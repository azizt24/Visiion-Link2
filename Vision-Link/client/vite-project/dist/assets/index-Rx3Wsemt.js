function _mergeNamespaces(e,o){for(var s=0;s<o.length;s++){const a=o[s];if(typeof a!="string"&&!Array.isArray(a)){for(const _ in a)if(_!=="default"&&!(_ in e)){const $=Object.getOwnPropertyDescriptor(a,_);$&&Object.defineProperty(e,_,$.get?$:{enumerable:!0,get:()=>a[_]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))a(_);new MutationObserver(_=>{for(const $ of _)if($.type==="childList")for(const _e of $.addedNodes)_e.tagName==="LINK"&&_e.rel==="modulepreload"&&a(_e)}).observe(document,{childList:!0,subtree:!0});function s(_){const $={};return _.integrity&&($.integrity=_.integrity),_.referrerPolicy&&($.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?$.credentials="include":_.crossOrigin==="anonymous"?$.credentials="omit":$.credentials="same-origin",$}function a(_){if(_.ep)return;_.ep=!0;const $=s(_);fetch(_.href,$)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var o=e.default;if(typeof o=="function"){var s=function a(){return this instanceof a?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};s.prototype=o.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(a){var _=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(s,a,_.get?_:{enumerable:!0,get:function(){return e[a]}})}),s}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r$1=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(e,o,s){this.props=e,this.context=o,this.refs=D$1,this.updater=s||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(e,o){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,o,"setState")};E$1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(e,o,s){this.props=e,this.context=o,this.refs=D$1,this.updater=s||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(e,o,s){var a,_={},$=null,_e=null;if(o!=null)for(a in o.ref!==void 0&&(_e=o.ref),o.key!==void 0&&($=""+o.key),o)J.call(o,a)&&!L$1.hasOwnProperty(a)&&(_[a]=o[a]);var _n=arguments.length-2;if(_n===1)_.children=s;else if(1<_n){for(var _r=Array(_n),_s=0;_s<_n;_s++)_r[_s]=arguments[_s+2];_.children=_r}if(e&&e.defaultProps)for(a in _n=e.defaultProps,_n)_[a]===void 0&&(_[a]=_n[a]);return{$$typeof:l$1,type:e,key:$,ref:_e,props:_,_owner:K$1.current}}function N$1(e,o){return{$$typeof:l$1,type:e.type,key:o,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape$1(e){var o={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return o[s]})}var P$1=/\/+/g;function Q$1(e,o){return typeof e=="object"&&e!==null&&e.key!=null?escape$1(""+e.key):o.toString(36)}function R$1(e,o,s,a,_){var $=typeof e;($==="undefined"||$==="boolean")&&(e=null);var _e=!1;if(e===null)_e=!0;else switch($){case"string":case"number":_e=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:_e=!0}}if(_e)return _e=e,_=_(_e),e=a===""?"."+Q$1(_e,0):a,I$1(_)?(s="",e!=null&&(s=e.replace(P$1,"$&/")+"/"),R$1(_,o,s,"",function(_s){return _s})):_!=null&&(O$1(_)&&(_=N$1(_,s+(!_.key||_e&&_e.key===_.key?"":(""+_.key).replace(P$1,"$&/")+"/")+e)),o.push(_)),1;if(_e=0,a=a===""?".":a+":",I$1(e))for(var _n=0;_n<e.length;_n++){$=e[_n];var _r=a+Q$1($,_n);_e+=R$1($,o,s,_r,_)}else if(_r=A$1(e),typeof _r=="function")for(e=_r.call(e),_n=0;!($=e.next()).done;)$=$.value,_r=a+Q$1($,_n++),_e+=R$1($,o,s,_r,_);else if($==="object")throw o=String(e),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return _e}function S$1(e,o,s){if(e==null)return e;var a=[],_=0;return R$1(e,a,"","",function($){return o.call(s,$,_++)}),a}function T$1(e){if(e._status===-1){var o=e._result;o=o(),o.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=o)}if(e._status===1)return e._result.default;throw e._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};react_production_min.Children={map:S$1,forEach:function(e,o,s){S$1(e,function(){o.apply(this,arguments)},s)},count:function(e){var o=0;return S$1(e,function(){o++}),o},toArray:function(e){return S$1(e,function(o){return o})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r$1;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.cloneElement=function(e,o,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=C$1({},e.props),_=e.key,$=e.ref,_e=e._owner;if(o!=null){if(o.ref!==void 0&&($=o.ref,_e=K$1.current),o.key!==void 0&&(_=""+o.key),e.type&&e.type.defaultProps)var _n=e.type.defaultProps;for(_r in o)J.call(o,_r)&&!L$1.hasOwnProperty(_r)&&(a[_r]=o[_r]===void 0&&_n!==void 0?_n[_r]:o[_r])}var _r=arguments.length-2;if(_r===1)a.children=s;else if(1<_r){_n=Array(_r);for(var _s=0;_s<_r;_s++)_n[_s]=arguments[_s+2];a.children=_n}return{$$typeof:l$1,type:e.type,key:_,ref:$,props:a,_owner:_e}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$1;react_production_min.createFactory=function(e){var o=M$1.bind(null,e);return o.type=e,o};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$1,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,o){return{$$typeof:x,type:e,compare:o===void 0?null:o}};react_production_min.startTransition=function(e){var o=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=o}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(e,o){return U$1.current.useCallback(e,o)};react_production_min.useContext=function(e){return U$1.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$1.current.useDeferredValue(e)};react_production_min.useEffect=function(e,o){return U$1.current.useEffect(e,o)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(e,o,s){return U$1.current.useImperativeHandle(e,o,s)};react_production_min.useInsertionEffect=function(e,o){return U$1.current.useInsertionEffect(e,o)};react_production_min.useLayoutEffect=function(e,o){return U$1.current.useLayoutEffect(e,o)};react_production_min.useMemo=function(e,o){return U$1.current.useMemo(e,o)};react_production_min.useReducer=function(e,o,s){return U$1.current.useReducer(e,o,s)};react_production_min.useRef=function(e){return U$1.current.useRef(e)};react_production_min.useState=function(e){return U$1.current.useState(e)};react_production_min.useSyncExternalStore=function(e,o,s){return U$1.current.useSyncExternalStore(e,o,s)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,o,s){var a,_={},$=null,_e=null;s!==void 0&&($=""+s),o.key!==void 0&&($=""+o.key),o.ref!==void 0&&(_e=o.ref);for(a in o)m$1.call(o,a)&&!p$1.hasOwnProperty(a)&&(_[a]=o[a]);if(e&&e.defaultProps)for(a in o=e.defaultProps,o)_[a]===void 0&&(_[a]=o[a]);return{$$typeof:k,type:e,key:$,ref:_e,props:_,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function o(D_,n0){var a_=D_.length;D_.push(n0);e:for(;0<a_;){var s_=a_-1>>>1,S_=D_[s_];if(0<_(S_,n0))D_[s_]=n0,D_[a_]=S_,a_=s_;else break e}}function s(D_){return D_.length===0?null:D_[0]}function a(D_){if(D_.length===0)return null;var n0=D_[0],a_=D_.pop();if(a_!==n0){D_[0]=a_;e:for(var s_=0,S_=D_.length,V_=S_>>>1;s_<V_;){var W_=2*(s_+1)-1,Y_=D_[W_],e0=W_+1,F_=D_[e0];if(0>_(Y_,a_))e0<S_&&0>_(F_,Y_)?(D_[s_]=F_,D_[e0]=a_,s_=e0):(D_[s_]=Y_,D_[W_]=a_,s_=W_);else if(e0<S_&&0>_(F_,a_))D_[s_]=F_,D_[e0]=a_,s_=e0;else break e}}return n0}function _(D_,n0){var a_=D_.sortIndex-n0.sortIndex;return a_!==0?a_:D_.id-n0.id}if(typeof performance=="object"&&typeof performance.now=="function"){var $=performance;e.unstable_now=function(){return $.now()}}else{var _e=Date,_n=_e.now();e.unstable_now=function(){return _e.now()-_n}}var _r=[],_s=[],na=1,ba=null,_p=3,_f=!1,_E=!1,_v=!1,n_=typeof setTimeout=="function"?setTimeout:null,e_=typeof clearTimeout=="function"?clearTimeout:null,t_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function o_(D_){for(var n0=s(_s);n0!==null;){if(n0.callback===null)a(_s);else if(n0.startTime<=D_)a(_s),n0.sortIndex=n0.expirationTime,o(_r,n0);else break;n0=s(_s)}}function m_(D_){if(_v=!1,o_(D_),!_E)if(s(_r)!==null)_E=!0,I_(b_);else{var n0=s(_s);n0!==null&&U_(m_,n0.startTime-D_)}}function b_(D_,n0){_E=!1,_v&&(_v=!1,e_(N_),N_=-1),_f=!0;var a_=_p;try{for(o_(n0),ba=s(_r);ba!==null&&(!(ba.expirationTime>n0)||D_&&!A_());){var s_=ba.callback;if(typeof s_=="function"){ba.callback=null,_p=ba.priorityLevel;var S_=s_(ba.expirationTime<=n0);n0=e.unstable_now(),typeof S_=="function"?ba.callback=S_:ba===s(_r)&&a(_r),o_(n0)}else a(_r);ba=s(_r)}if(ba!==null)var V_=!0;else{var W_=s(_s);W_!==null&&U_(m_,W_.startTime-n0),V_=!1}return V_}finally{ba=null,_p=a_,_f=!1}}var w_=!1,y_=null,N_=-1,_y=5,v_=-1;function A_(){return!(e.unstable_now()-v_<_y)}function k_(){if(y_!==null){var D_=e.unstable_now();v_=D_;var n0=!0;try{n0=y_(!0,D_)}finally{n0?P_():(w_=!1,y_=null)}}else w_=!1}var P_;if(typeof t_=="function")P_=function(){t_(k_)};else if(typeof MessageChannel<"u"){var T_=new MessageChannel,R_=T_.port2;T_.port1.onmessage=k_,P_=function(){R_.postMessage(null)}}else P_=function(){n_(k_,0)};function I_(D_){y_=D_,w_||(w_=!0,P_())}function U_(D_,n0){N_=n_(function(){D_(e.unstable_now())},n0)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D_){D_.callback=null},e.unstable_continueExecution=function(){_E||_f||(_E=!0,I_(b_))},e.unstable_forceFrameRate=function(D_){0>D_||125<D_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_y=0<D_?Math.floor(1e3/D_):5},e.unstable_getCurrentPriorityLevel=function(){return _p},e.unstable_getFirstCallbackNode=function(){return s(_r)},e.unstable_next=function(D_){switch(_p){case 1:case 2:case 3:var n0=3;break;default:n0=_p}var a_=_p;_p=n0;try{return D_()}finally{_p=a_}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(D_,n0){switch(D_){case 1:case 2:case 3:case 4:case 5:break;default:D_=3}var a_=_p;_p=D_;try{return n0()}finally{_p=a_}},e.unstable_scheduleCallback=function(D_,n0,a_){var s_=e.unstable_now();switch(typeof a_=="object"&&a_!==null?(a_=a_.delay,a_=typeof a_=="number"&&0<a_?s_+a_:s_):a_=s_,D_){case 1:var S_=-1;break;case 2:S_=250;break;case 5:S_=1073741823;break;case 4:S_=1e4;break;default:S_=5e3}return S_=a_+S_,D_={id:na++,callback:n0,priorityLevel:D_,startTime:a_,expirationTime:S_,sortIndex:-1},a_>s_?(D_.sortIndex=a_,o(_s,D_),s(_r)===null&&D_===s(_s)&&(_v?(e_(N_),N_=-1):_v=!0,U_(m_,a_-s_))):(D_.sortIndex=S_,o(_r,D_),_E||_f||(_E=!0,I_(b_))),D_},e.unstable_shouldYield=A_,e.unstable_wrapCallback=function(D_){var n0=_p;return function(){var a_=_p;_p=n0;try{return D_.apply(this,arguments)}finally{_p=a_}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(e){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)o+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,o){ha(e,o),ha(e+"Capture",o)}function ha(e,o){for(ea[e]=o,e=0;e<o.length;e++)da.add(o[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,o,s,a){if(s!==null&&s.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return a?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,o,s,a){if(o===null||typeof o>"u"||pa(e,o,s,a))return!0;if(a)return!1;if(s!==null)switch(s.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function v(e,o,s,a,_,$,_e){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=a,this.attributeNamespace=_,this.mustUseProperty=s,this.propertyName=e,this.type=o,this.sanitizeURL=$,this.removeEmptyString=_e}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var o=e[0];z[o]=new v(o,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var o=e.replace(ra,sa);z[o]=new v(o,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var o=e.replace(ra,sa);z[o]=new v(o,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var o=e.replace(ra,sa);z[o]=new v(o,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,o,s,a){var _=z.hasOwnProperty(o)?z[o]:null;(_!==null?_.type!==0:a||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(qa(o,s,_,a)&&(s=null),a||_===null?oa(o)&&(s===null?e.removeAttribute(o):e.setAttribute(o,""+s)):_.mustUseProperty?e[_.propertyName]=s===null?_.type===3?!1:"":s:(o=_.attributeName,a=_.attributeNamespace,s===null?e.removeAttribute(o):(_=_.type,s=_===3||_===4&&s===!0?"":""+s,a?e.setAttributeNS(a,o,s):e.setAttribute(o,s))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(s){var o=s.stack.trim().match(/\n( *(at )?)/);La=o&&o[1]||""}return`
`+La+e}var Na=!1;function Oa(e,o){if(!e||Na)return"";Na=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(_s){var a=_s}Reflect.construct(e,[],o)}else{try{o.call()}catch(_s){a=_s}e.call(o.prototype)}else{try{throw Error()}catch(_s){a=_s}e()}}catch(_s){if(_s&&a&&typeof _s.stack=="string"){for(var _=_s.stack.split(`
`),$=a.stack.split(`
`),_e=_.length-1,_n=$.length-1;1<=_e&&0<=_n&&_[_e]!==$[_n];)_n--;for(;1<=_e&&0<=_n;_e--,_n--)if(_[_e]!==$[_n]){if(_e!==1||_n!==1)do if(_e--,_n--,0>_n||_[_e]!==$[_n]){var _r=`
`+_[_e].replace(" at new "," at ");return e.displayName&&_r.includes("<anonymous>")&&(_r=_r.replace("<anonymous>",e.displayName)),_r}while(1<=_e&&0<=_n);break}}}finally{Na=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var o=e.render;return e=e.displayName,e||(e=o.displayName||o.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return o=e.displayName||null,o!==null?o:Qa(e.type)||"Memo";case Ha:o=e._payload,e=e._init;try{return Qa(e(o))}catch{}}return null}function Ra(e){var o=e.type;switch(e.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=o.render,e=e.displayName||e.name||"",o.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(o);case 8:return o===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var o=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ua(e){var o=Ta(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,o),a=""+e[o];if(!e.hasOwnProperty(o)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var _=s.get,$=s.set;return Object.defineProperty(e,o,{configurable:!0,get:function(){return _.call(this)},set:function(_e){a=""+_e,$.call(this,_e)}}),Object.defineProperty(e,o,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(_e){a=""+_e},stopTracking:function(){e._valueTracker=null,delete e[o]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var o=e._valueTracker;if(!o)return!0;var s=o.getValue(),a="";return e&&(a=Ta(e)?e.checked?"true":"false":e.value),e=a,e!==s?(o.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,o){var s=o.checked;return A({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Za(e,o){var s=o.defaultValue==null?"":o.defaultValue,a=o.checked!=null?o.checked:o.defaultChecked;s=Sa(o.value!=null?o.value:s),e._wrapperState={initialChecked:a,initialValue:s,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ab(e,o){o=o.checked,o!=null&&ta(e,"checked",o,!1)}function bb(e,o){ab(e,o);var s=Sa(o.value),a=o.type;if(s!=null)a==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(a==="submit"||a==="reset"){e.removeAttribute("value");return}o.hasOwnProperty("value")?cb(e,o.type,s):o.hasOwnProperty("defaultValue")&&cb(e,o.type,Sa(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(e.defaultChecked=!!o.defaultChecked)}function db(e,o,s){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var a=o.type;if(!(a!=="submit"&&a!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+e._wrapperState.initialValue,s||o===e.value||(e.value=o),e.defaultValue=o}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function cb(e,o,s){(o!=="number"||Xa(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var eb=Array.isArray;function fb(e,o,s,a){if(e=e.options,o){o={};for(var _=0;_<s.length;_++)o["$"+s[_]]=!0;for(s=0;s<e.length;s++)_=o.hasOwnProperty("$"+e[s].value),e[s].selected!==_&&(e[s].selected=_),_&&a&&(e[s].defaultSelected=!0)}else{for(s=""+Sa(s),o=null,_=0;_<e.length;_++){if(e[_].value===s){e[_].selected=!0,a&&(e[_].defaultSelected=!0);return}o!==null||e[_].disabled||(o=e[_])}o!==null&&(o.selected=!0)}}function gb(e,o){if(o.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},o,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,o){var s=o.value;if(s==null){if(s=o.children,o=o.defaultValue,s!=null){if(o!=null)throw Error(p(92));if(eb(s)){if(1<s.length)throw Error(p(93));s=s[0]}o=s}o==null&&(o=""),s=o}e._wrapperState={initialValue:Sa(s)}}function ib(e,o){var s=Sa(o.value),a=Sa(o.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),o.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),a!=null&&(e.defaultValue=""+a)}function jb(e){var o=e.textContent;o===e._wrapperState.initialValue&&o!==""&&o!==null&&(e.value=o)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,o){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(o):e==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,s,a,_){MSApp.execUnsafeLocalFunction(function(){return e(o,s,a,_)})}:e}(function(e,o){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=o;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;o.firstChild;)e.appendChild(o.firstChild)}});function ob(e,o){if(o){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=o;return}}e.textContent=o}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(o){o=o+e.charAt(0).toUpperCase()+e.substring(1),pb[o]=pb[e]})});function rb(e,o,s){return o==null||typeof o=="boolean"||o===""?"":s||typeof o!="number"||o===0||pb.hasOwnProperty(e)&&pb[e]?(""+o).trim():o+"px"}function sb(e,o){e=e.style;for(var s in o)if(o.hasOwnProperty(s)){var a=s.indexOf("--")===0,_=rb(s,o[s],a);s==="float"&&(s="cssFloat"),a?e.setProperty(s,_):e[s]=_}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,o){if(o){if(tb[e]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(p(137,e));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(p(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(p(61))}if(o.style!=null&&typeof o.style!="object")throw Error(p(62))}}function vb(e,o){if(e.indexOf("-")===-1)return typeof o.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p(280));var o=e.stateNode;o&&(o=Db(o),yb(e.stateNode,e.type,o))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,o=Ab;if(Ab=zb=null,Bb(e),o)for(e=0;e<o.length;e++)Bb(o[e])}}function Gb(e,o){return e(o)}function Hb(){}var Ib=!1;function Jb(e,o,s){if(Ib)return e(o,s);Ib=!0;try{return Gb(e,o,s)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,o){var s=e.stateNode;if(s===null)return null;var a=Db(s);if(a===null)return null;s=a[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(e=e.type,a=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!a;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(p(231,o,typeof s));return s}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,o,s,a,_,$,_e,_n,_r){var _s=Array.prototype.slice.call(arguments,3);try{o.apply(s,_s)}catch(na){this.onError(na)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,o,s,a,_,$,_e,_n,_r){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,o,s,a,_,$,_e,_n,_r){if(Tb.apply(this,arguments),Ob){if(Ob){var _s=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=_s)}}function Vb(e){var o=e,s=e;if(e.alternate)for(;o.return;)o=o.return;else{e=o;do o=e,o.flags&4098&&(s=o.return),e=o.return;while(e)}return o.tag===3?s:null}function Wb(e){if(e.tag===13){var o=e.memoizedState;if(o===null&&(e=e.alternate,e!==null&&(o=e.memoizedState)),o!==null)return o.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p(188))}function Yb(e){var o=e.alternate;if(!o){if(o=Vb(e),o===null)throw Error(p(188));return o!==e?null:e}for(var s=e,a=o;;){var _=s.return;if(_===null)break;var $=_.alternate;if($===null){if(a=_.return,a!==null){s=a;continue}break}if(_.child===$.child){for($=_.child;$;){if($===s)return Xb(_),e;if($===a)return Xb(_),o;$=$.sibling}throw Error(p(188))}if(s.return!==a.return)s=_,a=$;else{for(var _e=!1,_n=_.child;_n;){if(_n===s){_e=!0,s=_,a=$;break}if(_n===a){_e=!0,a=_,s=$;break}_n=_n.sibling}if(!_e){for(_n=$.child;_n;){if(_n===s){_e=!0,s=$,a=_;break}if(_n===a){_e=!0,a=$,s=_;break}_n=_n.sibling}if(!_e)throw Error(p(189))}}if(s.alternate!==a)throw Error(p(190))}if(s.tag!==3)throw Error(p(188));return s.stateNode.current===s?e:o}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var o=$b(e);if(o!==null)return o;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,o){var s=e.pendingLanes;if(s===0)return 0;var a=0,_=e.suspendedLanes,$=e.pingedLanes,_e=s&268435455;if(_e!==0){var _n=_e&~_;_n!==0?a=tc(_n):($&=_e,$!==0&&(a=tc($)))}else _e=s&~_,_e!==0?a=tc(_e):$!==0&&(a=tc($));if(a===0)return 0;if(o!==0&&o!==a&&!(o&_)&&(_=a&-a,$=o&-o,_>=$||_===16&&($&4194240)!==0))return o;if(a&4&&(a|=s&16),o=e.entangledLanes,o!==0)for(e=e.entanglements,o&=a;0<o;)s=31-oc(o),_=1<<s,a|=e[s],o&=~_;return a}function vc(e,o){switch(e){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,o){for(var s=e.suspendedLanes,a=e.pingedLanes,_=e.expirationTimes,$=e.pendingLanes;0<$;){var _e=31-oc($),_n=1<<_e,_r=_[_e];_r===-1?(!(_n&s)||_n&a)&&(_[_e]=vc(_n,o)):_r<=o&&(e.expiredLanes|=_n),$&=~_n}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var o=[],s=0;31>s;s++)o.push(e);return o}function Ac(e,o,s){e.pendingLanes|=o,o!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,o=31-oc(o),e[o]=s}function Bc(e,o){var s=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<s;){var _=31-oc(s),$=1<<_;o[_]=0,a[_]=-1,e[_]=-1,s&=~$}}function Cc(e,o){var s=e.entangledLanes|=o;for(e=e.entanglements;s;){var a=31-oc(s),_=1<<a;_&o|e[a]&o&&(e[a]|=o),s&=~_}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,o){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(o.pointerId)}}function Tc(e,o,s,a,_,$){return e===null||e.nativeEvent!==$?(e={blockedOn:o,domEventName:s,eventSystemFlags:a,nativeEvent:$,targetContainers:[_]},o!==null&&(o=Cb(o),o!==null&&Fc(o)),e):(e.eventSystemFlags|=a,o=e.targetContainers,_!==null&&o.indexOf(_)===-1&&o.push(_),e)}function Uc(e,o,s,a,_){switch(o){case"focusin":return Lc=Tc(Lc,e,o,s,a,_),!0;case"dragenter":return Mc=Tc(Mc,e,o,s,a,_),!0;case"mouseover":return Nc=Tc(Nc,e,o,s,a,_),!0;case"pointerover":var $=_.pointerId;return Oc.set($,Tc(Oc.get($)||null,e,o,s,a,_)),!0;case"gotpointercapture":return $=_.pointerId,Pc.set($,Tc(Pc.get($)||null,e,o,s,a,_)),!0}return!1}function Vc(e){var o=Wc(e.target);if(o!==null){var s=Vb(o);if(s!==null){if(o=s.tag,o===13){if(o=Wb(s),o!==null){e.blockedOn=o,Ic(e.priority,function(){Gc(s)});return}}else if(o===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var o=e.targetContainers;0<o.length;){var s=Yc(e.domEventName,e.eventSystemFlags,o[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var a=new s.constructor(s.type,s);wb=a,s.target.dispatchEvent(a),wb=null}else return o=Cb(s),o!==null&&Fc(o),e.blockedOn=s,!1;o.shift()}return!0}function Zc(e,o,s){Xc(e)&&s.delete(o)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,o){e.blockedOn===o&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function o(_){return ad(_,e)}if(0<Kc.length){ad(Kc[0],e);for(var s=1;s<Kc.length;s++){var a=Kc[s];a.blockedOn===e&&(a.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(o),Pc.forEach(o),s=0;s<Qc.length;s++)a=Qc[s],a.blockedOn===e&&(a.blockedOn=null);for(;0<Qc.length&&(s=Qc[0],s.blockedOn===null);)Vc(s),s.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,o,s,a){var _=C,$=cd.transition;cd.transition=null;try{C=1,fd(e,o,s,a)}finally{C=_,cd.transition=$}}function gd(e,o,s,a){var _=C,$=cd.transition;cd.transition=null;try{C=4,fd(e,o,s,a)}finally{C=_,cd.transition=$}}function fd(e,o,s,a){if(dd){var _=Yc(e,o,s,a);if(_===null)hd(e,o,a,id,s),Sc(e,a);else if(Uc(_,e,o,s,a))a.stopPropagation();else if(Sc(e,a),o&4&&-1<Rc.indexOf(e)){for(;_!==null;){var $=Cb(_);if($!==null&&Ec($),$=Yc(e,o,s,a),$===null&&hd(e,o,a,id,s),$===_)break;_=$}_!==null&&a.stopPropagation()}else hd(e,o,a,null,s)}}var id=null;function Yc(e,o,s,a){if(id=null,e=xb(a),e=Wc(e),e!==null)if(o=Vb(e),o===null)e=null;else if(s=o.tag,s===13){if(e=Wb(o),e!==null)return e;e=null}else if(s===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;e=null}else o!==e&&(e=null);return id=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,o=ld,s=o.length,a,_="value"in kd?kd.value:kd.textContent,$=_.length;for(e=0;e<s&&o[e]===_[e];e++);var _e=s-e;for(a=1;a<=_e&&o[s-a]===_[$-a];a++);return md=_.slice(e,1<a?1-a:void 0)}function od(e){var o=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&o===13&&(e=13)):e=o,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function o(s,a,_,$,_e){this._reactName=s,this._targetInst=_,this.type=a,this.nativeEvent=$,this.target=_e,this.currentTarget=null;for(var _n in e)e.hasOwnProperty(_n)&&(s=e[_n],this[_n]=s?s($):$[_n]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),o}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(e):(e=Od[e])?!!o[e]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var o=Md[e.key]||e.key;if(o!=="Unidentified")return o}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(e,o){switch(e){case"keyup":return $d.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie=!1;function je(e,o){switch(e){case"compositionend":return he(o);case"keypress":return o.which!==32?null:(fe=!0,ee);case"textInput":return e=o.data,e===ee&&fe?null:e;default:return null}}function ke(e,o){if(ie)return e==="compositionend"||!ae&&ge(e,o)?(e=nd(),md=ld=kd=null,ie=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return de&&o.locale!=="ko"?null:o.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(e){var o=e&&e.nodeName&&e.nodeName.toLowerCase();return o==="input"?!!le[e.type]:o==="textarea"}function ne(e,o,s,a){Eb(a),o=oe(o,"onChange"),0<o.length&&(s=new td("onChange","change",null,s,a),e.push({event:s,listeners:o}))}var pe=null,qe=null;function re$1(e){se(e,0)}function te(e){var o=ue(e);if(Wa(o))return e}function ve(e,o){if(e==="change")return o}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(e){if(e.propertyName==="value"&&te(qe)){var o=[];ne(o,qe,e,xb(e)),Jb(re$1,o)}}function Ce(e,o,s){e==="focusin"?(Ae(),pe=o,qe=s,pe.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te(qe)}function Ee(e,o){if(e==="click")return te(o)}function Fe(e,o){if(e==="input"||e==="change")return te(o)}function Ge(e,o){return e===o&&(e!==0||1/e===1/o)||e!==e&&o!==o}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,o){if(He(e,o))return!0;if(typeof e!="object"||e===null||typeof o!="object"||o===null)return!1;var s=Object.keys(e),a=Object.keys(o);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var _=s[a];if(!ja.call(o,_)||!He(e[_],o[_]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,o){var s=Je(e);e=0;for(var a;s;){if(s.nodeType===3){if(a=e+s.textContent.length,e<=o&&a>=o)return{node:s,offset:o-e};e=a}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Je(s)}}function Le(e,o){return e&&o?e===o?!0:e&&e.nodeType===3?!1:o&&o.nodeType===3?Le(e,o.parentNode):"contains"in e?e.contains(o):e.compareDocumentPosition?!!(e.compareDocumentPosition(o)&16):!1:!1}function Me(){for(var e=window,o=Xa();o instanceof e.HTMLIFrameElement;){try{var s=typeof o.contentWindow.location.href=="string"}catch{s=!1}if(s)e=o.contentWindow;else break;o=Xa(e.document)}return o}function Ne(e){var o=e&&e.nodeName&&e.nodeName.toLowerCase();return o&&(o==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||o==="textarea"||e.contentEditable==="true")}function Oe(e){var o=Me(),s=e.focusedElem,a=e.selectionRange;if(o!==s&&s&&s.ownerDocument&&Le(s.ownerDocument.documentElement,s)){if(a!==null&&Ne(s)){if(o=a.start,e=a.end,e===void 0&&(e=o),"selectionStart"in s)s.selectionStart=o,s.selectionEnd=Math.min(e,s.value.length);else if(e=(o=s.ownerDocument||document)&&o.defaultView||window,e.getSelection){e=e.getSelection();var _=s.textContent.length,$=Math.min(a.start,_);a=a.end===void 0?$:Math.min(a.end,_),!e.extend&&$>a&&(_=a,a=$,$=_),_=Ke(s,$);var _e=Ke(s,a);_&&_e&&(e.rangeCount!==1||e.anchorNode!==_.node||e.anchorOffset!==_.offset||e.focusNode!==_e.node||e.focusOffset!==_e.offset)&&(o=o.createRange(),o.setStart(_.node,_.offset),e.removeAllRanges(),$>a?(e.addRange(o),e.extend(_e.node,_e.offset)):(o.setEnd(_e.node,_e.offset),e.addRange(o)))}}for(o=[],e=s;e=e.parentNode;)e.nodeType===1&&o.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<o.length;s++)e=o[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(e,o,s){var a=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Te||Qe==null||Qe!==Xa(a)||(a=Qe,"selectionStart"in a&&Ne(a)?a={start:a.selectionStart,end:a.selectionEnd}:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection(),a={anchorNode:a.anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset}),Se&&Ie(Se,a)||(Se=a,a=oe(Re,"onSelect"),0<a.length&&(o=new td("onSelect","select",null,o,s),e.push({event:o,listeners:a}),o.target=Qe)))}function Ve(e,o){var s={};return s[e.toLowerCase()]=o.toLowerCase(),s["Webkit"+e]="webkit"+o,s["Moz"+e]="moz"+o,s}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var o=We[e],s;for(s in o)if(o.hasOwnProperty(s)&&s in Ye)return Xe[e]=o[s];return e}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,o){df.set(e,o),fa(o,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,o,s){var a=e.type||"unknown-event";e.currentTarget=s,Ub(a,o,void 0,e),e.currentTarget=null}function se(e,o){o=(o&4)!==0;for(var s=0;s<e.length;s++){var a=e[s],_=a.event;a=a.listeners;e:{var $=void 0;if(o)for(var _e=a.length-1;0<=_e;_e--){var _n=a[_e],_r=_n.instance,_s=_n.currentTarget;if(_n=_n.listener,_r!==$&&_.isPropagationStopped())break e;nf(_,_n,_s),$=_r}else for(_e=0;_e<a.length;_e++){if(_n=a[_e],_r=_n.instance,_s=_n.currentTarget,_n=_n.listener,_r!==$&&_.isPropagationStopped())break e;nf(_,_n,_s),$=_r}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D(e,o){var s=o[of];s===void 0&&(s=o[of]=new Set);var a=e+"__bubble";s.has(a)||(pf(o,e,2,!1),s.add(a))}function qf(e,o,s){var a=0;o&&(a|=4),pf(s,e,a,o)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(s){s!=="selectionchange"&&(mf.has(s)||qf(s,!1,e),qf(s,!0,e))});var o=e.nodeType===9?e:e.ownerDocument;o===null||o[rf]||(o[rf]=!0,qf("selectionchange",!1,o))}}function pf(e,o,s,a){switch(jd(o)){case 1:var _=ed;break;case 4:_=gd;break;default:_=fd}s=_.bind(null,o,s,e),_=void 0,!Lb||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(_=!0),a?_!==void 0?e.addEventListener(o,s,{capture:!0,passive:_}):e.addEventListener(o,s,!0):_!==void 0?e.addEventListener(o,s,{passive:_}):e.addEventListener(o,s,!1)}function hd(e,o,s,a,_){var $=a;if(!(o&1)&&!(o&2)&&a!==null)e:for(;;){if(a===null)return;var _e=a.tag;if(_e===3||_e===4){var _n=a.stateNode.containerInfo;if(_n===_||_n.nodeType===8&&_n.parentNode===_)break;if(_e===4)for(_e=a.return;_e!==null;){var _r=_e.tag;if((_r===3||_r===4)&&(_r=_e.stateNode.containerInfo,_r===_||_r.nodeType===8&&_r.parentNode===_))return;_e=_e.return}for(;_n!==null;){if(_e=Wc(_n),_e===null)return;if(_r=_e.tag,_r===5||_r===6){a=$=_e;continue e}_n=_n.parentNode}}a=a.return}Jb(function(){var _s=$,na=xb(s),ba=[];e:{var _p=df.get(e);if(_p!==void 0){var _f=td,_E=e;switch(e){case"keypress":if(od(s)===0)break e;case"keydown":case"keyup":_f=Rd;break;case"focusin":_E="focus",_f=Fd;break;case"focusout":_E="blur",_f=Fd;break;case"beforeblur":case"afterblur":_f=Fd;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_f=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_f=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_f=Vd;break;case $e:case af:case bf:_f=Hd;break;case cf:_f=Xd;break;case"scroll":_f=vd;break;case"wheel":_f=Zd;break;case"copy":case"cut":case"paste":_f=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_f=Td}var _v=(o&4)!==0,n_=!_v&&e==="scroll",e_=_v?_p!==null?_p+"Capture":null:_p;_v=[];for(var t_=_s,o_;t_!==null;){o_=t_;var m_=o_.stateNode;if(o_.tag===5&&m_!==null&&(o_=m_,e_!==null&&(m_=Kb(t_,e_),m_!=null&&_v.push(tf(t_,m_,o_)))),n_)break;t_=t_.return}0<_v.length&&(_p=new _f(_p,_E,null,s,na),ba.push({event:_p,listeners:_v}))}}if(!(o&7)){e:{if(_p=e==="mouseover"||e==="pointerover",_f=e==="mouseout"||e==="pointerout",_p&&s!==wb&&(_E=s.relatedTarget||s.fromElement)&&(Wc(_E)||_E[uf]))break e;if((_f||_p)&&(_p=na.window===na?na:(_p=na.ownerDocument)?_p.defaultView||_p.parentWindow:window,_f?(_E=s.relatedTarget||s.toElement,_f=_s,_E=_E?Wc(_E):null,_E!==null&&(n_=Vb(_E),_E!==n_||_E.tag!==5&&_E.tag!==6)&&(_E=null)):(_f=null,_E=_s),_f!==_E)){if(_v=Bd,m_="onMouseLeave",e_="onMouseEnter",t_="mouse",(e==="pointerout"||e==="pointerover")&&(_v=Td,m_="onPointerLeave",e_="onPointerEnter",t_="pointer"),n_=_f==null?_p:ue(_f),o_=_E==null?_p:ue(_E),_p=new _v(m_,t_+"leave",_f,s,na),_p.target=n_,_p.relatedTarget=o_,m_=null,Wc(na)===_s&&(_v=new _v(e_,t_+"enter",_E,s,na),_v.target=o_,_v.relatedTarget=n_,m_=_v),n_=m_,_f&&_E)t:{for(_v=_f,e_=_E,t_=0,o_=_v;o_;o_=vf(o_))t_++;for(o_=0,m_=e_;m_;m_=vf(m_))o_++;for(;0<t_-o_;)_v=vf(_v),t_--;for(;0<o_-t_;)e_=vf(e_),o_--;for(;t_--;){if(_v===e_||e_!==null&&_v===e_.alternate)break t;_v=vf(_v),e_=vf(e_)}_v=null}else _v=null;_f!==null&&wf(ba,_p,_f,_v,!1),_E!==null&&n_!==null&&wf(ba,n_,_E,_v,!0)}}e:{if(_p=_s?ue(_s):window,_f=_p.nodeName&&_p.nodeName.toLowerCase(),_f==="select"||_f==="input"&&_p.type==="file")var b_=ve;else if(me(_p))if(we)b_=Fe;else{b_=De;var w_=Ce}else(_f=_p.nodeName)&&_f.toLowerCase()==="input"&&(_p.type==="checkbox"||_p.type==="radio")&&(b_=Ee);if(b_&&(b_=b_(e,_s))){ne(ba,b_,s,na);break e}w_&&w_(e,_p,_s),e==="focusout"&&(w_=_p._wrapperState)&&w_.controlled&&_p.type==="number"&&cb(_p,"number",_p.value)}switch(w_=_s?ue(_s):window,e){case"focusin":(me(w_)||w_.contentEditable==="true")&&(Qe=w_,Re=_s,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(ba,s,na);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(ba,s,na)}var y_;if(ae)e:{switch(e){case"compositionstart":var N_="onCompositionStart";break e;case"compositionend":N_="onCompositionEnd";break e;case"compositionupdate":N_="onCompositionUpdate";break e}N_=void 0}else ie?ge(e,s)&&(N_="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(N_="onCompositionStart");N_&&(de&&s.locale!=="ko"&&(ie||N_!=="onCompositionStart"?N_==="onCompositionEnd"&&ie&&(y_=nd()):(kd=na,ld="value"in kd?kd.value:kd.textContent,ie=!0)),w_=oe(_s,N_),0<w_.length&&(N_=new Ld(N_,e,null,s,na),ba.push({event:N_,listeners:w_}),y_?N_.data=y_:(y_=he(s),y_!==null&&(N_.data=y_)))),(y_=ce?je(e,s):ke(e,s))&&(_s=oe(_s,"onBeforeInput"),0<_s.length&&(na=new Ld("onBeforeInput","beforeinput",null,s,na),ba.push({event:na,listeners:_s}),na.data=y_))}se(ba,o)})}function tf(e,o,s){return{instance:e,listener:o,currentTarget:s}}function oe(e,o){for(var s=o+"Capture",a=[];e!==null;){var _=e,$=_.stateNode;_.tag===5&&$!==null&&(_=$,$=Kb(e,s),$!=null&&a.unshift(tf(e,$,_)),$=Kb(e,o),$!=null&&a.push(tf(e,$,_))),e=e.return}return a}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,o,s,a,_){for(var $=o._reactName,_e=[];s!==null&&s!==a;){var _n=s,_r=_n.alternate,_s=_n.stateNode;if(_r!==null&&_r===a)break;_n.tag===5&&_s!==null&&(_n=_s,_?(_r=Kb(s,$),_r!=null&&_e.unshift(tf(s,_r,_n))):_||(_r=Kb(s,$),_r!=null&&_e.push(tf(s,_r,_n)))),s=s.return}_e.length!==0&&e.push({event:o,listeners:_e})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,o,s){if(o=zf(o),zf(e)!==o&&s)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,o){return e==="textarea"||e==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,o){var s=o,a=0;do{var _=s.nextSibling;if(e.removeChild(s),_&&_.nodeType===8)if(s=_.data,s==="/$"){if(a===0){e.removeChild(_),bd(o);return}a--}else s!=="$"&&s!=="$?"&&s!=="$!"||a++;s=_}while(s);bd(o)}function Lf(e){for(;e!=null;e=e.nextSibling){var o=e.nodeType;if(o===1||o===3)break;if(o===8){if(o=e.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var o=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(o===0)return e;o--}else s==="/$"&&o++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var o=e[Of];if(o)return o;for(var s=e.parentNode;s;){if(o=s[uf]||s[Of]){if(s=o.alternate,o.child!==null||s!==null&&s.child!==null)for(e=Mf(e);e!==null;){if(s=e[Of])return s;e=Mf(e)}return o}e=s,s=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,o){Tf++,Sf[Tf]=e.current,e.current=o}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,o){var s=e.type.contextTypes;if(!s)return Vf;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===o)return a.__reactInternalMemoizedMaskedChildContext;var _={},$;for($ in s)_[$]=o[$];return a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=_),_}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E(Wf),E(H)}function ag(e,o,s){if(H.current!==Vf)throw Error(p(168));G(H,o),G(Wf,s)}function bg(e,o,s){var a=e.stateNode;if(o=o.childContextTypes,typeof a.getChildContext!="function")return s;a=a.getChildContext();for(var _ in a)if(!(_ in o))throw Error(p(108,Ra(e)||"Unknown",_));return A({},s,a)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,e),G(Wf,Wf.current),!0}function dg(e,o,s){var a=e.stateNode;if(!a)throw Error(p(169));s?(e=bg(e,o,Xf),a.__reactInternalMemoizedMergedChildContext=e,E(Wf),E(H),G(H,e)):E(Wf),G(Wf,s)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,o=C;try{var s=eg;for(C=1;e<s.length;e++){var a=s[e];do a=a(!0);while(a!==null)}eg=null,fg=!1}catch(_){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),_}finally{C=o,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,o){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=o}function ug(e,o,s){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var a=rg;e=sg;var _=32-oc(a)-1;a&=~(1<<_),s+=1;var $=32-oc(o)+_;if(30<$){var _e=_-_%5;$=(a&(1<<_e)-1).toString(32),a>>=_e,_-=_e,rg=1<<32-oc(o)+_|s<<_|a,sg=$+e}else rg=1<<$|s<<_|a,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,o){var s=Bg(5,null,null,0);s.elementType="DELETED",s.stateNode=o,s.return=e,o=e.deletions,o===null?(e.deletions=[s],e.flags|=16):o.push(s)}function Cg(e,o){switch(e.tag){case 5:var s=e.type;return o=o.nodeType!==1||s.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(e.stateNode=o,xg=e,yg=Lf(o.firstChild),!0):!1;case 6:return o=e.pendingProps===""||o.nodeType!==3?null:o,o!==null?(e.stateNode=o,xg=e,yg=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(s=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:o,treeContext:s,retryLane:1073741824},s=Bg(18,null,null,0),s.stateNode=o,s.return=e,e.child=s,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var o=yg;if(o){var s=o;if(!Cg(e,o)){if(Dg(e))throw Error(p(418));o=Lf(s.nextSibling);var a=xg;o&&Cg(e,o)?Ag(a,s):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var o;if((o=e.tag!==3)&&!(o=e.tag!==5)&&(o=e.type,o=o!=="head"&&o!=="body"&&!Ef(e.type,e.memoizedProps)),o&&(o=yg)){if(Dg(e))throw Hg(),Error(p(418));for(;o;)Ag(e,o),o=Lf(o.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p(317));e:{for(e=e.nextSibling,o=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(o===0){yg=Lf(e.nextSibling);break e}o--}else s!=="$"&&s!=="$!"&&s!=="$?"||o++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,o){if(e&&e.defaultProps){o=A({},o),e=e.defaultProps;for(var s in e)o[s]===void 0&&(o[s]=e[s]);return o}return o}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(e){var o=Mg.current;E(Mg),e._currentValue=o}function Sg(e,o,s){for(;e!==null;){var a=e.alternate;if((e.childLanes&o)!==o?(e.childLanes|=o,a!==null&&(a.childLanes|=o)):a!==null&&(a.childLanes&o)!==o&&(a.childLanes|=o),e===s)break;e=e.return}}function Tg(e,o){Ng=e,Pg=Og=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&o&&(Ug=!0),e.firstContext=null)}function Vg(e){var o=e._currentValue;if(Pg!==e)if(e={context:e,memoizedValue:o,next:null},Og===null){if(Ng===null)throw Error(p(308));Og=e,Ng.dependencies={lanes:0,firstContext:e}}else Og=Og.next=e;return o}var Wg=null;function Xg(e){Wg===null?Wg=[e]:Wg.push(e)}function Yg(e,o,s,a){var _=o.interleaved;return _===null?(s.next=s,Xg(o)):(s.next=_.next,_.next=s),o.interleaved=s,Zg(e,a)}function Zg(e,o){e.lanes|=o;var s=e.alternate;for(s!==null&&(s.lanes|=o),s=e,e=e.return;e!==null;)e.childLanes|=o,s=e.alternate,s!==null&&(s.childLanes|=o),s=e,e=e.return;return s.tag===3?s.stateNode:null}var $g=!1;function ah(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(e,o){e=e.updateQueue,o.updateQueue===e&&(o.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ch(e,o){return{eventTime:e,lane:o,tag:0,payload:null,callback:null,next:null}}function dh(e,o,s){var a=e.updateQueue;if(a===null)return null;if(a=a.shared,K&2){var _=a.pending;return _===null?o.next=o:(o.next=_.next,_.next=o),a.pending=o,Zg(e,s)}return _=a.interleaved,_===null?(o.next=o,Xg(a)):(o.next=_.next,_.next=o),a.interleaved=o,Zg(e,s)}function eh(e,o,s){if(o=o.updateQueue,o!==null&&(o=o.shared,(s&4194240)!==0)){var a=o.lanes;a&=e.pendingLanes,s|=a,o.lanes=s,Cc(e,s)}}function fh(e,o){var s=e.updateQueue,a=e.alternate;if(a!==null&&(a=a.updateQueue,s===a)){var _=null,$=null;if(s=s.firstBaseUpdate,s!==null){do{var _e={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};$===null?_=$=_e:$=$.next=_e,s=s.next}while(s!==null);$===null?_=$=o:$=$.next=o}else _=$=o;s={baseState:a.baseState,firstBaseUpdate:_,lastBaseUpdate:$,shared:a.shared,effects:a.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=o:e.next=o,s.lastBaseUpdate=o}function gh(e,o,s,a){var _=e.updateQueue;$g=!1;var $=_.firstBaseUpdate,_e=_.lastBaseUpdate,_n=_.shared.pending;if(_n!==null){_.shared.pending=null;var _r=_n,_s=_r.next;_r.next=null,_e===null?$=_s:_e.next=_s,_e=_r;var na=e.alternate;na!==null&&(na=na.updateQueue,_n=na.lastBaseUpdate,_n!==_e&&(_n===null?na.firstBaseUpdate=_s:_n.next=_s,na.lastBaseUpdate=_r))}if($!==null){var ba=_.baseState;_e=0,na=_s=_r=null,_n=$;do{var _p=_n.lane,_f=_n.eventTime;if((a&_p)===_p){na!==null&&(na=na.next={eventTime:_f,lane:0,tag:_n.tag,payload:_n.payload,callback:_n.callback,next:null});e:{var _E=e,_v=_n;switch(_p=o,_f=s,_v.tag){case 1:if(_E=_v.payload,typeof _E=="function"){ba=_E.call(_f,ba,_p);break e}ba=_E;break e;case 3:_E.flags=_E.flags&-65537|128;case 0:if(_E=_v.payload,_p=typeof _E=="function"?_E.call(_f,ba,_p):_E,_p==null)break e;ba=A({},ba,_p);break e;case 2:$g=!0}}_n.callback!==null&&_n.lane!==0&&(e.flags|=64,_p=_.effects,_p===null?_.effects=[_n]:_p.push(_n))}else _f={eventTime:_f,lane:_p,tag:_n.tag,payload:_n.payload,callback:_n.callback,next:null},na===null?(_s=na=_f,_r=ba):na=na.next=_f,_e|=_p;if(_n=_n.next,_n===null){if(_n=_.shared.pending,_n===null)break;_p=_n,_n=_p.next,_p.next=null,_.lastBaseUpdate=_p,_.shared.pending=null}}while(!0);if(na===null&&(_r=ba),_.baseState=_r,_.firstBaseUpdate=_s,_.lastBaseUpdate=na,o=_.shared.interleaved,o!==null){_=o;do _e|=_.lane,_=_.next;while(_!==o)}else $===null&&(_.shared.lanes=0);hh|=_e,e.lanes=_e,e.memoizedState=ba}}function ih(e,o,s){if(e=o.effects,o.effects=null,e!==null)for(o=0;o<e.length;o++){var a=e[o],_=a.callback;if(_!==null){if(a.callback=null,a=s,typeof _!="function")throw Error(p(191,_));_.call(a)}}}var jh=new aa.Component().refs;function kh(e,o,s,a){o=e.memoizedState,s=s(a,o),s=s==null?o:A({},o,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var nh={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,o,s){e=e._reactInternals;var a=L(),_=lh(e),$=ch(a,_);$.payload=o,s!=null&&($.callback=s),o=dh(e,$,_),o!==null&&(mh(o,e,_,a),eh(o,e,_))},enqueueReplaceState:function(e,o,s){e=e._reactInternals;var a=L(),_=lh(e),$=ch(a,_);$.tag=1,$.payload=o,s!=null&&($.callback=s),o=dh(e,$,_),o!==null&&(mh(o,e,_,a),eh(o,e,_))},enqueueForceUpdate:function(e,o){e=e._reactInternals;var s=L(),a=lh(e),_=ch(s,a);_.tag=2,o!=null&&(_.callback=o),o=dh(e,_,a),o!==null&&(mh(o,e,a,s),eh(o,e,a))}};function oh(e,o,s,a,_,$,_e){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(a,$,_e):o.prototype&&o.prototype.isPureReactComponent?!Ie(s,a)||!Ie(_,$):!0}function ph(e,o,s){var a=!1,_=Vf,$=o.contextType;return typeof $=="object"&&$!==null?$=Vg($):(_=Zf(o)?Xf:H.current,a=o.contextTypes,$=(a=a!=null)?Yf(e,_):Vf),o=new o(s,$),e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=nh,e.stateNode=o,o._reactInternals=e,a&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=_,e.__reactInternalMemoizedMaskedChildContext=$),o}function qh(e,o,s,a){e=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(s,a),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(s,a),o.state!==e&&nh.enqueueReplaceState(o,o.state,null)}function rh(e,o,s,a){var _=e.stateNode;_.props=s,_.state=e.memoizedState,_.refs=jh,ah(e);var $=o.contextType;typeof $=="object"&&$!==null?_.context=Vg($):($=Zf(o)?Xf:H.current,_.context=Yf(e,$)),_.state=e.memoizedState,$=o.getDerivedStateFromProps,typeof $=="function"&&(kh(e,o,$,s),_.state=e.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(o=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),o!==_.state&&nh.enqueueReplaceState(_,_.state,null),gh(e,s,_,a),_.state=e.memoizedState),typeof _.componentDidMount=="function"&&(e.flags|=4194308)}function sh(e,o,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(p(309));var a=s.stateNode}if(!a)throw Error(p(147,e));var _=a,$=""+e;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===$?o.ref:(o=function(_e){var _n=_.refs;_n===jh&&(_n=_.refs={}),_e===null?delete _n[$]:_n[$]=_e},o._stringRef=$,o)}if(typeof e!="string")throw Error(p(284));if(!s._owner)throw Error(p(290,e))}return e}function th(e,o){throw e=Object.prototype.toString.call(o),Error(p(31,e==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":e))}function uh(e){var o=e._init;return o(e._payload)}function vh(e){function o(e_,t_){if(e){var o_=e_.deletions;o_===null?(e_.deletions=[t_],e_.flags|=16):o_.push(t_)}}function s(e_,t_){if(!e)return null;for(;t_!==null;)o(e_,t_),t_=t_.sibling;return null}function a(e_,t_){for(e_=new Map;t_!==null;)t_.key!==null?e_.set(t_.key,t_):e_.set(t_.index,t_),t_=t_.sibling;return e_}function _(e_,t_){return e_=wh(e_,t_),e_.index=0,e_.sibling=null,e_}function $(e_,t_,o_){return e_.index=o_,e?(o_=e_.alternate,o_!==null?(o_=o_.index,o_<t_?(e_.flags|=2,t_):o_):(e_.flags|=2,t_)):(e_.flags|=1048576,t_)}function _e(e_){return e&&e_.alternate===null&&(e_.flags|=2),e_}function _n(e_,t_,o_,m_){return t_===null||t_.tag!==6?(t_=xh(o_,e_.mode,m_),t_.return=e_,t_):(t_=_(t_,o_),t_.return=e_,t_)}function _r(e_,t_,o_,m_){var b_=o_.type;return b_===ya?na(e_,t_,o_.props.children,m_,o_.key):t_!==null&&(t_.elementType===b_||typeof b_=="object"&&b_!==null&&b_.$$typeof===Ha&&uh(b_)===t_.type)?(m_=_(t_,o_.props),m_.ref=sh(e_,t_,o_),m_.return=e_,m_):(m_=yh(o_.type,o_.key,o_.props,null,e_.mode,m_),m_.ref=sh(e_,t_,o_),m_.return=e_,m_)}function _s(e_,t_,o_,m_){return t_===null||t_.tag!==4||t_.stateNode.containerInfo!==o_.containerInfo||t_.stateNode.implementation!==o_.implementation?(t_=zh(o_,e_.mode,m_),t_.return=e_,t_):(t_=_(t_,o_.children||[]),t_.return=e_,t_)}function na(e_,t_,o_,m_,b_){return t_===null||t_.tag!==7?(t_=Ah(o_,e_.mode,m_,b_),t_.return=e_,t_):(t_=_(t_,o_),t_.return=e_,t_)}function ba(e_,t_,o_){if(typeof t_=="string"&&t_!==""||typeof t_=="number")return t_=xh(""+t_,e_.mode,o_),t_.return=e_,t_;if(typeof t_=="object"&&t_!==null){switch(t_.$$typeof){case va:return o_=yh(t_.type,t_.key,t_.props,null,e_.mode,o_),o_.ref=sh(e_,null,t_),o_.return=e_,o_;case wa:return t_=zh(t_,e_.mode,o_),t_.return=e_,t_;case Ha:var m_=t_._init;return ba(e_,m_(t_._payload),o_)}if(eb(t_)||Ka(t_))return t_=Ah(t_,e_.mode,o_,null),t_.return=e_,t_;th(e_,t_)}return null}function _p(e_,t_,o_,m_){var b_=t_!==null?t_.key:null;if(typeof o_=="string"&&o_!==""||typeof o_=="number")return b_!==null?null:_n(e_,t_,""+o_,m_);if(typeof o_=="object"&&o_!==null){switch(o_.$$typeof){case va:return o_.key===b_?_r(e_,t_,o_,m_):null;case wa:return o_.key===b_?_s(e_,t_,o_,m_):null;case Ha:return b_=o_._init,_p(e_,t_,b_(o_._payload),m_)}if(eb(o_)||Ka(o_))return b_!==null?null:na(e_,t_,o_,m_,null);th(e_,o_)}return null}function _f(e_,t_,o_,m_,b_){if(typeof m_=="string"&&m_!==""||typeof m_=="number")return e_=e_.get(o_)||null,_n(t_,e_,""+m_,b_);if(typeof m_=="object"&&m_!==null){switch(m_.$$typeof){case va:return e_=e_.get(m_.key===null?o_:m_.key)||null,_r(t_,e_,m_,b_);case wa:return e_=e_.get(m_.key===null?o_:m_.key)||null,_s(t_,e_,m_,b_);case Ha:var w_=m_._init;return _f(e_,t_,o_,w_(m_._payload),b_)}if(eb(m_)||Ka(m_))return e_=e_.get(o_)||null,na(t_,e_,m_,b_,null);th(t_,m_)}return null}function _E(e_,t_,o_,m_){for(var b_=null,w_=null,y_=t_,N_=t_=0,_y=null;y_!==null&&N_<o_.length;N_++){y_.index>N_?(_y=y_,y_=null):_y=y_.sibling;var v_=_p(e_,y_,o_[N_],m_);if(v_===null){y_===null&&(y_=_y);break}e&&y_&&v_.alternate===null&&o(e_,y_),t_=$(v_,t_,N_),w_===null?b_=v_:w_.sibling=v_,w_=v_,y_=_y}if(N_===o_.length)return s(e_,y_),I&&tg(e_,N_),b_;if(y_===null){for(;N_<o_.length;N_++)y_=ba(e_,o_[N_],m_),y_!==null&&(t_=$(y_,t_,N_),w_===null?b_=y_:w_.sibling=y_,w_=y_);return I&&tg(e_,N_),b_}for(y_=a(e_,y_);N_<o_.length;N_++)_y=_f(y_,e_,N_,o_[N_],m_),_y!==null&&(e&&_y.alternate!==null&&y_.delete(_y.key===null?N_:_y.key),t_=$(_y,t_,N_),w_===null?b_=_y:w_.sibling=_y,w_=_y);return e&&y_.forEach(function(A_){return o(e_,A_)}),I&&tg(e_,N_),b_}function _v(e_,t_,o_,m_){var b_=Ka(o_);if(typeof b_!="function")throw Error(p(150));if(o_=b_.call(o_),o_==null)throw Error(p(151));for(var w_=b_=null,y_=t_,N_=t_=0,_y=null,v_=o_.next();y_!==null&&!v_.done;N_++,v_=o_.next()){y_.index>N_?(_y=y_,y_=null):_y=y_.sibling;var A_=_p(e_,y_,v_.value,m_);if(A_===null){y_===null&&(y_=_y);break}e&&y_&&A_.alternate===null&&o(e_,y_),t_=$(A_,t_,N_),w_===null?b_=A_:w_.sibling=A_,w_=A_,y_=_y}if(v_.done)return s(e_,y_),I&&tg(e_,N_),b_;if(y_===null){for(;!v_.done;N_++,v_=o_.next())v_=ba(e_,v_.value,m_),v_!==null&&(t_=$(v_,t_,N_),w_===null?b_=v_:w_.sibling=v_,w_=v_);return I&&tg(e_,N_),b_}for(y_=a(e_,y_);!v_.done;N_++,v_=o_.next())v_=_f(y_,e_,N_,v_.value,m_),v_!==null&&(e&&v_.alternate!==null&&y_.delete(v_.key===null?N_:v_.key),t_=$(v_,t_,N_),w_===null?b_=v_:w_.sibling=v_,w_=v_);return e&&y_.forEach(function(k_){return o(e_,k_)}),I&&tg(e_,N_),b_}function n_(e_,t_,o_,m_){if(typeof o_=="object"&&o_!==null&&o_.type===ya&&o_.key===null&&(o_=o_.props.children),typeof o_=="object"&&o_!==null){switch(o_.$$typeof){case va:e:{for(var b_=o_.key,w_=t_;w_!==null;){if(w_.key===b_){if(b_=o_.type,b_===ya){if(w_.tag===7){s(e_,w_.sibling),t_=_(w_,o_.props.children),t_.return=e_,e_=t_;break e}}else if(w_.elementType===b_||typeof b_=="object"&&b_!==null&&b_.$$typeof===Ha&&uh(b_)===w_.type){s(e_,w_.sibling),t_=_(w_,o_.props),t_.ref=sh(e_,w_,o_),t_.return=e_,e_=t_;break e}s(e_,w_);break}else o(e_,w_);w_=w_.sibling}o_.type===ya?(t_=Ah(o_.props.children,e_.mode,m_,o_.key),t_.return=e_,e_=t_):(m_=yh(o_.type,o_.key,o_.props,null,e_.mode,m_),m_.ref=sh(e_,t_,o_),m_.return=e_,e_=m_)}return _e(e_);case wa:e:{for(w_=o_.key;t_!==null;){if(t_.key===w_)if(t_.tag===4&&t_.stateNode.containerInfo===o_.containerInfo&&t_.stateNode.implementation===o_.implementation){s(e_,t_.sibling),t_=_(t_,o_.children||[]),t_.return=e_,e_=t_;break e}else{s(e_,t_);break}else o(e_,t_);t_=t_.sibling}t_=zh(o_,e_.mode,m_),t_.return=e_,e_=t_}return _e(e_);case Ha:return w_=o_._init,n_(e_,t_,w_(o_._payload),m_)}if(eb(o_))return _E(e_,t_,o_,m_);if(Ka(o_))return _v(e_,t_,o_,m_);th(e_,o_)}return typeof o_=="string"&&o_!==""||typeof o_=="number"?(o_=""+o_,t_!==null&&t_.tag===6?(s(e_,t_.sibling),t_=_(t_,o_),t_.return=e_,e_=t_):(s(e_,t_),t_=xh(o_,e_.mode,m_),t_.return=e_,e_=t_),_e(e_)):s(e_,t_)}return n_}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(e){if(e===Dh)throw Error(p(174));return e}function Ih(e,o){switch(G(Gh,o),G(Fh,e),G(Eh,Dh),e=o.nodeType,e){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:lb(null,"");break;default:e=e===8?o.parentNode:o,o=e.namespaceURI||null,e=e.tagName,o=lb(o,e)}E(Eh),G(Eh,o)}function Jh(){E(Eh),E(Fh),E(Gh)}function Kh(e){Hh(Gh.current);var o=Hh(Eh.current),s=lb(o,e.type);o!==s&&(G(Fh,e),G(Eh,s))}function Lh(e){Fh.current===e&&(E(Eh),E(Fh))}var M=Uf(0);function Mh(e){for(var o=e;o!==null;){if(o.tag===13){var s=o.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Nh=[];function Oh(){for(var e=0;e<Nh.length;e++)Nh[e]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N=null,O=null,P=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q(){throw Error(p(321))}function Wh(e,o){if(o===null)return!1;for(var s=0;s<o.length&&s<e.length;s++)if(!He(e[s],o[s]))return!1;return!0}function Xh(e,o,s,a,_,$){if(Rh=$,N=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ph.current=e===null||e.memoizedState===null?Yh:Zh,e=s(a,_),Th){$=0;do{if(Th=!1,Uh=0,25<=$)throw Error(p(301));$+=1,P=O=null,o.updateQueue=null,Ph.current=$h,e=s(a,_)}while(Th)}if(Ph.current=ai,o=O!==null&&O.next!==null,Rh=0,P=O=N=null,Sh=!1,o)throw Error(p(300));return e}function bi(){var e=Uh!==0;return Uh=0,e}function ci(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P===null?N.memoizedState=P=e:P=P.next=e,P}function di(){if(O===null){var e=N.alternate;e=e!==null?e.memoizedState:null}else e=O.next;var o=P===null?N.memoizedState:P.next;if(o!==null)P=o,O=e;else{if(e===null)throw Error(p(310));O=e,e={memoizedState:O.memoizedState,baseState:O.baseState,baseQueue:O.baseQueue,queue:O.queue,next:null},P===null?N.memoizedState=P=e:P=P.next=e}return P}function ei(e,o){return typeof o=="function"?o(e):o}function fi(e){var o=di(),s=o.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var a=O,_=a.baseQueue,$=s.pending;if($!==null){if(_!==null){var _e=_.next;_.next=$.next,$.next=_e}a.baseQueue=_=$,s.pending=null}if(_!==null){$=_.next,a=a.baseState;var _n=_e=null,_r=null,_s=$;do{var na=_s.lane;if((Rh&na)===na)_r!==null&&(_r=_r.next={lane:0,action:_s.action,hasEagerState:_s.hasEagerState,eagerState:_s.eagerState,next:null}),a=_s.hasEagerState?_s.eagerState:e(a,_s.action);else{var ba={lane:na,action:_s.action,hasEagerState:_s.hasEagerState,eagerState:_s.eagerState,next:null};_r===null?(_n=_r=ba,_e=a):_r=_r.next=ba,N.lanes|=na,hh|=na}_s=_s.next}while(_s!==null&&_s!==$);_r===null?_e=a:_r.next=_n,He(a,o.memoizedState)||(Ug=!0),o.memoizedState=a,o.baseState=_e,o.baseQueue=_r,s.lastRenderedState=a}if(e=s.interleaved,e!==null){_=e;do $=_.lane,N.lanes|=$,hh|=$,_=_.next;while(_!==e)}else _===null&&(s.lanes=0);return[o.memoizedState,s.dispatch]}function gi(e){var o=di(),s=o.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var a=s.dispatch,_=s.pending,$=o.memoizedState;if(_!==null){s.pending=null;var _e=_=_.next;do $=e($,_e.action),_e=_e.next;while(_e!==_);He($,o.memoizedState)||(Ug=!0),o.memoizedState=$,o.baseQueue===null&&(o.baseState=$),s.lastRenderedState=$}return[$,a]}function hi(){}function ii(e,o){var s=N,a=di(),_=o(),$=!He(a.memoizedState,_);if($&&(a.memoizedState=_,Ug=!0),a=a.queue,ji(ki.bind(null,s,a,e),[e]),a.getSnapshot!==o||$||P!==null&&P.memoizedState.tag&1){if(s.flags|=2048,li(9,mi.bind(null,s,a,_,o),void 0,null),R===null)throw Error(p(349));Rh&30||ni(s,o,_)}return _}function ni(e,o,s){e.flags|=16384,e={getSnapshot:o,value:s},o=N.updateQueue,o===null?(o={lastEffect:null,stores:null},N.updateQueue=o,o.stores=[e]):(s=o.stores,s===null?o.stores=[e]:s.push(e))}function mi(e,o,s,a){o.value=s,o.getSnapshot=a,oi(o)&&pi(e)}function ki(e,o,s){return s(function(){oi(o)&&pi(e)})}function oi(e){var o=e.getSnapshot;e=e.value;try{var s=o();return!He(e,s)}catch{return!0}}function pi(e){var o=Zg(e,1);o!==null&&mh(o,e,1,-1)}function qi(e){var o=ci();return typeof e=="function"&&(e=e()),o.memoizedState=o.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:e},o.queue=e,e=e.dispatch=ri.bind(null,N,e),[o.memoizedState,e]}function li(e,o,s,a){return e={tag:e,create:o,destroy:s,deps:a,next:null},o=N.updateQueue,o===null?(o={lastEffect:null,stores:null},N.updateQueue=o,o.lastEffect=e.next=e):(s=o.lastEffect,s===null?o.lastEffect=e.next=e:(a=s.next,s.next=e,e.next=a,o.lastEffect=e)),e}function si(){return di().memoizedState}function ti(e,o,s,a){var _=ci();N.flags|=e,_.memoizedState=li(1|o,s,void 0,a===void 0?null:a)}function ui(e,o,s,a){var _=di();a=a===void 0?null:a;var $=void 0;if(O!==null){var _e=O.memoizedState;if($=_e.destroy,a!==null&&Wh(a,_e.deps)){_.memoizedState=li(o,s,$,a);return}}N.flags|=e,_.memoizedState=li(1|o,s,$,a)}function vi(e,o){return ti(8390656,8,e,o)}function ji(e,o){return ui(2048,8,e,o)}function wi(e,o){return ui(4,2,e,o)}function xi(e,o){return ui(4,4,e,o)}function yi(e,o){if(typeof o=="function")return e=e(),o(e),function(){o(null)};if(o!=null)return e=e(),o.current=e,function(){o.current=null}}function zi(e,o,s){return s=s!=null?s.concat([e]):null,ui(4,4,yi.bind(null,o,e),s)}function Ai(){}function Bi(e,o){var s=di();o=o===void 0?null:o;var a=s.memoizedState;return a!==null&&o!==null&&Wh(o,a[1])?a[0]:(s.memoizedState=[e,o],e)}function Ci(e,o){var s=di();o=o===void 0?null:o;var a=s.memoizedState;return a!==null&&o!==null&&Wh(o,a[1])?a[0]:(e=e(),s.memoizedState=[e,o],e)}function Di(e,o,s){return Rh&21?(He(s,o)||(s=yc(),N.lanes|=s,hh|=s,e.baseState=!0),o):(e.baseState&&(e.baseState=!1,Ug=!0),e.memoizedState=s)}function Ei(e,o){var s=C;C=s!==0&&4>s?s:4,e(!0);var a=Qh.transition;Qh.transition={};try{e(!1),o()}finally{C=s,Qh.transition=a}}function Fi(){return di().memoizedState}function Gi(e,o,s){var a=lh(e);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},Hi(e))Ii(o,s);else if(s=Yg(e,o,s,a),s!==null){var _=L();mh(s,e,a,_),Ji(s,o,a)}}function ri(e,o,s){var a=lh(e),_={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if(Hi(e))Ii(o,_);else{var $=e.alternate;if(e.lanes===0&&($===null||$.lanes===0)&&($=o.lastRenderedReducer,$!==null))try{var _e=o.lastRenderedState,_n=$(_e,s);if(_.hasEagerState=!0,_.eagerState=_n,He(_n,_e)){var _r=o.interleaved;_r===null?(_.next=_,Xg(o)):(_.next=_r.next,_r.next=_),o.interleaved=_;return}}catch{}finally{}s=Yg(e,o,_,a),s!==null&&(_=L(),mh(s,e,a,_),Ji(s,o,a))}}function Hi(e){var o=e.alternate;return e===N||o!==null&&o===N}function Ii(e,o){Th=Sh=!0;var s=e.pending;s===null?o.next=o:(o.next=s.next,s.next=o),e.pending=o}function Ji(e,o,s){if(s&4194240){var a=o.lanes;a&=e.pendingLanes,s|=a,o.lanes=s,Cc(e,s)}}var ai={readContext:Vg,useCallback:Q,useContext:Q,useEffect:Q,useImperativeHandle:Q,useInsertionEffect:Q,useLayoutEffect:Q,useMemo:Q,useReducer:Q,useRef:Q,useState:Q,useDebugValue:Q,useDeferredValue:Q,useTransition:Q,useMutableSource:Q,useSyncExternalStore:Q,useId:Q,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(e,o){return ci().memoizedState=[e,o===void 0?null:o],e},useContext:Vg,useEffect:vi,useImperativeHandle:function(e,o,s){return s=s!=null?s.concat([e]):null,ti(4194308,4,yi.bind(null,o,e),s)},useLayoutEffect:function(e,o){return ti(4194308,4,e,o)},useInsertionEffect:function(e,o){return ti(4,2,e,o)},useMemo:function(e,o){var s=ci();return o=o===void 0?null:o,e=e(),s.memoizedState=[e,o],e},useReducer:function(e,o,s){var a=ci();return o=s!==void 0?s(o):o,a.memoizedState=a.baseState=o,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:o},a.queue=e,e=e.dispatch=Gi.bind(null,N,e),[a.memoizedState,e]},useRef:function(e){var o=ci();return e={current:e},o.memoizedState=e},useState:qi,useDebugValue:Ai,useDeferredValue:function(e){return ci().memoizedState=e},useTransition:function(){var e=qi(!1),o=e[0];return e=Ei.bind(null,e[1]),ci().memoizedState=e,[o,e]},useMutableSource:function(){},useSyncExternalStore:function(e,o,s){var a=N,_=ci();if(I){if(s===void 0)throw Error(p(407));s=s()}else{if(s=o(),R===null)throw Error(p(349));Rh&30||ni(a,o,s)}_.memoizedState=s;var $={value:s,getSnapshot:o};return _.queue=$,vi(ki.bind(null,a,$,e),[e]),a.flags|=2048,li(9,mi.bind(null,a,$,s,o),void 0,null),s},useId:function(){var e=ci(),o=R.identifierPrefix;if(I){var s=sg,a=rg;s=(a&~(1<<32-oc(a)-1)).toString(32)+s,o=":"+o+"R"+s,s=Uh++,0<s&&(o+="H"+s.toString(32)),o+=":"}else s=Vh++,o=":"+o+"r"+s.toString(32)+":";return e.memoizedState=o},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(e){var o=di();return Di(o,O.memoizedState,e)},useTransition:function(){var e=fi(ei)[0],o=di().memoizedState;return[e,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(e){var o=di();return O===null?o.memoizedState=e:Di(o,O.memoizedState,e)},useTransition:function(){var e=gi(ei)[0],o=di().memoizedState;return[e,o]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(e,o){try{var s="",a=o;do s+=Pa(a),a=a.return;while(a);var _=s}catch($){_=`
Error generating stack: `+$.message+`
`+$.stack}return{value:e,source:o,stack:_,digest:null}}function Li(e,o,s){return{value:e,source:null,stack:s??null,digest:o??null}}function Mi(e,o){try{console.error(o.value)}catch(s){setTimeout(function(){throw s})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(e,o,s){s=ch(-1,s),s.tag=3,s.payload={element:null};var a=o.value;return s.callback=function(){Pi||(Pi=!0,Qi=a),Mi(e,o)},s}function Ri(e,o,s){s=ch(-1,s),s.tag=3;var a=e.type.getDerivedStateFromError;if(typeof a=="function"){var _=o.value;s.payload=function(){return a(_)},s.callback=function(){Mi(e,o)}}var $=e.stateNode;return $!==null&&typeof $.componentDidCatch=="function"&&(s.callback=function(){Mi(e,o),typeof a!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var _e=o.stack;this.componentDidCatch(o.value,{componentStack:_e!==null?_e:""})}),s}function Ti(e,o,s){var a=e.pingCache;if(a===null){a=e.pingCache=new Ni;var _=new Set;a.set(o,_)}else _=a.get(o),_===void 0&&(_=new Set,a.set(o,_));_.has(s)||(_.add(s),e=Ui.bind(null,e,o,s),o.then(e,e))}function Vi(e){do{var o;if((o=e.tag===13)&&(o=e.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return e;e=e.return}while(e!==null);return null}function Wi(e,o,s,a,_){return e.mode&1?(e.flags|=65536,e.lanes=_,e):(e===o?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(o=ch(-1,1),o.tag=2,dh(s,o,1))),s.lanes|=1),e)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(e,o,s,a){o.child=e===null?Ch(o,null,s,a):Bh(o,e.child,s,a)}function Zi(e,o,s,a,_){s=s.render;var $=o.ref;return Tg(o,_),a=Xh(e,o,s,a,$,_),s=bi(),e!==null&&!Ug?(o.updateQueue=e.updateQueue,o.flags&=-2053,e.lanes&=~_,$i(e,o,_)):(I&&s&&vg(o),o.flags|=1,Yi(e,o,a,_),o.child)}function aj(e,o,s,a,_){if(e===null){var $=s.type;return typeof $=="function"&&!bj($)&&$.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(o.tag=15,o.type=$,cj(e,o,$,a,_)):(e=yh(s.type,null,a,o,o.mode,_),e.ref=o.ref,e.return=o,o.child=e)}if($=e.child,!(e.lanes&_)){var _e=$.memoizedProps;if(s=s.compare,s=s!==null?s:Ie,s(_e,a)&&e.ref===o.ref)return $i(e,o,_)}return o.flags|=1,e=wh($,a),e.ref=o.ref,e.return=o,o.child=e}function cj(e,o,s,a,_){if(e!==null){var $=e.memoizedProps;if(Ie($,a)&&e.ref===o.ref)if(Ug=!1,o.pendingProps=a=$,(e.lanes&_)!==0)e.flags&131072&&(Ug=!0);else return o.lanes=e.lanes,$i(e,o,_)}return dj(e,o,s,a,_)}function ej(e,o,s){var a=o.pendingProps,_=a.children,$=e!==null?e.memoizedState:null;if(a.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(fj,gj),gj|=s;else{if(!(s&1073741824))return e=$!==null?$.baseLanes|s:s,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:e,cachePool:null,transitions:null},o.updateQueue=null,G(fj,gj),gj|=e,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=$!==null?$.baseLanes:s,G(fj,gj),gj|=a}else $!==null?(a=$.baseLanes|s,o.memoizedState=null):a=s,G(fj,gj),gj|=a;return Yi(e,o,_,s),o.child}function hj(e,o){var s=o.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(o.flags|=512,o.flags|=2097152)}function dj(e,o,s,a,_){var $=Zf(s)?Xf:H.current;return $=Yf(o,$),Tg(o,_),s=Xh(e,o,s,a,$,_),a=bi(),e!==null&&!Ug?(o.updateQueue=e.updateQueue,o.flags&=-2053,e.lanes&=~_,$i(e,o,_)):(I&&a&&vg(o),o.flags|=1,Yi(e,o,s,_),o.child)}function ij(e,o,s,a,_){if(Zf(s)){var $=!0;cg(o)}else $=!1;if(Tg(o,_),o.stateNode===null)jj(e,o),ph(o,s,a),rh(o,s,a,_),a=!0;else if(e===null){var _e=o.stateNode,_n=o.memoizedProps;_e.props=_n;var _r=_e.context,_s=s.contextType;typeof _s=="object"&&_s!==null?_s=Vg(_s):(_s=Zf(s)?Xf:H.current,_s=Yf(o,_s));var na=s.getDerivedStateFromProps,ba=typeof na=="function"||typeof _e.getSnapshotBeforeUpdate=="function";ba||typeof _e.UNSAFE_componentWillReceiveProps!="function"&&typeof _e.componentWillReceiveProps!="function"||(_n!==a||_r!==_s)&&qh(o,_e,a,_s),$g=!1;var _p=o.memoizedState;_e.state=_p,gh(o,a,_e,_),_r=o.memoizedState,_n!==a||_p!==_r||Wf.current||$g?(typeof na=="function"&&(kh(o,s,na,a),_r=o.memoizedState),(_n=$g||oh(o,s,_n,a,_p,_r,_s))?(ba||typeof _e.UNSAFE_componentWillMount!="function"&&typeof _e.componentWillMount!="function"||(typeof _e.componentWillMount=="function"&&_e.componentWillMount(),typeof _e.UNSAFE_componentWillMount=="function"&&_e.UNSAFE_componentWillMount()),typeof _e.componentDidMount=="function"&&(o.flags|=4194308)):(typeof _e.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=a,o.memoizedState=_r),_e.props=a,_e.state=_r,_e.context=_s,a=_n):(typeof _e.componentDidMount=="function"&&(o.flags|=4194308),a=!1)}else{_e=o.stateNode,bh(e,o),_n=o.memoizedProps,_s=o.type===o.elementType?_n:Lg(o.type,_n),_e.props=_s,ba=o.pendingProps,_p=_e.context,_r=s.contextType,typeof _r=="object"&&_r!==null?_r=Vg(_r):(_r=Zf(s)?Xf:H.current,_r=Yf(o,_r));var _f=s.getDerivedStateFromProps;(na=typeof _f=="function"||typeof _e.getSnapshotBeforeUpdate=="function")||typeof _e.UNSAFE_componentWillReceiveProps!="function"&&typeof _e.componentWillReceiveProps!="function"||(_n!==ba||_p!==_r)&&qh(o,_e,a,_r),$g=!1,_p=o.memoizedState,_e.state=_p,gh(o,a,_e,_);var _E=o.memoizedState;_n!==ba||_p!==_E||Wf.current||$g?(typeof _f=="function"&&(kh(o,s,_f,a),_E=o.memoizedState),(_s=$g||oh(o,s,_s,a,_p,_E,_r)||!1)?(na||typeof _e.UNSAFE_componentWillUpdate!="function"&&typeof _e.componentWillUpdate!="function"||(typeof _e.componentWillUpdate=="function"&&_e.componentWillUpdate(a,_E,_r),typeof _e.UNSAFE_componentWillUpdate=="function"&&_e.UNSAFE_componentWillUpdate(a,_E,_r)),typeof _e.componentDidUpdate=="function"&&(o.flags|=4),typeof _e.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof _e.componentDidUpdate!="function"||_n===e.memoizedProps&&_p===e.memoizedState||(o.flags|=4),typeof _e.getSnapshotBeforeUpdate!="function"||_n===e.memoizedProps&&_p===e.memoizedState||(o.flags|=1024),o.memoizedProps=a,o.memoizedState=_E),_e.props=a,_e.state=_E,_e.context=_r,a=_s):(typeof _e.componentDidUpdate!="function"||_n===e.memoizedProps&&_p===e.memoizedState||(o.flags|=4),typeof _e.getSnapshotBeforeUpdate!="function"||_n===e.memoizedProps&&_p===e.memoizedState||(o.flags|=1024),a=!1)}return kj(e,o,s,a,$,_)}function kj(e,o,s,a,_,$){hj(e,o);var _e=(o.flags&128)!==0;if(!a&&!_e)return _&&dg(o,s,!1),$i(e,o,$);a=o.stateNode,Xi.current=o;var _n=_e&&typeof s.getDerivedStateFromError!="function"?null:a.render();return o.flags|=1,e!==null&&_e?(o.child=Bh(o,e.child,null,$),o.child=Bh(o,null,_n,$)):Yi(e,o,_n,$),o.memoizedState=a.state,_&&dg(o,s,!0),o.child}function lj(e){var o=e.stateNode;o.pendingContext?ag(e,o.pendingContext,o.pendingContext!==o.context):o.context&&ag(e,o.context,!1),Ih(e,o.containerInfo)}function mj(e,o,s,a,_){return Ig(),Jg(_),o.flags|=256,Yi(e,o,s,a),o.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(e){return{baseLanes:e,cachePool:null,transitions:null}}function pj(e,o,s){var a=o.pendingProps,_=M.current,$=!1,_e=(o.flags&128)!==0,_n;if((_n=_e)||(_n=e!==null&&e.memoizedState===null?!1:(_&2)!==0),_n?($=!0,o.flags&=-129):(e===null||e.memoizedState!==null)&&(_|=1),G(M,_&1),e===null)return Eg(o),e=o.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(o.mode&1?e.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(_e=a.children,e=a.fallback,$?(a=o.mode,$=o.child,_e={mode:"hidden",children:_e},!(a&1)&&$!==null?($.childLanes=0,$.pendingProps=_e):$=qj(_e,a,0,null),e=Ah(e,a,s,null),$.return=o,e.return=o,$.sibling=e,o.child=$,o.child.memoizedState=oj(s),o.memoizedState=nj,e):rj(o,_e));if(_=e.memoizedState,_!==null&&(_n=_.dehydrated,_n!==null))return sj(e,o,_e,a,_n,_,s);if($){$=a.fallback,_e=o.mode,_=e.child,_n=_.sibling;var _r={mode:"hidden",children:a.children};return!(_e&1)&&o.child!==_?(a=o.child,a.childLanes=0,a.pendingProps=_r,o.deletions=null):(a=wh(_,_r),a.subtreeFlags=_.subtreeFlags&14680064),_n!==null?$=wh(_n,$):($=Ah($,_e,s,null),$.flags|=2),$.return=o,a.return=o,a.sibling=$,o.child=a,a=$,$=o.child,_e=e.child.memoizedState,_e=_e===null?oj(s):{baseLanes:_e.baseLanes|s,cachePool:null,transitions:_e.transitions},$.memoizedState=_e,$.childLanes=e.childLanes&~s,o.memoizedState=nj,a}return $=e.child,e=$.sibling,a=wh($,{mode:"visible",children:a.children}),!(o.mode&1)&&(a.lanes=s),a.return=o,a.sibling=null,e!==null&&(s=o.deletions,s===null?(o.deletions=[e],o.flags|=16):s.push(e)),o.child=a,o.memoizedState=null,a}function rj(e,o){return o=qj({mode:"visible",children:o},e.mode,0,null),o.return=e,e.child=o}function tj(e,o,s,a){return a!==null&&Jg(a),Bh(o,e.child,null,s),e=rj(o,o.pendingProps.children),e.flags|=2,o.memoizedState=null,e}function sj(e,o,s,a,_,$,_e){if(s)return o.flags&256?(o.flags&=-257,a=Li(Error(p(422))),tj(e,o,_e,a)):o.memoizedState!==null?(o.child=e.child,o.flags|=128,null):($=a.fallback,_=o.mode,a=qj({mode:"visible",children:a.children},_,0,null),$=Ah($,_,_e,null),$.flags|=2,a.return=o,$.return=o,a.sibling=$,o.child=a,o.mode&1&&Bh(o,e.child,null,_e),o.child.memoizedState=oj(_e),o.memoizedState=nj,$);if(!(o.mode&1))return tj(e,o,_e,null);if(_.data==="$!"){if(a=_.nextSibling&&_.nextSibling.dataset,a)var _n=a.dgst;return a=_n,$=Error(p(419)),a=Li($,a,void 0),tj(e,o,_e,a)}if(_n=(_e&e.childLanes)!==0,Ug||_n){if(a=R,a!==null){switch(_e&-_e){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(a.suspendedLanes|_e)?0:_,_!==0&&_!==$.retryLane&&($.retryLane=_,Zg(e,_),mh(a,e,_,-1))}return uj(),a=Li(Error(p(421))),tj(e,o,_e,a)}return _.data==="$?"?(o.flags|=128,o.child=e.child,o=vj.bind(null,e),_._reactRetry=o,null):(e=$.treeContext,yg=Lf(_.nextSibling),xg=o,I=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=o),o=rj(o,a.children),o.flags|=4096,o)}function wj(e,o,s){e.lanes|=o;var a=e.alternate;a!==null&&(a.lanes|=o),Sg(e.return,o,s)}function xj(e,o,s,a,_){var $=e.memoizedState;$===null?e.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:_}:($.isBackwards=o,$.rendering=null,$.renderingStartTime=0,$.last=a,$.tail=s,$.tailMode=_)}function yj(e,o,s){var a=o.pendingProps,_=a.revealOrder,$=a.tail;if(Yi(e,o,a.children,s),a=M.current,a&2)a=a&1|2,o.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=o.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&wj(e,s,o);else if(e.tag===19)wj(e,s,o);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===o)break e;for(;e.sibling===null;){if(e.return===null||e.return===o)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(G(M,a),!(o.mode&1))o.memoizedState=null;else switch(_){case"forwards":for(s=o.child,_=null;s!==null;)e=s.alternate,e!==null&&Mh(e)===null&&(_=s),s=s.sibling;s=_,s===null?(_=o.child,o.child=null):(_=s.sibling,s.sibling=null),xj(o,!1,_,s,$);break;case"backwards":for(s=null,_=o.child,o.child=null;_!==null;){if(e=_.alternate,e!==null&&Mh(e)===null){o.child=_;break}e=_.sibling,_.sibling=s,s=_,_=e}xj(o,!0,s,null,$);break;case"together":xj(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function jj(e,o){!(o.mode&1)&&e!==null&&(e.alternate=null,o.alternate=null,o.flags|=2)}function $i(e,o,s){if(e!==null&&(o.dependencies=e.dependencies),hh|=o.lanes,!(s&o.childLanes))return null;if(e!==null&&o.child!==e.child)throw Error(p(153));if(o.child!==null){for(e=o.child,s=wh(e,e.pendingProps),o.child=s,s.return=o;e.sibling!==null;)e=e.sibling,s=s.sibling=wh(e,e.pendingProps),s.return=o;s.sibling=null}return o.child}function zj(e,o,s){switch(o.tag){case 3:lj(o),Ig();break;case 5:Kh(o);break;case 1:Zf(o.type)&&cg(o);break;case 4:Ih(o,o.stateNode.containerInfo);break;case 10:var a=o.type._context,_=o.memoizedProps.value;G(Mg,a._currentValue),a._currentValue=_;break;case 13:if(a=o.memoizedState,a!==null)return a.dehydrated!==null?(G(M,M.current&1),o.flags|=128,null):s&o.child.childLanes?pj(e,o,s):(G(M,M.current&1),e=$i(e,o,s),e!==null?e.sibling:null);G(M,M.current&1);break;case 19:if(a=(s&o.childLanes)!==0,e.flags&128){if(a)return yj(e,o,s);o.flags|=128}if(_=o.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),G(M,M.current),a)break;return null;case 22:case 23:return o.lanes=0,ej(e,o,s)}return $i(e,o,s)}var Aj,Bj,Cj,Dj;Aj=function(e,o){for(var s=o.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break;for(;s.sibling===null;){if(s.return===null||s.return===o)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Bj=function(){};Cj=function(e,o,s,a){var _=e.memoizedProps;if(_!==a){e=o.stateNode,Hh(Eh.current);var $=null;switch(s){case"input":_=Ya(e,_),a=Ya(e,a),$=[];break;case"select":_=A({},_,{value:void 0}),a=A({},a,{value:void 0}),$=[];break;case"textarea":_=gb(e,_),a=gb(e,a),$=[];break;default:typeof _.onClick!="function"&&typeof a.onClick=="function"&&(e.onclick=Bf)}ub(s,a);var _e;s=null;for(_s in _)if(!a.hasOwnProperty(_s)&&_.hasOwnProperty(_s)&&_[_s]!=null)if(_s==="style"){var _n=_[_s];for(_e in _n)_n.hasOwnProperty(_e)&&(s||(s={}),s[_e]="")}else _s!=="dangerouslySetInnerHTML"&&_s!=="children"&&_s!=="suppressContentEditableWarning"&&_s!=="suppressHydrationWarning"&&_s!=="autoFocus"&&(ea.hasOwnProperty(_s)?$||($=[]):($=$||[]).push(_s,null));for(_s in a){var _r=a[_s];if(_n=_!=null?_[_s]:void 0,a.hasOwnProperty(_s)&&_r!==_n&&(_r!=null||_n!=null))if(_s==="style")if(_n){for(_e in _n)!_n.hasOwnProperty(_e)||_r&&_r.hasOwnProperty(_e)||(s||(s={}),s[_e]="");for(_e in _r)_r.hasOwnProperty(_e)&&_n[_e]!==_r[_e]&&(s||(s={}),s[_e]=_r[_e])}else s||($||($=[]),$.push(_s,s)),s=_r;else _s==="dangerouslySetInnerHTML"?(_r=_r?_r.__html:void 0,_n=_n?_n.__html:void 0,_r!=null&&_n!==_r&&($=$||[]).push(_s,_r)):_s==="children"?typeof _r!="string"&&typeof _r!="number"||($=$||[]).push(_s,""+_r):_s!=="suppressContentEditableWarning"&&_s!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_s)?(_r!=null&&_s==="onScroll"&&D("scroll",e),$||_n===_r||($=[])):($=$||[]).push(_s,_r))}s&&($=$||[]).push("style",s);var _s=$;(o.updateQueue=_s)&&(o.flags|=4)}};Dj=function(e,o,s,a){s!==a&&(o.flags|=4)};function Ej(e,o){if(!I)switch(e.tailMode){case"hidden":o=e.tail;for(var s=null;o!==null;)o.alternate!==null&&(s=o),o=o.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var a=null;s!==null;)s.alternate!==null&&(a=s),s=s.sibling;a===null?o||e.tail===null?e.tail=null:e.tail.sibling=null:a.sibling=null}}function S(e){var o=e.alternate!==null&&e.alternate.child===e.child,s=0,a=0;if(o)for(var _=e.child;_!==null;)s|=_.lanes|_.childLanes,a|=_.subtreeFlags&14680064,a|=_.flags&14680064,_.return=e,_=_.sibling;else for(_=e.child;_!==null;)s|=_.lanes|_.childLanes,a|=_.subtreeFlags,a|=_.flags,_.return=e,_=_.sibling;return e.subtreeFlags|=a,e.childLanes=s,o}function Fj(e,o,s){var a=o.pendingProps;switch(wg(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(o),null;case 1:return Zf(o.type)&&$f(),S(o),null;case 3:return a=o.stateNode,Jh(),E(Wf),E(H),Oh(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),(e===null||e.child===null)&&(Gg(o)?o.flags|=4:e===null||e.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(e,o),S(o),null;case 5:Lh(o);var _=Hh(Gh.current);if(s=o.type,e!==null&&o.stateNode!=null)Cj(e,o,s,a,_),e.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!a){if(o.stateNode===null)throw Error(p(166));return S(o),null}if(e=Hh(Eh.current),Gg(o)){a=o.stateNode,s=o.type;var $=o.memoizedProps;switch(a[Of]=o,a[Pf]=$,e=(o.mode&1)!==0,s){case"dialog":D("cancel",a),D("close",a);break;case"iframe":case"object":case"embed":D("load",a);break;case"video":case"audio":for(_=0;_<lf.length;_++)D(lf[_],a);break;case"source":D("error",a);break;case"img":case"image":case"link":D("error",a),D("load",a);break;case"details":D("toggle",a);break;case"input":Za(a,$),D("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!$.multiple},D("invalid",a);break;case"textarea":hb(a,$),D("invalid",a)}ub(s,$),_=null;for(var _e in $)if($.hasOwnProperty(_e)){var _n=$[_e];_e==="children"?typeof _n=="string"?a.textContent!==_n&&($.suppressHydrationWarning!==!0&&Af(a.textContent,_n,e),_=["children",_n]):typeof _n=="number"&&a.textContent!==""+_n&&($.suppressHydrationWarning!==!0&&Af(a.textContent,_n,e),_=["children",""+_n]):ea.hasOwnProperty(_e)&&_n!=null&&_e==="onScroll"&&D("scroll",a)}switch(s){case"input":Va(a),db(a,$,!0);break;case"textarea":Va(a),jb(a);break;case"select":case"option":break;default:typeof $.onClick=="function"&&(a.onclick=Bf)}a=_,o.updateQueue=a,a!==null&&(o.flags|=4)}else{_e=_.nodeType===9?_:_.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=_e.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof a.is=="string"?e=_e.createElement(s,{is:a.is}):(e=_e.createElement(s),s==="select"&&(_e=e,a.multiple?_e.multiple=!0:a.size&&(_e.size=a.size))):e=_e.createElementNS(e,s),e[Of]=o,e[Pf]=a,Aj(e,o,!1,!1),o.stateNode=e;e:{switch(_e=vb(s,a),s){case"dialog":D("cancel",e),D("close",e),_=a;break;case"iframe":case"object":case"embed":D("load",e),_=a;break;case"video":case"audio":for(_=0;_<lf.length;_++)D(lf[_],e);_=a;break;case"source":D("error",e),_=a;break;case"img":case"image":case"link":D("error",e),D("load",e),_=a;break;case"details":D("toggle",e),_=a;break;case"input":Za(e,a),_=Ya(e,a),D("invalid",e);break;case"option":_=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},_=A({},a,{value:void 0}),D("invalid",e);break;case"textarea":hb(e,a),_=gb(e,a),D("invalid",e);break;default:_=a}ub(s,_),_n=_;for($ in _n)if(_n.hasOwnProperty($)){var _r=_n[$];$==="style"?sb(e,_r):$==="dangerouslySetInnerHTML"?(_r=_r?_r.__html:void 0,_r!=null&&nb(e,_r)):$==="children"?typeof _r=="string"?(s!=="textarea"||_r!=="")&&ob(e,_r):typeof _r=="number"&&ob(e,""+_r):$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&$!=="autoFocus"&&(ea.hasOwnProperty($)?_r!=null&&$==="onScroll"&&D("scroll",e):_r!=null&&ta(e,$,_r,_e))}switch(s){case"input":Va(e),db(e,a,!1);break;case"textarea":Va(e),jb(e);break;case"option":a.value!=null&&e.setAttribute("value",""+Sa(a.value));break;case"select":e.multiple=!!a.multiple,$=a.value,$!=null?fb(e,!!a.multiple,$,!1):a.defaultValue!=null&&fb(e,!!a.multiple,a.defaultValue,!0);break;default:typeof _.onClick=="function"&&(e.onclick=Bf)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return S(o),null;case 6:if(e&&o.stateNode!=null)Dj(e,o,e.memoizedProps,a);else{if(typeof a!="string"&&o.stateNode===null)throw Error(p(166));if(s=Hh(Gh.current),Hh(Eh.current),Gg(o)){if(a=o.stateNode,s=o.memoizedProps,a[Of]=o,($=a.nodeValue!==s)&&(e=xg,e!==null))switch(e.tag){case 3:Af(a.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(a.nodeValue,s,(e.mode&1)!==0)}$&&(o.flags|=4)}else a=(s.nodeType===9?s:s.ownerDocument).createTextNode(a),a[Of]=o,o.stateNode=a}return S(o),null;case 13:if(E(M),a=o.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&o.mode&1&&!(o.flags&128))Hg(),Ig(),o.flags|=98560,$=!1;else if($=Gg(o),a!==null&&a.dehydrated!==null){if(e===null){if(!$)throw Error(p(318));if($=o.memoizedState,$=$!==null?$.dehydrated:null,!$)throw Error(p(317));$[Of]=o}else Ig(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;S(o),$=!1}else zg!==null&&(Gj(zg),zg=null),$=!0;if(!$)return o.flags&65536?o:null}return o.flags&128?(o.lanes=s,o):(a=a!==null,a!==(e!==null&&e.memoizedState!==null)&&a&&(o.child.flags|=8192,o.mode&1&&(e===null||M.current&1?T===0&&(T=3):uj())),o.updateQueue!==null&&(o.flags|=4),S(o),null);case 4:return Jh(),Bj(e,o),e===null&&sf(o.stateNode.containerInfo),S(o),null;case 10:return Rg(o.type._context),S(o),null;case 17:return Zf(o.type)&&$f(),S(o),null;case 19:if(E(M),$=o.memoizedState,$===null)return S(o),null;if(a=(o.flags&128)!==0,_e=$.rendering,_e===null)if(a)Ej($,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=o.child;e!==null;){if(_e=Mh(e),_e!==null){for(o.flags|=128,Ej($,!1),a=_e.updateQueue,a!==null&&(o.updateQueue=a,o.flags|=4),o.subtreeFlags=0,a=s,s=o.child;s!==null;)$=s,e=a,$.flags&=14680066,_e=$.alternate,_e===null?($.childLanes=0,$.lanes=e,$.child=null,$.subtreeFlags=0,$.memoizedProps=null,$.memoizedState=null,$.updateQueue=null,$.dependencies=null,$.stateNode=null):($.childLanes=_e.childLanes,$.lanes=_e.lanes,$.child=_e.child,$.subtreeFlags=0,$.deletions=null,$.memoizedProps=_e.memoizedProps,$.memoizedState=_e.memoizedState,$.updateQueue=_e.updateQueue,$.type=_e.type,e=_e.dependencies,$.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return G(M,M.current&1|2),o.child}e=e.sibling}$.tail!==null&&B()>Hj&&(o.flags|=128,a=!0,Ej($,!1),o.lanes=4194304)}else{if(!a)if(e=Mh(_e),e!==null){if(o.flags|=128,a=!0,s=e.updateQueue,s!==null&&(o.updateQueue=s,o.flags|=4),Ej($,!0),$.tail===null&&$.tailMode==="hidden"&&!_e.alternate&&!I)return S(o),null}else 2*B()-$.renderingStartTime>Hj&&s!==1073741824&&(o.flags|=128,a=!0,Ej($,!1),o.lanes=4194304);$.isBackwards?(_e.sibling=o.child,o.child=_e):(s=$.last,s!==null?s.sibling=_e:o.child=_e,$.last=_e)}return $.tail!==null?(o=$.tail,$.rendering=o,$.tail=o.sibling,$.renderingStartTime=B(),o.sibling=null,s=M.current,G(M,a?s&1|2:s&1),o):(S(o),null);case 22:case 23:return Ij(),a=o.memoizedState!==null,e!==null&&e.memoizedState!==null!==a&&(o.flags|=8192),a&&o.mode&1?gj&1073741824&&(S(o),o.subtreeFlags&6&&(o.flags|=8192)):S(o),null;case 24:return null;case 25:return null}throw Error(p(156,o.tag))}function Jj(e,o){switch(wg(o),o.tag){case 1:return Zf(o.type)&&$f(),e=o.flags,e&65536?(o.flags=e&-65537|128,o):null;case 3:return Jh(),E(Wf),E(H),Oh(),e=o.flags,e&65536&&!(e&128)?(o.flags=e&-65537|128,o):null;case 5:return Lh(o),null;case 13:if(E(M),e=o.memoizedState,e!==null&&e.dehydrated!==null){if(o.alternate===null)throw Error(p(340));Ig()}return e=o.flags,e&65536?(o.flags=e&-65537|128,o):null;case 19:return E(M),null;case 4:return Jh(),null;case 10:return Rg(o.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Mj(e,o){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(a){W(e,o,a)}else s.current=null}function Nj(e,o,s){try{s()}catch(a){W(e,o,a)}}var Oj=!1;function Pj(e,o){if(Cf=dd,e=Me(),Ne(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var a=s.getSelection&&s.getSelection();if(a&&a.rangeCount!==0){s=a.anchorNode;var _=a.anchorOffset,$=a.focusNode;a=a.focusOffset;try{s.nodeType,$.nodeType}catch{s=null;break e}var _e=0,_n=-1,_r=-1,_s=0,na=0,ba=e,_p=null;t:for(;;){for(var _f;ba!==s||_!==0&&ba.nodeType!==3||(_n=_e+_),ba!==$||a!==0&&ba.nodeType!==3||(_r=_e+a),ba.nodeType===3&&(_e+=ba.nodeValue.length),(_f=ba.firstChild)!==null;)_p=ba,ba=_f;for(;;){if(ba===e)break t;if(_p===s&&++_s===_&&(_n=_e),_p===$&&++na===a&&(_r=_e),(_f=ba.nextSibling)!==null)break;ba=_p,_p=ba.parentNode}ba=_f}s=_n===-1||_r===-1?null:{start:_n,end:_r}}else s=null}s=s||{start:0,end:0}}else s=null;for(Df={focusedElem:e,selectionRange:s},dd=!1,V=o;V!==null;)if(o=V,e=o.child,(o.subtreeFlags&1028)!==0&&e!==null)e.return=o,V=e;else for(;V!==null;){o=V;try{var _E=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(_E!==null){var _v=_E.memoizedProps,n_=_E.memoizedState,e_=o.stateNode,t_=e_.getSnapshotBeforeUpdate(o.elementType===o.type?_v:Lg(o.type,_v),n_);e_.__reactInternalSnapshotBeforeUpdate=t_}break;case 3:var o_=o.stateNode.containerInfo;o_.nodeType===1?o_.textContent="":o_.nodeType===9&&o_.documentElement&&o_.removeChild(o_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(m_){W(o,o.return,m_)}if(e=o.sibling,e!==null){e.return=o.return,V=e;break}V=o.return}return _E=Oj,Oj=!1,_E}function Qj(e,o,s){var a=o.updateQueue;if(a=a!==null?a.lastEffect:null,a!==null){var _=a=a.next;do{if((_.tag&e)===e){var $=_.destroy;_.destroy=void 0,$!==void 0&&Nj(o,s,$)}_=_.next}while(_!==a)}}function Rj(e,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var s=o=o.next;do{if((s.tag&e)===e){var a=s.create;s.destroy=a()}s=s.next}while(s!==o)}}function Sj(e){var o=e.ref;if(o!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof o=="function"?o(e):o.current=e}}function Tj(e){var o=e.alternate;o!==null&&(e.alternate=null,Tj(o)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(o=e.stateNode,o!==null&&(delete o[Of],delete o[Pf],delete o[of],delete o[Qf],delete o[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Uj(e){return e.tag===5||e.tag===3||e.tag===4}function Vj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Uj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wj(e,o,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,o?s.nodeType===8?s.parentNode.insertBefore(e,o):s.insertBefore(e,o):(s.nodeType===8?(o=s.parentNode,o.insertBefore(e,s)):(o=s,o.appendChild(e)),s=s._reactRootContainer,s!=null||o.onclick!==null||(o.onclick=Bf));else if(a!==4&&(e=e.child,e!==null))for(Wj(e,o,s),e=e.sibling;e!==null;)Wj(e,o,s),e=e.sibling}function Xj(e,o,s){var a=e.tag;if(a===5||a===6)e=e.stateNode,o?s.insertBefore(e,o):s.appendChild(e);else if(a!==4&&(e=e.child,e!==null))for(Xj(e,o,s),e=e.sibling;e!==null;)Xj(e,o,s),e=e.sibling}var X=null,Yj=!1;function Zj(e,o,s){for(s=s.child;s!==null;)ak(e,o,s),s=s.sibling}function ak(e,o,s){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,s)}catch{}switch(s.tag){case 5:U||Mj(s,o);case 6:var a=X,_=Yj;X=null,Zj(e,o,s),X=a,Yj=_,X!==null&&(Yj?(e=X,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):X.removeChild(s.stateNode));break;case 18:X!==null&&(Yj?(e=X,s=s.stateNode,e.nodeType===8?Kf(e.parentNode,s):e.nodeType===1&&Kf(e,s),bd(e)):Kf(X,s.stateNode));break;case 4:a=X,_=Yj,X=s.stateNode.containerInfo,Yj=!0,Zj(e,o,s),X=a,Yj=_;break;case 0:case 11:case 14:case 15:if(!U&&(a=s.updateQueue,a!==null&&(a=a.lastEffect,a!==null))){_=a=a.next;do{var $=_,_e=$.destroy;$=$.tag,_e!==void 0&&($&2||$&4)&&Nj(s,o,_e),_=_.next}while(_!==a)}Zj(e,o,s);break;case 1:if(!U&&(Mj(s,o),a=s.stateNode,typeof a.componentWillUnmount=="function"))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(_n){W(s,o,_n)}Zj(e,o,s);break;case 21:Zj(e,o,s);break;case 22:s.mode&1?(U=(a=U)||s.memoizedState!==null,Zj(e,o,s),U=a):Zj(e,o,s);break;default:Zj(e,o,s)}}function bk(e){var o=e.updateQueue;if(o!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new Lj),o.forEach(function(a){var _=ck.bind(null,e,a);s.has(a)||(s.add(a),a.then(_,_))})}}function dk(e,o){var s=o.deletions;if(s!==null)for(var a=0;a<s.length;a++){var _=s[a];try{var $=e,_e=o,_n=_e;e:for(;_n!==null;){switch(_n.tag){case 5:X=_n.stateNode,Yj=!1;break e;case 3:X=_n.stateNode.containerInfo,Yj=!0;break e;case 4:X=_n.stateNode.containerInfo,Yj=!0;break e}_n=_n.return}if(X===null)throw Error(p(160));ak($,_e,_),X=null,Yj=!1;var _r=_.alternate;_r!==null&&(_r.return=null),_.return=null}catch(_s){W(_,o,_s)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)ek(o,e),o=o.sibling}function ek(e,o){var s=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(dk(o,e),fk(e),a&4){try{Qj(3,e,e.return),Rj(3,e)}catch(_v){W(e,e.return,_v)}try{Qj(5,e,e.return)}catch(_v){W(e,e.return,_v)}}break;case 1:dk(o,e),fk(e),a&512&&s!==null&&Mj(s,s.return);break;case 5:if(dk(o,e),fk(e),a&512&&s!==null&&Mj(s,s.return),e.flags&32){var _=e.stateNode;try{ob(_,"")}catch(_v){W(e,e.return,_v)}}if(a&4&&(_=e.stateNode,_!=null)){var $=e.memoizedProps,_e=s!==null?s.memoizedProps:$,_n=e.type,_r=e.updateQueue;if(e.updateQueue=null,_r!==null)try{_n==="input"&&$.type==="radio"&&$.name!=null&&ab(_,$),vb(_n,_e);var _s=vb(_n,$);for(_e=0;_e<_r.length;_e+=2){var na=_r[_e],ba=_r[_e+1];na==="style"?sb(_,ba):na==="dangerouslySetInnerHTML"?nb(_,ba):na==="children"?ob(_,ba):ta(_,na,ba,_s)}switch(_n){case"input":bb(_,$);break;case"textarea":ib(_,$);break;case"select":var _p=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!$.multiple;var _f=$.value;_f!=null?fb(_,!!$.multiple,_f,!1):_p!==!!$.multiple&&($.defaultValue!=null?fb(_,!!$.multiple,$.defaultValue,!0):fb(_,!!$.multiple,$.multiple?[]:"",!1))}_[Pf]=$}catch(_v){W(e,e.return,_v)}}break;case 6:if(dk(o,e),fk(e),a&4){if(e.stateNode===null)throw Error(p(162));_=e.stateNode,$=e.memoizedProps;try{_.nodeValue=$}catch(_v){W(e,e.return,_v)}}break;case 3:if(dk(o,e),fk(e),a&4&&s!==null&&s.memoizedState.isDehydrated)try{bd(o.containerInfo)}catch(_v){W(e,e.return,_v)}break;case 4:dk(o,e),fk(e);break;case 13:dk(o,e),fk(e),_=e.child,_.flags&8192&&($=_.memoizedState!==null,_.stateNode.isHidden=$,!$||_.alternate!==null&&_.alternate.memoizedState!==null||(gk=B())),a&4&&bk(e);break;case 22:if(na=s!==null&&s.memoizedState!==null,e.mode&1?(U=(_s=U)||na,dk(o,e),U=_s):dk(o,e),fk(e),a&8192){if(_s=e.memoizedState!==null,(e.stateNode.isHidden=_s)&&!na&&e.mode&1)for(V=e,na=e.child;na!==null;){for(ba=V=na;V!==null;){switch(_p=V,_f=_p.child,_p.tag){case 0:case 11:case 14:case 15:Qj(4,_p,_p.return);break;case 1:Mj(_p,_p.return);var _E=_p.stateNode;if(typeof _E.componentWillUnmount=="function"){a=_p,s=_p.return;try{o=a,_E.props=o.memoizedProps,_E.state=o.memoizedState,_E.componentWillUnmount()}catch(_v){W(a,s,_v)}}break;case 5:Mj(_p,_p.return);break;case 22:if(_p.memoizedState!==null){hk(ba);continue}}_f!==null?(_f.return=_p,V=_f):hk(ba)}na=na.sibling}e:for(na=null,ba=e;;){if(ba.tag===5){if(na===null){na=ba;try{_=ba.stateNode,_s?($=_.style,typeof $.setProperty=="function"?$.setProperty("display","none","important"):$.display="none"):(_n=ba.stateNode,_r=ba.memoizedProps.style,_e=_r!=null&&_r.hasOwnProperty("display")?_r.display:null,_n.style.display=rb("display",_e))}catch(_v){W(e,e.return,_v)}}}else if(ba.tag===6){if(na===null)try{ba.stateNode.nodeValue=_s?"":ba.memoizedProps}catch(_v){W(e,e.return,_v)}}else if((ba.tag!==22&&ba.tag!==23||ba.memoizedState===null||ba===e)&&ba.child!==null){ba.child.return=ba,ba=ba.child;continue}if(ba===e)break e;for(;ba.sibling===null;){if(ba.return===null||ba.return===e)break e;na===ba&&(na=null),ba=ba.return}na===ba&&(na=null),ba.sibling.return=ba.return,ba=ba.sibling}}break;case 19:dk(o,e),fk(e),a&4&&bk(e);break;case 21:break;default:dk(o,e),fk(e)}}function fk(e){var o=e.flags;if(o&2){try{e:{for(var s=e.return;s!==null;){if(Uj(s)){var a=s;break e}s=s.return}throw Error(p(160))}switch(a.tag){case 5:var _=a.stateNode;a.flags&32&&(ob(_,""),a.flags&=-33);var $=Vj(e);Xj(e,$,_);break;case 3:case 4:var _e=a.stateNode.containerInfo,_n=Vj(e);Wj(e,_n,_e);break;default:throw Error(p(161))}}catch(_r){W(e,e.return,_r)}e.flags&=-3}o&4096&&(e.flags&=-4097)}function ik(e,o,s){V=e,jk(e)}function jk(e,o,s){for(var a=(e.mode&1)!==0;V!==null;){var _=V,$=_.child;if(_.tag===22&&a){var _e=_.memoizedState!==null||Kj;if(!_e){var _n=_.alternate,_r=_n!==null&&_n.memoizedState!==null||U;_n=Kj;var _s=U;if(Kj=_e,(U=_r)&&!_s)for(V=_;V!==null;)_e=V,_r=_e.child,_e.tag===22&&_e.memoizedState!==null?kk(_):_r!==null?(_r.return=_e,V=_r):kk(_);for(;$!==null;)V=$,jk($),$=$.sibling;V=_,Kj=_n,U=_s}lk(e)}else _.subtreeFlags&8772&&$!==null?($.return=_,V=$):lk(e)}}function lk(e){for(;V!==null;){var o=V;if(o.flags&8772){var s=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:U||Rj(5,o);break;case 1:var a=o.stateNode;if(o.flags&4&&!U)if(s===null)a.componentDidMount();else{var _=o.elementType===o.type?s.memoizedProps:Lg(o.type,s.memoizedProps);a.componentDidUpdate(_,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var $=o.updateQueue;$!==null&&ih(o,$,a);break;case 3:var _e=o.updateQueue;if(_e!==null){if(s=null,o.child!==null)switch(o.child.tag){case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}ih(o,_e,s)}break;case 5:var _n=o.stateNode;if(s===null&&o.flags&4){s=_n;var _r=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":_r.autoFocus&&s.focus();break;case"img":_r.src&&(s.src=_r.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var _s=o.alternate;if(_s!==null){var na=_s.memoizedState;if(na!==null){var ba=na.dehydrated;ba!==null&&bd(ba)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||o.flags&512&&Sj(o)}catch(_p){W(o,o.return,_p)}}if(o===e){V=null;break}if(s=o.sibling,s!==null){s.return=o.return,V=s;break}V=o.return}}function hk(e){for(;V!==null;){var o=V;if(o===e){V=null;break}var s=o.sibling;if(s!==null){s.return=o.return,V=s;break}V=o.return}}function kk(e){for(;V!==null;){var o=V;try{switch(o.tag){case 0:case 11:case 15:var s=o.return;try{Rj(4,o)}catch(_r){W(o,s,_r)}break;case 1:var a=o.stateNode;if(typeof a.componentDidMount=="function"){var _=o.return;try{a.componentDidMount()}catch(_r){W(o,_,_r)}}var $=o.return;try{Sj(o)}catch(_r){W(o,$,_r)}break;case 5:var _e=o.return;try{Sj(o)}catch(_r){W(o,_e,_r)}}}catch(_r){W(o,o.return,_r)}if(o===e){V=null;break}var _n=o.sibling;if(_n!==null){_n.return=o.return,V=_n;break}V=o.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K=0,R=null,Y=null,Z=0,gj=0,fj=Uf(0),T=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L(){return K&6?B():Bk!==-1?Bk:Bk=B()}function lh(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function mh(e,o,s,a){if(50<zk)throw zk=0,Ak=null,Error(p(185));Ac(e,s,a),(!(K&2)||e!==R)&&(e===R&&(!(K&2)&&(rk|=s),T===4&&Dk(e,Z)),Ek(e,a),s===1&&K===0&&!(o.mode&1)&&(Hj=B()+500,fg&&jg()))}function Ek(e,o){var s=e.callbackNode;wc(e,o);var a=uc(e,e===R?Z:0);if(a===0)s!==null&&bc(s),e.callbackNode=null,e.callbackPriority=0;else if(o=a&-a,e.callbackPriority!==o){if(s!=null&&bc(s),o===1)e.tag===0?ig(Fk.bind(null,e)):hg(Fk.bind(null,e)),Jf(function(){!(K&6)&&jg()}),s=null;else{switch(Dc(a)){case 1:s=fc;break;case 4:s=gc;break;case 16:s=hc;break;case 536870912:s=jc;break;default:s=hc}s=Gk(s,Hk.bind(null,e))}e.callbackPriority=o,e.callbackNode=s}}function Hk(e,o){if(Bk=-1,Ck=0,K&6)throw Error(p(327));var s=e.callbackNode;if(Ik()&&e.callbackNode!==s)return null;var a=uc(e,e===R?Z:0);if(a===0)return null;if(a&30||a&e.expiredLanes||o)o=Jk(e,a);else{o=a;var _=K;K|=2;var $=Kk();(R!==e||Z!==o)&&(vk=null,Hj=B()+500,Lk(e,o));do try{Mk();break}catch(_n){Nk(e,_n)}while(!0);Qg(),nk.current=$,K=_,Y!==null?o=0:(R=null,Z=0,o=T)}if(o!==0){if(o===2&&(_=xc(e),_!==0&&(a=_,o=Ok(e,_))),o===1)throw s=qk,Lk(e,0),Dk(e,a),Ek(e,B()),s;if(o===6)Dk(e,a);else{if(_=e.current.alternate,!(a&30)&&!Pk(_)&&(o=Jk(e,a),o===2&&($=xc(e),$!==0&&(a=$,o=Ok(e,$))),o===1))throw s=qk,Lk(e,0),Dk(e,a),Ek(e,B()),s;switch(e.finishedWork=_,e.finishedLanes=a,o){case 0:case 1:throw Error(p(345));case 2:Qk(e,uk,vk);break;case 3:if(Dk(e,a),(a&130023424)===a&&(o=gk+500-B(),10<o)){if(uc(e,0)!==0)break;if(_=e.suspendedLanes,(_&a)!==a){L(),e.pingedLanes|=e.suspendedLanes&_;break}e.timeoutHandle=Ff(Qk.bind(null,e,uk,vk),o);break}Qk(e,uk,vk);break;case 4:if(Dk(e,a),(a&4194240)===a)break;for(o=e.eventTimes,_=-1;0<a;){var _e=31-oc(a);$=1<<_e,_e=o[_e],_e>_&&(_=_e),a&=~$}if(a=_,a=B()-a,a=(120>a?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*mk(a/1960))-a,10<a){e.timeoutHandle=Ff(Qk.bind(null,e,uk,vk),a);break}Qk(e,uk,vk);break;case 5:Qk(e,uk,vk);break;default:throw Error(p(329))}}}return Ek(e,B()),e.callbackNode===s?Hk.bind(null,e):null}function Ok(e,o){var s=tk;return e.current.memoizedState.isDehydrated&&(Lk(e,o).flags|=256),e=Jk(e,o),e!==2&&(o=uk,uk=s,o!==null&&Gj(o)),e}function Gj(e){uk===null?uk=e:uk.push.apply(uk,e)}function Pk(e){for(var o=e;;){if(o.flags&16384){var s=o.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var a=0;a<s.length;a++){var _=s[a],$=_.getSnapshot;_=_.value;try{if(!He($(),_))return!1}catch{return!1}}}if(s=o.child,o.subtreeFlags&16384&&s!==null)s.return=o,o=s;else{if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Dk(e,o){for(o&=~sk,o&=~rk,e.suspendedLanes|=o,e.pingedLanes&=~o,e=e.expirationTimes;0<o;){var s=31-oc(o),a=1<<s;e[s]=-1,o&=~a}}function Fk(e){if(K&6)throw Error(p(327));Ik();var o=uc(e,0);if(!(o&1))return Ek(e,B()),null;var s=Jk(e,o);if(e.tag!==0&&s===2){var a=xc(e);a!==0&&(o=a,s=Ok(e,a))}if(s===1)throw s=qk,Lk(e,0),Dk(e,o),Ek(e,B()),s;if(s===6)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=o,Qk(e,uk,vk),Ek(e,B()),null}function Rk(e,o){var s=K;K|=1;try{return e(o)}finally{K=s,K===0&&(Hj=B()+500,fg&&jg())}}function Sk(e){xk!==null&&xk.tag===0&&!(K&6)&&Ik();var o=K;K|=1;var s=pk.transition,a=C;try{if(pk.transition=null,C=1,e)return e()}finally{C=a,pk.transition=s,K=o,!(K&6)&&jg()}}function Ij(){gj=fj.current,E(fj)}function Lk(e,o){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,Gf(s)),Y!==null)for(s=Y.return;s!==null;){var a=s;switch(wg(a),a.tag){case 1:a=a.type.childContextTypes,a!=null&&$f();break;case 3:Jh(),E(Wf),E(H),Oh();break;case 5:Lh(a);break;case 4:Jh();break;case 13:E(M);break;case 19:E(M);break;case 10:Rg(a.type._context);break;case 22:case 23:Ij()}s=s.return}if(R=e,Y=e=wh(e.current,null),Z=gj=o,T=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(o=0;o<Wg.length;o++)if(s=Wg[o],a=s.interleaved,a!==null){s.interleaved=null;var _=a.next,$=s.pending;if($!==null){var _e=$.next;$.next=_,a.next=_e}s.pending=a}Wg=null}return e}function Nk(e,o){do{var s=Y;try{if(Qg(),Ph.current=ai,Sh){for(var a=N.memoizedState;a!==null;){var _=a.queue;_!==null&&(_.pending=null),a=a.next}Sh=!1}if(Rh=0,P=O=N=null,Th=!1,Uh=0,ok.current=null,s===null||s.return===null){T=1,qk=o,Y=null;break}e:{var $=e,_e=s.return,_n=s,_r=o;if(o=Z,_n.flags|=32768,_r!==null&&typeof _r=="object"&&typeof _r.then=="function"){var _s=_r,na=_n,ba=na.tag;if(!(na.mode&1)&&(ba===0||ba===11||ba===15)){var _p=na.alternate;_p?(na.updateQueue=_p.updateQueue,na.memoizedState=_p.memoizedState,na.lanes=_p.lanes):(na.updateQueue=null,na.memoizedState=null)}var _f=Vi(_e);if(_f!==null){_f.flags&=-257,Wi(_f,_e,_n,$,o),_f.mode&1&&Ti($,_s,o),o=_f,_r=_s;var _E=o.updateQueue;if(_E===null){var _v=new Set;_v.add(_r),o.updateQueue=_v}else _E.add(_r);break e}else{if(!(o&1)){Ti($,_s,o),uj();break e}_r=Error(p(426))}}else if(I&&_n.mode&1){var n_=Vi(_e);if(n_!==null){!(n_.flags&65536)&&(n_.flags|=256),Wi(n_,_e,_n,$,o),Jg(Ki(_r,_n));break e}}$=_r=Ki(_r,_n),T!==4&&(T=2),tk===null?tk=[$]:tk.push($),$=_e;do{switch($.tag){case 3:$.flags|=65536,o&=-o,$.lanes|=o;var e_=Oi($,_r,o);fh($,e_);break e;case 1:_n=_r;var t_=$.type,o_=$.stateNode;if(!($.flags&128)&&(typeof t_.getDerivedStateFromError=="function"||o_!==null&&typeof o_.componentDidCatch=="function"&&(Si===null||!Si.has(o_)))){$.flags|=65536,o&=-o,$.lanes|=o;var m_=Ri($,_n,o);fh($,m_);break e}}$=$.return}while($!==null)}Tk(s)}catch(b_){o=b_,Y===s&&s!==null&&(Y=s=s.return);continue}break}while(!0)}function Kk(){var e=nk.current;return nk.current=ai,e===null?ai:e}function uj(){(T===0||T===3||T===2)&&(T=4),R===null||!(hh&268435455)&&!(rk&268435455)||Dk(R,Z)}function Jk(e,o){var s=K;K|=2;var a=Kk();(R!==e||Z!==o)&&(vk=null,Lk(e,o));do try{Uk();break}catch(_){Nk(e,_)}while(!0);if(Qg(),K=s,nk.current=a,Y!==null)throw Error(p(261));return R=null,Z=0,T}function Uk(){for(;Y!==null;)Vk(Y)}function Mk(){for(;Y!==null&&!cc();)Vk(Y)}function Vk(e){var o=Wk(e.alternate,e,gj);e.memoizedProps=e.pendingProps,o===null?Tk(e):Y=o,ok.current=null}function Tk(e){var o=e;do{var s=o.alternate;if(e=o.return,o.flags&32768){if(s=Jj(s,o),s!==null){s.flags&=32767,Y=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y=null;return}}else if(s=Fj(s,o,gj),s!==null){Y=s;return}if(o=o.sibling,o!==null){Y=o;return}Y=o=e}while(o!==null);T===0&&(T=5)}function Qk(e,o,s){var a=C,_=pk.transition;try{pk.transition=null,C=1,Xk(e,o,s,a)}finally{pk.transition=_,C=a}return null}function Xk(e,o,s,a){do Ik();while(xk!==null);if(K&6)throw Error(p(327));s=e.finishedWork;var _=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var $=s.lanes|s.childLanes;if(Bc(e,$),e===R&&(Y=R=null,Z=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),$=(s.flags&15990)!==0,s.subtreeFlags&15990||$){$=pk.transition,pk.transition=null;var _e=C;C=1;var _n=K;K|=4,ok.current=null,Pj(e,s),ek(s,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=s,ik(s),dc(),K=_n,C=_e,pk.transition=$}else e.current=s;if(wk&&(wk=!1,xk=e,yk=_),$=e.pendingLanes,$===0&&(Si=null),mc(s.stateNode),Ek(e,B()),o!==null)for(a=e.onRecoverableError,s=0;s<o.length;s++)_=o[s],a(_.value,{componentStack:_.stack,digest:_.digest});if(Pi)throw Pi=!1,e=Qi,Qi=null,e;return yk&1&&e.tag!==0&&Ik(),$=e.pendingLanes,$&1?e===Ak?zk++:(zk=0,Ak=e):zk=0,jg(),null}function Ik(){if(xk!==null){var e=Dc(yk),o=pk.transition,s=C;try{if(pk.transition=null,C=16>e?16:e,xk===null)var a=!1;else{if(e=xk,xk=null,yk=0,K&6)throw Error(p(331));var _=K;for(K|=4,V=e.current;V!==null;){var $=V,_e=$.child;if(V.flags&16){var _n=$.deletions;if(_n!==null){for(var _r=0;_r<_n.length;_r++){var _s=_n[_r];for(V=_s;V!==null;){var na=V;switch(na.tag){case 0:case 11:case 15:Qj(8,na,$)}var ba=na.child;if(ba!==null)ba.return=na,V=ba;else for(;V!==null;){na=V;var _p=na.sibling,_f=na.return;if(Tj(na),na===_s){V=null;break}if(_p!==null){_p.return=_f,V=_p;break}V=_f}}}var _E=$.alternate;if(_E!==null){var _v=_E.child;if(_v!==null){_E.child=null;do{var n_=_v.sibling;_v.sibling=null,_v=n_}while(_v!==null)}}V=$}}if($.subtreeFlags&2064&&_e!==null)_e.return=$,V=_e;else e:for(;V!==null;){if($=V,$.flags&2048)switch($.tag){case 0:case 11:case 15:Qj(9,$,$.return)}var e_=$.sibling;if(e_!==null){e_.return=$.return,V=e_;break e}V=$.return}}var t_=e.current;for(V=t_;V!==null;){_e=V;var o_=_e.child;if(_e.subtreeFlags&2064&&o_!==null)o_.return=_e,V=o_;else e:for(_e=t_;V!==null;){if(_n=V,_n.flags&2048)try{switch(_n.tag){case 0:case 11:case 15:Rj(9,_n)}}catch(b_){W(_n,_n.return,b_)}if(_n===_e){V=null;break e}var m_=_n.sibling;if(m_!==null){m_.return=_n.return,V=m_;break e}V=_n.return}}if(K=_,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,e)}catch{}a=!0}return a}finally{C=s,pk.transition=o}}return!1}function Yk(e,o,s){o=Ki(s,o),o=Oi(e,o,1),e=dh(e,o,1),o=L(),e!==null&&(Ac(e,1,o),Ek(e,o))}function W(e,o,s){if(e.tag===3)Yk(e,e,s);else for(;o!==null;){if(o.tag===3){Yk(o,e,s);break}else if(o.tag===1){var a=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof a.componentDidCatch=="function"&&(Si===null||!Si.has(a))){e=Ki(s,e),e=Ri(o,e,1),o=dh(o,e,1),e=L(),o!==null&&(Ac(o,1,e),Ek(o,e));break}}o=o.return}}function Ui(e,o,s){var a=e.pingCache;a!==null&&a.delete(o),o=L(),e.pingedLanes|=e.suspendedLanes&s,R===e&&(Z&s)===s&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-gk?Lk(e,0):sk|=s),Ek(e,o)}function Zk(e,o){o===0&&(e.mode&1?(o=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):o=1);var s=L();e=Zg(e,o),e!==null&&(Ac(e,o,s),Ek(e,s))}function vj(e){var o=e.memoizedState,s=0;o!==null&&(s=o.retryLane),Zk(e,s)}function ck(e,o){var s=0;switch(e.tag){case 13:var a=e.stateNode,_=e.memoizedState;_!==null&&(s=_.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(p(314))}a!==null&&a.delete(o),Zk(e,s)}var Wk;Wk=function(e,o,s){if(e!==null)if(e.memoizedProps!==o.pendingProps||Wf.current)Ug=!0;else{if(!(e.lanes&s)&&!(o.flags&128))return Ug=!1,zj(e,o,s);Ug=!!(e.flags&131072)}else Ug=!1,I&&o.flags&1048576&&ug(o,ng,o.index);switch(o.lanes=0,o.tag){case 2:var a=o.type;jj(e,o),e=o.pendingProps;var _=Yf(o,H.current);Tg(o,s),_=Xh(null,o,a,e,_,s);var $=bi();return o.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Zf(a)?($=!0,cg(o)):$=!1,o.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,ah(o),_.updater=nh,o.stateNode=_,_._reactInternals=o,rh(o,a,e,s),o=kj(null,o,a,!0,$,s)):(o.tag=0,I&&$&&vg(o),Yi(null,o,_,s),o=o.child),o;case 16:a=o.elementType;e:{switch(jj(e,o),e=o.pendingProps,_=a._init,a=_(a._payload),o.type=a,_=o.tag=$k(a),e=Lg(a,e),_){case 0:o=dj(null,o,a,e,s);break e;case 1:o=ij(null,o,a,e,s);break e;case 11:o=Zi(null,o,a,e,s);break e;case 14:o=aj(null,o,a,Lg(a.type,e),s);break e}throw Error(p(306,a,""))}return o;case 0:return a=o.type,_=o.pendingProps,_=o.elementType===a?_:Lg(a,_),dj(e,o,a,_,s);case 1:return a=o.type,_=o.pendingProps,_=o.elementType===a?_:Lg(a,_),ij(e,o,a,_,s);case 3:e:{if(lj(o),e===null)throw Error(p(387));a=o.pendingProps,$=o.memoizedState,_=$.element,bh(e,o),gh(o,a,null,s);var _e=o.memoizedState;if(a=_e.element,$.isDehydrated)if($={element:a,isDehydrated:!1,cache:_e.cache,pendingSuspenseBoundaries:_e.pendingSuspenseBoundaries,transitions:_e.transitions},o.updateQueue.baseState=$,o.memoizedState=$,o.flags&256){_=Ki(Error(p(423)),o),o=mj(e,o,a,s,_);break e}else if(a!==_){_=Ki(Error(p(424)),o),o=mj(e,o,a,s,_);break e}else for(yg=Lf(o.stateNode.containerInfo.firstChild),xg=o,I=!0,zg=null,s=Ch(o,null,a,s),o.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Ig(),a===_){o=$i(e,o,s);break e}Yi(e,o,a,s)}o=o.child}return o;case 5:return Kh(o),e===null&&Eg(o),a=o.type,_=o.pendingProps,$=e!==null?e.memoizedProps:null,_e=_.children,Ef(a,_)?_e=null:$!==null&&Ef(a,$)&&(o.flags|=32),hj(e,o),Yi(e,o,_e,s),o.child;case 6:return e===null&&Eg(o),null;case 13:return pj(e,o,s);case 4:return Ih(o,o.stateNode.containerInfo),a=o.pendingProps,e===null?o.child=Bh(o,null,a,s):Yi(e,o,a,s),o.child;case 11:return a=o.type,_=o.pendingProps,_=o.elementType===a?_:Lg(a,_),Zi(e,o,a,_,s);case 7:return Yi(e,o,o.pendingProps,s),o.child;case 8:return Yi(e,o,o.pendingProps.children,s),o.child;case 12:return Yi(e,o,o.pendingProps.children,s),o.child;case 10:e:{if(a=o.type._context,_=o.pendingProps,$=o.memoizedProps,_e=_.value,G(Mg,a._currentValue),a._currentValue=_e,$!==null)if(He($.value,_e)){if($.children===_.children&&!Wf.current){o=$i(e,o,s);break e}}else for($=o.child,$!==null&&($.return=o);$!==null;){var _n=$.dependencies;if(_n!==null){_e=$.child;for(var _r=_n.firstContext;_r!==null;){if(_r.context===a){if($.tag===1){_r=ch(-1,s&-s),_r.tag=2;var _s=$.updateQueue;if(_s!==null){_s=_s.shared;var na=_s.pending;na===null?_r.next=_r:(_r.next=na.next,na.next=_r),_s.pending=_r}}$.lanes|=s,_r=$.alternate,_r!==null&&(_r.lanes|=s),Sg($.return,s,o),_n.lanes|=s;break}_r=_r.next}}else if($.tag===10)_e=$.type===o.type?null:$.child;else if($.tag===18){if(_e=$.return,_e===null)throw Error(p(341));_e.lanes|=s,_n=_e.alternate,_n!==null&&(_n.lanes|=s),Sg(_e,s,o),_e=$.sibling}else _e=$.child;if(_e!==null)_e.return=$;else for(_e=$;_e!==null;){if(_e===o){_e=null;break}if($=_e.sibling,$!==null){$.return=_e.return,_e=$;break}_e=_e.return}$=_e}Yi(e,o,_.children,s),o=o.child}return o;case 9:return _=o.type,a=o.pendingProps.children,Tg(o,s),_=Vg(_),a=a(_),o.flags|=1,Yi(e,o,a,s),o.child;case 14:return a=o.type,_=Lg(a,o.pendingProps),_=Lg(a.type,_),aj(e,o,a,_,s);case 15:return cj(e,o,o.type,o.pendingProps,s);case 17:return a=o.type,_=o.pendingProps,_=o.elementType===a?_:Lg(a,_),jj(e,o),o.tag=1,Zf(a)?(e=!0,cg(o)):e=!1,Tg(o,s),ph(o,a,_),rh(o,a,_,s),kj(null,o,a,!0,e,s);case 19:return yj(e,o,s);case 22:return ej(e,o,s)}throw Error(p(156,o.tag))};function Gk(e,o){return ac(e,o)}function al(e,o,s,a){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,o,s,a){return new al(e,o,s,a)}function bj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function $k(e){if(typeof e=="function")return bj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function wh(e,o){var s=e.alternate;return s===null?(s=Bg(e.tag,o,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=o,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,o=e.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function yh(e,o,s,a,_,$){var _e=2;if(a=e,typeof e=="function")bj(e)&&(_e=1);else if(typeof e=="string")_e=5;else e:switch(e){case ya:return Ah(s.children,_,$,o);case za:_e=8,_|=8;break;case Aa:return e=Bg(12,s,o,_|2),e.elementType=Aa,e.lanes=$,e;case Ea:return e=Bg(13,s,o,_),e.elementType=Ea,e.lanes=$,e;case Fa:return e=Bg(19,s,o,_),e.elementType=Fa,e.lanes=$,e;case Ia:return qj(s,_,$,o);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:_e=10;break e;case Ca:_e=9;break e;case Da:_e=11;break e;case Ga:_e=14;break e;case Ha:_e=16,a=null;break e}throw Error(p(130,e==null?e:typeof e,""))}return o=Bg(_e,s,o,_),o.elementType=e,o.type=a,o.lanes=$,o}function Ah(e,o,s,a){return e=Bg(7,e,a,o),e.lanes=s,e}function qj(e,o,s,a){return e=Bg(22,e,a,o),e.elementType=Ia,e.lanes=s,e.stateNode={isHidden:!1},e}function xh(e,o,s){return e=Bg(6,e,null,o),e.lanes=s,e}function zh(e,o,s){return o=Bg(4,e.children!==null?e.children:[],e.key,o),o.lanes=s,o.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},o}function bl(e,o,s,a,_){this.tag=o,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=a,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function cl(e,o,s,a,_,$,_e,_n,_r){return e=new bl(e,o,s,_n,_r),o===1?(o=1,$===!0&&(o|=8)):o=0,$=Bg(3,null,null,o),e.current=$,$.stateNode=e,$.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah($),e}function dl(e,o,s){var a=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:a==null?null:""+a,children:e,containerInfo:o,implementation:s}}function el(e){if(!e)return Vf;e=e._reactInternals;e:{if(Vb(e)!==e||e.tag!==1)throw Error(p(170));var o=e;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Zf(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(p(171))}if(e.tag===1){var s=e.type;if(Zf(s))return bg(e,s,o)}return o}function fl(e,o,s,a,_,$,_e,_n,_r){return e=cl(s,a,!0,e,_,$,_e,_n,_r),e.context=el(null),s=e.current,a=L(),_=lh(s),$=ch(a,_),$.callback=o??null,dh(s,$,_),e.current.lanes=_,Ac(e,_,a),Ek(e,a),e}function gl(e,o,s,a){var _=o.current,$=L(),_e=lh(_);return s=el(s),o.context===null?o.context=s:o.pendingContext=s,o=ch($,_e),o.payload={element:e},a=a===void 0?null:a,a!==null&&(o.callback=a),e=dh(_,o,_e),e!==null&&(mh(e,_,_e,$),eh(e,_,_e)),_e}function hl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function il(e,o){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<o?s:o}}function jl(e,o){il(e,o),(e=e.alternate)&&il(e,o)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(e){console.error(e)};function ml(e){this._internalRoot=e}nl.prototype.render=ml.prototype.render=function(e){var o=this._internalRoot;if(o===null)throw Error(p(409));gl(e,o,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var o=e.containerInfo;Sk(function(){gl(null,e,null,null)}),o[uf]=null}};function nl(e){this._internalRoot=e}nl.prototype.unstable_scheduleHydration=function(e){if(e){var o=Hc();e={blockedOn:null,target:e,priority:o};for(var s=0;s<Qc.length&&o!==0&&o<Qc[s].priority;s++);Qc.splice(s,0,e),s===0&&Vc(e)}};function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function pl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(e,o,s,a,_){if(_){if(typeof a=="function"){var $=a;a=function(){var _s=hl(_e);$.call(_s)}}var _e=fl(o,a,e,0,null,!1,!1,"",ql);return e._reactRootContainer=_e,e[uf]=_e.current,sf(e.nodeType===8?e.parentNode:e),Sk(),_e}for(;_=e.lastChild;)e.removeChild(_);if(typeof a=="function"){var _n=a;a=function(){var _s=hl(_r);_n.call(_s)}}var _r=cl(e,0,!1,null,null,!1,!1,"",ql);return e._reactRootContainer=_r,e[uf]=_r.current,sf(e.nodeType===8?e.parentNode:e),Sk(function(){gl(o,_r,s,a)}),_r}function sl(e,o,s,a,_){var $=s._reactRootContainer;if($){var _e=$;if(typeof _=="function"){var _n=_;_=function(){var _r=hl(_e);_n.call(_r)}}gl(o,_e,e,_)}else _e=rl(s,o,e,_,a);return hl(_e)}Ec=function(e){switch(e.tag){case 3:var o=e.stateNode;if(o.current.memoizedState.isDehydrated){var s=tc(o.pendingLanes);s!==0&&(Cc(o,s|1),Ek(o,B()),!(K&6)&&(Hj=B()+500,jg()))}break;case 13:Sk(function(){var a=Zg(e,1);if(a!==null){var _=L();mh(a,e,1,_)}}),jl(e,1)}};Fc=function(e){if(e.tag===13){var o=Zg(e,134217728);if(o!==null){var s=L();mh(o,e,134217728,s)}jl(e,134217728)}};Gc=function(e){if(e.tag===13){var o=lh(e),s=Zg(e,o);if(s!==null){var a=L();mh(s,e,o,a)}jl(e,o)}};Hc=function(){return C};Ic=function(e,o){var s=C;try{return C=e,o()}finally{C=s}};yb=function(e,o,s){switch(o){case"input":if(bb(e,s),o=s.name,s.type==="radio"&&o!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<s.length;o++){var a=s[o];if(a!==e&&a.form===e.form){var _=Db(a);if(!_)throw Error(p(90));Wa(a),bb(a,_)}}}break;case"textarea":ib(e,s);break;case"select":o=s.value,o!=null&&fb(e,!!s.multiple,o,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(e,o){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(o))throw Error(p(200));return dl(e,o,null,s)};reactDom_production_min.createRoot=function(e,o){if(!ol(e))throw Error(p(299));var s=!1,a="",_=ll;return o!=null&&(o.unstable_strictMode===!0&&(s=!0),o.identifierPrefix!==void 0&&(a=o.identifierPrefix),o.onRecoverableError!==void 0&&(_=o.onRecoverableError)),o=cl(e,1,!1,null,null,s,!1,a,_),e[uf]=o.current,sf(e.nodeType===8?e.parentNode:e),new ml(o)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var o=e._reactInternals;if(o===void 0)throw typeof e.render=="function"?Error(p(188)):(e=Object.keys(e).join(","),Error(p(268,e)));return e=Zb(o),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Sk(e)};reactDom_production_min.hydrate=function(e,o,s){if(!pl(o))throw Error(p(200));return sl(null,e,o,!0,s)};reactDom_production_min.hydrateRoot=function(e,o,s){if(!ol(e))throw Error(p(405));var a=s!=null&&s.hydratedSources||null,_=!1,$="",_e=ll;if(s!=null&&(s.unstable_strictMode===!0&&(_=!0),s.identifierPrefix!==void 0&&($=s.identifierPrefix),s.onRecoverableError!==void 0&&(_e=s.onRecoverableError)),o=fl(o,null,e,1,s??null,_,!1,$,_e),e[uf]=o.current,sf(e),a)for(e=0;e<a.length;e++)s=a[e],_=s._getVersion,_=_(s._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[s,_]:o.mutableSourceEagerHydrationData.push(s,_);return new nl(o)};reactDom_production_min.render=function(e,o,s){if(!pl(o))throw Error(p(200));return sl(null,e,o,!1,s)};reactDom_production_min.unmountComponentAtNode=function(e){if(!pl(e))throw Error(p(40));return e._reactRootContainer?(Sk(function(){sl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,o,s,a){if(!pl(s))throw Error(p(200));if(e==null||e._reactInternals===void 0)throw Error(p(38));return sl(e,o,s,!1,a)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const ReactDOM=getDefaultExportFromCjs(reactDomExports);var m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;var classnames={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var o={}.hasOwnProperty;function s(){for(var a=[],_=0;_<arguments.length;_++){var $=arguments[_];if($){var _e=typeof $;if(_e==="string"||_e==="number")a.push($);else if(Array.isArray($)){if($.length){var _n=s.apply(null,$);_n&&a.push(_n)}}else if(_e==="object"){if($.toString!==Object.prototype.toString&&!$.toString.toString().includes("[native code]")){a.push($.toString());continue}for(var _r in $)o.call($,_r)&&$[_r]&&a.push(_r)}}}return a.join(" ")}e.exports?(s.default=s,e.exports=s):window.classNames=s})()})(classnames);var classnamesExports=classnames.exports;const classNames=getDefaultExportFromCjs(classnamesExports);function _extends$3(){return _extends$3=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},_extends$3.apply(this,arguments)}function _objectWithoutPropertiesLoose$7(e,o){if(e==null)return{};var s={},a=Object.keys(e),_,$;for($=0;$<a.length;$++)_=a[$],!(o.indexOf(_)>=0)&&(s[_]=e[_]);return s}function defaultKey(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function _toPropertyKey(e){var o=_toPrimitive(e,"string");return typeof o=="symbol"?o:String(o)}function _toPrimitive(e,o){if(typeof e!="object"||e===null)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var a=s.call(e,o||"default");if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(e)}function useUncontrolledProp$1(e,o,s){var a=reactExports.useRef(e!==void 0),_=reactExports.useState(o),$=_[0],_e=_[1],_n=e!==void 0,_r=a.current;return a.current=_n,!_n&&_r&&$!==o&&_e(o),[_n?e:$,reactExports.useCallback(function(_s){for(var na=arguments.length,ba=new Array(na>1?na-1:0),_p=1;_p<na;_p++)ba[_p-1]=arguments[_p];s&&s.apply(void 0,[_s].concat(ba)),_e(_s)},[s])]}function useUncontrolled(e,o){return Object.keys(o).reduce(function(s,a){var _,$=s,_e=$[defaultKey(a)],_n=$[a],_r=_objectWithoutPropertiesLoose$7($,[defaultKey(a),a].map(_toPropertyKey)),_s=o[a],na=useUncontrolledProp$1(_n,_e,e[_s]),ba=na[0],_p=na[1];return _extends$3({},_r,(_={},_[a]=ba,_[_s]=_p,_))},e)}function _setPrototypeOf(e,o){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,_){return a.__proto__=_,a},_setPrototypeOf(e,o)}function _inheritsLoose(e,o){e.prototype=Object.create(o.prototype),e.prototype.constructor=e,_setPrototypeOf(e,o)}const DEFAULT_BREAKPOINTS=["xxl","xl","lg","md","sm","xs"],DEFAULT_MIN_BREAKPOINT="xs",ThemeContext$1=reactExports.createContext({prefixes:{},breakpoints:DEFAULT_BREAKPOINTS,minBreakpoint:DEFAULT_MIN_BREAKPOINT});function useBootstrapPrefix(e,o){const{prefixes:s}=reactExports.useContext(ThemeContext$1);return e||s[o]||o}function useIsRTL(){const{dir:e}=reactExports.useContext(ThemeContext$1);return e==="rtl"}function ownerDocument$1(e){return e&&e.ownerDocument||document}const config$1={disabled:!1},TransitionGroupContext=React.createContext(null);var forceReflow=function(o){return o.scrollTop},UNMOUNTED="unmounted",EXITED="exited",ENTERING="entering",ENTERED="entered",EXITING="exiting",Transition=function(e){_inheritsLoose(o,e);function o(a,_){var $;$=e.call(this,a,_)||this;var _e=_,_n=_e&&!_e.isMounting?a.enter:a.appear,_r;return $.appearStatus=null,a.in?_n?(_r=EXITED,$.appearStatus=ENTERING):_r=ENTERED:a.unmountOnExit||a.mountOnEnter?_r=UNMOUNTED:_r=EXITED,$.state={status:_r},$.nextCallback=null,$}o.getDerivedStateFromProps=function(_,$){var _e=_.in;return _e&&$.status===UNMOUNTED?{status:EXITED}:null};var s=o.prototype;return s.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},s.componentDidUpdate=function(_){var $=null;if(_!==this.props){var _e=this.state.status;this.props.in?_e!==ENTERING&&_e!==ENTERED&&($=ENTERING):(_e===ENTERING||_e===ENTERED)&&($=EXITING)}this.updateStatus(!1,$)},s.componentWillUnmount=function(){this.cancelNextCallback()},s.getTimeouts=function(){var _=this.props.timeout,$,_e,_n;return $=_e=_n=_,_!=null&&typeof _!="number"&&($=_.exit,_e=_.enter,_n=_.appear!==void 0?_.appear:_e),{exit:$,enter:_e,appear:_n}},s.updateStatus=function(_,$){if(_===void 0&&(_=!1),$!==null)if(this.cancelNextCallback(),$===ENTERING){if(this.props.unmountOnExit||this.props.mountOnEnter){var _e=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this);_e&&forceReflow(_e)}this.performEnter(_)}else this.performExit();else this.props.unmountOnExit&&this.state.status===EXITED&&this.setState({status:UNMOUNTED})},s.performEnter=function(_){var $=this,_e=this.props.enter,_n=this.context?this.context.isMounting:_,_r=this.props.nodeRef?[_n]:[ReactDOM.findDOMNode(this),_n],_s=_r[0],na=_r[1],ba=this.getTimeouts(),_p=_n?ba.appear:ba.enter;if(!_&&!_e||config$1.disabled){this.safeSetState({status:ENTERED},function(){$.props.onEntered(_s)});return}this.props.onEnter(_s,na),this.safeSetState({status:ENTERING},function(){$.props.onEntering(_s,na),$.onTransitionEnd(_p,function(){$.safeSetState({status:ENTERED},function(){$.props.onEntered(_s,na)})})})},s.performExit=function(){var _=this,$=this.props.exit,_e=this.getTimeouts(),_n=this.props.nodeRef?void 0:ReactDOM.findDOMNode(this);if(!$||config$1.disabled){this.safeSetState({status:EXITED},function(){_.props.onExited(_n)});return}this.props.onExit(_n),this.safeSetState({status:EXITING},function(){_.props.onExiting(_n),_.onTransitionEnd(_e.exit,function(){_.safeSetState({status:EXITED},function(){_.props.onExited(_n)})})})},s.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},s.safeSetState=function(_,$){$=this.setNextCallback($),this.setState(_,$)},s.setNextCallback=function(_){var $=this,_e=!0;return this.nextCallback=function(_n){_e&&(_e=!1,$.nextCallback=null,_(_n))},this.nextCallback.cancel=function(){_e=!1},this.nextCallback},s.onTransitionEnd=function(_,$){this.setNextCallback($);var _e=this.props.nodeRef?this.props.nodeRef.current:ReactDOM.findDOMNode(this),_n=_==null&&!this.props.addEndListener;if(!_e||_n){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var _r=this.props.nodeRef?[this.nextCallback]:[_e,this.nextCallback],_s=_r[0],na=_r[1];this.props.addEndListener(_s,na)}_!=null&&setTimeout(this.nextCallback,_)},s.render=function(){var _=this.state.status;if(_===UNMOUNTED)return null;var $=this.props,_e=$.children;$.in,$.mountOnEnter,$.unmountOnExit,$.appear,$.enter,$.exit,$.timeout,$.addEndListener,$.onEnter,$.onEntering,$.onEntered,$.onExit,$.onExiting,$.onExited,$.nodeRef;var _n=_objectWithoutPropertiesLoose$7($,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return React.createElement(TransitionGroupContext.Provider,{value:null},typeof _e=="function"?_e(_,_n):React.cloneElement(React.Children.only(_e),_n))},o}(React.Component);Transition.contextType=TransitionGroupContext;Transition.propTypes={};function noop$4(){}Transition.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:noop$4,onEntering:noop$4,onEntered:noop$4,onExit:noop$4,onExiting:noop$4,onExited:noop$4};Transition.UNMOUNTED=UNMOUNTED;Transition.EXITED=EXITED;Transition.ENTERING=ENTERING;Transition.ENTERED=ENTERED;Transition.EXITING=EXITING;const Transition$1=Transition,canUseDOM=!!(typeof window<"u"&&window.document&&window.document.createElement);var optionsSupported=!1,onceSupported=!1;try{var options={get passive(){return optionsSupported=!0},get once(){return onceSupported=optionsSupported=!0}};canUseDOM&&(window.addEventListener("test",options,options),window.removeEventListener("test",options,!0))}catch{}function addEventListener$1(e,o,s,a){if(a&&typeof a!="boolean"&&!onceSupported){var _=a.once,$=a.capture,_e=s;!onceSupported&&_&&(_e=s.__once||function _n(_r){this.removeEventListener(o,_n,$),s.call(this,_r)},s.__once=_e),e.addEventListener(o,_e,optionsSupported?a:$)}e.addEventListener(o,s,a)}function removeEventListener$1(e,o,s,a){var _=a&&typeof a!="boolean"?a.capture:a;e.removeEventListener(o,s,_),s.__once&&e.removeEventListener(o,s.__once,_)}function listen(e,o,s,a){return addEventListener$1(e,o,s,a),function(){removeEventListener$1(e,o,s,a)}}const toFnRef=e=>!e||typeof e=="function"?e:o=>{e.current=o};function mergeRefs(e,o){const s=toFnRef(e),a=toFnRef(o);return _=>{s&&s(_),a&&a(_)}}function useMergedRefs(e,o){return reactExports.useMemo(()=>mergeRefs(e,o),[e,o])}function useCommittedRef(e){const o=reactExports.useRef(e);return reactExports.useEffect(()=>{o.current=e},[e]),o}function useEventCallback$1(e){const o=useCommittedRef(e);return reactExports.useCallback(function(...s){return o.current&&o.current(...s)},[o])}const divWithClassName=e=>reactExports.forwardRef((o,s)=>jsxRuntimeExports.jsx("div",{...o,ref:s,className:classNames(o.className,e)}));function useCallbackRef(){return reactExports.useState(null)}function useEventListener(e,o,s,a=!1){const _=useEventCallback$1(s);reactExports.useEffect(()=>{const $=typeof e=="function"?e():e;return $.addEventListener(o,_,a),()=>$.removeEventListener(o,_,a)},[e])}function useMounted(){const e=reactExports.useRef(!0),o=reactExports.useRef(()=>e.current);return reactExports.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),o.current}function usePrevious(e){const o=reactExports.useRef(null);return reactExports.useEffect(()=>{o.current=e}),o.current}const isReactNative$1=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",isDOM=typeof document<"u",useIsomorphicEffect=isDOM||isReactNative$1?reactExports.useLayoutEffect:reactExports.useEffect,_excluded$k=["as","disabled"];function _objectWithoutPropertiesLoose$6(e,o){if(e==null)return{};var s={},a=Object.keys(e),_,$;for($=0;$<a.length;$++)_=a[$],!(o.indexOf(_)>=0)&&(s[_]=e[_]);return s}function isTrivialHref$1(e){return!e||e.trim()==="#"}function useButtonProps({tagName:e,disabled:o,href:s,target:a,rel:_,role:$,onClick:_e,tabIndex:_n=0,type:_r}){e||(s!=null||a!=null||_!=null?e="a":e="button");const _s={tagName:e};if(e==="button")return[{type:_r||"button",disabled:o},_s];const na=_p=>{if((o||e==="a"&&isTrivialHref$1(s))&&_p.preventDefault(),o){_p.stopPropagation();return}_e==null||_e(_p)},ba=_p=>{_p.key===" "&&(_p.preventDefault(),na(_p))};return e==="a"&&(s||(s="#"),o&&(s=void 0)),[{role:$??"button",disabled:void 0,tabIndex:o?void 0:_n,href:s,target:e==="a"?a:void 0,"aria-disabled":o||void 0,rel:e==="a"?_:void 0,onClick:na,onKeyDown:ba},_s]}const Button$3=reactExports.forwardRef((e,o)=>{let{as:s,disabled:a}=e,_=_objectWithoutPropertiesLoose$6(e,_excluded$k);const[$,{tagName:_e}]=useButtonProps(Object.assign({tagName:s,disabled:a},_));return jsxRuntimeExports.jsx(_e,Object.assign({},_,$,{ref:o}))});Button$3.displayName="Button";const _excluded$j=["onKeyDown"];function _objectWithoutPropertiesLoose$5(e,o){if(e==null)return{};var s={},a=Object.keys(e),_,$;for($=0;$<a.length;$++)_=a[$],!(o.indexOf(_)>=0)&&(s[_]=e[_]);return s}function isTrivialHref(e){return!e||e.trim()==="#"}const Anchor=reactExports.forwardRef((e,o)=>{let{onKeyDown:s}=e,a=_objectWithoutPropertiesLoose$5(e,_excluded$j);const[_]=useButtonProps(Object.assign({tagName:"a"},a)),$=useEventCallback$1(_e=>{_.onKeyDown(_e),s==null||s(_e)});return isTrivialHref(a.href)||a.role==="button"?jsxRuntimeExports.jsx("a",Object.assign({ref:o},a,_,{onKeyDown:$})):jsxRuntimeExports.jsx("a",Object.assign({ref:o},a,{onKeyDown:s}))});Anchor.displayName="Anchor";const Anchor$1=Anchor,Button$1=reactExports.forwardRef(({as:e,bsPrefix:o,variant:s="primary",size:a,active:_=!1,disabled:$=!1,className:_e,..._n},_r)=>{const _s=useBootstrapPrefix(o,"btn"),[na,{tagName:ba}]=useButtonProps({tagName:e,disabled:$,..._n}),_p=ba;return jsxRuntimeExports.jsx(_p,{...na,..._n,ref:_r,disabled:$,className:classNames(_e,_s,_&&"active",s&&`${_s}-${s}`,a&&`${_s}-${a}`,_n.href&&$&&"disabled")})});Button$1.displayName="Button";const Button$2=Button$1,CardBody=reactExports.forwardRef(({className:e,bsPrefix:o,as:s="div",...a},_)=>(o=useBootstrapPrefix(o,"card-body"),jsxRuntimeExports.jsx(s,{ref:_,className:classNames(e,o),...a})));CardBody.displayName="CardBody";const CardBody$1=CardBody,CardFooter=reactExports.forwardRef(({className:e,bsPrefix:o,as:s="div",...a},_)=>(o=useBootstrapPrefix(o,"card-footer"),jsxRuntimeExports.jsx(s,{ref:_,className:classNames(e,o),...a})));CardFooter.displayName="CardFooter";const CardFooter$1=CardFooter,context$2=reactExports.createContext(null);context$2.displayName="CardHeaderContext";const CardHeaderContext=context$2,CardHeader=reactExports.forwardRef(({bsPrefix:e,className:o,as:s="div",...a},_)=>{const $=useBootstrapPrefix(e,"card-header"),_e=reactExports.useMemo(()=>({cardHeaderBsPrefix:$}),[$]);return jsxRuntimeExports.jsx(CardHeaderContext.Provider,{value:_e,children:jsxRuntimeExports.jsx(s,{ref:_,...a,className:classNames(o,$)})})});CardHeader.displayName="CardHeader";const CardHeader$1=CardHeader,CardImg=reactExports.forwardRef(({bsPrefix:e,className:o,variant:s,as:a="img",..._},$)=>{const _e=useBootstrapPrefix(e,"card-img");return jsxRuntimeExports.jsx(a,{ref:$,className:classNames(s?`${_e}-${s}`:_e,o),..._})});CardImg.displayName="CardImg";const CardImg$1=CardImg,CardImgOverlay=reactExports.forwardRef(({className:e,bsPrefix:o,as:s="div",...a},_)=>(o=useBootstrapPrefix(o,"card-img-overlay"),jsxRuntimeExports.jsx(s,{ref:_,className:classNames(e,o),...a})));CardImgOverlay.displayName="CardImgOverlay";const CardImgOverlay$1=CardImgOverlay,CardLink=reactExports.forwardRef(({className:e,bsPrefix:o,as:s="a",...a},_)=>(o=useBootstrapPrefix(o,"card-link"),jsxRuntimeExports.jsx(s,{ref:_,className:classNames(e,o),...a})));CardLink.displayName="CardLink";const CardLink$1=CardLink,DivStyledAsH6=divWithClassName("h6"),CardSubtitle=reactExports.forwardRef(({className:e,bsPrefix:o,as:s=DivStyledAsH6,...a},_)=>(o=useBootstrapPrefix(o,"card-subtitle"),jsxRuntimeExports.jsx(s,{ref:_,className:classNames(e,o),...a})));CardSubtitle.displayName="CardSubtitle";const CardSubtitle$1=CardSubtitle,CardText=reactExports.forwardRef(({className:e,bsPrefix:o,as:s="p",...a},_)=>(o=useBootstrapPrefix(o,"card-text"),jsxRuntimeExports.jsx(s,{ref:_,className:classNames(e,o),...a})));CardText.displayName="CardText";const CardText$1=CardText,DivStyledAsH5=divWithClassName("h5"),CardTitle=reactExports.forwardRef(({className:e,bsPrefix:o,as:s=DivStyledAsH5,...a},_)=>(o=useBootstrapPrefix(o,"card-title"),jsxRuntimeExports.jsx(s,{ref:_,className:classNames(e,o),...a})));CardTitle.displayName="CardTitle";const CardTitle$1=CardTitle,Card=reactExports.forwardRef(({bsPrefix:e,className:o,bg:s,text:a,border:_,body:$=!1,children:_e,as:_n="div",..._r},_s)=>{const na=useBootstrapPrefix(e,"card");return jsxRuntimeExports.jsx(_n,{ref:_s,..._r,className:classNames(o,na,s&&`bg-${s}`,a&&`text-${a}`,_&&`border-${_}`),children:$?jsxRuntimeExports.jsx(CardBody$1,{children:_e}):_e})});Card.displayName="Card";const Card$1=Object.assign(Card,{Img:CardImg$1,Title:CardTitle$1,Subtitle:CardSubtitle$1,Body:CardBody$1,Link:CardLink$1,Text:CardText$1,Header:CardHeader$1,Footer:CardFooter$1,ImgOverlay:CardImgOverlay$1});var toArray$2=Function.prototype.bind.call(Function.prototype.call,[].slice);function qsa(e,o){return toArray$2(e.querySelectorAll(o))}function useUncontrolledProp(e,o,s){const a=reactExports.useRef(e!==void 0),[_,$]=reactExports.useState(o),_e=e!==void 0,_n=a.current;return a.current=_e,!_e&&_n&&_!==o&&$(o),[_e?e:_,reactExports.useCallback((..._r)=>{const[_s,...na]=_r;let ba=s==null?void 0:s(_s,...na);return $(_s),ba},[s])]}function useForceUpdate(){const[,e]=reactExports.useReducer(o=>!o,!1);return e}const DropdownContext$2=reactExports.createContext(null),DropdownContext$3=DropdownContext$2;var has=Object.prototype.hasOwnProperty;function find(e,o,s){for(s of e.keys())if(dequal(s,o))return s}function dequal(e,o){var s,a,_;if(e===o)return!0;if(e&&o&&(s=e.constructor)===o.constructor){if(s===Date)return e.getTime()===o.getTime();if(s===RegExp)return e.toString()===o.toString();if(s===Array){if((a=e.length)===o.length)for(;a--&&dequal(e[a],o[a]););return a===-1}if(s===Set){if(e.size!==o.size)return!1;for(a of e)if(_=a,_&&typeof _=="object"&&(_=find(o,_),!_)||!o.has(_))return!1;return!0}if(s===Map){if(e.size!==o.size)return!1;for(a of e)if(_=a[0],_&&typeof _=="object"&&(_=find(o,_),!_)||!dequal(a[1],o.get(_)))return!1;return!0}if(s===ArrayBuffer)e=new Uint8Array(e),o=new Uint8Array(o);else if(s===DataView){if((a=e.byteLength)===o.byteLength)for(;a--&&e.getInt8(a)===o.getInt8(a););return a===-1}if(ArrayBuffer.isView(e)){if((a=e.byteLength)===o.byteLength)for(;a--&&e[a]===o[a];);return a===-1}if(!s||typeof e=="object"){a=0;for(s in e)if(has.call(e,s)&&++a&&!has.call(o,s)||!(s in o)||!dequal(e[s],o[s]))return!1;return Object.keys(o).length===a}}return e!==e&&o!==o}function useSafeState(e){const o=useMounted();return[e[0],reactExports.useCallback(s=>{if(o())return e[1](s)},[o,e[1]])]}var top="top",bottom="bottom",right="right",left="left",auto="auto",basePlacements=[top,bottom,right,left],start="start",end="end",clippingParents="clippingParents",viewport="viewport",popper="popper",reference="reference",variationPlacements=basePlacements.reduce(function(e,o){return e.concat([o+"-"+start,o+"-"+end])},[]),placements=[].concat(basePlacements,[auto]).reduce(function(e,o){return e.concat([o,o+"-"+start,o+"-"+end])},[]),beforeRead="beforeRead",read="read",afterRead="afterRead",beforeMain="beforeMain",main="main",afterMain="afterMain",beforeWrite="beforeWrite",write="write",afterWrite="afterWrite",modifierPhases=[beforeRead,read,afterRead,beforeMain,main,afterMain,beforeWrite,write,afterWrite];function getBasePlacement(e){return e.split("-")[0]}function getWindow(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var o=e.ownerDocument;return o&&o.defaultView||window}return e}function isElement(e){var o=getWindow(e).Element;return e instanceof o||e instanceof Element}function isHTMLElement$1(e){var o=getWindow(e).HTMLElement;return e instanceof o||e instanceof HTMLElement}function isShadowRoot(e){if(typeof ShadowRoot>"u")return!1;var o=getWindow(e).ShadowRoot;return e instanceof o||e instanceof ShadowRoot}var max=Math.max,min=Math.min,round$2=Math.round;function getUAString(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(o){return o.brand+"/"+o.version}).join(" "):navigator.userAgent}function isLayoutViewport(){return!/^((?!chrome|android).)*safari/i.test(getUAString())}function getBoundingClientRect(e,o,s){o===void 0&&(o=!1),s===void 0&&(s=!1);var a=e.getBoundingClientRect(),_=1,$=1;o&&isHTMLElement$1(e)&&(_=e.offsetWidth>0&&round$2(a.width)/e.offsetWidth||1,$=e.offsetHeight>0&&round$2(a.height)/e.offsetHeight||1);var _e=isElement(e)?getWindow(e):window,_n=_e.visualViewport,_r=!isLayoutViewport()&&s,_s=(a.left+(_r&&_n?_n.offsetLeft:0))/_,na=(a.top+(_r&&_n?_n.offsetTop:0))/$,ba=a.width/_,_p=a.height/$;return{width:ba,height:_p,top:na,right:_s+ba,bottom:na+_p,left:_s,x:_s,y:na}}function getLayoutRect(e){var o=getBoundingClientRect(e),s=e.offsetWidth,a=e.offsetHeight;return Math.abs(o.width-s)<=1&&(s=o.width),Math.abs(o.height-a)<=1&&(a=o.height),{x:e.offsetLeft,y:e.offsetTop,width:s,height:a}}function contains$1(e,o){var s=o.getRootNode&&o.getRootNode();if(e.contains(o))return!0;if(s&&isShadowRoot(s)){var a=o;do{if(a&&e.isSameNode(a))return!0;a=a.parentNode||a.host}while(a)}return!1}function getNodeName(e){return e?(e.nodeName||"").toLowerCase():null}function getComputedStyle$1(e){return getWindow(e).getComputedStyle(e)}function isTableElement(e){return["table","td","th"].indexOf(getNodeName(e))>=0}function getDocumentElement(e){return((isElement(e)?e.ownerDocument:e.document)||window.document).documentElement}function getParentNode(e){return getNodeName(e)==="html"?e:e.assignedSlot||e.parentNode||(isShadowRoot(e)?e.host:null)||getDocumentElement(e)}function getTrueOffsetParent(e){return!isHTMLElement$1(e)||getComputedStyle$1(e).position==="fixed"?null:e.offsetParent}function getContainingBlock(e){var o=/firefox/i.test(getUAString()),s=/Trident/i.test(getUAString());if(s&&isHTMLElement$1(e)){var a=getComputedStyle$1(e);if(a.position==="fixed")return null}var _=getParentNode(e);for(isShadowRoot(_)&&(_=_.host);isHTMLElement$1(_)&&["html","body"].indexOf(getNodeName(_))<0;){var $=getComputedStyle$1(_);if($.transform!=="none"||$.perspective!=="none"||$.contain==="paint"||["transform","perspective"].indexOf($.willChange)!==-1||o&&$.willChange==="filter"||o&&$.filter&&$.filter!=="none")return _;_=_.parentNode}return null}function getOffsetParent(e){for(var o=getWindow(e),s=getTrueOffsetParent(e);s&&isTableElement(s)&&getComputedStyle$1(s).position==="static";)s=getTrueOffsetParent(s);return s&&(getNodeName(s)==="html"||getNodeName(s)==="body"&&getComputedStyle$1(s).position==="static")?o:s||getContainingBlock(e)||o}function getMainAxisFromPlacement(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function within(e,o,s){return max(e,min(o,s))}function withinMaxClamp(e,o,s){var a=within(e,o,s);return a>s?s:a}function getFreshSideObject(){return{top:0,right:0,bottom:0,left:0}}function mergePaddingObject(e){return Object.assign({},getFreshSideObject(),e)}function expandToHashMap(e,o){return o.reduce(function(s,a){return s[a]=e,s},{})}var toPaddingObject=function(o,s){return o=typeof o=="function"?o(Object.assign({},s.rects,{placement:s.placement})):o,mergePaddingObject(typeof o!="number"?o:expandToHashMap(o,basePlacements))};function arrow(e){var o,s=e.state,a=e.name,_=e.options,$=s.elements.arrow,_e=s.modifiersData.popperOffsets,_n=getBasePlacement(s.placement),_r=getMainAxisFromPlacement(_n),_s=[left,right].indexOf(_n)>=0,na=_s?"height":"width";if(!(!$||!_e)){var ba=toPaddingObject(_.padding,s),_p=getLayoutRect($),_f=_r==="y"?top:left,_E=_r==="y"?bottom:right,_v=s.rects.reference[na]+s.rects.reference[_r]-_e[_r]-s.rects.popper[na],n_=_e[_r]-s.rects.reference[_r],e_=getOffsetParent($),t_=e_?_r==="y"?e_.clientHeight||0:e_.clientWidth||0:0,o_=_v/2-n_/2,m_=ba[_f],b_=t_-_p[na]-ba[_E],w_=t_/2-_p[na]/2+o_,y_=within(m_,w_,b_),N_=_r;s.modifiersData[a]=(o={},o[N_]=y_,o.centerOffset=y_-w_,o)}}function effect$2(e){var o=e.state,s=e.options,a=s.element,_=a===void 0?"[data-popper-arrow]":a;_!=null&&(typeof _=="string"&&(_=o.elements.popper.querySelector(_),!_)||contains$1(o.elements.popper,_)&&(o.elements.arrow=_))}const arrow$1={name:"arrow",enabled:!0,phase:"main",fn:arrow,effect:effect$2,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function getVariation(e){return e.split("-")[1]}var unsetSides={top:"auto",right:"auto",bottom:"auto",left:"auto"};function roundOffsetsByDPR(e,o){var s=e.x,a=e.y,_=o.devicePixelRatio||1;return{x:round$2(s*_)/_||0,y:round$2(a*_)/_||0}}function mapToStyles(e){var o,s=e.popper,a=e.popperRect,_=e.placement,$=e.variation,_e=e.offsets,_n=e.position,_r=e.gpuAcceleration,_s=e.adaptive,na=e.roundOffsets,ba=e.isFixed,_p=_e.x,_f=_p===void 0?0:_p,_E=_e.y,_v=_E===void 0?0:_E,n_=typeof na=="function"?na({x:_f,y:_v}):{x:_f,y:_v};_f=n_.x,_v=n_.y;var e_=_e.hasOwnProperty("x"),t_=_e.hasOwnProperty("y"),o_=left,m_=top,b_=window;if(_s){var w_=getOffsetParent(s),y_="clientHeight",N_="clientWidth";if(w_===getWindow(s)&&(w_=getDocumentElement(s),getComputedStyle$1(w_).position!=="static"&&_n==="absolute"&&(y_="scrollHeight",N_="scrollWidth")),w_=w_,_===top||(_===left||_===right)&&$===end){m_=bottom;var _y=ba&&w_===b_&&b_.visualViewport?b_.visualViewport.height:w_[y_];_v-=_y-a.height,_v*=_r?1:-1}if(_===left||(_===top||_===bottom)&&$===end){o_=right;var v_=ba&&w_===b_&&b_.visualViewport?b_.visualViewport.width:w_[N_];_f-=v_-a.width,_f*=_r?1:-1}}var A_=Object.assign({position:_n},_s&&unsetSides),k_=na===!0?roundOffsetsByDPR({x:_f,y:_v},getWindow(s)):{x:_f,y:_v};if(_f=k_.x,_v=k_.y,_r){var P_;return Object.assign({},A_,(P_={},P_[m_]=t_?"0":"",P_[o_]=e_?"0":"",P_.transform=(b_.devicePixelRatio||1)<=1?"translate("+_f+"px, "+_v+"px)":"translate3d("+_f+"px, "+_v+"px, 0)",P_))}return Object.assign({},A_,(o={},o[m_]=t_?_v+"px":"",o[o_]=e_?_f+"px":"",o.transform="",o))}function computeStyles(e){var o=e.state,s=e.options,a=s.gpuAcceleration,_=a===void 0?!0:a,$=s.adaptive,_e=$===void 0?!0:$,_n=s.roundOffsets,_r=_n===void 0?!0:_n,_s={placement:getBasePlacement(o.placement),variation:getVariation(o.placement),popper:o.elements.popper,popperRect:o.rects.popper,gpuAcceleration:_,isFixed:o.options.strategy==="fixed"};o.modifiersData.popperOffsets!=null&&(o.styles.popper=Object.assign({},o.styles.popper,mapToStyles(Object.assign({},_s,{offsets:o.modifiersData.popperOffsets,position:o.options.strategy,adaptive:_e,roundOffsets:_r})))),o.modifiersData.arrow!=null&&(o.styles.arrow=Object.assign({},o.styles.arrow,mapToStyles(Object.assign({},_s,{offsets:o.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:_r})))),o.attributes.popper=Object.assign({},o.attributes.popper,{"data-popper-placement":o.placement})}const computeStyles$1={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:computeStyles,data:{}};var passive={passive:!0};function effect$1(e){var o=e.state,s=e.instance,a=e.options,_=a.scroll,$=_===void 0?!0:_,_e=a.resize,_n=_e===void 0?!0:_e,_r=getWindow(o.elements.popper),_s=[].concat(o.scrollParents.reference,o.scrollParents.popper);return $&&_s.forEach(function(na){na.addEventListener("scroll",s.update,passive)}),_n&&_r.addEventListener("resize",s.update,passive),function(){$&&_s.forEach(function(na){na.removeEventListener("scroll",s.update,passive)}),_n&&_r.removeEventListener("resize",s.update,passive)}}const eventListeners={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:effect$1,data:{}};var hash$2={left:"right",right:"left",bottom:"top",top:"bottom"};function getOppositePlacement(e){return e.replace(/left|right|bottom|top/g,function(o){return hash$2[o]})}var hash$1={start:"end",end:"start"};function getOppositeVariationPlacement(e){return e.replace(/start|end/g,function(o){return hash$1[o]})}function getWindowScroll(e){var o=getWindow(e),s=o.pageXOffset,a=o.pageYOffset;return{scrollLeft:s,scrollTop:a}}function getWindowScrollBarX(e){return getBoundingClientRect(getDocumentElement(e)).left+getWindowScroll(e).scrollLeft}function getViewportRect(e,o){var s=getWindow(e),a=getDocumentElement(e),_=s.visualViewport,$=a.clientWidth,_e=a.clientHeight,_n=0,_r=0;if(_){$=_.width,_e=_.height;var _s=isLayoutViewport();(_s||!_s&&o==="fixed")&&(_n=_.offsetLeft,_r=_.offsetTop)}return{width:$,height:_e,x:_n+getWindowScrollBarX(e),y:_r}}function getDocumentRect(e){var o,s=getDocumentElement(e),a=getWindowScroll(e),_=(o=e.ownerDocument)==null?void 0:o.body,$=max(s.scrollWidth,s.clientWidth,_?_.scrollWidth:0,_?_.clientWidth:0),_e=max(s.scrollHeight,s.clientHeight,_?_.scrollHeight:0,_?_.clientHeight:0),_n=-a.scrollLeft+getWindowScrollBarX(e),_r=-a.scrollTop;return getComputedStyle$1(_||s).direction==="rtl"&&(_n+=max(s.clientWidth,_?_.clientWidth:0)-$),{width:$,height:_e,x:_n,y:_r}}function isScrollParent(e){var o=getComputedStyle$1(e),s=o.overflow,a=o.overflowX,_=o.overflowY;return/auto|scroll|overlay|hidden/.test(s+_+a)}function getScrollParent(e){return["html","body","#document"].indexOf(getNodeName(e))>=0?e.ownerDocument.body:isHTMLElement$1(e)&&isScrollParent(e)?e:getScrollParent(getParentNode(e))}function listScrollParents(e,o){var s;o===void 0&&(o=[]);var a=getScrollParent(e),_=a===((s=e.ownerDocument)==null?void 0:s.body),$=getWindow(a),_e=_?[$].concat($.visualViewport||[],isScrollParent(a)?a:[]):a,_n=o.concat(_e);return _?_n:_n.concat(listScrollParents(getParentNode(_e)))}function rectToClientRect(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function getInnerBoundingClientRect(e,o){var s=getBoundingClientRect(e,!1,o==="fixed");return s.top=s.top+e.clientTop,s.left=s.left+e.clientLeft,s.bottom=s.top+e.clientHeight,s.right=s.left+e.clientWidth,s.width=e.clientWidth,s.height=e.clientHeight,s.x=s.left,s.y=s.top,s}function getClientRectFromMixedType(e,o,s){return o===viewport?rectToClientRect(getViewportRect(e,s)):isElement(o)?getInnerBoundingClientRect(o,s):rectToClientRect(getDocumentRect(getDocumentElement(e)))}function getClippingParents(e){var o=listScrollParents(getParentNode(e)),s=["absolute","fixed"].indexOf(getComputedStyle$1(e).position)>=0,a=s&&isHTMLElement$1(e)?getOffsetParent(e):e;return isElement(a)?o.filter(function(_){return isElement(_)&&contains$1(_,a)&&getNodeName(_)!=="body"}):[]}function getClippingRect(e,o,s,a){var _=o==="clippingParents"?getClippingParents(e):[].concat(o),$=[].concat(_,[s]),_e=$[0],_n=$.reduce(function(_r,_s){var na=getClientRectFromMixedType(e,_s,a);return _r.top=max(na.top,_r.top),_r.right=min(na.right,_r.right),_r.bottom=min(na.bottom,_r.bottom),_r.left=max(na.left,_r.left),_r},getClientRectFromMixedType(e,_e,a));return _n.width=_n.right-_n.left,_n.height=_n.bottom-_n.top,_n.x=_n.left,_n.y=_n.top,_n}function computeOffsets(e){var o=e.reference,s=e.element,a=e.placement,_=a?getBasePlacement(a):null,$=a?getVariation(a):null,_e=o.x+o.width/2-s.width/2,_n=o.y+o.height/2-s.height/2,_r;switch(_){case top:_r={x:_e,y:o.y-s.height};break;case bottom:_r={x:_e,y:o.y+o.height};break;case right:_r={x:o.x+o.width,y:_n};break;case left:_r={x:o.x-s.width,y:_n};break;default:_r={x:o.x,y:o.y}}var _s=_?getMainAxisFromPlacement(_):null;if(_s!=null){var na=_s==="y"?"height":"width";switch($){case start:_r[_s]=_r[_s]-(o[na]/2-s[na]/2);break;case end:_r[_s]=_r[_s]+(o[na]/2-s[na]/2);break}}return _r}function detectOverflow(e,o){o===void 0&&(o={});var s=o,a=s.placement,_=a===void 0?e.placement:a,$=s.strategy,_e=$===void 0?e.strategy:$,_n=s.boundary,_r=_n===void 0?clippingParents:_n,_s=s.rootBoundary,na=_s===void 0?viewport:_s,ba=s.elementContext,_p=ba===void 0?popper:ba,_f=s.altBoundary,_E=_f===void 0?!1:_f,_v=s.padding,n_=_v===void 0?0:_v,e_=mergePaddingObject(typeof n_!="number"?n_:expandToHashMap(n_,basePlacements)),t_=_p===popper?reference:popper,o_=e.rects.popper,m_=e.elements[_E?t_:_p],b_=getClippingRect(isElement(m_)?m_:m_.contextElement||getDocumentElement(e.elements.popper),_r,na,_e),w_=getBoundingClientRect(e.elements.reference),y_=computeOffsets({reference:w_,element:o_,strategy:"absolute",placement:_}),N_=rectToClientRect(Object.assign({},o_,y_)),_y=_p===popper?N_:w_,v_={top:b_.top-_y.top+e_.top,bottom:_y.bottom-b_.bottom+e_.bottom,left:b_.left-_y.left+e_.left,right:_y.right-b_.right+e_.right},A_=e.modifiersData.offset;if(_p===popper&&A_){var k_=A_[_];Object.keys(v_).forEach(function(P_){var T_=[right,bottom].indexOf(P_)>=0?1:-1,R_=[top,bottom].indexOf(P_)>=0?"y":"x";v_[P_]+=k_[R_]*T_})}return v_}function computeAutoPlacement(e,o){o===void 0&&(o={});var s=o,a=s.placement,_=s.boundary,$=s.rootBoundary,_e=s.padding,_n=s.flipVariations,_r=s.allowedAutoPlacements,_s=_r===void 0?placements:_r,na=getVariation(a),ba=na?_n?variationPlacements:variationPlacements.filter(function(_E){return getVariation(_E)===na}):basePlacements,_p=ba.filter(function(_E){return _s.indexOf(_E)>=0});_p.length===0&&(_p=ba);var _f=_p.reduce(function(_E,_v){return _E[_v]=detectOverflow(e,{placement:_v,boundary:_,rootBoundary:$,padding:_e})[getBasePlacement(_v)],_E},{});return Object.keys(_f).sort(function(_E,_v){return _f[_E]-_f[_v]})}function getExpandedFallbackPlacements(e){if(getBasePlacement(e)===auto)return[];var o=getOppositePlacement(e);return[getOppositeVariationPlacement(e),o,getOppositeVariationPlacement(o)]}function flip(e){var o=e.state,s=e.options,a=e.name;if(!o.modifiersData[a]._skip){for(var _=s.mainAxis,$=_===void 0?!0:_,_e=s.altAxis,_n=_e===void 0?!0:_e,_r=s.fallbackPlacements,_s=s.padding,na=s.boundary,ba=s.rootBoundary,_p=s.altBoundary,_f=s.flipVariations,_E=_f===void 0?!0:_f,_v=s.allowedAutoPlacements,n_=o.options.placement,e_=getBasePlacement(n_),t_=e_===n_,o_=_r||(t_||!_E?[getOppositePlacement(n_)]:getExpandedFallbackPlacements(n_)),m_=[n_].concat(o_).reduce(function(W_,Y_){return W_.concat(getBasePlacement(Y_)===auto?computeAutoPlacement(o,{placement:Y_,boundary:na,rootBoundary:ba,padding:_s,flipVariations:_E,allowedAutoPlacements:_v}):Y_)},[]),b_=o.rects.reference,w_=o.rects.popper,y_=new Map,N_=!0,_y=m_[0],v_=0;v_<m_.length;v_++){var A_=m_[v_],k_=getBasePlacement(A_),P_=getVariation(A_)===start,T_=[top,bottom].indexOf(k_)>=0,R_=T_?"width":"height",I_=detectOverflow(o,{placement:A_,boundary:na,rootBoundary:ba,altBoundary:_p,padding:_s}),U_=T_?P_?right:left:P_?bottom:top;b_[R_]>w_[R_]&&(U_=getOppositePlacement(U_));var D_=getOppositePlacement(U_),n0=[];if($&&n0.push(I_[k_]<=0),_n&&n0.push(I_[U_]<=0,I_[D_]<=0),n0.every(function(W_){return W_})){_y=A_,N_=!1;break}y_.set(A_,n0)}if(N_)for(var a_=_E?3:1,s_=function(Y_){var e0=m_.find(function(F_){var H_=y_.get(F_);if(H_)return H_.slice(0,Y_).every(function(E0){return E0})});if(e0)return _y=e0,"break"},S_=a_;S_>0;S_--){var V_=s_(S_);if(V_==="break")break}o.placement!==_y&&(o.modifiersData[a]._skip=!0,o.placement=_y,o.reset=!0)}}const flip$1={name:"flip",enabled:!0,phase:"main",fn:flip,requiresIfExists:["offset"],data:{_skip:!1}};function getSideOffsets(e,o,s){return s===void 0&&(s={x:0,y:0}),{top:e.top-o.height-s.y,right:e.right-o.width+s.x,bottom:e.bottom-o.height+s.y,left:e.left-o.width-s.x}}function isAnySideFullyClipped(e){return[top,right,bottom,left].some(function(o){return e[o]>=0})}function hide(e){var o=e.state,s=e.name,a=o.rects.reference,_=o.rects.popper,$=o.modifiersData.preventOverflow,_e=detectOverflow(o,{elementContext:"reference"}),_n=detectOverflow(o,{altBoundary:!0}),_r=getSideOffsets(_e,a),_s=getSideOffsets(_n,_,$),na=isAnySideFullyClipped(_r),ba=isAnySideFullyClipped(_s);o.modifiersData[s]={referenceClippingOffsets:_r,popperEscapeOffsets:_s,isReferenceHidden:na,hasPopperEscaped:ba},o.attributes.popper=Object.assign({},o.attributes.popper,{"data-popper-reference-hidden":na,"data-popper-escaped":ba})}const hide$1={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:hide};function distanceAndSkiddingToXY(e,o,s){var a=getBasePlacement(e),_=[left,top].indexOf(a)>=0?-1:1,$=typeof s=="function"?s(Object.assign({},o,{placement:e})):s,_e=$[0],_n=$[1];return _e=_e||0,_n=(_n||0)*_,[left,right].indexOf(a)>=0?{x:_n,y:_e}:{x:_e,y:_n}}function offset(e){var o=e.state,s=e.options,a=e.name,_=s.offset,$=_===void 0?[0,0]:_,_e=placements.reduce(function(na,ba){return na[ba]=distanceAndSkiddingToXY(ba,o.rects,$),na},{}),_n=_e[o.placement],_r=_n.x,_s=_n.y;o.modifiersData.popperOffsets!=null&&(o.modifiersData.popperOffsets.x+=_r,o.modifiersData.popperOffsets.y+=_s),o.modifiersData[a]=_e}const offset$1={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:offset};function popperOffsets(e){var o=e.state,s=e.name;o.modifiersData[s]=computeOffsets({reference:o.rects.reference,element:o.rects.popper,strategy:"absolute",placement:o.placement})}const popperOffsets$1={name:"popperOffsets",enabled:!0,phase:"read",fn:popperOffsets,data:{}};function getAltAxis(e){return e==="x"?"y":"x"}function preventOverflow(e){var o=e.state,s=e.options,a=e.name,_=s.mainAxis,$=_===void 0?!0:_,_e=s.altAxis,_n=_e===void 0?!1:_e,_r=s.boundary,_s=s.rootBoundary,na=s.altBoundary,ba=s.padding,_p=s.tether,_f=_p===void 0?!0:_p,_E=s.tetherOffset,_v=_E===void 0?0:_E,n_=detectOverflow(o,{boundary:_r,rootBoundary:_s,padding:ba,altBoundary:na}),e_=getBasePlacement(o.placement),t_=getVariation(o.placement),o_=!t_,m_=getMainAxisFromPlacement(e_),b_=getAltAxis(m_),w_=o.modifiersData.popperOffsets,y_=o.rects.reference,N_=o.rects.popper,_y=typeof _v=="function"?_v(Object.assign({},o.rects,{placement:o.placement})):_v,v_=typeof _y=="number"?{mainAxis:_y,altAxis:_y}:Object.assign({mainAxis:0,altAxis:0},_y),A_=o.modifiersData.offset?o.modifiersData.offset[o.placement]:null,k_={x:0,y:0};if(w_){if($){var P_,T_=m_==="y"?top:left,R_=m_==="y"?bottom:right,I_=m_==="y"?"height":"width",U_=w_[m_],D_=U_+n_[T_],n0=U_-n_[R_],a_=_f?-N_[I_]/2:0,s_=t_===start?y_[I_]:N_[I_],S_=t_===start?-N_[I_]:-y_[I_],V_=o.elements.arrow,W_=_f&&V_?getLayoutRect(V_):{width:0,height:0},Y_=o.modifiersData["arrow#persistent"]?o.modifiersData["arrow#persistent"].padding:getFreshSideObject(),e0=Y_[T_],F_=Y_[R_],H_=within(0,y_[I_],W_[I_]),E0=o_?y_[I_]/2-a_-H_-e0-v_.mainAxis:s_-H_-e0-v_.mainAxis,d0=o_?-y_[I_]/2+a_+H_+F_+v_.mainAxis:S_+H_+F_+v_.mainAxis,m0=o.elements.arrow&&getOffsetParent(o.elements.arrow),v0=m0?m_==="y"?m0.clientTop||0:m0.clientLeft||0:0,u0=(P_=A_==null?void 0:A_[m_])!=null?P_:0,s0=U_+E0-u0-v0,T0=U_+d0-u0,j0=within(_f?min(D_,s0):D_,U_,_f?max(n0,T0):n0);w_[m_]=j0,k_[m_]=j0-U_}if(_n){var J_,g0=m_==="x"?top:left,A0=m_==="x"?bottom:right,j_=w_[b_],o0=b_==="y"?"height":"width",w0=j_+n_[g0],k0=j_-n_[A0],H0=[top,left].indexOf(e_)!==-1,U0=(J_=A_==null?void 0:A_[b_])!=null?J_:0,NS=H0?w0:j_-y_[o0]-N_[o0]-U0+v_.altAxis,yS=H0?j_+y_[o0]+N_[o0]-U0-v_.altAxis:k0,SR=_f&&H0?withinMaxClamp(NS,j_,yS):within(_f?NS:w0,j_,_f?yS:k0);w_[b_]=SR,k_[b_]=SR-j_}o.modifiersData[a]=k_}}const preventOverflow$1={name:"preventOverflow",enabled:!0,phase:"main",fn:preventOverflow,requiresIfExists:["offset"]};function getHTMLElementScroll(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function getNodeScroll(e){return e===getWindow(e)||!isHTMLElement$1(e)?getWindowScroll(e):getHTMLElementScroll(e)}function isElementScaled(e){var o=e.getBoundingClientRect(),s=round$2(o.width)/e.offsetWidth||1,a=round$2(o.height)/e.offsetHeight||1;return s!==1||a!==1}function getCompositeRect(e,o,s){s===void 0&&(s=!1);var a=isHTMLElement$1(o),_=isHTMLElement$1(o)&&isElementScaled(o),$=getDocumentElement(o),_e=getBoundingClientRect(e,_,s),_n={scrollLeft:0,scrollTop:0},_r={x:0,y:0};return(a||!a&&!s)&&((getNodeName(o)!=="body"||isScrollParent($))&&(_n=getNodeScroll(o)),isHTMLElement$1(o)?(_r=getBoundingClientRect(o,!0),_r.x+=o.clientLeft,_r.y+=o.clientTop):$&&(_r.x=getWindowScrollBarX($))),{x:_e.left+_n.scrollLeft-_r.x,y:_e.top+_n.scrollTop-_r.y,width:_e.width,height:_e.height}}function order(e){var o=new Map,s=new Set,a=[];e.forEach(function($){o.set($.name,$)});function _($){s.add($.name);var _e=[].concat($.requires||[],$.requiresIfExists||[]);_e.forEach(function(_n){if(!s.has(_n)){var _r=o.get(_n);_r&&_(_r)}}),a.push($)}return e.forEach(function($){s.has($.name)||_($)}),a}function orderModifiers(e){var o=order(e);return modifierPhases.reduce(function(s,a){return s.concat(o.filter(function(_){return _.phase===a}))},[])}function debounce$1(e){var o;return function(){return o||(o=new Promise(function(s){Promise.resolve().then(function(){o=void 0,s(e())})})),o}}function mergeByName(e){var o=e.reduce(function(s,a){var _=s[a.name];return s[a.name]=_?Object.assign({},_,a,{options:Object.assign({},_.options,a.options),data:Object.assign({},_.data,a.data)}):a,s},{});return Object.keys(o).map(function(s){return o[s]})}var DEFAULT_OPTIONS={placement:"bottom",modifiers:[],strategy:"absolute"};function areValidElements(){for(var e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];return!o.some(function(a){return!(a&&typeof a.getBoundingClientRect=="function")})}function popperGenerator(e){e===void 0&&(e={});var o=e,s=o.defaultModifiers,a=s===void 0?[]:s,_=o.defaultOptions,$=_===void 0?DEFAULT_OPTIONS:_;return function(_n,_r,_s){_s===void 0&&(_s=$);var na={placement:"bottom",orderedModifiers:[],options:Object.assign({},DEFAULT_OPTIONS,$),modifiersData:{},elements:{reference:_n,popper:_r},attributes:{},styles:{}},ba=[],_p=!1,_f={state:na,setOptions:function(e_){var t_=typeof e_=="function"?e_(na.options):e_;_v(),na.options=Object.assign({},$,na.options,t_),na.scrollParents={reference:isElement(_n)?listScrollParents(_n):_n.contextElement?listScrollParents(_n.contextElement):[],popper:listScrollParents(_r)};var o_=orderModifiers(mergeByName([].concat(a,na.options.modifiers)));return na.orderedModifiers=o_.filter(function(m_){return m_.enabled}),_E(),_f.update()},forceUpdate:function(){if(!_p){var e_=na.elements,t_=e_.reference,o_=e_.popper;if(areValidElements(t_,o_)){na.rects={reference:getCompositeRect(t_,getOffsetParent(o_),na.options.strategy==="fixed"),popper:getLayoutRect(o_)},na.reset=!1,na.placement=na.options.placement,na.orderedModifiers.forEach(function(v_){return na.modifiersData[v_.name]=Object.assign({},v_.data)});for(var m_=0;m_<na.orderedModifiers.length;m_++){if(na.reset===!0){na.reset=!1,m_=-1;continue}var b_=na.orderedModifiers[m_],w_=b_.fn,y_=b_.options,N_=y_===void 0?{}:y_,_y=b_.name;typeof w_=="function"&&(na=w_({state:na,options:N_,name:_y,instance:_f})||na)}}}},update:debounce$1(function(){return new Promise(function(n_){_f.forceUpdate(),n_(na)})}),destroy:function(){_v(),_p=!0}};if(!areValidElements(_n,_r))return _f;_f.setOptions(_s).then(function(n_){!_p&&_s.onFirstUpdate&&_s.onFirstUpdate(n_)});function _E(){na.orderedModifiers.forEach(function(n_){var e_=n_.name,t_=n_.options,o_=t_===void 0?{}:t_,m_=n_.effect;if(typeof m_=="function"){var b_=m_({state:na,name:e_,instance:_f,options:o_}),w_=function(){};ba.push(b_||w_)}})}function _v(){ba.forEach(function(n_){return n_()}),ba=[]}return _f}}const createPopper$1=popperGenerator({defaultModifiers:[hide$1,popperOffsets$1,computeStyles$1,eventListeners,offset$1,flip$1,preventOverflow$1,arrow$1]}),_excluded$i=["enabled","placement","strategy","modifiers"];function _objectWithoutPropertiesLoose$4(e,o){if(e==null)return{};var s={},a=Object.keys(e),_,$;for($=0;$<a.length;$++)_=a[$],!(o.indexOf(_)>=0)&&(s[_]=e[_]);return s}const disabledApplyStylesModifier={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},ariaDescribedByModifier={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:e})=>()=>{const{reference:o,popper:s}=e.elements;if("removeAttribute"in o){const a=(o.getAttribute("aria-describedby")||"").split(",").filter(_=>_.trim()!==s.id);a.length?o.setAttribute("aria-describedby",a.join(",")):o.removeAttribute("aria-describedby")}},fn:({state:e})=>{var o;const{popper:s,reference:a}=e.elements,_=(o=s.getAttribute("role"))==null?void 0:o.toLowerCase();if(s.id&&_==="tooltip"&&"setAttribute"in a){const $=a.getAttribute("aria-describedby");if($&&$.split(",").indexOf(s.id)!==-1)return;a.setAttribute("aria-describedby",$?`${$},${s.id}`:s.id)}}},EMPTY_MODIFIERS=[];function usePopper(e,o,s={}){let{enabled:a=!0,placement:_="bottom",strategy:$="absolute",modifiers:_e=EMPTY_MODIFIERS}=s,_n=_objectWithoutPropertiesLoose$4(s,_excluded$i);const _r=reactExports.useRef(_e),_s=reactExports.useRef(),na=reactExports.useCallback(()=>{var n_;(n_=_s.current)==null||n_.update()},[]),ba=reactExports.useCallback(()=>{var n_;(n_=_s.current)==null||n_.forceUpdate()},[]),[_p,_f]=useSafeState(reactExports.useState({placement:_,update:na,forceUpdate:ba,attributes:{},styles:{popper:{},arrow:{}}})),_E=reactExports.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:n_})=>{const e_={},t_={};Object.keys(n_.elements).forEach(o_=>{e_[o_]=n_.styles[o_],t_[o_]=n_.attributes[o_]}),_f({state:n_,styles:e_,attributes:t_,update:na,forceUpdate:ba,placement:n_.placement})}}),[na,ba,_f]),_v=reactExports.useMemo(()=>(dequal(_r.current,_e)||(_r.current=_e),_r.current),[_e]);return reactExports.useEffect(()=>{!_s.current||!a||_s.current.setOptions({placement:_,strategy:$,modifiers:[..._v,_E,disabledApplyStylesModifier]})},[$,_,_E,a,_v]),reactExports.useEffect(()=>{if(!(!a||e==null||o==null))return _s.current=createPopper$1(e,o,Object.assign({},_n,{placement:_,strategy:$,modifiers:[..._v,ariaDescribedByModifier,_E]})),()=>{_s.current!=null&&(_s.current.destroy(),_s.current=void 0,_f(n_=>Object.assign({},n_,{attributes:{},styles:{popper:{}}})))}},[a,e,o]),_p}function contains(e,o){if(e.contains)return e.contains(o);if(e.compareDocumentPosition)return e===o||!!(e.compareDocumentPosition(o)&16)}var warning$1=function(){},warning_1=warning$1;const warning$2=getDefaultExportFromCjs(warning_1),noop$3=()=>{};function isLeftClickEvent(e){return e.button===0}function isModifiedEvent$1(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}const getRefTarget=e=>e&&("current"in e?e.current:e),InitialTriggerEvents={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function useClickOutside(e,o=noop$3,{disabled:s,clickTrigger:a="click"}={}){const _=reactExports.useRef(!1),$=reactExports.useRef(!1),_e=reactExports.useCallback(_s=>{const na=getRefTarget(e);warning$2(!!na,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),_.current=!na||isModifiedEvent$1(_s)||!isLeftClickEvent(_s)||!!contains(na,_s.target)||$.current,$.current=!1},[e]),_n=useEventCallback$1(_s=>{const na=getRefTarget(e);na&&contains(na,_s.target)&&($.current=!0)}),_r=useEventCallback$1(_s=>{_.current||o(_s)});reactExports.useEffect(()=>{var _s,na;if(s||e==null)return;const ba=ownerDocument$1(getRefTarget(e)),_p=ba.defaultView||window;let _f=(_s=_p.event)!=null?_s:(na=_p.parent)==null?void 0:na.event,_E=null;InitialTriggerEvents[a]&&(_E=listen(ba,InitialTriggerEvents[a],_n,!0));const _v=listen(ba,a,_e,!0),n_=listen(ba,a,t_=>{if(t_===_f){_f=void 0;return}_r(t_)});let e_=[];return"ontouchstart"in ba.documentElement&&(e_=[].slice.call(ba.body.children).map(t_=>listen(t_,"mousemove",noop$3))),()=>{_E==null||_E(),_v(),n_(),e_.forEach(t_=>t_())}},[e,s,a,_e,_n,_r])}function toModifierMap(e){const o={};return Array.isArray(e)?(e==null||e.forEach(s=>{o[s.name]=s}),o):e||o}function toModifierArray(e={}){return Array.isArray(e)?e:Object.keys(e).map(o=>(e[o].name=o,e[o]))}function mergeOptionsWithPopperConfig({enabled:e,enableEvents:o,placement:s,flip:a,offset:_,fixed:$,containerPadding:_e,arrowElement:_n,popperConfig:_r={}}){var _s,na,ba,_p,_f;const _E=toModifierMap(_r.modifiers);return Object.assign({},_r,{placement:s,enabled:e,strategy:$?"fixed":_r.strategy,modifiers:toModifierArray(Object.assign({},_E,{eventListeners:{enabled:o,options:(_s=_E.eventListeners)==null?void 0:_s.options},preventOverflow:Object.assign({},_E.preventOverflow,{options:_e?Object.assign({padding:_e},(na=_E.preventOverflow)==null?void 0:na.options):(ba=_E.preventOverflow)==null?void 0:ba.options}),offset:{options:Object.assign({offset:_},(_p=_E.offset)==null?void 0:_p.options)},arrow:Object.assign({},_E.arrow,{enabled:!!_n,options:Object.assign({},(_f=_E.arrow)==null?void 0:_f.options,{element:_n})}),flip:Object.assign({enabled:!!a},_E.flip)}))})}const _excluded$h=["children"];function _objectWithoutPropertiesLoose$3(e,o){if(e==null)return{};var s={},a=Object.keys(e),_,$;for($=0;$<a.length;$++)_=a[$],!(o.indexOf(_)>=0)&&(s[_]=e[_]);return s}const noop$2=()=>{};function useDropdownMenu(e={}){const o=reactExports.useContext(DropdownContext$3),[s,a]=useCallbackRef(),_=reactExports.useRef(!1),{flip:$,offset:_e,rootCloseEvent:_n,fixed:_r=!1,placement:_s,popperConfig:na={},enableEventListeners:ba=!0,usePopper:_p=!!o}=e,_f=(o==null?void 0:o.show)==null?!!e.show:o.show;_f&&!_.current&&(_.current=!0);const _E=w_=>{o==null||o.toggle(!1,w_)},{placement:_v,setMenu:n_,menuElement:e_,toggleElement:t_}=o||{},o_=usePopper(t_,e_,mergeOptionsWithPopperConfig({placement:_s||_v||"bottom-start",enabled:_p,enableEvents:ba??_f,offset:_e,flip:$,fixed:_r,arrowElement:s,popperConfig:na})),m_=Object.assign({ref:n_||noop$2,"aria-labelledby":t_==null?void 0:t_.id},o_.attributes.popper,{style:o_.styles.popper}),b_={show:_f,placement:_v,hasShown:_.current,toggle:o==null?void 0:o.toggle,popper:_p?o_:null,arrowProps:_p?Object.assign({ref:a},o_.attributes.arrow,{style:o_.styles.arrow}):{}};return useClickOutside(e_,_E,{clickTrigger:_n,disabled:!_f}),[m_,b_]}const defaultProps={usePopper:!0};function DropdownMenu$2(e){let{children:o}=e,s=_objectWithoutPropertiesLoose$3(e,_excluded$h);const[a,_]=useDropdownMenu(s);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:o(a,_)})}DropdownMenu$2.displayName="DropdownMenu";DropdownMenu$2.defaultProps=defaultProps;const $b5e257d569688ac6$var$defaultContext={prefix:String(Math.round(Math.random()*1e10)),current:0},$b5e257d569688ac6$var$SSRContext=React.createContext($b5e257d569688ac6$var$defaultContext),$b5e257d569688ac6$var$IsSSRContext=React.createContext(!1);let $b5e257d569688ac6$var$canUseDOM=!!(typeof window<"u"&&window.document&&window.document.createElement),$b5e257d569688ac6$var$componentIds=new WeakMap;function $b5e257d569688ac6$var$useCounter(e=!1){let o=reactExports.useContext($b5e257d569688ac6$var$SSRContext),s=reactExports.useRef(null);if(s.current===null&&!e){var a,_;let $=(_=React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED)===null||_===void 0||(a=_.ReactCurrentOwner)===null||a===void 0?void 0:a.current;if($){let _e=$b5e257d569688ac6$var$componentIds.get($);_e==null?$b5e257d569688ac6$var$componentIds.set($,{id:o.current,state:$.memoizedState}):$.memoizedState!==_e.state&&(o.current=_e.id,$b5e257d569688ac6$var$componentIds.delete($))}s.current=++o.current}return s.current}function $b5e257d569688ac6$var$useLegacySSRSafeId(e){let o=reactExports.useContext($b5e257d569688ac6$var$SSRContext);o===$b5e257d569688ac6$var$defaultContext&&!$b5e257d569688ac6$var$canUseDOM&&console.warn("When server rendering, you must wrap your application in an <SSRProvider> to ensure consistent ids are generated between the client and server.");let s=$b5e257d569688ac6$var$useCounter(!!e),a=`react-aria${o.prefix}`;return e||`${a}-${s}`}function $b5e257d569688ac6$var$useModernSSRSafeId(e){let o=React.useId(),[s]=reactExports.useState($b5e257d569688ac6$export$535bd6ca7f90a273()),a=s?"react-aria":`react-aria${$b5e257d569688ac6$var$defaultContext.prefix}`;return e||`${a}-${o}`}const $b5e257d569688ac6$export$619500959fc48b26=typeof React.useId=="function"?$b5e257d569688ac6$var$useModernSSRSafeId:$b5e257d569688ac6$var$useLegacySSRSafeId;function $b5e257d569688ac6$var$getSnapshot(){return!1}function $b5e257d569688ac6$var$getServerSnapshot(){return!0}function $b5e257d569688ac6$var$subscribe(e){return()=>{}}function $b5e257d569688ac6$export$535bd6ca7f90a273(){return typeof React.useSyncExternalStore=="function"?React.useSyncExternalStore($b5e257d569688ac6$var$subscribe,$b5e257d569688ac6$var$getSnapshot,$b5e257d569688ac6$var$getServerSnapshot):reactExports.useContext($b5e257d569688ac6$var$IsSSRContext)}const isRoleMenu=e=>{var o;return((o=e.getAttribute("role"))==null?void 0:o.toLowerCase())==="menu"},noop$1=()=>{};function useDropdownToggle(){const e=$b5e257d569688ac6$export$619500959fc48b26(),{show:o=!1,toggle:s=noop$1,setToggle:a,menuElement:_}=reactExports.useContext(DropdownContext$3)||{},$=reactExports.useCallback(_n=>{s(!o,_n)},[o,s]),_e={id:e,ref:a||noop$1,onClick:$,"aria-expanded":!!o};return _&&isRoleMenu(_)&&(_e["aria-haspopup"]=!0),[_e,{show:o,toggle:s}]}function DropdownToggle$2({children:e}){const[o,s]=useDropdownToggle();return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:e(o,s)})}DropdownToggle$2.displayName="DropdownToggle";const SelectableContext=reactExports.createContext(null),makeEventKey=(e,o=null)=>e!=null?String(e):o||null,SelectableContext$1=SelectableContext,NavContext=reactExports.createContext(null);NavContext.displayName="NavContext";const NavContext$1=NavContext,ATTRIBUTE_PREFIX="data-rr-ui-";function dataAttr(e){return`${ATTRIBUTE_PREFIX}${e}`}const _excluded$g=["eventKey","disabled","onClick","active","as"];function _objectWithoutPropertiesLoose$2(e,o){if(e==null)return{};var s={},a=Object.keys(e),_,$;for($=0;$<a.length;$++)_=a[$],!(o.indexOf(_)>=0)&&(s[_]=e[_]);return s}function useDropdownItem({key:e,href:o,active:s,disabled:a,onClick:_}){const $=reactExports.useContext(SelectableContext$1),_e=reactExports.useContext(NavContext$1),{activeKey:_n}=_e||{},_r=makeEventKey(e,o),_s=s==null&&e!=null?makeEventKey(_n)===_r:s;return[{onClick:useEventCallback$1(ba=>{a||(_==null||_(ba),$&&!ba.isPropagationStopped()&&$(_r,ba))}),"aria-disabled":a||void 0,"aria-selected":_s,[dataAttr("dropdown-item")]:""},{isActive:_s}]}const DropdownItem$2=reactExports.forwardRef((e,o)=>{let{eventKey:s,disabled:a,onClick:_,active:$,as:_e=Button$3}=e,_n=_objectWithoutPropertiesLoose$2(e,_excluded$g);const[_r]=useDropdownItem({key:s,href:_n.href,disabled:a,onClick:_,active:$});return jsxRuntimeExports.jsx(_e,Object.assign({},_n,{ref:o},_r))});DropdownItem$2.displayName="DropdownItem";const Context=reactExports.createContext(canUseDOM?window:void 0);Context.Provider;function useWindow(){return reactExports.useContext(Context)}function useRefWithUpdate(){const e=useForceUpdate(),o=reactExports.useRef(null),s=reactExports.useCallback(a=>{o.current=a,e()},[e]);return[o,s]}function Dropdown$2({defaultShow:e,show:o,onSelect:s,onToggle:a,itemSelector:_=`* [${dataAttr("dropdown-item")}]`,focusFirstItemOnShow:$,placement:_e="bottom-start",children:_n}){const _r=useWindow(),[_s,na]=useUncontrolledProp(o,e,a),[ba,_p]=useRefWithUpdate(),_f=ba.current,[_E,_v]=useRefWithUpdate(),n_=_E.current,e_=usePrevious(_s),t_=reactExports.useRef(null),o_=reactExports.useRef(!1),m_=reactExports.useContext(SelectableContext$1),b_=reactExports.useCallback((A_,k_,P_=k_==null?void 0:k_.type)=>{na(A_,{originalEvent:k_,source:P_})},[na]),w_=useEventCallback$1((A_,k_)=>{s==null||s(A_,k_),b_(!1,k_,"select"),k_.isPropagationStopped()||m_==null||m_(A_,k_)}),y_=reactExports.useMemo(()=>({toggle:b_,placement:_e,show:_s,menuElement:_f,toggleElement:n_,setMenu:_p,setToggle:_v}),[b_,_e,_s,_f,n_,_p,_v]);_f&&e_&&!_s&&(o_.current=_f.contains(_f.ownerDocument.activeElement));const N_=useEventCallback$1(()=>{n_&&n_.focus&&n_.focus()}),_y=useEventCallback$1(()=>{const A_=t_.current;let k_=$;if(k_==null&&(k_=ba.current&&isRoleMenu(ba.current)?"keyboard":!1),k_===!1||k_==="keyboard"&&!/^key.+$/.test(A_))return;const P_=qsa(ba.current,_)[0];P_&&P_.focus&&P_.focus()});reactExports.useEffect(()=>{_s?_y():o_.current&&(o_.current=!1,N_())},[_s,o_,N_,_y]),reactExports.useEffect(()=>{t_.current=null});const v_=(A_,k_)=>{if(!ba.current)return null;const P_=qsa(ba.current,_);let T_=P_.indexOf(A_)+k_;return T_=Math.max(0,Math.min(T_,P_.length)),P_[T_]};return useEventListener(reactExports.useCallback(()=>_r.document,[_r]),"keydown",A_=>{var k_,P_;const{key:T_}=A_,R_=A_.target,I_=(k_=ba.current)==null?void 0:k_.contains(R_),U_=(P_=_E.current)==null?void 0:P_.contains(R_);if(/input|textarea/i.test(R_.tagName)&&(T_===" "||T_!=="Escape"&&I_||T_==="Escape"&&R_.type==="search")||!I_&&!U_||T_==="Tab"&&(!ba.current||!_s))return;t_.current=A_.type;const n0={originalEvent:A_,source:A_.type};switch(T_){case"ArrowUp":{const a_=v_(R_,-1);a_&&a_.focus&&a_.focus(),A_.preventDefault();return}case"ArrowDown":if(A_.preventDefault(),!_s)na(!0,n0);else{const a_=v_(R_,1);a_&&a_.focus&&a_.focus()}return;case"Tab":addEventListener$1(R_.ownerDocument,"keyup",a_=>{var s_;(a_.key==="Tab"&&!a_.target||!((s_=ba.current)!=null&&s_.contains(a_.target)))&&na(!1,n0)},{once:!0});break;case"Escape":T_==="Escape"&&(A_.preventDefault(),A_.stopPropagation()),na(!1,n0);break}}),jsxRuntimeExports.jsx(SelectableContext$1.Provider,{value:w_,children:jsxRuntimeExports.jsx(DropdownContext$3.Provider,{value:y_,children:_n})})}Dropdown$2.displayName="Dropdown";Dropdown$2.Menu=DropdownMenu$2;Dropdown$2.Toggle=DropdownToggle$2;Dropdown$2.Item=DropdownItem$2;const DropdownContext=reactExports.createContext({});DropdownContext.displayName="DropdownContext";const DropdownContext$1=DropdownContext,DropdownDivider=reactExports.forwardRef(({className:e,bsPrefix:o,as:s="hr",role:a="separator",..._},$)=>(o=useBootstrapPrefix(o,"dropdown-divider"),jsxRuntimeExports.jsx(s,{ref:$,className:classNames(e,o),role:a,..._})));DropdownDivider.displayName="DropdownDivider";const DropdownDivider$1=DropdownDivider,DropdownHeader=reactExports.forwardRef(({className:e,bsPrefix:o,as:s="div",role:a="heading",..._},$)=>(o=useBootstrapPrefix(o,"dropdown-header"),jsxRuntimeExports.jsx(s,{ref:$,className:classNames(e,o),role:a,..._})));DropdownHeader.displayName="DropdownHeader";const DropdownHeader$1=DropdownHeader,DropdownItem=reactExports.forwardRef(({bsPrefix:e,className:o,eventKey:s,disabled:a=!1,onClick:_,active:$,as:_e=Anchor$1,..._n},_r)=>{const _s=useBootstrapPrefix(e,"dropdown-item"),[na,ba]=useDropdownItem({key:s,href:_n.href,disabled:a,onClick:_,active:$});return jsxRuntimeExports.jsx(_e,{..._n,...na,ref:_r,className:classNames(o,_s,ba.isActive&&"active",a&&"disabled")})});DropdownItem.displayName="DropdownItem";const DropdownItem$1=DropdownItem,DropdownItemText=reactExports.forwardRef(({className:e,bsPrefix:o,as:s="span",...a},_)=>(o=useBootstrapPrefix(o,"dropdown-item-text"),jsxRuntimeExports.jsx(s,{ref:_,className:classNames(e,o),...a})));DropdownItemText.displayName="DropdownItemText";const DropdownItemText$1=DropdownItemText,context$1=reactExports.createContext(null);context$1.displayName="InputGroupContext";const InputGroupContext=context$1,context=reactExports.createContext(null);context.displayName="NavbarContext";const NavbarContext=context;function useWrappedRefWithWarning(e,o){return e}function getDropdownMenuPlacement(e,o,s){const a=s?"top-end":"top-start",_=s?"top-start":"top-end",$=s?"bottom-end":"bottom-start",_e=s?"bottom-start":"bottom-end",_n=s?"right-start":"left-start",_r=s?"right-end":"left-end",_s=s?"left-start":"right-start",na=s?"left-end":"right-end";let ba=e?_e:$;return o==="up"?ba=e?_:a:o==="end"?ba=e?na:_s:o==="start"?ba=e?_r:_n:o==="down-centered"?ba="bottom":o==="up-centered"&&(ba="top"),ba}const DropdownMenu=reactExports.forwardRef(({bsPrefix:e,className:o,align:s,rootCloseEvent:a,flip:_=!0,show:$,renderOnMount:_e,as:_n="div",popperConfig:_r,variant:_s,...na},ba)=>{let _p=!1;const _f=reactExports.useContext(NavbarContext),_E=useBootstrapPrefix(e,"dropdown-menu"),{align:_v,drop:n_,isRTL:e_}=reactExports.useContext(DropdownContext$1);s=s||_v;const t_=reactExports.useContext(InputGroupContext),o_=[];if(s)if(typeof s=="object"){const A_=Object.keys(s);if(A_.length){const k_=A_[0],P_=s[k_];_p=P_==="start",o_.push(`${_E}-${k_}-${P_}`)}}else s==="end"&&(_p=!0);const m_=getDropdownMenuPlacement(_p,n_,e_),[b_,{hasShown:w_,popper:y_,show:N_,toggle:_y}]=useDropdownMenu({flip:_,rootCloseEvent:a,show:$,usePopper:!_f&&o_.length===0,offset:[0,2],popperConfig:_r,placement:m_});if(b_.ref=useMergedRefs(useWrappedRefWithWarning(ba),b_.ref),useIsomorphicEffect(()=>{N_&&(y_==null||y_.update())},[N_]),!w_&&!_e&&!t_)return null;typeof _n!="string"&&(b_.show=N_,b_.close=()=>_y==null?void 0:_y(!1),b_.align=s);let v_=na.style;return y_!=null&&y_.placement&&(v_={...na.style,...b_.style},na["x-placement"]=y_.placement),jsxRuntimeExports.jsx(_n,{...na,...b_,style:v_,...(o_.length||_f)&&{"data-bs-popper":"static"},className:classNames(o,_E,N_&&"show",_p&&`${_E}-end`,_s&&`${_E}-${_s}`,...o_)})});DropdownMenu.displayName="DropdownMenu";const DropdownMenu$1=DropdownMenu,DropdownToggle=reactExports.forwardRef(({bsPrefix:e,split:o,className:s,childBsPrefix:a,as:_=Button$2,...$},_e)=>{const _n=useBootstrapPrefix(e,"dropdown-toggle"),_r=reactExports.useContext(DropdownContext$3);a!==void 0&&($.bsPrefix=a);const[_s]=useDropdownToggle();return _s.ref=useMergedRefs(_s.ref,useWrappedRefWithWarning(_e)),jsxRuntimeExports.jsx(_,{className:classNames(s,_n,o&&`${_n}-split`,(_r==null?void 0:_r.show)&&"show"),..._s,...$})});DropdownToggle.displayName="DropdownToggle";const DropdownToggle$1=DropdownToggle,Dropdown=reactExports.forwardRef((e,o)=>{const{bsPrefix:s,drop:a="down",show:_,className:$,align:_e="start",onSelect:_n,onToggle:_r,focusFirstItemOnShow:_s,as:na="div",navbar:ba,autoClose:_p=!0,..._f}=useUncontrolled(e,{show:"onToggle"}),_E=reactExports.useContext(InputGroupContext),_v=useBootstrapPrefix(s,"dropdown"),n_=useIsRTL(),e_=y_=>_p===!1?y_==="click":_p==="inside"?y_!=="rootClose":_p==="outside"?y_!=="select":!0,t_=useEventCallback$1((y_,N_)=>{N_.originalEvent.currentTarget===document&&(N_.source!=="keydown"||N_.originalEvent.key==="Escape")&&(N_.source="rootClose"),e_(N_.source)&&(_r==null||_r(y_,N_))}),m_=getDropdownMenuPlacement(_e==="end",a,n_),b_=reactExports.useMemo(()=>({align:_e,drop:a,isRTL:n_}),[_e,a,n_]),w_={down:_v,"down-centered":`${_v}-center`,up:"dropup","up-centered":"dropup-center dropup",end:"dropend",start:"dropstart"};return jsxRuntimeExports.jsx(DropdownContext$1.Provider,{value:b_,children:jsxRuntimeExports.jsx(Dropdown$2,{placement:m_,show:_,onSelect:_n,onToggle:t_,focusFirstItemOnShow:_s,itemSelector:`.${_v}-item:not(.disabled):not(:disabled)`,children:_E?_f.children:jsxRuntimeExports.jsx(na,{..._f,ref:o,className:classNames($,_&&"show",w_[a])})})})});Dropdown.displayName="Dropdown";const Dropdown$1=Object.assign(Dropdown,{Toggle:DropdownToggle$1,Menu:DropdownMenu$1,Item:DropdownItem$1,ItemText:DropdownItemText$1,Divider:DropdownDivider$1,Header:DropdownHeader$1});var DefaultContext={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},IconContext=React.createContext&&React.createContext(DefaultContext),__assign=function(){return __assign=Object.assign||function(e){for(var o,s=1,a=arguments.length;s<a;s++){o=arguments[s];for(var _ in o)Object.prototype.hasOwnProperty.call(o,_)&&(e[_]=o[_])}return e},__assign.apply(this,arguments)},__rest=function(e,o){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&o.indexOf(a)<0&&(s[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var _=0,a=Object.getOwnPropertySymbols(e);_<a.length;_++)o.indexOf(a[_])<0&&Object.prototype.propertyIsEnumerable.call(e,a[_])&&(s[a[_]]=e[a[_]]);return s};function Tree2Element(e){return e&&e.map(function(o,s){return React.createElement(o.tag,__assign({key:s},o.attr),Tree2Element(o.child))})}function GenIcon(e){return function(o){return React.createElement(IconBase,__assign({attr:__assign({},e.attr)},o),Tree2Element(e.child))}}function IconBase(e){var o=function(s){var a=e.attr,_=e.size,$=e.title,_e=__rest(e,["attr","size","title"]),_n=_||s.size||"1em",_r;return s.className&&(_r=s.className),e.className&&(_r=(_r?_r+" ":"")+e.className),React.createElement("svg",__assign({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},s.attr,a,_e,{className:_r,style:__assign(__assign({color:e.color||s.color},s.style),e.style),height:_n,width:_n,xmlns:"http://www.w3.org/2000/svg"}),$&&React.createElement("title",null,$),e.children)};return IconContext!==void 0?React.createElement(IconContext.Consumer,null,function(s){return o(s)}):o(DefaultContext)}function CgEnter(e){return GenIcon({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M20 5H8V9H6V3H22V21H6V15H8V19H20V5Z",fill:"currentColor"}},{tag:"path",attr:{d:"M13.0743 16.9498L11.6601 15.5356L14.1957 13H2V11H14.1956L11.6601 8.46451L13.0743 7.05029L18.024 12L13.0743 16.9498Z",fill:"currentColor"}}]})(e)}function RiVideoAddFill(e){return GenIcon({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M16 4C16.5523 4 17 4.44772 17 5V9.2L22.2133 5.55071C22.4395 5.39235 22.7513 5.44737 22.9096 5.6736C22.9684 5.75764 23 5.85774 23 5.96033V18.0397C23 18.3158 22.7761 18.5397 22.5 18.5397C22.3974 18.5397 22.2973 18.5081 22.2133 18.4493L17 14.8V19C17 19.5523 16.5523 20 16 20H2C1.44772 20 1 19.5523 1 19V5C1 4.44772 1.44772 4 2 4H16ZM8 8V11H5V13H7.999L8 16H10L9.999 13H13V11H10V8H8Z"}}]})(e)}/**
 * @remix-run/router v1.14.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},_extends$2.apply(this,arguments)}var Action;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(e){e===void 0&&(e={});function o(a,_){let{pathname:$,search:_e,hash:_n}=a.location;return createLocation("",{pathname:$,search:_e,hash:_n},_.state&&_.state.usr||null,_.state&&_.state.key||"default")}function s(a,_){return typeof _=="string"?_:createPath(_)}return getUrlBasedHistory(o,s,null,e)}function invariant(e,o){if(e===!1||e===null||typeof e>"u")throw new Error(o)}function warning(e,o){if(!e){typeof console<"u"&&console.warn(o);try{throw new Error(o)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(e,o){return{usr:e.state,key:e.key,idx:o}}function createLocation(e,o,s,a){return s===void 0&&(s=null),_extends$2({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof o=="string"?parsePath(o):o,{state:s,key:o&&o.key||a||createKey()})}function createPath(e){let{pathname:o="/",search:s="",hash:a=""}=e;return s&&s!=="?"&&(o+=s.charAt(0)==="?"?s:"?"+s),a&&a!=="#"&&(o+=a.charAt(0)==="#"?a:"#"+a),o}function parsePath(e){let o={};if(e){let s=e.indexOf("#");s>=0&&(o.hash=e.substr(s),e=e.substr(0,s));let a=e.indexOf("?");a>=0&&(o.search=e.substr(a),e=e.substr(0,a)),e&&(o.pathname=e)}return o}function getUrlBasedHistory(e,o,s,a){a===void 0&&(a={});let{window:_=document.defaultView,v5Compat:$=!1}=a,_e=_.history,_n=Action.Pop,_r=null,_s=na();_s==null&&(_s=0,_e.replaceState(_extends$2({},_e.state,{idx:_s}),""));function na(){return(_e.state||{idx:null}).idx}function ba(){_n=Action.Pop;let n_=na(),e_=n_==null?null:n_-_s;_s=n_,_r&&_r({action:_n,location:_v.location,delta:e_})}function _p(n_,e_){_n=Action.Push;let t_=createLocation(_v.location,n_,e_);s&&s(t_,n_),_s=na()+1;let o_=getHistoryState(t_,_s),m_=_v.createHref(t_);try{_e.pushState(o_,"",m_)}catch(b_){if(b_ instanceof DOMException&&b_.name==="DataCloneError")throw b_;_.location.assign(m_)}$&&_r&&_r({action:_n,location:_v.location,delta:1})}function _f(n_,e_){_n=Action.Replace;let t_=createLocation(_v.location,n_,e_);s&&s(t_,n_),_s=na();let o_=getHistoryState(t_,_s),m_=_v.createHref(t_);_e.replaceState(o_,"",m_),$&&_r&&_r({action:_n,location:_v.location,delta:0})}function _E(n_){let e_=_.location.origin!=="null"?_.location.origin:_.location.href,t_=typeof n_=="string"?n_:createPath(n_);return invariant(e_,"No window.location.(origin|href) available to create URL for href: "+t_),new URL(t_,e_)}let _v={get action(){return _n},get location(){return e(_,_e)},listen(n_){if(_r)throw new Error("A history only accepts one active listener");return _.addEventListener(PopStateEventType,ba),_r=n_,()=>{_.removeEventListener(PopStateEventType,ba),_r=null}},createHref(n_){return o(_,n_)},createURL:_E,encodeLocation(n_){let e_=_E(n_);return{pathname:e_.pathname,search:e_.search,hash:e_.hash}},push:_p,replace:_f,go(n_){return _e.go(n_)}};return _v}var ResultType;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(ResultType||(ResultType={}));function matchRoutes(e,o,s){s===void 0&&(s="/");let a=typeof o=="string"?parsePath(o):o,_=stripBasename(a.pathname||"/",s);if(_==null)return null;let $=flattenRoutes(e);rankRouteBranches($);let _e=null;for(let _n=0;_e==null&&_n<$.length;++_n)_e=matchRouteBranch($[_n],safelyDecodeURI(_));return _e}function flattenRoutes(e,o,s,a){o===void 0&&(o=[]),s===void 0&&(s=[]),a===void 0&&(a="");let _=($,_e,_n)=>{let _r={relativePath:_n===void 0?$.path||"":_n,caseSensitive:$.caseSensitive===!0,childrenIndex:_e,route:$};_r.relativePath.startsWith("/")&&(invariant(_r.relativePath.startsWith(a),'Absolute route path "'+_r.relativePath+'" nested under path '+('"'+a+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),_r.relativePath=_r.relativePath.slice(a.length));let _s=joinPaths([a,_r.relativePath]),na=s.concat(_r);$.children&&$.children.length>0&&(invariant($.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_s+'".')),flattenRoutes($.children,o,na,_s)),!($.path==null&&!$.index)&&o.push({path:_s,score:computeScore(_s,$.index),routesMeta:na})};return e.forEach(($,_e)=>{var _n;if($.path===""||!((_n=$.path)!=null&&_n.includes("?")))_($,_e);else for(let _r of explodeOptionalSegments($.path))_($,_e,_r)}),o}function explodeOptionalSegments(e){let o=e.split("/");if(o.length===0)return[];let[s,...a]=o,_=s.endsWith("?"),$=s.replace(/\?$/,"");if(a.length===0)return _?[$,""]:[$];let _e=explodeOptionalSegments(a.join("/")),_n=[];return _n.push(..._e.map(_r=>_r===""?$:[$,_r].join("/"))),_&&_n.push(..._e),_n.map(_r=>e.startsWith("/")&&_r===""?"/":_r)}function rankRouteBranches(e){e.sort((o,s)=>o.score!==s.score?s.score-o.score:compareIndexes(o.routesMeta.map(a=>a.childrenIndex),s.routesMeta.map(a=>a.childrenIndex)))}const paramRe=/^:\w+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,o){let s=e.split("/"),a=s.length;return s.some(isSplat)&&(a+=splatPenalty),o&&(a+=indexRouteValue),s.filter(_=>!isSplat(_)).reduce((_,$)=>_+(paramRe.test($)?dynamicSegmentValue:$===""?emptySegmentValue:staticSegmentValue),a)}function compareIndexes(e,o){return e.length===o.length&&e.slice(0,-1).every((a,_)=>a===o[_])?e[e.length-1]-o[o.length-1]:0}function matchRouteBranch(e,o){let{routesMeta:s}=e,a={},_="/",$=[];for(let _e=0;_e<s.length;++_e){let _n=s[_e],_r=_e===s.length-1,_s=_==="/"?o:o.slice(_.length)||"/",na=matchPath({path:_n.relativePath,caseSensitive:_n.caseSensitive,end:_r},_s);if(!na)return null;Object.assign(a,na.params);let ba=_n.route;$.push({params:a,pathname:joinPaths([_,na.pathname]),pathnameBase:normalizePathname(joinPaths([_,na.pathnameBase])),route:ba}),na.pathnameBase!=="/"&&(_=joinPaths([_,na.pathnameBase]))}return $}function matchPath(e,o){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[s,a]=compilePath(e.path,e.caseSensitive,e.end),_=o.match(s);if(!_)return null;let $=_[0],_e=$.replace(/(.)\/+$/,"$1"),_n=_.slice(1);return{params:a.reduce((_s,na,ba)=>{let{paramName:_p,isOptional:_f}=na;if(_p==="*"){let _v=_n[ba]||"";_e=$.slice(0,$.length-_v.length).replace(/(.)\/+$/,"$1")}const _E=_n[ba];return _f&&!_E?_s[_p]=void 0:_s[_p]=safelyDecodeURIComponent(_E||"",_p),_s},{}),pathname:$,pathnameBase:_e,pattern:e}}function compilePath(e,o,s){o===void 0&&(o=!1),s===void 0&&(s=!0),warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let a=[],_="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(_e,_n,_r)=>(a.push({paramName:_n,isOptional:_r!=null}),_r?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),_+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?_+="\\/*$":e!==""&&e!=="/"&&(_+="(?:(?=\\/|$))"),[new RegExp(_,o?void 0:"i"),a]}function safelyDecodeURI(e){try{return decodeURI(e)}catch(o){return warning(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+o+").")),e}}function safelyDecodeURIComponent(e,o){try{return decodeURIComponent(e)}catch(s){return warning(!1,'The value for the URL param "'+o+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+s+").")),e}}function stripBasename(e,o){if(o==="/")return e;if(!e.toLowerCase().startsWith(o.toLowerCase()))return null;let s=o.endsWith("/")?o.length-1:o.length,a=e.charAt(s);return a&&a!=="/"?null:e.slice(s)||"/"}function resolvePath(e,o){o===void 0&&(o="/");let{pathname:s,search:a="",hash:_=""}=typeof e=="string"?parsePath(e):e;return{pathname:s?s.startsWith("/")?s:resolvePathname(s,o):o,search:normalizeSearch(a),hash:normalizeHash(_)}}function resolvePathname(e,o){let s=o.replace(/\/+$/,"").split("/");return e.split("/").forEach(_=>{_===".."?s.length>1&&s.pop():_!=="."&&s.push(_)}),s.length>1?s.join("/"):"/"}function getInvalidPathError(e,o,s,a){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+o+"` field ["+JSON.stringify(a)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(e){return e.filter((o,s)=>s===0||o.route.path&&o.route.path.length>0)}function getResolveToMatches(e,o){let s=getPathContributingMatches(e);return o?s.map((a,_)=>_===e.length-1?a.pathname:a.pathnameBase):s.map(a=>a.pathnameBase)}function resolveTo(e,o,s,a){a===void 0&&(a=!1);let _;typeof e=="string"?_=parsePath(e):(_=_extends$2({},e),invariant(!_.pathname||!_.pathname.includes("?"),getInvalidPathError("?","pathname","search",_)),invariant(!_.pathname||!_.pathname.includes("#"),getInvalidPathError("#","pathname","hash",_)),invariant(!_.search||!_.search.includes("#"),getInvalidPathError("#","search","hash",_)));let $=e===""||_.pathname==="",_e=$?"/":_.pathname,_n;if(_e==null)_n=s;else if(a){let ba=o.length===0?[]:o[o.length-1].replace(/^\//,"").split("/");if(_e.startsWith("..")){let _p=_e.split("/");for(;_p[0]==="..";)_p.shift(),ba.pop();_.pathname=_p.join("/")}_n="/"+ba.join("/")}else{let ba=o.length-1;if(_e.startsWith("..")){let _p=_e.split("/");for(;_p[0]==="..";)_p.shift(),ba-=1;_.pathname=_p.join("/")}_n=ba>=0?o[ba]:"/"}let _r=resolvePath(_,_n),_s=_e&&_e!=="/"&&_e.endsWith("/"),na=($||_e===".")&&s.endsWith("/");return!_r.pathname.endsWith("/")&&(_s||na)&&(_r.pathname+="/"),_r}const joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},_extends$1.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(e,o){let{relative:s}=o===void 0?{}:o;useInRouterContext()||invariant(!1);let{basename:a,navigator:_}=reactExports.useContext(NavigationContext),{hash:$,pathname:_e,search:_n}=useResolvedPath(e,{relative:s}),_r=_e;return a!=="/"&&(_r=_e==="/"?a:joinPaths([a,_e])),_.createHref({pathname:_r,search:_n,hash:$})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant(!1);let e=reactExports.useContext(DataRouterContext),{basename:o,future:s,navigator:a}=reactExports.useContext(NavigationContext),{matches:_}=reactExports.useContext(RouteContext),{pathname:$}=useLocation(),_e=JSON.stringify(getResolveToMatches(_,s.v7_relativeSplatPath)),_n=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{_n.current=!0}),reactExports.useCallback(function(_s,na){if(na===void 0&&(na={}),!_n.current)return;if(typeof _s=="number"){a.go(_s);return}let ba=resolveTo(_s,JSON.parse(_e),$,na.relative==="path");e==null&&o!=="/"&&(ba.pathname=ba.pathname==="/"?o:joinPaths([o,ba.pathname])),(na.replace?a.replace:a.push)(ba,na.state,na)},[o,a,_e,$,e])}function useParams(){let{matches:e}=reactExports.useContext(RouteContext),o=e[e.length-1];return o?o.params:{}}function useResolvedPath(e,o){let{relative:s}=o===void 0?{}:o,{future:a}=reactExports.useContext(NavigationContext),{matches:_}=reactExports.useContext(RouteContext),{pathname:$}=useLocation(),_e=JSON.stringify(getResolveToMatches(_,a.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(_e),$,s==="path"),[e,_e,$,s])}function useRoutes(e,o){return useRoutesImpl(e,o)}function useRoutesImpl(e,o,s,a){useInRouterContext()||invariant(!1);let{navigator:_}=reactExports.useContext(NavigationContext),{matches:$}=reactExports.useContext(RouteContext),_e=$[$.length-1],_n=_e?_e.params:{};_e&&_e.pathname;let _r=_e?_e.pathnameBase:"/";_e&&_e.route;let _s=useLocation(),na;if(o){var ba;let n_=typeof o=="string"?parsePath(o):o;_r==="/"||(ba=n_.pathname)!=null&&ba.startsWith(_r)||invariant(!1),na=n_}else na=_s;let _p=na.pathname||"/",_f=_r==="/"?_p:_p.slice(_r.length)||"/",_E=matchRoutes(e,{pathname:_f}),_v=_renderMatches(_E&&_E.map(n_=>Object.assign({},n_,{params:Object.assign({},_n,n_.params),pathname:joinPaths([_r,_.encodeLocation?_.encodeLocation(n_.pathname).pathname:n_.pathname]),pathnameBase:n_.pathnameBase==="/"?_r:joinPaths([_r,_.encodeLocation?_.encodeLocation(n_.pathnameBase).pathname:n_.pathnameBase])})),$,s,a);return o&&_v?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},na),navigationType:Action.Pop}},_v):_v}function DefaultErrorComponent(){let e=useRouteError(),o=isRouteErrorResponse(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,_={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},$=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},o),s?reactExports.createElement("pre",{style:_},s):null,$)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(o){super(o),this.state={location:o.location,revalidation:o.revalidation,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,s){return s.location!==o.location||s.revalidation!=="idle"&&o.revalidation==="idle"?{error:o.error,location:o.location,revalidation:o.revalidation}:{error:o.error!==void 0?o.error:s.error,location:s.location,revalidation:o.revalidation||s.revalidation}}componentDidCatch(o,s){console.error("React Router caught the following error during render",o,s)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(e){let{routeContext:o,match:s,children:a}=e,_=reactExports.useContext(DataRouterContext);return _&&_.static&&_.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(_.staticContext._deepestRenderedBoundaryId=s.route.id),reactExports.createElement(RouteContext.Provider,{value:o},a)}function _renderMatches(e,o,s,a){var _;if(o===void 0&&(o=[]),s===void 0&&(s=null),a===void 0&&(a=null),e==null){var $;if(($=s)!=null&&$.errors)e=s.matches;else return null}let _e=e,_n=(_=s)==null?void 0:_.errors;if(_n!=null){let na=_e.findIndex(ba=>ba.route.id&&(_n==null?void 0:_n[ba.route.id]));na>=0||invariant(!1),_e=_e.slice(0,Math.min(_e.length,na+1))}let _r=!1,_s=-1;if(s&&a&&a.v7_partialHydration)for(let na=0;na<_e.length;na++){let ba=_e[na];if((ba.route.HydrateFallback||ba.route.hydrateFallbackElement)&&(_s=na),ba.route.loader&&ba.route.id&&s.loaderData[ba.route.id]===void 0&&(!s.errors||s.errors[ba.route.id]===void 0)){_r=!0,_s>=0?_e=_e.slice(0,_s+1):_e=[_e[0]];break}}return _e.reduceRight((na,ba,_p)=>{let _f,_E=!1,_v=null,n_=null;s&&(_f=_n&&ba.route.id?_n[ba.route.id]:void 0,_v=ba.route.errorElement||defaultErrorElement,_r&&(_s<0&&_p===0?(warningOnce("route-fallback",!1),_E=!0,n_=null):_s===_p&&(_E=!0,n_=ba.route.hydrateFallbackElement||null)));let e_=o.concat(_e.slice(0,_p+1)),t_=()=>{let o_;return _f?o_=_v:_E?o_=n_:ba.route.Component?o_=reactExports.createElement(ba.route.Component,null):ba.route.element?o_=ba.route.element:o_=na,reactExports.createElement(RenderedRoute,{match:ba,routeContext:{outlet:na,matches:e_,isDataRoute:s!=null},children:o_})};return s&&(ba.route.ErrorBoundary||ba.route.errorElement||_p===0)?reactExports.createElement(RenderErrorBoundary,{location:s.location,revalidation:s.revalidation,component:_v,error:_f,children:t_(),routeContext:{outlet:null,matches:e_,isDataRoute:!0}}):t_()},null)}var DataRouterHook$1=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(DataRouterHook$1||{}),DataRouterStateHook$1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(DataRouterStateHook$1||{});function useDataRouterContext(e){let o=reactExports.useContext(DataRouterContext);return o||invariant(!1),o}function useDataRouterState(e){let o=reactExports.useContext(DataRouterStateContext);return o||invariant(!1),o}function useRouteContext(e){let o=reactExports.useContext(RouteContext);return o||invariant(!1),o}function useCurrentRouteId(e){let o=useRouteContext(),s=o.matches[o.matches.length-1];return s.route.id||invariant(!1),s.route.id}function useRouteError(){var e;let o=reactExports.useContext(RouteErrorContext),s=useDataRouterState(DataRouterStateHook$1.UseRouteError),a=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return o!==void 0?o:(e=s.errors)==null?void 0:e[a]}function useNavigateStable(){let{router:e}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),o=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),s=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{s.current=!0}),reactExports.useCallback(function(_,$){$===void 0&&($={}),s.current&&(typeof _=="number"?e.navigate(_):e.navigate(_,_extends$1({fromRouteId:o},$)))},[e,o])}const alreadyWarned={};function warningOnce(e,o,s){!o&&!alreadyWarned[e]&&(alreadyWarned[e]=!0)}function Route(e){invariant(!1)}function Router(e){let{basename:o="/",children:s=null,location:a,navigationType:_=Action.Pop,navigator:$,static:_e=!1,future:_n}=e;useInRouterContext()&&invariant(!1);let _r=o.replace(/^\/*/,"/"),_s=reactExports.useMemo(()=>({basename:_r,navigator:$,static:_e,future:_extends$1({v7_relativeSplatPath:!1},_n)}),[_r,_n,$,_e]);typeof a=="string"&&(a=parsePath(a));let{pathname:na="/",search:ba="",hash:_p="",state:_f=null,key:_E="default"}=a,_v=reactExports.useMemo(()=>{let n_=stripBasename(na,_r);return n_==null?null:{location:{pathname:n_,search:ba,hash:_p,state:_f,key:_E},navigationType:_}},[_r,na,ba,_p,_f,_E,_]);return _v==null?null:reactExports.createElement(NavigationContext.Provider,{value:_s},reactExports.createElement(LocationContext.Provider,{children:s,value:_v}))}function Routes(e){let{children:o,location:s}=e;return useRoutes(createRoutesFromChildren(o),s)}new Promise(()=>{});function createRoutesFromChildren(e,o){o===void 0&&(o=[]);let s=[];return reactExports.Children.forEach(e,(a,_)=>{if(!reactExports.isValidElement(a))return;let $=[...o,_];if(a.type===reactExports.Fragment){s.push.apply(s,createRoutesFromChildren(a.props.children,$));return}a.type!==Route&&invariant(!1),!a.props.index||!a.props.children||invariant(!1);let _e={id:a.props.id||$.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(_e.children=createRoutesFromChildren(a.props.children,$)),s.push(_e)}),s}/**
 * React Router DOM v6.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(e){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose$1(e,o){if(e==null)return{};var s={},a=Object.keys(e),_,$;for($=0;$<a.length;$++)_=a[$],!(o.indexOf(_)>=0)&&(s[_]=e[_]);return s}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,o){return e.button===0&&(!o||o==="_self")&&!isModifiedEvent(e)}const _excluded$f=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],START_TRANSITION="startTransition",startTransitionImpl=React$1[START_TRANSITION];function BrowserRouter(e){let{basename:o,children:s,future:a,window:_}=e,$=reactExports.useRef();$.current==null&&($.current=createBrowserHistory({window:_,v5Compat:!0}));let _e=$.current,[_n,_r]=reactExports.useState({action:_e.action,location:_e.location}),{v7_startTransition:_s}=a||{},na=reactExports.useCallback(ba=>{_s&&startTransitionImpl?startTransitionImpl(()=>_r(ba)):_r(ba)},[_r,_s]);return reactExports.useLayoutEffect(()=>_e.listen(na),[_e,na]),reactExports.createElement(Router,{basename:o,children:s,location:_n.location,navigationType:_n.action,navigator:_e,future:a})}const isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function(o,s){let{onClick:a,relative:_,reloadDocument:$,replace:_e,state:_n,target:_r,to:_s,preventScrollReset:na,unstable_viewTransition:ba}=o,_p=_objectWithoutPropertiesLoose$1(o,_excluded$f),{basename:_f}=reactExports.useContext(NavigationContext),_E,_v=!1;if(typeof _s=="string"&&ABSOLUTE_URL_REGEX.test(_s)&&(_E=_s,isBrowser$1))try{let o_=new URL(window.location.href),m_=_s.startsWith("//")?new URL(o_.protocol+_s):new URL(_s),b_=stripBasename(m_.pathname,_f);m_.origin===o_.origin&&b_!=null?_s=b_+m_.search+m_.hash:_v=!0}catch{}let n_=useHref(_s,{relative:_}),e_=useLinkClickHandler(_s,{replace:_e,state:_n,target:_r,preventScrollReset:na,relative:_,unstable_viewTransition:ba});function t_(o_){a&&a(o_),o_.defaultPrevented||e_(o_)}return reactExports.createElement("a",_extends({},_p,{href:_E||n_,onClick:_v||$?a:t_,ref:s,target:_r}))});var DataRouterHook;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(e,o){let{target:s,replace:a,state:_,preventScrollReset:$,relative:_e,unstable_viewTransition:_n}=o===void 0?{}:o,_r=useNavigate(),_s=useLocation(),na=useResolvedPath(e,{relative:_e});return reactExports.useCallback(ba=>{if(shouldProcessLinkClick(ba,s)){ba.preventDefault();let _p=a!==void 0?a:createPath(_s)===createPath(na);_r(e,{replace:_p,state:_,preventScrollReset:$,relative:_e,unstable_viewTransition:_n})}},[_s,_r,na,a,_,s,e,$,_e,_n])}var Groups2={},interopRequireDefault={exports:{}};(function(e){function o(s){return s&&s.__esModule?s:{default:s}}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports})(interopRequireDefault);var interopRequireDefaultExports=interopRequireDefault.exports,createSvgIcon$1={};function isPlainObject$1(e){return e!==null&&typeof e=="object"&&e.constructor===Object}function deepClone(e){if(!isPlainObject$1(e))return e;const o={};return Object.keys(e).forEach(s=>{o[s]=deepClone(e[s])}),o}function deepmerge(e,o,s={clone:!0}){const a=s.clone?_extends$3({},e):e;return isPlainObject$1(e)&&isPlainObject$1(o)&&Object.keys(o).forEach(_=>{_!=="__proto__"&&(isPlainObject$1(o[_])&&_ in e&&isPlainObject$1(e[_])?a[_]=deepmerge(e[_],o[_],s):s.clone?a[_]=isPlainObject$1(o[_])?deepClone(o[_]):o[_]:a[_]=o[_])}),a}function formatMuiErrorMessage(e){let o="https://mui.com/production-error/?code="+e;for(let s=1;s<arguments.length;s+=1)o+="&args[]="+encodeURIComponent(arguments[s]);return"Minified MUI error #"+e+"; visit "+o+" for the full message."}function capitalize(e){if(typeof e!="string")throw new Error(formatMuiErrorMessage(7));return e.charAt(0).toUpperCase()+e.slice(1)}function createChainedFunction(...e){return e.reduce((o,s)=>s==null?o:function(..._){o.apply(this,_),s.apply(this,_)},()=>{})}function debounce(e,o=166){let s;function a(..._){const $=()=>{e.apply(this,_)};clearTimeout(s),s=setTimeout($,o)}return a.clear=()=>{clearTimeout(s)},a}function deprecatedPropType(e,o){return()=>null}function isMuiElement(e,o){var s,a;return reactExports.isValidElement(e)&&o.indexOf((s=e.type.muiName)!=null?s:(a=e.type)==null||(a=a._payload)==null||(a=a.value)==null?void 0:a.muiName)!==-1}function ownerDocument(e){return e&&e.ownerDocument||document}function ownerWindow(e){return ownerDocument(e).defaultView||window}function requirePropFactory(e,o){return()=>null}function setRef(e,o){typeof e=="function"?e(o):e&&(e.current=o)}const useEnhancedEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,useEnhancedEffect$1=useEnhancedEffect;let globalId=0;function useGlobalId(e){const[o,s]=reactExports.useState(e),a=e||o;return reactExports.useEffect(()=>{o==null&&(globalId+=1,s(`mui-${globalId}`))},[o]),a}const maybeReactUseId=React$1.useId;function useId(e){if(maybeReactUseId!==void 0){const o=maybeReactUseId();return e??o}return useGlobalId(e)}function unsupportedProp(e,o,s,a,_){return null}function useControlled({controlled:e,default:o,name:s,state:a="value"}){const{current:_}=reactExports.useRef(e!==void 0),[$,_e]=reactExports.useState(o),_n=_?e:$,_r=reactExports.useCallback(_s=>{_||_e(_s)},[]);return[_n,_r]}function useEventCallback(e){const o=reactExports.useRef(e);return useEnhancedEffect$1(()=>{o.current=e}),reactExports.useRef((...s)=>(0,o.current)(...s)).current}function useForkRef(...e){return reactExports.useMemo(()=>e.every(o=>o==null)?null:o=>{e.forEach(s=>{setRef(s,o)})},e)}let hadKeyboardEvent=!0,hadFocusVisibleRecently=!1,hadFocusVisibleRecentlyTimeout;const inputTypesWhitelist={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function focusTriggersKeyboardModality(e){const{type:o,tagName:s}=e;return!!(s==="INPUT"&&inputTypesWhitelist[o]&&!e.readOnly||s==="TEXTAREA"&&!e.readOnly||e.isContentEditable)}function handleKeyDown(e){e.metaKey||e.altKey||e.ctrlKey||(hadKeyboardEvent=!0)}function handlePointerDown(){hadKeyboardEvent=!1}function handleVisibilityChange(){this.visibilityState==="hidden"&&hadFocusVisibleRecently&&(hadKeyboardEvent=!0)}function prepare(e){e.addEventListener("keydown",handleKeyDown,!0),e.addEventListener("mousedown",handlePointerDown,!0),e.addEventListener("pointerdown",handlePointerDown,!0),e.addEventListener("touchstart",handlePointerDown,!0),e.addEventListener("visibilitychange",handleVisibilityChange,!0)}function isFocusVisible(e){const{target:o}=e;try{return o.matches(":focus-visible")}catch{}return hadKeyboardEvent||focusTriggersKeyboardModality(o)}function useIsFocusVisible(){const e=reactExports.useCallback(_=>{_!=null&&prepare(_.ownerDocument)},[]),o=reactExports.useRef(!1);function s(){return o.current?(hadFocusVisibleRecently=!0,window.clearTimeout(hadFocusVisibleRecentlyTimeout),hadFocusVisibleRecentlyTimeout=window.setTimeout(()=>{hadFocusVisibleRecently=!1},100),o.current=!1,!0):!1}function a(_){return isFocusVisible(_)?(o.current=!0,!0):!1}return{isFocusVisibleRef:o,onFocus:a,onBlur:s,ref:e}}function resolveProps(e,o){const s=_extends$3({},o);return Object.keys(e).forEach(a=>{if(a.toString().match(/^(components|slots)$/))s[a]=_extends$3({},e[a],s[a]);else if(a.toString().match(/^(componentsProps|slotProps)$/)){const _=e[a]||{},$=o[a];s[a]={},!$||!Object.keys($)?s[a]=_:!_||!Object.keys(_)?s[a]=$:(s[a]=_extends$3({},$),Object.keys(_).forEach(_e=>{s[a][_e]=resolveProps(_[_e],$[_e])}))}else s[a]===void 0&&(s[a]=e[a])}),s}function composeClasses(e,o,s=void 0){const a={};return Object.keys(e).forEach(_=>{a[_]=e[_].reduce(($,_e)=>{if(_e){const _n=o(_e);_n!==""&&$.push(_n),s&&s[_e]&&$.push(s[_e])}return $},[]).join(" ")}),a}const defaultGenerator=e=>e,createClassNameGenerator=()=>{let e=defaultGenerator;return{configure(o){e=o},generate(o){return e(o)},reset(){e=defaultGenerator}}},ClassNameGenerator=createClassNameGenerator(),ClassNameGenerator$1=ClassNameGenerator,globalStateClassesMapping={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function generateUtilityClass(e,o,s="Mui"){const a=globalStateClassesMapping[o];return a?`${s}-${a}`:`${ClassNameGenerator$1.generate(e)}-${o}`}function generateUtilityClasses(e,o,s="Mui"){const a={};return o.forEach(_=>{a[_]=generateUtilityClass(e,_,s)}),a}function r(e){var o,s,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e))for(o=0;o<e.length;o++)e[o]&&(s=r(e[o]))&&(a&&(a+=" "),a+=s);else for(o in e)e[o]&&(a&&(a+=" "),a+=o);return a}function clsx(){for(var e,o,s=0,a="";s<arguments.length;)(e=arguments[s++])&&(o=r(e))&&(a&&(a+=" "),a+=o);return a}function memoize$1(e){var o=Object.create(null);return function(s){return o[s]===void 0&&(o[s]=e(s)),o[s]}}var reactPropsRegex=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,isPropValid=memoize$1(function(e){return reactPropsRegex.test(e)||e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)<91});function sheetForTag(e){if(e.sheet)return e.sheet;for(var o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].ownerNode===e)return document.styleSheets[o]}function createStyleElement(e){var o=document.createElement("style");return o.setAttribute("data-emotion",e.key),e.nonce!==void 0&&o.setAttribute("nonce",e.nonce),o.appendChild(document.createTextNode("")),o.setAttribute("data-s",""),o}var StyleSheet=function(){function e(s){var a=this;this._insertTag=function(_){var $;a.tags.length===0?a.insertionPoint?$=a.insertionPoint.nextSibling:a.prepend?$=a.container.firstChild:$=a.before:$=a.tags[a.tags.length-1].nextSibling,a.container.insertBefore(_,$),a.tags.push(_)},this.isSpeedy=s.speedy===void 0?!0:s.speedy,this.tags=[],this.ctr=0,this.nonce=s.nonce,this.key=s.key,this.container=s.container,this.prepend=s.prepend,this.insertionPoint=s.insertionPoint,this.before=null}var o=e.prototype;return o.hydrate=function(a){a.forEach(this._insertTag)},o.insert=function(a){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(createStyleElement(this));var _=this.tags[this.tags.length-1];if(this.isSpeedy){var $=sheetForTag(_);try{$.insertRule(a,$.cssRules.length)}catch{}}else _.appendChild(document.createTextNode(a));this.ctr++},o.flush=function(){this.tags.forEach(function(a){return a.parentNode&&a.parentNode.removeChild(a)}),this.tags=[],this.ctr=0},e}(),MS="-ms-",MOZ="-moz-",WEBKIT="-webkit-",COMMENT="comm",RULESET="rule",DECLARATION="decl",IMPORT="@import",KEYFRAMES="@keyframes",LAYER="@layer",abs=Math.abs,from=String.fromCharCode,assign=Object.assign;function hash(e,o){return charat(e,0)^45?(((o<<2^charat(e,0))<<2^charat(e,1))<<2^charat(e,2))<<2^charat(e,3):0}function trim$1(e){return e.trim()}function match(e,o){return(e=o.exec(e))?e[0]:e}function replace(e,o,s){return e.replace(o,s)}function indexof(e,o){return e.indexOf(o)}function charat(e,o){return e.charCodeAt(o)|0}function substr(e,o,s){return e.slice(o,s)}function strlen(e){return e.length}function sizeof(e){return e.length}function append(e,o){return o.push(e),e}function combine(e,o){return e.map(o).join("")}var line=1,column=1,length$1=0,position=0,character=0,characters="";function node(e,o,s,a,_,$,_e){return{value:e,root:o,parent:s,type:a,props:_,children:$,line,column,length:_e,return:""}}function copy(e,o){return assign(node("",null,null,"",null,null,0),e,{length:-e.length},o)}function char(){return character}function prev$1(){return character=position>0?charat(characters,--position):0,column--,character===10&&(column=1,line--),character}function next(){return character=position<length$1?charat(characters,position++):0,column++,character===10&&(column=1,line++),character}function peek(){return charat(characters,position)}function caret(){return position}function slice(e,o){return substr(characters,e,o)}function token$1(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function alloc(e){return line=column=1,length$1=strlen(characters=e),position=0,[]}function dealloc(e){return characters="",e}function delimit(e){return trim$1(slice(position-1,delimiter(e===91?e+2:e===40?e+1:e)))}function whitespace(e){for(;(character=peek())&&character<33;)next();return token$1(e)>2||token$1(character)>3?"":" "}function escaping(e,o){for(;--o&&next()&&!(character<48||character>102||character>57&&character<65||character>70&&character<97););return slice(e,caret()+(o<6&&peek()==32&&next()==32))}function delimiter(e){for(;next();)switch(character){case e:return position;case 34:case 39:e!==34&&e!==39&&delimiter(character);break;case 40:e===41&&delimiter(e);break;case 92:next();break}return position}function commenter(e,o){for(;next()&&e+character!==57;)if(e+character===84&&peek()===47)break;return"/*"+slice(o,position-1)+"*"+from(e===47?e:next())}function identifier(e){for(;!token$1(peek());)next();return slice(e,position)}function compile(e){return dealloc(parse$1("",null,null,null,[""],e=alloc(e),0,[0],e))}function parse$1(e,o,s,a,_,$,_e,_n,_r){for(var _s=0,na=0,ba=_e,_p=0,_f=0,_E=0,_v=1,n_=1,e_=1,t_=0,o_="",m_=_,b_=$,w_=a,y_=o_;n_;)switch(_E=t_,t_=next()){case 40:if(_E!=108&&charat(y_,ba-1)==58){indexof(y_+=replace(delimit(t_),"&","&\f"),"&\f")!=-1&&(e_=-1);break}case 34:case 39:case 91:y_+=delimit(t_);break;case 9:case 10:case 13:case 32:y_+=whitespace(_E);break;case 92:y_+=escaping(caret()-1,7);continue;case 47:switch(peek()){case 42:case 47:append(comment(commenter(next(),caret()),o,s),_r);break;default:y_+="/"}break;case 123*_v:_n[_s++]=strlen(y_)*e_;case 125*_v:case 59:case 0:switch(t_){case 0:case 125:n_=0;case 59+na:e_==-1&&(y_=replace(y_,/\f/g,"")),_f>0&&strlen(y_)-ba&&append(_f>32?declaration(y_+";",a,s,ba-1):declaration(replace(y_," ","")+";",a,s,ba-2),_r);break;case 59:y_+=";";default:if(append(w_=ruleset(y_,o,s,_s,na,_,_n,o_,m_=[],b_=[],ba),$),t_===123)if(na===0)parse$1(y_,o,w_,w_,m_,$,ba,_n,b_);else switch(_p===99&&charat(y_,3)===110?100:_p){case 100:case 108:case 109:case 115:parse$1(e,w_,w_,a&&append(ruleset(e,w_,w_,0,0,_,_n,o_,_,m_=[],ba),b_),_,b_,ba,_n,a?m_:b_);break;default:parse$1(y_,w_,w_,w_,[""],b_,0,_n,b_)}}_s=na=_f=0,_v=e_=1,o_=y_="",ba=_e;break;case 58:ba=1+strlen(y_),_f=_E;default:if(_v<1){if(t_==123)--_v;else if(t_==125&&_v++==0&&prev$1()==125)continue}switch(y_+=from(t_),t_*_v){case 38:e_=na>0?1:(y_+="\f",-1);break;case 44:_n[_s++]=(strlen(y_)-1)*e_,e_=1;break;case 64:peek()===45&&(y_+=delimit(next())),_p=peek(),na=ba=strlen(o_=y_+=identifier(caret())),t_++;break;case 45:_E===45&&strlen(y_)==2&&(_v=0)}}return $}function ruleset(e,o,s,a,_,$,_e,_n,_r,_s,na){for(var ba=_-1,_p=_===0?$:[""],_f=sizeof(_p),_E=0,_v=0,n_=0;_E<a;++_E)for(var e_=0,t_=substr(e,ba+1,ba=abs(_v=_e[_E])),o_=e;e_<_f;++e_)(o_=trim$1(_v>0?_p[e_]+" "+t_:replace(t_,/&\f/g,_p[e_])))&&(_r[n_++]=o_);return node(e,o,s,_===0?RULESET:_n,_r,_s,na)}function comment(e,o,s){return node(e,o,s,COMMENT,from(char()),substr(e,2,-2),0)}function declaration(e,o,s,a){return node(e,o,s,DECLARATION,substr(e,0,a),substr(e,a+1,-1),a)}function serialize(e,o){for(var s="",a=sizeof(e),_=0;_<a;_++)s+=o(e[_],_,e,o)||"";return s}function stringify(e,o,s,a){switch(e.type){case LAYER:if(e.children.length)break;case IMPORT:case DECLARATION:return e.return=e.return||e.value;case COMMENT:return"";case KEYFRAMES:return e.return=e.value+"{"+serialize(e.children,a)+"}";case RULESET:e.value=e.props.join(",")}return strlen(s=serialize(e.children,a))?e.return=e.value+"{"+s+"}":""}function middleware(e){var o=sizeof(e);return function(s,a,_,$){for(var _e="",_n=0;_n<o;_n++)_e+=e[_n](s,a,_,$)||"";return _e}}function rulesheet(e){return function(o){o.root||(o=o.return)&&e(o)}}var identifierWithPointTracking=function(o,s,a){for(var _=0,$=0;_=$,$=peek(),_===38&&$===12&&(s[a]=1),!token$1($);)next();return slice(o,position)},toRules=function(o,s){var a=-1,_=44;do switch(token$1(_)){case 0:_===38&&peek()===12&&(s[a]=1),o[a]+=identifierWithPointTracking(position-1,s,a);break;case 2:o[a]+=delimit(_);break;case 4:if(_===44){o[++a]=peek()===58?"&\f":"",s[a]=o[a].length;break}default:o[a]+=from(_)}while(_=next());return o},getRules=function(o,s){return dealloc(toRules(alloc(o),s))},fixedElements=new WeakMap,compat=function(o){if(!(o.type!=="rule"||!o.parent||o.length<1)){for(var s=o.value,a=o.parent,_=o.column===a.column&&o.line===a.line;a.type!=="rule";)if(a=a.parent,!a)return;if(!(o.props.length===1&&s.charCodeAt(0)!==58&&!fixedElements.get(a))&&!_){fixedElements.set(o,!0);for(var $=[],_e=getRules(s,$),_n=a.props,_r=0,_s=0;_r<_e.length;_r++)for(var na=0;na<_n.length;na++,_s++)o.props[_s]=$[_r]?_e[_r].replace(/&\f/g,_n[na]):_n[na]+" "+_e[_r]}}},removeLabel=function(o){if(o.type==="decl"){var s=o.value;s.charCodeAt(0)===108&&s.charCodeAt(2)===98&&(o.return="",o.value="")}};function prefix(e,o){switch(hash(e,o)){case 5103:return WEBKIT+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return WEBKIT+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return WEBKIT+e+MOZ+e+MS+e+e;case 6828:case 4268:return WEBKIT+e+MS+e+e;case 6165:return WEBKIT+e+MS+"flex-"+e+e;case 5187:return WEBKIT+e+replace(e,/(\w+).+(:[^]+)/,WEBKIT+"box-$1$2"+MS+"flex-$1$2")+e;case 5443:return WEBKIT+e+MS+"flex-item-"+replace(e,/flex-|-self/,"")+e;case 4675:return WEBKIT+e+MS+"flex-line-pack"+replace(e,/align-content|flex-|-self/,"")+e;case 5548:return WEBKIT+e+MS+replace(e,"shrink","negative")+e;case 5292:return WEBKIT+e+MS+replace(e,"basis","preferred-size")+e;case 6060:return WEBKIT+"box-"+replace(e,"-grow","")+WEBKIT+e+MS+replace(e,"grow","positive")+e;case 4554:return WEBKIT+replace(e,/([^-])(transform)/g,"$1"+WEBKIT+"$2")+e;case 6187:return replace(replace(replace(e,/(zoom-|grab)/,WEBKIT+"$1"),/(image-set)/,WEBKIT+"$1"),e,"")+e;case 5495:case 3959:return replace(e,/(image-set\([^]*)/,WEBKIT+"$1$`$1");case 4968:return replace(replace(e,/(.+:)(flex-)?(.*)/,WEBKIT+"box-pack:$3"+MS+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+WEBKIT+e+e;case 4095:case 3583:case 4068:case 2532:return replace(e,/(.+)-inline(.+)/,WEBKIT+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(strlen(e)-1-o>6)switch(charat(e,o+1)){case 109:if(charat(e,o+4)!==45)break;case 102:return replace(e,/(.+:)(.+)-([^]+)/,"$1"+WEBKIT+"$2-$3$1"+MOZ+(charat(e,o+3)==108?"$3":"$2-$3"))+e;case 115:return~indexof(e,"stretch")?prefix(replace(e,"stretch","fill-available"),o)+e:e}break;case 4949:if(charat(e,o+1)!==115)break;case 6444:switch(charat(e,strlen(e)-3-(~indexof(e,"!important")&&10))){case 107:return replace(e,":",":"+WEBKIT)+e;case 101:return replace(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+WEBKIT+(charat(e,14)===45?"inline-":"")+"box$3$1"+WEBKIT+"$2$3$1"+MS+"$2box$3")+e}break;case 5936:switch(charat(e,o+11)){case 114:return WEBKIT+e+MS+replace(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return WEBKIT+e+MS+replace(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return WEBKIT+e+MS+replace(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return WEBKIT+e+MS+e+e}return e}var prefixer=function(o,s,a,_){if(o.length>-1&&!o.return)switch(o.type){case DECLARATION:o.return=prefix(o.value,o.length);break;case KEYFRAMES:return serialize([copy(o,{value:replace(o.value,"@","@"+WEBKIT)})],_);case RULESET:if(o.length)return combine(o.props,function($){switch(match($,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return serialize([copy(o,{props:[replace($,/:(read-\w+)/,":"+MOZ+"$1")]})],_);case"::placeholder":return serialize([copy(o,{props:[replace($,/:(plac\w+)/,":"+WEBKIT+"input-$1")]}),copy(o,{props:[replace($,/:(plac\w+)/,":"+MOZ+"$1")]}),copy(o,{props:[replace($,/:(plac\w+)/,MS+"input-$1")]})],_)}return""})}},defaultStylisPlugins=[prefixer],createCache=function(o){var s=o.key;if(s==="css"){var a=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(a,function(_v){var n_=_v.getAttribute("data-emotion");n_.indexOf(" ")!==-1&&(document.head.appendChild(_v),_v.setAttribute("data-s",""))})}var _=o.stylisPlugins||defaultStylisPlugins,$={},_e,_n=[];_e=o.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+s+' "]'),function(_v){for(var n_=_v.getAttribute("data-emotion").split(" "),e_=1;e_<n_.length;e_++)$[n_[e_]]=!0;_n.push(_v)});var _r,_s=[compat,removeLabel];{var na,ba=[stringify,rulesheet(function(_v){na.insert(_v)})],_p=middleware(_s.concat(_,ba)),_f=function(n_){return serialize(compile(n_),_p)};_r=function(n_,e_,t_,o_){na=t_,_f(n_?n_+"{"+e_.styles+"}":e_.styles),o_&&(_E.inserted[e_.name]=!0)}}var _E={key:s,sheet:new StyleSheet({key:s,container:_e,nonce:o.nonce,speedy:o.speedy,prepend:o.prepend,insertionPoint:o.insertionPoint}),nonce:o.nonce,inserted:$,registered:{},insert:_r};return _E.sheet.hydrate(_n),_E},isBrowser=!0;function getRegisteredStyles(e,o,s){var a="";return s.split(" ").forEach(function(_){e[_]!==void 0?o.push(e[_]+";"):a+=_+" "}),a}var registerStyles=function(o,s,a){var _=o.key+"-"+s.name;(a===!1||isBrowser===!1)&&o.registered[_]===void 0&&(o.registered[_]=s.styles)},insertStyles=function(o,s,a){registerStyles(o,s,a);var _=o.key+"-"+s.name;if(o.inserted[s.name]===void 0){var $=s;do o.insert(s===$?"."+_:"",$,o.sheet,!0),$=$.next;while($!==void 0)}};function murmur2(e){for(var o=0,s,a=0,_=e.length;_>=4;++a,_-=4)s=e.charCodeAt(a)&255|(e.charCodeAt(++a)&255)<<8|(e.charCodeAt(++a)&255)<<16|(e.charCodeAt(++a)&255)<<24,s=(s&65535)*1540483477+((s>>>16)*59797<<16),s^=s>>>24,o=(s&65535)*1540483477+((s>>>16)*59797<<16)^(o&65535)*1540483477+((o>>>16)*59797<<16);switch(_){case 3:o^=(e.charCodeAt(a+2)&255)<<16;case 2:o^=(e.charCodeAt(a+1)&255)<<8;case 1:o^=e.charCodeAt(a)&255,o=(o&65535)*1540483477+((o>>>16)*59797<<16)}return o^=o>>>13,o=(o&65535)*1540483477+((o>>>16)*59797<<16),((o^o>>>15)>>>0).toString(36)}var unitlessKeys={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},hyphenateRegex=/[A-Z]|^ms/g,animationRegex=/_EMO_([^_]+?)_([^]*?)_EMO_/g,isCustomProperty=function(o){return o.charCodeAt(1)===45},isProcessableValue=function(o){return o!=null&&typeof o!="boolean"},processStyleName=memoize$1(function(e){return isCustomProperty(e)?e:e.replace(hyphenateRegex,"-$&").toLowerCase()}),processStyleValue=function(o,s){switch(o){case"animation":case"animationName":if(typeof s=="string")return s.replace(animationRegex,function(a,_,$){return cursor={name:_,styles:$,next:cursor},_})}return unitlessKeys[o]!==1&&!isCustomProperty(o)&&typeof s=="number"&&s!==0?s+"px":s},noComponentSelectorMessage="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function handleInterpolation(e,o,s){if(s==null)return"";if(s.__emotion_styles!==void 0)return s;switch(typeof s){case"boolean":return"";case"object":{if(s.anim===1)return cursor={name:s.name,styles:s.styles,next:cursor},s.name;if(s.styles!==void 0){var a=s.next;if(a!==void 0)for(;a!==void 0;)cursor={name:a.name,styles:a.styles,next:cursor},a=a.next;var _=s.styles+";";return _}return createStringFromObject(e,o,s)}case"function":{if(e!==void 0){var $=cursor,_e=s(e);return cursor=$,handleInterpolation(e,o,_e)}break}}if(o==null)return s;var _n=o[s];return _n!==void 0?_n:s}function createStringFromObject(e,o,s){var a="";if(Array.isArray(s))for(var _=0;_<s.length;_++)a+=handleInterpolation(e,o,s[_])+";";else for(var $ in s){var _e=s[$];if(typeof _e!="object")o!=null&&o[_e]!==void 0?a+=$+"{"+o[_e]+"}":isProcessableValue(_e)&&(a+=processStyleName($)+":"+processStyleValue($,_e)+";");else if(Array.isArray(_e)&&typeof _e[0]=="string"&&(o==null||o[_e[0]]===void 0))for(var _n=0;_n<_e.length;_n++)isProcessableValue(_e[_n])&&(a+=processStyleName($)+":"+processStyleValue($,_e[_n])+";");else{var _r=handleInterpolation(e,o,_e);switch($){case"animation":case"animationName":{a+=processStyleName($)+":"+_r+";";break}default:a+=$+"{"+_r+"}"}}}return a}var labelPattern=/label:\s*([^\s;\n{]+)\s*(;|$)/g,cursor,serializeStyles=function(o,s,a){if(o.length===1&&typeof o[0]=="object"&&o[0]!==null&&o[0].styles!==void 0)return o[0];var _=!0,$="";cursor=void 0;var _e=o[0];_e==null||_e.raw===void 0?(_=!1,$+=handleInterpolation(a,s,_e)):$+=_e[0];for(var _n=1;_n<o.length;_n++)$+=handleInterpolation(a,s,o[_n]),_&&($+=_e[_n]);labelPattern.lastIndex=0;for(var _r="",_s;(_s=labelPattern.exec($))!==null;)_r+="-"+_s[1];var na=murmur2($)+_r;return{name:na,styles:$,next:cursor}},syncFallback=function(o){return o()},useInsertionEffect=React$1.useInsertionEffect?React$1.useInsertionEffect:!1,useInsertionEffectAlwaysWithSyncFallback=useInsertionEffect||syncFallback,EmotionCacheContext=reactExports.createContext(typeof HTMLElement<"u"?createCache({key:"css"}):null);EmotionCacheContext.Provider;var withEmotionCache=function(o){return reactExports.forwardRef(function(s,a){var _=reactExports.useContext(EmotionCacheContext);return o(s,_,a)})},ThemeContext=reactExports.createContext({}),testOmitPropsOnStringTag=isPropValid,testOmitPropsOnComponent=function(o){return o!=="theme"},getDefaultShouldForwardProp=function(o){return typeof o=="string"&&o.charCodeAt(0)>96?testOmitPropsOnStringTag:testOmitPropsOnComponent},composeShouldForwardProps=function(o,s,a){var _;if(s){var $=s.shouldForwardProp;_=o.__emotion_forwardProp&&$?function(_e){return o.__emotion_forwardProp(_e)&&$(_e)}:$}return typeof _!="function"&&a&&(_=o.__emotion_forwardProp),_},Insertion=function(o){var s=o.cache,a=o.serialized,_=o.isStringTag;return registerStyles(s,a,_),useInsertionEffectAlwaysWithSyncFallback(function(){return insertStyles(s,a,_)}),null},createStyled$1=function e(o,s){var a=o.__emotion_real===o,_=a&&o.__emotion_base||o,$,_e;s!==void 0&&($=s.label,_e=s.target);var _n=composeShouldForwardProps(o,s,a),_r=_n||getDefaultShouldForwardProp(_),_s=!_r("as");return function(){var na=arguments,ba=a&&o.__emotion_styles!==void 0?o.__emotion_styles.slice(0):[];if($!==void 0&&ba.push("label:"+$+";"),na[0]==null||na[0].raw===void 0)ba.push.apply(ba,na);else{ba.push(na[0][0]);for(var _p=na.length,_f=1;_f<_p;_f++)ba.push(na[_f],na[0][_f])}var _E=withEmotionCache(function(_v,n_,e_){var t_=_s&&_v.as||_,o_="",m_=[],b_=_v;if(_v.theme==null){b_={};for(var w_ in _v)b_[w_]=_v[w_];b_.theme=reactExports.useContext(ThemeContext)}typeof _v.className=="string"?o_=getRegisteredStyles(n_.registered,m_,_v.className):_v.className!=null&&(o_=_v.className+" ");var y_=serializeStyles(ba.concat(m_),n_.registered,b_);o_+=n_.key+"-"+y_.name,_e!==void 0&&(o_+=" "+_e);var N_=_s&&_n===void 0?getDefaultShouldForwardProp(t_):_r,_y={};for(var v_ in _v)_s&&v_==="as"||N_(v_)&&(_y[v_]=_v[v_]);return _y.className=o_,_y.ref=e_,reactExports.createElement(reactExports.Fragment,null,reactExports.createElement(Insertion,{cache:n_,serialized:y_,isStringTag:typeof t_=="string"}),reactExports.createElement(t_,_y))});return _E.displayName=$!==void 0?$:"Styled("+(typeof _=="string"?_:_.displayName||_.name||"Component")+")",_E.defaultProps=o.defaultProps,_E.__emotion_real=_E,_E.__emotion_base=_,_E.__emotion_styles=ba,_E.__emotion_forwardProp=_n,Object.defineProperty(_E,"toString",{value:function(){return"."+_e}}),_E.withComponent=function(_v,n_){return e(_v,_extends$3({},s,n_,{shouldForwardProp:composeShouldForwardProps(_E,n_,!0)})).apply(void 0,ba)},_E}},tags=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],newStyled=createStyled$1.bind();tags.forEach(function(e){newStyled[e]=newStyled(e)});function styled$2(e,o){return newStyled(e,o)}const internal_processStyles=(e,o)=>{Array.isArray(e.__emotion_styles)&&(e.__emotion_styles=o(e.__emotion_styles))},_excluded$e=["values","unit","step"],sortBreakpointsValues=e=>{const o=Object.keys(e).map(s=>({key:s,val:e[s]}))||[];return o.sort((s,a)=>s.val-a.val),o.reduce((s,a)=>_extends$3({},s,{[a.key]:a.val}),{})};function createBreakpoints(e){const{values:o={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:s="px",step:a=5}=e,_=_objectWithoutPropertiesLoose$7(e,_excluded$e),$=sortBreakpointsValues(o),_e=Object.keys($);function _n(_p){return`@media (min-width:${typeof o[_p]=="number"?o[_p]:_p}${s})`}function _r(_p){return`@media (max-width:${(typeof o[_p]=="number"?o[_p]:_p)-a/100}${s})`}function _s(_p,_f){const _E=_e.indexOf(_f);return`@media (min-width:${typeof o[_p]=="number"?o[_p]:_p}${s}) and (max-width:${(_E!==-1&&typeof o[_e[_E]]=="number"?o[_e[_E]]:_f)-a/100}${s})`}function na(_p){return _e.indexOf(_p)+1<_e.length?_s(_p,_e[_e.indexOf(_p)+1]):_n(_p)}function ba(_p){const _f=_e.indexOf(_p);return _f===0?_n(_e[1]):_f===_e.length-1?_r(_e[_f]):_s(_p,_e[_e.indexOf(_p)+1]).replace("@media","@media not all and")}return _extends$3({keys:_e,values:$,up:_n,down:_r,between:_s,only:na,not:ba,unit:s},_)}const shape={borderRadius:4},shape$1=shape;function merge$1(e,o){return o?deepmerge(e,o,{clone:!1}):e}const values={xs:0,sm:600,md:900,lg:1200,xl:1536},defaultBreakpoints={keys:["xs","sm","md","lg","xl"],up:e=>`@media (min-width:${values[e]}px)`};function handleBreakpoints(e,o,s){const a=e.theme||{};if(Array.isArray(o)){const $=a.breakpoints||defaultBreakpoints;return o.reduce((_e,_n,_r)=>(_e[$.up($.keys[_r])]=s(o[_r]),_e),{})}if(typeof o=="object"){const $=a.breakpoints||defaultBreakpoints;return Object.keys(o).reduce((_e,_n)=>{if(Object.keys($.values||values).indexOf(_n)!==-1){const _r=$.up(_n);_e[_r]=s(o[_n],_n)}else{const _r=_n;_e[_r]=o[_r]}return _e},{})}return s(o)}function createEmptyBreakpointObject(e={}){var o;return((o=e.keys)==null?void 0:o.reduce((a,_)=>{const $=e.up(_);return a[$]={},a},{}))||{}}function removeUnusedBreakpoints(e,o){return e.reduce((s,a)=>{const _=s[a];return(!_||Object.keys(_).length===0)&&delete s[a],s},o)}function getPath(e,o,s=!0){if(!o||typeof o!="string")return null;if(e&&e.vars&&s){const a=`vars.${o}`.split(".").reduce((_,$)=>_&&_[$]?_[$]:null,e);if(a!=null)return a}return o.split(".").reduce((a,_)=>a&&a[_]!=null?a[_]:null,e)}function getStyleValue(e,o,s,a=s){let _;return typeof e=="function"?_=e(s):Array.isArray(e)?_=e[s]||a:_=getPath(e,s)||a,o&&(_=o(_,a,e)),_}function style$1(e){const{prop:o,cssProperty:s=e.prop,themeKey:a,transform:_}=e,$=_e=>{if(_e[o]==null)return null;const _n=_e[o],_r=_e.theme,_s=getPath(_r,a)||{};return handleBreakpoints(_e,_n,ba=>{let _p=getStyleValue(_s,_,ba);return ba===_p&&typeof ba=="string"&&(_p=getStyleValue(_s,_,`${o}${ba==="default"?"":capitalize(ba)}`,ba)),s===!1?_p:{[s]:_p}})};return $.propTypes={},$.filterProps=[o],$}function memoize(e){const o={};return s=>(o[s]===void 0&&(o[s]=e(s)),o[s])}const properties={m:"margin",p:"padding"},directions={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},aliases={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},getCssProperties=memoize(e=>{if(e.length>2)if(aliases[e])e=aliases[e];else return[e];const[o,s]=e.split(""),a=properties[o],_=directions[s]||"";return Array.isArray(_)?_.map($=>a+$):[a+_]}),marginKeys=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],paddingKeys=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...marginKeys,...paddingKeys];function createUnaryUnit(e,o,s,a){var _;const $=(_=getPath(e,o,!1))!=null?_:s;return typeof $=="number"?_e=>typeof _e=="string"?_e:$*_e:Array.isArray($)?_e=>typeof _e=="string"?_e:$[_e]:typeof $=="function"?$:()=>{}}function createUnarySpacing(e){return createUnaryUnit(e,"spacing",8)}function getValue(e,o){if(typeof o=="string"||o==null)return o;const s=Math.abs(o),a=e(s);return o>=0?a:typeof a=="number"?-a:`-${a}`}function getStyleFromPropValue(e,o){return s=>e.reduce((a,_)=>(a[_]=getValue(o,s),a),{})}function resolveCssProperty(e,o,s,a){if(o.indexOf(s)===-1)return null;const _=getCssProperties(s),$=getStyleFromPropValue(_,a),_e=e[s];return handleBreakpoints(e,_e,$)}function style(e,o){const s=createUnarySpacing(e.theme);return Object.keys(e).map(a=>resolveCssProperty(e,o,a,s)).reduce(merge$1,{})}function margin(e){return style(e,marginKeys)}margin.propTypes={};margin.filterProps=marginKeys;function padding(e){return style(e,paddingKeys)}padding.propTypes={};padding.filterProps=paddingKeys;function createSpacing(e=8){if(e.mui)return e;const o=createUnarySpacing({spacing:e}),s=(...a)=>(a.length===0?[1]:a).map($=>{const _e=o($);return typeof _e=="number"?`${_e}px`:_e}).join(" ");return s.mui=!0,s}function compose(...e){const o=e.reduce((a,_)=>(_.filterProps.forEach($=>{a[$]=_}),a),{}),s=a=>Object.keys(a).reduce((_,$)=>o[$]?merge$1(_,o[$](a)):_,{});return s.propTypes={},s.filterProps=e.reduce((a,_)=>a.concat(_.filterProps),[]),s}function borderTransform(e){return typeof e!="number"?e:`${e}px solid`}function createBorderStyle(e,o){return style$1({prop:e,themeKey:"borders",transform:o})}const border=createBorderStyle("border",borderTransform),borderTop=createBorderStyle("borderTop",borderTransform),borderRight=createBorderStyle("borderRight",borderTransform),borderBottom=createBorderStyle("borderBottom",borderTransform),borderLeft=createBorderStyle("borderLeft",borderTransform),borderColor=createBorderStyle("borderColor"),borderTopColor=createBorderStyle("borderTopColor"),borderRightColor=createBorderStyle("borderRightColor"),borderBottomColor=createBorderStyle("borderBottomColor"),borderLeftColor=createBorderStyle("borderLeftColor"),outline=createBorderStyle("outline",borderTransform),outlineColor=createBorderStyle("outlineColor"),borderRadius=e=>{if(e.borderRadius!==void 0&&e.borderRadius!==null){const o=createUnaryUnit(e.theme,"shape.borderRadius",4),s=a=>({borderRadius:getValue(o,a)});return handleBreakpoints(e,e.borderRadius,s)}return null};borderRadius.propTypes={};borderRadius.filterProps=["borderRadius"];compose(border,borderTop,borderRight,borderBottom,borderLeft,borderColor,borderTopColor,borderRightColor,borderBottomColor,borderLeftColor,borderRadius,outline,outlineColor);const gap=e=>{if(e.gap!==void 0&&e.gap!==null){const o=createUnaryUnit(e.theme,"spacing",8),s=a=>({gap:getValue(o,a)});return handleBreakpoints(e,e.gap,s)}return null};gap.propTypes={};gap.filterProps=["gap"];const columnGap=e=>{if(e.columnGap!==void 0&&e.columnGap!==null){const o=createUnaryUnit(e.theme,"spacing",8),s=a=>({columnGap:getValue(o,a)});return handleBreakpoints(e,e.columnGap,s)}return null};columnGap.propTypes={};columnGap.filterProps=["columnGap"];const rowGap=e=>{if(e.rowGap!==void 0&&e.rowGap!==null){const o=createUnaryUnit(e.theme,"spacing",8),s=a=>({rowGap:getValue(o,a)});return handleBreakpoints(e,e.rowGap,s)}return null};rowGap.propTypes={};rowGap.filterProps=["rowGap"];const gridColumn=style$1({prop:"gridColumn"}),gridRow=style$1({prop:"gridRow"}),gridAutoFlow=style$1({prop:"gridAutoFlow"}),gridAutoColumns=style$1({prop:"gridAutoColumns"}),gridAutoRows=style$1({prop:"gridAutoRows"}),gridTemplateColumns=style$1({prop:"gridTemplateColumns"}),gridTemplateRows=style$1({prop:"gridTemplateRows"}),gridTemplateAreas=style$1({prop:"gridTemplateAreas"}),gridArea=style$1({prop:"gridArea"});compose(gap,columnGap,rowGap,gridColumn,gridRow,gridAutoFlow,gridAutoColumns,gridAutoRows,gridTemplateColumns,gridTemplateRows,gridTemplateAreas,gridArea);function paletteTransform(e,o){return o==="grey"?o:e}const color=style$1({prop:"color",themeKey:"palette",transform:paletteTransform}),bgcolor=style$1({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:paletteTransform}),backgroundColor=style$1({prop:"backgroundColor",themeKey:"palette",transform:paletteTransform});compose(color,bgcolor,backgroundColor);function sizingTransform(e){return e<=1&&e!==0?`${e*100}%`:e}const width=style$1({prop:"width",transform:sizingTransform}),maxWidth=e=>{if(e.maxWidth!==void 0&&e.maxWidth!==null){const o=s=>{var a,_;const $=((a=e.theme)==null||(a=a.breakpoints)==null||(a=a.values)==null?void 0:a[s])||values[s];return $?((_=e.theme)==null||(_=_.breakpoints)==null?void 0:_.unit)!=="px"?{maxWidth:`${$}${e.theme.breakpoints.unit}`}:{maxWidth:$}:{maxWidth:sizingTransform(s)}};return handleBreakpoints(e,e.maxWidth,o)}return null};maxWidth.filterProps=["maxWidth"];const minWidth=style$1({prop:"minWidth",transform:sizingTransform}),height=style$1({prop:"height",transform:sizingTransform}),maxHeight=style$1({prop:"maxHeight",transform:sizingTransform}),minHeight=style$1({prop:"minHeight",transform:sizingTransform});style$1({prop:"size",cssProperty:"width",transform:sizingTransform});style$1({prop:"size",cssProperty:"height",transform:sizingTransform});const boxSizing=style$1({prop:"boxSizing"});compose(width,maxWidth,minWidth,height,maxHeight,minHeight,boxSizing);const defaultSxConfig={border:{themeKey:"borders",transform:borderTransform},borderTop:{themeKey:"borders",transform:borderTransform},borderRight:{themeKey:"borders",transform:borderTransform},borderBottom:{themeKey:"borders",transform:borderTransform},borderLeft:{themeKey:"borders",transform:borderTransform},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:borderTransform},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:borderRadius},color:{themeKey:"palette",transform:paletteTransform},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:paletteTransform},backgroundColor:{themeKey:"palette",transform:paletteTransform},p:{style:padding},pt:{style:padding},pr:{style:padding},pb:{style:padding},pl:{style:padding},px:{style:padding},py:{style:padding},padding:{style:padding},paddingTop:{style:padding},paddingRight:{style:padding},paddingBottom:{style:padding},paddingLeft:{style:padding},paddingX:{style:padding},paddingY:{style:padding},paddingInline:{style:padding},paddingInlineStart:{style:padding},paddingInlineEnd:{style:padding},paddingBlock:{style:padding},paddingBlockStart:{style:padding},paddingBlockEnd:{style:padding},m:{style:margin},mt:{style:margin},mr:{style:margin},mb:{style:margin},ml:{style:margin},mx:{style:margin},my:{style:margin},margin:{style:margin},marginTop:{style:margin},marginRight:{style:margin},marginBottom:{style:margin},marginLeft:{style:margin},marginX:{style:margin},marginY:{style:margin},marginInline:{style:margin},marginInlineStart:{style:margin},marginInlineEnd:{style:margin},marginBlock:{style:margin},marginBlockStart:{style:margin},marginBlockEnd:{style:margin},displayPrint:{cssProperty:!1,transform:e=>({"@media print":{display:e}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:gap},rowGap:{style:rowGap},columnGap:{style:columnGap},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:sizingTransform},maxWidth:{style:maxWidth},minWidth:{transform:sizingTransform},height:{transform:sizingTransform},maxHeight:{transform:sizingTransform},minHeight:{transform:sizingTransform},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},defaultSxConfig$1=defaultSxConfig;function objectsHaveSameKeys(...e){const o=e.reduce((a,_)=>a.concat(Object.keys(_)),[]),s=new Set(o);return e.every(a=>s.size===Object.keys(a).length)}function callIfFn(e,o){return typeof e=="function"?e(o):e}function unstable_createStyleFunctionSx(){function e(s,a,_,$){const _e={[s]:a,theme:_},_n=$[s];if(!_n)return{[s]:a};const{cssProperty:_r=s,themeKey:_s,transform:na,style:ba}=_n;if(a==null)return null;if(_s==="typography"&&a==="inherit")return{[s]:a};const _p=getPath(_,_s)||{};return ba?ba(_e):handleBreakpoints(_e,a,_E=>{let _v=getStyleValue(_p,na,_E);return _E===_v&&typeof _E=="string"&&(_v=getStyleValue(_p,na,`${s}${_E==="default"?"":capitalize(_E)}`,_E)),_r===!1?_v:{[_r]:_v}})}function o(s){var a;const{sx:_,theme:$={}}=s||{};if(!_)return null;const _e=(a=$.unstable_sxConfig)!=null?a:defaultSxConfig$1;function _n(_r){let _s=_r;if(typeof _r=="function")_s=_r($);else if(typeof _r!="object")return _r;if(!_s)return null;const na=createEmptyBreakpointObject($.breakpoints),ba=Object.keys(na);let _p=na;return Object.keys(_s).forEach(_f=>{const _E=callIfFn(_s[_f],$);if(_E!=null)if(typeof _E=="object")if(_e[_f])_p=merge$1(_p,e(_f,_E,$,_e));else{const _v=handleBreakpoints({theme:$},_E,n_=>({[_f]:n_}));objectsHaveSameKeys(_v,_E)?_p[_f]=o({sx:_E,theme:$}):_p=merge$1(_p,_v)}else _p=merge$1(_p,e(_f,_E,$,_e))}),removeUnusedBreakpoints(ba,_p)}return Array.isArray(_)?_.map(_n):_n(_)}return o}const styleFunctionSx=unstable_createStyleFunctionSx();styleFunctionSx.filterProps=["sx"];const styleFunctionSx$1=styleFunctionSx,_excluded$d=["breakpoints","palette","spacing","shape"];function createTheme$1(e={},...o){const{breakpoints:s={},palette:a={},spacing:_,shape:$={}}=e,_e=_objectWithoutPropertiesLoose$7(e,_excluded$d),_n=createBreakpoints(s),_r=createSpacing(_);let _s=deepmerge({breakpoints:_n,direction:"ltr",components:{},palette:_extends$3({mode:"light"},a),spacing:_r,shape:_extends$3({},shape$1,$)},_e);return _s=o.reduce((na,ba)=>deepmerge(na,ba),_s),_s.unstable_sxConfig=_extends$3({},defaultSxConfig$1,_e==null?void 0:_e.unstable_sxConfig),_s.unstable_sx=function(ba){return styleFunctionSx$1({sx:ba,theme:this})},_s}function isObjectEmpty(e){return Object.keys(e).length===0}function useTheme$2(e=null){const o=reactExports.useContext(ThemeContext);return!o||isObjectEmpty(o)?e:o}const systemDefaultTheme$1=createTheme$1();function useTheme$1(e=systemDefaultTheme$1){return useTheme$2(e)}const _excluded$c=["variant"];function isEmpty$1(e){return e.length===0}function propsToClassKey(e){const{variant:o}=e,s=_objectWithoutPropertiesLoose$7(e,_excluded$c);let a=o||"";return Object.keys(s).sort().forEach(_=>{_==="color"?a+=isEmpty$1(a)?e[_]:capitalize(e[_]):a+=`${isEmpty$1(a)?_:capitalize(_)}${capitalize(e[_].toString())}`}),a}const _excluded$b=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function isEmpty(e){return Object.keys(e).length===0}function isStringTag(e){return typeof e=="string"&&e.charCodeAt(0)>96}const getStyleOverrides=(e,o)=>o.components&&o.components[e]&&o.components[e].styleOverrides?o.components[e].styleOverrides:null,transformVariants=e=>{const o={};return e&&e.forEach(s=>{const a=propsToClassKey(s.props);o[a]=s.style}),o},getVariantStyles=(e,o)=>{let s=[];return o&&o.components&&o.components[e]&&o.components[e].variants&&(s=o.components[e].variants),transformVariants(s)},variantsResolver=(e,o,s)=>{const{ownerState:a={}}=e,_=[];return s&&s.forEach($=>{let _e=!0;Object.keys($.props).forEach(_n=>{a[_n]!==$.props[_n]&&e[_n]!==$.props[_n]&&(_e=!1)}),_e&&_.push(o[propsToClassKey($.props)])}),_},themeVariantsResolver=(e,o,s,a)=>{var _;const $=s==null||(_=s.components)==null||(_=_[a])==null?void 0:_.variants;return variantsResolver(e,o,$)};function shouldForwardProp(e){return e!=="ownerState"&&e!=="theme"&&e!=="sx"&&e!=="as"}const systemDefaultTheme=createTheme$1(),lowercaseFirstLetter=e=>e&&e.charAt(0).toLowerCase()+e.slice(1);function resolveTheme({defaultTheme:e,theme:o,themeId:s}){return isEmpty(o)?e:o[s]||o}function defaultOverridesResolver(e){return e?(o,s)=>s[e]:null}const muiStyledFunctionResolver=({styledArg:e,props:o,defaultTheme:s,themeId:a})=>{const _=e(_extends$3({},o,{theme:resolveTheme(_extends$3({},o,{defaultTheme:s,themeId:a}))}));let $;if(_&&_.variants&&($=_.variants,delete _.variants),$){const _e=variantsResolver(o,transformVariants($),$);return[_,..._e]}return _};function createStyled(e={}){const{themeId:o,defaultTheme:s=systemDefaultTheme,rootShouldForwardProp:a=shouldForwardProp,slotShouldForwardProp:_=shouldForwardProp}=e,$=_e=>styleFunctionSx$1(_extends$3({},_e,{theme:resolveTheme(_extends$3({},_e,{defaultTheme:s,themeId:o}))}));return $.__mui_systemSx=!0,(_e,_n={})=>{internal_processStyles(_e,m_=>m_.filter(b_=>!(b_!=null&&b_.__mui_systemSx)));const{name:_r,slot:_s,skipVariantsResolver:na,skipSx:ba,overridesResolver:_p=defaultOverridesResolver(lowercaseFirstLetter(_s))}=_n,_f=_objectWithoutPropertiesLoose$7(_n,_excluded$b),_E=na!==void 0?na:_s&&_s!=="Root"&&_s!=="root"||!1,_v=ba||!1;let n_,e_=shouldForwardProp;_s==="Root"||_s==="root"?e_=a:_s?e_=_:isStringTag(_e)&&(e_=void 0);const t_=styled$2(_e,_extends$3({shouldForwardProp:e_,label:n_},_f)),o_=(m_,...b_)=>{const w_=b_?b_.map(v_=>{if(typeof v_=="function"&&v_.__emotion_real!==v_)return A_=>muiStyledFunctionResolver({styledArg:v_,props:A_,defaultTheme:s,themeId:o});if(isPlainObject$1(v_)){let A_=v_,k_;return v_&&v_.variants&&(k_=v_.variants,delete A_.variants,A_=P_=>{let T_=v_;return variantsResolver(P_,transformVariants(k_),k_).forEach(I_=>{T_=deepmerge(T_,I_)}),T_}),A_}return v_}):[];let y_=m_;if(isPlainObject$1(m_)){let v_;m_&&m_.variants&&(v_=m_.variants,delete y_.variants,y_=A_=>{let k_=m_;return variantsResolver(A_,transformVariants(v_),v_).forEach(T_=>{k_=deepmerge(k_,T_)}),k_})}else typeof m_=="function"&&m_.__emotion_real!==m_&&(y_=v_=>muiStyledFunctionResolver({styledArg:m_,props:v_,defaultTheme:s,themeId:o}));_r&&_p&&w_.push(v_=>{const A_=resolveTheme(_extends$3({},v_,{defaultTheme:s,themeId:o})),k_=getStyleOverrides(_r,A_);if(k_){const P_={};return Object.entries(k_).forEach(([T_,R_])=>{P_[T_]=typeof R_=="function"?R_(_extends$3({},v_,{theme:A_})):R_}),_p(v_,P_)}return null}),_r&&!_E&&w_.push(v_=>{const A_=resolveTheme(_extends$3({},v_,{defaultTheme:s,themeId:o}));return themeVariantsResolver(v_,getVariantStyles(_r,A_),A_,_r)}),_v||w_.push($);const N_=w_.length-b_.length;if(Array.isArray(m_)&&N_>0){const v_=new Array(N_).fill("");y_=[...m_,...v_],y_.raw=[...m_.raw,...v_]}const _y=t_(y_,...w_);return _e.muiName&&(_y.muiName=_e.muiName),_y};return t_.withConfig&&(o_.withConfig=t_.withConfig),o_}}function getThemeProps(e){const{theme:o,name:s,props:a}=e;return!o||!o.components||!o.components[s]||!o.components[s].defaultProps?a:resolveProps(o.components[s].defaultProps,a)}function useThemeProps$1({props:e,name:o,defaultTheme:s,themeId:a}){let _=useTheme$1(s);return a&&(_=_[a]||_),getThemeProps({theme:_,name:o,props:e})}function clamp(e,o=0,s=1){return Math.min(Math.max(o,e),s)}function hexToRgb(e){e=e.slice(1);const o=new RegExp(`.{1,${e.length>=6?2:1}}`,"g");let s=e.match(o);return s&&s[0].length===1&&(s=s.map(a=>a+a)),s?`rgb${s.length===4?"a":""}(${s.map((a,_)=>_<3?parseInt(a,16):Math.round(parseInt(a,16)/255*1e3)/1e3).join(", ")})`:""}function decomposeColor(e){if(e.type)return e;if(e.charAt(0)==="#")return decomposeColor(hexToRgb(e));const o=e.indexOf("("),s=e.substring(0,o);if(["rgb","rgba","hsl","hsla","color"].indexOf(s)===-1)throw new Error(formatMuiErrorMessage(9,e));let a=e.substring(o+1,e.length-1),_;if(s==="color"){if(a=a.split(" "),_=a.shift(),a.length===4&&a[3].charAt(0)==="/"&&(a[3]=a[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(_)===-1)throw new Error(formatMuiErrorMessage(10,_))}else a=a.split(",");return a=a.map($=>parseFloat($)),{type:s,values:a,colorSpace:_}}function recomposeColor(e){const{type:o,colorSpace:s}=e;let{values:a}=e;return o.indexOf("rgb")!==-1?a=a.map((_,$)=>$<3?parseInt(_,10):_):o.indexOf("hsl")!==-1&&(a[1]=`${a[1]}%`,a[2]=`${a[2]}%`),o.indexOf("color")!==-1?a=`${s} ${a.join(" ")}`:a=`${a.join(", ")}`,`${o}(${a})`}function hslToRgb(e){e=decomposeColor(e);const{values:o}=e,s=o[0],a=o[1]/100,_=o[2]/100,$=a*Math.min(_,1-_),_e=(_s,na=(_s+s/30)%12)=>_-$*Math.max(Math.min(na-3,9-na,1),-1);let _n="rgb";const _r=[Math.round(_e(0)*255),Math.round(_e(8)*255),Math.round(_e(4)*255)];return e.type==="hsla"&&(_n+="a",_r.push(o[3])),recomposeColor({type:_n,values:_r})}function getLuminance(e){e=decomposeColor(e);let o=e.type==="hsl"||e.type==="hsla"?decomposeColor(hslToRgb(e)).values:e.values;return o=o.map(s=>(e.type!=="color"&&(s/=255),s<=.03928?s/12.92:((s+.055)/1.055)**2.4)),Number((.2126*o[0]+.7152*o[1]+.0722*o[2]).toFixed(3))}function getContrastRatio(e,o){const s=getLuminance(e),a=getLuminance(o);return(Math.max(s,a)+.05)/(Math.min(s,a)+.05)}function alpha(e,o){return e=decomposeColor(e),o=clamp(o),(e.type==="rgb"||e.type==="hsl")&&(e.type+="a"),e.type==="color"?e.values[3]=`/${o}`:e.values[3]=o,recomposeColor(e)}function darken(e,o){if(e=decomposeColor(e),o=clamp(o),e.type.indexOf("hsl")!==-1)e.values[2]*=1-o;else if(e.type.indexOf("rgb")!==-1||e.type.indexOf("color")!==-1)for(let s=0;s<3;s+=1)e.values[s]*=1-o;return recomposeColor(e)}function lighten(e,o){if(e=decomposeColor(e),o=clamp(o),e.type.indexOf("hsl")!==-1)e.values[2]+=(100-e.values[2])*o;else if(e.type.indexOf("rgb")!==-1)for(let s=0;s<3;s+=1)e.values[s]+=(255-e.values[s])*o;else if(e.type.indexOf("color")!==-1)for(let s=0;s<3;s+=1)e.values[s]+=(1-e.values[s])*o;return recomposeColor(e)}function createMixins(e,o){return _extends$3({toolbar:{minHeight:56,[e.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[e.up("sm")]:{minHeight:64}}},o)}const common={black:"#000",white:"#fff"},common$1=common,grey={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},grey$1=grey,purple={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},purple$1=purple,red={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},red$1=red,orange={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},orange$1=orange,blue={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},blue$1=blue,lightBlue={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},lightBlue$1=lightBlue,green={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},green$1=green,_excluded$a=["mode","contrastThreshold","tonalOffset"],light={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:common$1.white,default:common$1.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},dark={text:{primary:common$1.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:common$1.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function addLightOrDark(e,o,s,a){const _=a.light||a,$=a.dark||a*1.5;e[o]||(e.hasOwnProperty(s)?e[o]=e[s]:o==="light"?e.light=lighten(e.main,_):o==="dark"&&(e.dark=darken(e.main,$)))}function getDefaultPrimary(e="light"){return e==="dark"?{main:blue$1[200],light:blue$1[50],dark:blue$1[400]}:{main:blue$1[700],light:blue$1[400],dark:blue$1[800]}}function getDefaultSecondary(e="light"){return e==="dark"?{main:purple$1[200],light:purple$1[50],dark:purple$1[400]}:{main:purple$1[500],light:purple$1[300],dark:purple$1[700]}}function getDefaultError(e="light"){return e==="dark"?{main:red$1[500],light:red$1[300],dark:red$1[700]}:{main:red$1[700],light:red$1[400],dark:red$1[800]}}function getDefaultInfo(e="light"){return e==="dark"?{main:lightBlue$1[400],light:lightBlue$1[300],dark:lightBlue$1[700]}:{main:lightBlue$1[700],light:lightBlue$1[500],dark:lightBlue$1[900]}}function getDefaultSuccess(e="light"){return e==="dark"?{main:green$1[400],light:green$1[300],dark:green$1[700]}:{main:green$1[800],light:green$1[500],dark:green$1[900]}}function getDefaultWarning(e="light"){return e==="dark"?{main:orange$1[400],light:orange$1[300],dark:orange$1[700]}:{main:"#ed6c02",light:orange$1[500],dark:orange$1[900]}}function createPalette(e){const{mode:o="light",contrastThreshold:s=3,tonalOffset:a=.2}=e,_=_objectWithoutPropertiesLoose$7(e,_excluded$a),$=e.primary||getDefaultPrimary(o),_e=e.secondary||getDefaultSecondary(o),_n=e.error||getDefaultError(o),_r=e.info||getDefaultInfo(o),_s=e.success||getDefaultSuccess(o),na=e.warning||getDefaultWarning(o);function ba(_v){return getContrastRatio(_v,dark.text.primary)>=s?dark.text.primary:light.text.primary}const _p=({color:_v,name:n_,mainShade:e_=500,lightShade:t_=300,darkShade:o_=700})=>{if(_v=_extends$3({},_v),!_v.main&&_v[e_]&&(_v.main=_v[e_]),!_v.hasOwnProperty("main"))throw new Error(formatMuiErrorMessage(11,n_?` (${n_})`:"",e_));if(typeof _v.main!="string")throw new Error(formatMuiErrorMessage(12,n_?` (${n_})`:"",JSON.stringify(_v.main)));return addLightOrDark(_v,"light",t_,a),addLightOrDark(_v,"dark",o_,a),_v.contrastText||(_v.contrastText=ba(_v.main)),_v},_f={dark,light};return deepmerge(_extends$3({common:_extends$3({},common$1),mode:o,primary:_p({color:$,name:"primary"}),secondary:_p({color:_e,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:_p({color:_n,name:"error"}),warning:_p({color:na,name:"warning"}),info:_p({color:_r,name:"info"}),success:_p({color:_s,name:"success"}),grey:grey$1,contrastThreshold:s,getContrastText:ba,augmentColor:_p,tonalOffset:a},_f[o]),_)}const _excluded$9=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function round$1(e){return Math.round(e*1e5)/1e5}const caseAllCaps={textTransform:"uppercase"},defaultFontFamily='"Roboto", "Helvetica", "Arial", sans-serif';function createTypography(e,o){const s=typeof o=="function"?o(e):o,{fontFamily:a=defaultFontFamily,fontSize:_=14,fontWeightLight:$=300,fontWeightRegular:_e=400,fontWeightMedium:_n=500,fontWeightBold:_r=700,htmlFontSize:_s=16,allVariants:na,pxToRem:ba}=s,_p=_objectWithoutPropertiesLoose$7(s,_excluded$9),_f=_/14,_E=ba||(e_=>`${e_/_s*_f}rem`),_v=(e_,t_,o_,m_,b_)=>_extends$3({fontFamily:a,fontWeight:e_,fontSize:_E(t_),lineHeight:o_},a===defaultFontFamily?{letterSpacing:`${round$1(m_/t_)}em`}:{},b_,na),n_={h1:_v($,96,1.167,-1.5),h2:_v($,60,1.2,-.5),h3:_v(_e,48,1.167,0),h4:_v(_e,34,1.235,.25),h5:_v(_e,24,1.334,0),h6:_v(_n,20,1.6,.15),subtitle1:_v(_e,16,1.75,.15),subtitle2:_v(_n,14,1.57,.1),body1:_v(_e,16,1.5,.15),body2:_v(_e,14,1.43,.15),button:_v(_n,14,1.75,.4,caseAllCaps),caption:_v(_e,12,1.66,.4),overline:_v(_e,12,2.66,1,caseAllCaps),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return deepmerge(_extends$3({htmlFontSize:_s,pxToRem:_E,fontFamily:a,fontSize:_,fontWeightLight:$,fontWeightRegular:_e,fontWeightMedium:_n,fontWeightBold:_r},n_),_p,{clone:!1})}const shadowKeyUmbraOpacity=.2,shadowKeyPenumbraOpacity=.14,shadowAmbientShadowOpacity=.12;function createShadow(...e){return[`${e[0]}px ${e[1]}px ${e[2]}px ${e[3]}px rgba(0,0,0,${shadowKeyUmbraOpacity})`,`${e[4]}px ${e[5]}px ${e[6]}px ${e[7]}px rgba(0,0,0,${shadowKeyPenumbraOpacity})`,`${e[8]}px ${e[9]}px ${e[10]}px ${e[11]}px rgba(0,0,0,${shadowAmbientShadowOpacity})`].join(",")}const shadows=["none",createShadow(0,2,1,-1,0,1,1,0,0,1,3,0),createShadow(0,3,1,-2,0,2,2,0,0,1,5,0),createShadow(0,3,3,-2,0,3,4,0,0,1,8,0),createShadow(0,2,4,-1,0,4,5,0,0,1,10,0),createShadow(0,3,5,-1,0,5,8,0,0,1,14,0),createShadow(0,3,5,-1,0,6,10,0,0,1,18,0),createShadow(0,4,5,-2,0,7,10,1,0,2,16,1),createShadow(0,5,5,-3,0,8,10,1,0,3,14,2),createShadow(0,5,6,-3,0,9,12,1,0,3,16,2),createShadow(0,6,6,-3,0,10,14,1,0,4,18,3),createShadow(0,6,7,-4,0,11,15,1,0,4,20,3),createShadow(0,7,8,-4,0,12,17,2,0,5,22,4),createShadow(0,7,8,-4,0,13,19,2,0,5,24,4),createShadow(0,7,9,-4,0,14,21,2,0,5,26,4),createShadow(0,8,9,-5,0,15,22,2,0,6,28,5),createShadow(0,8,10,-5,0,16,24,2,0,6,30,5),createShadow(0,8,11,-5,0,17,26,2,0,6,32,5),createShadow(0,9,11,-5,0,18,28,2,0,7,34,6),createShadow(0,9,12,-6,0,19,29,2,0,7,36,6),createShadow(0,10,13,-6,0,20,31,3,0,8,38,7),createShadow(0,10,13,-6,0,21,33,3,0,8,40,7),createShadow(0,10,14,-6,0,22,35,3,0,8,42,7),createShadow(0,11,14,-7,0,23,36,3,0,9,44,8),createShadow(0,11,15,-7,0,24,38,3,0,9,46,8)],shadows$1=shadows,_excluded$8=["duration","easing","delay"],easing={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},duration={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function formatMs(e){return`${Math.round(e)}ms`}function getAutoHeightDuration(e){if(!e)return 0;const o=e/36;return Math.round((4+15*o**.25+o/5)*10)}function createTransitions(e){const o=_extends$3({},easing,e.easing),s=_extends$3({},duration,e.duration);return _extends$3({getAutoHeightDuration,create:(_=["all"],$={})=>{const{duration:_e=s.standard,easing:_n=o.easeInOut,delay:_r=0}=$;return _objectWithoutPropertiesLoose$7($,_excluded$8),(Array.isArray(_)?_:[_]).map(_s=>`${_s} ${typeof _e=="string"?_e:formatMs(_e)} ${_n} ${typeof _r=="string"?_r:formatMs(_r)}`).join(",")}},e,{easing:o,duration:s})}const zIndex={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},zIndex$1=zIndex,_excluded$7=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function createTheme(e={},...o){const{mixins:s={},palette:a={},transitions:_={},typography:$={}}=e,_e=_objectWithoutPropertiesLoose$7(e,_excluded$7);if(e.vars)throw new Error(formatMuiErrorMessage(18));const _n=createPalette(a),_r=createTheme$1(e);let _s=deepmerge(_r,{mixins:createMixins(_r.breakpoints,s),palette:_n,shadows:shadows$1.slice(),typography:createTypography(_n,$),transitions:createTransitions(_),zIndex:_extends$3({},zIndex$1)});return _s=deepmerge(_s,_e),_s=o.reduce((na,ba)=>deepmerge(na,ba),_s),_s.unstable_sxConfig=_extends$3({},defaultSxConfig$1,_e==null?void 0:_e.unstable_sxConfig),_s.unstable_sx=function(ba){return styleFunctionSx$1({sx:ba,theme:this})},_s}const defaultTheme=createTheme(),defaultTheme$1=defaultTheme,THEME_ID="$$material";function useThemeProps({props:e,name:o}){return useThemeProps$1({props:e,name:o,defaultTheme:defaultTheme$1,themeId:THEME_ID})}const rootShouldForwardProp=e=>shouldForwardProp(e)&&e!=="classes",styled=createStyled({themeId:THEME_ID,defaultTheme:defaultTheme$1,rootShouldForwardProp}),styled$1=styled;function getSvgIconUtilityClass(e){return generateUtilityClass("MuiSvgIcon",e)}generateUtilityClasses("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const _excluded$6=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],useUtilityClasses$3=e=>{const{color:o,fontSize:s,classes:a}=e,_={root:["root",o!=="inherit"&&`color${capitalize(o)}`,`fontSize${capitalize(s)}`]};return composeClasses(_,getSvgIconUtilityClass,a)},SvgIconRoot=styled$1("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.root,s.color!=="inherit"&&o[`color${capitalize(s.color)}`],o[`fontSize${capitalize(s.fontSize)}`]]}})(({theme:e,ownerState:o})=>{var s,a,_,$,_e,_n,_r,_s,na,ba,_p,_f,_E;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:o.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(s=e.transitions)==null||(a=s.create)==null?void 0:a.call(s,"fill",{duration:(_=e.transitions)==null||(_=_.duration)==null?void 0:_.shorter}),fontSize:{inherit:"inherit",small:(($=e.typography)==null||(_e=$.pxToRem)==null?void 0:_e.call($,20))||"1.25rem",medium:((_n=e.typography)==null||(_r=_n.pxToRem)==null?void 0:_r.call(_n,24))||"1.5rem",large:((_s=e.typography)==null||(na=_s.pxToRem)==null?void 0:na.call(_s,35))||"2.1875rem"}[o.fontSize],color:(ba=(_p=(e.vars||e).palette)==null||(_p=_p[o.color])==null?void 0:_p.main)!=null?ba:{action:(_f=(e.vars||e).palette)==null||(_f=_f.action)==null?void 0:_f.active,disabled:(_E=(e.vars||e).palette)==null||(_E=_E.action)==null?void 0:_E.disabled,inherit:void 0}[o.color]}}),SvgIcon=reactExports.forwardRef(function(o,s){const a=useThemeProps({props:o,name:"MuiSvgIcon"}),{children:_,className:$,color:_e="inherit",component:_n="svg",fontSize:_r="medium",htmlColor:_s,inheritViewBox:na=!1,titleAccess:ba,viewBox:_p="0 0 24 24"}=a,_f=_objectWithoutPropertiesLoose$7(a,_excluded$6),_E=reactExports.isValidElement(_)&&_.type==="svg",_v=_extends$3({},a,{color:_e,component:_n,fontSize:_r,instanceFontSize:o.fontSize,inheritViewBox:na,viewBox:_p,hasSvgAsChild:_E}),n_={};na||(n_.viewBox=_p);const e_=useUtilityClasses$3(_v);return jsxRuntimeExports.jsxs(SvgIconRoot,_extends$3({as:_n,className:clsx(e_.root,$),focusable:"false",color:_s,"aria-hidden":ba?void 0:!0,role:ba?"img":void 0,ref:s},n_,_f,_E&&_.props,{ownerState:_v,children:[_E?_.props.children:_,ba?jsxRuntimeExports.jsx("title",{children:ba}):null]}))});SvgIcon.muiName="SvgIcon";const SvgIcon$1=SvgIcon;function createSvgIcon(e,o){function s(a,_){return jsxRuntimeExports.jsx(SvgIcon$1,_extends$3({"data-testid":`${o}Icon`,ref:_},a,{children:e}))}return s.muiName=SvgIcon$1.muiName,reactExports.memo(reactExports.forwardRef(s))}const unstable_ClassNameGenerator={configure:e=>{ClassNameGenerator$1.configure(e)}},utils$2=Object.freeze(Object.defineProperty({__proto__:null,capitalize,createChainedFunction,createSvgIcon,debounce,deprecatedPropType,isMuiElement,ownerDocument,ownerWindow,requirePropFactory,setRef,unstable_ClassNameGenerator,unstable_useEnhancedEffect:useEnhancedEffect$1,unstable_useId:useId,unsupportedProp,useControlled,useEventCallback,useForkRef,useIsFocusVisible},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(utils$2);var hasRequiredCreateSvgIcon;function requireCreateSvgIcon(){return hasRequiredCreateSvgIcon||(hasRequiredCreateSvgIcon=1,function(e){"use client";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return o.createSvgIcon}});var o=require$$0}(createSvgIcon$1)),createSvgIcon$1}var _interopRequireDefault$l=interopRequireDefaultExports;Object.defineProperty(Groups2,"__esModule",{value:!0});var default_1$l=Groups2.default=void 0,_createSvgIcon$l=_interopRequireDefault$l(requireCreateSvgIcon()),_jsxRuntime$l=jsxRuntimeExports,_default$l=(0,_createSvgIcon$l.default)((0,_jsxRuntime$l.jsx)("path",{d:"M10.27 12h3.46c.93 0 1.63-.83 1.48-1.75l-.3-1.79C14.67 7.04 13.44 6 12 6S9.33 7.04 9.09 8.47l-.3 1.79c-.15.91.55 1.74 1.48 1.74zm-8.61-.89c-.13.26-.18.57-.1.88.16.69.76 1.03 1.53 1h1.95c.83 0 1.51-.58 1.51-1.29 0-.14-.03-.27-.07-.4-.01-.03-.01-.05.01-.08.09-.16.14-.34.14-.53 0-.31-.14-.6-.36-.82-.03-.03-.03-.06-.02-.1.07-.2.07-.43.01-.65-.16-.43-.55-.72-.99-.74-.03 0-.05-.01-.07-.03-.17-.21-.48-.35-.83-.35-.3 0-.57.1-.75.26-.03.03-.06.03-.09.02-.14-.06-.3-.09-.46-.09-.65 0-1.18.49-1.24 1.12 0 .02-.01.04-.03.06-.29.26-.46.65-.41 1.05.03.22.12.43.25.6.03.02.03.06.02.09zm14.58 2.54c-1.17-.52-2.61-.9-4.24-.9-1.63 0-3.07.39-4.24.9C6.68 14.13 6 15.21 6 16.39V18h12v-1.61c0-1.18-.68-2.26-1.76-2.74zm-15.02.93C.48 14.9 0 15.62 0 16.43V18h4.5v-1.61c0-.83.23-1.61.63-2.29-.37-.06-.74-.1-1.13-.1-.99 0-1.93.21-2.78.58zm21.56 0c-.85-.37-1.79-.58-2.78-.58-.39 0-.76.04-1.13.1.4.68.63 1.46.63 2.29V18H24v-1.57c0-.81-.48-1.53-1.22-1.85zM22 11v-.5c0-1.1-.9-2-2-2h-2c-.42 0-.65.48-.39.81l.7.63c-.19.31-.31.67-.31 1.06 0 1.1.9 2 2 2s2-.9 2-2z"}),"Groups2");default_1$l=Groups2.default=_default$l;var CalendarMonth={},_interopRequireDefault$k=interopRequireDefaultExports;Object.defineProperty(CalendarMonth,"__esModule",{value:!0});var default_1$k=CalendarMonth.default=void 0,_createSvgIcon$k=_interopRequireDefault$k(requireCreateSvgIcon()),_jsxRuntime$k=jsxRuntimeExports,_default$k=(0,_createSvgIcon$k.default)((0,_jsxRuntime$k.jsx)("path",{d:"M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zM9 14H7v-2h2v2zm4 0h-2v-2h2v2zm4 0h-2v-2h2v2zm-8 4H7v-2h2v2zm4 0h-2v-2h2v2zm4 0h-2v-2h2v2z"}),"CalendarMonth");default_1$k=CalendarMonth.default=_default$k;var StopCircle={},_interopRequireDefault$j=interopRequireDefaultExports;Object.defineProperty(StopCircle,"__esModule",{value:!0});var default_1$j=StopCircle.default=void 0,_createSvgIcon$j=_interopRequireDefault$j(requireCreateSvgIcon()),_jsxRuntime$j=jsxRuntimeExports,_default$j=(0,_createSvgIcon$j.default)((0,_jsxRuntime$j.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm4 14H8V8h8v8z"}),"StopCircle");default_1$j=StopCircle.default=_default$j;var QuestionAnswer={},_interopRequireDefault$i=interopRequireDefaultExports;Object.defineProperty(QuestionAnswer,"__esModule",{value:!0});var default_1$i=QuestionAnswer.default=void 0,_createSvgIcon$i=_interopRequireDefault$i(requireCreateSvgIcon()),_jsxRuntime$i=jsxRuntimeExports,_default$i=(0,_createSvgIcon$i.default)((0,_jsxRuntime$i.jsx)("path",{d:"M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1zm-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1z"}),"QuestionAnswer");default_1$i=QuestionAnswer.default=_default$i;var Bolt={},_interopRequireDefault$h=interopRequireDefaultExports;Object.defineProperty(Bolt,"__esModule",{value:!0});var default_1$h=Bolt.default=void 0,_createSvgIcon$h=_interopRequireDefault$h(requireCreateSvgIcon()),_jsxRuntime$h=jsxRuntimeExports,_default$h=(0,_createSvgIcon$h.default)((0,_jsxRuntime$h.jsx)("path",{d:"M11 21h-1l1-7H7.5c-.58 0-.57-.32-.38-.66.19-.34.05-.08.07-.12C8.48 10.94 10.42 7.54 13 3h1l-1 7h3.5c.49 0 .56.33.47.51l-.07.15C12.96 17.55 11 21 11 21z"}),"Bolt");default_1$h=Bolt.default=_default$h;var Google={},_interopRequireDefault$g=interopRequireDefaultExports;Object.defineProperty(Google,"__esModule",{value:!0});var default_1$g=Google.default=void 0;_interopRequireWildcard$3(reactExports);var _createSvgIcon$g=_interopRequireDefault$g(requireCreateSvgIcon()),_jsxRuntime$g=jsxRuntimeExports;function _getRequireWildcardCache$3(e){if(typeof WeakMap!="function")return null;var o=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache$3=function(a){return a?s:o})(e)}function _interopRequireWildcard$3(e,o){if(!o&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var s=_getRequireWildcardCache$3(o);if(s&&s.has(e))return s.get(e);var a={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in e)if($!=="default"&&Object.prototype.hasOwnProperty.call(e,$)){var _e=_?Object.getOwnPropertyDescriptor(e,$):null;_e&&(_e.get||_e.set)?Object.defineProperty(a,$,_e):a[$]=e[$]}return a.default=e,s&&s.set(e,a),a}var _default$g=(0,_createSvgIcon$g.default)((0,_jsxRuntime$g.jsx)("path",{d:"M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"}),"Google");default_1$g=Google.default=_default$g;var Facebook={},_interopRequireDefault$f=interopRequireDefaultExports;Object.defineProperty(Facebook,"__esModule",{value:!0});var default_1$f=Facebook.default=void 0;_interopRequireWildcard$2(reactExports);var _createSvgIcon$f=_interopRequireDefault$f(requireCreateSvgIcon()),_jsxRuntime$f=jsxRuntimeExports;function _getRequireWildcardCache$2(e){if(typeof WeakMap!="function")return null;var o=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache$2=function(a){return a?s:o})(e)}function _interopRequireWildcard$2(e,o){if(!o&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var s=_getRequireWildcardCache$2(o);if(s&&s.has(e))return s.get(e);var a={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in e)if($!=="default"&&Object.prototype.hasOwnProperty.call(e,$)){var _e=_?Object.getOwnPropertyDescriptor(e,$):null;_e&&(_e.get||_e.set)?Object.defineProperty(a,$,_e):a[$]=e[$]}return a.default=e,s&&s.set(e,a),a}var _default$f=(0,_createSvgIcon$f.default)((0,_jsxRuntime$f.jsx)("path",{d:"M5 3h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2m13 2h-2.5A3.5 3.5 0 0 0 12 8.5V11h-2v3h2v7h3v-7h3v-3h-3V9a1 1 0 0 1 1-1h2V5z"}),"Facebook");default_1$f=Facebook.default=_default$f;var Instagram={},_interopRequireDefault$e=interopRequireDefaultExports;Object.defineProperty(Instagram,"__esModule",{value:!0});var default_1$e=Instagram.default=void 0;_interopRequireWildcard$1(reactExports);var _createSvgIcon$e=_interopRequireDefault$e(requireCreateSvgIcon()),_jsxRuntime$e=jsxRuntimeExports;function _getRequireWildcardCache$1(e){if(typeof WeakMap!="function")return null;var o=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache$1=function(a){return a?s:o})(e)}function _interopRequireWildcard$1(e,o){if(!o&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var s=_getRequireWildcardCache$1(o);if(s&&s.has(e))return s.get(e);var a={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in e)if($!=="default"&&Object.prototype.hasOwnProperty.call(e,$)){var _e=_?Object.getOwnPropertyDescriptor(e,$):null;_e&&(_e.get||_e.set)?Object.defineProperty(a,$,_e):a[$]=e[$]}return a.default=e,s&&s.set(e,a),a}var _default$e=(0,_createSvgIcon$e.default)((0,_jsxRuntime$e.jsx)("path",{d:"M7.8 2h8.4C19.4 2 22 4.6 22 7.8v8.4a5.8 5.8 0 0 1-5.8 5.8H7.8C4.6 22 2 19.4 2 16.2V7.8A5.8 5.8 0 0 1 7.8 2m-.2 2A3.6 3.6 0 0 0 4 7.6v8.8C4 18.39 5.61 20 7.6 20h8.8a3.6 3.6 0 0 0 3.6-3.6V7.6C20 5.61 18.39 4 16.4 4H7.6m9.65 1.5a1.25 1.25 0 0 1 1.25 1.25A1.25 1.25 0 0 1 17.25 8 1.25 1.25 0 0 1 16 6.75a1.25 1.25 0 0 1 1.25-1.25M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3z"}),"Instagram");default_1$e=Instagram.default=_default$e;var GitHub={},_interopRequireDefault$d=interopRequireDefaultExports;Object.defineProperty(GitHub,"__esModule",{value:!0});var default_1$d=GitHub.default=void 0;_interopRequireWildcard(reactExports);var _createSvgIcon$d=_interopRequireDefault$d(requireCreateSvgIcon()),_jsxRuntime$d=jsxRuntimeExports;function _getRequireWildcardCache(e){if(typeof WeakMap!="function")return null;var o=new WeakMap,s=new WeakMap;return(_getRequireWildcardCache=function(a){return a?s:o})(e)}function _interopRequireWildcard(e,o){if(!o&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var s=_getRequireWildcardCache(o);if(s&&s.has(e))return s.get(e);var a={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in e)if($!=="default"&&Object.prototype.hasOwnProperty.call(e,$)){var _e=_?Object.getOwnPropertyDescriptor(e,$):null;_e&&(_e.get||_e.set)?Object.defineProperty(a,$,_e):a[$]=e[$]}return a.default=e,s&&s.set(e,a),a}var _default$d=(0,_createSvgIcon$d.default)((0,_jsxRuntime$d.jsx)("path",{d:"M12 1.27a11 11 0 00-3.48 21.46c.55.09.73-.28.73-.55v-1.84c-3.03.64-3.67-1.46-3.67-1.46-.55-1.29-1.28-1.65-1.28-1.65-.92-.65.1-.65.1-.65 1.1 0 1.73 1.1 1.73 1.1.92 1.65 2.57 1.2 3.21.92a2 2 0 01.64-1.47c-2.47-.27-5.04-1.19-5.04-5.5 0-1.1.46-2.1 1.2-2.84a3.76 3.76 0 010-2.93s.91-.28 3.11 1.1c1.8-.49 3.7-.49 5.5 0 2.1-1.38 3.02-1.1 3.02-1.1a3.76 3.76 0 010 2.93c.83.74 1.2 1.74 1.2 2.94 0 4.21-2.57 5.13-5.04 5.4.45.37.82.92.82 2.02v3.03c0 .27.1.64.73.55A11 11 0 0012 1.27"}),"GitHub");default_1$d=GitHub.default=_default$d;function bind(e,o){return function(){return e.apply(o,arguments)}}const{toString:toString$1}=Object.prototype,{getPrototypeOf}=Object,kindOf=(e=>o=>{const s=toString$1.call(o);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=e=>(e=e.toLowerCase(),o=>kindOf(o)===e),typeOfTest=e=>o=>typeof o===e,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(e){return e!==null&&!isUndefined(e)&&e.constructor!==null&&!isUndefined(e.constructor)&&isFunction(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(e){let o;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?o=ArrayBuffer.isView(e):o=e&&e.buffer&&isArrayBuffer(e.buffer),o}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject$1=e=>e!==null&&typeof e=="object",isBoolean=e=>e===!0||e===!1,isPlainObject=e=>{if(kindOf(e)!=="object")return!1;const o=getPrototypeOf(e);return(o===null||o===Object.prototype||Object.getPrototypeOf(o)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=e=>isObject$1(e)&&isFunction(e.pipe),isFormData=e=>{let o;return e&&(typeof FormData=="function"&&e instanceof FormData||isFunction(e.append)&&((o=kindOf(e))==="formdata"||o==="object"&&isFunction(e.toString)&&e.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(e,o,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let a,_;if(typeof e!="object"&&(e=[e]),isArray(e))for(a=0,_=e.length;a<_;a++)o.call(null,e[a],a,e);else{const $=s?Object.getOwnPropertyNames(e):Object.keys(e),_e=$.length;let _n;for(a=0;a<_e;a++)_n=$[a],o.call(null,e[_n],_n,e)}}function findKey(e,o){o=o.toLowerCase();const s=Object.keys(e);let a=s.length,_;for(;a-- >0;)if(_=s[a],o===_.toLowerCase())return _;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=e=>!isUndefined(e)&&e!==_global;function merge(){const{caseless:e}=isContextDefined(this)&&this||{},o={},s=(a,_)=>{const $=e&&findKey(o,_)||_;isPlainObject(o[$])&&isPlainObject(a)?o[$]=merge(o[$],a):isPlainObject(a)?o[$]=merge({},a):isArray(a)?o[$]=a.slice():o[$]=a};for(let a=0,_=arguments.length;a<_;a++)arguments[a]&&forEach(arguments[a],s);return o}const extend=(e,o,s,{allOwnKeys:a}={})=>(forEach(o,(_,$)=>{s&&isFunction(_)?e[$]=bind(_,s):e[$]=_},{allOwnKeys:a}),e),stripBOM=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),inherits=(e,o,s,a)=>{e.prototype=Object.create(o.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:o.prototype}),s&&Object.assign(e.prototype,s)},toFlatObject=(e,o,s,a)=>{let _,$,_e;const _n={};if(o=o||{},e==null)return o;do{for(_=Object.getOwnPropertyNames(e),$=_.length;$-- >0;)_e=_[$],(!a||a(_e,e,o))&&!_n[_e]&&(o[_e]=e[_e],_n[_e]=!0);e=s!==!1&&getPrototypeOf(e)}while(e&&(!s||s(e,o))&&e!==Object.prototype);return o},endsWith=(e,o,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=o.length;const a=e.indexOf(o,s);return a!==-1&&a===s},toArray$1=e=>{if(!e)return null;if(isArray(e))return e;let o=e.length;if(!isNumber(o))return null;const s=new Array(o);for(;o-- >0;)s[o]=e[o];return s},isTypedArray=(e=>o=>e&&o instanceof e)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(e,o)=>{const a=(e&&e[Symbol.iterator]).call(e);let _;for(;(_=a.next())&&!_.done;){const $=_.value;o.call(e,$[0],$[1])}},matchAll=(e,o)=>{let s;const a=[];for(;(s=e.exec(o))!==null;)a.push(s);return a},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,a,_){return a.toUpperCase()+_}),hasOwnProperty=(({hasOwnProperty:e})=>(o,s)=>e.call(o,s))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(e,o)=>{const s=Object.getOwnPropertyDescriptors(e),a={};forEach(s,(_,$)=>{let _e;(_e=o(_,$,e))!==!1&&(a[$]=_e||_)}),Object.defineProperties(e,a)},freezeMethods=e=>{reduceDescriptors(e,(o,s)=>{if(isFunction(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const a=e[s];if(isFunction(a)){if(o.enumerable=!1,"writable"in o){o.writable=!1;return}o.set||(o.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},toObjectSet=(e,o)=>{const s={},a=_=>{_.forEach($=>{s[$]=!0})};return isArray(e)?a(e):a(String(e).split(o)),s},noop=()=>{},toFiniteNumber=(e,o)=>(e=+e,Number.isFinite(e)?e:o),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(e=16,o=ALPHABET.ALPHA_DIGIT)=>{let s="";const{length:a}=o;for(;e--;)s+=o[Math.random()*a|0];return s};function isSpecCompliantForm(e){return!!(e&&isFunction(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const toJSONObject=e=>{const o=new Array(10),s=(a,_)=>{if(isObject$1(a)){if(o.indexOf(a)>=0)return;if(!("toJSON"in a)){o[_]=a;const $=isArray(a)?[]:{};return forEach(a,(_e,_n)=>{const _r=s(_e,_+1);!isUndefined(_r)&&($[_n]=_r)}),o[_]=void 0,$}}return a};return s(e,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=e=>e&&(isObject$1(e)||isFunction(e))&&isFunction(e.then)&&isFunction(e.catch),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject:isObject$1,isPlainObject,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray:toArray$1,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(e,o,s,a,_){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",o&&(this.code=o),s&&(this.config=s),a&&(this.request=a),_&&(this.response=_)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{descriptors[e]={value:e}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(e,o,s,a,_,$)=>{const _e=Object.create(prototype$1);return utils$1.toFlatObject(e,_e,function(_r){return _r!==Error.prototype},_n=>_n!=="isAxiosError"),AxiosError.call(_e,e.message,o,s,a,_),_e.cause=e,_e.name=e.name,$&&Object.assign(_e,$),_e};const httpAdapter=null;function isVisitable(e){return utils$1.isPlainObject(e)||utils$1.isArray(e)}function removeBrackets(e){return utils$1.endsWith(e,"[]")?e.slice(0,-2):e}function renderKey(e,o,s){return e?e.concat(o).map(function(_,$){return _=removeBrackets(_),!s&&$?"["+_+"]":_}).join(s?".":""):o}function isFlatArray(e){return utils$1.isArray(e)&&!e.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(o){return/^is[A-Z]/.test(o)});function toFormData(e,o,s){if(!utils$1.isObject(e))throw new TypeError("target must be an object");o=o||new FormData,s=utils$1.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_v,n_){return!utils$1.isUndefined(n_[_v])});const a=s.metaTokens,_=s.visitor||na,$=s.dots,_e=s.indexes,_r=(s.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(o);if(!utils$1.isFunction(_))throw new TypeError("visitor must be a function");function _s(_E){if(_E===null)return"";if(utils$1.isDate(_E))return _E.toISOString();if(!_r&&utils$1.isBlob(_E))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(_E)||utils$1.isTypedArray(_E)?_r&&typeof Blob=="function"?new Blob([_E]):Buffer.from(_E):_E}function na(_E,_v,n_){let e_=_E;if(_E&&!n_&&typeof _E=="object"){if(utils$1.endsWith(_v,"{}"))_v=a?_v:_v.slice(0,-2),_E=JSON.stringify(_E);else if(utils$1.isArray(_E)&&isFlatArray(_E)||(utils$1.isFileList(_E)||utils$1.endsWith(_v,"[]"))&&(e_=utils$1.toArray(_E)))return _v=removeBrackets(_v),e_.forEach(function(o_,m_){!(utils$1.isUndefined(o_)||o_===null)&&o.append(_e===!0?renderKey([_v],m_,$):_e===null?_v:_v+"[]",_s(o_))}),!1}return isVisitable(_E)?!0:(o.append(renderKey(n_,_v,$),_s(_E)),!1)}const ba=[],_p=Object.assign(predicates,{defaultVisitor:na,convertValue:_s,isVisitable});function _f(_E,_v){if(!utils$1.isUndefined(_E)){if(ba.indexOf(_E)!==-1)throw Error("Circular reference detected in "+_v.join("."));ba.push(_E),utils$1.forEach(_E,function(e_,t_){(!(utils$1.isUndefined(e_)||e_===null)&&_.call(o,e_,utils$1.isString(t_)?t_.trim():t_,_v,_p))===!0&&_f(e_,_v?_v.concat(t_):[t_])}),ba.pop()}}if(!utils$1.isObject(e))throw new TypeError("data must be an object");return _f(e),o}function encode$3(e){const o={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(a){return o[a]})}function AxiosURLSearchParams(e,o){this._pairs=[],e&&toFormData(e,this,o)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(o,s){this._pairs.push([o,s])};prototype.toString=function(o){const s=o?function(a){return o.call(this,a,encode$3)}:encode$3;return this._pairs.map(function(_){return s(_[0])+"="+s(_[1])},"").join("&")};function encode$2(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(e,o,s){if(!o)return e;const a=s&&s.encode||encode$2,_=s&&s.serialize;let $;if(_?$=_(o,s):$=utils$1.isURLSearchParams(o)?o.toString():new AxiosURLSearchParams(o,s).toString(a),$){const _e=e.indexOf("#");_e!==-1&&(e=e.slice(0,_e)),e+=(e.indexOf("?")===-1?"?":"&")+$}return e}class InterceptorManager{constructor(){this.handlers=[]}use(o,s,a){return this.handlers.push({fulfilled:o,rejected:s,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(o){this.handlers[o]&&(this.handlers[o]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(o){utils$1.forEach(this.handlers,function(a){a!==null&&o(a)})}}const InterceptorManager$1=InterceptorManager,transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(e=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(e,o){return toFormData(e,new platform.classes.URLSearchParams,Object.assign({visitor:function(s,a,_,$){return platform.isNode&&utils$1.isBuffer(s)?(this.append(a,s.toString("base64")),!1):$.defaultVisitor.apply(this,arguments)}},o))}function parsePropPath(e){return utils$1.matchAll(/\w+|\[(\w*)]/g,e).map(o=>o[0]==="[]"?"":o[1]||o[0])}function arrayToObject(e){const o={},s=Object.keys(e);let a;const _=s.length;let $;for(a=0;a<_;a++)$=s[a],o[$]=e[$];return o}function formDataToJSON(e){function o(s,a,_,$){let _e=s[$++];const _n=Number.isFinite(+_e),_r=$>=s.length;return _e=!_e&&utils$1.isArray(_)?_.length:_e,_r?(utils$1.hasOwnProp(_,_e)?_[_e]=[_[_e],a]:_[_e]=a,!_n):((!_[_e]||!utils$1.isObject(_[_e]))&&(_[_e]=[]),o(s,a,_[_e],$)&&utils$1.isArray(_[_e])&&(_[_e]=arrayToObject(_[_e])),!_n)}if(utils$1.isFormData(e)&&utils$1.isFunction(e.entries)){const s={};return utils$1.forEachEntry(e,(a,_)=>{o(parsePropPath(a),_,s,0)}),s}return null}function stringifySafely(e,o,s){if(utils$1.isString(e))try{return(o||JSON.parse)(e),utils$1.trim(e)}catch(a){if(a.name!=="SyntaxError")throw a}return(s||JSON.stringify)(e)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http"],transformRequest:[function(o,s){const a=s.getContentType()||"",_=a.indexOf("application/json")>-1,$=utils$1.isObject(o);if($&&utils$1.isHTMLForm(o)&&(o=new FormData(o)),utils$1.isFormData(o))return _&&_?JSON.stringify(formDataToJSON(o)):o;if(utils$1.isArrayBuffer(o)||utils$1.isBuffer(o)||utils$1.isStream(o)||utils$1.isFile(o)||utils$1.isBlob(o))return o;if(utils$1.isArrayBufferView(o))return o.buffer;if(utils$1.isURLSearchParams(o))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),o.toString();let _n;if($){if(a.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(o,this.formSerializer).toString();if((_n=utils$1.isFileList(o))||a.indexOf("multipart/form-data")>-1){const _r=this.env&&this.env.FormData;return toFormData(_n?{"files[]":o}:o,_r&&new _r,this.formSerializer)}}return $||_?(s.setContentType("application/json",!1),stringifySafely(o)):o}],transformResponse:[function(o){const s=this.transitional||defaults.transitional,a=s&&s.forcedJSONParsing,_=this.responseType==="json";if(o&&utils$1.isString(o)&&(a&&!this.responseType||_)){const _e=!(s&&s.silentJSONParsing)&&_;try{return JSON.parse(o)}catch(_n){if(_e)throw _n.name==="SyntaxError"?AxiosError.from(_n,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):_n}}return o}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(o){return o>=200&&o<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],e=>{defaults.headers[e]={}});const defaults$1=defaults,ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=e=>{const o={};let s,a,_;return e&&e.split(`
`).forEach(function(_e){_=_e.indexOf(":"),s=_e.substring(0,_).trim().toLowerCase(),a=_e.substring(_+1).trim(),!(!s||o[s]&&ignoreDuplicateOf[s])&&(s==="set-cookie"?o[s]?o[s].push(a):o[s]=[a]:o[s]=o[s]?o[s]+", "+a:a)}),o},$internals=Symbol("internals");function normalizeHeader(e){return e&&String(e).trim().toLowerCase()}function normalizeValue(e){return e===!1||e==null?e:utils$1.isArray(e)?e.map(normalizeValue):String(e)}function parseTokens(e){const o=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=s.exec(e);)o[a[1]]=a[2];return o}const isValidHeaderName=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function matchHeaderValue(e,o,s,a,_){if(utils$1.isFunction(a))return a.call(this,o,s);if(_&&(o=s),!!utils$1.isString(o)){if(utils$1.isString(a))return o.indexOf(a)!==-1;if(utils$1.isRegExp(a))return a.test(o)}}function formatHeader(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(o,s,a)=>s.toUpperCase()+a)}function buildAccessors(e,o){const s=utils$1.toCamelCase(" "+o);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+s,{value:function(_,$,_e){return this[a].call(this,o,_,$,_e)},configurable:!0})})}class AxiosHeaders{constructor(o){o&&this.set(o)}set(o,s,a){const _=this;function $(_n,_r,_s){const na=normalizeHeader(_r);if(!na)throw new Error("header name must be a non-empty string");const ba=utils$1.findKey(_,na);(!ba||_[ba]===void 0||_s===!0||_s===void 0&&_[ba]!==!1)&&(_[ba||_r]=normalizeValue(_n))}const _e=(_n,_r)=>utils$1.forEach(_n,(_s,na)=>$(_s,na,_r));return utils$1.isPlainObject(o)||o instanceof this.constructor?_e(o,s):utils$1.isString(o)&&(o=o.trim())&&!isValidHeaderName(o)?_e(parseHeaders(o),s):o!=null&&$(s,o,a),this}get(o,s){if(o=normalizeHeader(o),o){const a=utils$1.findKey(this,o);if(a){const _=this[a];if(!s)return _;if(s===!0)return parseTokens(_);if(utils$1.isFunction(s))return s.call(this,_,a);if(utils$1.isRegExp(s))return s.exec(_);throw new TypeError("parser must be boolean|regexp|function")}}}has(o,s){if(o=normalizeHeader(o),o){const a=utils$1.findKey(this,o);return!!(a&&this[a]!==void 0&&(!s||matchHeaderValue(this,this[a],a,s)))}return!1}delete(o,s){const a=this;let _=!1;function $(_e){if(_e=normalizeHeader(_e),_e){const _n=utils$1.findKey(a,_e);_n&&(!s||matchHeaderValue(a,a[_n],_n,s))&&(delete a[_n],_=!0)}}return utils$1.isArray(o)?o.forEach($):$(o),_}clear(o){const s=Object.keys(this);let a=s.length,_=!1;for(;a--;){const $=s[a];(!o||matchHeaderValue(this,this[$],$,o,!0))&&(delete this[$],_=!0)}return _}normalize(o){const s=this,a={};return utils$1.forEach(this,(_,$)=>{const _e=utils$1.findKey(a,$);if(_e){s[_e]=normalizeValue(_),delete s[$];return}const _n=o?formatHeader($):String($).trim();_n!==$&&delete s[$],s[_n]=normalizeValue(_),a[_n]=!0}),this}concat(...o){return this.constructor.concat(this,...o)}toJSON(o){const s=Object.create(null);return utils$1.forEach(this,(a,_)=>{a!=null&&a!==!1&&(s[_]=o&&utils$1.isArray(a)?a.join(", "):a)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([o,s])=>o+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(o){return o instanceof this?o:new this(o)}static concat(o,...s){const a=new this(o);return s.forEach(_=>a.set(_)),a}static accessor(o){const a=(this[$internals]=this[$internals]={accessors:{}}).accessors,_=this.prototype;function $(_e){const _n=normalizeHeader(_e);a[_n]||(buildAccessors(_,_e),a[_n]=!0)}return utils$1.isArray(o)?o.forEach($):$(o),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:e},o)=>{let s=o[0].toUpperCase()+o.slice(1);return{get:()=>e,set(a){this[s]=a}}});utils$1.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(e,o){const s=this||defaults$1,a=o||s,_=AxiosHeaders$1.from(a.headers);let $=a.data;return utils$1.forEach(e,function(_n){$=_n.call(s,$,_.normalize(),o?o.status:void 0)}),_.normalize(),$}function isCancel(e){return!!(e&&e.__CANCEL__)}function CanceledError(e,o,s){AxiosError.call(this,e??"canceled",AxiosError.ERR_CANCELED,o,s),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(e,o,s){const a=s.config.validateStatus;!s.status||!a||a(s.status)?e(s):o(new AxiosError("Request failed with status code "+s.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}const cookies=platform.hasStandardBrowserEnv?{write(e,o,s,a,_,$){const _e=[e+"="+encodeURIComponent(o)];utils$1.isNumber(s)&&_e.push("expires="+new Date(s).toGMTString()),utils$1.isString(a)&&_e.push("path="+a),utils$1.isString(_)&&_e.push("domain="+_),$===!0&&_e.push("secure"),document.cookie=_e.join("; ")},read(e){const o=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return o?decodeURIComponent(o[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function combineURLs(e,o){return o?e.replace(/\/+$/,"")+"/"+o.replace(/^\/+/,""):e}function buildFullPath(e,o){return e&&!isAbsoluteURL(o)?combineURLs(e,o):o}const isURLSameOrigin=platform.hasStandardBrowserEnv?function(){const o=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a");let a;function _($){let _e=$;return o&&(s.setAttribute("href",_e),_e=s.href),s.setAttribute("href",_e),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return a=_(window.location.href),function(_e){const _n=utils$1.isString(_e)?_(_e):_e;return _n.protocol===a.protocol&&_n.host===a.host}}():function(){return function(){return!0}}();function parseProtocol(e){const o=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return o&&o[1]||""}function speedometer(e,o){e=e||10;const s=new Array(e),a=new Array(e);let _=0,$=0,_e;return o=o!==void 0?o:1e3,function(_r){const _s=Date.now(),na=a[$];_e||(_e=_s),s[_]=_r,a[_]=_s;let ba=$,_p=0;for(;ba!==_;)_p+=s[ba++],ba=ba%e;if(_=(_+1)%e,_===$&&($=($+1)%e),_s-_e<o)return;const _f=na&&_s-na;return _f?Math.round(_p*1e3/_f):void 0}}function progressEventReducer(e,o){let s=0;const a=speedometer(50,250);return _=>{const $=_.loaded,_e=_.lengthComputable?_.total:void 0,_n=$-s,_r=a(_n),_s=$<=_e;s=$;const na={loaded:$,total:_e,progress:_e?$/_e:void 0,bytes:_n,rate:_r||void 0,estimated:_r&&_e&&_s?(_e-$)/_r:void 0,event:_};na[o?"download":"upload"]=!0,e(na)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(e){return new Promise(function(s,a){let _=e.data;const $=AxiosHeaders$1.from(e.headers).normalize();let{responseType:_e,withXSRFToken:_n}=e,_r;function _s(){e.cancelToken&&e.cancelToken.unsubscribe(_r),e.signal&&e.signal.removeEventListener("abort",_r)}let na;if(utils$1.isFormData(_)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)$.setContentType(!1);else if((na=$.getContentType())!==!1){const[_v,...n_]=na?na.split(";").map(e_=>e_.trim()).filter(Boolean):[];$.setContentType([_v||"multipart/form-data",...n_].join("; "))}}let ba=new XMLHttpRequest;if(e.auth){const _v=e.auth.username||"",n_=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";$.set("Authorization","Basic "+btoa(_v+":"+n_))}const _p=buildFullPath(e.baseURL,e.url);ba.open(e.method.toUpperCase(),buildURL(_p,e.params,e.paramsSerializer),!0),ba.timeout=e.timeout;function _f(){if(!ba)return;const _v=AxiosHeaders$1.from("getAllResponseHeaders"in ba&&ba.getAllResponseHeaders()),e_={data:!_e||_e==="text"||_e==="json"?ba.responseText:ba.response,status:ba.status,statusText:ba.statusText,headers:_v,config:e,request:ba};settle(function(o_){s(o_),_s()},function(o_){a(o_),_s()},e_),ba=null}if("onloadend"in ba?ba.onloadend=_f:ba.onreadystatechange=function(){!ba||ba.readyState!==4||ba.status===0&&!(ba.responseURL&&ba.responseURL.indexOf("file:")===0)||setTimeout(_f)},ba.onabort=function(){ba&&(a(new AxiosError("Request aborted",AxiosError.ECONNABORTED,e,ba)),ba=null)},ba.onerror=function(){a(new AxiosError("Network Error",AxiosError.ERR_NETWORK,e,ba)),ba=null},ba.ontimeout=function(){let n_=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";const e_=e.transitional||transitionalDefaults;e.timeoutErrorMessage&&(n_=e.timeoutErrorMessage),a(new AxiosError(n_,e_.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,e,ba)),ba=null},platform.hasStandardBrowserEnv&&(_n&&utils$1.isFunction(_n)&&(_n=_n(e)),_n||_n!==!1&&isURLSameOrigin(_p))){const _v=e.xsrfHeaderName&&e.xsrfCookieName&&cookies.read(e.xsrfCookieName);_v&&$.set(e.xsrfHeaderName,_v)}_===void 0&&$.setContentType(null),"setRequestHeader"in ba&&utils$1.forEach($.toJSON(),function(n_,e_){ba.setRequestHeader(e_,n_)}),utils$1.isUndefined(e.withCredentials)||(ba.withCredentials=!!e.withCredentials),_e&&_e!=="json"&&(ba.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&ba.addEventListener("progress",progressEventReducer(e.onDownloadProgress,!0)),typeof e.onUploadProgress=="function"&&ba.upload&&ba.upload.addEventListener("progress",progressEventReducer(e.onUploadProgress)),(e.cancelToken||e.signal)&&(_r=_v=>{ba&&(a(!_v||_v.type?new CanceledError(null,e,ba):_v),ba.abort(),ba=null)},e.cancelToken&&e.cancelToken.subscribe(_r),e.signal&&(e.signal.aborted?_r():e.signal.addEventListener("abort",_r)));const _E=parseProtocol(_p);if(_E&&platform.protocols.indexOf(_E)===-1){a(new AxiosError("Unsupported protocol "+_E+":",AxiosError.ERR_BAD_REQUEST,e));return}ba.send(_||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils$1.forEach(knownAdapters,(e,o)=>{if(e){try{Object.defineProperty(e,"name",{value:o})}catch{}Object.defineProperty(e,"adapterName",{value:o})}});const renderReason=e=>`- ${e}`,isResolvedHandle=e=>utils$1.isFunction(e)||e===null||e===!1,adapters={getAdapter:e=>{e=utils$1.isArray(e)?e:[e];const{length:o}=e;let s,a;const _={};for(let $=0;$<o;$++){s=e[$];let _e;if(a=s,!isResolvedHandle(s)&&(a=knownAdapters[(_e=String(s)).toLowerCase()],a===void 0))throw new AxiosError(`Unknown adapter '${_e}'`);if(a)break;_[_e||"#"+$]=a}if(!a){const $=Object.entries(_).map(([_n,_r])=>`adapter ${_n} `+(_r===!1?"is not supported by the environment":"is not available in the build"));let _e=o?$.length>1?`since :
`+$.map(renderReason).join(`
`):" "+renderReason($[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+_e,"ERR_NOT_SUPPORT")}return a},adapters:knownAdapters};function throwIfCancellationRequested(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new CanceledError(null,e)}function dispatchRequest(e){return throwIfCancellationRequested(e),e.headers=AxiosHeaders$1.from(e.headers),e.data=transformData.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(e.adapter||defaults$1.adapter)(e).then(function(a){return throwIfCancellationRequested(e),a.data=transformData.call(e,e.transformResponse,a),a.headers=AxiosHeaders$1.from(a.headers),a},function(a){return isCancel(a)||(throwIfCancellationRequested(e),a&&a.response&&(a.response.data=transformData.call(e,e.transformResponse,a.response),a.response.headers=AxiosHeaders$1.from(a.response.headers))),Promise.reject(a)})}const headersToObject=e=>e instanceof AxiosHeaders$1?e.toJSON():e;function mergeConfig(e,o){o=o||{};const s={};function a(_s,na,ba){return utils$1.isPlainObject(_s)&&utils$1.isPlainObject(na)?utils$1.merge.call({caseless:ba},_s,na):utils$1.isPlainObject(na)?utils$1.merge({},na):utils$1.isArray(na)?na.slice():na}function _(_s,na,ba){if(utils$1.isUndefined(na)){if(!utils$1.isUndefined(_s))return a(void 0,_s,ba)}else return a(_s,na,ba)}function $(_s,na){if(!utils$1.isUndefined(na))return a(void 0,na)}function _e(_s,na){if(utils$1.isUndefined(na)){if(!utils$1.isUndefined(_s))return a(void 0,_s)}else return a(void 0,na)}function _n(_s,na,ba){if(ba in o)return a(_s,na);if(ba in e)return a(void 0,_s)}const _r={url:$,method:$,data:$,baseURL:_e,transformRequest:_e,transformResponse:_e,paramsSerializer:_e,timeout:_e,timeoutMessage:_e,withCredentials:_e,withXSRFToken:_e,adapter:_e,responseType:_e,xsrfCookieName:_e,xsrfHeaderName:_e,onUploadProgress:_e,onDownloadProgress:_e,decompress:_e,maxContentLength:_e,maxBodyLength:_e,beforeRedirect:_e,transport:_e,httpAgent:_e,httpsAgent:_e,cancelToken:_e,socketPath:_e,responseEncoding:_e,validateStatus:_n,headers:(_s,na)=>_(headersToObject(_s),headersToObject(na),!0)};return utils$1.forEach(Object.keys(Object.assign({},e,o)),function(na){const ba=_r[na]||_,_p=ba(e[na],o[na],na);utils$1.isUndefined(_p)&&ba!==_n||(s[na]=_p)}),s}const VERSION="1.6.2",validators$1={};["object","boolean","number","function","string","symbol"].forEach((e,o)=>{validators$1[e]=function(a){return typeof a===e||"a"+(o<1?"n ":" ")+e}});const deprecatedWarnings={};validators$1.transitional=function(o,s,a){function _($,_e){return"[Axios v"+VERSION+"] Transitional option '"+$+"'"+_e+(a?". "+a:"")}return($,_e,_n)=>{if(o===!1)throw new AxiosError(_(_e," has been removed"+(s?" in "+s:"")),AxiosError.ERR_DEPRECATED);return s&&!deprecatedWarnings[_e]&&(deprecatedWarnings[_e]=!0,console.warn(_(_e," has been deprecated since v"+s+" and will be removed in the near future"))),o?o($,_e,_n):!0}};function assertOptions(e,o,s){if(typeof e!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let _=a.length;for(;_-- >0;){const $=a[_],_e=o[$];if(_e){const _n=e[$],_r=_n===void 0||_e(_n,$,e);if(_r!==!0)throw new AxiosError("option "+$+" must be "+_r,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new AxiosError("Unknown option "+$,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(o){this.defaults=o,this.interceptors={request:new InterceptorManager$1,response:new InterceptorManager$1}}request(o,s){typeof o=="string"?(s=s||{},s.url=o):s=o||{},s=mergeConfig(this.defaults,s);const{transitional:a,paramsSerializer:_,headers:$}=s;a!==void 0&&validator.assertOptions(a,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),_!=null&&(utils$1.isFunction(_)?s.paramsSerializer={serialize:_}:validator.assertOptions(_,{encode:validators.function,serialize:validators.function},!0)),s.method=(s.method||this.defaults.method||"get").toLowerCase();let _e=$&&utils$1.merge($.common,$[s.method]);$&&utils$1.forEach(["delete","get","head","post","put","patch","common"],_E=>{delete $[_E]}),s.headers=AxiosHeaders$1.concat(_e,$);const _n=[];let _r=!0;this.interceptors.request.forEach(function(_v){typeof _v.runWhen=="function"&&_v.runWhen(s)===!1||(_r=_r&&_v.synchronous,_n.unshift(_v.fulfilled,_v.rejected))});const _s=[];this.interceptors.response.forEach(function(_v){_s.push(_v.fulfilled,_v.rejected)});let na,ba=0,_p;if(!_r){const _E=[dispatchRequest.bind(this),void 0];for(_E.unshift.apply(_E,_n),_E.push.apply(_E,_s),_p=_E.length,na=Promise.resolve(s);ba<_p;)na=na.then(_E[ba++],_E[ba++]);return na}_p=_n.length;let _f=s;for(ba=0;ba<_p;){const _E=_n[ba++],_v=_n[ba++];try{_f=_E(_f)}catch(n_){_v.call(this,n_);break}}try{na=dispatchRequest.call(this,_f)}catch(_E){return Promise.reject(_E)}for(ba=0,_p=_s.length;ba<_p;)na=na.then(_s[ba++],_s[ba++]);return na}getUri(o){o=mergeConfig(this.defaults,o);const s=buildFullPath(o.baseURL,o.url);return buildURL(s,o.params,o.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(o){Axios.prototype[o]=function(s,a){return this.request(mergeConfig(a||{},{method:o,url:s,data:(a||{}).data}))}});utils$1.forEach(["post","put","patch"],function(o){function s(a){return function($,_e,_n){return this.request(mergeConfig(_n||{},{method:o,headers:a?{"Content-Type":"multipart/form-data"}:{},url:$,data:_e}))}}Axios.prototype[o]=s(),Axios.prototype[o+"Form"]=s(!0)});const Axios$1=Axios;class CancelToken{constructor(o){if(typeof o!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function($){s=$});const a=this;this.promise.then(_=>{if(!a._listeners)return;let $=a._listeners.length;for(;$-- >0;)a._listeners[$](_);a._listeners=null}),this.promise.then=_=>{let $;const _e=new Promise(_n=>{a.subscribe(_n),$=_n}).then(_);return _e.cancel=function(){a.unsubscribe($)},_e},o(function($,_e,_n){a.reason||(a.reason=new CanceledError($,_e,_n),s(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(o){if(this.reason){o(this.reason);return}this._listeners?this._listeners.push(o):this._listeners=[o]}unsubscribe(o){if(!this._listeners)return;const s=this._listeners.indexOf(o);s!==-1&&this._listeners.splice(s,1)}static source(){let o;return{token:new CancelToken(function(_){o=_}),cancel:o}}}const CancelToken$1=CancelToken;function spread(e){return function(s){return e.apply(null,s)}}function isAxiosError(e){return utils$1.isObject(e)&&e.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([e,o])=>{HttpStatusCode[o]=e});const HttpStatusCode$1=HttpStatusCode;function createInstance(e){const o=new Axios$1(e),s=bind(Axios$1.prototype.request,o);return utils$1.extend(s,Axios$1.prototype,o,{allOwnKeys:!0}),utils$1.extend(s,o,null,{allOwnKeys:!0}),s.create=function(_){return createInstance(mergeConfig(e,_))},s}const axios=createInstance(defaults$1);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(o){return Promise.all(o)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=e=>formDataToJSON(utils$1.isHTMLForm(e)?new FormData(e):e);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const axios$1=axios,AuthContext=reactExports.createContext(),AuthContextProvider=({children:e})=>{const o=useNavigate(),s=async $=>{try{await axios$1.post("https://vision-link-api.onrender.com/auth/login",$).then(async _e=>{await localStorage.setItem("userToken",_e.data.token),await localStorage.setItem("userId",_e.data.user._id),await localStorage.setItem("userName",_e.data.user.username),await localStorage.setItem("userEmail",_e.data.user.email),o("/")}).catch(_e=>{console.log(_e)})}catch(_e){console.log(_e)}},a=async $=>{try{await axios$1.post("https://vision-link-api.onrender.com/auth/register",$).then(async _e=>{await localStorage.setItem("userToken",_e.data.token),await localStorage.setItem("userId",_e.data.user._id),await localStorage.setItem("userName",_e.data.user.username),await localStorage.setItem("userEmail",_e.data.user.email),o("/")}).catch(_e=>{console.log(_e)})}catch(_e){console.log(_e)}},_=async()=>{localStorage.clear();for(let $ in localStorage)localStorage.hasOwnProperty($)&&localStorage.removeItem($);o("/")};return jsxRuntimeExports.jsx(AuthContext.Provider,{value:{login:s,register:a,logout:_},children:e})},PACKET_TYPES=Object.create(null);PACKET_TYPES.open="0";PACKET_TYPES.close="1";PACKET_TYPES.ping="2";PACKET_TYPES.pong="3";PACKET_TYPES.message="4";PACKET_TYPES.upgrade="5";PACKET_TYPES.noop="6";const PACKET_TYPES_REVERSE=Object.create(null);Object.keys(PACKET_TYPES).forEach(e=>{PACKET_TYPES_REVERSE[PACKET_TYPES[e]]=e});const ERROR_PACKET={type:"error",data:"parser error"},withNativeBlob$1=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",withNativeArrayBuffer$2=typeof ArrayBuffer=="function",isView$1=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,encodePacket=({type:e,data:o},s,a)=>withNativeBlob$1&&o instanceof Blob?s?a(o):encodeBlobAsBase64(o,a):withNativeArrayBuffer$2&&(o instanceof ArrayBuffer||isView$1(o))?s?a(o):encodeBlobAsBase64(new Blob([o]),a):a(PACKET_TYPES[e]+(o||"")),encodeBlobAsBase64=(e,o)=>{const s=new FileReader;return s.onload=function(){const a=s.result.split(",")[1];o("b"+(a||""))},s.readAsDataURL(e)};function toArray(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let TEXT_ENCODER;function encodePacketToBinary(e,o){if(withNativeBlob$1&&e.data instanceof Blob)return e.data.arrayBuffer().then(toArray).then(o);if(withNativeArrayBuffer$2&&(e.data instanceof ArrayBuffer||isView$1(e.data)))return o(toArray(e.data));encodePacket(e,!1,s=>{TEXT_ENCODER||(TEXT_ENCODER=new TextEncoder),o(TEXT_ENCODER.encode(s))})}const chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup$1=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<chars.length;e++)lookup$1[chars.charCodeAt(e)]=e;const decode$1=e=>{let o=e.length*.75,s=e.length,a,_=0,$,_e,_n,_r;e[e.length-1]==="="&&(o--,e[e.length-2]==="="&&o--);const _s=new ArrayBuffer(o),na=new Uint8Array(_s);for(a=0;a<s;a+=4)$=lookup$1[e.charCodeAt(a)],_e=lookup$1[e.charCodeAt(a+1)],_n=lookup$1[e.charCodeAt(a+2)],_r=lookup$1[e.charCodeAt(a+3)],na[_++]=$<<2|_e>>4,na[_++]=(_e&15)<<4|_n>>2,na[_++]=(_n&3)<<6|_r&63;return _s},withNativeArrayBuffer$1=typeof ArrayBuffer=="function",decodePacket=(e,o)=>{if(typeof e!="string")return{type:"message",data:mapBinary(e,o)};const s=e.charAt(0);return s==="b"?{type:"message",data:decodeBase64Packet(e.substring(1),o)}:PACKET_TYPES_REVERSE[s]?e.length>1?{type:PACKET_TYPES_REVERSE[s],data:e.substring(1)}:{type:PACKET_TYPES_REVERSE[s]}:ERROR_PACKET},decodeBase64Packet=(e,o)=>{if(withNativeArrayBuffer$1){const s=decode$1(e);return mapBinary(s,o)}else return{base64:!0,data:e}},mapBinary=(e,o)=>{switch(o){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},SEPARATOR="",encodePayload=(e,o)=>{const s=e.length,a=new Array(s);let _=0;e.forEach(($,_e)=>{encodePacket($,!1,_n=>{a[_e]=_n,++_===s&&o(a.join(SEPARATOR))})})},decodePayload=(e,o)=>{const s=e.split(SEPARATOR),a=[];for(let _=0;_<s.length;_++){const $=decodePacket(s[_],o);if(a.push($),$.type==="error")break}return a};function createPacketEncoderStream(){return new TransformStream({transform(e,o){encodePacketToBinary(e,s=>{const a=s.length;let _;if(a<126)_=new Uint8Array(1),new DataView(_.buffer).setUint8(0,a);else if(a<65536){_=new Uint8Array(3);const $=new DataView(_.buffer);$.setUint8(0,126),$.setUint16(1,a)}else{_=new Uint8Array(9);const $=new DataView(_.buffer);$.setUint8(0,127),$.setBigUint64(1,BigInt(a))}e.data&&typeof e.data!="string"&&(_[0]|=128),o.enqueue(_),o.enqueue(s)})}})}let TEXT_DECODER;function totalLength(e){return e.reduce((o,s)=>o+s.length,0)}function concatChunks(e,o){if(e[0].length===o)return e.shift();const s=new Uint8Array(o);let a=0;for(let _=0;_<o;_++)s[_]=e[0][a++],a===e[0].length&&(e.shift(),a=0);return e.length&&a<e[0].length&&(e[0]=e[0].slice(a)),s}function createPacketDecoderStream(e,o){TEXT_DECODER||(TEXT_DECODER=new TextDecoder);const s=[];let a=0,_=-1,$=!1;return new TransformStream({transform(_e,_n){for(s.push(_e);;){if(a===0){if(totalLength(s)<1)break;const _r=concatChunks(s,1);$=(_r[0]&128)===128,_=_r[0]&127,_<126?a=3:_===126?a=1:a=2}else if(a===1){if(totalLength(s)<2)break;const _r=concatChunks(s,2);_=new DataView(_r.buffer,_r.byteOffset,_r.length).getUint16(0),a=3}else if(a===2){if(totalLength(s)<8)break;const _r=concatChunks(s,8),_s=new DataView(_r.buffer,_r.byteOffset,_r.length),na=_s.getUint32(0);if(na>Math.pow(2,21)-1){_n.enqueue(ERROR_PACKET);break}_=na*Math.pow(2,32)+_s.getUint32(4),a=3}else{if(totalLength(s)<_)break;const _r=concatChunks(s,_);_n.enqueue(decodePacket($?_r:TEXT_DECODER.decode(_r),o)),a=0}if(_===0||_>e){_n.enqueue(ERROR_PACKET);break}}}})}const protocol$1=4;function Emitter(e){if(e)return mixin(e)}function mixin(e){for(var o in Emitter.prototype)e[o]=Emitter.prototype[o];return e}Emitter.prototype.on=Emitter.prototype.addEventListener=function(e,o){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(o),this};Emitter.prototype.once=function(e,o){function s(){this.off(e,s),o.apply(this,arguments)}return s.fn=o,this.on(e,s),this};Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(e,o){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+e];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var a,_=0;_<s.length;_++)if(a=s[_],a===o||a.fn===o){s.splice(_,1);break}return s.length===0&&delete this._callbacks["$"+e],this};Emitter.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var o=new Array(arguments.length-1),s=this._callbacks["$"+e],a=1;a<arguments.length;a++)o[a-1]=arguments[a];if(s){s=s.slice(0);for(var a=0,_=s.length;a<_;++a)s[a].apply(this,o)}return this};Emitter.prototype.emitReserved=Emitter.prototype.emit;Emitter.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Emitter.prototype.hasListeners=function(e){return!!this.listeners(e).length};const globalThisShim=typeof self<"u"?self:typeof window<"u"?window:Function("return this")();function pick(e,...o){return o.reduce((s,a)=>(e.hasOwnProperty(a)&&(s[a]=e[a]),s),{})}const NATIVE_SET_TIMEOUT=globalThisShim.setTimeout,NATIVE_CLEAR_TIMEOUT=globalThisShim.clearTimeout;function installTimerFunctions(e,o){o.useNativeTimers?(e.setTimeoutFn=NATIVE_SET_TIMEOUT.bind(globalThisShim),e.clearTimeoutFn=NATIVE_CLEAR_TIMEOUT.bind(globalThisShim)):(e.setTimeoutFn=globalThisShim.setTimeout.bind(globalThisShim),e.clearTimeoutFn=globalThisShim.clearTimeout.bind(globalThisShim))}const BASE64_OVERHEAD=1.33;function byteLength(e){return typeof e=="string"?utf8Length(e):Math.ceil((e.byteLength||e.size)*BASE64_OVERHEAD)}function utf8Length(e){let o=0,s=0;for(let a=0,_=e.length;a<_;a++)o=e.charCodeAt(a),o<128?s+=1:o<2048?s+=2:o<55296||o>=57344?s+=3:(a++,s+=4);return s}function encode$1(e){let o="";for(let s in e)e.hasOwnProperty(s)&&(o.length&&(o+="&"),o+=encodeURIComponent(s)+"="+encodeURIComponent(e[s]));return o}function decode(e){let o={},s=e.split("&");for(let a=0,_=s.length;a<_;a++){let $=s[a].split("=");o[decodeURIComponent($[0])]=decodeURIComponent($[1])}return o}class TransportError extends Error{constructor(o,s,a){super(o),this.description=s,this.context=a,this.type="TransportError"}}class Transport extends Emitter{constructor(o){super(),this.writable=!1,installTimerFunctions(this,o),this.opts=o,this.query=o.query,this.socket=o.socket}onError(o,s,a){return super.emitReserved("error",new TransportError(o,s,a)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(o){this.readyState==="open"&&this.write(o)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(o){const s=decodePacket(o,this.socket.binaryType);this.onPacket(s)}onPacket(o){super.emitReserved("packet",o)}onClose(o){this.readyState="closed",super.emitReserved("close",o)}pause(o){}createUri(o,s={}){return o+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const o=this.opts.hostname;return o.indexOf(":")===-1?o:"["+o+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(o){const s=encode$1(o);return s.length?"?"+s:""}}const alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map={};let seed=0,i=0,prev;function encode(e){let o="";do o=alphabet[e%length]+o,e=Math.floor(e/length);while(e>0);return o}function yeast(){const e=encode(+new Date);return e!==prev?(seed=0,prev=e):e+"."+encode(seed++)}for(;i<length;i++)map[alphabet[i]]=i;let value=!1;try{value=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const hasCORS=value;function XHR(e){const o=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!o||hasCORS))return new XMLHttpRequest}catch{}if(!o)try{return new globalThisShim[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function createCookieJar(){}function empty(){}const hasXHR2=function(){return new XHR({xdomain:!1}).responseType!=null}();class Polling extends Transport{constructor(o){if(super(o),this.polling=!1,typeof location<"u"){const a=location.protocol==="https:";let _=location.port;_||(_=a?"443":"80"),this.xd=typeof location<"u"&&o.hostname!==location.hostname||_!==o.port}const s=o&&o.forceBase64;this.supportsBinary=hasXHR2&&!s,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(o){this.readyState="pausing";const s=()=>{this.readyState="paused",o()};if(this.polling||!this.writable){let a=0;this.polling&&(a++,this.once("pollComplete",function(){--a||s()})),this.writable||(a++,this.once("drain",function(){--a||s()}))}else s()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(o){const s=a=>{if(this.readyState==="opening"&&a.type==="open"&&this.onOpen(),a.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};decodePayload(o,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const o=()=>{this.write([{type:"close"}])};this.readyState==="open"?o():this.once("open",o)}write(o){this.writable=!1,encodePayload(o,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const o=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=yeast()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(o,s)}request(o={}){return Object.assign(o,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new Request(this.uri(),o)}doWrite(o,s){const a=this.request({method:"POST",data:o});a.on("success",s),a.on("error",(_,$)=>{this.onError("xhr post error",_,$)})}doPoll(){const o=this.request();o.on("data",this.onData.bind(this)),o.on("error",(s,a)=>{this.onError("xhr poll error",s,a)}),this.pollXhr=o}}class Request extends Emitter{constructor(o,s){super(),installTimerFunctions(this,s),this.opts=s,this.method=s.method||"GET",this.uri=o,this.data=s.data!==void 0?s.data:null,this.create()}create(){var o;const s=pick(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this.opts.xd;const a=this.xhr=new XHR(s);try{a.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders){a.setDisableHeaderCheck&&a.setDisableHeaderCheck(!0);for(let _ in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(_)&&a.setRequestHeader(_,this.opts.extraHeaders[_])}}catch{}if(this.method==="POST")try{a.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{a.setRequestHeader("Accept","*/*")}catch{}(o=this.opts.cookieJar)===null||o===void 0||o.addCookies(a),"withCredentials"in a&&(a.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(a.timeout=this.opts.requestTimeout),a.onreadystatechange=()=>{var _;a.readyState===3&&((_=this.opts.cookieJar)===null||_===void 0||_.parseCookies(a)),a.readyState===4&&(a.status===200||a.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof a.status=="number"?a.status:0)},0))},a.send(this.data)}catch(_){this.setTimeoutFn(()=>{this.onError(_)},0);return}typeof document<"u"&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)}onError(o){this.emitReserved("error",o,this.xhr),this.cleanup(!0)}cleanup(o){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=empty,o)try{this.xhr.abort()}catch{}typeof document<"u"&&delete Request.requests[this.index],this.xhr=null}}onLoad(){const o=this.xhr.responseText;o!==null&&(this.emitReserved("data",o),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}Request.requestsCount=0;Request.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",unloadHandler);else if(typeof addEventListener=="function"){const e="onpagehide"in globalThisShim?"pagehide":"unload";addEventListener(e,unloadHandler,!1)}}function unloadHandler(){for(let e in Request.requests)Request.requests.hasOwnProperty(e)&&Request.requests[e].abort()}const nextTick=typeof Promise=="function"&&typeof Promise.resolve=="function"?o=>Promise.resolve().then(o):(o,s)=>s(o,0),WebSocket$1=globalThisShim.WebSocket||globalThisShim.MozWebSocket,usingBrowserWebSocket=!0,defaultBinaryType="arraybuffer",isReactNative=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";let WS$1=class extends Transport{constructor(o){super(o),this.supportsBinary=!o.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const o=this.uri(),s=this.opts.protocols,a=isReactNative?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(a.headers=this.opts.extraHeaders);try{this.ws=usingBrowserWebSocket&&!isReactNative?s?new WebSocket$1(o,s):new WebSocket$1(o):new WebSocket$1(o,s,a)}catch(_){return this.emitReserved("error",_)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=o=>this.onClose({description:"websocket connection closed",context:o}),this.ws.onmessage=o=>this.onData(o.data),this.ws.onerror=o=>this.onError("websocket error",o)}write(o){this.writable=!1;for(let s=0;s<o.length;s++){const a=o[s],_=s===o.length-1;encodePacket(a,this.supportsBinary,$=>{const _e={};try{usingBrowserWebSocket&&this.ws.send($)}catch{}_&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){const o=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=yeast()),this.supportsBinary||(s.b64=1),this.createUri(o,s)}check(){return!!WebSocket$1}};class WT extends Transport{get name(){return"webtransport"}doOpen(){typeof WebTransport=="function"&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(o=>{this.onError("webtransport error",o)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(o=>{const s=createPacketDecoderStream(Number.MAX_SAFE_INTEGER,this.socket.binaryType),a=o.readable.pipeThrough(s).getReader(),_=createPacketEncoderStream();_.readable.pipeTo(o.writable),this.writer=_.writable.getWriter();const $=()=>{a.read().then(({done:_n,value:_r})=>{_n||(this.onPacket(_r),$())}).catch(_n=>{})};$();const _e={type:"open"};this.query.sid&&(_e.data=`{"sid":"${this.query.sid}"}`),this.writer.write(_e).then(()=>this.onOpen())})}))}write(o){this.writable=!1;for(let s=0;s<o.length;s++){const a=o[s],_=s===o.length-1;this.writer.write(a).then(()=>{_&&nextTick(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var o;(o=this.transport)===null||o===void 0||o.close()}}const transports={websocket:WS$1,webtransport:WT,polling:Polling},re=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse(e){if(e.length>2e3)throw"URI too long";const o=e,s=e.indexOf("["),a=e.indexOf("]");s!=-1&&a!=-1&&(e=e.substring(0,s)+e.substring(s,a).replace(/:/g,";")+e.substring(a,e.length));let _=re.exec(e||""),$={},_e=14;for(;_e--;)$[parts[_e]]=_[_e]||"";return s!=-1&&a!=-1&&($.source=o,$.host=$.host.substring(1,$.host.length-1).replace(/;/g,":"),$.authority=$.authority.replace("[","").replace("]","").replace(/;/g,":"),$.ipv6uri=!0),$.pathNames=pathNames($,$.path),$.queryKey=queryKey($,$.query),$}function pathNames(e,o){const s=/\/{2,9}/g,a=o.replace(s,"/").split("/");return(o.slice(0,1)=="/"||o.length===0)&&a.splice(0,1),o.slice(-1)=="/"&&a.splice(a.length-1,1),a}function queryKey(e,o){const s={};return o.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,_,$){_&&(s[_]=$)}),s}let Socket$1=class vP extends Emitter{constructor(o,s={}){super(),this.binaryType=defaultBinaryType,this.writeBuffer=[],o&&typeof o=="object"&&(s=o,o=null),o?(o=parse(o),s.hostname=o.host,s.secure=o.protocol==="https"||o.protocol==="wss",s.port=o.port,o.query&&(s.query=o.query)):s.host&&(s.hostname=parse(s.host).host),installTimerFunctions(this,s),this.secure=s.secure!=null?s.secure:typeof location<"u"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=s.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=s.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(o){const s=Object.assign({},this.opts.query);s.EIO=protocol$1,s.transport=o,this.id&&(s.sid=this.id);const a=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[o]);return new transports[o](a)}open(){let o;if(this.opts.rememberUpgrade&&vP.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)o="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else o=this.transports[0];this.readyState="opening";try{o=this.createTransport(o)}catch{this.transports.shift(),this.open();return}o.open(),this.setTransport(o)}setTransport(o){this.transport&&this.transport.removeAllListeners(),this.transport=o,o.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",s=>this.onClose("transport close",s))}probe(o){let s=this.createTransport(o),a=!1;vP.priorWebsocketSuccess=!1;const _=()=>{a||(s.send([{type:"ping",data:"probe"}]),s.once("packet",ba=>{if(!a)if(ba.type==="pong"&&ba.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;vP.priorWebsocketSuccess=s.name==="websocket",this.transport.pause(()=>{a||this.readyState!=="closed"&&(na(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const _p=new Error("probe error");_p.transport=s.name,this.emitReserved("upgradeError",_p)}}))};function $(){a||(a=!0,na(),s.close(),s=null)}const _e=ba=>{const _p=new Error("probe error: "+ba);_p.transport=s.name,$(),this.emitReserved("upgradeError",_p)};function _n(){_e("transport closed")}function _r(){_e("socket closed")}function _s(ba){s&&ba.name!==s.name&&$()}const na=()=>{s.removeListener("open",_),s.removeListener("error",_e),s.removeListener("close",_n),this.off("close",_r),this.off("upgrading",_s)};s.once("open",_),s.once("error",_e),s.once("close",_n),this.once("close",_r),this.once("upgrading",_s),this.upgrades.indexOf("webtransport")!==-1&&o!=="webtransport"?this.setTimeoutFn(()=>{a||s.open()},200):s.open()}onOpen(){if(this.readyState="open",vP.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let o=0;const s=this.upgrades.length;for(;o<s;o++)this.probe(this.upgrades[o])}}onPacket(o){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",o),this.emitReserved("heartbeat"),this.resetPingTimeout(),o.type){case"open":this.onHandshake(JSON.parse(o.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const s=new Error("server error");s.code=o.data,this.onError(s);break;case"message":this.emitReserved("data",o.data),this.emitReserved("message",o.data);break}}onHandshake(o){this.emitReserved("handshake",o),this.id=o.sid,this.transport.query.sid=o.sid,this.upgrades=this.filterUpgrades(o.upgrades),this.pingInterval=o.pingInterval,this.pingTimeout=o.pingTimeout,this.maxPayload=o.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const o=this.getWritablePackets();this.transport.send(o),this.prevBufferLen=o.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let s=1;for(let a=0;a<this.writeBuffer.length;a++){const _=this.writeBuffer[a].data;if(_&&(s+=byteLength(_)),a>0&&s>this.maxPayload)return this.writeBuffer.slice(0,a);s+=2}return this.writeBuffer}write(o,s,a){return this.sendPacket("message",o,s,a),this}send(o,s,a){return this.sendPacket("message",o,s,a),this}sendPacket(o,s,a,_){if(typeof s=="function"&&(_=s,s=void 0),typeof a=="function"&&(_=a,a=null),this.readyState==="closing"||this.readyState==="closed")return;a=a||{},a.compress=a.compress!==!1;const $={type:o,data:s,options:a};this.emitReserved("packetCreate",$),this.writeBuffer.push($),_&&this.once("flush",_),this.flush()}close(){const o=()=>{this.onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),o()},a=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?a():o()}):this.upgrading?a():o()),this}onError(o){vP.priorWebsocketSuccess=!1,this.emitReserved("error",o),this.onClose("transport error",o)}onClose(o,s){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",o,s),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(o){const s=[];let a=0;const _=o.length;for(;a<_;a++)~this.transports.indexOf(o[a])&&s.push(o[a]);return s}};Socket$1.protocol=protocol$1;function url(e,o="",s){let a=e;s=s||typeof location<"u"&&location,e==null&&(e=s.protocol+"//"+s.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=s.protocol+e:e=s.host+e),/^(https?|wss?):\/\//.test(e)||(typeof s<"u"?e=s.protocol+"//"+e:e="https://"+e),a=parse(e)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";const $=a.host.indexOf(":")!==-1?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+$+":"+a.port+o,a.href=a.protocol+"://"+$+(s&&s.port===a.port?"":":"+a.port),a}const withNativeArrayBuffer=typeof ArrayBuffer=="function",isView=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,toString=Object.prototype.toString,withNativeBlob=typeof Blob=="function"||typeof Blob<"u"&&toString.call(Blob)==="[object BlobConstructor]",withNativeFile=typeof File=="function"||typeof File<"u"&&toString.call(File)==="[object FileConstructor]";function isBinary(e){return withNativeArrayBuffer&&(e instanceof ArrayBuffer||isView(e))||withNativeBlob&&e instanceof Blob||withNativeFile&&e instanceof File}function hasBinary(e,o){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let s=0,a=e.length;s<a;s++)if(hasBinary(e[s]))return!0;return!1}if(isBinary(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return hasBinary(e.toJSON(),!0);for(const s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&hasBinary(e[s]))return!0;return!1}function deconstructPacket(e){const o=[],s=e.data,a=e;return a.data=_deconstructPacket(s,o),a.attachments=o.length,{packet:a,buffers:o}}function _deconstructPacket(e,o){if(!e)return e;if(isBinary(e)){const s={_placeholder:!0,num:o.length};return o.push(e),s}else if(Array.isArray(e)){const s=new Array(e.length);for(let a=0;a<e.length;a++)s[a]=_deconstructPacket(e[a],o);return s}else if(typeof e=="object"&&!(e instanceof Date)){const s={};for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(s[a]=_deconstructPacket(e[a],o));return s}return e}function reconstructPacket(e,o){return e.data=_reconstructPacket(e.data,o),delete e.attachments,e}function _reconstructPacket(e,o){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<o.length)return o[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let s=0;s<e.length;s++)e[s]=_reconstructPacket(e[s],o);else if(typeof e=="object")for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(e[s]=_reconstructPacket(e[s],o));return e}const RESERVED_EVENTS$1=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],protocol=5;var PacketType;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(PacketType||(PacketType={}));class Encoder{constructor(o){this.replacer=o}encode(o){return(o.type===PacketType.EVENT||o.type===PacketType.ACK)&&hasBinary(o)?this.encodeAsBinary({type:o.type===PacketType.EVENT?PacketType.BINARY_EVENT:PacketType.BINARY_ACK,nsp:o.nsp,data:o.data,id:o.id}):[this.encodeAsString(o)]}encodeAsString(o){let s=""+o.type;return(o.type===PacketType.BINARY_EVENT||o.type===PacketType.BINARY_ACK)&&(s+=o.attachments+"-"),o.nsp&&o.nsp!=="/"&&(s+=o.nsp+","),o.id!=null&&(s+=o.id),o.data!=null&&(s+=JSON.stringify(o.data,this.replacer)),s}encodeAsBinary(o){const s=deconstructPacket(o),a=this.encodeAsString(s.packet),_=s.buffers;return _.unshift(a),_}}function isObject(e){return Object.prototype.toString.call(e)==="[object Object]"}class Decoder extends Emitter{constructor(o){super(),this.reviver=o}add(o){let s;if(typeof o=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(o);const a=s.type===PacketType.BINARY_EVENT;a||s.type===PacketType.BINARY_ACK?(s.type=a?PacketType.EVENT:PacketType.ACK,this.reconstructor=new BinaryReconstructor(s),s.attachments===0&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else if(isBinary(o)||o.base64)if(this.reconstructor)s=this.reconstructor.takeBinaryData(o),s&&(this.reconstructor=null,super.emitReserved("decoded",s));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+o)}decodeString(o){let s=0;const a={type:Number(o.charAt(0))};if(PacketType[a.type]===void 0)throw new Error("unknown packet type "+a.type);if(a.type===PacketType.BINARY_EVENT||a.type===PacketType.BINARY_ACK){const $=s+1;for(;o.charAt(++s)!=="-"&&s!=o.length;);const _e=o.substring($,s);if(_e!=Number(_e)||o.charAt(s)!=="-")throw new Error("Illegal attachments");a.attachments=Number(_e)}if(o.charAt(s+1)==="/"){const $=s+1;for(;++s&&!(o.charAt(s)===","||s===o.length););a.nsp=o.substring($,s)}else a.nsp="/";const _=o.charAt(s+1);if(_!==""&&Number(_)==_){const $=s+1;for(;++s;){const _e=o.charAt(s);if(_e==null||Number(_e)!=_e){--s;break}if(s===o.length)break}a.id=Number(o.substring($,s+1))}if(o.charAt(++s)){const $=this.tryParse(o.substr(s));if(Decoder.isPayloadValid(a.type,$))a.data=$;else throw new Error("invalid payload")}return a}tryParse(o){try{return JSON.parse(o,this.reviver)}catch{return!1}}static isPayloadValid(o,s){switch(o){case PacketType.CONNECT:return isObject(s);case PacketType.DISCONNECT:return s===void 0;case PacketType.CONNECT_ERROR:return typeof s=="string"||isObject(s);case PacketType.EVENT:case PacketType.BINARY_EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&RESERVED_EVENTS$1.indexOf(s[0])===-1);case PacketType.ACK:case PacketType.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class BinaryReconstructor{constructor(o){this.packet=o,this.buffers=[],this.reconPack=o}takeBinaryData(o){if(this.buffers.push(o),this.buffers.length===this.reconPack.attachments){const s=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),s}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const parser=Object.freeze(Object.defineProperty({__proto__:null,Decoder,Encoder,get PacketType(){return PacketType},protocol},Symbol.toStringTag,{value:"Module"}));function on(e,o,s){return e.on(o,s),function(){e.off(o,s)}}const RESERVED_EVENTS=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Socket extends Emitter{constructor(o,s,a){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=o,this.nsp=s,a&&a.auth&&(this.auth=a.auth),this._opts=Object.assign({},a),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const o=this.io;this.subs=[on(o,"open",this.onopen.bind(this)),on(o,"packet",this.onpacket.bind(this)),on(o,"error",this.onerror.bind(this)),on(o,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...o){return o.unshift("message"),this.emit.apply(this,o),this}emit(o,...s){if(RESERVED_EVENTS.hasOwnProperty(o))throw new Error('"'+o.toString()+'" is a reserved event name');if(s.unshift(o),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const a={type:PacketType.EVENT,data:s};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"){const _e=this.ids++,_n=s.pop();this._registerAckCallback(_e,_n),a.id=_e}const _=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!_||!this.connected)||(this.connected?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(o,s){var a;const _=(a=this.flags.timeout)!==null&&a!==void 0?a:this._opts.ackTimeout;if(_===void 0){this.acks[o]=s;return}const $=this.io.setTimeoutFn(()=>{delete this.acks[o];for(let _e=0;_e<this.sendBuffer.length;_e++)this.sendBuffer[_e].id===o&&this.sendBuffer.splice(_e,1);s.call(this,new Error("operation has timed out"))},_);this.acks[o]=(..._e)=>{this.io.clearTimeoutFn($),s.apply(this,[null,..._e])}}emitWithAck(o,...s){const a=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((_,$)=>{s.push((_e,_n)=>a?_e?$(_e):_(_n):_(_e)),this.emit(o,...s)})}_addToQueue(o){let s;typeof o[o.length-1]=="function"&&(s=o.pop());const a={id:this._queueSeq++,tryCount:0,pending:!1,args:o,flags:Object.assign({fromQueue:!0},this.flags)};o.push((_,...$)=>a!==this._queue[0]?void 0:(_!==null?a.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(_)):(this._queue.shift(),s&&s(null,...$)),a.pending=!1,this._drainQueue())),this._queue.push(a),this._drainQueue()}_drainQueue(o=!1){if(!this.connected||this._queue.length===0)return;const s=this._queue[0];s.pending&&!o||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(o){o.nsp=this.nsp,this.io._packet(o)}onopen(){typeof this.auth=="function"?this.auth(o=>{this._sendConnectPacket(o)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(o){this.packet({type:PacketType.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},o):o})}onerror(o){this.connected||this.emitReserved("connect_error",o)}onclose(o,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",o,s)}onpacket(o){if(o.nsp===this.nsp)switch(o.type){case PacketType.CONNECT:o.data&&o.data.sid?this.onconnect(o.data.sid,o.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case PacketType.EVENT:case PacketType.BINARY_EVENT:this.onevent(o);break;case PacketType.ACK:case PacketType.BINARY_ACK:this.onack(o);break;case PacketType.DISCONNECT:this.ondisconnect();break;case PacketType.CONNECT_ERROR:this.destroy();const a=new Error(o.data.message);a.data=o.data.data,this.emitReserved("connect_error",a);break}}onevent(o){const s=o.data||[];o.id!=null&&s.push(this.ack(o.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(o){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const a of s)a.apply(this,o)}super.emit.apply(this,o),this._pid&&o.length&&typeof o[o.length-1]=="string"&&(this._lastOffset=o[o.length-1])}ack(o){const s=this;let a=!1;return function(..._){a||(a=!0,s.packet({type:PacketType.ACK,id:o,data:_}))}}onack(o){const s=this.acks[o.id];typeof s=="function"&&(s.apply(this,o.data),delete this.acks[o.id])}onconnect(o,s){this.id=o,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(o=>this.emitEvent(o)),this.receiveBuffer=[],this.sendBuffer.forEach(o=>{this.notifyOutgoingListeners(o),this.packet(o)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(o=>o()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:PacketType.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(o){return this.flags.compress=o,this}get volatile(){return this.flags.volatile=!0,this}timeout(o){return this.flags.timeout=o,this}onAny(o){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(o),this}prependAny(o){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(o),this}offAny(o){if(!this._anyListeners)return this;if(o){const s=this._anyListeners;for(let a=0;a<s.length;a++)if(o===s[a])return s.splice(a,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(o){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(o),this}prependAnyOutgoing(o){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(o),this}offAnyOutgoing(o){if(!this._anyOutgoingListeners)return this;if(o){const s=this._anyOutgoingListeners;for(let a=0;a<s.length;a++)if(o===s[a])return s.splice(a,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(o){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const a of s)a.apply(this,o.data)}}}function Backoff(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var o=Math.random(),s=Math.floor(o*this.jitter*e);e=Math.floor(o*10)&1?e+s:e-s}return Math.min(e,this.max)|0};Backoff.prototype.reset=function(){this.attempts=0};Backoff.prototype.setMin=function(e){this.ms=e};Backoff.prototype.setMax=function(e){this.max=e};Backoff.prototype.setJitter=function(e){this.jitter=e};class Manager extends Emitter{constructor(o,s){var a;super(),this.nsps={},this.subs=[],o&&typeof o=="object"&&(s=o,o=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,installTimerFunctions(this,s),this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor((a=s.randomizationFactor)!==null&&a!==void 0?a:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=o;const _=s.parser||parser;this.encoder=new _.Encoder,this.decoder=new _.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(o){return arguments.length?(this._reconnection=!!o,this):this._reconnection}reconnectionAttempts(o){return o===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=o,this)}reconnectionDelay(o){var s;return o===void 0?this._reconnectionDelay:(this._reconnectionDelay=o,(s=this.backoff)===null||s===void 0||s.setMin(o),this)}randomizationFactor(o){var s;return o===void 0?this._randomizationFactor:(this._randomizationFactor=o,(s=this.backoff)===null||s===void 0||s.setJitter(o),this)}reconnectionDelayMax(o){var s;return o===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=o,(s=this.backoff)===null||s===void 0||s.setMax(o),this)}timeout(o){return arguments.length?(this._timeout=o,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(o){if(~this._readyState.indexOf("open"))return this;this.engine=new Socket$1(this.uri,this.opts);const s=this.engine,a=this;this._readyState="opening",this.skipReconnect=!1;const _=on(s,"open",function(){a.onopen(),o&&o()}),$=_n=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",_n),o?o(_n):this.maybeReconnectOnOpen()},_e=on(s,"error",$);if(this._timeout!==!1){const _n=this._timeout,_r=this.setTimeoutFn(()=>{_(),$(new Error("timeout")),s.close()},_n);this.opts.autoUnref&&_r.unref(),this.subs.push(()=>{this.clearTimeoutFn(_r)})}return this.subs.push(_),this.subs.push(_e),this}connect(o){return this.open(o)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const o=this.engine;this.subs.push(on(o,"ping",this.onping.bind(this)),on(o,"data",this.ondata.bind(this)),on(o,"error",this.onerror.bind(this)),on(o,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(o){try{this.decoder.add(o)}catch(s){this.onclose("parse error",s)}}ondecoded(o){nextTick(()=>{this.emitReserved("packet",o)},this.setTimeoutFn)}onerror(o){this.emitReserved("error",o)}socket(o,s){let a=this.nsps[o];return a?this._autoConnect&&!a.active&&a.connect():(a=new Socket(this,o,s),this.nsps[o]=a),a}_destroy(o){const s=Object.keys(this.nsps);for(const a of s)if(this.nsps[a].active)return;this._close()}_packet(o){const s=this.encoder.encode(o);for(let a=0;a<s.length;a++)this.engine.write(s[a],o.options)}cleanup(){this.subs.forEach(o=>o()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(o,s){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",o,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const o=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const a=this.setTimeoutFn(()=>{o.skipReconnect||(this.emitReserved("reconnect_attempt",o.backoff.attempts),!o.skipReconnect&&o.open(_=>{_?(o._reconnecting=!1,o.reconnect(),this.emitReserved("reconnect_error",_)):o.onreconnect()}))},s);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}}onreconnect(){const o=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",o)}}const cache={};function lookup(e,o){typeof e=="object"&&(o=e,e=void 0),o=o||{};const s=url(e,o.path||"/socket.io"),a=s.source,_=s.id,$=s.path,_e=cache[_]&&$ in cache[_].nsps,_n=o.forceNew||o["force new connection"]||o.multiplex===!1||_e;let _r;return _n?_r=new Manager(a,o):(cache[_]||(cache[_]=new Manager(a,o)),_r=cache[_]),s.query&&!o.query&&(o.query=s.queryKey),_r.socket(s.path,o)}Object.assign(lookup,{Manager,Socket,io:lookup,connect:lookup});var AgoraRTC_NProduction={exports:{}};(function(e,o){(function(s,a){e.exports=a()})(commonjsGlobal,function(){function s(d,h){return h.forEach(function(g){g&&typeof g!="string"&&!Array.isArray(g)&&Object.keys(g).forEach(function(j){if(j!=="default"&&!(j in d)){var _t=Object.getOwnPropertyDescriptor(g,j);Object.defineProperty(d,j,_t.get?_t:{enumerable:!0,get:function(){return g[j]}})}})}),Object.freeze(d)}var a=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{},_=function(d){try{return!!d()}catch{return!0}},$=!_(function(){var d=(function(){}).bind();return typeof d!="function"||d.hasOwnProperty("prototype")}),_e=$,_n=Function.prototype,_r=_n.bind,_s=_n.call,na=_e&&_r.bind(_s,_s),ba=_e?function(d){return d&&na(d)}:function(d){return d&&function(){return _s.apply(d,arguments)}},_p=ba({}.isPrototypeOf),_f=function(d){return d&&d.Math==Math&&d},_E=_f(typeof globalThis=="object"&&globalThis)||_f(typeof window=="object"&&window)||_f(typeof self=="object"&&self)||_f(typeof a=="object"&&a)||function(){return this}()||Function("return this")(),_v=$,n_=Function.prototype,e_=n_.apply,t_=n_.call,o_=typeof Reflect=="object"&&Reflect.apply||(_v?t_.bind(e_):function(){return t_.apply(e_,arguments)}),m_=function(d){return typeof d=="function"},b_={},w_=!_(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),y_=$,N_=Function.prototype.call,_y=y_?N_.bind(N_):function(){return N_.apply(N_,arguments)},v_={},A_={}.propertyIsEnumerable,k_=Object.getOwnPropertyDescriptor,P_=k_&&!A_.call({1:2},1);v_.f=P_?function(d){var h=k_(this,d);return!!h&&h.enumerable}:A_;var T_,R_,I_=function(d,h){return{enumerable:!(1&d),configurable:!(2&d),writable:!(4&d),value:h}},U_=ba,D_=U_({}.toString),n0=U_("".slice),a_=function(d){return n0(D_(d),8,-1)},s_=ba,S_=_,V_=a_,W_=_E.Object,Y_=s_("".split),e0=S_(function(){return!W_("z").propertyIsEnumerable(0)})?function(d){return V_(d)=="String"?Y_(d,""):W_(d)}:W_,F_=_E.TypeError,H_=function(d){if(d==null)throw F_("Can't call method on "+d);return d},E0=e0,d0=H_,m0=function(d){return E0(d0(d))},v0=m_,u0=function(d){return typeof d=="object"?d!==null:v0(d)},s0={},T0=s0,j0=_E,J_=m_,g0=function(d){return J_(d)?d:void 0},A0=function(d,h){return arguments.length<2?g0(T0[d])||g0(j0[d]):T0[d]&&T0[d][h]||j0[d]&&j0[d][h]},j_=A0("navigator","userAgent")||"",o0=_E,w0=j_,k0=o0.process,H0=o0.Deno,U0=k0&&k0.versions||H0&&H0.version,NS=U0&&U0.v8;NS&&(R_=(T_=NS.split("."))[0]>0&&T_[0]<4?1:+(T_[0]+T_[1])),!R_&&w0&&(!(T_=w0.match(/Edge\/(\d+)/))||T_[1]>=74)&&(T_=w0.match(/Chrome\/(\d+)/))&&(R_=+T_[1]);var yS=R_,SR=yS,BS=_,mR=!!Object.getOwnPropertySymbols&&!BS(function(){var d=Symbol();return!String(d)||!(Object(d)instanceof Symbol)||!Symbol.sham&&SR&&SR<41}),XR=mR&&!Symbol.sham&&typeof Symbol.iterator=="symbol",dR=A0,dT=m_,pT=_p,iT=XR,kR=_E.Object,bT=iT?function(d){return typeof d=="symbol"}:function(d){var h=dR("Symbol");return dT(h)&&pT(h.prototype,kR(d))},rO=_E.String,nI=function(d){try{return rO(d)}catch{return"Object"}},iO=m_,UI=nI,bI=_E.TypeError,QR=function(d){if(iO(d))return d;throw bI(UI(d)+" is not a function")},HO=QR,SI=function(d,h){var g=d[h];return g==null?void 0:HO(g)},gR=_y,kT=m_,VT=u0,wN=_E.TypeError,RI={exports:{}},tR=_E,ST=Object.defineProperty,AR=function(d,h){try{ST(tR,d,{value:h,configurable:!0,writable:!0})}catch{tR[d]=h}return h},RR="__core-js_shared__",vS=_E[RR]||AR(RR,{}),TR=vS;(RI.exports=function(d,h){return TR[d]||(TR[d]=h!==void 0?h:{})})("versions",[]).push({version:"3.20.3",mode:"pure",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var rI=H_,PT=_E.Object,hT=function(d){return PT(rI(d))},qO=hT,iI=ba({}.hasOwnProperty),IS=Object.hasOwn||function(d,h){return iI(qO(d),h)},oT=ba,fT=0,ZR=Math.random(),zO=oT(1 .toString),TI=function(d){return"Symbol("+(d===void 0?"":d)+")_"+zO(++fT+ZR,36)},tS=_E,NR=RI.exports,_P=IS,yP=TI,bO=mR,bP=XR,SO=NR("wks"),FI=tS.Symbol,SP=FI&&FI.for,jL=bP?FI:FI&&FI.withoutSetter||yP,wR=function(d){if(!_P(SO,d)||!bO&&typeof SO[d]!="string"){var h="Symbol."+d;bO&&_P(FI,d)?SO[d]=FI[d]:SO[d]=bP&&SP?SP(h):jL(h)}return SO[d]},UL=_y,RP=u0,TP=bT,FL=SI,BL=function(d,h){var g,j;if(h==="string"&&kT(g=d.toString)&&!VT(j=gR(g,d))||kT(g=d.valueOf)&&!VT(j=gR(g,d))||h!=="string"&&kT(g=d.toString)&&!VT(j=gR(g,d)))return j;throw wN("Can't convert object to primitive value")},VL=wR,GL=_E.TypeError,wI=VL("toPrimitive"),xT=function(d,h){if(!RP(d)||TP(d))return d;var g,j=FL(d,wI);if(j){if(h===void 0&&(h="default"),g=UL(j,d,h),!RP(g)||TP(g))return g;throw GL("Can't convert object to primitive value")}return h===void 0&&(h="number"),BL(d,h)},RO=bT,mT=function(d){var h=xT(d,"string");return RO(h)?h:h+""},h1=u0,CN=_E.document,CI=h1(CN)&&h1(CN.createElement),BI=function(d){return CI?CN.createElement(d):{}},f1=BI,TO=!w_&&!_(function(){return Object.defineProperty(f1("div"),"a",{get:function(){return 7}}).a!=7}),wP=w_,$L=_y,KO=v_,CP=I_,WL=m0,VI=mT,PF=IS,oO=TO,IN=Object.getOwnPropertyDescriptor;b_.f=wP?IN:function(d,h){if(d=WL(d),h=VI(h),oO)try{return IN(d,h)}catch{}if(PF(d,h))return CP(!$L(KO.f,d,h),d[h])};var HL=_,ON=m_,IP=/#|\.prototype\./,GI=function(d,h){var g=zL[qL(d)];return g==YO||g!=KL&&(ON(h)?HL(h):!!h)},qL=GI.normalize=function(d){return String(d).replace(IP,".").toLowerCase()},zL=GI.data={},KL=GI.NATIVE="N",YO=GI.POLYFILL="P",YL=GI,JL=QR,OP=$,m1=ba(ba.bind),wO=function(d,h){return JL(d),h===void 0?d:OP?m1(d,h):function(){return d.apply(h,arguments)}},oI={},AN=w_&&_(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),XL=_E,QL=u0,AP=XL.String,NP=XL.TypeError,DT=function(d){if(QL(d))return d;throw NP(AP(d)+" is not an object")},ZL=w_,NN=TO,kP=AN,kN=DT,PP=mT,JO=_E.TypeError,xP=Object.defineProperty,eM=Object.getOwnPropertyDescriptor,tM="enumerable",nM="configurable",rM="writable";oI.f=ZL?kP?function(d,h,g){if(kN(d),h=PP(h),kN(g),typeof d=="function"&&h==="prototype"&&"value"in g&&rM in g&&!g.writable){var j=eM(d,h);j&&j.writable&&(d[h]=g.value,g={configurable:nM in g?g.configurable:j.configurable,enumerable:tM in g?g.enumerable:j.enumerable,writable:!1})}return xP(d,h,g)}:xP:function(d,h,g){if(kN(d),h=PP(h),kN(g),NN)try{return xP(d,h,g)}catch{}if("get"in g||"set"in g)throw JO("Accessors not supported");return"value"in g&&(d[h]=g.value),d};var iM=oI,DP=I_,sO=w_?function(d,h,g){return iM.f(d,h,DP(1,g))}:function(d,h,g){return d[h]=g,d},g1=_E,xF=o_,oM=ba,sM=m_,E1=b_.f,DF=YL,XO=s0,LP=wO,CO=sO,MP=IS,IO=function(d){var h=function(g,j,_t){if(this instanceof h){switch(arguments.length){case 0:return new d;case 1:return new d(g);case 2:return new d(g,j)}return new d(g,j,_t)}return xF(d,this,arguments)};return h.prototype=d.prototype,h},PR=function(d,h){var g,j,_t,_i,_o,ga,_a,_u,_c=d.target,_l=d.global,_g=d.stat,r_=d.proto,l_=_l?g1:_g?g1[_c]:(g1[_c]||{}).prototype,d_=_l?XO:XO[_c]||CO(XO,_c,{})[_c],p_=d_.prototype;for(_t in h)g=!DF(_l?_t:_c+(_g?".":"#")+_t,d.forced)&&l_&&MP(l_,_t),_o=d_[_t],g&&(ga=d.noTargetGet?(_u=E1(l_,_t))&&_u.value:l_[_t]),_i=g&&ga?ga:h[_t],g&&typeof _o==typeof _i||(_a=d.bind&&g?LP(_i,g1):d.wrap&&g?IO(_i):r_&&sM(_i)?oM(_i):_i,(d.sham||_i&&_i.sham||_o&&_o.sham)&&CO(_a,"sham",!0),CO(d_,_t,_a),r_&&(MP(XO,j=_c+"Prototype")||CO(XO,j,{}),CO(XO[j],_t,_i),d.real&&p_&&!p_[_t]&&CO(p_,_t,_i)))},LF=Math.ceil,aM=Math.floor,jP=function(d){var h=+d;return h!=h||h===0?0:(h>0?aM:LF)(h)},MF=jP,UF=Math.min,FF=function(d){return d>0?UF(MF(d),9007199254740991):0},$I=function(d){return FF(d.length)},cM=QR,BF=hT,QO=e0,OO=$I,VF=_E.TypeError,PN=function(d){return function(h,g,j,_t){cM(g);var _i=BF(h),_o=QO(_i),ga=OO(_i),_a=d?ga-1:0,_u=d?-1:1;if(j<2)for(;;){if(_a in _o){_t=_o[_a],_a+=_u;break}if(_a+=_u,d?_a<0:ga<=_a)throw VF("Reduce of empty array with no initial value")}for(;d?_a>=0:ga>_a;_a+=_u)_a in _o&&(_t=g(_t,_o[_a],_a,_i));return _t}},GF={left:PN(!1),right:PN(!0)},$F=_,UP=function(d,h){var g=[][d];return!!g&&$F(function(){g.call(null,h||function(){throw 1},1)})},v1=a_(_E.process)=="process",WF=GF.left,uM=yS,HF=v1;PR({target:"Array",proto:!0,forced:!UP("reduce")||!HF&&uM>79&&uM<83},{reduce:function(d){var h=arguments.length;return WF(this,d,h,h>1?arguments[1]:void 0)}});var zF=s0,UR=function(d){return zF[d+"Prototype"]},lM=UR("Array").reduce,dM=_p,pM=lM,FP=Array.prototype,hM=function(d){var h=d.reduce;return d===FP||dM(FP,d)&&h===FP.reduce?pM:h},WI=hM;let xN=!0,fM=!0;function _1(d,h,g){const j=d.match(h);return j&&j.length>=g&&parseInt(j[g],10)}function aO(d,h,g){if(!d.RTCPeerConnection)return;const j=d.RTCPeerConnection.prototype,_t=j.addEventListener;j.addEventListener=function(_o,ga){if(_o!==h)return _t.apply(this,arguments);const _a=_u=>{const _c=g(_u);_c&&(ga.handleEvent?ga.handleEvent(_c):ga(_c))};return this._eventMap=this._eventMap||{},this._eventMap[h]||(this._eventMap[h]=new Map),this._eventMap[h].set(ga,_a),_t.apply(this,[_o,_a])};const _i=j.removeEventListener;j.removeEventListener=function(_o,ga){if(_o!==h||!this._eventMap||!this._eventMap[h])return _i.apply(this,arguments);if(!this._eventMap[h].has(ga))return _i.apply(this,arguments);const _a=this._eventMap[h].get(ga);return this._eventMap[h].delete(ga),this._eventMap[h].size===0&&delete this._eventMap[h],Object.keys(this._eventMap).length===0&&delete this._eventMap,_i.apply(this,[_o,_a])},Object.defineProperty(j,"on"+h,{get(){return this["_on"+h]},set(_o){this["_on"+h]&&(this.removeEventListener(h,this["_on"+h]),delete this["_on"+h]),_o&&this.addEventListener(h,this["_on"+h]=_o)},enumerable:!0,configurable:!0})}function KF(d){return typeof d!="boolean"?new Error("Argument type: "+typeof d+". Please use a boolean."):(xN=d,d?"adapter.js logging disabled":"adapter.js logging enabled")}function YF(d){return typeof d!="boolean"?new Error("Argument type: "+typeof d+". Please use a boolean."):(fM=!d,"adapter.js deprecation warnings "+(d?"disabled":"enabled"))}function BP(){if(typeof window=="object"){if(xN)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function y1(d,h){fM&&console.warn(d+" is deprecated, please use "+h+" instead.")}function mM(d){const h={browser:null,version:null};if(d===void 0||!d.navigator)return h.browser="Not a browser.",h;const{navigator:g}=d;if(g.mozGetUserMedia)h.browser="firefox",h.version=_1(g.userAgent,/Firefox\/(\d+)\./,1);else if(g.webkitGetUserMedia||d.isSecureContext===!1&&d.webkitRTCPeerConnection)h.browser="chrome",h.version=_1(g.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!d.RTCPeerConnection||!g.userAgent.match(/AppleWebKit\/(\d+)\./))return h.browser="Not a supported browser.",h;h.browser="safari",h.version=_1(g.userAgent,/AppleWebKit\/(\d+)\./,1),h.supportsUnifiedPlan=d.RTCRtpTransceiver&&"currentDirection"in d.RTCRtpTransceiver.prototype}return h}function DN(d){return Object.prototype.toString.call(d)==="[object Object]"}function VP(d){var h;return DN(d)?WI(h=Object.keys(d)).call(h,function(g,j){const _t=DN(d[j]),_i=_t?VP(d[j]):d[j],_o=_t&&!Object.keys(_i).length;return _i===void 0||_o?g:Object.assign(g,{[j]:_i})},{}):d}function b1(d,h,g){const j=g?"outbound-rtp":"inbound-rtp",_t=new Map;if(h===null)return _t;const _i=[];return d.forEach(_o=>{_o.type==="track"&&_o.trackIdentifier===h.id&&_i.push(_o)}),_i.forEach(_o=>{d.forEach(ga=>{ga.type===j&&ga.trackId===_o.id&&function _a(_u,_c,_l){_c&&!_l.has(_c.id)&&(_l.set(_c.id,_c),Object.keys(_c).forEach(_g=>{_g.endsWith("Id")?_a(_u,_u.get(_c[_g]),_l):_g.endsWith("Ids")&&_c[_g].forEach(r_=>{_a(_u,_u.get(r_),_l)})}))}(d,ga,_t)})}),_t}var GT=RI.exports,JF=TI,gM=GT("keys"),LN=function(d){return gM[d]||(gM[d]=JF(d))},EM=!_(function(){function d(){}return d.prototype.constructor=null,Object.getPrototypeOf(new d)!==d.prototype}),XF=_E,QF=IS,ZF=m_,_B=hT,eV=EM,vM=LN("IE_PROTO"),S1=XF.Object,_M=S1.prototype,MN=eV?S1.getPrototypeOf:function(d){var h=_B(d);if(QF(h,vM))return h[vM];var g=h.constructor;return ZF(g)&&h instanceof g?g.prototype:h instanceof S1?_M:null},yM=_E,tV=m_,AO=yM.String,HI=yM.TypeError,bM=ba,nV=DT,SM=function(d){if(typeof d=="object"||tV(d))return d;throw HI("Can't set "+AO(d)+" as a prototype")},RM=Object.setPrototypeOf||("__proto__"in{}?function(){var d,h=!1,g={};try{(d=bM(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(g,[]),h=g instanceof Array}catch{}return function(j,_t){return nV(j),SM(_t),h?d(j,_t):j.__proto__=_t,j}}():void 0),jN={},TM=jP,rV=Math.max,iV=Math.min,GP=function(d,h){var g=TM(d);return g<0?rV(g+h,0):iV(g,h)},wM=m0,CM=GP,oV=$I,IM=function(d){return function(h,g,j){var _t,_i=wM(h),_o=oV(_i),ga=CM(j,_o);if(d&&g!=g){for(;_o>ga;)if((_t=_i[ga++])!=_t)return!0}else for(;_o>ga;ga++)if((d||ga in _i)&&_i[ga]===g)return d||ga||0;return!d&&-1}},sV={includes:IM(!0),indexOf:IM(!1)},R1={},$P=IS,qI=m0,OM=sV.indexOf,aV=R1,AM=ba([].push),NM=function(d,h){var g,j=qI(d),_t=0,_i=[];for(g in j)!$P(aV,g)&&$P(j,g)&&AM(_i,g);for(;h.length>_t;)$P(j,g=h[_t++])&&(~OM(_i,g)||AM(_i,g));return _i},WP=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],cV=NM,uV=WP.concat("length","prototype");jN.f=Object.getOwnPropertyNames||function(d){return cV(d,uV)};var HP={};HP.f=Object.getOwnPropertySymbols;var lV=A0,qP=jN,T1=HP,kM=DT,PM=ba([].concat),UN=lV("Reflect","ownKeys")||function(d){var h=qP.f(kM(d)),g=T1.f;return g?PM(h,g(d)):h},w1=IS,dV=UN,pV=b_,hV=oI,zI={},fV=NM,mV=WP,ZO=Object.keys||function(d){return fV(d,mV)},zP=w_,gV=AN,xM=oI,EV=DT,_A=m0,KP=ZO;zI.f=zP&&!gV?Object.defineProperties:function(d,h){EV(d);for(var g,j=_A(h),_t=KP(h),_i=_t.length,_o=0;_i>_o;)xM.f(d,g=_t[_o++],j[g]);return d};var FN,DM=A0("document","documentElement"),vV=DT,_V=zI,eN=WP,NO=R1,yV=DM,bV=BI,LM=LN("IE_PROTO"),YP=function(){},MM=function(d){return"<script>"+d+"<\/script>"},jM=function(d){d.write(MM("")),d.close();var h=d.parentWindow.Object;return d=null,h},C1=function(){try{FN=new ActiveXObject("htmlfile")}catch{}var d,h;C1=typeof document<"u"?document.domain&&FN?jM(FN):((h=bV("iframe")).style.display="none",yV.appendChild(h),h.src="javascript:",(d=h.contentWindow.document).open(),d.write(MM("document.F=Object")),d.close(),d.F):jM(FN);for(var g=eN.length;g--;)delete C1.prototype[eN[g]];return C1()};NO[LM]=!0;var I1=Object.create||function(d,h){var g;return d!==null?(YP.prototype=vV(d),g=new YP,YP.prototype=null,g[LM]=d):g=C1(),h===void 0?g:_V.f(g,h)},UM=ba("".replace),SV=String(Error("zxcasd").stack),JP=/\n\s*at [^:]*:[^\n]*/,XP=JP.test(SV),FM=u0,kO=sO,PO={},QP=PO,BM=wR("iterator"),ZP=Array.prototype,_x={};_x[wR("toStringTag")]="z";var BN=String(_x)==="[object z]",RV=_E,xO=BN,cO=m_,O1=a_,TV=wR("toStringTag"),wV=RV.Object,CV=O1(function(){return arguments}())=="Arguments",uO=xO?O1:function(d){var h,g,j;return d===void 0?"Undefined":d===null?"Null":typeof(g=function(_t,_i){try{return _t[_i]}catch{}}(h=wV(d),TV))=="string"?g:CV?O1(h):(j=O1(h))=="Object"&&cO(h.callee)?"Arguments":j},IV=uO,VM=SI,OV=PO,GM=wR("iterator"),VN=function(d){if(d!=null)return VM(d,GM)||VM(d,"@@iterator")||OV[IV(d)]},A1=_y,AV=QR,NV=DT,GN=nI,u_=VN,_d=_E.TypeError,i_=_y,g_=DT,x_=SI,M_=wO,X_=_y,i0=DT,_0=nI,N0=function(d){return d!==void 0&&(QP.Array===d||ZP[BM]===d)},P0=$I,R0=_p,oS=function(d,h){var g=arguments.length<2?u_(d):h;if(AV(g))return NV(A1(g,d));throw _d(GN(d)+" is not iterable")},W0=VN,Q0=function(d,h,g){var j,_t;g_(d);try{if(!(j=x_(d,"return"))){if(h==="throw")throw g;return g}j=i_(j,d)}catch(_i){_t=!0,j=_i}if(h==="throw")throw g;if(_t)throw j;return g_(j),g},J0=_E.TypeError,K0=function(d,h){this.stopped=d,this.result=h},xS=K0.prototype,DS=function(d,h,g){var j,_t,_i,_o,ga,_a,_u,_c=g&&g.that,_l=!(!g||!g.AS_ENTRIES),_g=!(!g||!g.IS_ITERATOR),r_=!(!g||!g.INTERRUPTED),l_=M_(h,_c),d_=function(C_){return j&&Q0(j,"normal",C_),new K0(!0,C_)},p_=function(C_){return _l?(i0(C_),r_?l_(C_[0],C_[1],d_):l_(C_[0],C_[1])):r_?l_(C_,d_):l_(C_)};if(_g)j=d;else{if(!(_t=W0(d)))throw J0(_0(d)+" is not iterable");if(N0(_t)){for(_i=0,_o=P0(d);_o>_i;_i++)if((ga=p_(d[_i]))&&R0(xS,ga))return ga;return new K0(!1)}j=oS(d,_t)}for(_a=j.next;!(_u=X_(_a,j)).done;){try{ga=p_(_u.value)}catch(C_){Q0(j,"throw",C_)}if(typeof ga=="object"&&ga&&R0(xS,ga))return ga}return new K0(!1)},fS=uO,OS=_E.String,Z0=function(d){if(fS(d)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return OS(d)},bS=Z0,LS=I_,VS=!_(function(){var d=Error("a");return!("stack"in d)||(Object.defineProperty(d,"stack",LS(1,7)),d.stack!==7)}),jS=PR,CR=_E,LT=_p,sI=MN,FR=RM,$T=function(d,h,g){for(var j=dV(h),_t=hV.f,_i=pV.f,_o=0;_o<j.length;_o++){var ga=j[_o];w1(d,ga)||g&&w1(g,ga)||_t(d,ga,_i(h,ga))}},MT=I1,nR=sO,HT=I_,II=function(d,h){if(XP&&typeof d=="string")for(;h--;)d=UM(d,JP,"");return d},tN=function(d,h){FM(h)&&"cause"in h&&kO(d,"cause",h.cause)},BR=DS,YS=function(d,h){return d===void 0?arguments.length<2?"":h:bS(d)},gT=VS,qT=wR("toStringTag"),aI=CR.Error,N1=[].push,nN=function(d,h){var g,j=arguments.length>2?arguments[2]:void 0,_t=LT(k1,this);FR?g=FR(new aI,_t?sI(this):k1):(g=_t?this:MT(k1),nR(g,qT,"Error")),h!==void 0&&nR(g,"message",YS(h)),gT&&nR(g,"stack",II(g.stack,1)),tN(g,j);var _i=[];return BR(d,N1,{that:_i}),nR(g,"errors",_i),g};FR?FR(nN,aI):$T(nN,aI,{name:!0});var k1=nN.prototype=MT(aI.prototype,{constructor:HT(1,nN),message:HT(1,""),name:HT(1,"AggregateError")});jS({global:!0},{AggregateError:nN});var P1=m_,_D=vS,kV=ba(Function.toString);P1(_D.inspectSource)||(_D.inspectSource=function(d){return kV(d)});var rN,$N,WN,eL=_D.inspectSource,$M=m_,WM=eL,HM=_E.WeakMap,PV=$M(HM)&&/native code/.test(WM(HM)),lO=_E,iN=ba,qM=u0,zM=sO,HN=IS,x1=vS,KM=LN,YM=R1,tL="Object already initialized",nL=lO.TypeError,xV=lO.WeakMap;if(PV||x1.state){var KI=x1.state||(x1.state=new xV),JM=iN(KI.get),T6=iN(KI.has),E7=iN(KI.set);rN=function(d,h){if(T6(KI,d))throw new nL(tL);return h.facade=d,E7(KI,d,h),h},$N=function(d){return JM(KI,d)||{}},WN=function(d){return T6(KI,d)}}else{var D1=KM("state");YM[D1]=!0,rN=function(d,h){if(HN(d,D1))throw new nL(tL);return h.facade=d,zM(d,D1,h),h},$N=function(d){return HN(d,D1)?d[D1]:{}},WN=function(d){return HN(d,D1)}}var qN,w6,C6,XM={set:rN,get:$N,has:WN,enforce:function(d){return WN(d)?$N(d):rN(d,{})},getterFor:function(d){return function(h){var g;if(!qM(h)||(g=$N(h)).type!==d)throw nL("Incompatible receiver, "+d+" required");return g}}},DV=w_,v7=IS,I6=Function.prototype,_7=DV&&Object.getOwnPropertyDescriptor,LV=v7(I6,"name"),O6={EXISTS:LV,PROPER:LV&&(function(){}).name==="something",CONFIGURABLE:LV&&(!DV||DV&&_7(I6,"name").configurable)},y7=sO,QM=function(d,h,g,j){j&&j.enumerable?d[h]=g:y7(d,h,g)},b7=_,S7=m_,R7=I1,A6=MN,T7=QM,MV=wR("iterator"),N6=!1;[].keys&&("next"in(C6=[].keys())?(w6=A6(A6(C6)))!==Object.prototype&&(qN=w6):N6=!0);var w7=qN==null||b7(function(){var d={};return qN[MV].call(d)!==d});S7((qN=w7?{}:R7(qN))[MV])||T7(qN,MV,function(){return this});var k6={IteratorPrototype:qN,BUGGY_SAFARI_ITERATORS:N6},C7=uO,I7=BN?{}.toString:function(){return"[object "+C7(this)+"]"},O7=BN,A7=oI.f,N7=sO,k7=IS,P7=I7,P6=wR("toStringTag"),rL=function(d,h,g,j){if(d){var _t=g?d:d.prototype;k7(_t,P6)||A7(_t,P6,{configurable:!0,value:h}),j&&!O7&&N7(_t,"toString",P7)}},x7=k6.IteratorPrototype,D7=I1,L7=I_,M7=rL,j7=PO,U7=function(){return this},F7=PR,B7=_y,V7=function(d,h,g,j){var _t=h+" Iterator";return d.prototype=D7(x7,{next:L7(+!j,g)}),M7(d,_t,!1,!0),j7[_t]=U7,d},G7=MN,$7=rL,x6=QM,D6=PO,W7=O6.PROPER,ZM=k6.BUGGY_SAFARI_ITERATORS,jV=wR("iterator"),L6="keys",_j="values",M6="entries",H7=function(){return this},j6=function(d,h,g,j,_t,_i,_o){V7(g,h,j);var ga,_a,_u,_c=function(C_){if(C_===_t&&d_)return d_;if(!ZM&&C_ in r_)return r_[C_];switch(C_){case L6:case _j:case M6:return function(){return new g(this,C_)}}return function(){return new g(this)}},_l=h+" Iterator",_g=!1,r_=d.prototype,l_=r_[jV]||r_["@@iterator"]||_t&&r_[_t],d_=!ZM&&l_||_c(_t),p_=h=="Array"&&r_.entries||l_;if(p_&&(ga=G7(p_.call(new d)))!==Object.prototype&&ga.next&&($7(ga,_l,!0,!0),D6[_l]=H7),W7&&_t==_j&&l_&&l_.name!==_j&&(_g=!0,d_=function(){return B7(l_,this)}),_t)if(_a={values:_c(_j),keys:_i?d_:_c(L6),entries:_c(M6)},_o)for(_u in _a)(ZM||_g||!(_u in r_))&&x6(r_,_u,_a[_u]);else F7({target:h,proto:!0,forced:ZM||_g},_a);return _o&&r_[jV]!==d_&&x6(r_,jV,d_,{name:_t}),D6[h]=d_,_a},q7=m0,U6=PO,F6=XM;oI.f;var z7=j6,B6="Array Iterator",K7=F6.set,Y7=F6.getterFor(B6);z7(Array,"Array",function(d,h){K7(this,{type:B6,target:q7(d),index:0,kind:h})},function(){var d=Y7(this),h=d.target,g=d.kind,j=d.index++;return!h||j>=h.length?(d.target=void 0,{value:void 0,done:!0}):g=="keys"?{value:j,done:!1}:g=="values"?{value:h[j],done:!1}:{value:[j,h[j]],done:!1}},"values"),U6.Arguments=U6.Array;var V6=_E.Promise,J7=QM,X7=A0,Q7=oI,Z7=w_,G6=wR("species"),e9=_p,t9=_E.TypeError,$6=wR("iterator"),W6=!1;try{var n9=0,H6={next:function(){return{done:!!n9++}},return:function(){W6=!0}};H6[$6]=function(){return this},Array.from(H6,function(){throw 2})}catch{}var r9=ba,i9=_,q6=m_,o9=uO,s9=eL,z6=function(){},a9=[],K6=A0("Reflect","construct"),UV=/^\s*(?:class|function)\b/,c9=r9(UV.exec),u9=!UV.exec(z6),iL=function(d){if(!q6(d))return!1;try{return K6(z6,a9,d),!0}catch{return!1}},Y6=function(d){if(!q6(d))return!1;switch(o9(d)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return u9||!!c9(UV,s9(d))}catch{return!0}};Y6.sham=!0;var oL,L1,J6,FV,BV=!K6||i9(function(){var d;return iL(iL.call)||!iL(Object)||!iL(function(){d=!0})||d})?Y6:iL,l9=BV,d9=nI,p9=_E.TypeError,X6=DT,h9=function(d){if(l9(d))return d;throw p9(d9(d)+" is not a constructor")},f9=wR("species"),Q6=function(d,h){var g,j=X6(d).constructor;return j===void 0||(g=X6(j)[f9])==null?h:h9(g)},VV=ba([].slice),Z6=/(?:ipad|iphone|ipod).*applewebkit/i.test(j_),cI=_E,m9=o_,g9=wO,eG=m_,E9=IS,v9=_,tG=DM,_9=VV,nG=BI,y9=Z6,b9=v1,GV=cI.setImmediate,$V=cI.clearImmediate,S9=cI.process,WV=cI.Dispatch,R9=cI.Function,rG=cI.MessageChannel,T9=cI.String,HV=0,sL={},w9="onreadystatechange";try{oL=cI.location}catch{}var qV=function(d){if(E9(sL,d)){var h=sL[d];delete sL[d],h()}},zV=function(d){return function(){qV(d)}},iG=function(d){qV(d.data)},oG=function(d){cI.postMessage(T9(d),oL.protocol+"//"+oL.host)};GV&&$V||(GV=function(d){var h=_9(arguments,1);return sL[++HV]=function(){m9(eG(d)?d:R9(d),void 0,h)},L1(HV),HV},$V=function(d){delete sL[d]},b9?L1=function(d){S9.nextTick(zV(d))}:WV&&WV.now?L1=function(d){WV.now(zV(d))}:rG&&!y9?(FV=(J6=new rG).port2,J6.port1.onmessage=iG,L1=g9(FV.postMessage,FV)):cI.addEventListener&&eG(cI.postMessage)&&!cI.importScripts&&oL&&oL.protocol!=="file:"&&!v9(oG)?(L1=oG,cI.addEventListener("message",iG,!1)):L1=w9 in nG("script")?function(d){tG.appendChild(nG("script")).onreadystatechange=function(){tG.removeChild(this),qV(d)}}:function(d){setTimeout(zV(d),0)});var aL,zN,cL,M1,KV,YV,JV,sG,aG={set:GV,clear:$V},C9=_E,I9=/ipad|iphone|ipod/i.test(j_)&&C9.Pebble!==void 0,O9=/web0s(?!.*chrome)/i.test(j_),KN=_E,cG=wO,A9=b_.f,XV=aG.set,N9=Z6,k9=I9,P9=O9,QV=v1,uG=KN.MutationObserver||KN.WebKitMutationObserver,lG=KN.document,dG=KN.process,$j=KN.Promise,pG=A9(KN,"queueMicrotask"),hG=pG&&pG.value;hG||(aL=function(){var d,h;for(QV&&(d=dG.domain)&&d.exit();zN;){h=zN.fn,zN=zN.next;try{h()}catch(g){throw zN?M1():cL=void 0,g}}cL=void 0,d&&d.enter()},N9||QV||P9||!uG||!lG?!k9&&$j&&$j.resolve?((JV=$j.resolve(void 0)).constructor=$j,sG=cG(JV.then,JV),M1=function(){sG(aL)}):QV?M1=function(){dG.nextTick(aL)}:(XV=cG(XV,KN),M1=function(){XV(aL)}):(KV=!0,YV=lG.createTextNode(""),new uG(aL).observe(YV,{characterData:!0}),M1=function(){YV.data=KV=!KV}));var x9=hG||function(d){var h={fn:d,next:void 0};cL&&(cL.next=h),zN||(zN=h,M1()),cL=h},j1={},fG=QR,D9=function(d){var h,g;this.promise=new d(function(j,_t){if(h!==void 0||g!==void 0)throw TypeError("Bad Promise constructor");h=j,g=_t}),this.resolve=fG(h),this.reject=fG(g)};j1.f=function(d){return new D9(d)};var L9=DT,M9=u0,j9=j1,mG=function(d,h){if(L9(d),M9(h)&&h.constructor===d)return h;var g=j9.f(d);return(0,g.resolve)(h),g.promise},U9=_E,eU=function(d){try{return{error:!1,value:d()}}catch(h){return{error:!0,value:h}}},gG=function(){this.head=null,this.tail=null};gG.prototype={add:function(d){var h={item:d,next:null};this.head?this.tail.next=h:this.head=h,this.tail=h},get:function(){var d=this.head;if(d)return this.head=d.next,this.tail===d&&(this.tail=null),d.item}};var ZV,EG,e3,F9=typeof window=="object",tU=PR,DO=_E,B9=A0,oN=_y,t3=V6,V9=function(d,h,g){for(var j in h)g&&g.unsafe&&d[j]?d[j]=h[j]:J7(d,j,h[j],g);return d},G9=rL,$9=function(d){var h=X7(d),g=Q7.f;Z7&&h&&!h[G6]&&g(h,G6,{configurable:!0,get:function(){return this}})},n3=QR,nU=m_,W9=u0,H9=function(d,h){if(e9(h,d))return d;throw t9("Incorrect invocation")},q9=eL,vG=DS,z9=function(d,h){if(!h&&!W6)return!1;var g=!1;try{var j={};j[$6]=function(){return{next:function(){return{done:g=!0}}}},d(j)}catch{}return g},K9=Q6,_G=aG.set,r3=x9,Y9=mG,J9=function(d,h){var g=U9.console;g&&g.error&&(arguments.length==1?g.error(d):g.error(d,h))},yG=j1,i3=eU,X9=gG,o3=XM,Q9=YL,Z9=F9,rU=v1,bG=yS,eY=wR("species"),dO="Promise",SG=o3.getterFor(dO),tY=o3.set,nY=o3.getterFor(dO),rY=t3&&t3.prototype,pO=t3,iU=rY,RG=DO.TypeError,s3=DO.document,a3=DO.process,U1=yG.f,iY=U1,oY=!!(s3&&s3.createEvent&&DO.dispatchEvent),TG=nU(DO.PromiseRejectionEvent),wG="unhandledrejection",oU=Q9(dO,function(){var d=q9(pO),h=d!==String(pO);if(!h&&bG===66||!iU.finally)return!0;if(bG>=51&&/native code/.test(d))return!1;var g=new pO(function(_t){_t(1)}),j=function(_t){_t(function(){},function(){})};return(g.constructor={})[eY]=j,!(g.then(function(){})instanceof j)||!h&&Z9&&!TG}),sY=oU||!z9(function(d){pO.all(d).catch(function(){})}),CG=function(d){var h;return!(!W9(d)||!nU(h=d.then))&&h},IG=function(d,h){var g,j,_t,_i=h.value,_o=h.state==1,ga=_o?d.ok:d.fail,_a=d.resolve,_u=d.reject,_c=d.domain;try{ga?(_o||(h.rejection===2&&cY(h),h.rejection=1),ga===!0?g=_i:(_c&&_c.enter(),g=ga(_i),_c&&(_c.exit(),_t=!0)),g===d.promise?_u(RG("Promise-chain cycle")):(j=CG(g))?oN(j,g,_a,_u):_a(g)):_u(_i)}catch(_l){_c&&!_t&&_c.exit(),_u(_l)}},OG=function(d,h){d.notified||(d.notified=!0,r3(function(){for(var g,j=d.reactions;g=j.get();)IG(g,d);d.notified=!1,h&&!d.rejection&&aY(d)}))},AG=function(d,h,g){var j,_t;oY?((j=s3.createEvent("Event")).promise=h,j.reason=g,j.initEvent(d,!1,!0),DO.dispatchEvent(j)):j={promise:h,reason:g},!TG&&(_t=DO["on"+d])?_t(j):d===wG&&J9("Unhandled promise rejection",g)},aY=function(d){oN(_G,DO,function(){var h,g=d.facade,j=d.value;if(NG(d)&&(h=i3(function(){rU?a3.emit("unhandledRejection",j,g):AG(wG,g,j)}),d.rejection=rU||NG(d)?2:1,h.error))throw h.value})},NG=function(d){return d.rejection!==1&&!d.parent},cY=function(d){oN(_G,DO,function(){var h=d.facade;rU?a3.emit("rejectionHandled",h):AG("rejectionhandled",h,d.value)})},F1=function(d,h,g){return function(j){d(h,j,g)}},B1=function(d,h,g){d.done||(d.done=!0,g&&(d=g),d.value=h,d.state=2,OG(d,!0))},c3=function(d,h,g){if(!d.done){d.done=!0,g&&(d=g);try{if(d.facade===h)throw RG("Promise can't be resolved itself");var j=CG(h);j?r3(function(){var _t={done:!1};try{oN(j,h,F1(c3,_t,d),F1(B1,_t,d))}catch(_i){B1(_t,_i,d)}}):(d.value=h,d.state=1,OG(d,!1))}catch(_t){B1({done:!1},_t,d)}}};oU&&(iU=(pO=function(d){H9(this,iU),n3(d),oN(ZV,this);var h=SG(this);try{d(F1(c3,h),F1(B1,h))}catch(g){B1(h,g)}}).prototype,(ZV=function(d){tY(this,{type:dO,done:!1,notified:!1,parent:!1,reactions:new X9,rejection:!1,state:0,value:void 0})}).prototype=V9(iU,{then:function(d,h){var g=nY(this),j=U1(K9(this,pO));return g.parent=!0,j.ok=!nU(d)||d,j.fail=nU(h)&&h,j.domain=rU?a3.domain:void 0,g.state==0?g.reactions.add(j):r3(function(){IG(j,g)}),j.promise},catch:function(d){return this.then(void 0,d)}}),EG=function(){var d=new ZV,h=SG(d);this.promise=d,this.resolve=F1(c3,h),this.reject=F1(B1,h)},yG.f=U1=function(d){return d===pO||d===e3?new EG(d):iY(d)}),tU({global:!0,wrap:!0,forced:oU},{Promise:pO}),G9(pO,dO,!1,!0),$9(dO),e3=B9(dO),tU({target:dO,stat:!0,forced:oU},{reject:function(d){var h=U1(this);return oN(h.reject,void 0,d),h.promise}}),tU({target:dO,stat:!0,forced:!0},{resolve:function(d){return Y9(this===e3?pO:this,d)}}),tU({target:dO,stat:!0,forced:sY},{all:function(d){var h=this,g=U1(h),j=g.resolve,_t=g.reject,_i=i3(function(){var _o=n3(h.resolve),ga=[],_a=0,_u=1;vG(d,function(_c){var _l=_a++,_g=!1;_u++,oN(_o,h,_c).then(function(r_){_g||(_g=!0,ga[_l]=r_,--_u||j(ga))},_t)}),--_u||j(ga)});return _i.error&&_t(_i.value),g.promise},race:function(d){var h=this,g=U1(h),j=g.reject,_t=i3(function(){var _i=n3(h.resolve);vG(d,function(_o){oN(_i,h,_o).then(g.resolve,j)})});return _t.error&&j(_t.value),g.promise}});var uY=_y,lY=QR,dY=j1,pY=eU,hY=DS;PR({target:"Promise",stat:!0},{allSettled:function(d){var h=this,g=dY.f(h),j=g.resolve,_t=g.reject,_i=pY(function(){var _o=lY(h.resolve),ga=[],_a=0,_u=1;hY(d,function(_c){var _l=_a++,_g=!1;_u++,uY(_o,h,_c).then(function(r_){_g||(_g=!0,ga[_l]={status:"fulfilled",value:r_},--_u||j(ga))},function(r_){_g||(_g=!0,ga[_l]={status:"rejected",reason:r_},--_u||j(ga))})}),--_u||j(ga)});return _i.error&&_t(_i.value),g.promise}});var fY=QR,mY=A0,gY=_y,EY=j1,vY=eU,_Y=DS,kG="No one promise resolved";PR({target:"Promise",stat:!0},{any:function(d){var h=this,g=mY("AggregateError"),j=EY.f(h),_t=j.resolve,_i=j.reject,_o=vY(function(){var ga=fY(h.resolve),_a=[],_u=0,_c=1,_l=!1;_Y(d,function(_g){var r_=_u++,l_=!1;_c++,gY(ga,h,_g).then(function(d_){l_||_l||(_l=!0,_t(d_))},function(d_){l_||_l||(l_=!0,_a[r_]=d_,--_c||_i(new g(_a,kG)))})}),--_c||_i(new g(_a,kG))});return _o.error&&_i(_o.value),j.promise}});var PG=V6,yY=A0,bY=m_,SY=Q6,xG=mG;PR({target:"Promise",proto:!0,real:!0,forced:!!PG&&_(function(){PG.prototype.finally.call({then:function(){}},function(){})})},{finally:function(d){var h=SY(this,yY("Promise")),g=bY(d);return this.then(g?function(j){return xG(h,d()).then(function(){return j})}:d,g?function(j){return xG(h,d()).then(function(){throw j})}:d)}});var u3=ba,RY=jP,TY=Z0,wY=H_,CY=u3("".charAt),DG=u3("".charCodeAt),IY=u3("".slice),LG=function(d){return function(h,g){var j,_t,_i=TY(wY(h)),_o=RY(g),ga=_i.length;return _o<0||_o>=ga?d?"":void 0:(j=DG(_i,_o))<55296||j>56319||_o+1===ga||(_t=DG(_i,_o+1))<56320||_t>57343?d?CY(_i,_o):j:d?IY(_i,_o,_o+2):_t-56320+(j-55296<<10)+65536}},OY={codeAt:LG(!1),charAt:LG(!0)}.charAt,AY=Z0,MG=XM,NY=j6,jG="String Iterator",kY=MG.set,PY=MG.getterFor(jG);NY(String,"String",function(d){kY(this,{type:jG,string:AY(d),index:0})},function(){var d,h=PY(this),g=h.string,j=h.index;return j>=g.length?{value:void 0,done:!0}:(d=OY(g,j),h.index+=d.length,{value:d,done:!1})});var xY=s0.Promise,DY={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},LY=_E,MY=uO,jY=sO,UG=PO,FG=wR("toStringTag");for(var l3 in DY){var BG=LY[l3],d3=BG&&BG.prototype;d3&&MY(d3)!==FG&&jY(d3,FG,l3),UG[l3]=UG.Array}var VG=xY,a0=VG;const GG=BP;function $G(d,h){const g=d&&d.navigator;if(!g.mediaDevices)return;const j=function(_o){if(typeof _o!="object"||_o.mandatory||_o.optional)return _o;const ga={};return Object.keys(_o).forEach(_a=>{if(_a==="require"||_a==="advanced"||_a==="mediaSource")return;const _u=typeof _o[_a]=="object"?_o[_a]:{ideal:_o[_a]};_u.exact!==void 0&&typeof _u.exact=="number"&&(_u.min=_u.max=_u.exact);const _c=function(_l,_g){return _l?_l+_g.charAt(0).toUpperCase()+_g.slice(1):_g==="deviceId"?"sourceId":_g};if(_u.ideal!==void 0){ga.optional=ga.optional||[];let _l={};typeof _u.ideal=="number"?(_l[_c("min",_a)]=_u.ideal,ga.optional.push(_l),_l={},_l[_c("max",_a)]=_u.ideal,ga.optional.push(_l)):(_l[_c("",_a)]=_u.ideal,ga.optional.push(_l))}_u.exact!==void 0&&typeof _u.exact!="number"?(ga.mandatory=ga.mandatory||{},ga.mandatory[_c("",_a)]=_u.exact):["min","max"].forEach(_l=>{_u[_l]!==void 0&&(ga.mandatory=ga.mandatory||{},ga.mandatory[_c(_l,_a)]=_u[_l])})}),_o.advanced&&(ga.optional=(ga.optional||[]).concat(_o.advanced)),ga},_t=function(_o,ga){if(h.version>=61)return ga(_o);if((_o=JSON.parse(JSON.stringify(_o)))&&typeof _o.audio=="object"){const _a=function(_u,_c,_l){_c in _u&&!(_l in _u)&&(_u[_l]=_u[_c],delete _u[_c])};_a((_o=JSON.parse(JSON.stringify(_o))).audio,"autoGainControl","googAutoGainControl"),_a(_o.audio,"noiseSuppression","googNoiseSuppression"),_o.audio=j(_o.audio)}if(_o&&typeof _o.video=="object"){let _a=_o.video.facingMode;_a=_a&&(typeof _a=="object"?_a:{ideal:_a});const _u=h.version<66;if(_a&&(_a.exact==="user"||_a.exact==="environment"||_a.ideal==="user"||_a.ideal==="environment")&&(!g.mediaDevices.getSupportedConstraints||!g.mediaDevices.getSupportedConstraints().facingMode||_u)){let _c;if(delete _o.video.facingMode,_a.exact==="environment"||_a.ideal==="environment"?_c=["back","rear"]:_a.exact!=="user"&&_a.ideal!=="user"||(_c=["front"]),_c)return g.mediaDevices.enumerateDevices().then(_l=>{let _g=(_l=_l.filter(r_=>r_.kind==="videoinput")).find(r_=>_c.some(l_=>r_.label.toLowerCase().includes(l_)));return!_g&&_l.length&&_c.includes("back")&&(_g=_l[_l.length-1]),_g&&(_o.video.deviceId=_a.exact?{exact:_g.deviceId}:{ideal:_g.deviceId}),_o.video=j(_o.video),GG("chrome: "+JSON.stringify(_o)),ga(_o)})}_o.video=j(_o.video)}return GG("chrome: "+JSON.stringify(_o)),ga(_o)},_i=function(_o){return h.version>=64?_o:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[_o.name]||_o.name,message:_o.message,constraint:_o.constraint||_o.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(g.getUserMedia=(function(_o,ga,_a){_t(_o,_u=>{g.webkitGetUserMedia(_u,ga,_c=>{_a&&_a(_i(_c))})})}).bind(g),g.mediaDevices.getUserMedia){const _o=g.mediaDevices.getUserMedia.bind(g.mediaDevices);g.mediaDevices.getUserMedia=function(ga){return _t(ga,_a=>_o(_a).then(_u=>{if(_a.audio&&!_u.getAudioTracks().length||_a.video&&!_u.getVideoTracks().length)throw _u.getTracks().forEach(_c=>{_c.stop()}),new DOMException("","NotFoundError");return _u},_u=>a0.reject(_i(_u))))}}}function WG(d){d.MediaStream=d.MediaStream||d.webkitMediaStream}function HG(d){if(typeof d=="object"&&d.RTCPeerConnection&&!("ontrack"in d.RTCPeerConnection.prototype)){Object.defineProperty(d.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(g){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=g)},enumerable:!0,configurable:!0});const h=d.RTCPeerConnection.prototype.setRemoteDescription;d.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=g=>{g.stream.addEventListener("addtrack",j=>{let _t;_t=d.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(_o=>_o.track&&_o.track.id===j.track.id):{track:j.track};const _i=new Event("track");_i.track=j.track,_i.receiver=_t,_i.transceiver={receiver:_t},_i.streams=[g.stream],this.dispatchEvent(_i)}),g.stream.getTracks().forEach(j=>{let _t;_t=d.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(_o=>_o.track&&_o.track.id===j.id):{track:j};const _i=new Event("track");_i.track=j,_i.receiver=_t,_i.transceiver={receiver:_t},_i.streams=[g.stream],this.dispatchEvent(_i)})},this.addEventListener("addstream",this._ontrackpoly)),h.apply(this,arguments)}}else aO(d,"track",h=>(h.transceiver||Object.defineProperty(h,"transceiver",{value:{receiver:h.receiver}}),h))}function qG(d){if(typeof d=="object"&&d.RTCPeerConnection&&!("getSenders"in d.RTCPeerConnection.prototype)&&"createDTMFSender"in d.RTCPeerConnection.prototype){const h=function(_t,_i){return{track:_i,get dtmf(){return this._dtmf===void 0&&(_i.kind==="audio"?this._dtmf=_t.createDTMFSender(_i):this._dtmf=null),this._dtmf},_pc:_t}};if(!d.RTCPeerConnection.prototype.getSenders){d.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const _t=d.RTCPeerConnection.prototype.addTrack;d.RTCPeerConnection.prototype.addTrack=function(_o,ga){let _a=_t.apply(this,arguments);return _a||(_a=h(this,_o),this._senders.push(_a)),_a};const _i=d.RTCPeerConnection.prototype.removeTrack;d.RTCPeerConnection.prototype.removeTrack=function(_o){_i.apply(this,arguments);const ga=this._senders.indexOf(_o);ga!==-1&&this._senders.splice(ga,1)}}const g=d.RTCPeerConnection.prototype.addStream;d.RTCPeerConnection.prototype.addStream=function(_t){this._senders=this._senders||[],g.apply(this,[_t]),_t.getTracks().forEach(_i=>{this._senders.push(h(this,_i))})};const j=d.RTCPeerConnection.prototype.removeStream;d.RTCPeerConnection.prototype.removeStream=function(_t){this._senders=this._senders||[],j.apply(this,[_t]),_t.getTracks().forEach(_i=>{const _o=this._senders.find(ga=>ga.track===_i);_o&&this._senders.splice(this._senders.indexOf(_o),1)})}}else if(typeof d=="object"&&d.RTCPeerConnection&&"getSenders"in d.RTCPeerConnection.prototype&&"createDTMFSender"in d.RTCPeerConnection.prototype&&d.RTCRtpSender&&!("dtmf"in d.RTCRtpSender.prototype)){const h=d.RTCPeerConnection.prototype.getSenders;d.RTCPeerConnection.prototype.getSenders=function(){const g=h.apply(this,[]);return g.forEach(j=>j._pc=this),g},Object.defineProperty(d.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function zG(d){if(!d.RTCPeerConnection)return;const h=d.RTCPeerConnection.prototype.getStats;d.RTCPeerConnection.prototype.getStats=function(){const[g,j,_t]=arguments;if(arguments.length>0&&typeof g=="function")return h.apply(this,arguments);if(h.length===0&&(arguments.length===0||typeof g!="function"))return h.apply(this,[]);const _i=function(ga){const _a={};return ga.result().forEach(_u=>{const _c={id:_u.id,timestamp:_u.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[_u.type]||_u.type};_u.names().forEach(_l=>{_c[_l]=_u.stat(_l)}),_a[_c.id]=_c}),_a},_o=function(ga){return new Map(Object.keys(ga).map(_a=>[_a,ga[_a]]))};if(arguments.length>=2){const ga=function(_a){j(_o(_i(_a)))};return h.apply(this,[ga,g])}return new a0((ga,_a)=>{h.apply(this,[function(_u){ga(_o(_i(_u)))},_a])}).then(j,_t)}}function KG(d){if(!(typeof d=="object"&&d.RTCPeerConnection&&d.RTCRtpSender&&d.RTCRtpReceiver))return;if(!("getStats"in d.RTCRtpSender.prototype)){const g=d.RTCPeerConnection.prototype.getSenders;g&&(d.RTCPeerConnection.prototype.getSenders=function(){const _t=g.apply(this,[]);return _t.forEach(_i=>_i._pc=this),_t});const j=d.RTCPeerConnection.prototype.addTrack;j&&(d.RTCPeerConnection.prototype.addTrack=function(){const _t=j.apply(this,arguments);return _t._pc=this,_t}),d.RTCRtpSender.prototype.getStats=function(){const _t=this;return this._pc.getStats().then(_i=>b1(_i,_t.track,!0))}}if(!("getStats"in d.RTCRtpReceiver.prototype)){const g=d.RTCPeerConnection.prototype.getReceivers;g&&(d.RTCPeerConnection.prototype.getReceivers=function(){const j=g.apply(this,[]);return j.forEach(_t=>_t._pc=this),j}),aO(d,"track",j=>(j.receiver._pc=j.srcElement,j)),d.RTCRtpReceiver.prototype.getStats=function(){const j=this;return this._pc.getStats().then(_t=>b1(_t,j.track,!1))}}if(!("getStats"in d.RTCRtpSender.prototype)||!("getStats"in d.RTCRtpReceiver.prototype))return;const h=d.RTCPeerConnection.prototype.getStats;d.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof d.MediaStreamTrack){const g=arguments[0];let j,_t,_i;return this.getSenders().forEach(_o=>{_o.track===g&&(j?_i=!0:j=_o)}),this.getReceivers().forEach(_o=>(_o.track===g&&(_t?_i=!0:_t=_o),_o.track===g)),_i||j&&_t?a0.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):j?j.getStats():_t?_t.getStats():a0.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return h.apply(this,arguments)}}function YG(d){d.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(_i=>this._shimmedLocalStreams[_i][0])};const h=d.RTCPeerConnection.prototype.addTrack;d.RTCPeerConnection.prototype.addTrack=function(_i,_o){if(!_o)return h.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const ga=h.apply(this,arguments);return this._shimmedLocalStreams[_o.id]?this._shimmedLocalStreams[_o.id].indexOf(ga)===-1&&this._shimmedLocalStreams[_o.id].push(ga):this._shimmedLocalStreams[_o.id]=[_o,ga],ga};const g=d.RTCPeerConnection.prototype.addStream;d.RTCPeerConnection.prototype.addStream=function(_i){this._shimmedLocalStreams=this._shimmedLocalStreams||{},_i.getTracks().forEach(_a=>{if(this.getSenders().find(_u=>_u.track===_a))throw new DOMException("Track already exists.","InvalidAccessError")});const _o=this.getSenders();g.apply(this,arguments);const ga=this.getSenders().filter(_a=>_o.indexOf(_a)===-1);this._shimmedLocalStreams[_i.id]=[_i].concat(ga)};const j=d.RTCPeerConnection.prototype.removeStream;d.RTCPeerConnection.prototype.removeStream=function(_i){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[_i.id],j.apply(this,arguments)};const _t=d.RTCPeerConnection.prototype.removeTrack;d.RTCPeerConnection.prototype.removeTrack=function(_i){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},_i&&Object.keys(this._shimmedLocalStreams).forEach(_o=>{const ga=this._shimmedLocalStreams[_o].indexOf(_i);ga!==-1&&this._shimmedLocalStreams[_o].splice(ga,1),this._shimmedLocalStreams[_o].length===1&&delete this._shimmedLocalStreams[_o]}),_t.apply(this,arguments)}}function JG(d,h){if(!d.RTCPeerConnection)return;if(d.RTCPeerConnection.prototype.addTrack&&h.version>=65)return YG(d);const g=d.RTCPeerConnection.prototype.getLocalStreams;d.RTCPeerConnection.prototype.getLocalStreams=function(){const _u=g.apply(this);return this._reverseStreams=this._reverseStreams||{},_u.map(_c=>this._reverseStreams[_c.id])};const j=d.RTCPeerConnection.prototype.addStream;d.RTCPeerConnection.prototype.addStream=function(_u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},_u.getTracks().forEach(_c=>{if(this.getSenders().find(_l=>_l.track===_c))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[_u.id]){const _c=new d.MediaStream(_u.getTracks());this._streams[_u.id]=_c,this._reverseStreams[_c.id]=_u,_u=_c}j.apply(this,[_u])};const _t=d.RTCPeerConnection.prototype.removeStream;function _i(_u,_c){let _l=_c.sdp;return Object.keys(_u._reverseStreams||[]).forEach(_g=>{const r_=_u._reverseStreams[_g],l_=_u._streams[r_.id];_l=_l.replace(new RegExp(l_.id,"g"),r_.id)}),new RTCSessionDescription({type:_c.type,sdp:_l})}function _o(_u,_c){let _l=_c.sdp;return Object.keys(_u._reverseStreams||[]).forEach(_g=>{const r_=_u._reverseStreams[_g],l_=_u._streams[r_.id];_l=_l.replace(new RegExp(r_.id,"g"),l_.id)}),new RTCSessionDescription({type:_c.type,sdp:_l})}d.RTCPeerConnection.prototype.removeStream=function(_u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},_t.apply(this,[this._streams[_u.id]||_u]),delete this._reverseStreams[this._streams[_u.id]?this._streams[_u.id].id:_u.id],delete this._streams[_u.id]},d.RTCPeerConnection.prototype.addTrack=function(_u,_c){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const _l=[].slice.call(arguments,1);if(_l.length!==1||!_l[0].getTracks().find(l_=>l_===_u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(l_=>l_.track===_u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const r_=this._streams[_c.id];if(r_)r_.addTrack(_u),a0.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const l_=new d.MediaStream([_u]);this._streams[_c.id]=l_,this._reverseStreams[l_.id]=_c,this.addStream(l_)}return this.getSenders().find(l_=>l_.track===_u)},["createOffer","createAnswer"].forEach(function(_u){const _c=d.RTCPeerConnection.prototype[_u],_l={[_u](){const _g=arguments;return arguments.length&&typeof arguments[0]=="function"?_c.apply(this,[r_=>{const l_=_i(this,r_);_g[0].apply(null,[l_])},r_=>{_g[1]&&_g[1].apply(null,r_)},arguments[2]]):_c.apply(this,arguments).then(r_=>_i(this,r_))}};d.RTCPeerConnection.prototype[_u]=_l[_u]});const ga=d.RTCPeerConnection.prototype.setLocalDescription;d.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=_o(this,arguments[0]),ga.apply(this,arguments)):ga.apply(this,arguments)};const _a=Object.getOwnPropertyDescriptor(d.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(d.RTCPeerConnection.prototype,"localDescription",{get(){const _u=_a.get.apply(this);return _u.type===""?_u:_i(this,_u)}}),d.RTCPeerConnection.prototype.removeTrack=function(_u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!_u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(_u._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let _c;this._streams=this._streams||{},Object.keys(this._streams).forEach(_l=>{this._streams[_l].getTracks().find(_g=>_u.track===_g)&&(_c=this._streams[_l])}),_c&&(_c.getTracks().length===1?this.removeStream(this._reverseStreams[_c.id]):_c.removeTrack(_u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function p3(d,h){!d.RTCPeerConnection&&d.webkitRTCPeerConnection&&(d.RTCPeerConnection=d.webkitRTCPeerConnection),d.RTCPeerConnection&&h.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(g){const j=d.RTCPeerConnection.prototype[g],_t={[g](){return arguments[0]=new(g==="addIceCandidate"?d.RTCIceCandidate:d.RTCSessionDescription)(arguments[0]),j.apply(this,arguments)}};d.RTCPeerConnection.prototype[g]=_t[g]})}function XG(d,h){aO(d,"negotiationneeded",g=>{const j=g.target;if(!(h.version<72||j.getConfiguration&&j.getConfiguration().sdpSemantics==="plan-b")||j.signalingState==="stable")return g})}var QG=Object.freeze({__proto__:null,shimMediaStream:WG,shimOnTrack:HG,shimGetSendersWithDtmf:qG,shimGetStats:zG,shimSenderReceiverGetStats:KG,shimAddTrackRemoveTrackWithNative:YG,shimAddTrackRemoveTrack:JG,shimPeerConnection:p3,fixNegotiationNeeded:XG,shimGetUserMedia:$G,shimGetDisplayMedia:function(d,h){d.navigator.mediaDevices&&"getDisplayMedia"in d.navigator.mediaDevices||d.navigator.mediaDevices&&(typeof h=="function"?d.navigator.mediaDevices.getDisplayMedia=function(g){return h(g).then(j=>{const _t=g.video&&g.video.width,_i=g.video&&g.video.height,_o=g.video&&g.video.frameRate;return g.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:j,maxFrameRate:_o||3}},_t&&(g.video.mandatory.maxWidth=_t),_i&&(g.video.mandatory.maxHeight=_i),d.navigator.mediaDevices.getUserMedia(g)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}});function ZG(d,h){const g=d&&d.navigator,j=d&&d.MediaStreamTrack;if(g.getUserMedia=function(_t,_i,_o){y1("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),g.mediaDevices.getUserMedia(_t).then(_i,_o)},!(h.version>55&&"autoGainControl"in g.mediaDevices.getSupportedConstraints())){const _t=function(_o,ga,_a){ga in _o&&!(_a in _o)&&(_o[_a]=_o[ga],delete _o[ga])},_i=g.mediaDevices.getUserMedia.bind(g.mediaDevices);if(g.mediaDevices.getUserMedia=function(_o){return typeof _o=="object"&&typeof _o.audio=="object"&&(_o=JSON.parse(JSON.stringify(_o)),_t(_o.audio,"autoGainControl","mozAutoGainControl"),_t(_o.audio,"noiseSuppression","mozNoiseSuppression")),_i(_o)},j&&j.prototype.getSettings){const _o=j.prototype.getSettings;j.prototype.getSettings=function(){const ga=_o.apply(this,arguments);return _t(ga,"mozAutoGainControl","autoGainControl"),_t(ga,"mozNoiseSuppression","noiseSuppression"),ga}}if(j&&j.prototype.applyConstraints){const _o=j.prototype.applyConstraints;j.prototype.applyConstraints=function(ga){return this.kind==="audio"&&typeof ga=="object"&&(ga=JSON.parse(JSON.stringify(ga)),_t(ga,"autoGainControl","mozAutoGainControl"),_t(ga,"noiseSuppression","mozNoiseSuppression")),_o.apply(this,[ga])}}}}function e2(d){typeof d=="object"&&d.RTCTrackEvent&&"receiver"in d.RTCTrackEvent.prototype&&!("transceiver"in d.RTCTrackEvent.prototype)&&Object.defineProperty(d.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function h3(d,h){if(typeof d!="object"||!d.RTCPeerConnection&&!d.mozRTCPeerConnection)return;!d.RTCPeerConnection&&d.mozRTCPeerConnection&&(d.RTCPeerConnection=d.mozRTCPeerConnection),h.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(_t){const _i=d.RTCPeerConnection.prototype[_t],_o={[_t](){return arguments[0]=new(_t==="addIceCandidate"?d.RTCIceCandidate:d.RTCSessionDescription)(arguments[0]),_i.apply(this,arguments)}};d.RTCPeerConnection.prototype[_t]=_o[_t]});const g={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},j=d.RTCPeerConnection.prototype.getStats;d.RTCPeerConnection.prototype.getStats=function(){const[_t,_i,_o]=arguments;return j.apply(this,[_t||null]).then(ga=>{if(h.version<53&&!_i)try{ga.forEach(_a=>{_a.type=g[_a.type]||_a.type})}catch(_a){if(_a.name!=="TypeError")throw _a;ga.forEach((_u,_c)=>{ga.set(_c,Object.assign({},_u,{type:g[_u.type]||_u.type}))})}return ga}).then(_i,_o)}}function t2(d){if(typeof d!="object"||!d.RTCPeerConnection||!d.RTCRtpSender||d.RTCRtpSender&&"getStats"in d.RTCRtpSender.prototype)return;const h=d.RTCPeerConnection.prototype.getSenders;h&&(d.RTCPeerConnection.prototype.getSenders=function(){const j=h.apply(this,[]);return j.forEach(_t=>_t._pc=this),j});const g=d.RTCPeerConnection.prototype.addTrack;g&&(d.RTCPeerConnection.prototype.addTrack=function(){const j=g.apply(this,arguments);return j._pc=this,j}),d.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):a0.resolve(new Map)}}function n2(d){if(typeof d!="object"||!d.RTCPeerConnection||!d.RTCRtpSender||d.RTCRtpSender&&"getStats"in d.RTCRtpReceiver.prototype)return;const h=d.RTCPeerConnection.prototype.getReceivers;h&&(d.RTCPeerConnection.prototype.getReceivers=function(){const g=h.apply(this,[]);return g.forEach(j=>j._pc=this),g}),aO(d,"track",g=>(g.receiver._pc=g.srcElement,g)),d.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function r2(d){d.RTCPeerConnection&&!("removeStream"in d.RTCPeerConnection.prototype)&&(d.RTCPeerConnection.prototype.removeStream=function(h){y1("removeStream","removeTrack"),this.getSenders().forEach(g=>{g.track&&h.getTracks().includes(g.track)&&this.removeTrack(g)})})}function i2(d){d.DataChannel&&!d.RTCDataChannel&&(d.RTCDataChannel=d.DataChannel)}function o2(d){if(typeof d!="object"||!d.RTCPeerConnection)return;const h=d.RTCPeerConnection.prototype.addTransceiver;h&&(d.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let g=arguments[1]&&arguments[1].sendEncodings;g===void 0&&(g=[]),g=[...g];const j=g.length>0;j&&g.forEach(_i=>{if("rid"in _i&&!/^[a-z0-9]{0,16}$/i.test(_i.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in _i&&!(parseFloat(_i.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in _i&&!(parseFloat(_i.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const _t=h.apply(this,arguments);if(j){const{sender:_i}=_t,_o=_i.getParameters();(!("encodings"in _o)||_o.encodings.length===1&&Object.keys(_o.encodings[0]).length===0)&&(_o.encodings=g,_i.sendEncodings=g,this.setParametersPromises.push(_i.setParameters(_o).then(()=>{delete _i.sendEncodings}).catch(()=>{delete _i.sendEncodings})))}return _t})}function s2(d){if(typeof d!="object"||!d.RTCRtpSender)return;const h=d.RTCRtpSender.prototype.getParameters;h&&(d.RTCRtpSender.prototype.getParameters=function(){const g=h.apply(this,arguments);return"encodings"in g||(g.encodings=[].concat(this.sendEncodings||[{}])),g})}function a2(d){if(typeof d!="object"||!d.RTCPeerConnection)return;const h=d.RTCPeerConnection.prototype.createOffer;d.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?a0.all(this.setParametersPromises).then(()=>h.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):h.apply(this,arguments)}}function c2(d){if(typeof d!="object"||!d.RTCPeerConnection)return;const h=d.RTCPeerConnection.prototype.createAnswer;d.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?a0.all(this.setParametersPromises).then(()=>h.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):h.apply(this,arguments)}}var u2=Object.freeze({__proto__:null,shimOnTrack:e2,shimPeerConnection:h3,shimSenderGetStats:t2,shimReceiverGetStats:n2,shimRemoveStream:r2,shimRTCDataChannel:i2,shimAddTransceiver:o2,shimGetParameters:s2,shimCreateOffer:a2,shimCreateAnswer:c2,shimGetUserMedia:ZG,shimGetDisplayMedia:function(d,h){d.navigator.mediaDevices&&"getDisplayMedia"in d.navigator.mediaDevices||d.navigator.mediaDevices&&(d.navigator.mediaDevices.getDisplayMedia=function(g){if(!g||!g.video){const j=new DOMException("getDisplayMedia without video constraints is undefined");return j.name="NotFoundError",j.code=8,a0.reject(j)}return g.video===!0?g.video={mediaSource:h}:g.video.mediaSource=h,d.navigator.mediaDevices.getUserMedia(g)})}});function l2(d){if(typeof d=="object"&&d.RTCPeerConnection){if("getLocalStreams"in d.RTCPeerConnection.prototype||(d.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in d.RTCPeerConnection.prototype)){const h=d.RTCPeerConnection.prototype.addTrack;d.RTCPeerConnection.prototype.addStream=function(g){this._localStreams||(this._localStreams=[]),this._localStreams.includes(g)||this._localStreams.push(g),g.getAudioTracks().forEach(j=>h.call(this,j,g)),g.getVideoTracks().forEach(j=>h.call(this,j,g))},d.RTCPeerConnection.prototype.addTrack=function(g){for(var j=arguments.length,_t=new Array(j>1?j-1:0),_i=1;_i<j;_i++)_t[_i-1]=arguments[_i];return _t&&_t.forEach(_o=>{this._localStreams?this._localStreams.includes(_o)||this._localStreams.push(_o):this._localStreams=[_o]}),h.apply(this,arguments)}}"removeStream"in d.RTCPeerConnection.prototype||(d.RTCPeerConnection.prototype.removeStream=function(h){this._localStreams||(this._localStreams=[]);const g=this._localStreams.indexOf(h);if(g===-1)return;this._localStreams.splice(g,1);const j=h.getTracks();this.getSenders().forEach(_t=>{j.includes(_t.track)&&this.removeTrack(_t)})})}}function d2(d){if(typeof d=="object"&&d.RTCPeerConnection&&("getRemoteStreams"in d.RTCPeerConnection.prototype||(d.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in d.RTCPeerConnection.prototype))){Object.defineProperty(d.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(g){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=g),this.addEventListener("track",this._onaddstreampoly=j=>{j.streams.forEach(_t=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(_t))return;this._remoteStreams.push(_t);const _i=new Event("addstream");_i.stream=_t,this.dispatchEvent(_i)})})}});const h=d.RTCPeerConnection.prototype.setRemoteDescription;d.RTCPeerConnection.prototype.setRemoteDescription=function(){const g=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(j){j.streams.forEach(_t=>{if(g._remoteStreams||(g._remoteStreams=[]),g._remoteStreams.indexOf(_t)>=0)return;g._remoteStreams.push(_t);const _i=new Event("addstream");_i.stream=_t,g.dispatchEvent(_i)})}),h.apply(g,arguments)}}}function p2(d){if(typeof d!="object"||!d.RTCPeerConnection)return;const h=d.RTCPeerConnection.prototype,g=h.createOffer,j=h.createAnswer,_t=h.setLocalDescription,_i=h.setRemoteDescription,_o=h.addIceCandidate;h.createOffer=function(_a,_u){const _c=arguments.length>=2?arguments[2]:arguments[0],_l=g.apply(this,[_c]);return _u?(_l.then(_a,_u),a0.resolve()):_l},h.createAnswer=function(_a,_u){const _c=arguments.length>=2?arguments[2]:arguments[0],_l=j.apply(this,[_c]);return _u?(_l.then(_a,_u),a0.resolve()):_l};let ga=function(_a,_u,_c){const _l=_t.apply(this,[_a]);return _c?(_l.then(_u,_c),a0.resolve()):_l};h.setLocalDescription=ga,ga=function(_a,_u,_c){const _l=_i.apply(this,[_a]);return _c?(_l.then(_u,_c),a0.resolve()):_l},h.setRemoteDescription=ga,ga=function(_a,_u,_c){const _l=_o.apply(this,[_a]);return _c?(_l.then(_u,_c),a0.resolve()):_l},h.addIceCandidate=ga}function h2(d){const h=d&&d.navigator;if(h.mediaDevices&&h.mediaDevices.getUserMedia){const g=h.mediaDevices,j=g.getUserMedia.bind(g);h.mediaDevices.getUserMedia=_t=>j(f2(_t))}!h.getUserMedia&&h.mediaDevices&&h.mediaDevices.getUserMedia&&(h.getUserMedia=(function(g,j,_t){h.mediaDevices.getUserMedia(g).then(j,_t)}).bind(h))}function f2(d){return d&&d.video!==void 0?Object.assign({},d,{video:VP(d.video)}):d}function m2(d){if(!d.RTCPeerConnection)return;const h=d.RTCPeerConnection;d.RTCPeerConnection=function(g,j){if(g&&g.iceServers){const _t=[];for(let _i=0;_i<g.iceServers.length;_i++){let _o=g.iceServers[_i];!_o.hasOwnProperty("urls")&&_o.hasOwnProperty("url")?(y1("RTCIceServer.url","RTCIceServer.urls"),_o=JSON.parse(JSON.stringify(_o)),_o.urls=_o.url,delete _o.url,_t.push(_o)):_t.push(g.iceServers[_i])}g.iceServers=_t}return new h(g,j)},d.RTCPeerConnection.prototype=h.prototype,"generateCertificate"in h&&Object.defineProperty(d.RTCPeerConnection,"generateCertificate",{get:()=>h.generateCertificate})}function g2(d){typeof d=="object"&&d.RTCTrackEvent&&"receiver"in d.RTCTrackEvent.prototype&&!("transceiver"in d.RTCTrackEvent.prototype)&&Object.defineProperty(d.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function E2(d){const h=d.RTCPeerConnection.prototype.createOffer;d.RTCPeerConnection.prototype.createOffer=function(g){if(g){g.offerToReceiveAudio!==void 0&&(g.offerToReceiveAudio=!!g.offerToReceiveAudio);const j=this.getTransceivers().find(_i=>_i.receiver.track.kind==="audio");g.offerToReceiveAudio===!1&&j?j.direction==="sendrecv"?j.setDirection?j.setDirection("sendonly"):j.direction="sendonly":j.direction==="recvonly"&&(j.setDirection?j.setDirection("inactive"):j.direction="inactive"):g.offerToReceiveAudio!==!0||j||this.addTransceiver("audio",{direction:"recvonly"}),g.offerToReceiveVideo!==void 0&&(g.offerToReceiveVideo=!!g.offerToReceiveVideo);const _t=this.getTransceivers().find(_i=>_i.receiver.track.kind==="video");g.offerToReceiveVideo===!1&&_t?_t.direction==="sendrecv"?_t.setDirection?_t.setDirection("sendonly"):_t.direction="sendonly":_t.direction==="recvonly"&&(_t.setDirection?_t.setDirection("inactive"):_t.direction="inactive"):g.offerToReceiveVideo!==!0||_t||this.addTransceiver("video",{direction:"recvonly"})}return h.apply(this,arguments)}}function v2(d){typeof d!="object"||d.AudioContext||(d.AudioContext=d.webkitAudioContext)}var _2=Object.freeze({__proto__:null,shimLocalStreamsAPI:l2,shimRemoteStreamsAPI:d2,shimCallbacksAPI:p2,shimGetUserMedia:h2,shimConstraints:f2,shimRTCIceServerUrls:m2,shimTrackEventTransceiver:g2,shimCreateOfferLegacy:E2,shimAudioContext:v2}),UY=`	
\v\f\r \u2028\u2029\uFEFF`,FY=H_,BY=Z0,y2=ba("".replace),sU=`[	
\v\f\r \u2028\u2029\uFEFF]`,VY=RegExp("^"+sU+sU+"*"),GY=RegExp(sU+sU+"*$"),f3=function(d){return function(h){var g=BY(FY(h));return 1&d&&(g=y2(g,VY,"")),2&d&&(g=y2(g,GY,"")),g}},$Y={start:f3(1),end:f3(2),trim:f3(3)},WY=O6.PROPER,HY=_,b2=UY,qY=$Y.trim;PR({target:"String",proto:!0,forced:function(d){return HY(function(){return!!b2[d]()||""[d]()!==""||WY&&b2[d].name!==d})}("trim")},{trim:function(){return qY(this)}});var zY=UR("String").trim,KY=_p,YY=zY,m3=String.prototype,LO=function(d){var h=d.trim;return typeof d=="string"||d===m3||KY(m3,d)&&h===m3.trim?YY:h},g3={exports:{}};(function(d){const h={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};h.localCName=h.generateIdentifier(),h.splitLines=function(g){return LO(g).call(g).split(`
`).map(j=>LO(j).call(j))},h.splitSections=function(g){return g.split(`
m=`).map((j,_t)=>{var _i;return LO(_i=_t>0?"m="+j:j).call(_i)+`\r
`})},h.getDescription=function(g){const j=h.splitSections(g);return j&&j[0]},h.getMediaSections=function(g){const j=h.splitSections(g);return j.shift(),j},h.matchPrefix=function(g,j){return h.splitLines(g).filter(_t=>_t.indexOf(j)===0)},h.parseCandidate=function(g){let j;j=g.indexOf("a=candidate:")===0?g.substring(12).split(" "):g.substring(10).split(" ");const _t={foundation:j[0],component:{1:"rtp",2:"rtcp"}[j[1]]||j[1],protocol:j[2].toLowerCase(),priority:parseInt(j[3],10),ip:j[4],address:j[4],port:parseInt(j[5],10),type:j[7]};for(let _i=8;_i<j.length;_i+=2)switch(j[_i]){case"raddr":_t.relatedAddress=j[_i+1];break;case"rport":_t.relatedPort=parseInt(j[_i+1],10);break;case"tcptype":_t.tcpType=j[_i+1];break;case"ufrag":_t.ufrag=j[_i+1],_t.usernameFragment=j[_i+1];break;default:_t[j[_i]]===void 0&&(_t[j[_i]]=j[_i+1])}return _t},h.writeCandidate=function(g){const j=[];j.push(g.foundation);const _t=g.component;_t==="rtp"?j.push(1):_t==="rtcp"?j.push(2):j.push(_t),j.push(g.protocol.toUpperCase()),j.push(g.priority),j.push(g.address||g.ip),j.push(g.port);const _i=g.type;return j.push("typ"),j.push(_i),_i!=="host"&&g.relatedAddress&&g.relatedPort&&(j.push("raddr"),j.push(g.relatedAddress),j.push("rport"),j.push(g.relatedPort)),g.tcpType&&g.protocol.toLowerCase()==="tcp"&&(j.push("tcptype"),j.push(g.tcpType)),(g.usernameFragment||g.ufrag)&&(j.push("ufrag"),j.push(g.usernameFragment||g.ufrag)),"candidate:"+j.join(" ")},h.parseIceOptions=function(g){return g.substr(14).split(" ")},h.parseRtpMap=function(g){let j=g.substr(9).split(" ");const _t={payloadType:parseInt(j.shift(),10)};return j=j[0].split("/"),_t.name=j[0],_t.clockRate=parseInt(j[1],10),_t.channels=j.length===3?parseInt(j[2],10):1,_t.numChannels=_t.channels,_t},h.writeRtpMap=function(g){let j=g.payloadType;g.preferredPayloadType!==void 0&&(j=g.preferredPayloadType);const _t=g.channels||g.numChannels||1;return"a=rtpmap:"+j+" "+g.name+"/"+g.clockRate+(_t!==1?"/"+_t:"")+`\r
`},h.parseExtmap=function(g){const j=g.substr(9).split(" ");return{id:parseInt(j[0],10),direction:j[0].indexOf("/")>0?j[0].split("/")[1]:"sendrecv",uri:j[1]}},h.writeExtmap=function(g){return"a=extmap:"+(g.id||g.preferredId)+(g.direction&&g.direction!=="sendrecv"?"/"+g.direction:"")+" "+g.uri+`\r
`},h.parseFmtp=function(g){const j={};let _t;const _i=g.substr(g.indexOf(" ")+1).split(";");for(let _a=0;_a<_i.length;_a++){var _o,ga;_t=LO(_o=_i[_a]).call(_o).split("="),j[LO(ga=_t[0]).call(ga)]=_t[1]}return j},h.writeFmtp=function(g){let j="",_t=g.payloadType;if(g.preferredPayloadType!==void 0&&(_t=g.preferredPayloadType),g.parameters&&Object.keys(g.parameters).length){const _i=[];Object.keys(g.parameters).forEach(_o=>{g.parameters[_o]!==void 0?_i.push(_o+"="+g.parameters[_o]):_i.push(_o)}),j+="a=fmtp:"+_t+" "+_i.join(";")+`\r
`}return j},h.parseRtcpFb=function(g){const j=g.substr(g.indexOf(" ")+1).split(" ");return{type:j.shift(),parameter:j.join(" ")}},h.writeRtcpFb=function(g){let j="",_t=g.payloadType;return g.preferredPayloadType!==void 0&&(_t=g.preferredPayloadType),g.rtcpFeedback&&g.rtcpFeedback.length&&g.rtcpFeedback.forEach(_i=>{j+="a=rtcp-fb:"+_t+" "+_i.type+(_i.parameter&&_i.parameter.length?" "+_i.parameter:"")+`\r
`}),j},h.parseSsrcMedia=function(g){const j=g.indexOf(" "),_t={ssrc:parseInt(g.substr(7,j-7),10)},_i=g.indexOf(":",j);return _i>-1?(_t.attribute=g.substr(j+1,_i-j-1),_t.value=g.substr(_i+1)):_t.attribute=g.substr(j+1),_t},h.parseSsrcGroup=function(g){const j=g.substr(13).split(" ");return{semantics:j.shift(),ssrcs:j.map(_t=>parseInt(_t,10))}},h.getMid=function(g){const j=h.matchPrefix(g,"a=mid:")[0];if(j)return j.substr(6)},h.parseFingerprint=function(g){const j=g.substr(14).split(" ");return{algorithm:j[0].toLowerCase(),value:j[1].toUpperCase()}},h.getDtlsParameters=function(g,j){return{role:"auto",fingerprints:h.matchPrefix(g+j,"a=fingerprint:").map(h.parseFingerprint)}},h.writeDtlsParameters=function(g,j){let _t="a=setup:"+j+`\r
`;return g.fingerprints.forEach(_i=>{_t+="a=fingerprint:"+_i.algorithm+" "+_i.value+`\r
`}),_t},h.parseCryptoLine=function(g){const j=g.substr(9).split(" ");return{tag:parseInt(j[0],10),cryptoSuite:j[1],keyParams:j[2],sessionParams:j.slice(3)}},h.writeCryptoLine=function(g){return"a=crypto:"+g.tag+" "+g.cryptoSuite+" "+(typeof g.keyParams=="object"?h.writeCryptoKeyParams(g.keyParams):g.keyParams)+(g.sessionParams?" "+g.sessionParams.join(" "):"")+`\r
`},h.parseCryptoKeyParams=function(g){if(g.indexOf("inline:")!==0)return null;const j=g.substr(7).split("|");return{keyMethod:"inline",keySalt:j[0],lifeTime:j[1],mkiValue:j[2]?j[2].split(":")[0]:void 0,mkiLength:j[2]?j[2].split(":")[1]:void 0}},h.writeCryptoKeyParams=function(g){return g.keyMethod+":"+g.keySalt+(g.lifeTime?"|"+g.lifeTime:"")+(g.mkiValue&&g.mkiLength?"|"+g.mkiValue+":"+g.mkiLength:"")},h.getCryptoParameters=function(g,j){return h.matchPrefix(g+j,"a=crypto:").map(h.parseCryptoLine)},h.getIceParameters=function(g,j){const _t=h.matchPrefix(g+j,"a=ice-ufrag:")[0],_i=h.matchPrefix(g+j,"a=ice-pwd:")[0];return _t&&_i?{usernameFragment:_t.substr(12),password:_i.substr(10)}:null},h.writeIceParameters=function(g){let j="a=ice-ufrag:"+g.usernameFragment+`\r
a=ice-pwd:`+g.password+`\r
`;return g.iceLite&&(j+=`a=ice-lite\r
`),j},h.parseRtpParameters=function(g){const j={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},_t=h.splitLines(g)[0].split(" ");for(let _i=3;_i<_t.length;_i++){const _o=_t[_i],ga=h.matchPrefix(g,"a=rtpmap:"+_o+" ")[0];if(ga){const _a=h.parseRtpMap(ga),_u=h.matchPrefix(g,"a=fmtp:"+_o+" ");switch(_a.parameters=_u.length?h.parseFmtp(_u[0]):{},_a.rtcpFeedback=h.matchPrefix(g,"a=rtcp-fb:"+_o+" ").map(h.parseRtcpFb),j.codecs.push(_a),_a.name.toUpperCase()){case"RED":case"ULPFEC":j.fecMechanisms.push(_a.name.toUpperCase())}}}return h.matchPrefix(g,"a=extmap:").forEach(_i=>{j.headerExtensions.push(h.parseExtmap(_i))}),j},h.writeRtpDescription=function(g,j){let _t="";_t+="m="+g+" ",_t+=j.codecs.length>0?"9":"0",_t+=" UDP/TLS/RTP/SAVPF ",_t+=j.codecs.map(_o=>_o.preferredPayloadType!==void 0?_o.preferredPayloadType:_o.payloadType).join(" ")+`\r
`,_t+=`c=IN IP4 0.0.0.0\r
`,_t+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,j.codecs.forEach(_o=>{_t+=h.writeRtpMap(_o),_t+=h.writeFmtp(_o),_t+=h.writeRtcpFb(_o)});let _i=0;return j.codecs.forEach(_o=>{_o.maxptime>_i&&(_i=_o.maxptime)}),_i>0&&(_t+="a=maxptime:"+_i+`\r
`),j.headerExtensions&&j.headerExtensions.forEach(_o=>{_t+=h.writeExtmap(_o)}),_t},h.parseRtpEncodingParameters=function(g){const j=[],_t=h.parseRtpParameters(g),_i=_t.fecMechanisms.indexOf("RED")!==-1,_o=_t.fecMechanisms.indexOf("ULPFEC")!==-1,ga=h.matchPrefix(g,"a=ssrc:").map(_g=>h.parseSsrcMedia(_g)).filter(_g=>_g.attribute==="cname"),_a=ga.length>0&&ga[0].ssrc;let _u;const _c=h.matchPrefix(g,"a=ssrc-group:FID").map(_g=>_g.substr(17).split(" ").map(r_=>parseInt(r_,10)));_c.length>0&&_c[0].length>1&&_c[0][0]===_a&&(_u=_c[0][1]),_t.codecs.forEach(_g=>{if(_g.name.toUpperCase()==="RTX"&&_g.parameters.apt){let r_={ssrc:_a,codecPayloadType:parseInt(_g.parameters.apt,10)};_a&&_u&&(r_.rtx={ssrc:_u}),j.push(r_),_i&&(r_=JSON.parse(JSON.stringify(r_)),r_.fec={ssrc:_a,mechanism:_o?"red+ulpfec":"red"},j.push(r_))}}),j.length===0&&_a&&j.push({ssrc:_a});let _l=h.matchPrefix(g,"b=");return _l.length&&(_l=_l[0].indexOf("b=TIAS:")===0?parseInt(_l[0].substr(7),10):_l[0].indexOf("b=AS:")===0?1e3*parseInt(_l[0].substr(5),10)*.95-16e3:void 0,j.forEach(_g=>{_g.maxBitrate=_l})),j},h.parseRtcpParameters=function(g){const j={},_t=h.matchPrefix(g,"a=ssrc:").map(ga=>h.parseSsrcMedia(ga)).filter(ga=>ga.attribute==="cname")[0];_t&&(j.cname=_t.value,j.ssrc=_t.ssrc);const _i=h.matchPrefix(g,"a=rtcp-rsize");j.reducedSize=_i.length>0,j.compound=_i.length===0;const _o=h.matchPrefix(g,"a=rtcp-mux");return j.mux=_o.length>0,j},h.writeRtcpParameters=function(g){let j="";return g.reducedSize&&(j+=`a=rtcp-rsize\r
`),g.mux&&(j+=`a=rtcp-mux\r
`),g.ssrc!==void 0&&g.cname&&(j+="a=ssrc:"+g.ssrc+" cname:"+g.cname+`\r
`),j},h.parseMsid=function(g){let j;const _t=h.matchPrefix(g,"a=msid:");if(_t.length===1)return j=_t[0].substr(7).split(" "),{stream:j[0],track:j[1]};const _i=h.matchPrefix(g,"a=ssrc:").map(_o=>h.parseSsrcMedia(_o)).filter(_o=>_o.attribute==="msid");return _i.length>0?(j=_i[0].value.split(" "),{stream:j[0],track:j[1]}):void 0},h.parseSctpDescription=function(g){const j=h.parseMLine(g),_t=h.matchPrefix(g,"a=max-message-size:");let _i;_t.length>0&&(_i=parseInt(_t[0].substr(19),10)),isNaN(_i)&&(_i=65536);const _o=h.matchPrefix(g,"a=sctp-port:");if(_o.length>0)return{port:parseInt(_o[0].substr(12),10),protocol:j.fmt,maxMessageSize:_i};const ga=h.matchPrefix(g,"a=sctpmap:");if(ga.length>0){const _a=ga[0].substr(10).split(" ");return{port:parseInt(_a[0],10),protocol:_a[1],maxMessageSize:_i}}},h.writeSctpDescription=function(g,j){let _t=[];return _t=g.protocol!=="DTLS/SCTP"?["m="+g.kind+" 9 "+g.protocol+" "+j.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+j.port+`\r
`]:["m="+g.kind+" 9 "+g.protocol+" "+j.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+j.port+" "+j.protocol+` 65535\r
`],j.maxMessageSize!==void 0&&_t.push("a=max-message-size:"+j.maxMessageSize+`\r
`),_t.join("")},h.generateSessionId=function(){return Math.random().toString().substr(2,21)},h.writeSessionBoilerplate=function(g,j,_t){let _i;const _o=j!==void 0?j:2;return _i=g||h.generateSessionId(),`v=0\r
o=`+(_t||"thisisadapterortc")+" "+_i+" "+_o+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},h.getDirection=function(g,j){const _t=h.splitLines(g);for(let _i=0;_i<_t.length;_i++)switch(_t[_i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return _t[_i].substr(2)}return j?h.getDirection(j):"sendrecv"},h.getKind=function(g){return h.splitLines(g)[0].split(" ")[0].substr(2)},h.isRejected=function(g){return g.split(" ",2)[1]==="0"},h.parseMLine=function(g){const j=h.splitLines(g)[0].substr(2).split(" ");return{kind:j[0],port:parseInt(j[1],10),protocol:j[2],fmt:j.slice(3).join(" ")}},h.parseOLine=function(g){const j=h.matchPrefix(g,"o=")[0].substr(2).split(" ");return{username:j[0],sessionId:j[1],sessionVersion:parseInt(j[2],10),netType:j[3],addressType:j[4],address:j[5]}},h.isValidSDP=function(g){if(typeof g!="string"||g.length===0)return!1;const j=h.splitLines(g);for(let _t=0;_t<j.length;_t++)if(j[_t].length<2||j[_t].charAt(1)!=="=")return!1;return!0},d.exports=h})(g3);var V1=g3.exports,JY=Object.freeze(s({__proto__:null,default:V1},[g3.exports]));function aU(d){if(!d.RTCIceCandidate||d.RTCIceCandidate&&"foundation"in d.RTCIceCandidate.prototype)return;const h=d.RTCIceCandidate;d.RTCIceCandidate=function(g){if(typeof g=="object"&&g.candidate&&g.candidate.indexOf("a=")===0&&((g=JSON.parse(JSON.stringify(g))).candidate=g.candidate.substr(2)),g.candidate&&g.candidate.length){const j=new h(g),_t=V1.parseCandidate(g.candidate),_i=Object.assign(j,_t);return _i.toJSON=function(){return{candidate:_i.candidate,sdpMid:_i.sdpMid,sdpMLineIndex:_i.sdpMLineIndex,usernameFragment:_i.usernameFragment}},_i}return new h(g)},d.RTCIceCandidate.prototype=h.prototype,aO(d,"icecandidate",g=>(g.candidate&&Object.defineProperty(g,"candidate",{value:new d.RTCIceCandidate(g.candidate),writable:"false"}),g))}function E3(d){!d.RTCIceCandidate||d.RTCIceCandidate&&"relayProtocol"in d.RTCIceCandidate.prototype||aO(d,"icecandidate",h=>{if(h.candidate){const g=V1.parseCandidate(h.candidate.candidate);g.type==="relay"&&(h.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[g.priority>>24])}return h})}function cU(d,h){if(!d.RTCPeerConnection)return;"sctp"in d.RTCPeerConnection.prototype||Object.defineProperty(d.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const g=function(ga){if(!ga||!ga.sdp)return!1;const _a=V1.splitSections(ga.sdp);return _a.shift(),_a.some(_u=>{const _c=V1.parseMLine(_u);return _c&&_c.kind==="application"&&_c.protocol.indexOf("SCTP")!==-1})},j=function(ga){const _a=ga.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(_a===null||_a.length<2)return-1;const _u=parseInt(_a[1],10);return _u!=_u?-1:_u},_t=function(ga){let _a=65536;return h.browser==="firefox"&&(_a=h.version<57?ga===-1?16384:2147483637:h.version<60?h.version===57?65535:65536:2147483637),_a},_i=function(ga,_a){let _u=65536;h.browser==="firefox"&&h.version===57&&(_u=65535);const _c=V1.matchPrefix(ga.sdp,"a=max-message-size:");return _c.length>0?_u=parseInt(_c[0].substr(19),10):h.browser==="firefox"&&_a!==-1&&(_u=2147483637),_u},_o=d.RTCPeerConnection.prototype.setRemoteDescription;d.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,h.browser==="chrome"&&h.version>=76){const{sdpSemantics:ga}=this.getConfiguration();ga==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(g(arguments[0])){const ga=j(arguments[0]),_a=_t(ga),_u=_i(arguments[0],ga);let _c;_c=_a===0&&_u===0?Number.POSITIVE_INFINITY:_a===0||_u===0?Math.max(_a,_u):Math.min(_a,_u);const _l={};Object.defineProperty(_l,"maxMessageSize",{get:()=>_c}),this._sctp=_l}return _o.apply(this,arguments)}}function uU(d){if(!d.RTCPeerConnection||!("createDataChannel"in d.RTCPeerConnection.prototype))return;function h(j,_t){const _i=j.send;j.send=function(){const _o=arguments[0],ga=_o.length||_o.size||_o.byteLength;if(j.readyState==="open"&&_t.sctp&&ga>_t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+_t.sctp.maxMessageSize+" bytes)");return _i.apply(j,arguments)}}const g=d.RTCPeerConnection.prototype.createDataChannel;d.RTCPeerConnection.prototype.createDataChannel=function(){const j=g.apply(this,arguments);return h(j,this),j},aO(d,"datachannel",j=>(h(j.channel,j.target),j))}function v3(d){if(!d.RTCPeerConnection||"connectionState"in d.RTCPeerConnection.prototype)return;const h=d.RTCPeerConnection.prototype;Object.defineProperty(h,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(h,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(g){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),g&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=g)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(g=>{const j=h[g];h[g]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=_t=>{const _i=_t.target;if(_i._lastConnectionState!==_i.connectionState){_i._lastConnectionState=_i.connectionState;const _o=new Event("connectionstatechange",_t);_i.dispatchEvent(_o)}return _t},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),j.apply(this,arguments)}})}function _3(d,h){if(!d.RTCPeerConnection||h.browser==="chrome"&&h.version>=71||h.browser==="safari"&&h.version>=605)return;const g=d.RTCPeerConnection.prototype.setRemoteDescription;d.RTCPeerConnection.prototype.setRemoteDescription=function(j){if(j&&j.sdp&&j.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const _t=j.sdp.split(`
`).filter(_i=>LO(_i).call(_i)!=="a=extmap-allow-mixed").join(`
`);d.RTCSessionDescription&&j instanceof d.RTCSessionDescription?arguments[0]=new d.RTCSessionDescription({type:j.type,sdp:_t}):j.sdp=_t}return g.apply(this,arguments)}}function lU(d,h){if(!d.RTCPeerConnection||!d.RTCPeerConnection.prototype)return;const g=d.RTCPeerConnection.prototype.addIceCandidate;g&&g.length!==0&&(d.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(h.browser==="chrome"&&h.version<78||h.browser==="firefox"&&h.version<68||h.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?a0.resolve():g.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),a0.resolve())})}function dU(d,h){if(!d.RTCPeerConnection||!d.RTCPeerConnection.prototype)return;const g=d.RTCPeerConnection.prototype.setLocalDescription;g&&g.length!==0&&(d.RTCPeerConnection.prototype.setLocalDescription=function(){let j=arguments[0]||{};if(typeof j!="object"||j.type&&j.sdp)return g.apply(this,arguments);if(j={type:j.type,sdp:j.sdp},!j.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":j.type="offer";break;default:j.type="answer"}return j.sdp||j.type!=="offer"&&j.type!=="answer"?g.apply(this,[j]):(j.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(_i=>g.apply(this,[_i]))})}var XY=Object.freeze({__proto__:null,shimRTCIceCandidate:aU,shimRTCIceCandidateRelayProtocol:E3,shimMaxMessageSize:cU,shimSendThrowTypeError:uU,shimConnectionState:v3,removeExtmapAllowMixed:_3,shimAddIceCandidateNullOrEmpty:lU,shimParameterlessSetLocalDescription:dU});let VR,dS;(function(){let{window:d}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const g=BP,j=mM(d),_t={browserDetails:j,commonShim:XY,extractVersion:_1,disableLog:KF,disableWarnings:YF,sdp:JY};switch(j.browser){case"chrome":if(!QG||!p3||!h.shimChrome)return g("Chrome shim is not included in this adapter release."),_t;if(j.version===null)return g("Chrome shim can not determine version, not shimming."),_t;g("adapter.js shimming chrome."),_t.browserShim=QG,lU(d,j),dU(d),$G(d,j),WG(d),p3(d,j),HG(d),JG(d,j),qG(d),zG(d),KG(d),XG(d,j),aU(d),E3(d),v3(d),cU(d,j),uU(d),_3(d,j);break;case"firefox":if(!u2||!h3||!h.shimFirefox)return g("Firefox shim is not included in this adapter release."),_t;g("adapter.js shimming firefox."),_t.browserShim=u2,lU(d,j),dU(d),ZG(d,j),h3(d,j),e2(d),r2(d),t2(d),n2(d),i2(d),o2(d),s2(d),a2(d),c2(d),aU(d),v3(d),cU(d,j),uU(d);break;case"safari":if(!_2||!h.shimSafari)return g("Safari shim is not included in this adapter release."),_t;g("adapter.js shimming safari."),_t.browserShim=_2,lU(d,j),dU(d),m2(d),E2(d),p2(d),l2(d),d2(d),g2(d),h2(d),v2(d),aU(d),E3(d),cU(d,j),uU(d),_3(d,j);break;default:g("Unsupported browser!")}})({window:typeof window>"u"?void 0:window}),function(d){d.WIN_10="Windows 10",d.WIN_81="Windows 8.1",d.WIN_8="Windows 8",d.WIN_7="Windows 7",d.WIN_VISTA="Windows Vista",d.WIN_SERVER_2003="Windows Server 2003",d.WIN_XP="Windows XP",d.WIN_2000="Windows 2000",d.ANDROID="Android",d.HARMONY_OS="HarmonyOS",d.OPEN_BSD="Open BSD",d.SUN_OS="Sun OS",d.LINUX="Linux",d.IOS="iOS",d.MAC_OS="Mac OS",d.QNX="QNX",d.UNIX="UNIX",d.BEOS="BeOS",d.OS_2="OS/2",d.SEARCH_BOT="Search Bot"}(VR||(VR={})),function(d){d.CHROME="Chrome",d.SAFARI="Safari",d.EDGE="Edge",d.FIREFOX="Firefox",d.OPERA="OPR",d.QQ="QQBrowser",d.WECHAT="MicroMessenger"}(dS||(dS={}));var y3={exports:{}};(function(d,h){(function(g,j){var _t="function",_i="undefined",_o="object",ga="string",_a="major",_u="model",_c="name",_l="type",_g="vendor",r_="version",l_="architecture",d_="console",p_="mobile",C_="tablet",O_="smarttv",q_="wearable",c0="embedded",K_="Amazon",Q_="Apple",$_="ASUS",_b="BlackBerry",iS="Firefox",y0="Google",TS="Huawei",hS="LG",eR="Microsoft",MR="Motorola",XS="Opera",AT="Samsung",L_="Sharp",z_="Sony",r0="Xiaomi",O0="Zebra",eS="Facebook",Z_="Chromium OS",_m="Mac OS",h_=function(zS){for(var lR={},_S=0;_S<zS.length;_S++)lR[zS[_S].toUpperCase()]=zS[_S];return lR},E_=function(zS,lR){return typeof zS===ga&&B_(lR).indexOf(B_(zS))!==-1},B_=function(zS){return zS.toLowerCase()},D0=function(zS,lR){if(typeof zS===ga)return zS=zS.replace(/^\s\s*/,""),typeof lR===_i?zS:zS.substring(0,350)},wS=function(zS,lR){for(var _S,yT,yO,KS,X0,NT,TN=0;TN<lR.length&&!X0;){var nO=lR[TN],m7=lR[TN+1];for(_S=yT=0;_S<nO.length&&!X0&&nO[_S];)if(X0=nO[_S++].exec(zS))for(yO=0;yO<m7.length;yO++)NT=X0[++yT],typeof(KS=m7[yO])===_o&&KS.length>0?KS.length===2?typeof KS[1]==_t?this[KS[0]]=KS[1].call(this,NT):this[KS[0]]=KS[1]:KS.length===3?typeof KS[1]!==_t||KS[1].exec&&KS[1].test?this[KS[0]]=NT?NT.replace(KS[1],KS[2]):j:this[KS[0]]=NT?KS[1].call(this,NT,KS[2]):j:KS.length===4&&(this[KS[0]]=NT?KS[3].call(this,NT.replace(KS[1],KS[2])):j):this[KS]=NT||j;TN+=2}},jR=function(zS,lR){for(var _S in lR)if(typeof lR[_S]===_o&&lR[_S].length>0){for(var yT=0;yT<lR[_S].length;yT++)if(E_(lR[_S][yT],zS))return _S==="?"?j:_S}else if(E_(lR[_S],zS))return _S==="?"?j:_S;return zS},jI={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},SN={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[r_,[_c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[r_,[_c,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[_c,r_],[/opios[\/ ]+([\w\.]+)/i],[r_,[_c,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[r_,[_c,XS]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[_c,r_],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[r_,[_c,"UCBrowser"]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[r_,[_c,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[r_,[_c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[r_,[_c,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[r_,[_c,"IE"]],[/yabrowser\/([\w\.]+)/i],[r_,[_c,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[_c,/(.+)/,"$1 Secure Browser"],r_],[/\bfocus\/([\w\.]+)/i],[r_,[_c,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[r_,[_c,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[r_,[_c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[r_,[_c,"Dolphin"]],[/coast\/([\w\.]+)/i],[r_,[_c,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[r_,[_c,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[r_,[_c,iS]],[/\bqihu|(qi?ho?o?|360)browser/i],[[_c,"360 Browser"]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[_c,/(.+)/,"$1 Browser"],r_],[/(comodo_dragon)\/([\w\.]+)/i],[[_c,/_/g," "],r_],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[_c,r_],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[_c],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[_c,eS],r_],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[_c,r_],[/\bgsa\/([\w\.]+) .*safari\//i],[r_,[_c,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[r_,[_c,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[_c,"Chrome WebView"],r_],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[r_,[_c,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[_c,r_],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[r_,[_c,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[r_,_c],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[_c,[r_,jR,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[_c,r_],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[_c,"Netscape"],r_],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[r_,[_c,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[_c,r_],[/(cobalt)\/([\w\.]+)/i],[_c,[r_,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[l_,"amd64"]],[/(ia32(?=;))/i],[[l_,B_]],[/((?:i[346]|x)86)[;\)]/i],[[l_,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[l_,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[l_,"armhf"]],[/windows (ce|mobile); ppc;/i],[[l_,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[l_,/ower/,"",B_]],[/(sun4\w)[;\)]/i],[[l_,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[l_,B_]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[_u,[_g,AT],[_l,C_]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[_u,[_g,AT],[_l,p_]],[/\((ip(?:hone|od)[\w ]*);/i],[_u,[_g,Q_],[_l,p_]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[_u,[_g,Q_],[_l,C_]],[/(macintosh);/i],[_u,[_g,Q_]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[_u,[_g,L_],[_l,p_]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[_u,[_g,TS],[_l,C_]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[_u,[_g,TS],[_l,p_]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[_u,/_/g," "],[_g,r0],[_l,p_]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[_u,/_/g," "],[_g,r0],[_l,C_]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[_u,[_g,"OPPO"],[_l,p_]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[_u,[_g,"Vivo"],[_l,p_]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[_u,[_g,"Realme"],[_l,p_]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[_u,[_g,MR],[_l,p_]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[_u,[_g,MR],[_l,C_]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[_u,[_g,hS],[_l,C_]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[_u,[_g,hS],[_l,p_]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[_u,[_g,"Lenovo"],[_l,C_]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[_u,/_/g," "],[_g,"Nokia"],[_l,p_]],[/(pixel c)\b/i],[_u,[_g,y0],[_l,C_]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[_u,[_g,y0],[_l,p_]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[_u,[_g,z_],[_l,p_]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[_u,"Xperia Tablet"],[_g,z_],[_l,C_]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[_u,[_g,"OnePlus"],[_l,p_]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[_u,[_g,K_],[_l,C_]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[_u,/(.+)/g,"Fire Phone $1"],[_g,K_],[_l,p_]],[/(playbook);[-\w\),; ]+(rim)/i],[_u,_g,[_l,C_]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[_u,[_g,_b],[_l,p_]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[_u,[_g,$_],[_l,C_]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[_u,[_g,$_],[_l,p_]],[/(nexus 9)/i],[_u,[_g,"HTC"],[_l,C_]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[_g,[_u,/_/g," "],[_l,p_]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[_u,[_g,"Acer"],[_l,C_]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[_u,[_g,"Meizu"],[_l,p_]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[_g,_u,[_l,p_]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[_g,_u,[_l,C_]],[/(surface duo)/i],[_u,[_g,eR],[_l,C_]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[_u,[_g,"Fairphone"],[_l,p_]],[/(u304aa)/i],[_u,[_g,"AT&T"],[_l,p_]],[/\bsie-(\w*)/i],[_u,[_g,"Siemens"],[_l,p_]],[/\b(rct\w+) b/i],[_u,[_g,"RCA"],[_l,C_]],[/\b(venue[\d ]{2,7}) b/i],[_u,[_g,"Dell"],[_l,C_]],[/\b(q(?:mv|ta)\w+) b/i],[_u,[_g,"Verizon"],[_l,C_]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[_u,[_g,"Barnes & Noble"],[_l,C_]],[/\b(tm\d{3}\w+) b/i],[_u,[_g,"NuVision"],[_l,C_]],[/\b(k88) b/i],[_u,[_g,"ZTE"],[_l,C_]],[/\b(nx\d{3}j) b/i],[_u,[_g,"ZTE"],[_l,p_]],[/\b(gen\d{3}) b.+49h/i],[_u,[_g,"Swiss"],[_l,p_]],[/\b(zur\d{3}) b/i],[_u,[_g,"Swiss"],[_l,C_]],[/\b((zeki)?tb.*\b) b/i],[_u,[_g,"Zeki"],[_l,C_]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[_g,"Dragon Touch"],_u,[_l,C_]],[/\b(ns-?\w{0,9}) b/i],[_u,[_g,"Insignia"],[_l,C_]],[/\b((nxa|next)-?\w{0,9}) b/i],[_u,[_g,"NextBook"],[_l,C_]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[_g,"Voice"],_u,[_l,p_]],[/\b(lvtel\-)?(v1[12]) b/i],[[_g,"LvTel"],_u,[_l,p_]],[/\b(ph-1) /i],[_u,[_g,"Essential"],[_l,p_]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[_u,[_g,"Envizen"],[_l,C_]],[/\b(trio[-\w\. ]+) b/i],[_u,[_g,"MachSpeed"],[_l,C_]],[/\btu_(1491) b/i],[_u,[_g,"Rotor"],[_l,C_]],[/(shield[\w ]+) b/i],[_u,[_g,"Nvidia"],[_l,C_]],[/(sprint) (\w+)/i],[_g,_u,[_l,p_]],[/(kin\.[onetw]{3})/i],[[_u,/\./g," "],[_g,eR],[_l,p_]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[_u,[_g,O0],[_l,C_]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[_u,[_g,O0],[_l,p_]],[/smart-tv.+(samsung)/i],[_g,[_l,O_]],[/hbbtv.+maple;(\d+)/i],[[_u,/^/,"SmartTV"],[_g,AT],[_l,O_]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[_g,hS],[_l,O_]],[/(apple) ?tv/i],[_g,[_u,"Apple TV"],[_l,O_]],[/crkey/i],[[_u,"Chromecast"],[_g,y0],[_l,O_]],[/droid.+aft(\w)( bui|\))/i],[_u,[_g,K_],[_l,O_]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[_u,[_g,L_],[_l,O_]],[/(bravia[\w ]+)( bui|\))/i],[_u,[_g,z_],[_l,O_]],[/(mitv-\w{5}) bui/i],[_u,[_g,r0],[_l,O_]],[/Hbbtv.*(technisat) (.*);/i],[_g,_u,[_l,O_]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[_g,D0],[_u,D0],[_l,O_]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[_l,O_]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[_g,_u,[_l,d_]],[/droid.+; (shield) bui/i],[_u,[_g,"Nvidia"],[_l,d_]],[/(playstation [345portablevi]+)/i],[_u,[_g,z_],[_l,d_]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[_u,[_g,eR],[_l,d_]],[/((pebble))app/i],[_g,_u,[_l,q_]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[_u,[_g,Q_],[_l,q_]],[/droid.+; (glass) \d/i],[_u,[_g,y0],[_l,q_]],[/droid.+; (wt63?0{2,3})\)/i],[_u,[_g,O0],[_l,q_]],[/(quest( 2| pro)?)/i],[_u,[_g,eS],[_l,q_]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[_g,[_l,c0]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[_u,[_l,p_]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[_u,[_l,C_]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[_l,C_]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[_l,p_]],[/(android[-\w\. ]{0,9});.+buil/i],[_u,[_g,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[r_,[_c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[r_,[_c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[_c,r_],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[r_,_c]],os:[[/microsoft (windows) (vista|xp)/i],[_c,r_],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[_c,[r_,jR,jI]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[_c,"Windows"],[r_,jR,jI]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[r_,/_/g,"."],[_c,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[_c,_m],[r_,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[r_,_c],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[_c,r_],[/\(bb(10);/i],[r_,[_c,_b]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[r_,[_c,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[r_,[_c,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[r_,[_c,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[r_,[_c,"watchOS"]],[/crkey\/([\d\.]+)/i],[r_,[_c,"Chromecast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[_c,Z_],r_],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[_c,r_],[/(sunos) ?([\w\.\d]*)/i],[[_c,"Solaris"],r_],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[_c,r_]]},yI=function(zS,lR){if(typeof zS===_o&&(lR=zS,zS=j),!(this instanceof yI))return new yI(zS,lR).getResult();var _S=typeof g!==_i&&g.navigator?g.navigator:j,yT=zS||(_S&&_S.userAgent?_S.userAgent:""),yO=_S&&_S.userAgentData?_S.userAgentData:j,KS=lR?function(X0,NT){var TN={};for(var nO in X0)NT[nO]&&NT[nO].length%2==0?TN[nO]=NT[nO].concat(X0[nO]):TN[nO]=X0[nO];return TN}(SN,lR):SN;return this.getBrowser=function(){var X0={};return X0.name=j,X0.version=j,wS.call(X0,yT,KS.browser),X0.major=function(NT){return typeof NT===ga?NT.replace(/[^\d\.]/g,"").split(".")[0]:j}(X0.version),_S&&_S.brave&&typeof _S.brave.isBrave==_t&&(X0.name="Brave"),X0},this.getCPU=function(){var X0={};return X0.architecture=j,wS.call(X0,yT,KS.cpu),X0},this.getDevice=function(){var X0={};return X0.vendor=j,X0.model=j,X0.type=j,wS.call(X0,yT,KS.device),!X0.type&&yO&&yO.mobile&&(X0.type=p_),X0.model=="Macintosh"&&_S&&typeof _S.standalone!==_i&&_S.maxTouchPoints&&_S.maxTouchPoints>2&&(X0.model="iPad",X0.type=C_),X0},this.getEngine=function(){var X0={};return X0.name=j,X0.version=j,wS.call(X0,yT,KS.engine),X0},this.getOS=function(){var X0={};return X0.name=j,X0.version=j,wS.call(X0,yT,KS.os),!X0.name&&yO&&yO.platform!="Unknown"&&(X0.name=yO.platform.replace(/chrome os/i,Z_).replace(/macos/i,_m)),X0},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return yT},this.setUA=function(X0){return yT=typeof X0===ga&&X0.length>350?D0(X0,350):X0,this},this.setUA(yT),this};yI.VERSION="0.7.34",yI.BROWSER=h_([_c,r_,_a]),yI.CPU=h_([l_]),yI.DEVICE=h_([_u,_g,_l,d_,p_,O_,C_,q_,c0]),yI.ENGINE=yI.OS=h_([_c,r_]),d.exports&&(h=d.exports=yI),h.UAParser=yI;var RN=typeof g!==_i&&(g.jQuery||g.Zepto);if(RN&&!RN.ua){var EP=new yI;RN.ua=EP.getResult(),RN.ua.get=function(){return EP.getUA()},RN.ua.set=function(zS){EP.setUA(zS);var lR=EP.getResult();for(var _S in lR)RN.ua[_S]=lR[_S]}}})(typeof window=="object"?window:a)})(y3,y3.exports);const b3=new y3.exports;let S3,RT,MO=b3.getResult(),R3=null;function sS(d){if(!R3){d&&b3.setUA(d),MO=b3.getResult();const h=function(_i){if(_i.engine.name==="Blink"&&_i.browser.name!=="WeChat")return dS.CHROME;switch(_i.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return dS.CHROME;case"Safari":case"Mobile Safari":return dS.SAFARI;case"Edge":return dS.EDGE;case"Firefox":return dS.FIREFOX;case"QQBrowser":return dS.QQ;case"Opera":return dS.OPERA;case"WeChat":return dS.WECHAT;default:return _i.browser.name||""}}(MO),g=function(_i){let _o;return _o=_i.engine.name==="Blink"?_i.engine.version||"":_i.browser.version||"",_o.split(".")[0]}(MO),j=function(_i){switch(_i.os.name){case"Windows":return _i.os.version?_i.os.name+" "+_i.os.version:_i.os.name;default:return _i.os.name||""}}(MO),_t=MO.os.version;if(!(h&&g&&j&&_t))return{name:h,version:g,os:j,osVersion:_t};R3={name:h,version:g,os:j,osVersion:_t}}return R3}function S2(){return sS().os}function R2(){const d=sS();return"".concat(d.os," ").concat(d.osVersion)}function pU(){const d=sS();return!!(MO.engine.name==="WebKit"&&d.os===VR.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&d.name!==dS.SAFARI||aT()&&d.name!==dS.SAFARI)}function QY(){const d=sS();if(pU()){if(d.os===VR.MAC_OS)return!0;if(d.os===VR.IOS){const h=MO.os.version&&MO.os.version.split(".");if(h&&Number(h[0])===14&&h[1]&&Number(h[1])>=3||h&&Number(h[0])>14)return!0}}return!1}function ZY(){return MO.engine.name==="WebKit"}function T3(){return sS().name===dS.CHROME}function sT(){return sS().name===dS.SAFARI}function GS(){return sS().name===dS.FIREFOX}function aT(){return sS().os===VR.IOS}function w3(d){const h=sS();return!(h.name!==dS.CHROME||!h.osVersion)&&Number(h.version)>=d}function T2(d){const h=sS();return!(h.name!==dS.EDGE||!h.osVersion)&&Number(h.version)>=d}function w2(d){const h=sS();return!(h.name!==dS.OPERA||!h.osVersion)&&Number(h.version)>=d}function C2(){const d=sS();return!(d.name!==dS.CHROME||!d.osVersion)&&Number(d.version)<=90}function I2(){const d=sS();if(d.os!==VR.IOS||!d.osVersion)return!1;const h=d.osVersion.split(".");return Number(h[0])<14||Number(h[0])===14&&Number(h[1])<=6}function G1(){const d=sS();if(d.os!==VR.IOS||!d.osVersion)return!1;const h=d.osVersion.split(".");return Number(h[0])===15}function C3(){const d=sS();if(d.os!==VR.IOS||!d.osVersion)return!1;const h=d.osVersion.split(".");return Number(h[0])===16}function O2(){const d=sS();if(d.os!==VR.IOS||!d.osVersion)return!1;const h=d.osVersion.split(".");return Number(h[0])===15&&Number(h[1])>=1}function hO(){return sT()&&navigator.maxTouchPoints>0}function A2(){return sS().name===dS.WECHAT}function N2(){return window.navigator.appVersion&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)!==null&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function YN(){const d=sS();return d.name===dS.EDGE||d.name===dS.SAFARI?!1:!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function hU(){return S2()===VR.ANDROID}function uL(){const d=sS();return hU()&&(d.name===dS.CHROME||d.name===dS.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}(function(d){d.L1T1="L1T1",d.L1T2="L1T2",d.L1T3="L1T3",d.L2T1_KEY="L2T1_KEY",d.L2T2_KEY="L2T2_KEY",d.L2T3_KEY="L2T3_KEY",d.L3T1_KEY="L3T1_KEY",d.L3T2_KEY="L3T2_KEY",d.L3T3_KEY="L3T3_KEY"})(S3||(S3={})),function(d){d.CERTIFICATE="certificate",d.CODEC="codec",d.CANDIDATE_PAIR="candidate-pair",d.LOCAL_CANDIDATE="local-candidate",d.REMOTE_CANDIDATE="remote-candidate",d.INBOUND="inbound-rtp",d.TRACK="track",d.OUTBOUND="outbound-rtp",d.PC="peer-connection",d.REMOTE_INBOUND="remote-inbound-rtp",d.REMOTE_OUTBOUND="remote-outbound-rtp",d.TRANSPORT="transport",d.CSRC="csrc",d.DATA_CHANNEL="data-channel",d.STREAM="stream",d.SENDER="sender",d.RECEIVER="receiver"}(RT||(RT={}));var k2={exports:{}},eJ=PR,tJ=w_,P2=oI.f;eJ({target:"Object",stat:!0,forced:Object.defineProperty!==P2,sham:!tJ},{defineProperty:P2});var x2=s0.Object,nJ=k2.exports=function(d,h,g){return x2.defineProperty(d,h,g)};x2.defineProperty.sham&&(nJ.sham=!0);var D2=k2.exports;function _h(d,h,g){return h in d?D2(d,h,{value:g,enumerable:!0,configurable:!0,writable:!0}):d[h]=g,d}var I3,O3={exports:{}},L2=function(d,h){return function(){for(var g=new Array(arguments.length),j=0;j<g.length;j++)g[j]=arguments[j];return d.apply(h,g)}},rJ=L2,A3=Object.prototype.toString,N3=(I3=Object.create(null),function(d){var h=A3.call(d);return I3[h]||(I3[h]=h.slice(8,-1).toLowerCase())});function JN(d){return d=d.toLowerCase(),function(h){return N3(h)===d}}function k3(d){return Array.isArray(d)}function fU(d){return d===void 0}var M2=JN("ArrayBuffer");function j2(d){return d!==null&&typeof d=="object"}function mU(d){if(N3(d)!=="object")return!1;var h=Object.getPrototypeOf(d);return h===null||h===Object.prototype}var iJ=JN("Date"),oJ=JN("File"),sJ=JN("Blob"),aJ=JN("FileList");function P3(d){return A3.call(d)==="[object Function]"}var cJ=JN("URLSearchParams");function x3(d,h){if(d!=null)if(typeof d!="object"&&(d=[d]),k3(d))for(var g=0,j=d.length;g<j;g++)h.call(null,d[g],g,d);else for(var _t in d)Object.prototype.hasOwnProperty.call(d,_t)&&h.call(null,d[_t],_t,d)}var D3,uJ=(D3=typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array),function(d){return D3&&d instanceof D3}),ET={isArray:k3,isArrayBuffer:M2,isBuffer:function(d){return d!==null&&!fU(d)&&d.constructor!==null&&!fU(d.constructor)&&typeof d.constructor.isBuffer=="function"&&d.constructor.isBuffer(d)},isFormData:function(d){var h="[object FormData]";return d&&(typeof FormData=="function"&&d instanceof FormData||A3.call(d)===h||P3(d.toString)&&d.toString()===h)},isArrayBufferView:function(d){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(d):d&&d.buffer&&M2(d.buffer)},isString:function(d){return typeof d=="string"},isNumber:function(d){return typeof d=="number"},isObject:j2,isPlainObject:mU,isUndefined:fU,isDate:iJ,isFile:oJ,isBlob:sJ,isFunction:P3,isStream:function(d){return j2(d)&&P3(d.pipe)},isURLSearchParams:cJ,isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:x3,merge:function d(){var h={};function g(_i,_o){mU(h[_o])&&mU(_i)?h[_o]=d(h[_o],_i):mU(_i)?h[_o]=d({},_i):k3(_i)?h[_o]=_i.slice():h[_o]=_i}for(var j=0,_t=arguments.length;j<_t;j++)x3(arguments[j],g);return h},extend:function(d,h,g){return x3(h,function(j,_t){d[_t]=g&&typeof j=="function"?rJ(j,g):j}),d},trim:function(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")},stripBOM:function(d){return d.charCodeAt(0)===65279&&(d=d.slice(1)),d},inherits:function(d,h,g,j){d.prototype=Object.create(h.prototype,j),d.prototype.constructor=d,g&&Object.assign(d.prototype,g)},toFlatObject:function(d,h,g){var j,_t,_i,_o={};h=h||{};do{for(_t=(j=Object.getOwnPropertyNames(d)).length;_t-- >0;)_o[_i=j[_t]]||(h[_i]=d[_i],_o[_i]=!0);d=Object.getPrototypeOf(d)}while(d&&(!g||g(d,h))&&d!==Object.prototype);return h},kindOf:N3,kindOfTest:JN,endsWith:function(d,h,g){d=String(d),(g===void 0||g>d.length)&&(g=d.length),g-=h.length;var j=d.indexOf(h,g);return j!==-1&&j===g},toArray:function(d){if(!d)return null;var h=d.length;if(fU(h))return null;for(var g=new Array(h);h-- >0;)g[h]=d[h];return g},isTypedArray:uJ,isFileList:aJ},$1=ET;function U2(d){return encodeURIComponent(d).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var F2=function(d,h,g){if(!h)return d;var j;if(g)j=g(h);else if($1.isURLSearchParams(h))j=h.toString();else{var _t=[];$1.forEach(h,function(_o,ga){_o!=null&&($1.isArray(_o)?ga+="[]":_o=[_o],$1.forEach(_o,function(_a){$1.isDate(_a)?_a=_a.toISOString():$1.isObject(_a)&&(_a=JSON.stringify(_a)),_t.push(U2(ga)+"="+U2(_a))}))}),j=_t.join("&")}if(j){var _i=d.indexOf("#");_i!==-1&&(d=d.slice(0,_i)),d+=(d.indexOf("?")===-1?"?":"&")+j}return d},lJ=ET;function gU(){this.handlers=[]}gU.prototype.use=function(d,h,g){return this.handlers.push({fulfilled:d,rejected:h,synchronous:!!g&&g.synchronous,runWhen:g?g.runWhen:null}),this.handlers.length-1},gU.prototype.eject=function(d){this.handlers[d]&&(this.handlers[d]=null)},gU.prototype.forEach=function(d){lJ.forEach(this.handlers,function(h){h!==null&&d(h)})};var dJ=gU,pJ=ET,B2=ET;function W1(d,h,g,j,_t){Error.call(this),this.message=d,this.name="AxiosError",h&&(this.code=h),g&&(this.config=g),j&&(this.request=j),_t&&(this.response=_t)}B2.inherits(W1,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var V2=W1.prototype,G2={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(d){G2[d]={value:d}}),Object.defineProperties(W1,G2),Object.defineProperty(V2,"isAxiosError",{value:!0}),W1.from=function(d,h,g,j,_t,_i){var _o=Object.create(V2);return B2.toFlatObject(d,_o,function(ga){return ga!==Error.prototype}),W1.call(_o,d.message,h,g,j,_t),_o.name=d.name,_i&&Object.assign(_o,_i),_o};var H1=W1,$2={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},YI=ET,W2=function(d,h){h=h||new FormData;var g=[];function j(_t){return _t===null?"":YI.isDate(_t)?_t.toISOString():YI.isArrayBuffer(_t)||YI.isTypedArray(_t)?typeof Blob=="function"?new Blob([_t]):Buffer.from(_t):_t}return function _t(_i,_o){if(YI.isPlainObject(_i)||YI.isArray(_i)){if(g.indexOf(_i)!==-1)throw Error("Circular reference detected in "+_o);g.push(_i),YI.forEach(_i,function(ga,_a){if(!YI.isUndefined(ga)){var _u,_c=_o?_o+"."+_a:_a;if(ga&&!_o&&typeof ga=="object"){if(YI.endsWith(_a,"{}"))ga=JSON.stringify(ga);else if(YI.endsWith(_a,"[]")&&(_u=YI.toArray(ga)))return void _u.forEach(function(_l){!YI.isUndefined(_l)&&h.append(_c,j(_l))})}_t(ga,_c)}}),g.pop()}else h.append(_o,j(_i))}(d),h},L3=H1,EU=ET,hJ=EU.isStandardBrowserEnv()?{write:function(d,h,g,j,_t,_i){var _o=[];_o.push(d+"="+encodeURIComponent(h)),EU.isNumber(g)&&_o.push("expires="+new Date(g).toGMTString()),EU.isString(j)&&_o.push("path="+j),EU.isString(_t)&&_o.push("domain="+_t),_i===!0&&_o.push("secure"),document.cookie=_o.join("; ")},read:function(d){var h=document.cookie.match(new RegExp("(^|;\\s*)("+d+")=([^;]*)"));return h?decodeURIComponent(h[3]):null},remove:function(d){this.write(d,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},fJ=function(d){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(d)},mJ=function(d,h){return h?d.replace(/\/+$/,"")+"/"+h.replace(/^\/+/,""):d},H2=function(d,h){return d&&!fJ(h)?mJ(d,h):h},M3=ET,gJ=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],q2=ET,EJ=q2.isStandardBrowserEnv()?function(){var d,h=/(msie|trident)/i.test(navigator.userAgent),g=document.createElement("a");function j(_t){var _i=_t;return h&&(g.setAttribute("href",_i),_i=g.href),g.setAttribute("href",_i),{href:g.href,protocol:g.protocol?g.protocol.replace(/:$/,""):"",host:g.host,search:g.search?g.search.replace(/^\?/,""):"",hash:g.hash?g.hash.replace(/^#/,""):"",hostname:g.hostname,port:g.port,pathname:g.pathname.charAt(0)==="/"?g.pathname:"/"+g.pathname}}return d=j(window.location.href),function(_t){var _i=q2.isString(_t)?j(_t):_t;return _i.protocol===d.protocol&&_i.host===d.host}}():function(){return!0},j3=H1;function z2(d){j3.call(this,d??"canceled",j3.ERR_CANCELED),this.name="CanceledError"}ET.inherits(z2,j3,{__CANCEL__:!0});var vU=z2,lL=ET,vJ=function(d,h,g){var j=g.config.validateStatus;g.status&&j&&!j(g.status)?h(new L3("Request failed with status code "+g.status,[L3.ERR_BAD_REQUEST,L3.ERR_BAD_RESPONSE][Math.floor(g.status/100)-4],g.config,g.request,g)):d(g)},_J=hJ,yJ=F2,bJ=H2,SJ=function(d){var h,g,j,_t={};return d&&M3.forEach(d.split(`
`),function(_i){if(j=_i.indexOf(":"),h=M3.trim(_i.substr(0,j)).toLowerCase(),g=M3.trim(_i.substr(j+1)),h){if(_t[h]&&gJ.indexOf(h)>=0)return;_t[h]=h==="set-cookie"?(_t[h]?_t[h]:[]).concat([g]):_t[h]?_t[h]+", "+g:g}}),_t},RJ=EJ,TJ=$2,jO=H1,wJ=vU,CJ=function(d){var h=/^([-+\w]{1,25})(:?\/\/|:)/.exec(d);return h&&h[1]||""},IJ=function(d){return new Promise(function(h,g){var j,_t=d.data,_i=d.headers,_o=d.responseType;function ga(){d.cancelToken&&d.cancelToken.unsubscribe(j),d.signal&&d.signal.removeEventListener("abort",j)}lL.isFormData(_t)&&lL.isStandardBrowserEnv()&&delete _i["Content-Type"];var _a=new XMLHttpRequest;if(d.auth){var _u=d.auth.username||"",_c=d.auth.password?unescape(encodeURIComponent(d.auth.password)):"";_i.Authorization="Basic "+btoa(_u+":"+_c)}var _l=bJ(d.baseURL,d.url);function _g(){if(_a){var d_="getAllResponseHeaders"in _a?SJ(_a.getAllResponseHeaders()):null,p_={data:_o&&_o!=="text"&&_o!=="json"?_a.response:_a.responseText,status:_a.status,statusText:_a.statusText,headers:d_,config:d,request:_a};vJ(function(C_){h(C_),ga()},function(C_){g(C_),ga()},p_),_a=null}}if(_a.open(d.method.toUpperCase(),yJ(_l,d.params,d.paramsSerializer),!0),_a.timeout=d.timeout,"onloadend"in _a?_a.onloadend=_g:_a.onreadystatechange=function(){_a&&_a.readyState===4&&(_a.status!==0||_a.responseURL&&_a.responseURL.indexOf("file:")===0)&&setTimeout(_g)},_a.onabort=function(){_a&&(g(new jO("Request aborted",jO.ECONNABORTED,d,_a)),_a=null)},_a.onerror=function(){g(new jO("Network Error",jO.ERR_NETWORK,d,_a,_a)),_a=null},_a.ontimeout=function(){var d_=d.timeout?"timeout of "+d.timeout+"ms exceeded":"timeout exceeded",p_=d.transitional||TJ;d.timeoutErrorMessage&&(d_=d.timeoutErrorMessage),g(new jO(d_,p_.clarifyTimeoutError?jO.ETIMEDOUT:jO.ECONNABORTED,d,_a)),_a=null},lL.isStandardBrowserEnv()){var r_=(d.withCredentials||RJ(_l))&&d.xsrfCookieName?_J.read(d.xsrfCookieName):void 0;r_&&(_i[d.xsrfHeaderName]=r_)}"setRequestHeader"in _a&&lL.forEach(_i,function(d_,p_){_t===void 0&&p_.toLowerCase()==="content-type"?delete _i[p_]:_a.setRequestHeader(p_,d_)}),lL.isUndefined(d.withCredentials)||(_a.withCredentials=!!d.withCredentials),_o&&_o!=="json"&&(_a.responseType=d.responseType),typeof d.onDownloadProgress=="function"&&_a.addEventListener("progress",d.onDownloadProgress),typeof d.onUploadProgress=="function"&&_a.upload&&_a.upload.addEventListener("progress",d.onUploadProgress),(d.cancelToken||d.signal)&&(j=function(d_){_a&&(g(!d_||d_&&d_.type?new wJ:d_),_a.abort(),_a=null)},d.cancelToken&&d.cancelToken.subscribe(j),d.signal&&(d.signal.aborted?j():d.signal.addEventListener("abort",j))),_t||(_t=null);var l_=CJ(_l);l_&&["http","https","file"].indexOf(l_)===-1?g(new jO("Unsupported protocol "+l_+":",jO.ERR_BAD_REQUEST,d)):_a.send(_t)})},cT=ET,K2=function(d,h){pJ.forEach(d,function(g,j){j!==h&&j.toUpperCase()===h.toUpperCase()&&(d[h]=g,delete d[j])})},Y2=H1,OJ=W2,AJ={"Content-Type":"application/x-www-form-urlencoded"};function J2(d,h){!cT.isUndefined(d)&&cT.isUndefined(d["Content-Type"])&&(d["Content-Type"]=h)}var X2,_U={transitional:$2,adapter:((typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(X2=IJ),X2),transformRequest:[function(d,h){if(K2(h,"Accept"),K2(h,"Content-Type"),cT.isFormData(d)||cT.isArrayBuffer(d)||cT.isBuffer(d)||cT.isStream(d)||cT.isFile(d)||cT.isBlob(d))return d;if(cT.isArrayBufferView(d))return d.buffer;if(cT.isURLSearchParams(d))return J2(h,"application/x-www-form-urlencoded;charset=utf-8"),d.toString();var g,j=cT.isObject(d),_t=h&&h["Content-Type"];if((g=cT.isFileList(d))||j&&_t==="multipart/form-data"){var _i=this.env&&this.env.FormData;return OJ(g?{"files[]":d}:d,_i&&new _i)}return j||_t==="application/json"?(J2(h,"application/json"),function(_o,ga,_a){if(cT.isString(_o))try{return(ga||JSON.parse)(_o),cT.trim(_o)}catch(_u){if(_u.name!=="SyntaxError")throw _u}return(_a||JSON.stringify)(_o)}(d)):d}],transformResponse:[function(d){var h=this.transitional||_U.transitional,g=h&&h.silentJSONParsing,j=h&&h.forcedJSONParsing,_t=!g&&this.responseType==="json";if(_t||j&&cT.isString(d)&&d.length)try{return JSON.parse(d)}catch(_i){if(_t)throw _i.name==="SyntaxError"?Y2.from(_i,Y2.ERR_BAD_RESPONSE,this,null,this.response):_i}return d}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:null},validateStatus:function(d){return d>=200&&d<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};cT.forEach(["delete","get","head"],function(d){_U.headers[d]={}}),cT.forEach(["post","put","patch"],function(d){_U.headers[d]=cT.merge(AJ)});var U3=_U,NJ=ET,kJ=U3,Q2=function(d){return!(!d||!d.__CANCEL__)},Z2=ET,F3=function(d,h,g){var j=this||kJ;return NJ.forEach(g,function(_t){d=_t.call(j,d,h)}),d},PJ=Q2,xJ=U3,DJ=vU;function B3(d){if(d.cancelToken&&d.cancelToken.throwIfRequested(),d.signal&&d.signal.aborted)throw new DJ}var uI=ET,e4=function(d,h){h=h||{};var g={};function j(_u,_c){return uI.isPlainObject(_u)&&uI.isPlainObject(_c)?uI.merge(_u,_c):uI.isPlainObject(_c)?uI.merge({},_c):uI.isArray(_c)?_c.slice():_c}function _t(_u){return uI.isUndefined(h[_u])?uI.isUndefined(d[_u])?void 0:j(void 0,d[_u]):j(d[_u],h[_u])}function _i(_u){if(!uI.isUndefined(h[_u]))return j(void 0,h[_u])}function _o(_u){return uI.isUndefined(h[_u])?uI.isUndefined(d[_u])?void 0:j(void 0,d[_u]):j(void 0,h[_u])}function ga(_u){return _u in h?j(d[_u],h[_u]):_u in d?j(void 0,d[_u]):void 0}var _a={url:_i,method:_i,data:_i,baseURL:_o,transformRequest:_o,transformResponse:_o,paramsSerializer:_o,timeout:_o,timeoutMessage:_o,withCredentials:_o,adapter:_o,responseType:_o,xsrfCookieName:_o,xsrfHeaderName:_o,onUploadProgress:_o,onDownloadProgress:_o,decompress:_o,maxContentLength:_o,maxBodyLength:_o,beforeRedirect:_o,transport:_o,httpAgent:_o,httpsAgent:_o,cancelToken:_o,socketPath:_o,responseEncoding:_o,validateStatus:ga};return uI.forEach(Object.keys(d).concat(Object.keys(h)),function(_u){var _c=_a[_u]||_t,_l=_c(_u);uI.isUndefined(_l)&&_c!==ga||(g[_u]=_l)}),g},t4="0.27.2",LJ=t4,sN=H1,V3={};["object","boolean","number","function","string","symbol"].forEach(function(d,h){V3[d]=function(g){return typeof g===d||"a"+(h<1?"n ":" ")+d}});var n4={};V3.transitional=function(d,h,g){function j(_t,_i){return"[Axios v"+LJ+"] Transitional option '"+_t+"'"+_i+(g?". "+g:"")}return function(_t,_i,_o){if(d===!1)throw new sN(j(_i," has been removed"+(h?" in "+h:"")),sN.ERR_DEPRECATED);return h&&!n4[_i]&&(n4[_i]=!0,console.warn(j(_i," has been deprecated since v"+h+" and will be removed in the near future"))),!d||d(_t,_i,_o)}};var r4=ET,MJ=F2,i4=dJ,o4=function(d){return B3(d),d.headers=d.headers||{},d.data=F3.call(d,d.data,d.headers,d.transformRequest),d.headers=Z2.merge(d.headers.common||{},d.headers[d.method]||{},d.headers),Z2.forEach(["delete","get","head","post","put","patch","common"],function(h){delete d.headers[h]}),(d.adapter||xJ.adapter)(d).then(function(h){return B3(d),h.data=F3.call(d,h.data,h.headers,d.transformResponse),h},function(h){return PJ(h)||(B3(d),h&&h.response&&(h.response.data=F3.call(d,h.response.data,h.response.headers,d.transformResponse))),Promise.reject(h)})},yU=e4,jJ=H2,s4={assertOptions:function(d,h,g){if(typeof d!="object")throw new sN("options must be an object",sN.ERR_BAD_OPTION_VALUE);for(var j=Object.keys(d),_t=j.length;_t-- >0;){var _i=j[_t],_o=h[_i];if(_o){var ga=d[_i],_a=ga===void 0||_o(ga,_i,d);if(_a!==!0)throw new sN("option "+_i+" must be "+_a,sN.ERR_BAD_OPTION_VALUE)}else if(g!==!0)throw new sN("Unknown option "+_i,sN.ERR_BAD_OPTION)}},validators:V3},q1=s4.validators;function z1(d){this.defaults=d,this.interceptors={request:new i4,response:new i4}}z1.prototype.request=function(d,h){typeof d=="string"?(h=h||{}).url=d:h=d||{},(h=yU(this.defaults,h)).method?h.method=h.method.toLowerCase():this.defaults.method?h.method=this.defaults.method.toLowerCase():h.method="get";var g=h.transitional;g!==void 0&&s4.assertOptions(g,{silentJSONParsing:q1.transitional(q1.boolean),forcedJSONParsing:q1.transitional(q1.boolean),clarifyTimeoutError:q1.transitional(q1.boolean)},!1);var j=[],_t=!0;this.interceptors.request.forEach(function(_l){typeof _l.runWhen=="function"&&_l.runWhen(h)===!1||(_t=_t&&_l.synchronous,j.unshift(_l.fulfilled,_l.rejected))});var _i,_o=[];if(this.interceptors.response.forEach(function(_l){_o.push(_l.fulfilled,_l.rejected)}),!_t){var ga=[o4,void 0];for(Array.prototype.unshift.apply(ga,j),ga=ga.concat(_o),_i=Promise.resolve(h);ga.length;)_i=_i.then(ga.shift(),ga.shift());return _i}for(var _a=h;j.length;){var _u=j.shift(),_c=j.shift();try{_a=_u(_a)}catch(_l){_c(_l);break}}try{_i=o4(_a)}catch(_l){return Promise.reject(_l)}for(;_o.length;)_i=_i.then(_o.shift(),_o.shift());return _i},z1.prototype.getUri=function(d){d=yU(this.defaults,d);var h=jJ(d.baseURL,d.url);return MJ(h,d.params,d.paramsSerializer)},r4.forEach(["delete","get","head","options"],function(d){z1.prototype[d]=function(h,g){return this.request(yU(g||{},{method:d,url:h,data:(g||{}).data}))}}),r4.forEach(["post","put","patch"],function(d){function h(g){return function(j,_t,_i){return this.request(yU(_i||{},{method:d,headers:g?{"Content-Type":"multipart/form-data"}:{},url:j,data:_t}))}}z1.prototype[d]=h(),z1.prototype[d+"Form"]=h(!0)});var UJ=z1,FJ=vU;function K1(d){if(typeof d!="function")throw new TypeError("executor must be a function.");var h;this.promise=new Promise(function(j){h=j});var g=this;this.promise.then(function(j){if(g._listeners){var _t,_i=g._listeners.length;for(_t=0;_t<_i;_t++)g._listeners[_t](j);g._listeners=null}}),this.promise.then=function(j){var _t,_i=new Promise(function(_o){g.subscribe(_o),_t=_o}).then(j);return _i.cancel=function(){g.unsubscribe(_t)},_i},d(function(j){g.reason||(g.reason=new FJ(j),h(g.reason))})}K1.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},K1.prototype.subscribe=function(d){this.reason?d(this.reason):this._listeners?this._listeners.push(d):this._listeners=[d]},K1.prototype.unsubscribe=function(d){if(this._listeners){var h=this._listeners.indexOf(d);h!==-1&&this._listeners.splice(h,1)}},K1.source=function(){var d;return{token:new K1(function(h){d=h}),cancel:d}};var BJ=K1,VJ=ET,a4=ET,GJ=L2,bU=UJ,$J=e4,zT=function d(h){var g=new bU(h),j=GJ(bU.prototype.request,g);return a4.extend(j,bU.prototype,g),a4.extend(j,g),j.create=function(_t){return d($J(h,_t))},j}(U3);zT.Axios=bU,zT.CanceledError=vU,zT.CancelToken=BJ,zT.isCancel=Q2,zT.VERSION=t4,zT.toFormData=W2,zT.AxiosError=H1,zT.Cancel=zT.CanceledError,zT.all=function(d){return Promise.all(d)},zT.spread=function(d){return function(h){return d.apply(null,h)}},zT.isAxiosError=function(d){return VJ.isObject(d)&&d.isAxiosError===!0},O3.exports=zT,O3.exports.default=zT;var KT=O3.exports;class WJ{constructor(h){_h(this,"logger",void 0),_h(this,"prefixLists",[]),this.logger=h}debug(){for(var h=arguments.length,g=new Array(h),j=0;j<h;j++)g[j]=arguments[j];this.logger.debug(...this.prefixLists,...g)}info(){for(var h=arguments.length,g=new Array(h),j=0;j<h;j++)g[j]=arguments[j];this.logger.info(...this.prefixLists,...g)}warning(){for(var h=arguments.length,g=new Array(h),j=0;j<h;j++)g[j]=arguments[j];this.logger.warning(...this.prefixLists,...g)}error(){for(var h=arguments.length,g=new Array(h),j=0;j<h;j++)g[j]=arguments[j];this.logger.error(...this.prefixLists,...g)}prefix(h){return this.prefixLists.push(h),this}popPrefix(){return this.prefixLists.pop(),this}}class US{constructor(){_h(this,"_events",{}),_h(this,"addListener",this.on)}getListeners(h){return this._events[h]?this._events[h].map(g=>g.listener):[]}on(h,g){this._events[h]||(this._events[h]=[]);const j=this._events[h];this._indexOfListener(j,g)===-1&&j.push({listener:g,once:!1})}once(h,g){this._events[h]||(this._events[h]=[]);const j=this._events[h];this._indexOfListener(j,g)===-1&&j.push({listener:g,once:!0})}off(h,g){if(!this._events[h])return;const j=this._events[h],_t=this._indexOfListener(j,g);_t!==-1&&j.splice(_t,1),this._events[h].length===0&&delete this._events[h]}removeAllListeners(h){h?delete this._events[h]:this._events={}}emit(h){this._events[h]||(this._events[h]=[]);const g=this._events[h].map(_o=>_o);for(var j=arguments.length,_t=new Array(j>1?j-1:0),_i=1;_i<j;_i++)_t[_i-1]=arguments[_i];for(let _o=0;_o<g.length;_o+=1){const ga=g[_o];ga.once&&this.off(h,ga.listener),ga.listener.apply(this,_t||[])}}safeEmit(h){for(var g=arguments.length,j=new Array(g>1?g-1:0),_t=1;_t<g;_t++)j[_t-1]=arguments[_t];[...this._events[h]||[]].forEach(_i=>{_i.once&&this.off(h,_i.listener);try{_i.listener.apply(this,j)}catch(_o){wE.error("safeEmit event:".concat(h," error ").concat(_o==null?void 0:_o.toString()))}})}_indexOfListener(h,g){let j=h.length;for(;j--;)if(h[j].listener===g)return j;return-1}}const SU=new class extends US{reportLogUploadError(d){this.emit("REPORT_LOG_UPLOAD",d)}};let c_;(function(d){d.UNEXPECTED_ERROR="UNEXPECTED_ERROR",d.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",d.TIMEOUT="TIMEOUT",d.INVALID_PARAMS="INVALID_PARAMS",d.NOT_READABLE="NOT_READABLE",d.NOT_SUPPORTED="NOT_SUPPORTED",d.INVALID_OPERATION="INVALID_OPERATION",d.OPERATION_ABORTED="OPERATION_ABORTED",d.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",d.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",d.NETWORK_ERROR="NETWORK_ERROR",d.NETWORK_TIMEOUT="NETWORK_TIMEOUT",d.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",d.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",d.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",d.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",d.ELECTRON_IS_NULL="ELECTRON_IS_NULL",d.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",d.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",d.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",d.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",d.PERMISSION_DENIED="PERMISSION_DENIED",d.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",d.TRACK_IS_DISABLED="TRACK_IS_DISABLED",d.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",d.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",d.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",d.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",d.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",d.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",d.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",d.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",d.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",d.UID_CONFLICT="UID_CONFLICT",d.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",d.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",d.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",d.INVALID_TRACK="INVALID_TRACK",d.SENDER_NOT_FOUND="SENDER_NOT_FOUND",d.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",d.SET_ANSWER_FAILED="SET_ANSWER_FAILED",d.ICE_FAILED="ICE_FAILED",d.PC_CLOSED="PC_CLOSED",d.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",d.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",d.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",d.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",d.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",d.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",d.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",d.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",d.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",d.INVALID_REMOTE_USER="INVALID_REMOTE_USER",d.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",d.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",d.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",d.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",d.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",d.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",d.WS_ABORT="WS_ABORT",d.WS_DISCONNECT="WS_DISCONNECT",d.WS_ERR="WS_ERR",d.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",d.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",d.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",d.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",d.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",d.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",d.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",d.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",d.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",d.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",d.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",d.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",d.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",d.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",d.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",d.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",d.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",d.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",d.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",d.INVALID_PLUGIN="INVALID_PLUGIN",d.DISCONNECT_P2P="DISCONNECT_P2P",d.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT",d.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",d.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",d.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",d.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",d.PROHIBITED_OPERATION="PROHIBITED_OPERATION",d.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED"})(c_||(c_={}));class f_ extends Error{constructor(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",j=arguments.length>2?arguments[2]:void 0;super(g),_h(this,"code",void 0),_h(this,"message",void 0),_h(this,"data",void 0),_h(this,"name","AgoraRTCException"),this.code=h,this.message="AgoraRTCError ".concat(this.code,": ").concat(g),this.data=j}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),`
`).concat(this.stack):"".concat(this.stack)}print(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"error";return h==="error"&&wE.error(this.toString()),h==="warning"&&wE.warning(this.toString()),this}throw(){throw this.print(),this}}const rR={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function G3(d,h){const g=Math.floor(h.timeout*Math.pow(h.timeoutFactor,d));return Math.min(h.maxRetryTimeout,g)}function JI(d,h,g,j){const _t=Object.assign({},rR,j);let _i=_t.timeout;const _o=async()=>{await function(_u){return new a0(_c=>{window.setTimeout(_c,_u)})}(_i),_i*=_t.timeoutFactor,_i=Math.min(_t.maxRetryTimeout,_i)};let ga=!1;const _a=new a0(async(_u,_c)=>{h=h||(()=>!1),g=g||(()=>!0);for(let _l=0;_l<_t.maxRetryCount;_l+=1){if(ga)return _c(new f_(c_.OPERATION_ABORTED));try{const _g=await d();if(!h(_g,_l)||_l+1===_t.maxRetryCount)return _u(_g);await _o()}catch(_g){if(!g(_g,_l)||_l+1===_t.maxRetryCount)return _c(_g);await _o()}}});return _a.cancel=()=>ga=!0,_a}function $3(){const d=new Date;return d.toTimeString().split(" ")[0]+":"+d.getMilliseconds()}function c4(){const d=new Date,h=/((\d+:){2}\d+)/.exec(new Date().toUTCString());return h?(h==null?void 0:h[0])+":"+d.getUTCMilliseconds():d.toTimeString().split(" ")[0]+":"+d.getMilliseconds()}const lI={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},RU=Date.now(),dL=d=>{for(const h in lI)if(Object.prototype.hasOwnProperty.call(lI,h)&&lI[h]===d)return h;return"DEFAULT"},wE=new class{constructor(){_h(this,"proxyServerURL",void 0),_h(this,"logLevel",lI.DEBUG),_h(this,"uploadState","collecting"),_h(this,"uploadLogWaitingList",[]),_h(this,"uploadLogUploadingList",[]),_h(this,"uploadErrorCount",0),_h(this,"currentLogID",0),_h(this,"url",void 0),_h(this,"extLog",(d,h)=>{this.appendLogToWaitingList(d,...h)})}debug(){for(var d=arguments.length,h=new Array(d),g=0;g<d;g++)h[g]=arguments[g];const j=[lI.DEBUG].concat(h);this.log.apply(this,j)}info(){for(var d=arguments.length,h=new Array(d),g=0;g<d;g++)h[g]=arguments[g];const j=[lI.INFO].concat(h);this.log.apply(this,j)}warning(){for(var d=arguments.length,h=new Array(d),g=0;g<d;g++)h[g]=arguments[g];const j=[lI.WARNING].concat(h);this.log.apply(this,j)}error(){for(var d=arguments.length,h=new Array(d),g=0;g<d;g++)h[g]=arguments[g];const j=[lI.ERROR].concat(h);this.log.apply(this,j)}upload(){for(var d=arguments.length,h=new Array(d),g=0;g<d;g++)h[g]=arguments[g];const j=[lI.DEBUG].concat(h);this.uploadLog.apply(this,j)}setLogLevel(d){d=Math.min(Math.max(0,d),4),this.logLevel=d}enableLogUpload(){ES("UPLOAD_LOG",!0)}disableLogUpload(){ES("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(d){this.proxyServerURL=d}prefix(d){return new WJ(this).prefix(d)}log(){for(var d=arguments.length,h=new Array(d),g=0;g<d;g++)h[g]=arguments[g];if(Date.now()-RU<100)return void setTimeout(()=>{this.log(...h)},Date.now()-RU);const j=Math.max(0,Math.min(4,h[0]));if(h[0]=$3()+" Agora-SDK [".concat(dL(j),"]:"),this.appendLogToWaitingList(j,...h),j<this.logLevel)return;const _t=$3()+" %cAgora-SDK [".concat(dL(j),"]:");let _i=[];if(!__("USE_NEW_LOG"))switch(j){case lI.DEBUG:_i=[_t,"color: #64B5F6;"].concat(h.slice(1)),console.log.apply(console,_i);break;case lI.INFO:_i=[_t,"color: #1E88E5; font-weight: bold;"].concat(h.slice(1)),console.log.apply(console,_i);break;case lI.WARNING:_i=[_t,"color: #FB8C00; font-weight: bold;"].concat(h.slice(1)),console.warn.apply(console,_i);break;case lI.ERROR:_i=[_t,"color: #B00020; font-weight: bold;"].concat(h.slice(1)),console.error.apply(console,_i)}}uploadLog(){for(var d=arguments.length,h=new Array(d),g=0;g<d;g++)h[g]=arguments[g];if(Date.now()-RU<100)return void setTimeout(()=>{this.uploadLog(...h)},Date.now()-RU);const j=Math.max(0,Math.min(4,h[0]));h[0]=$3()+" Agora-SDK [".concat(dL(j),"]:"),this.appendLogToWaitingList(j,...h)}appendLogToWaitingList(d){if(!__("UPLOAD_LOG"))return;for(var h=arguments.length,g=new Array(h>1?h-1:0),j=1;j<h;j++)g[j-1]=arguments[j];Array.isArray(g[0])?g[0][0]=c4()+" Agora-SDK [".concat(dL(d),"]:"):g[0]=c4()+" Agora-SDK [".concat(dL(d),"]:");let _t="";g.forEach(_i=>{typeof _i=="object"&&(_i=JSON.stringify(_i)),_t+="".concat(_i," ")}),this.uploadLogWaitingList.push({payload_str:_t,log_level:d,log_item_id:this.currentLogID++}),this.uploadState==="uploading"&&this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",this.uploadLogUploadingList.length===0&&this.uploadLogInterval()}async uploadLogs(){const d=this.uploadLogUploadingList,h={sdk_version:dI,process_id:__("PROCESS_ID"),payload:JSON.stringify(d)};return JI(async()=>{const g=await KT.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(__("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(__("LOG_UPLOAD_SERVER"),"/upload/v1")),h,{responseType:"text"});if(g.data!=="OK"){const j=new Error("unexpected upload log response");throw j.response=g,j}},()=>(this.uploadLogUploadingList=[],!1),g=>(g.response?SU.reportLogUploadError({status:g.response.status,data:g.response.data,headers:g.response.headers,message:g.message}):g.request?SU.reportLogUploadError({status:g.request.status,message:g.message}):SU.reportLogUploadError({status:-1,message:g.message}),!0),{timeout:__("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:__("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){this.uploadLogUploadingList.length===0&&this.uploadLogWaitingList.length===0||(this.uploadLogUploadingList.length===0&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,__("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then(()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout(()=>this.uploadLogInterval(),__("UPLOAD_LOG_INTERVAL"))}).catch(d=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout(()=>this.uploadLogInterval(),__("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout(()=>this.uploadLogInterval(),__("UPLOAD_LOG_RETRY_INTERVAL_V1"))}))}},W3="v4.18.3-0-g04adbcef-dirty(9/20/2023, 10:34:38 AM)",dI=function(d){if(d.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return d;const h=d.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(h&&h[1]&&h[2]){const j=h[1],_t=h[2];return"".concat(j,".").concat(_t)}const g=d.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(g&&g[1]&&g[2]){const j=g[1],_t=g[2];return"".concat(j,".").concat(100*(Number(_t)+1))}return"4.0.0.999"}("4.18.3"),H3=function(){try{return JSON.parse("true")===!0}catch{return!0}}(),u4=["CHINA","GLOBAL"],YT=function(){const d="us".concat("erna","me"),h="pa".concat("sswo","rd"),g=["t","s","t"];g.splice(1,0,"e");const j=g.join(""),_t=[];for(let ga=0;ga<6;ga++)_t.push("1");const _i=_t.join(""),_o={};return _o[d]=j,_o[h]=_i,Object.assign(_o,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=YT;const HJ={"90p":q0(160,90),"90p_1":q0(160,90),"120p":q0(160,120,15,30,65),"120p_1":q0(160,120,15,30,65),"120p_3":q0(120,120,15,30,50),"120p_4":q0(212,120),"180p":q0(320,180,15,30,140),"180p_1":q0(320,180,15,30,140),"180p_3":q0(180,180,15,30,100),"180p_4":q0(240,180,15,30,120),"240p":q0(320,240,15,40,200),"240p_1":q0(320,240,15,40,200),"240p_3":q0(240,240,15,40,140),"240p_4":q0(424,240,15,40,220),"360p":q0(640,360,15,80,400),"360p_1":q0(640,360,15,80,400),"360p_3":q0(360,360,15,80,260),"360p_4":q0(640,360,30,80,600),"360p_6":q0(360,360,30,80,400),"360p_7":q0(480,360,15,80,320),"360p_8":q0(480,360,30,80,490),"360p_9":q0(640,360,15,80,800),"360p_10":q0(640,360,24,80,800),"360p_11":q0(640,360,24,80,1e3),"480p":q0(640,480,15,100,500),"480p_1":q0(640,480,15,100,500),"480p_2":q0(640,480,30,100,1e3),"480p_3":q0(480,480,15,100,400),"480p_4":q0(640,480,30,100,750),"480p_6":q0(480,480,30,100,600),"480p_8":q0(848,480,15,100,610),"480p_9":q0(848,480,30,100,930),"480p_10":q0(640,480,10,100,400),"720p":q0(1280,720,15,120,1130),"720p_1":q0(1280,720,15,120,1130),"720p_2":q0(1280,720,30,120,2e3),"720p_3":q0(1280,720,30,120,1710),"720p_5":q0(960,720,15,120,910),"720p_6":q0(960,720,30,120,1380),"1080p":q0(1920,1080,15,120,2080),"1080p_1":q0(1920,1080,15,120,2080),"1080p_2":q0(1920,1080,30,120,3e3),"1080p_3":q0(1920,1080,30,120,3150),"1080p_5":q0(1920,1080,60,120,4780),"1440p":q0(2560,1440,30,120,4850),"1440p_1":q0(2560,1440,30,120,4850),"1440p_2":q0(2560,1440,60,120,7350),"4k":q0(3840,2160,30,120,8910),"4k_1":q0(3840,2160,30,120,8910),"4k_3":q0(3840,2160,60,120,13500)},qJ={"480p":OI(640,480,5),"480p_1":OI(640,480,5),"480p_2":OI(640,480,30),"480p_3":OI(640,480,15),"720p":OI(1280,720,5),"720p_1":OI(1280,720,5),"720p_2":OI(1280,720,30),"720p_3":OI(1280,720,15),"1080p":OI(1920,1080,5),"1080p_1":OI(1920,1080,5),"1080p_2":OI(1920,1080,30),"1080p_3":OI(1920,1080,15)},zJ={"1SL1TL":z3(1,1),"3SL3TL":z3(3,3),"2SL3TL":z3(2,3)};function XN(d){return d||(d="480p_1"),typeof d=="string"?Object.assign({},HJ[d]):d}function q3(d){return typeof d=="string"?Object.assign({},qJ[d]):d}function TU(d){return typeof d=="string"?Object.assign({},zJ[d]):d}const KJ={speech_low_quality:Y1(16e3,!1),speech_standard:Y1(32e3,!1,18),music_standard:Y1(48e3,!1),standard_stereo:Y1(48e3,!0,56),high_quality:Y1(48e3,!1,128),high_quality_stereo:Y1(48e3,!0,192)};function wU(d){return typeof d=="string"?Object.assign({},KJ[d]):d}function ES(d,h,g){Object.keys(TT).includes(d)&&(!g&&Object.keys(QN).includes(d)||(TT[d]=h))}function __(d){return TT[d]}const TT={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:u4,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TWCC:!1,PUBLISH_TWCC:!1,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_PUB_RTX:!1,USE_SUB_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION:2e3,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!0,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,NEW_ICE_RESTART:!1,ENABLE_USER_LICENSE_CHECK:!0,SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,AP_AREA:!0,SVC:[],ENABLE_ENCODED_TRANSFORM:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0}},QN={};function Y1(d,h,g){return{sampleRate:d,stereo:h,bitrate:g}}function q0(d,h,g,j,_t){return{width:d,height:h,frameRate:g,bitrateMin:j,bitrateMax:_t}}function OI(d,h,g,j,_t){return{width:{max:d},height:{max:h},frameRate:g,bitrateMin:j,bitrateMax:_t}}function z3(d,h){return{numSpatialLayers:d,numTemporalLayers:h}}H3||(TT.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],TT.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],TT.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],TT.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],TT.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],TT.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],TT.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",TT.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",TT.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",TT.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",TT.AREAS=["NORTH_AMERICA","OVERSEA"]);const YJ=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],ZN=[],pL=[];function e1(d,h){return!!h&&ZN.some(g=>g.uid===d&&g.channelName===h)}var JJ=mT,XJ=oI,QJ=I_,K3=function(d,h,g){var j=JJ(h);j in d?XJ.f(d,j,QJ(0,g)):d[j]=g},l4=GP,ZJ=$I,eX=K3,tX=_E.Array,nX=Math.max,d4=function(d,h,g){for(var j=ZJ(d),_t=l4(h,j),_i=l4(g===void 0?j:g,j),_o=tX(nX(_i-_t,0)),ga=0;_t<_i;_t++,ga++)eX(_o,ga,d[_t]);return _o.length=ga,_o},p4=d4,rX=Math.floor,Y3=function(d,h){var g=d.length,j=rX(g/2);return g<8?iX(d,h):oX(d,Y3(p4(d,0,j),h),Y3(p4(d,j),h),h)},iX=function(d,h){for(var g,j,_t=d.length,_i=1;_i<_t;){for(j=_i,g=d[_i];j&&h(d[j-1],g)>0;)d[j]=d[--j];j!==_i++&&(d[j]=g)}return d},oX=function(d,h,g,j){for(var _t=h.length,_i=g.length,_o=0,ga=0;_o<_t||ga<_i;)d[_o+ga]=_o<_t&&ga<_i?j(h[_o],g[ga])<=0?h[_o++]:g[ga++]:_o<_t?h[_o++]:g[ga++];return d},sX=Y3,h4=j_.match(/firefox\/(\d+)/i),aX=!!h4&&+h4[1],cX=/MSIE|Trident/.test(j_),f4=j_.match(/AppleWebKit\/(\d+)\./),uX=!!f4&&+f4[1],lX=PR,m4=ba,dX=QR,pX=hT,hX=$I,g4=Z0,J3=_,fX=sX,mX=UP,E4=aX,gX=cX,v4=yS,_4=uX,aN=[],y4=m4(aN.sort),EX=m4(aN.push),vX=J3(function(){aN.sort(void 0)}),_X=J3(function(){aN.sort(null)}),yX=mX("sort"),b4=!J3(function(){if(v4)return v4<70;if(!(E4&&E4>3)){if(gX)return!0;if(_4)return _4<603;var d,h,g,j,_t="";for(d=65;d<76;d++){switch(h=String.fromCharCode(d),d){case 66:case 69:case 70:case 72:g=3;break;case 68:case 71:g=4;break;default:g=2}for(j=0;j<47;j++)aN.push({k:h+j,v:g})}for(aN.sort(function(_i,_o){return _o.v-_i.v}),j=0;j<aN.length;j++)h=aN[j].k.charAt(0),_t.charAt(_t.length-1)!==h&&(_t+=h);return _t!=="DGBEFHACIJK"}});lX({target:"Array",proto:!0,forced:vX||!_X||!yX||!b4},{sort:function(d){d!==void 0&&dX(d);var h=pX(this);if(b4)return d===void 0?y4(h):y4(h,d);var g,j,_t=[],_i=hX(h);for(j=0;j<_i;j++)j in h&&EX(_t,h[j]);for(fX(_t,function(_o){return function(ga,_a){return _a===void 0?-1:ga===void 0?1:_o!==void 0?+_o(ga,_a)||0:g4(ga)>g4(_a)?1:-1}}(d)),g=_t.length,j=0;j<g;)h[j]=_t[j++];for(;j<_i;)delete h[j++];return h}});var bX=UR("Array").sort,SX=_p,RX=bX,X3=Array.prototype,Q3=function(d){var h=d.sort;return d===X3||SX(X3,d)&&h===X3.sort?RX:h};function J1(d,h){if(typeof d!="boolean")throw new f_(c_.INVALID_PARAMS,"Invalid ".concat(h,": The value is of the boolean type."))}function IR(d,h,g){if(!g.includes(d))throw new f_(c_.INVALID_PARAMS,"".concat(h," can only be set as ").concat(JSON.stringify(g)))}function SS(d,h){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1e4,_t=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(d<g||d>j||_t&&!TX(d))throw new f_(c_.INVALID_PARAMS,"invalid ".concat(h,": the value range is [").concat(g,", ").concat(j,"]. integer only"))}function Z3(d,h){if(typeof d!="number"){if(!(d.min||d.max||d.ideal||d.exact))throw new f_(c_.INVALID_PARAMS,"".concat(h," is not a valid ConstrainLong"));d.min!==void 0&&SS(d.min,"".concat(h,".min"),0,1/0),d.max!==void 0&&SS(d.max,"".concat(h,".max"),1,1/0),d.exact!==void 0&&SS(d.exact,"".concat(h,".exact"),1,1/0),d.ideal!==void 0&&SS(d.ideal,"".concat(h,".ideal"),1,1/0)}else SS(d,h,1,1/0)}function GR(d,h){let g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:255,_t=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4];if(d==null)throw new f_(c_.INVALID_PARAMS,"".concat(h||"param"," cannot be empty"));if(!S4(d,g,j,_t))throw new f_(c_.INVALID_PARAMS,"Invalid ".concat(h||"string param",": Length of the string: [").concat(g,",").concat(j,"].").concat(_t?" ASCII characters only.":""))}function UO(d,h){if(!Array.isArray(d))throw new f_(c_.INVALID_PARAMS,"".concat(h," should be an array"))}function e5(d){if(typeof d!="string"||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(d))throw wE.error("Invalid Channel Name ".concat(d)),new f_(c_.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function t5(d){if(h=d,!(typeof h=="number"&&Math.floor(h)===h&&0<=h&&h<=4294967295||S4(d,1,255)))throw wE.error("Invalid UID ".concat(d," ").concat(typeof d)),new f_(c_.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var h;typeof d=="string"&&wE.warning("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}function AS(d){return d==null}function S4(d){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:255,j=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return typeof d=="string"&&d.length<=g&&d.length>=h&&(!j||wX(d))}function TX(d){return typeof d=="number"&&d%1==0}function wX(d){if(typeof d!="string")return!1;for(let h=0;h<d.length;h+=1){const g=d.charCodeAt(h);if(g<0||g>255)return!1}return!0}let R4,T4,$R;(function(d){d.FREE="free",d.UPLOADING="uploading"})(R4||(R4={})),function(d){d[d.MISC=0]="MISC",d[d.INTERNAL_EVENT=1]="INTERNAL_EVENT",d[d.PUBLIC_EVENT=2]="PUBLIC_EVENT",d[d.WEB_EVENT=3]="WEB_EVENT",d[d.INTERNAL_API=4]="INTERNAL_API",d[d.WEB_API=5]="WEB_API",d[d.PUBLIC_API=6]="PUBLIC_API"}(T4||(T4={})),function(d){d.NONE="none",d.INIT="init",d.CANPLAY="canplay",d.PLAYING="playing",d.PAUSED="paused",d.SUSPEND="suspend",d.STALLED="stalled",d.WAITING="waiting",d.ERROR="error",d.DESTROYED="destroyed",d.ABORT="abort",d.ENDED="ended",d.EMPTIED="emptied",d.LOADEDDATA="loadeddata"}($R||($R={}));const n5={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};function CX(d){return GR(d.reportId,"params.reportId",0,100,!1),GR(d.category,"params.category",0,100,!1),GR(d.event,"params.event",0,100,!1),GR(d.label,"params.label",0,100,!1),SS(d.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}const IX={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let xR,FS,w4,r5,iR,kS,t1,FO,X1,hL,JT,WR,S0,i5,aS,V0,vT,pS,f0,C0,jT,F0,C4,wT;function I4(d){return SS(d.timeout,"config.timeout",0,1e5),SS(d.timeoutFactor,"config.timeoutFactor",0,100,!1),SS(d.maxRetryCount,"config.maxRetryConfig",0,1/0),SS(d.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function OX(d){return IR(d.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),IR(d.mode,"config.mode",["rtc","live"]),d.audioCodec!==void 0&&IR(d.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),d.proxyServer!==void 0&&GR(d.proxyServer,"config.proxyServer",1,1e4),d.turnServer!==void 0&&O4(d.turnServer),d.httpRetryConfig!==void 0&&I4(d.httpRetryConfig),d.websocketRetryConfig!==void 0&&I4(d.websocketRetryConfig),!0}function fL(d){if(!Array.isArray(d)||d.length<1)return!1;try{d.forEach(h=>{if(!h.urls)throw Error()})}catch{return!1}return!0}function O4(d){return GR(d.turnServerURL,"turnServerURL"),GR(d.username,"username"),GR(d.password,"password"),d.udpport&&SS(d.udpport,"udpport",1,99999,!0),d.forceturn&&J1(d.forceturn,"forceturn"),d.security&&J1(d.security,"security"),d.tcpport&&SS(d.tcpport,"tcpport",1,99999,!0),!0}function A4(d){return d.level!==void 0&&IR(d.level,"level",[1,2,3]),!0}(function(d){d.PUBLISH="publish",d.SUBSCRIBE="subscribe",d.WS_COMPRESSOR_INIT="ws_compressor_init",d.SESSION_INIT="session_init",d.JOIN_CHOOSE_SERVER="join_choose_server",d.REQ_USER_ACCOUNT="req_user_account",d.JOIN_GATEWAY="join_gateway",d.REJOIN_GATEWAY="rejoin_gateway",d.STREAM_SWITCH="stream_switch",d.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",d.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",d.FIRST_VIDEO_RECEIVED="first_video_received",d.FIRST_AUDIO_RECEIVED="first_audio_received",d.FIRST_VIDEO_DECODE="first_video_decode",d.FIRST_AUDIO_DECODE="first_audio_decode",d.ON_ADD_AUDIO_STREAM="on_add_audio_stream",d.ON_ADD_VIDEO_STREAM="on_add_video_stream",d.ON_UPDATE_STREAM="on_update_stream",d.ON_REMOVE_STREAM="on_remove_stream",d.USER_ANALYTICS="req_user_analytics",d.PC_STATS="pc_stats"})(xR||(xR={})),function(d){d.SESSION="io.agora.pb.Wrtc.Session",d.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",d.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",d.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",d.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",d.PUBLISH="io.agora.pb.Wrtc.Publish",d.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",d.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",d.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",d.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",d.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",d.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",d.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",d.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",d.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",d.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",d.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",d.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",d.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",d.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",d.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",d.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",d.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",d.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",d.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",d.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",d.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",d.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",d.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",d.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",d.PC_STATS="io.agora.pb.Wrtc.PCStats"}(FS||(FS={})),function(d){d[d.WORKER_EVENT=156]="WORKER_EVENT",d[d.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(w4||(w4={})),function(d){d[d.SESSION=26]="SESSION",d[d.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",d[d.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",d[d.JOIN_GATEWAY=28]="JOIN_GATEWAY",d[d.PUBLISH=30]="PUBLISH",d[d.SUBSCRIBE=29]="SUBSCRIBE",d[d.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",d[d.STREAM_SWITCH=32]="STREAM_SWITCH",d[d.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",d[d.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",d[d.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",d[d.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",d[d.API_INVOKE=41]="API_INVOKE",d[d.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",d[d.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",d[d.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",d[d.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",d[d.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",d[d.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",d[d.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",d[d.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",d[d.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",d[d.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",d[d.WORKER_EVENT=156]="WORKER_EVENT",d[d.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",d[d.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",d[d.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",d[d.USER_ANALYTICS=1e4]="USER_ANALYTICS",d[d.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(r5||(r5={})),function(d){d.CREATE_CLIENT="createClient",d.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",d.SET_AREA="setArea",d.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",d.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",d.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",d.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",d.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",d.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",d.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",d.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",d.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",d.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",d.START_PROXY_SERVER="Client.startProxyServer",d.STOP_PROXY_SERVER="Client.stopProxyServer",d.SET_PROXY_SERVER="Client.setProxyServer",d.SET_TURN_SERVER="Client.setTurnServer",d.SET_CLIENT_ROLE="Client.setClientRole",d.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",d.ENABLE_DUAL_STREAM="Client.enableDualStream",d.DISABLE_DUAL_STREAM="Client.disableDualStream",d.JOIN="Client.join",d.LEAVE="Client.leave",d.PUBLISH="Client.publish",d.UNPUBLISH="Client.unpublish",d.SUBSCRIBE="Client.subscribe",d.MASS_SUBSCRIBE="Client.massSubscribe",d.MASS_UNSUBSCRIBE="Client.massUnsubscribe",d.UNSUBSCRIBE="Client.unsubscribe",d.RENEW_TOKEN="Client.renewToken",d.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",d.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",d.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",d.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",d.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",d.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",d.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",d.DATACHANNEL_FAILBACK="Client._datachannelFailback",d.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",d.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",d.START_LIVE_STREAMING="Client.startLiveStreaming",d.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",d.STOP_LIVE_STREAMING="Client.stopLiveStreaming",d.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",d.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",d.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",d.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",d.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",d.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",d.SET_CONFIG_DISTRIBUTE="_configDistribute",d.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",d.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",d.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",d.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",d.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",d.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",d.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",d.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",d.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",d.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",d.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",d.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",d.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",d.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",d.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",d.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",d.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",d.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",d.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",d.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",d.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",d.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",d.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",d.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",d.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",d.STREAM_TYPE_CHANGE="streamTypeChange",d.CONNECTION_STATE_CHANGE="connectionStateChange",d.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",d.IMAGE_MODERATION_UPLOAD="imageModerationUpload"}(iR||(iR={})),function(d){d.TRACER="tracer"}(kS||(kS={})),function(d){d.IDLE="IDLE",d.INITING="INITING",d.INITEND="INITEND"}(t1||(t1={})),function(d){d.STATE_CHANGE="state_change",d.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",d.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",d.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(FO||(FO={})),function(d){d[d.ACCESS_POINT=101]="ACCESS_POINT",d[d.UNILBS=201]="UNILBS",d[d.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(X1||(X1={})),function(d){d[d.IIIEGAL_APPID=1]="IIIEGAL_APPID",d[d.IIIEGAL_UID=2]="IIIEGAL_UID",d[d.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(hL||(hL={})),function(d){d[d.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",d[d.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",d[d.INTERNAL_ERROR=8]="INTERNAL_ERROR",d[d.NO_AUTHORIZED=9]="NO_AUTHORIZED",d[d.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",d[d.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",d[d.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",d[d.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",d[d.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",d[d.USER_OVERLOAD=16]="USER_OVERLOAD",d[d.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",d[d.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(JT||(JT={})),function(d){d[d.NO_FLAG_SET=100]="NO_FLAG_SET",d[d.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",d[d.INVALID_FALG_SET=102]="INVALID_FALG_SET",d[d.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",d[d.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",d[d.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",d[d.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",d[d.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",d[d.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",d[d.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",d[d.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",d[d.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",d[d.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",d[d.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",d[d.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",d[d.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",d[d.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",d[d.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",d[d.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(WR||(WR={})),function(d){d[d.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",d[d.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",d[d.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",d[d.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",d[d.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",d[d.K_TICKET_INVALID=7]="K_TICKET_INVALID",d[d.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",d[d.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",d[d.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",d[d.K_UID_BANNED=14]="K_UID_BANNED",d[d.K_IP_BANNED=15]="K_IP_BANNED",d[d.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",d[d.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",d[d.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",d[d.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",d[d.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",d[d.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",d[d.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",d[d.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",d[d.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",d[d.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",d[d.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",d[d.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",d[d.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",d[d.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",d[d.ERR_INVALID_UID=117]="ERR_INVALID_UID",d[d.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",d[d.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",d[d.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",d[d.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",d[d.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",d[d.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",d[d.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",d[d.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",d[d.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",d[d.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",d[d.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",d[d.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",d[d.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",d[d.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",d[d.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",d[d.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",d[d.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",d[d.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",d[d.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",d[d.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",d[d.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",d[d.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",d[d.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",d[d.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",d[d.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",d[d.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",d[d.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",d[d.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",d[d.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",d[d.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",d[d.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",d[d.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",d[d.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",d[d.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",d[d.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",d[d.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",d[d.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(S0||(S0={})),function(d){d[d.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",d[d.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",d[d.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(i5||(i5={})),function(d){d.LEAVE="LEAVE",d.NETWORK_ERROR="NETWORK_ERROR",d.SERVER_ERROR="SERVER_ERROR",d.UID_BANNED="UID_BANNED",d.IP_BANNED="IP_BANNED",d.CHANNEL_BANNED="CHANNEL_BANNED",d.FALLBACK="FALLBACK",d.LICENSE_MISSING="LICENSE_MISSING",d.LICENSE_EXPIRED="LICENSE_EXPIRED",d.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",d.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",d.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",d.LICENSE_ILLEGAL="LICENSE_ILLEGAL"}(aS||(aS={})),function(d){d.CONNECTION_STATE_CHANGE="connection-state-change",d.MEDIA_RECONNECT_START="media-reconnect-start",d.MEDIA_RECONNECT_END="media-reconnect-end",d.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",d.USER_JOINED="user-joined",d.USER_LEAVED="user-left",d.USER_PUBLISHED="user-published",d.USER_UNPUBLISHED="user-unpublished",d.USER_INFO_UPDATED="user-info-updated",d.CLIENT_BANNED="client-banned",d.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",d.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",d.VOLUME_INDICATOR="volume-indicator",d.CRYPT_ERROR="crypt-error",d.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",d.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",d.NETWORK_QUALITY="network-quality",d.STREAM_TYPE_CHANGED="stream-type-changed",d.STREAM_FALLBACK="stream-fallback",d.RECEIVE_METADATA="receive-metadata",d.STREAM_MESSAGE="stream-message",d.LIVE_STREAMING_ERROR="live-streaming-error",d.LIVE_STREAMING_WARNING="live-streaming-warning",d.INJECT_STREAM_STATUS="stream-inject-status",d.EXCEPTION="exception",d.ERROR="error",d.P2P_LOST="p2p_lost",d.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",d.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",d.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",d.PUBLISHED_USER_LIST="published-user-list",d.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",d.CONTENT_INSPECT_ERROR="content-inspect-error",d.CONTENT_INSPECT_RESULT="content-inspect-result",d.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change"}(V0||(V0={})),function(d){d.NETWORK_ERROR="NETWORK_ERROR",d.SERVER_ERROR="SERVER_ERROR",d.MULTI_IP="MULTI_IP",d.TIMEOUT="TIMEOUT",d.OFFLINE="OFFLINE",d.LEAVE="LEAVE",d.P2P_FAILED="P2P_FAILED",d.FALLBACK="FALLBACK"}(vT||(vT={})),function(d){d.CONNECTING="connecting",d.CONNECTED="connected",d.RECONNECTING="reconnecting",d.CLOSED="closed"}(pS||(pS={})),function(d){d.WS_CONNECTED="ws_connected",d.WS_RECONNECTING="ws_reconnecting",d.WS_CLOSED="ws_closed",d.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",d.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",d.ON_BINARY_DATA="on_binary_data",d.REQUEST_RECOVER="request_recover",d.REQUEST_JOIN_INFO="request_join_info",d.REQUEST_REJOIN_INFO="req_rejoin_info",d.IS_P2P_DISCONNECTED="is_p2p_dis",d.DISCONNECT_P2P="dis_p2p",d.ABORT_P2P_EXECUTION="abort_p2p_execution",d.NEED_RENEW_SESSION="need-sid",d.REPORT_JOIN_GATEWAY="report_join_gateway",d.REQUEST_TIMEOUT="request_timeout",d.REQUEST_SUCCESS="request_success",d.JOIN_RESPONSE="join_response",d.DATACHANNEL_PRECONNECT="datachannel_preconnect",d.DATACHANNEL_CONNECTING="datachannel_connecting",d.DATACHANNEL_FAILBACK="datachannel_failback"}(f0||(f0={})),function(d){d.PING="ping",d.PING_BACK="ping_back",d.JOIN="join_v3",d.REJOIN="rejoin_v3",d.LEAVE="leave",d.SET_CLIENT_ROLE="set_client_role",d.PUBLISH="publish",d.UNPUBLISH="unpublish",d.SUBSCRIBE="subscribe",d.SUBSCRIBE_STREAMS="subscribe_streams",d.UNSUBSCRIBE="unsubscribe",d.UNSUBSCRIBE_STREAMS="unsubscribe_streams",d.SUBSCRIBE_CHANGE="subscribe_change",d.TRAFFIC_STATS="traffic_stats",d.RENEW_TOKEN="renew_token",d.SWITCH_VIDEO_STREAM="switch_video_stream",d.DEFAULT_VIDEO_STREAM="default_video_stream",d.SET_FALLBACK_OPTION="set_fallback_option",d.GATEWAY_INFO="gateway_info",d.CONTROL="control",d.SEND_METADATA="send_metadata",d.DATA_STREAM="data_stream",d.PICK_SVC_LAYER="pick_svc_layer",d.RESTART_ICE="restart_ice",d.CONNECT_PC="connect_pc",d.SET_VIDEO_PROFILE="set_video_profile",d.SET_PARAMETER="set_parameter"}(C0||(C0={})),function(d){d.PUBLISH_STATS="publish_stats",d.PUBLISH_RELATED_STATS="publish_related_stats",d.SUBSCRIBE_STATS="subscribe_stats",d.SUBSCRIBE_RELATED_STATS="subscribe_related_stats",d.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",d.DENOISER_STATS="denoiser_stats",d.TRANSPORT_STATS="transport_stats",d.EXTENSION_USAGE_STATS="extension_usage_stats"}(jT||(jT={})),function(d){d.ON_USER_ONLINE="on_user_online",d.ON_USER_OFFLINE="on_user_offline",d.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",d.ON_PUBLISH_STREAM="on_publish_stream",d.ON_UPLINK_STATS="on_uplink_stats",d.ON_P2P_LOST="on_p2p_lost",d.ON_REMOVE_STREAM="on_remove_stream",d.ON_ADD_AUDIO_STREAM="on_add_audio_stream",d.ON_ADD_VIDEO_STREAM="on_add_video_stream",d.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",d.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",d.ON_USER_BANNED="on_user_banned",d.ON_USER_LICENSE_BANNED="on_user_license_banned",d.ON_NOTIFICATION="on_notification",d.ON_CRYPT_ERROR="on_crypt_error",d.MUTE_AUDIO="mute_audio",d.MUTE_VIDEO="mute_video",d.UNMUTE_AUDIO="unmute_audio",d.UNMUTE_VIDEO="unmute_video",d.ON_P2P_OK="on_p2p_ok",d.RECEIVE_METADATA="receive_metadata",d.ON_DATA_STREAM="on_data_stream",d.ENABLE_LOCAL_VIDEO="enable_local_video",d.DISABLE_LOCAL_VIDEO="disable_local_video",d.ENABLE_LOCAL_AUDIO="enable_local_audio",d.DISABLE_LOCAL_AUDIO="disable_local_audio",d.ON_PUBLISHED_USER_LIST="on_published_user_list"}(F0||(F0={})),function(d){d.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",d.NEED_ANSWER="NEED_ANSWER",d.NEED_RENEGOTIATE="NEED_RENEGOTIATE",d.P2P_LOST="P2P_LOST",d.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",d.NEED_UNPUB="NEED_UNPUB",d.NEED_UNSUB="NEED_UNSUB",d.NEED_UPLOAD="NEED_UPLOAD",d.NEED_CONTROL="NEED_CONTROL",d.START_RECONNECT="START_RECONNECT",d.END_RECONNECT="END_RECONNECT",d.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(C4||(C4={})),function(d){d.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",d.RECEIVE_TRACK_BUFFER="receive_track_buffer",d.ON_AUDIO_BUFFER="on_audio_buffer",d.UPDATE_SOURCE="update_source"}(wT||(wT={}));const o5={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,currentPacketLossRate:0},s5={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},N4={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},AX={uplinkNetworkQuality:0,downlinkNetworkQuality:0},k4={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let x0,pR,cN;(function(d){d.CONNECTED="websocket:connected",d.RECONNECTING="websocket:reconnecting",d.WILL_RECONNECT="websocket:will_reconnect",d.CLOSED="websocket:closed",d.FAILED="websocket:failed",d.ON_MESSAGE="websocket:on_message",d.REQUEST_NEW_URLS="websocket:request_new_urls",d.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",d.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",d.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire"})(x0||(x0={})),function(d){d.TRANSCODE="mix_streaming",d.RAW="raw_streaming",d.INJECT="inject_streaming"}(pR||(pR={})),function(d){d[d.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",d[d.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",d[d.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",d[d.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",d[d.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",d[d.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",d[d.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",d[d.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",d[d.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",d[d.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",d[d.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(cN||(cN={}));const NX={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},a5={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function c5(d,h){GR(d.url,"".concat(h,".url"),1,1e3,!1),AS(d.x)||SS(d.x,"".concat(h,".x"),0,1e4),AS(d.y)||SS(d.y,"".concat(h,".y"),0,1e4),AS(d.width)||SS(d.width,"".concat(h,".width"),0,1e4),AS(d.height)||SS(d.height,"".concat(h,".height"),0,1e4),AS(d.zOrder)||SS(d.zOrder,"".concat(h,".zOrder"),0,255),AS(d.alpha)||SS(d.alpha,"".concat(h,".alpha"),0,1,!1)}const kX={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},PX={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};let AI,Q1,JS,P4,HR,XI,uT,uN,hR,PS,oR,CU,I0,ER,Z1,u5,l5,mL,lN,_k,z0;function x4(d){if(!d.channelName)throw new f_(c_.INVALID_PARAMS,"invalid channelName in info");if(typeof d.uid!="number")throw new f_(c_.INVALID_PARAMS,"invalid uid in info, uid must be a number");return d.token&&GR(d.token,"info.token",1,2047),t5(d.uid),e5(d.channelName),!0}function D4(d){return IR(d,"mediaSource",["screen","window","application"]),!0}(function(d){d.WARNING="@live_uap-warning",d.ERROR="@line_uap-error",d.PUBLISH_STREAM_STATUS="@live_uap-publish-status",d.INJECT_STREAM_STATUS="@live_uap-inject-status",d.WORKER_STATUS="@live_uap-worker-status",d.REQUEST_NEW_ADDRESS="@live_uap-request-address"})(AI||(AI={})),function(d){d.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(Q1||(Q1={})),function(d){d[d.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",d[d.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",d[d.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",d[d.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",d[d.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",d[d.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",d[d.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",d[d.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",d[d.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",d[d.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",d[d.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",d[d.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",d[d.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",d[d.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",d[d.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",d[d.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",d[d.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",d[d.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",d[d.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",d[d.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",d[d.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(JS||(JS={})),function(d){d.CONNECT_FAILED="connect failed",d.CONNECT_TIMEOUT="connect timeout",d.WS_DISCONNECTED="websocket disconnected",d.REQUEST_TIMEOUT="request timeout",d.REQUEST_FAILED="request failed",d.WAIT_STATUS_TIMEOUT="wait status timeout",d.WAIT_STATUS_ERROR="wait status error",d.BAD_STATE="bad state",d.WS_ABORT="ws abort",d.AP_REQUEST_TIMEOUT="AP request timeout",d.AP_JSON_PARSE_ERROR="AP json parse error",d.AP_REQUEST_ERROR="AP request error",d.AP_REQUEST_ABORT="AP request abort"}(P4||(P4={})),function(d){d[d.SetSdkProfile=0]="SetSdkProfile",d[d.SetSourceChannel=1]="SetSourceChannel",d[d.SetSourceUserId=2]="SetSourceUserId",d[d.SetDestChannel=3]="SetDestChannel",d[d.StartPacketTransfer=4]="StartPacketTransfer",d[d.StopPacketTransfer=5]="StopPacketTransfer",d[d.UpdateDestChannel=6]="UpdateDestChannel",d[d.Reconnect=7]="Reconnect",d[d.SetVideoProfile=8]="SetVideoProfile"}(HR||(HR={})),function(d){d.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",d.NETWORK_CONNECTED="NETWORK_CONNECTED",d.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",d.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",d.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",d.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",d.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",d.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",d.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",d.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(XI||(XI={})),function(d){d.RELAY_STATE_IDLE="RELAY_STATE_IDLE",d.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",d.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",d.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(uT||(uT={})),function(d){d.RELAY_OK="RELAY_OK",d.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",d.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",d.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(uN||(uN={})),function(d){d.High="high",d.Low="low",d.Audio="audio",d.Screen="screen",d.ScreenLow="screen_low"}(hR||(hR={})),function(d){d.DISCONNECT="disconnect",d.CONNECTION_STATE_CHANGE="connection-state-change",d.NETWORK_QUALITY="network-quality",d.STREAM_TYPE_CHANGE="stream-type-change",d.IS_P2P_DISCONNECTED="is-p2p-dis",d.DISCONNECT_P2P="dis-p2p",d.REQUEST_NEW_GATEWAY_LIST="req-gate-url",d.NEED_RENEW_SESSION="need-sid",d.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",d.JOIN_RESPONSE="join-response",d.REQUEST_DC_CONNECTION_PARAMS="request-dc-connection-params",d.RESET_CONNECTION_EVENTS="reset-connection-events",d.DATACHANNEL_PRECONNECT="datachannel_preconnect",d.DATACHANNEL_FAILBACK="datachannel_failback",d.RESET_SIGNAL="reset-signal"}(PS||(PS={})),function(d){d[d.Nothing=0]="Nothing",d[d.Audio=1]="Audio",d[d.LwoVideo=2]="LwoVideo",d[d.Video=4]="Video",d[d.Data=8]="Data"}(oR||(oR={})),function(d){d[d.websocket=0]="websocket",d[d.datachannel=1]="datachannel"}(CU||(CU={})),function(d){d.NEED_RENEGOTIATE="@need_renegotiate",d.NEED_REPLACE_TRACK="@need_replace_track",d.NEED_CLOSE="@need_close",d.NEED_ENABLE_TRACK="@need_enable_track",d.NEED_DISABLE_TRACK="@need_disable_track",d.NEED_SESSION_ID="@need_sid",d.SET_OPTIMIZATION_MODE="@set_optimization_mode",d.GET_STATS="@get_stats",d.GET_LOW_VIDEO_TRACK="@get_low_video_track",d.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",d.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",d.NEED_MUTE_TRACK="@need_mute_track",d.NEED_UNMUTE_TRACK="@need_unmute_track"}(I0||(I0={})),function(d){d.SCREEN_TRACK="screen_track",d.CUSTOM_TRACK="custome_track",d.LOW_STREAM="low_stream"}(ER||(ER={})),function(d){d[d.HIGH_STREAM=0]="HIGH_STREAM",d[d.LOW_STREAM=1]="LOW_STREAM"}(Z1||(Z1={})),function(d){d[d.HIGH_STREAM=0]="HIGH_STREAM",d[d.LOW_STREAM=1]="LOW_STREAM"}(u5||(u5={})),function(d){d[d.DISABLE=0]="DISABLE",d[d.LOW_STREAM=1]="LOW_STREAM",d[d.AUDIO_ONLY=2]="AUDIO_ONLY"}(l5||(l5={})),function(d){d.TRANSCEIVER_UPDATED="transceiver-updated"}(mL||(mL={})),function(d){d.SOURCE_STATE_CHANGE="source-state-change",d.TRACK_ENDED="track-ended",d.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",d.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",d.CLOSED="closed"}(lN||(lN={})),function(d){d.FIRST_FRAME_DECODED="first-frame-decoded",d.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(_k||(_k={})),function(d){d.CHINA="CHINA",d.ASIA="ASIA",d.NORTH_AMERICA="NORTH_AMERICA",d.EUROPE="EUROPE",d.JAPAN="JAPAN",d.INDIA="INDIA",d.KOREA="KOREA",d.HKMC="HKMC",d.US="US",d.OCEANIA="OCEANIA",d.SOUTH_AMERICA="SOUTH_AMERICA",d.AFRICA="AFRICA",d.OVERSEA="OVERSEA",d.GLOBAL="GLOBAL",d.EXTENSIONS="EXTENSIONS"}(z0||(z0={}));const xX=[z0.AFRICA,z0.ASIA,z0.CHINA,z0.EUROPE,z0.GLOBAL,z0.INDIA,z0.JAPAN,z0.NORTH_AMERICA,z0.OCEANIA,z0.OVERSEA,z0.SOUTH_AMERICA];let OR;(function(d){d.CHINA="CN",d.ASIA="AS",d.NORTH_AMERICA="NA",d.EUROPE="EU",d.JAPAN="JP",d.INDIA="IN",d.KOREA="KR",d.HKMC="HK",d.US="US",d.OCEANIA="OC",d.SOUTH_AMERICA="SA",d.AFRICA="AF",d.OVERSEA="OVERSEA",d.GLOBAL="GLOBAL",d.EXTENSIONS="GLOBAL"})(OR||(OR={}));const IU={CHINA:{},ASIA:{CODE:OR.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:OR.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:OR.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:OR.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","	uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:OR.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:OR.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:OR.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:OR.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:OR.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:OR.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:OR.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:OR.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:OR.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};let gL,L4,L0,DR,QI,l0,vR,Y0,eT,dN,qR,CT,XT,QT,fR,fO,$S,ZI,M4,UT,pI,pN;H3&&(IU.CHINA={CODE:OR.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(d){d.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(gL||(gL={}));class OU extends US{constructor(h,g){super(),_h(this,"onICEConnectionStateChange",void 0),_h(this,"onConnectionStateChange",void 0),_h(this,"onDTLSTransportStateChange",void 0),_h(this,"onDTLSTransportError",void 0),_h(this,"onICETransportStateChange",void 0),_h(this,"onFirstAudioReceived",void 0),_h(this,"onFirstVideoReceived",void 0),_h(this,"onFirstAudioDecoded",void 0),_h(this,"onFirstVideoDecoded",void 0),_h(this,"onFirstVideoDecodedTimeout",void 0),_h(this,"onSelectedLocalCandidateChanged",void 0),_h(this,"onSelectedRemoteCandidateChanged",void 0),_h(this,"establishPromise",void 0)}}(function(d){d.SEND="sendonly",d.RECV="recvonly",d.SENDRECV="sendrecv",d.INACTIVE="inactive"})(L4||(L4={})),function(d){d.VIDEO="video",d.AUDIO="audio"}(L0||(L0={})),function(d){d[d.UDP=0]="UDP",d[d.TCP=1]="TCP",d[d.RELAY=2]="RELAY"}(DR||(DR={})),function(d){d[d.FIRST_CONNECTION=0]="FIRST_CONNECTION",d[d.TCP_RESTART=1]="TCP_RESTART",d[d.RELAY_RESTART=2]="RELAY_RESTART",d[d.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",d[d.OLD_RESTART=11]="OLD_RESTART",d[d.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED"}(QI||(QI={})),function(d){d.LocalVideoTrack="videoTrack",d.LocalAudioTrack="audioTrack",d.LocalVideoLowTrack="videoLowTrack"}(l0||(l0={})),function(d){d.New="new",d.Connected="connected",d.Reconnecting="reconnecting",d.Disconnected="disconnected"}(vR||(vR={})),function(d){d.StateChange="stateChange",d.IceConnectionStateChange="iceConnectionStateChange",d.RequestMuteLocal="requestMuteLocal",d.RequestUnmuteLocal="requestUnmuteLocal",d.RequestRePublish="requestRePublish",d.RequestReSubscribe="requestReSubscribe",d.RequestUploadStats="requestUploadStats",d.MediaReconnectStart="MediaReconnectStart",d.MediaReconnectEnd="MediaReconnectEnd",d.NeedSignalRTT="NeedSignalRTT",d.RequestRestartICE="RequestRestartIce",d.PeerConnectionStateChange="PeerConnectionStateChange",d.RequestReconnect="RequestReconnect",d.RequestReconnectPC="RequestReconnectPC",d.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",d.P2PLost="P2PLost",d.UpdateVideoEncoder="UpdateVideoEncoder",d.ConnectionTypeChange="ConnectionTypeChange",d.RequestLowStreamParameter="RequestLowStreamParameter",d.QueryClientConnectionState="QueryClientConnectionState"}(Y0||(Y0={})),function(d){d.ONLINE="ONLINE",d.OFFLINE="OFFLINE"}(eT||(eT={})),function(d){d.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",d.ONLINE="ONLINE",d.OFFLINE="OFFLINE"}(dN||(dN={})),function(d){d.ON_TRACK="on_track",d.ON_NODE="on_node"}(qR||(qR={})),function(d){d.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",d.REQUEST_CONSTRAINTS="request_constraints"}(CT||(CT={})),function(d){d.CONNECTING="CONNECTING",d.RECONNECTING="RECONNECTING",d.CONNECTED="CONNECTED",d.CLOSED="CLOSED"}(XT||(XT={})),function(d){d[d.CONNECT_AP=0]="CONNECT_AP",d[d.AP_CONNECTED=1]="AP_CONNECTED",d[d.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",d[d.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",d[d.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",d[d.CONNECT_WORKER=5]="CONNECT_WORKER",d[d.WORKER_CONNECTED=6]="WORKER_CONNECTED",d[d.CLOSED=7]="CLOSED"}(QT||(QT={})),function(d){d.CONNECTION_STATE_CHANGE="connection-state-change",d.STATE_CHANGE="state-change",d.INSPECT_RESULT="inspect-result",d.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",d.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(fR||(fR={})),function(d){d.NETWORK_ERROR="NETWORK_ERROR",d.SERVER_ERROR="SERVER_ERROR",d.MULTI_IP="MULTI_IP",d.TIMEOUT="TIMEOUT",d.OFFLINE="OFFLINE",d.LEAVE="LEAVE",d.P2P_FAILED="P2P_FAILED",d.FALLBACK="FALLBACK"}(fO||(fO={})),function(d){d.CONNECTED="transmitter:connected",d.RECONNECTING="transmitter:reconnecting",d.WILL_RECONNECT="transmitter:will_reconnect",d.CLOSED="transmitter:closed",d.FAILED="transmitter:failed",d.ON_MESSAGE="transmitter:on_message",d.REQUEST_NEW_URLS="transmitter:request_new_urls",d.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",d.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",d.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",d.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",d.FAILBACK="transmitter:failback"}($S||($S={})),function(d){d.CAMERA_CHANGED="camera-changed",d.MICROPHONE_CHANGED="microphone-changed",d.PLAYBACK_DEVICE_CHANGED="playback-device-changed",d.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",d.AUTOPLAY_FAILED="autoplay-failed",d.SECURITY_POLICY_VIOLATION="security-policy-violation"}(ZI||(ZI={})),function(d){d[d.APP_TYPE_INVALID_VALUE=-1]="APP_TYPE_INVALID_VALUE",d[d.APP_TYPE_NATIVE=0]="APP_TYPE_NATIVE",d[d.APP_TYPE_NATIVE_COCOS=1]="APP_TYPE_NATIVE_COCOS",d[d.APP_TYPE_NATIVE_UNITY=2]="APP_TYPE_NATIVE_UNITY",d[d.APP_TYPE_NATIVE_ELECTRON=3]="APP_TYPE_NATIVE_ELECTRON",d[d.APP_TYPE_NATIVE_FLUTTER=4]="APP_TYPE_NATIVE_FLUTTER",d[d.APP_TYPE_NATIVE_UNREAL=5]="APP_TYPE_NATIVE_UNREAL",d[d.APP_TYPE_NATIVE_XAMARIN=6]="APP_TYPE_NATIVE_XAMARIN",d[d.APP_TYPE_NATIVE_API_CLOUD=7]="APP_TYPE_NATIVE_API_CLOUD",d[d.APP_TYPE_NATIVE_REACT_NATIVE=8]="APP_TYPE_NATIVE_REACT_NATIVE",d[d.APP_TYPE_NATIVE_PYTHON=9]="APP_TYPE_NATIVE_PYTHON",d[d.APP_TYPE_NATIVE_COCOS_CREATOR=10]="APP_TYPE_NATIVE_COCOS_CREATOR",d[d.APP_TYPE_NATIVE_RUST=11]="APP_TYPE_NATIVE_RUST",d[d.APP_TYPE_NATIVE_C_SHARP=12]="APP_TYPE_NATIVE_C_SHARP",d[d.APP_TYPE_NATIVE_CEF=13]="APP_TYPE_NATIVE_CEF",d[d.APP_TYPE_NATIVE_UNI_APP=14]="APP_TYPE_NATIVE_UNI_APP",d[d.APP_TYPE_WEBRTC=1e3]="APP_TYPE_WEBRTC",d[d.APP_TYPE_WEBRTC_REACT=1001]="APP_TYPE_WEBRTC_REACT",d[d.APP_TYPE_WEBRTC_VUE=1002]="APP_TYPE_WEBRTC_VUE",d[d.APP_TYPE_WEBRTC_ANGULAR=1003]="APP_TYPE_WEBRTC_ANGULAR"}(M4||(M4={})),function(d){d.CONNECTING="CONNECTING",d.RECONNECTING="RECONNECTING",d.CONNECTED="CONNECTED",d.CLOSED="CLOSED"}(UT||(UT={})),function(d){d.CONNECTION_STATE_CHANGE="connection-state-change",d.STATE_CHANGE="state-change",d.INSPECT_RESULT="inspect-result",d.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",d.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(pI||(pI={})),function(d){d[d.CONNECT_AP=0]="CONNECT_AP",d[d.AP_CONNECTED=1]="AP_CONNECTED",d[d.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",d[d.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",d[d.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",d[d.CONNECT_WORKER=5]="CONNECT_WORKER",d[d.WORKER_CONNECTED=6]="WORKER_CONNECTED",d[d.CLOSED=7]="CLOSED"}(pN||(pN={}));const tT={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1};function QS(){return tT}let yR;(function(d){d[d.CHOOSE_SERVER=11]="CHOOSE_SERVER",d[d.CLOUD_PROXY=18]="CLOUD_PROXY",d[d.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",d[d.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"})(yR||(yR={}));var DX=a_,EL=Array.isArray||function(d){return DX(d)=="Array"},LX=_E,j4=EL,MX=BV,jX=u0,UX=wR("species"),U4=LX.Array,FX=function(d){var h;return j4(d)&&(h=d.constructor,(MX(h)&&(h===U4||j4(h.prototype))||jX(h)&&(h=h[UX])===null)&&(h=void 0)),h===void 0?U4:h},F4=function(d,h){return new(FX(d))(h===0?0:h)},BX=wO,VX=e0,GX=hT,$X=$I,WX=F4,B4=ba([].push),hN=function(d){var h=d==1,g=d==2,j=d==3,_t=d==4,_i=d==6,_o=d==7,ga=d==5||_i;return function(_a,_u,_c,_l){for(var _g,r_,l_=GX(_a),d_=VX(l_),p_=BX(_u,_c),C_=$X(d_),O_=0,q_=_l||WX,c0=h?q_(_a,C_):g||_o?q_(_a,0):void 0;C_>O_;O_++)if((ga||O_ in d_)&&(r_=p_(_g=d_[O_],O_,l_),d))if(h)c0[O_]=r_;else if(r_)switch(d){case 3:return!0;case 5:return _g;case 6:return O_;case 2:B4(c0,_g)}else switch(d){case 4:return!1;case 7:B4(c0,_g)}return _i?-1:j||_t?_t:c0}},V4={forEach:hN(0),map:hN(1),filter:hN(2),some:hN(3),every:hN(4),find:hN(5),findIndex:hN(6),filterReject:hN(7)},HX=V4.forEach,G4=UP("forEach")?[].forEach:function(d){return HX(this,d,arguments.length>1?arguments[1]:void 0)};PR({target:"Array",proto:!0,forced:[].forEach!=G4},{forEach:G4});var qX=UR("Array").forEach,zX=uO,KX=IS,YX=_p,JX=qX,d5=Array.prototype,XX={DOMTokenList:!0,NodeList:!0},QX=function(d){var h=d.forEach;return d===d5||YX(d5,d)&&h===d5.forEach||KX(XX,zX(d))?JX:h},ZX=hT,$4=ZO;PR({target:"Object",stat:!0,forced:_(function(){$4(1)})},{keys:function(d){return $4(ZX(d))}});var eQ=s0.Object.keys,tQ=hM,nQ=PR,rQ=EL,iQ=ba([].reverse),W4=[1,2];nQ({target:"Array",proto:!0,forced:String(W4)===String(W4.reverse())},{reverse:function(){return rQ(this)&&(this.length=this.length),iQ(this)}});var oQ=UR("Array").reverse,sQ=_p,aQ=oQ,p5=Array.prototype,cQ=function(d){var h=d.reverse;return d===p5||sQ(p5,d)&&h===p5.reverse?aQ:h},uQ=_,lQ=yS,dQ=wR("species"),H4=function(d){return lQ>=51||!uQ(function(){var h=[];return(h.constructor={})[dQ]=function(){return{foo:1}},h[d](Boolean).foo!==1})},pQ=PR,hQ=_E,q4=EL,fQ=BV,mQ=u0,z4=GP,gQ=$I,EQ=m0,vQ=K3,_Q=wR,yQ=VV,bQ=H4("slice"),SQ=_Q("species"),h5=hQ.Array,RQ=Math.max;pQ({target:"Array",proto:!0,forced:!bQ},{slice:function(d,h){var g,j,_t,_i=EQ(this),_o=gQ(_i),ga=z4(d,_o),_a=z4(h===void 0?_o:h,_o);if(q4(_i)&&(g=_i.constructor,(fQ(g)&&(g===h5||q4(g.prototype))||mQ(g)&&(g=g[SQ])===null)&&(g=void 0),g===h5||g===void 0))return yQ(_i,ga,_a);for(j=new(g===void 0?h5:g)(RQ(_a-ga,0)),_t=0;ga<_a;ga++,_t++)ga in _i&&vQ(j,_t,_i[ga]);return j.length=_t,j}});var TQ=UR("Array").slice,wQ=_p,CQ=TQ,f5=Array.prototype,IQ=function(d){var h=d.slice;return d===f5||wQ(f5,d)&&h===f5.slice?CQ:h};function G_(d,h,g,j,_t){var _i,_o,ga,_a={};return QX(_i=eQ(j)).call(_i,function(_u){_a[_u]=j[_u]}),_a.enumerable=!!_a.enumerable,_a.configurable=!!_a.configurable,("value"in _a||_a.initializer)&&(_a.writable=!0),_a=tQ(_o=cQ(ga=IQ(g).call(g)).call(ga)).call(_o,function(_u,_c){return _c(d,h,_u)||_u},_a),_t&&_a.initializer!==void 0&&(_a.value=_a.initializer?_a.initializer.call(_t):void 0,_a.initializer=void 0),_a.initializer===void 0&&(D2(d,h,_a),_a=null),_a}var OQ=UR("Array").keys,AQ=uO,NQ=IS,kQ=_p,PQ=OQ,m5=Array.prototype,xQ={DOMTokenList:!0,NodeList:!0},n1=function(d){var h=d.keys;return d===m5||kQ(m5,d)&&h===m5.keys||NQ(xQ,AQ(d))?PQ:h};function K4(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function Y4(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?K4(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):K4(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}let AU=0,g5=0;function NI(d,h,g,j){return new a0((_t,_i)=>{h.timeout=h.timeout||__("HTTP_CONNECT_TIMEOUT"),h.responseType=h.responseType||"json",h.data&&!g?(h.data=JSON.stringify(h.data),AU+=oP(h.data)):g&&(h.data.size?AU+=h.data.size:h.data instanceof FormData?AU+=function(_o){let ga=0;return/DingTalk/i.test(navigator.userAgent)&&_o.realFormData&&(_o=_o.realFormData),_o.forEach(_a=>{ga+=typeof _a=="string"?oP(_a):_a.size}),ga+138}(h.data):AU+=oP(JSON.stringify(h.data))),h.headers=h.headers||{},h.headers["Content-Type"]=h.headers["Content-Type"]||"application/json",h.method="POST",h.url=d,KT.request(h).then(_o=>{typeof _o.data=="string"?g5+=oP(_o.data):_o.data instanceof ArrayBuffer||_o.data instanceof Uint8Array?g5+=_o.data.byteLength:g5+=oP(JSON.stringify(_o.data)),j&&_t({data:_o.data,headers:_o.headers}),_t(_o.data)}).catch(_o=>{KT.isCancel(_o)?_i(new f_(c_.OPERATION_ABORTED,"cancel token canceled")):_o.code==="ECONNABORTED"?_i(new f_(c_.NETWORK_TIMEOUT,_o.message)):_o.response?_i(new f_(c_.NETWORK_RESPONSE_ERROR,_o.response.status)):_i(new f_(c_.NETWORK_ERROR,_o.message))})})}async function DQ(d,h){const g=new Blob([h.data],{type:"buffer"});return await NI(d,Y4(Y4({},h),{},{data:g,headers:{"Content-Type":"application/octet-stream"}}),!0)}const sR=new class extends US{set networkState(d){wE.info("[".concat(this._moduleName,"]")+"network state changed, "+this._networkState+" -> "+d),this.emit(dN.NETWORK_STATE_CHANGE,d,this._networkState),d===eT.ONLINE?this.emit(dN.ONLINE):d===eT.OFFLINE&&(this.onlineWaiter=new a0(h=>{this.once(dN.ONLINE,()=>{this.onlineWaiter=void 0,h(eT.ONLINE)})}),this.emit(dN.OFFLINE)),this._networkState=d}get networkState(){return this._networkState}constructor(){super(),_h(this,"_moduleName","network-indicator"),_h(this,"_networkState",eT.ONLINE),_h(this,"onlineWaiter",void 0),window.addEventListener("online",()=>{this.networkState=eT.ONLINE}),window.addEventListener("offline",()=>{this.networkState=eT.OFFLINE})}};let E5=!1;const ZT=new class extends US{constructor(){super(...arguments),_h(this,"onAutoplayFailed",void 0),_h(this,"onAudioAutoplayFailed",void 0)}};function J4(){if(sS(),!E5){const d=h=>{h.preventDefault(),E5=!1,uL()?document.body.removeEventListener("click",d,!0):(document.body.removeEventListener("touchstart",d,!0),document.body.removeEventListener("mousedown",d,!0))};E5=!0,uL()?document.body.addEventListener("click",d,!0):(document.body.addEventListener("touchstart",d,!0),document.body.addEventListener("mousedown",d,!0)),wE.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),ZT.onAutoplayFailed?ZT.onAutoplayFailed():ZT.onAudioAutoplayFailed?wE.warning(`AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.

  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`):wE.warning(`We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.

  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.

  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web .`),ZT.emit("autoplay-failed")}}function v5(d){return new TextEncoder().encode(d)}const X4=function(d,h){const g=new Uint8Array(d.byteLength+h.byteLength);return g.set(new Uint8Array(d),0),g.set(new Uint8Array(h),d.byteLength),g},LQ=async d=>function(h,g){let j="";return new Uint8Array(h).forEach(_t=>{j+=_t.toString(g).padStart(2,"0")}),j}(await crypto.subtle.digest("SHA-256",v5(d)),16);function Q4(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function M0(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?Q4(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):Q4(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}function b0(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return function(h,g,j){const _t=j.value;if(typeof _t=="function"){const _i=d.className||h.__className__||(h.constructor.name==="AgoraRTCClient"?"Client":h.constructor.name);j.value=function(){for(var _o=arguments.length,ga=new Array(_o),_a=0;_a<_o;_a++)ga[_a]=arguments[_a];let _u=ga;if(d.argsMap)try{_u=d.argsMap(this,...ga)}catch(_l){wE.warning(_l),_u=[]}try{JSON.stringify(_u)}catch{wE.warning("arguments for method ".concat(_i,".").concat(String(g)," not serializable for apiInvoke.")),_u=[]}const _c=(d.report||p0).reportApiInvoke(this._sessionId||null,{name:"".concat(_i,".").concat(String(g)),options:_u,tag:kS.TRACER,reportResult:d.reportResult},d.throttleTime);try{const _l=_t.apply(this,ga);return _l instanceof a0?_l.then(_g=>(_c.onSuccess(d.reportResult&&_g),_g)).catch(_g=>{throw _c.onError(_g),_g}):(_c.onSuccess(d.reportResult&&_l),_l)}catch(_l){throw _c.onError(_l),_l}}}return j}}const p0=new class{constructor(){_h(this,"baseInfoMap",new Map),_h(this,"proxyServer",void 0),_h(this,"clientList",ZN),_h(this,"eventUploadTimer",void 0),_h(this,"setSessionIdTimer",void 0),_h(this,"url",void 0),_h(this,"backupUrl",void 0),_h(this,"_appId",void 0),_h(this,"keyEventUploadPendingItems",[]),_h(this,"normalEventUploadPendingItems",[]),_h(this,"apiInvokeUploadPendingItems",[]),_h(this,"apiInvokeCount",0),_h(this,"ltsList",[]),_h(this,"lastSendNormalEventTime",Date.now()),_h(this,"customReportCounterTimer",void 0),_h(this,"customReportCount",0),_h(this,"extApiInvoke",async d=>{for(const h of d){const g=M0(M0({},h),{},{sid:null,invokeId:++this.apiInvokeCount,tag:kS.TRACER});this.sendApiInvoke(g)}}),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),__("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),__("EVENT_REPORT_SEND_INTERVAL"))}adjustSessionStartTime(d){if(!this.baseInfoMap.has(d)&&!this.baseInfoMap.get(d))return void wE.error("adjust session ".concat(d," start time, sid is not exist or info is undefined"));const h=this.baseInfoMap.get(d),g=Date.now(),j=h.startTime;h.startTime=g,wE.debug("rewrite session ".concat(d," startTime: ").concat(g," , ").concat(g-j,"ms")),this.baseInfoMap.set(d,h)}setAppId(d){this._appId=d}reportApiInvoke(d,h,g){h.timeout=h.timeout||6e4,h.reportResult=h.reportResult===void 0||h.reportResult;const j=Date.now();this.apiInvokeCount+=1;const _t=this.apiInvokeCount,_i=()=>({tag:h.tag,invokeId:_t,sid:d,name:h.name,apiInvokeTime:j,options:h.options,states:h.states||null}),_o=!!__("SHOW_REPORT_INVOKER_LOG");_o&&wE.info("".concat(h.name," start"),h.options);let ga=!1;KR(h.timeout).then(()=>{ga||(this.sendApiInvoke(M0(M0({},_i()),{},{error:c_.API_INVOKE_TIMEOUT,success:!1})),wE.debug("".concat(h.name," timeout")))});const _a=new f_(c_.UNEXPECTED_ERROR,"".concat(h.name,": this api invoke is end"));return{onSuccess:_u=>{const _c=()=>{if(ga)throw _a;return ga=!0,this.sendApiInvoke(M0(M0({},_i()),{},{success:!0},h.reportResult&&{result:_u})),_o&&wE.info("".concat(h.name," onSuccess")),_u};return g?fW(_c,h.name+"Success",g,()=>ga=!0):_c()},onError:_u=>{const _c=()=>{if(ga)throw _u;ga=!0,this.sendApiInvoke(M0(M0({},_i()),{},{success:!1,error:_u})),_o&&wE.info("".concat(h.name," onFailure"),_u.toString())};return g?fW(_c,h.name+"Error",g,()=>ga=!0):_c()}}}sessionInit(d,h){if(this.baseInfoMap.has(d))return;const g=Date.now(),j=this.createBaseInfo(d,g);j.cname=h.cname;const _t=Object.assign({},{willUploadConsoleLog:__("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:H3?"global":"oversea",areas:__("AREAS")&&__("AREAS").join(",")},h.extend),_i=Date.now(),_o=M0(M0({},j),{},{eventType:xR.SESSION_INIT,appid:h.appid,browser:navigator.userAgent,build:W3,lts:_i,elapse:_i-g,extend:JSON.stringify(_t),mode:h.mode,process:__("PROCESS_ID"),appType:__("APP_TYPE"),success:!0,version:dI});this.send({type:FS.SESSION,data:_o},!0)}joinChooseServer(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now(),_i=M0(M0({},j),{},{eventType:xR.JOIN_CHOOSE_SERVER,lts:_t,eventElapse:_t-h.lts,chooseServerAddr:h.csAddr,errorCode:h.ec,elapse:_t-g.startTime,success:h.succ,chooseServerAddrList:JSON.stringify(h.serverList),uid:h.uid?parseInt(h.uid):null,cid:h.cid?parseInt(h.cid):null,chooseServerIp:h.csIp||"",opid:h.opid,unilbsServerIds:h.unilbsServerIds,extend:h.extend||void 0,isHttp3:h.isHttp3});this.send({type:FS.JOIN_CHOOSE_SERVER,data:_i},!0)}reqUserAccount(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now(),_i=M0(M0({},j),{},{eventType:xR.REQ_USER_ACCOUNT,lts:_t,success:h.success,serverAddress:h.serverAddr,stringUid:h.stringUid,uid:h.uid,errorCode:h.errorCode,elapse:_t-g.startTime,eventElapse:_t-h.lts,extend:JSON.stringify(h.extend)});this.send({type:FS.REQ_USER_ACCOUNT,data:_i},!0)}joinGateway(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info;h.vid&&(j.vid=h.vid),j.uid=h.uid,j.cid=h.cid;const _t=Date.now(),{firstSuccess:_i,avoidJoinStartTime:_o,isProxy:ga,addr:_a}=h,_u=_t-(_i&&_o?_o:g.startTime),_c=M0(M0({},j),{},{eventType:xR.JOIN_GATEWAY,lts:_t,gatewayAddr:h.addr,success:h.succ,errorCode:h.ec,elapse:_u,eventElapse:_t-h.lts,firstSuccess:_i,signalChannel:h.signalChannel}),_l=_c.success?1:0;if(h.succ&&(g.lastJoinSuccessTime=_t),_i)this.send({type:FS.JOIN_GATEWAY,data:_c},!0);else{let _g;if(_a)if(ga){const l_=_a.match(/h=(\d{1,3}-){3}\d{1,3}/g),d_=_a.match(/p=[0-9]{1,6}/g);_g={isSuccess:_l,gatewayIp:l_&&l_.length?l_[0].split("=")[1].replace(/-/g,"."):"",port:d_&&d_.length?d_[0].split("=")[1]:"",isProxy:ga?1:0}}else{const l_=_a.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),d_=_a.match(/:[0-9]{1,6}/g);_g={isSuccess:_l,gatewayIp:l_&&l_.length?l_[0].split("//")[1].replace(/-/g,"."):"",port:d_&&d_.length?d_[0].split(":")[1]:"",isProxy:ga?1:0}}else _g={isSuccess:_l,gatewayIp:"",port:"",isProxy:ga?1:0};delete _c.success,delete _c.eventType,delete _c.firstSuccess,_c.vid=Number(_c.vid);const r_=Object.assign({},_c,_g,{eventType:xR.REJOIN_GATEWAY});this.send({type:FS.RE_JOIN_GATEWAY,data:r_},!0)}}joinChannelTimeout(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=Date.now(),_t=M0(M0({},g.info),{},{lts:j,timeout:h,elapse:j-g.startTime});this.send({type:FS.JOIN_CHANNEL_TIMEOUT,data:_t},!0)}publish(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now(),_i=M0(M0({},j),{},{eventType:xR.PUBLISH,lts:_t,eventElapse:h.eventElapse,elapse:_t-g.startTime,success:h.succ,errorCode:h.ec,videoName:h.videoName,audioName:h.audioName,screenName:h.screenName,screenshare:h.screenshare,audio:h.audio,video:h.video,p2pid:h.p2pid,publishRequestid:h.publishRequestid});this.send({type:FS.PUBLISH,data:_i},!0)}subscribe(d,h,g){const j=this.baseInfoMap.get(d);if(!j)return;const _t=j.info,_i=Date.now(),_o=M0(M0({},_t),{},{eventType:xR.SUBSCRIBE,lts:_i,eventElapse:h.eventElapse,elapse:_i-j.startTime,success:h.succ,errorCode:h.ec,video:h.video,audio:h.audio,subscribeRequestid:h.subscribeRequestid,p2pid:h.p2pid},g&&{extend:JSON.stringify({isMassSubscribe:!0})});typeof h.peerid=="string"?_o.peerSuid=h.peerid:_o.peer=h.peerid,this.send({type:FS.SUBSCRIBE,data:_o},!0)}wsCompressorInit(d){var h;const g=[...n1(h=this.baseInfoMap).call(h)],j=g.length?g[0]:"UnableToGetSid",_t=this.baseInfoMap.get(j);if(!_t)return;const _i=_t.info,_o=Date.now(),ga=M0(M0({},_i),{},{eventType:xR.WS_COMPRESSOR_INIT,lts:_o,eventElapse:d.eventElapse,elapse:_o-_t.startTime,status:d.status?1:2});this.send({type:FS.WS_COMPRESSOR_INIT,data:ga},!0)}firstRemoteVideoDecode(d,h,g,j){const _t=this.baseInfoMap.get(d);if(!_t)return;const _i=_t.info,_o=Date.now(),ga=M0(M0(M0({},_i),j),{},{elapse:_o-_t.startTime,eventType:h,lts:_o,firstDecodeFrame:Math.max(_o-_t.startTime,0),apEnd:Math.max(j.apEnd-_t.startTime,0),apStart:Math.max(j.apStart-_t.startTime,0),joinGwEnd:Math.max(j.joinGwEnd-_t.startTime,0),joinGwStart:Math.max(j.joinGwStart-_t.startTime,0),pcEnd:Math.max(j.pcEnd-_t.startTime,0),pcStart:Math.max(j.pcStart-_t.startTime,0),subscriberEnd:Math.max(j.subscriberEnd-_t.startTime,0),subscriberStart:Math.max(j.subscriberStart-_t.startTime,0),videoAddNotify:Math.max(j.videoAddNotify-_t.startTime,0)});this.send({type:g,data:ga},!0)}firstRemoteFrame(d,h,g,j){const _t=this.baseInfoMap.get(d);if(!_t)return;const _i=_t.info,_o=Date.now(),ga=M0(M0(M0({},_i),j),{},{elapse:_o-_t.startTime,eventType:h,lts:_o});this.send({type:g,data:ga},!0)}pcStats(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now(),_i=M0(M0(M0({},j),h),{},{vid:j.vid===void 0?0:Number(j.vid),elapse:_t-g.startTime,eventType:xR.PC_STATS,lts:_t});this.send({type:FS.PC_STATS,data:_i},!0)}onGatewayStream(d,h,g,j){const _t=this.baseInfoMap.get(d);if(!_t)return;const _i=_t.info,_o=Date.now(),ga=M0(M0(M0({},_i),j),{},{eventType:h,lts:_o});this.send({type:g,data:ga},!0)}streamSwitch(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now(),_i=M0(M0({},j),{},{eventType:xR.STREAM_SWITCH,lts:_t,isDual:h.isdual,elapse:_t-g.startTime,success:h.succ});this.send({type:FS.STREAM_SWITCH,data:_i},!0)}requestProxyAppCenter(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now(),_i=M0(M0({},j),{},{eventType:xR.REQUEST_PROXY_APPCENTER,lts:_t,eventElapse:_t-h.lts,elapse:_t-g.startTime,APAddr:h.APAddr,workerManagerList:h.workerManagerList,response:h.response,errorCode:h.ec,success:h.succ});this.send({type:FS.REQUEST_PROXY_APPCENTER,data:_i},!0)}requestProxyWorkerManager(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now(),_i=M0(M0({},j),{},{eventType:xR.REQUEST_PROXY_WORKER_MANAGER,lts:_t,eventElapse:_t-h.lts,elapse:_t-g.startTime,workerManagerAddr:h.workerManagerAddr,response:h.response,errorCode:h.ec,success:h.succ});this.send({type:FS.REQUEST_PROXY_WORKER_MANAGER,data:_i},!0)}setProxyServer(d){this.proxyServer=d,d?wE.debug("reportProxyServerurl: ".concat(d)):wE.debug("disable reportProxyServerurl: ".concat(d))}peerPublishStatus(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now(),_i=M0(M0({},j),{},{subscribeElapse:h.subscribeElapse,peer:h.peer,peerPublishDuration:Math.max(h.audioPublishDuration,h.videoPublishDuration),audiotag:h.audioPublishDuration>0?1:-1,videotag:h.videoPublishDuration>0?1:-1,lts:_t,elapse:_t-g.startTime,joinChannelSuccessElapse:_t-(g.lastJoinSuccessTime||_t),peerPublishDurationVideo:h.videoPublishDuration,peerPublishDurationAudio:h.audioPublishDuration});this.send({type:FS.PEER_PUBLISH_STATUS,data:_i},!0)}workerEvent(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now();(function(_i,_o,ga){const _a=_i[_o];if(!_a||typeof _a!="string")return[_i];_i[_o]="";const _u=oP(JSON.stringify(_i));let _c=0;const _l=[];let _g=0;for(let r_=0;r_<_a.length;r_++)_g+=_a.charCodeAt(r_)<=127?1:3,_g<=ga-_u||(_l[_l.length]=o1(o1({},_i),{},{[_o]:_a.substring(_c,r_)}),_c=r_,_g=_a.charCodeAt(r_)<=127?1:3);return _c!==_a.length-1&&(_l[_l.length]=o1(o1({},_i),{},{[_o]:_a.substring(_c)})),_l})(M0(M0(M0({},j),h),{},{elapse:_t-g.startTime,lts:_t,productType:"WebRTC"}),"payload",1300).forEach(_i=>this.send({type:FS.WORKER_EVENT,data:_i},!0))}apworkerEvent(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now(),_i=M0(M0(M0({},j),h),{},{elapse:_t-g.startTime,lts:_t});this.send({type:FS.AP_WORKER_EVENT,data:_i},!0)}joinWebProxyAP(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now(),_i=M0(M0(M0({},j),h),{},{elapse:_t-g.startTime,lts:_t,extend:h.extend||void 0});this.send({type:FS.JOIN_WEB_PROXY_AP,data:_i},!0)}WebSocketQuit(d,h){const g=this.baseInfoMap.get(d);if(!g)return;const j=g.info,_t=Date.now(),_i=M0(M0(M0({},j),h),{},{elapse:_t-g.startTime,lts:_t});this.send({type:FS.WEBSOCKET_QUIT,data:_i},!0)}async sendCustomReportMessage(d,h){if(this.customReportCount+=h.length,this.customReportCount>__("CUSTOM_REPORT_LIMIT"))throw new f_(c_.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval(()=>{this.customReportCount=0},5e3));const g=Date.now(),j=h.map(_t=>({type:FS.USER_ANALYTICS,data:M0(M0({sid:d},_t),{},{lts:g})}));try{__("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(j):await this.postDataToStatsCollector(j)}catch(_t){throw wE.error("send custom report message failed",_t.toString()),new f_(c_.CUSTOM_REPORT_SEND_FAILED,_t.message)}}autoplayFailed(d,h,g,j){if(!d)return;const _t=this.baseInfoMap.get(d);if(!_t)return;const _i=_t.info,_o=Date.now(),ga=M0(M0({},_i),{},{vid:_i.vid===void 0?0:Number(_i.vid),lts:_o,elapse:_o-_t.startTime,cbRegistered:ZT.onAutoplayFailed||ZT.onAudioAutoplayFailed?1:-1,errorMsg:g,mediaType:h,trackId:j,extend:void 0});this.send({type:FS.AUTOPLAY_FAILED,data:ga},!0)}sendApiInvoke(d){const h=__("NOT_REPORT_EVENT");if(d.tag&&h.includes&&h.includes(d.tag))return!1;if(d.sid===null)return this.apiInvokeUploadPendingItems.push(d),!1;const g=this.baseInfoMap.get(d.sid);if(!g)return this.apiInvokeUploadPendingItems.push(d),!1;const{cname:j,uid:_t,cid:_i}=g.info;d.lts=d.lts||Date.now();let _o;if(d.error)if(d.error instanceof f_){const{code:_a,message:_u}=d.error;_o=_a||_u||d.error.toString()}else _o=d.error.toString();const ga={invokeId:d.invokeId,sid:d.sid,cname:j,cid:_i,uid:_t,lts:d.lts,success:d.success,elapse:d.lts-g.startTime,execElapse:d.lts-d.apiInvokeTime,apiName:d.name,options:d.options?JSON.stringify(d.options):void 0,execStates:d.states?JSON.stringify(d.states):void 0,execResult:d.result?JSON.stringify(d.result):void 0,errorCode:d.error?_o:void 0,errorMsg:d.error?JSON.stringify(d.error):void 0};return this.send({type:FS.API_INVOKE,data:ga},!1),!0}appendSessionId(){this.clientList.forEach(d=>{if(d._sessionId){const h=this.apiInvokeUploadPendingItems.length;for(let g=0;g<h;g++){const j=this.apiInvokeUploadPendingItems.shift();j&&(j.sid=d._sessionId,this.sendApiInvoke(Object.assign({},j)))}}})}send(d,h){if(h)return this.keyEventUploadPendingItems.push(d),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(d),this.normalEventUploadPendingItems.length>__("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(d,h){const g=[],j=[];for(;d.length;){const _i=d.shift();g.length<20?g.push(_i):j.push(_i)}d.push(...j);for(const _i of[...g]){var _t;this.ltsList.indexOf(_i.data.lts)!==-1?(_i.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(_i.data.lts)):(this.ltsList.push(_i.data.lts),Q3(_t=this.ltsList).call(_t,(_o,ga)=>_o-ga))}return h||(this.lastSendNormalEventTime=Date.now()),__("ENABLE_EVENT_REPORT")&&g.length&&(__("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(g):this.postDataToStatsCollector(g)).catch((_i=>_o=>{__("EVENT_REPORT_RETRY")&&(h?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(_i):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(_i),this.normalEventUploadPendingItems.length>__("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-__("NORMAL_EVENT_QUEUE_CAPACITY")),wE.warning("report: drop normal events"))))})(g)),d}async postDataToStatsCollector2(d){sR.networkState===eT.OFFLINE&&await a0.race([sR.onlineWaiter,KR(2*rR.maxRetryTimeout)]);const h=_t=>{let _i=new Uint8Array;return _t.forEach(_o=>{const ga=v5(JSON.stringify(_o.data)),_a=new ArrayBuffer(5),_u=(_l=>{let _g=0;return Object.entries(FS).forEach(r_=>{let[l_,d_]=r_;d_===_l.type&&(_g=r5[l_])}),_g})(_o),_c=new DataView(_a);_c.setUint16(0,ga.byteLength,!0),_c.setUint8(2,255&_u),_c.setUint8(3,_u>>>8&255),_c.setUint8(4,_u>>>16&255),_i=X4(_i,new Uint8Array(_a)),_i=X4(_i,ga)}),_i},g="event";let j=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(__("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(g):"https://".concat(__("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(g);for(let _t=0;_t<2;_t+=1){_t===1&&(j=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(__("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(g):"https://".concat(__("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(g));try{await NI(j,{timeout:1e4,data:h(d),headers:M0(M0({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(_i){if(_t===1)throw _i;continue}return}}async postDataToStatsCollector(d){let h=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const g={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:d.map(_i=>JSON.stringify(_i)),vid:(_i=>{const _o=_i&&_i.data.sid&&this.baseInfoMap.get(_i.data.sid);return _o&&_o.info.vid&&+_o.info.vid||0})(d[0])};sR.networkState===eT.OFFLINE&&await a0.race([sR.onlineWaiter,KR(2*rR.maxRetryTimeout)]);const j=h?"/events/proto-raws":"/events/messages";let _t=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(__("EVENT_REPORT_DOMAIN"),"&p=").concat(__("STATS_COLLECTOR_PORT"),"&d=").concat(j):"https://".concat(__("EVENT_REPORT_DOMAIN"),":").concat(__("STATS_COLLECTOR_PORT")).concat(j));for(let _i=0;_i<2;_i+=1){_i===1&&(_t=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(__("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(__("STATS_COLLECTOR_PORT"),"&d=").concat(j):"https://".concat(__("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(__("STATS_COLLECTOR_PORT")).concat(j)));try{h?await DQ(_t,{timeout:1e4,data:g}):await NI(_t,{timeout:1e4,data:g})}catch(_o){if(_i===1)throw _o;continue}return}}createBaseInfo(d,h){const g=Object.assign({},IX);return g.sid=d,this.baseInfoMap.set(d,{info:g,startTime:h}),g}reportResourceTiming(d,h){const g=performance.getEntriesByName(d),j=g[g.length-1];j&&this.reportApiInvoke(h,{name:"Client.resourceTiming",options:j,tag:kS.TRACER}).onSuccess()}};SU.on("REPORT_LOG_UPLOAD",d=>{d.networkState=sR.networkState,p0.reportApiInvoke(null,{name:"logUploadError",options:d,tag:kS.TRACER})});class Z4 extends US{constructor(h,g){super(),_h(this,"trackMediaType",void 0),_h(this,"_ID",void 0),_h(this,"_rtpTransceiver",void 0),_h(this,"_lowRtpTransceiver",void 0),_h(this,"_hints",[]),_h(this,"_isClosed",!1),_h(this,"_originMediaStreamTrack",void 0),_h(this,"_mediaStreamTrack",void 0),_h(this,"_external",{}),this._ID=g||CS(8,"track-"),this._originMediaStreamTrack=h,this._mediaStreamTrack=h,function(j){pL.includes(j)||pL.push(j)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(h){if(!h){const g=p0.reportApiInvoke(null,{name:iR.GET_MEDIA_STREAM_TRACK,options:[],tag:kS.TRACER});this._mediaStreamTrack&&typeof this._mediaStreamTrack.label=="string"?g.onSuccess(this._mediaStreamTrack.label):g.onSuccess("")}return this._mediaStreamTrack}getRTCRtpTransceiver(h){return h===Z1.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(h){const g=pL.indexOf(h);g!==-1&&pL.splice(g,1)}(this),this.emit(lN.CLOSED)}_updateRtpTransceiver(h,g){if(g===Z1.LOW_STREAM){if(this._lowRtpTransceiver===h)return;this._lowRtpTransceiver=h}else{if(this._rtpTransceiver===h)return;this._rtpTransceiver=h}this.emit(mL.TRANSCEIVER_UPDATED,h,g)}}let bR,MQ=1;class lT{constructor(h){_h(this,"lockingPromise",a0.resolve()),_h(this,"locks",0),_h(this,"name",""),_h(this,"lockId",void 0),this.lockId=MQ++,h&&(this.name=h),wE.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(h){let g;this.locks+=1,wE.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat(typeof h=="string"?h:""));const j=new a0(_i=>{g=()=>{this.locks-=1,wE.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat(typeof h=="string"?h:"")),_i()}}),_t=this.lockingPromise.then(()=>g);return this.lockingPromise=this.lockingPromise.then(()=>j),_t}}function eP(d,h){return function(g,j,_t){const _i=_t.value;if(typeof _i!="function")throw new Error("Cannot use mutex on object property.");return _t.value=async function(){const _o=this[h];if(!_o)throw new Error("mutex property key ".concat(h," doesn't exist on ").concat(d));const ga=await _o.lock("From ".concat(d,".").concat(j));try{for(var _a=arguments.length,_u=new Array(_a),_c=0;_c<_a;_c++)_u[_c]=arguments[_c];return await _i.apply(this,_u)}finally{ga()}},_t}}class _5 extends Z4{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}set processorContext(h){this._processorContext=h}constructor(h,g){super(h,g),_h(this,"_enabled",!0),_h(this,"_muted",!1),_h(this,"_isExternalTrack",!1),_h(this,"_isClosed",!1),_h(this,"_enabledMutex",void 0),_h(this,"processor",void 0),_h(this,"_processorContext",void 0),_h(this,"_handleTrackEnded",()=>{this.onTrackEnded()}),this._enabledMutex=new lT("".concat(this.getTrackId())),h.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var h,g;return(h=(g=this._originMediaStreamTrack)===null||g===void 0?void 0:g.label)!==null&&h!==void 0?h:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,wE.debug("[".concat(this.getTrackId(),"] close")),this.emit(I0.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(h,g){let j=arguments.length>2&&arguments[2]!==void 0&&arguments[2];this._isExternalTrack=j,h!==this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),g&&this._originMediaStreamTrack.stop(),h.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=h,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await qS(this,I0.NEED_REPLACE_TRACK,this),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){wE.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(lN.TRACK_ENDED)}stateCheck(h,g){if(wE.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(h,": ").concat(g,"]")),J1(g,h),this._enabled&&this._muted&&h==="enabled"&&g===!1)throw new f_(c_.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print();if(!this._enabled&&!this._muted&&h==="muted"&&g===!0)throw new f_(c_.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}function e$(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}(function(d){d.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",d.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",d.IOS_INTERRUPTION_START="ios-interruption-start",d.IOS_INTERRUPTION_END="ios-interruption-end",d.STATE_CHANGE="state-change"})(bR||(bR={}));const t$=window.AudioContext||window.webkitAudioContext;let _w=null;const cS=new class extends US{constructor(){super(...arguments),_h(this,"prevState",void 0),_h(this,"curState",void 0),_h(this,"currentTime",void 0),_h(this,"currentTimeStuckAt",void 0),_h(this,"interruptDetectorTrack",void 0),_h(this,"onLocalAudioTrackMute",()=>{wE.info("ios15-interruption-start"),this.emit(bR.IOS_15_16_INTERRUPTION_START)}),_h(this,"onLocalAudioTrackUnmute",async()=>{wE.info("ios15-interruption-end"),this.curState!=="running"||this.duringInterruption?wE.info("ios15-interruption-end-canceled"):(_w&&await _w.suspend(),this.emit(bR.IOS_15_16_INTERRUPTION_END))})}get duringInterruption(){return this.prevState==="running"&&this.curState==="interrupted"}bindInterruptDetectorTrack(d){wE.debug("webaudio bindInterruptDetectorTrack ".concat(d.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=d,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(d){wE.debug("webaudio unbindInterruptDetectorTrack ".concat(d.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===d&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function jQ(){if(!t$)return void wE.error("your browser is not support web audio");wE.info("create audio context");const d=function(h){for(var g=1;g<arguments.length;g++){var j=arguments[g]!=null?arguments[g]:{};g%2?e$(Object(j),!0).forEach(function(_t){_h(h,_t,j[_t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(h,Object.getOwnPropertyDescriptors(j)):e$(Object(j)).forEach(function(_t){Object.defineProperty(h,_t,Object.getOwnPropertyDescriptor(j,_t))})}return h}({},__("WEBAUDIO_INIT_OPTIONS"));wE.debug("audio context init option:",JSON.stringify(d)),_w=new t$(d),cS.curState=_w.state,_w.onstatechange=()=>{cS.prevState=cS.curState,cS.curState=_w?_w.state:void 0;const{prevState:h,curState:g}=cS,j=g==="running",_t=g==="interrupted",_i=h==="running",_o=h==="suspended",ga=h==="interrupted",_a=sS().osVersion;(aT()||hO())&&_i&&_t&&(wE.info("ios".concat(_a,"-interruption-start")),cS.emit(bR.IOS_INTERRUPTION_START)),(aT()||hO())&&(_o||ga)&&j&&(wE.info("ios".concat(_a,"-interruption-end")),cS.emit(bR.IOS_INTERRUPTION_END)),h!==g&&(wE.debug("AudioContext State Change","".concat(h,"=>").concat(g)),cS.emit(bR.STATE_CHANGE))},setInterval(()=>{var h;const g=(h=_w)===null||h===void 0?void 0:h.currentTime;cS.currentTime!==g?(cS.currentTimeStuckAt&&(wE.debug("AudioContext current time resume at ".concat(g)),cS.currentTimeStuckAt=void 0),cS.currentTime=g):(g!==cS.currentTimeStuckAt&&(p0.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:g},tag:kS.TRACER}).onSuccess(),wE.warning("AudioContext current time stuck at ".concat(g))),cS.currentTimeStuckAt=g)},5e3),async function(h){const g=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let j,_t=!1,_i=!1,_o=!1;function ga(p_){h.state==="running"?_a(!1):aT()||hO()?h.state==="suspended"&&(_a(!0),p_&&h.resume().then(_c,_c)):h.state!=="closed"&&(_a(!0),p_&&h.resume().then(_c,_c))}function _a(p_){if(_t!==p_){_t=p_;for(let C_=0,O_=g;C_<O_.length;C_+=1){const q_=O_[C_];p_?window.addEventListener(q_,_l,{capture:!0,passive:!0}):window.removeEventListener(q_,_l,{capture:!0,passive:!0})}}}function _u(){ga(!0)}function _c(){ga(!1)}function _l(){ga(!0)}function _g(p_){if(!_o)if(j.paused)if(p_){r_(!1),_o=!0;let C_;try{C_=j.play(),C_?C_.then(l_,l_):(j.addEventListener("playing",l_),j.addEventListener("abort",l_),j.addEventListener("error",l_))}catch{l_()}}else r_(!0);else r_(!1)}function r_(p_){if(_i!==p_){_i=p_;for(let C_=0,O_=g;C_<O_.length;C_++){const q_=O_[C_];p_?window.addEventListener(q_,d_,{capture:!0,passive:!0}):window.removeEventListener(q_,d_,{capture:!0,passive:!0})}}}function l_(){j.removeEventListener("playing",l_),j.removeEventListener("abort",l_),j.removeEventListener("error",l_),_o=!1,_g(!1)}function d_(){_g(!0)}if(aT()){const p_=h.createMediaStreamDestination(),C_=document.createElement("div");C_.innerHTML="<audio x-webkit-airplay='deny'></audio>",j=C_.children.item(0),j.controls=!1,j.disableRemotePlayback=!0,j.preload="auto",j.srcObject=p_.stream,_g(!0)}cS.on(bR.STATE_CHANGE,_u),ga(!1)}(_w)}function tP(){if(!_w){if(jQ(),!_w)throw new f_(c_.NOT_SUPPORTED,"can not create audio context");return _w}return _w}function n$(){return!!_w}function r1(d){if(function(){if(y5!==null)return y5;const j=tP(),_t=j.createBufferSource(),_i=j.createGain(),_o=j.createGain();_t.connect(_i),_t.connect(_o),_t.disconnect(_i);let ga=!1;try{_t.disconnect(_i)}catch{ga=!0}return _t.disconnect(),y5=ga,ga}())return;const h=d.connect,g=d.disconnect;d.connect=(j,_t,_i)=>(d._inputNodes||(d._inputNodes=[]),d._inputNodes.includes(j)||(j instanceof AudioNode?(d._inputNodes.push(j),h.call(d,j,_t,_i)):h.call(d,j,_t)),d),d.disconnect=(j,_t,_i)=>{g.call(d),j?A5(d._inputNodes,j):d._inputNodes=[];for(const _o of d._inputNodes)h.call(d,_o)}}let y5=null;function r$(d,h){let g=!1;const j=1/h;if(__("DISABLE_WEBAUDIO")){const _t=window.setInterval(()=>{g?window.clearInterval(_t):d(performance.now()/1e3)},1e3*j)}else{const _t=tP();let _i=_t.createGain();_i.gain.value=0,_i.connect(_t.destination);const _o=()=>{if(g)return void(_i=null);const ga=_t.createOscillator();ga.onended=_o,ga.connect(_i),ga.start(0),ga.stop(_t.currentTime+j),d(_t.currentTime)};_o()}return()=>{g=!0}}class i${constructor(){_h(this,"context",void 0),_h(this,"analyserNode",void 0),_h(this,"sourceNode",void 0),this.context=tP(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(h){if(h!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch{}this.sourceNode=h,h==null||h.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode||(!this.context||aT()||hO()||this.context.state!=="running"&&this.context.resume(),!this.analyserNode))return 0;const h=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(h);else{const j=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(j);for(let _t=0;_t<h.length;++_t)h[_t]=j[_t]/128-1}const g=WI(h).call(h,(j,_t)=>j+_t*_t,0)/h.length;return Math.max(10*Math.log10(g)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var h,g;(h=this.sourceNode)===null||h===void 0||h.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,(g=this.sourceNode)===null||g===void 0||g.connect(this.analyserNode)}catch{wE.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class o$ extends US{get processSourceNode(){return this.sourceNode}set processedNode(h){var g;if(!this.isDestroyed&&this._processedNode!==h){try{var j;(j=this.sourceNode)===null||j===void 0||j.disconnect(this.outputNode)}catch{}(g=this._processedNode)===null||g===void 0||g.disconnect(),this._processedNode=h,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),_h(this,"outputNode",void 0),_h(this,"outputTrack",void 0),_h(this,"isPlayed",!1),_h(this,"sourceNode",void 0),_h(this,"context",void 0),_h(this,"audioBufferNode",void 0),_h(this,"destNode",void 0),_h(this,"audioOutputLevel",0),_h(this,"volumeLevelAnalyser",void 0),_h(this,"_processedNode",void 0),_h(this,"playNode",void 0),_h(this,"isDestroyed",!1),_h(this,"onNoAudioInput",void 0),_h(this,"isNoAudioInput",!1),_h(this,"_noAudioInputCount",0),this.context=tP(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),r1(this.outputNode),this.volumeLevelAnalyser=new i$}startGetAudioBuffer(h){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(h),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=g=>{this.emit(wT.ON_AUDIO_BUFFER,function(j){for(let _t=0;_t<j.outputBuffer.numberOfChannels;_t+=1){const _i=j.outputBuffer.getChannelData(_t);for(let _o=0;_o<_i.length;_o+=1)_i[_o]=0}return j.inputBuffer}(g))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!QS().webAudioMediaStreamDest)throw new f_(c_.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(h){this.context.state!=="running"&&eO(()=>{cS.emit("autoplay-failed")}),this.isPlayed=!0,this.playNode=h||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch{}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;if(h>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;aT()||hO()?this.context.state==="suspended"&&this.context.resume():this.context.state!=="running"&&this.context.resume();const g=this.volumeLevelAnalyser.getAnalyserNode();let j;g.getFloatTimeDomainData?(j=new Float32Array(g.fftSize),g.getFloatTimeDomainData(j)):(j=new Uint8Array(g.fftSize),g.getByteTimeDomainData(j));let _t=!1;for(let _i=0;_i<j.length;_i++)j[_i]!==0&&(_t=!0);return _t?(this.isNoAudioInput=!1,!0):(await KR(200),await this.checkHasAudioInput(h?h+1:1)&&_t)}getAudioVolume(){return this.outputNode.gain.value}setVolume(h){this.outputNode.gain.setValueAtTime(h,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var h,g;(h=this.processedNode)===null||h===void 0||h.disconnect(),(g=this.sourceNode)===null||g===void 0||g.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var h;this.processedNode?(h=this.processedNode)===null||h===void 0||h.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class b5 extends o${get isFreeze(){return!1}constructor(h,g,j){var _t;if(super(),_h(this,"sourceNode",void 0),_h(this,"track",void 0),_h(this,"clonedTrack",void 0),_h(this,"audioElement",void 0),_h(this,"isCurrentTrackCloned",!1),_h(this,"isRemoteTrack",!1),_h(this,"originVolumeLevelAnalyser",void 0),_h(this,"rebuildWebAudio",async()=>{if(wE.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void wE.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then(()=>wE.info("resume success")),wE.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const ga=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?ga.stop():this.isCurrentTrackCloned=!0;const _a=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(_a),r1(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const _u=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(_u,this.context.currentTime),r1(this.outputNode),this.emit(wT.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=_a,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()}),h.kind!=="audio")throw new f_(c_.UNEXPECTED_ERROR);this.track=h;const _i=new MediaStream([this.track]);if(this.isRemoteTrack=!!g,this.sourceNode=this.context.createMediaStreamSource(_i),r1(this.sourceNode),j){const ga=j.clone();ga.enabled=!0,this.clonedTrack=ga,wE.debug("create an unmuted track ".concat(ga.id," from the original track ").concat(j.id," to get the volume"));const _a=this.context.createMediaStreamSource(new MediaStream([ga]));r1(_a),this.originVolumeLevelAnalyser=new i$,this.originVolumeLevelAnalyser.updateSource(_a)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=_i;const _o=sS();g&&_o.os===VR.IOS&&Number((_t=_o.osVersion)===null||_t===void 0?void 0:_t.split(".")[0])<15&&(cS.on(bR.STATE_CHANGE,()=>{this.context.state==="suspended"?document.body.addEventListener("click",this.rebuildWebAudio,!0):this.context.state==="running"&&this.rebuildWebAudio()}),this.checkHasAudioInput().then(ga=>{ga||document.body.addEventListener("click",this.rebuildWebAudio,!0)}))}updateTrack(h){this.sourceNode.disconnect(),this.track=h,this.isCurrentTrackCloned=!1;const g=new MediaStream([h]);this.sourceNode=this.context.createMediaStreamSource(g),r1(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(wT.UPDATE_SOURCE),this.audioElement.srcObject=g}destroy(){var h;this.audioElement.srcObject=null,this.audioElement.remove(),cS.off("state-change",this.rebuildWebAudio),(h=this.originVolumeLevelAnalyser)===null||h===void 0||h.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(h){return this.context.createMediaStreamSource(new MediaStream([h]))}updateOriginTrack(h){const g=h.clone();g.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=g),wE.debug("create an unmuted track ".concat(g.id," from the original track ").concat(h.id," to get the volume"));const j=this.context.createMediaStreamSource(new MediaStream([g]));r1(j),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(j)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function s$(d,h){const g=(_t,_i)=>_t?typeof _t!="number"?_t.max||_t.exact||_t.ideal||_t.min||_i:_t:_i,j={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:d,maxHeight:g(h.height,1080),maxWidth:g(h.width,1920)}}};return h.frameRate&&typeof h.frameRate!="number"?(j.video.mandatory.maxFrameRate=h.frameRate.max,j.video.mandatory.minFrameRate=h.frameRate.min):typeof h.frameRate=="number"&&(j.video.mandatory.maxFrameRate=h.frameRate),await navigator.mediaDevices.getUserMedia(j)}async function UQ(d){const h=await a$(d.mediaSource),g=await function(j){return new a0((_t,_i)=>{const _o=document.createElement("div");_o.innerText="share screen",_o.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const ga=document.createElement("div");ga.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const _a=document.createElement("div");_a.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",_a.setAttribute("style","height: 12%;");const _u=document.createElement("div");_u.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const _c=document.createElement("div");_c.setAttribute("style","text-align: right; padding: 16px 0;");const _l=document.createElement("button");_l.innerHTML="cancel",_l.setAttribute("style","width: 85px;"),_l.onclick=()=>{document.body.removeChild(_g);const r_=new Error("NotAllowedError");r_.name="NotAllowedError",_i(r_)},_c.appendChild(_l),ga.appendChild(_a),ga.appendChild(_u),ga.appendChild(_c);const _g=document.createElement("div");_g.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),_g.appendChild(_o),_g.appendChild(ga),document.body.appendChild(_g),j.map(r_=>{if(r_.id){const l_=document.createElement("div");l_.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let d_=r_.thumbnail;const{width:p_}=d_.getSize();p_>1920&&(d_=d_.resize({width:1920})),l_.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+d_.toDataURL()+' /></div><span style="	height: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+(r_.name.replace(/[\u00A0-\u9999<>\&]/g,function(C_){return"&#"+C_.charCodeAt(0)+";"})+"</span>"),l_.onclick=()=>{document.body.removeChild(_g),_t(r_.id)},_u.appendChild(l_)}})})}(h);return await s$(g,d)}async function a$(d){let h=["window","screen"];d!=="application"&&d!=="window"||(h=["window"]),d==="screen"&&(h=["screen"]);const g=c$();if(!g)throw new f_(c_.ELECTRON_IS_NULL);let j=null;try{var _t;j=((_t=g.desktopCapturer)===null||_t===void 0?void 0:_t.getSources({types:h}))||g.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:h})}catch{j=null}j&&j.then||(j=new a0((_i,_o)=>{g.desktopCapturer.getSources({types:h},(ga,_a)=>{ga?_o(ga):_i(_a)})}));try{return await j}catch(_i){throw new f_(c_.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,_i.toString())}}let NU=null;function c$(){if(NU)return NU;try{return NU=window.require("electron"),NU}catch{return null}}function u$(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}const S5=new lT("safari");let l$=!1,d$=!1;async function kI(d,h){let g=0,j=null;for(;g<2;)try{j=await FQ(d,h,g>0);break}catch(_t){if(_t instanceof f_)throw wE.error("[".concat(h,"] ").concat(_t.toString())),_t;const _i=kU(_t.name||_t.code||_t,_t.message);if(_i.code===c_.MEDIA_OPTION_INVALID){wE.debug("[".concat(h,"] detect media option invalid, retry")),g+=1,await KR(500);continue}throw wE.error("[".concat(h,"] ").concat(_i.toString())),_i}if(!j)throw new f_(c_.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return j}async function FQ(d,h,g){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new f_(c_.NOT_SUPPORTED,"can not find getUserMedia");g&&(d.video&&(delete d.video.width,delete d.video.height),d.screen&&(delete d.screen.width,delete d.screen.height));const j=QS(),_t=new MediaStream;if(d.audioSource&&_t.addTrack(d.audioSource),d.videoSource&&_t.addTrack(d.videoSource),!d.audio&&!d.video&&!d.screen)return wE.debug("Using Video Source/ Audio Source"),_t;if(d.screen)if(c$())d.screen.sourceId?nP(_t,await s$(d.screen.sourceId,d.screen)):nP(_t,await UQ(d.screen));else if(T3()&&d.screen.extensionId&&d.screen.mandatory){if(!j.getStreamFromExtension)throw new f_(c_.NOT_SUPPORTED,"This browser does not support screen sharing");wE.debug("[".concat(h,'] Screen access on chrome stable, looking for extension"'));const _g=await(_o=d.screen.extensionId,ga=h,new a0((r_,l_)=>{try{chrome.runtime.sendMessage(_o,{getStream:!0},d_=>{if(!d_||!d_.streamId)return wE.error("[".concat(ga,"] No response from Chrome Plugin. Plugin not installed properly"),d_),void l_(new f_(c_.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));r_(d_.streamId)})}catch(d_){wE.error("[".concat(ga,"] AgoraRTC screensharing plugin is not accessible(").concat(_o,")"),d_.toString()),l_(new f_(c_.CHROME_PLUGIN_NOT_INSTALL))}}));d.screen.mandatory.chromeMediaSourceId=_g,nP(_t,await navigator.mediaDevices.getUserMedia({video:{mandatory:d.screen.mandatory}}))}else if(j.getDisplayMedia){var _i;d.screen.mediaSource&&D4(d.screen.mediaSource);const _g={width:d.screen.width,height:d.screen.height,frameRate:d.screen.frameRate,displaySurface:(_i=d.screen.displaySurface)!==null&&_i!==void 0?_i:d.screen.mediaSource==="screen"?"monitor":d.screen.mediaSource},{selfBrowserSurface:r_,surfaceSwitching:l_,systemAudio:d_}=d.screen,p_={selfBrowserSurface:r_,surfaceSwitching:l_,systemAudio:d_};!r_&&delete p_.selfBrowserSurface,!l_&&delete p_.surfaceSwitching,!d_&&delete p_.systemAudio,wE.debug("[".concat(h,"] getDisplayMedia:"),JSON.stringify({video:_g,audio:!!d.screenAudio,controls:p_})),nP(_t,await navigator.mediaDevices.getDisplayMedia(function(C_){for(var O_=1;O_<arguments.length;O_++){var q_=arguments[O_]!=null?arguments[O_]:{};O_%2?u$(Object(q_),!0).forEach(function(c0){_h(C_,c0,q_[c0])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C_,Object.getOwnPropertyDescriptors(q_)):u$(Object(q_)).forEach(function(c0){Object.defineProperty(C_,c0,Object.getOwnPropertyDescriptor(q_,c0))})}return C_}({video:_g,audio:!!d.screenAudio},p_)))}else{if(!GS())throw wE.error("[".concat(h,"] This browser does not support screenSharing")),new f_(c_.NOT_SUPPORTED,"This browser does not support screen sharing");{d.screen.mediaSource&&D4(d.screen.mediaSource);const _g={video:{mediaSource:d.screen.mediaSource,width:d.screen.width,height:d.screen.height,frameRate:d.screen.frameRate}};wE.debug("[".concat(h,"] getUserMedia: ").concat(JSON.stringify(_g))),nP(_t,await navigator.mediaDevices.getUserMedia(_g))}}var _o,ga;if(!d.video&&!d.audio)return _t;let _a={video:d.video,audio:d.audio},_u=__("MEDIA_DEVICE_CONSTRAINTS");if(_u)try{typeof _u=="string"&&(_u=JSON.parse(_u)),_a=function _g(r_,l_){if(!mW(r_)||!mW(l_)||Array.isArray(r_)&&!Array.isArray(l_)||!Array.isArray(r_)&&Array.isArray(l_))return l_;if(Array.isArray(l_)&&Array.isArray(r_)){const d_=[...r_];for(let p_=0;p_<l_.length;p_++)d_[p_]=_g(r_[p_],l_[p_]);return d_}{const d_=o1({},r_);for(const p_ in l_)Object.prototype.hasOwnProperty.call(l_,p_)&&(Object.prototype.hasOwnProperty.call(r_,p_)?d_[p_]=_g(r_[p_],l_[p_]):d_[p_]=l_[p_]);return d_}}(_a,_u)}catch{}wE.debug("[".concat(h,"] GetUserMedia"),JSON.stringify(_a)),sS();let _c,_l=null;(sT()||aT()||pU())&&(_l=await S5.lock());try{_c=await navigator.mediaDevices.getUserMedia(_a)}catch(_g){throw _l&&_l(),_g}return _a.audio&&(l$=!0),_a.video&&(d$=!0),nP(_t,_c),_l&&_l(),_t}function kU(d,h){switch(d){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new f_(c_.MEDIA_OPTION_INVALID,"".concat(d,": ").concat(h));case"NotFoundError":case"DevicesNotFoundError":return new f_(c_.DEVICE_NOT_FOUND,"".concat(d,": ").concat(h));case"NotSupportedError":return new f_(c_.NOT_SUPPORTED,"".concat(d,": ").concat(h));case"NotReadableError":return new f_(c_.NOT_READABLE,"".concat(d,": ").concat(h));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new f_(c_.PERMISSION_DENIED,"".concat(d,": ").concat(h));case"ConstraintNotSatisfiedError":return new f_(c_.CONSTRAINT_NOT_SATISFIED,"".concat(d,": ").concat(h));default:return wE.error("getUserMedia unexpected error",d),new f_(c_.UNEXPECTED_ERROR,"".concat(d,": ").concat(h))}}function nP(d,h){const g=d.getVideoTracks()[0],j=d.getAudioTracks()[0],_t=h.getVideoTracks()[0],_i=h.getAudioTracks()[0];_i&&(j&&d.removeTrack(j),d.addTrack(_i)),_t&&(g&&d.removeTrack(g),d.addTrack(_t))}const _C=new class extends US{get state(){return this._state}set state(d){d!==this._state&&(this.emit(FO.STATE_CHANGE,d),this._state=d)}constructor(){super(),_h(this,"_state",t1.IDLE),_h(this,"isAccessMicrophonePermission",!1),_h(this,"isAccessCameraPermission",!1),_h(this,"lastAccessMicrophonePermission",!1),_h(this,"lastAccessCameraPermission",!1),_h(this,"checkdeviceMatched",!1),_h(this,"deviceInfoMap",new Map),this.init().then(()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval(()=>{(__("ENUMERATE_DEVICES_INTERVAL")||(hU()||S2()===VR.HARMONY_OS)&&YN())&&this.updateDevicesInfo()},__("ENUMERATE_DEVICES_INTERVAL_TIME"))}).catch(d=>wE.error(d.toString()))}async enumerateDevices(d,h){let g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new f_(c_.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const j=await navigator.mediaDevices.enumerateDevices(),_t=this.checkMediaDeviceInfoIsOk(j);let _i=!this.isAccessMicrophonePermission&&d,_o=!this.isAccessCameraPermission&&h;_t.audio&&(_i=!1),_t.video&&(_o=!1);let ga=null,_a=null,_u=null;if(!g&&(_i||_o)){if(S5.isLocked&&(wE.debug("[device manager] wait GUM lock"),(await S5.lock())(),wE.debug("[device manager] GUM unlock")),l$&&(_i=!1,this.isAccessMicrophonePermission=!0),d$&&(_o=!1,this.isAccessCameraPermission=!0),wE.debug("[device manager] check media device permissions",d,h,_i,_o),_i&&_o){try{_u=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(_c){const _l=kU(_c.name||_c.code||_c,_c.message);if(_l.code===c_.PERMISSION_DENIED)throw _l;wE.warning("getUserMedia failed in getDevices",_l)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(_i){try{ga=await navigator.mediaDevices.getUserMedia({audio:d})}catch(_c){const _l=kU(_c.name||_c.code||_c,_c.message);if(_l.code===c_.PERMISSION_DENIED)throw _l;wE.warning("getUserMedia failed in getDevices",_l)}this.isAccessMicrophonePermission=!0}else if(_o){try{_a=await navigator.mediaDevices.getUserMedia({video:h})}catch(_c){const _l=kU(_c.name||_c.code||_c,_c.message);if(_l.code===c_.PERMISSION_DENIED)throw _l;wE.warning("getUserMedia failed in getDevices",_l)}this.isAccessCameraPermission=!0}wE.debug("[device manager] mic permission",d,"cam permission",h)}try{const _c=await navigator.mediaDevices.enumerateDevices();return ga&&ga.getTracks().forEach(_l=>_l.stop()),_a&&_a.getTracks().forEach(_l=>_l.stop()),_u&&_u.getTracks().forEach(_l=>_l.stop()),ga=null,_a=null,_u=null,_c}catch(_c){return ga&&ga.getTracks().forEach(_l=>_l.stop()),_a&&_a.getTracks().forEach(_l=>_l.stop()),_u&&_u.getTracks().forEach(_l=>_l.stop()),ga=null,_a=null,_u=null,new f_(c_.ENUMERATE_DEVICES_FAILED,_c.toString()).throw()}}async getRecordingDevices(){let d=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,d)).filter(h=>h.kind==="audioinput")}async getCamerasDevices(){let d=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!1,!0,d)).filter(h=>h.kind==="videoinput")}async getSpeakers(){let d=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return(await this.enumerateDevices(!0,!1,d)).filter(h=>h.kind==="audiooutput")}searchDeviceIdByName(d){let h=null;return this.deviceInfoMap.forEach(g=>{g.device.label===d&&(h=g.device.deviceId)}),h}async getDeviceById(d){const h=(await this.enumerateDevices(!0,!0,!0)).find(g=>g.deviceId===d);if(!h)throw new f_(c_.DEVICE_NOT_FOUND,"deviceId: ".concat(d));return h}async init(){this.state=t1.INITING;try{await this.updateDevicesInfo(),this.state=t1.INITEND}catch(d){throw wE.warning("Device Detection functionality cannot start properly.",d.toString()),this.state=t1.IDLE,!function(){return typeof isSecureContext=="boolean"?isSecureContext:location.protocol==="https:"||location.protocol==="file:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"||location.hostname==="::1"}()&&new f_(c_.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),d}}async updateDevicesInfo(){const d=await this.enumerateDevices(!0,!0,!0),h=Date.now(),g=[];if(d[0]&&d[0].label&&this.checkdeviceMatched===!1){this.checkdeviceMatched=!0;const _t=d.find(_o=>_o.kind==="audioinput"&&_o.deviceId==="default"),_i=d.find(_o=>_o.kind==="audiooutput"&&_o.deviceId==="default");_t&&_i?_i.groupId===_t.groupId?wE.debug("[device-check] default input ".concat(_t.label," and output ").concat(_i.label," is the same group")):wE.warning("[device-check] default input ".concat(_t.label," and output ").concat(_i.label," is not the same group")):wE.debug("[device-check] default input or output not found")}const j=this.checkMediaDeviceInfoIsOk(d);if(d.forEach(_t=>{if(!_t.deviceId)return;const _i=this.deviceInfoMap.get("".concat(_t.kind,"_").concat(_t.deviceId));if((_i?_i.state:"INACTIVE")!=="ACTIVE"){const _o={initAt:h,updateAt:h,device:_t,state:"ACTIVE"};this.deviceInfoMap.set("".concat(_t.kind,"_").concat(_t.deviceId),_o),g.push(_o)}_i&&(_i.updateAt=h)}),this.deviceInfoMap.forEach((_t,_i)=>{_t.state==="ACTIVE"&&_t.updateAt!==h&&(_t.state="INACTIVE",g.push(_t))}),this.state!==t1.INITEND)return j.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(j.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));g.forEach(_t=>{switch(_t.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(FO.RECORDING_DEVICE_CHANGED,_t);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(FO.CAMERA_DEVICE_CHANGED,_t);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(FO.PLAYOUT_DEVICE_CHANGED,_t)}}),j.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),j.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(d){const h=d.filter(_t=>_t.kind==="audioinput"),g=d.filter(_t=>_t.kind==="videoinput"),j={audio:!1,video:!1};for(const _t of h)if(_t.label&&_t.deviceId){j.audio=!0;break}for(const _t of g)if(_t.label&&_t.deviceId){j.video=!0;break}return j}},BQ=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],FT=new class{constructor(){_h(this,"onAutoplayFailed",void 0),_h(this,"elementMap",new Map),_h(this,"elementStateMap",new Map),_h(this,"elementsNeedToResume",[]),_h(this,"sinkIdMap",new Map),_h(this,"autoResumeAfterInterruption",()=>{Array.from(this.elementMap.entries()).forEach(d=>{let[h,g]=d;const j=this.elementStateMap.get(h),_t=g.srcObject.getAudioTracks()[0];G1()?_t&&_t.readyState==="live"&&cS.curState==="running"&&(wE.debug("auto resume after interruption for iOS 15"),g.pause(),g.play()):j&&j==="paused"&&_t&&_t.readyState==="live"&&cS.curState==="running"&&(wE.debug("auto resume after interruption for iOS"),g.play())})}),_h(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{Array.from(this.elementMap.entries()).forEach(d=>{let[h,g]=d;const j=g.srcObject.getAudioTracks()[0];j&&j.readyState==="live"&&(wE.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),g.pause(),g.play())})}),this.autoResumeAudioElement(),cS.on(bR.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),cS.on(bR.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),cS.on(bR.STATE_CHANGE,()=>{aT()&&cS.prevState==="suspended"&&cS.curState==="running"&&this.autoResumeAfterInterruption()})}async setSinkID(d,h){const g=this.elementMap.get(d);if(this.sinkIdMap.set(d,h),g)try{await g.setSinkId(h)}catch(j){throw new f_(c_.PERMISSION_DENIED,"can not set sink id: "+j.toString())}}play(d,h,g,j){if(this.elementMap.has(h))return;const _t=document.createElement("audio");_t.autoplay=!0,_t.srcObject=new MediaStream([d]),this.bindAudioElementEvents(h,_t),this.elementMap.set(h,_t),this.elementStateMap.set(h,$R.INIT),this.setVolume(h,g);const _i=this.sinkIdMap.get(h);if(_i)try{_t.setSinkId(_i).catch(ga=>{wE.warning("[".concat(h,"] set sink id failed"),ga.toString())})}catch(ga){wE.warning("[".concat(h,"] set sink id failed"),ga.toString())}const _o=_t.play();_o&&_o.then&&_o.catch(ga=>{j&&p0.autoplayFailed(j,"audio",ga.message,h),wE.warning("audio element play warning",ga.toString()),this.elementMap.has(h)&&ga.name==="NotAllowedError"&&(wE.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(_t),eO(()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),J4()}))})}updateTrack(d,h){const g=this.elementMap.get(d);g&&(g.srcObject=new MediaStream([h]))}isPlaying(d){return this.elementMap.has(d)&&this.elementStateMap.get(d)==="playing"}setVolume(d,h){const g=this.elementMap.get(d);g&&(h=Math.max(0,Math.min(100,h)),g.volume=h/100)}stop(d){const h=this.elementMap.get(d);if(this.sinkIdMap.delete(d),!h)return;const g=this.elementsNeedToResume.indexOf(h);this.elementsNeedToResume.splice(g,1),h.srcObject=null,h.remove(),this.elementMap.delete(d),this.elementStateMap.delete(d)}bindAudioElementEvents(d,h){BQ.forEach(g=>{h.addEventListener(g,j=>{const _t=this.elementStateMap.get(d),_i=j.type==="pause"?"paused":j.type;if(wE.debug("[".concat(d,"] audio-element-status change ").concat(_t," => ").concat(_i)),j.type==="error"){const _o=h==null?void 0:h.error;_o&&wE.error("[".concat(d,"] media error, code: ").concat(_o.code,", message: ").concat(_o.message))}this.elementStateMap.set(d,_i)})})}getPlayerState(d){return this.elementStateMap.get(d)||"uninit"}autoResumeAudioElement(){const d=()=>{this.elementsNeedToResume.forEach(h=>{h.play().then(g=>{wE.debug("Auto resume audio element success")}).catch(g=>{wE.warning("Auto resume audio element failed!",g)})}),this.elementsNeedToResume=[]};new a0(h=>{document.body?h():window.addEventListener("load",()=>h())}).then(()=>{uL()?document.body.addEventListener("click",d,!0):(document.body.addEventListener("touchstart",d,!0),document.body.addEventListener("mousedown",d,!0))})}};function HS(){return function(d,h,g){const j=g.value;return typeof j=="function"&&(g.value=function(){this._isClosed&&new f_(c_.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning");for(var _t=arguments.length,_i=new Array(_t),_o=0;_o<_t;_o++)_i[_o]=arguments[_o];const ga=j.apply(this,_i);return ga instanceof a0?new a0((_a,_u)=>{ga.then(_a).catch(_u)}):ga}),g}}var VQ=UR("Array").values,GQ=uO,$Q=IS,WQ=_p,HQ=VQ,R5=Array.prototype,qQ={DOMTokenList:!0,NodeList:!0},mO=function(d){var h=d.values;return d===R5||WQ(R5,d)&&h===R5.values||$Q(qQ,GQ(d))?HQ:h};function p$(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function PU(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?p$(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):p$(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}class h$ extends US{constructor(h){super(),_h(this,"name","VideoProcessorDestination"),_h(this,"ID","0"),_h(this,"_source",void 0),_h(this,"videoContext",void 0),_h(this,"inputTrack",void 0),this.videoContext=h}get kind(){return"video"}get enabled(){return!0}pipe(){throw new f_(c_.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new f_(c_.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(h){if(h.context!==this.videoContext)throw new Error(`ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.
Probably you are making pipeline like this:
videoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).`);h.track&&h.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=h.track,this.emit(qR.ON_TRACK,h.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(qR.ON_TRACK,void 0)}}class f$ extends US{set chained(h){this._chained=h}get chained(){return this._chained}constructor(h,g){super(),_h(this,"constraintsMap",new Map),_h(this,"statsRegistry",[]),_h(this,"usageRegistry",[]),_h(this,"trackId",void 0),_h(this,"direction",void 0),_h(this,"_chained",!1),this.trackId=h,this.direction=g}async getConstraints(){return await YR(this,CT.REQUEST_CONSTRAINTS)}async requestApplyConstraints(h,g){var j;return wE.info("processor ".concat(g.name," requestApplyConstraints for ").concat(this.trackId)),h&&this.constraintsMap.set(g,h),qS(this,CT.REQUEST_UPDATE_CONSTRAINTS,Array.from(mO(j=this.constraintsMap).call(j)))}async requestRevertConstraints(h){var g;if(this.constraintsMap.has(h))return wE.info("processor ".concat(h.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(h),qS(this,CT.REQUEST_UPDATE_CONSTRAINTS,Array.from(mO(g=this.constraintsMap).call(g)))}registerStats(h,g,j){this.statsRegistry.find(_t=>_t.processorID===h.ID&&_t.processorName===h.name&&_t.type===g)||this.statsRegistry.push({processorName:h.name,processorID:h.ID,type:g,cb:j})}unregisterStats(h,g){const j=this.statsRegistry.findIndex(_t=>_t.processorID===h.ID&&_t.processorName===h.name&&_t.type===g);j!==-1&&this.statsRegistry.splice(j,1)}gatherStats(){const h=[];for(const{processorID:g,processorName:j,type:_t,cb:_i}of this.statsRegistry)try{const _o=_i();h.push({processorID:g,processorName:j,type:_t,stats:_o})}catch(_o){wE.error(new f_(c_.UNEXPECTED_ERROR,_o.message))}return h}registerUsage(h,g){this.usageRegistry.find(j=>j.processorID===h.ID&&j.processorName===h.name)||this.usageRegistry.push({processorID:h.ID,processorName:h.name,cb:g})}unregisterUsage(h){const g=this.usageRegistry.findIndex(j=>j.processorID===h.ID&&j.processorName===h.name);g!==-1&&this.usageRegistry.splice(g,1)}async gatherUsage(){const h=[];if(!this.chained)return[];for(const{cb:g}of this.usageRegistry)try{let j=g();j instanceof a0&&(j=await j),h.push(PU(PU({},j),{},{direction:this.direction}))}catch(j){wE.error("gather extension usage error",j)}return h}getDirection(){return this.direction}}class m$ extends US{constructor(h){super(),_h(this,"name","AudioProcessorDestination"),_h(this,"ID","0"),_h(this,"inputTrack",void 0),_h(this,"inputNode",void 0),_h(this,"audioProcessorContext",void 0),_h(this,"_source",void 0),this.audioProcessorContext=h}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new f_(c_.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new f_(c_.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(qR.ON_TRACK,void 0),this.emit(qR.ON_NODE,void 0)}updateInput(h){if(h.context!==this.audioProcessorContext)throw new Error(`ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.
        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).`);h.track&&this.inputTrack!==h.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=h.track,this.emit(qR.ON_TRACK,this.inputTrack)),h.node&&this.inputNode!==h.node&&(this.audioProcessorContext.chained=!0,this.inputNode=h.node,this.emit(qR.ON_NODE,this.inputNode))}}class g$ extends US{set chained(h){this._chained=h}get chained(){return this._chained}constructor(h,g,j){super(),_h(this,"constraintsMap",new Map),_h(this,"statsRegistry",[]),_h(this,"audioContext",void 0),_h(this,"trackId",void 0),_h(this,"direction",void 0),_h(this,"usageRegistry",[]),_h(this,"_chained",!1),this.audioContext=h,this.trackId=g,this.direction=j}async getConstraints(){return YR(this,CT.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(h,g){var j;return wE.info("processor ".concat(g.name," requestApplyConstraints for ").concat(this.trackId)),h&&this.constraintsMap.set(g,h),qS(this,CT.REQUEST_UPDATE_CONSTRAINTS,Array.from(mO(j=this.constraintsMap).call(j)))}async requestRevertConstraints(h){var g;if(this.constraintsMap.has(h))return this.constraintsMap.delete(h),qS(this,CT.REQUEST_UPDATE_CONSTRAINTS,Array.from(mO(g=this.constraintsMap).call(g)))}registerStats(h,g,j){this.statsRegistry.find(_t=>_t.processorID===h.ID&&_t.processorName===h.name&&_t.type===g)||this.statsRegistry.push({processorName:h.name,processorID:h.ID,type:g,cb:j})}unregisterStats(h,g){const j=this.statsRegistry.findIndex(_t=>_t.processorID===h.ID&&_t.processorName===h.name&&_t.type===g);j!==-1&&this.statsRegistry.splice(j,1)}gatherStats(){const h=[];for(const{processorID:g,processorName:j,type:_t,cb:_i}of this.statsRegistry)try{const _o=_i();h.push({processorID:g,processorName:j,type:_t,stats:_o})}catch(_o){wE.error(new f_(c_.UNEXPECTED_ERROR,_o.message))}return h}registerUsage(h,g){this.usageRegistry.find(j=>j.processorID===h.ID&&j.processorName===h.name)||this.usageRegistry.push({processorID:h.ID,processorName:h.name,cb:g})}unregisterUsage(h){const g=this.usageRegistry.findIndex(j=>j.processorID===h.ID&&j.processorName===h.name);g!==-1&&this.usageRegistry.splice(g,1)}async gatherUsage(){const h=[];if(!this.chained)return[];for(const{cb:g}of this.usageRegistry)try{let j=g();j instanceof a0&&(j=await j),h.push(PU(PU({},j),{},{direction:this.direction}))}catch(j){wE.error("gather extension usage error",j)}return h}getDirection(){return this.direction}}class T5 extends US{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),_h(this,"context",void 0),_h(this,"processSourceNode",void 0),_h(this,"outputTrack",void 0),_h(this,"processedNode",void 0),_h(this,"clonedTrack",void 0),_h(this,"outputNode",void 0),this.outputNode=new zQ}setVolume(){}createOutputTrack(){throw new f_(c_.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class zQ{disconnect(){}connect(){}}let xU,rP=null;class KQ{constructor(){_h(this,"state","open"),_h(this,"trigger",void 0),_h(this,"tasks",[]),wE.debug("[macro-task-queue] is created."),this.trigger=setTimeout(()=>{this.state="closed",wE.debug("[macro-task-queue] will be closed, all remaining tasks will execute. [".concat(this.tasks.map(h=>h.key),"]")),this.trigger=void 0,this.tasks.forEach(h=>{let{func:g}=h;return g()}),this.tasks.length=0,wE.debug("[macro-task-queue] is closed.")})}enqueue(h,g){this.state!=="closed"&&(this.tasks.push({key:h,func:g}),wE.debug("[macro-task-queue] is queued, current queue ".concat(this.tasks.length,". ").concat(typeof h=="string"?h:"")))}runTask(h){if(this.state==="closed")return;const g=this.tasks.findIndex(j=>j.key===h);if(g!==-1){const j=this.tasks.splice(g,1);wE.debug("[macro-task-queue] is unqueued, current queue ".concat(this.tasks.length,". ").concat(typeof h=="string"?h:"")),j[0].func()}}release(){this.trigger&&(this.state="closed",clearTimeout(this.trigger),this.trigger=void 0,this.tasks.length=0,wE.debug("[macro-task-queue] is closed."))}}function w5(d){return function(h,g,j){var _t;const _i=(_t=j.value)!==null&&_t!==void 0?_t:j.get,_o=function(){rP&&rP.state==="open"&&rP.runTask(d);for(var ga=arguments.length,_a=new Array(ga),_u=0;_u<ga;_u++)_a[_u]=arguments[_u];return _i==null?void 0:_i.apply(this,..._a)};return j.value?j.value=_o:j.get=_o,j}}var E$,v$,_$,y$,b$,S$,R$,T$,w$,C$,I$,O$,A$,N$,k$,P$,x$,D$,L$,M$,j$,uS,U$,F$,B$,V$,G$,$$,gO,W$,H$,q$,z$,K$,Y$,J$,X$,Q$,Z$,eW,tW,nT;function nW(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function C5(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?nW(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):nW(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}(function(d){d.UPDATE_TRACK_SOURCE="update-track-source"})(xU||(xU={}));let zR=(E$=w5("INIT_WEBAUDIO"),v$=w5("INIT_WEBAUDIO"),_$=w5("INIT_WEBAUDIO"),y$=b0({argsMap:(d,h)=>[d.getTrackId(),h],throttleTime:300}),b$=b0({argsMap:(d,h)=>[d.getTrackId(),h]}),S$=HS(),R$=eP("LocalAudioTrack","_enabledMutex"),T$=b0({argsMap:(d,h)=>[d.getTrackId(),h]}),w$=HS(),C$=eP("LocalAudioTrack","_enabledMutex"),I$=b0({argsMap:(d,h)=>[d.getTrackId(),h]}),O$=HS(),A$=HS(),N$=HS(),k$=b0({argsMap:d=>[d.getTrackId()]}),P$=HS(),x$=b0({argsMap:d=>[d.getTrackId()]}),D$=HS(),L$=b0({argsMap:d=>[d.getTrackId()]}),M$=b0({argsMap:(d,h)=>[d.getTrackId(),h.name]}),j$=b0({argsMap:d=>[d.getTrackId()]}),G_((uS=class extends _5{get _source(){return this._trackSource}set _source(d){this._trackSource=d}get processorContext(){return this._processorContext}set processorContext(d){this._processorContext=d}get processorDestination(){return this._processorDestination}set processorDestination(d){this._processorDestination=d}get isPlaying(){return this._useAudioElement?FT.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(d,h,g,j,_t){super(d,g),_h(this,"trackMediaType","audio"),_h(this,"_encoderConfig",void 0),_h(this,"_trackSource",void 0),_h(this,"_enabled",!0),_h(this,"_volume",100),_h(this,"_useAudioElement",!1),_h(this,"_bypassWebAudio",!1),_h(this,"processor",void 0),_h(this,"_processorContext",void 0),_h(this,"_processorDestination",void 0),_h(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=h,this._getOriginVolumeLevel=!!j;const _i=()=>{this.processorContext=new g$(this._source.context,this.getTrackId(),"local"),this.processorDestination=new m$(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(wT.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})},_o=_t&&sT()&&!n$();__("DISABLE_WEBAUDIO")?(this._source=new T5,this._useAudioElement=!0,this._bypassWebAudio=!0):_o?this._source=new T5:(this._source=new b5(d,!1,this._getOriginVolumeLevel?d:void 0),__("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0)),_i(),!__("DISABLE_WEBAUDIO")&&_o&&(rP||(rP=new KQ),rP).enqueue("INIT_WEBAUDIO",()=>{this._source=new b5(d,!1,this._getOriginVolumeLevel?d:void 0),__("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0),_i(),this.emit(xU.UPDATE_TRACK_SOURCE)})}setVolume(d){SS(d,"volume",0,1e3),this._volume=d,this._source.setVolume(d/100),this._useAudioElement&&FT.setVolume(this.getTrackId(),d);try{if(this._bypassWebAudio)return void wE.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const h=this._source.createOutputTrack();this._mediaStreamTrack!==h&&(this._mediaStreamTrack=h,qS(this,I0.NEED_REPLACE_TRACK,this).then(()=>{wE.debug("[".concat(this.getTrackId(),"] replace web audio track success"))}).catch(g=>{wE.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),g)}))}catch{}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(d){if(!this._useAudioElement)throw new f_(c_.NOT_SUPPORTED,"your browser does not support setting the audio output device");await FT.setSinkID(this.getTrackId(),d)}async setEnabled(d,h,g){return this._setEnabled(d,h,g)}async _setEnabled(d,h,g){if(!g){if(d===this._enabled)return;this.stateCheck("enabled",d)}if(wE.info("[".concat(this.getTrackId(),"] start setEnabled"),d),d){this._originMediaStreamTrack.enabled=!0;try{g||(this._enabled=!0),await qS(this,I0.NEED_ENABLE_TRACK,this),wE.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(d," success"))}catch(j){throw g||(this._enabled=!1),wE.error("[".concat(this.getTrackId(),"] setEnabled to true error"),j.toString()),j}}else{this._originMediaStreamTrack.enabled=!1,g||(this._enabled=!1);try{await qS(this,I0.NEED_DISABLE_TRACK,this)}catch(j){throw g||(this._enabled=!0),wE.error("[".concat(this.getTrackId(),"] setEnabled to false error"),j.toString()),j}}}async setMuted(d){d!==this._muted&&(this.stateCheck("muted",d),this._muted=d,this._originMediaStreamTrack.enabled=!d,wE.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(d)),d?await qS(this,I0.NEED_MUTE_TRACK,this):await qS(this,I0.NEED_UNMUTE_TRACK,this))}getStats(){return vL(()=>{wE.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")},"localAudioTrackGetStatsWarning"),PI(this,I0.GET_STATS)||C5({},o5)}setAudioFrameCallback(d){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!d)return this._source.removeAllListeners(wT.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(h),this._source.removeAllListeners(wT.ON_AUDIO_BUFFER),this._source.on(wT.ON_AUDIO_BUFFER,g=>d(g))}play(){wE.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(wE.debug("[".concat(this.getTrackId(),"] start audio playback in element")),FT.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){wE.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?FT.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let d=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];wE.debug("[".concat(this.getTrackId(),"] update player source track")),d&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&FT.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(d,h){this._originMediaStreamTrack!==d&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),d.addEventListener("ended",this._handleTrackEnded),h&&this._originMediaStreamTrack.stop(),this._originMediaStreamTrack=d,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this.processor.updateInput({track:d,context:this.processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await qS(this,I0.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(d))}renewMediaStreamTrack(d){return a0.resolve(void 0)}pipe(d){if(this._bypassWebAudio)throw new f_(c_.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===d)return d;if(d._source)throw new f_(c_.INVALID_OPERATION,"Processor ".concat(d.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=d,this.processor._source=this,d.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),d}unpipe(){var d;if(!this.processor)return;const h=this.processor;(d=this._source.processSourceNode)===null||d===void 0||d.disconnect(),this.processor._source=!1,this.processor=void 0,h.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(qR.ON_TRACK,async d=>{d?d!==this._mediaStreamTrack&&(this._mediaStreamTrack=d,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(d),await qS(this,I0.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await qS(this,I0.NEED_REPLACE_TRACK,this))}),this.processorDestination.on(qR.ON_NODE,d=>{this._source.processedNode=d})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(qR.ON_TRACK),this.processorDestination.removeAllListeners(qR.ON_NODE)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(CT.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(CT.REQUEST_CONSTRAINTS)}}).prototype,"_source",[E$],Object.getOwnPropertyDescriptor(uS.prototype,"_source"),uS.prototype),G_(uS.prototype,"processorContext",[v$],Object.getOwnPropertyDescriptor(uS.prototype,"processorContext"),uS.prototype),G_(uS.prototype,"processorDestination",[_$],Object.getOwnPropertyDescriptor(uS.prototype,"processorDestination"),uS.prototype),G_(uS.prototype,"setVolume",[y$],Object.getOwnPropertyDescriptor(uS.prototype,"setVolume"),uS.prototype),G_(uS.prototype,"setPlaybackDevice",[b$,S$],Object.getOwnPropertyDescriptor(uS.prototype,"setPlaybackDevice"),uS.prototype),G_(uS.prototype,"setEnabled",[R$,T$,w$],Object.getOwnPropertyDescriptor(uS.prototype,"setEnabled"),uS.prototype),G_(uS.prototype,"setMuted",[C$,I$,O$],Object.getOwnPropertyDescriptor(uS.prototype,"setMuted"),uS.prototype),G_(uS.prototype,"getStats",[A$],Object.getOwnPropertyDescriptor(uS.prototype,"getStats"),uS.prototype),G_(uS.prototype,"setAudioFrameCallback",[N$],Object.getOwnPropertyDescriptor(uS.prototype,"setAudioFrameCallback"),uS.prototype),G_(uS.prototype,"play",[k$,P$],Object.getOwnPropertyDescriptor(uS.prototype,"play"),uS.prototype),G_(uS.prototype,"stop",[x$,D$],Object.getOwnPropertyDescriptor(uS.prototype,"stop"),uS.prototype),G_(uS.prototype,"close",[L$],Object.getOwnPropertyDescriptor(uS.prototype,"close"),uS.prototype),G_(uS.prototype,"pipe",[M$],Object.getOwnPropertyDescriptor(uS.prototype,"pipe"),uS.prototype),G_(uS.prototype,"unpipe",[j$],Object.getOwnPropertyDescriptor(uS.prototype,"unpipe"),uS.prototype),uS),DU=(U$=b0({argsMap:(d,h)=>[d.getTrackId(),h]}),F$=HS(),B$=eP("MicrophoneAudioTrack","_enabledMutex"),V$=b0({argsMap:(d,h,g)=>[d.getTrackId(),h,g]}),G$=HS(),$$=b0({argsMap:d=>[d.getTrackId()]}),G_((gO=class extends zR{get __className__(){return"MicrophoneAudioTrack"}constructor(d,h,g,j){super(d,h.encoderConfig?wU(h.encoderConfig):{},j,__("GET_VOLUME_OF_MUTED_AUDIO_TRACK"),!0),_h(this,"_config",void 0),_h(this,"_deviceName","default"),_h(this,"_constraints",void 0),_h(this,"_originalConstraints",void 0),_h(this,"_enabled",!0),this._config=h,this._constraints=g,this._originalConstraints=g,this._deviceName=d.label,typeof h.bypassWebAudio=="boolean"&&(this._bypassWebAudio=h.bypassWebAudio),(G1()||C3())&&cS.bindInterruptDetectorTrack(this),this.on(xU.UPDATE_TRACK_SOURCE,()=>{this.bindProcessorContextEvents()}),n$()&&this.bindProcessorContextEvents()}async setDevice(d){if(wE.info("[".concat(this.getTrackId(),"] start set device to ").concat(d)),this._enabled)try{const h=await _C.getDeviceById(d),g={};g.audio=C5({},this._constraints),g.audio.deviceId={exact:d},this._originMediaStreamTrack.stop();let j=null;try{j=await kI(g,this.getTrackId())}catch(_t){throw wE.error("[".concat(this.getTrackId(),"] setDevice failed"),_t.toString()),j=await kI({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(j.getAudioTracks()[0],!1),_t}await this._updateOriginMediaStreamTrack(j.getAudioTracks()[0],!1),this._deviceName=h.label,this._config.microphoneId=d,this._constraints.deviceId={exact:d}}catch(h){throw wE.error("[".concat(this.getTrackId(),"] setDevice error"),h.toString()),h}else try{const h=await _C.getDeviceById(d);this._deviceName=h.label,this._config.microphoneId=d,this._constraints.deviceId={exact:d}}catch(h){throw wE.error("[".concat(this.getTrackId(),"] setDevice error"),h.toString()),h}wE.info("[".concat(this.getTrackId(),"] set device to ").concat(d," success"))}async setEnabled(d,h,g){if(h)return wE.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(d);if(!g){if(d===this._enabled)return;this.stateCheck("enabled",d)}if(wE.info("[".concat(this.getTrackId(),"] start setEnabled"),d),!d){var j;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),(j=this._source.clonedTrack)===null||j===void 0||j.stop(),g||(this._enabled=!1);try{await qS(this,I0.NEED_DISABLE_TRACK,this)}catch(_o){throw wE.error("[".concat(this.getTrackId(),"] setEnabled false failed"),_o.toString()),_o}return}const _t=C5({},this._constraints),_i=_C.searchDeviceIdByName(this._deviceName);_i&&!_t.deviceId&&(_t.deviceId=_i);try{g||(this._enabled=!0);const _o=await kI({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(_o.getAudioTracks()[0],!1),await qS(this,I0.NEED_ENABLE_TRACK,this)}catch(_o){throw g||(this._enabled=!1),wE.error("[".concat(this.getTrackId(),"] setEnabled true failed"),_o.toString()),_o}wE.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(G1()||C3())&&cS.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((aT()||hO())&&this._enabled&&!this._isClosed&&cS.duringInterruption){const d=async()=>{cS.off(bR.IOS_INTERRUPTION_END,d),this._enabled&&!this._isClosed&&(wE.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};cS.on(bR.IOS_INTERRUPTION_END,d)}else wE.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(lN.TRACK_ENDED)}async renewMediaStreamTrack(d){const h=d||this._constraints,g=_C.searchDeviceIdByName(this._deviceName);if(g&&!h.deviceId&&(h.deviceId=g),this._constraints=h,this._enabled){this._originMediaStreamTrack.stop();const j=await kI({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(j.getAudioTracks()[0],!0)}}bindProcessorContextEvents(){this.processorContext.on(CT.REQUEST_UPDATE_CONSTRAINTS,async(d,h,g)=>{try{const j=Object.assign({},this._originalConstraints,...d);await this.renewMediaStreamTrack(j),h()}catch(j){g(j)}}),this.processorContext.on(CT.REQUEST_CONSTRAINTS,async d=>{d(this._originMediaStreamTrack.getSettings())})}}).prototype,"setDevice",[U$,F$],Object.getOwnPropertyDescriptor(gO.prototype,"setDevice"),gO.prototype),G_(gO.prototype,"setEnabled",[B$,V$,G$],Object.getOwnPropertyDescriptor(gO.prototype,"setEnabled"),gO.prototype),G_(gO.prototype,"close",[$$],Object.getOwnPropertyDescriptor(gO.prototype,"close"),gO.prototype),gO),YQ=(W$=b0({argsMap:(d,h)=>[d.getTrackId(),h,d.duration]}),H$=HS(),q$=b0({argsMap:d=>[d.getTrackId()]}),z$=HS(),K$=b0({argsMap:d=>[d.getTrackId()]}),Y$=HS(),J$=b0({argsMap:d=>[d.getTrackId()]}),X$=HS(),Q$=b0({argsMap:d=>[d.getTrackId()]}),Z$=HS(),eW=b0({argsMap:d=>[d.getTrackId()]}),tW=HS(),G_((nT=class extends zR{get __className__(){return"BufferSourceAudioTrack"}constructor(d,h,g,j){super(h.createOutputTrack(),g,j),_h(this,"source",void 0),_h(this,"_bufferSource",void 0),this.source=d,this._bufferSource=h,this._bufferSource.on(wT.AUDIO_SOURCE_STATE_CHANGE,_t=>{this.safeEmit(lN.SOURCE_STATE_CHANGE,_t)});try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(d){d&&this._bufferSource.updateOptions(d),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(d){this._bufferSource.seekAudioBuffer(d)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}setAudioBufferPlaybackSpeed(d){SS(d,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(d)}}).prototype,"startProcessAudioBuffer",[W$,H$],Object.getOwnPropertyDescriptor(nT.prototype,"startProcessAudioBuffer"),nT.prototype),G_(nT.prototype,"pauseProcessAudioBuffer",[q$,z$],Object.getOwnPropertyDescriptor(nT.prototype,"pauseProcessAudioBuffer"),nT.prototype),G_(nT.prototype,"seekAudioBuffer",[K$,Y$],Object.getOwnPropertyDescriptor(nT.prototype,"seekAudioBuffer"),nT.prototype),G_(nT.prototype,"resumeProcessAudioBuffer",[J$,X$],Object.getOwnPropertyDescriptor(nT.prototype,"resumeProcessAudioBuffer"),nT.prototype),G_(nT.prototype,"stopProcessAudioBuffer",[Q$,Z$],Object.getOwnPropertyDescriptor(nT.prototype,"stopProcessAudioBuffer"),nT.prototype),G_(nT.prototype,"setAudioBufferPlaybackSpeed",[eW,tW],Object.getOwnPropertyDescriptor(nT.prototype,"setAudioBufferPlaybackSpeed"),nT.prototype),nT);class IT extends zR{get __className__(){return"MixingAudioTrack"}get isActive(){for(const h of this.trackList)if(h._enabled&&!h._isClosed&&!h.muted)return!0;return!1}constructor(){const h=tP().createMediaStreamDestination();super(h.stream.getAudioTracks()[0],void 0,CS(8,"track-mix-")),_h(this,"trackList",void 0),_h(this,"destNode",void 0);try{this._mediaStreamTrack=this._source.createOutputTrack()}catch{}this.destNode=h,this.trackList=[]}hasAudioTrack(h){return this.trackList.indexOf(h)!==-1}addAudioTrack(h){this.trackList.indexOf(h)===-1?(wE.debug("add ".concat(h.getTrackId()," to mixing track")),h._source.outputNode.connect(this.destNode),this.trackList.push(h),this.updateEncoderConfig()):wE.debug("track ".concat(h.getTrackId()," is already added"))}removeAudioTrack(h){if(this.trackList.indexOf(h)!==-1){wE.debug("remove ".concat(h.getTrackId()," from mixing track"));try{h._source.outputNode.disconnect(this.destNode)}catch{}A5(this.trackList,h),this.updateEncoderConfig()}}updateEncoderConfig(){const h={};this.trackList.forEach(g=>{g._encoderConfig&&((g._encoderConfig.bitrate||0)>(h.bitrate||0)&&(h.bitrate=g._encoderConfig.bitrate),(g._encoderConfig.sampleRate||0)>(h.sampleRate||0)&&(h.sampleRate=g._encoderConfig.sampleRate),(g._encoderConfig.sampleSize||0)>(h.sampleSize||0)&&(h.sampleSize=g._encoderConfig.sampleSize),g._encoderConfig.stereo&&(h.stereo=!0))}),this._encoderConfig=h}_updateRtpTransceiver(h){this._rtpTransceiver!==h&&(this._rtpTransceiver=h,this.trackList.forEach(g=>{g instanceof IT?g.emit(mL.TRANSCEIVER_UPDATED,h):g._updateRtpTransceiver(h)}))}}class JQ extends US{constructor(){super(...arguments),_h(this,"resultStorage",new Map)}setLocalAudioStats(h,g,j){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",h,this.checkAudioInputLevel(j,g)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",h,this.checkSendAudioBitrate(j,g))}setLocalVideoStats(h,g,j){this.record("SEND_VIDEO_BITRATE_TOO_LOW",h,this.checkSendVideoBitrate(j,g)),this.record("FRAMERATE_INPUT_TOO_LOW",h,this.checkFramerateInput(j,g)),this.record("FRAMERATE_SENT_TOO_LOW",h,this.checkFramerateSent(j))}setRemoteAudioStats(h,g){const j=h.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",j,this.checkAudioOutputLevel(g))}setRemoteVideoStats(h,g){const j=h.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",j,this.checkVideoDecode(g))}record(h,g,j){if(__("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(h)||this.resultStorage.set(h,{result:[],isPrevNormal:!0});const _t=this.resultStorage.get(h);if(_t&&(_t.result.push(j),_t.result.length>=5)){const _i=_t.result.includes(!0);_t.isPrevNormal&&!_i&&this.emit("exception",rW[h],h,g),!_t.isPrevNormal&&_i&&this.emit("exception",rW[h]+2e3,h+"_RECOVER",g),_t.isPrevNormal=_i,_t.result=[]}}checkAudioOutputLevel(h){return!(h.receiveBitrate>0&&h.receiveLevel===0)}checkAudioInputLevel(h,g){return g instanceof IT&&!g.isActive||!!g.muted||h.sendVolumeLevel!==0}checkFramerateInput(h,g){let j=null;g._encoderConfig&&g._encoderConfig.frameRate&&(j=VO(g._encoderConfig.frameRate));const _t=h.captureFrameRate;return!j||!_t||!(j>10&&_t<5||j<10&&j>=5&&_t<=1)}checkFramerateSent(h){return!(h.captureFrameRate&&h.sendFrameRate&&h.captureFrameRate>5&&h.sendFrameRate<=1)}checkSendVideoBitrate(h,g){return!!g.muted||h.sendBitrate!==0}checkSendAudioBitrate(h,g){return g instanceof IT&&!g.isActive||!!g.muted||h.sendBitrate!==0}checkVideoDecode(h){return h.receiveBitrate===0||h.decodeFrameRate!==0}}const rW={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},hI=new class{markSubscribeStart(d,h){performance.mark("agora-web-sdk/".concat(d,"/subscribe-").concat(h))}markPublishStart(d,h){performance.mark("agora-web-sdk/".concat(d,"/publish-").concat(h))}measureFromSubscribeStart(d,h){const g=performance.getEntriesByName("agora-web-sdk/".concat(d,"/subscribe-").concat(h));if(g.length>0){const j=g[g.length-1];return Math.round(performance.now()-j.startTime)}return 0}measureFromPublishStart(d,h){const g=performance.getEntriesByName("agora-web-sdk/".concat(d,"/publish-").concat(h));if(g.length>0){const j=g[g.length-1];return Math.round(performance.now()-j.startTime)}return 0}};function iW(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function i1(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?iW(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):iW(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}class iP{constructor(h){_h(this,"store",void 0),_h(this,"onStatsException",void 0),_h(this,"onUploadPublishDuration",void 0),_h(this,"onStatsChanged",void 0),_h(this,"localStats",new Map),_h(this,"remoteStats",new Map),_h(this,"updateStatsInterval",void 0),_h(this,"trafficStats",void 0),_h(this,"trafficStatsPeerList",[]),_h(this,"uplinkStats",void 0),_h(this,"exceptionMonitor",void 0),_h(this,"p2pChannel",void 0),_h(this,"scalabilityMode",S3.L1T1),_h(this,"updateStats",()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))}),this.store=h,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new JQ,this.exceptionMonitor.on("exception",(g,j,_t)=>{this.onStatsException&&this.onStatsException(g,j,_t)})}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(l0.LocalAudioTrack)||i1({},o5)}getLocalVideoTrackStats(){return this.localStats.get(l0.LocalVideoTrack)||i1({},s5)}getRemoteAudioTrackStats(h){const g=(_i,_o)=>{if(!this.trafficStats)return _o;const ga=this.trafficStats.peer_delay.find(_a=>_a.peer_uid===_i);return ga&&(_o.publishDuration=ga.B_ppad+(Date.now()-this.trafficStats.timestamp)),_o},j={};if(h){var _t;const _i=(_t=this.remoteStats.get(h))===null||_t===void 0?void 0:_t.audioStats;_i&&(j[h]=g(h,_i))}else Array.from(this.remoteStats.entries()).forEach(_i=>{let[_o,{audioStats:ga}]=_i;ga&&(j[_o]=g(_o,ga))});return j}getRemoteNetworkQualityStats(h){const g={};if(h){var j;const _t=(j=this.remoteStats.get(h))===null||j===void 0?void 0:j.networkStats;_t&&(g[h]=_t)}else Array.from(this.remoteStats.entries()).forEach(_t=>{let[_i,{networkStats:_o}]=_t;_o&&(g[_i]=_o)});return g}getRemoteVideoTrackStats(h){const g=(_i,_o)=>{if(!this.trafficStats)return _o;const ga=this.trafficStats.peer_delay.find(_a=>_a.peer_uid===_i);return ga&&(_o.publishDuration=ga.B_ppvd+(Date.now()-this.trafficStats.timestamp)),_o},j={};if(h){var _t;const _i=(_t=this.remoteStats.get(h))===null||_t===void 0?void 0:_t.videoStats;_i&&(j[h]=g(h,_i))}else Array.from(this.remoteStats.entries()).forEach(_i=>{let[_o,{videoStats:ga}]=_i;ga&&(j[_o]=g(_o,ga))});return j}getRTCStats(){let h=0,g=0,j=0,_t=0;const _i=this.localStats.get(l0.LocalAudioTrack);_i&&(h+=_i.sendBytes,g+=_i.sendBitrate);const _o=this.localStats.get(l0.LocalVideoTrack);_o&&(h+=_o.sendBytes,g+=_o.sendBitrate);const ga=this.localStats.get(l0.LocalVideoLowTrack);ga&&(h+=ga.sendBytes,g+=ga.sendBitrate),this.remoteStats.forEach(_u=>{let{audioStats:_c,videoStats:_l}=_u;_c&&(j+=_c.receiveBytes,_t+=_c.receiveBitrate),_l&&(j+=_l.receiveBytes,_t+=_l.receiveBitrate)});let _a=1;return this.trafficStats&&(_a+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:_a,SendBitrate:g,SendBytes:h,RecvBytes:j,RecvBitrate:_t,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(h){this.localStats.set(h,void 0)}removeLocalStats(h){h?this.localStats.delete(h):this.localStats.clear()}addRemoteStats(h){this.remoteStats.set(h,{})}removeRemoteStats(h){h?this.remoteStats.delete(h):this.remoteStats.clear()}addP2PChannel(h){this.p2pChannel=h}updateTrafficStats(h){h.peer_delay=h.peer_delay.filter(g=>g.B_ppad!==void 0||g.B_ppvd!==void 0),h.peer_delay.filter(g=>this.trafficStatsPeerList.indexOf(g.peer_uid)===-1).forEach(g=>{var j;const _t=(j=this.p2pChannel)===null||j===void 0?void 0:j.getRemoteMedia(g.peer_uid),_i=_t!=null&&_t.videoSSRC?hI.measureFromSubscribeStart(this.store.clientId,_t.videoSSRC):0,_o=_t!=null&&_t.audioSSRC?hI.measureFromSubscribeStart(this.store.clientId,_t.audioSSRC):0;g.B_ppad!==void 0&&g.B_ppvd!==void 0&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(g.peer_uid,g.B_ppad,g.B_ppvd,_i>_o?_i:_o),this.trafficStatsPeerList.push(g.peer_uid))}),this.trafficStats=h}updateUplinkStats(h){this.uplinkStats&&this.uplinkStats.B_fir!==h.B_fir&&wE.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(h.B_fir)),this.uplinkStats=h}static isRemoteVideoFreeze(h,g,j){if(!h)return!1;const _t=!!j&&g.framesDecodeFreezeTime>j.framesDecodeFreezeTime,_i=!j||g.framesDecodeCount>j.framesDecodeCount;return _t||!_i}static isRemoteAudioFreeze(h){return!!h&&h._isFreeze()}isLocalVideoFreeze(h){return!(!h.inputFrame||!h.sentFrame)&&h.inputFrame.frameRate>5&&h.sentFrame.frameRate<3}updateLocalStats(h){Array.from(this.localStats.entries()).forEach(g=>{let[j,_t]=g;switch(j){case l0.LocalVideoTrack:case l0.LocalVideoLowTrack:{const _o=_t,ga=i1({},s5),_a=h.getStats(),_u=h.getLocalMedia(j);if(_a){const _c=_a.videoSend.find(_l=>_l.ssrc===(_u==null?void 0:_u.ssrcs[0].ssrcId));if(_c){const _l=h.getLocalVideoSize(),_g=h.getEncoderConfig(l0.LocalVideoTrack);_c.codec!=="H264"&&_c.codec!=="H265"&&_c.codec!=="VP8"&&_c.codec!=="VP9"&&_c.codec!=="AV1X"&&_c.codec!=="AV1"||(ga.codecType=_c.codec),ga.sendBytes=_c.bytes,ga.sendBitrate=_o?8*Math.max(0,ga.sendBytes-_o.sendBytes):0,_c.inputFrame?(ga.captureFrameRate=_c.inputFrame.frameRate,ga.captureResolutionHeight=_c.inputFrame.height,ga.captureResolutionWidth=_c.inputFrame.width):_l&&(ga.captureResolutionWidth=_l.width,ga.captureResolutionHeight=_l.height),_c.sentFrame?(ga.sendFrameRate=_c.sentFrame.frameRate,ga.sendResolutionHeight=_c.sentFrame.height,ga.sendResolutionWidth=_c.sentFrame.width):_l&&(ga.sendResolutionWidth=_l.width,ga.sendResolutionHeight=_l.height),_c.avgEncodeMs&&(ga.encodeDelay=_c.avgEncodeMs),_g&&_g.bitrateMax&&(ga.targetSendBitrate=1e3*_g.bitrateMax),ga.sendPackets=_c.packets,ga.sendPacketsLost=_c.packetsLost,ga.totalDuration=_o?_o.totalDuration+1:1,ga.totalFreezeTime=_o?_o.totalFreezeTime:0,this.isLocalVideoFreeze(_c)&&(ga.totalFreezeTime+=1),_c.scalabilityMode&&this.scalabilityMode!==_c.scalabilityMode&&(wE.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(_c.scalabilityMode)),this.scalabilityMode=_c.scalabilityMode)}this.trafficStats&&(ga.sendPacketsLost=this.trafficStats.B_pvlr4/100)}var _i;this.localStats.set(j,ga),((_o==null?void 0:_o.sendResolutionWidth)!==ga.sendResolutionWidth||(_o==null?void 0:_o.sendResolutionHeight)!==ga.sendResolutionHeight)&&((_i=this.onStatsChanged)===null||_i===void 0||_i.call(this,"resolution",{width:ga.sendResolutionWidth,height:ga.sendResolutionHeight})),ga&&_u&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,_u.track,ga);break}case l0.LocalAudioTrack:{const _o=_t,ga=i1({},o5),_a=h.getStats(),_u=h.getLocalMedia(j);if(_a){const _c=_a.audioSend.find(_l=>_l.ssrc===(_u==null?void 0:_u.ssrcs[0].ssrcId));if(_c){if(_c.codec!=="opus"&&_c.codec!=="aac"&&_c.codec!=="PCMU"&&_c.codec!=="PCMA"&&_c.codec!=="G722"||(ga.codecType=_c.codec),_c.inputLevel)ga.sendVolumeLevel=Math.round(32767*_c.inputLevel);else{const _l=h.getLocalAudioVolume();_l&&(ga.sendVolumeLevel=Math.round(32767*_l))}ga.sendBytes=_c.bytes,ga.sendPackets=_c.packets,ga.sendPacketsLost=_c.packetsLost,ga.sendBitrate=_o?8*Math.max(0,ga.sendBytes-_o.sendBytes):0}}this.trafficStats&&(ga.sendPacketsLost=this.trafficStats.B_pvlr4/100),this.localStats.set(l0.LocalAudioTrack,ga),ga&&_u&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,_u.track,ga);break}}})}updateRemoteStats(h){Array.from(this.remoteStats.entries()).forEach(g=>{let[j,{videoStats:_t,audioStats:_i,videoPcStats:_o}]=g;const ga=_i,_a=_t,_u=_o,_c=i1({},N4),_l=i1({},k4),_g=i1({},AX),{audioTrack:r_,videoTrack:l_,audioSSRC:d_,videoSSRC:p_}=h.getRemoteMedia(j),C_=h.getStats(),O_=C_==null?void 0:C_.audioRecv.find(K_=>K_.ssrc===d_),q_=C_==null?void 0:C_.videoRecv.find(K_=>K_.ssrc===p_),c0=this.trafficStats&&this.trafficStats.peer_delay.find(K_=>K_.peer_uid===j);if(O_&&(O_.codec!=="opus"&&O_.codec!=="aac"&&O_.codec!=="PCMU"&&O_.codec!=="PCMA"&&O_.codec!=="G722"||(_c.codecType=O_.codec),O_.outputLevel?_c.receiveLevel=Math.round(32767*O_.outputLevel):r_&&(_c.receiveLevel=Math.round(32767*r_.getVolumeLevel())),_c.receiveBytes=O_.bytes,_c.receivePackets=O_.packets,_c.receivePacketsLost=O_.packetsLost,_c.packetLossRate=_c.receivePacketsLost/(_c.receivePackets+_c.receivePacketsLost),_c.receiveBitrate=ga?8*Math.max(0,_c.receiveBytes-ga.receiveBytes):0,_c.totalDuration=ga?ga.totalDuration+1:1,_c.totalFreezeTime=ga?ga.totalFreezeTime:0,_c.freezeRate=_c.totalFreezeTime/_c.totalDuration,_c.receiveDelay=O_.jitterBufferMs,_c.totalDuration>10&&iP.isRemoteAudioFreeze(r_)&&(_c.totalFreezeTime+=1)),q_){q_.codec!=="H264"&&q_.codec!=="H265"&&q_.codec!=="VP8"&&q_.codec!=="VP9"&&q_.codec!=="AV1X"&&q_.codec!=="AV1"||(_l.codecType=q_.codec),_l.receiveBytes=q_.bytes,_l.receiveBitrate=_a?8*Math.max(0,_l.receiveBytes-_a.receiveBytes):0,_l.decodeFrameRate=q_.decodeFrameRate<0?0:q_.decodeFrameRate,_l.renderFrameRate=q_.decodeFrameRate<0?0:q_.decodeFrameRate,q_.outputFrame&&(_l.renderFrameRate=q_.outputFrame.frameRate),q_.receivedFrame?(_l.receiveFrameRate=q_.receivedFrame.frameRate,_l.receiveResolutionHeight=q_.receivedFrame.height,_l.receiveResolutionWidth=q_.receivedFrame.width):l_&&(_l.receiveResolutionHeight=l_._videoHeight||0,_l.receiveResolutionWidth=l_._videoWidth||0),q_.framesRateFirefox!==void 0&&(_l.receiveFrameRate=Math.round(q_.framesRateFirefox)),_l.receivePackets=q_.packets,_l.receivePacketsLost=q_.packetsLost,_l.packetLossRate=_l.receivePacketsLost/(_l.receivePackets+_l.receivePacketsLost),_l.totalDuration=_a?_a.totalDuration+1:1,_l.totalFreezeTime=_a?_a.totalFreezeTime:0,_l.receiveDelay=q_.jitterBufferMs||0;const K_=!!p_&&h.getRemoteVideoIsReady(p_);l_&&K_&&iP.isRemoteVideoFreeze(l_,q_,_u)&&(_l.totalFreezeTime+=1),_l.freezeRate=_l.totalFreezeTime/_l.totalDuration}c0&&(_c.end2EndDelay=c0.B_ad,_l.end2EndDelay=c0.B_vd,_c.transportDelay=c0.B_ed,_l.transportDelay=c0.B_ed,_c.currentPacketLossRate=c0.B_ealr4/100,_l.currentPacketLossRate=c0.B_evlr4/100,_g.uplinkNetworkQuality=c0.B_punq?c0.B_punq:0,_g.downlinkNetworkQuality=c0.B_pdnq?c0.B_pdnq:0),this.remoteStats.set(j,{audioStats:_c,videoStats:_l,videoPcStats:q_,networkStats:_g}),r_&&this.exceptionMonitor.setRemoteAudioStats(r_,_c),l_&&this.exceptionMonitor.setRemoteVideoStats(l_,_l)})}}const BO=new class extends US{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),_h(this,"_lastHiddenTime",0),_h(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),wE.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)})}};function oW(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function LU(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?oW(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):oW(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}function MU(d){return d.match(/^[\.\:\d]+$/)?"".concat(d.replace(/[^\d]/g,"-"),".").concat(__("TURN_DOMAIN")):(wE.info("Cannot recognized as IP address ".concat(d,". Used As Host instead")),d)}function sW(d,h){var g,j;const _t=__("GATEWAY_DOMAINS");let _i=_t[1]&&h.indexOf(_t[1])!==-1?1:0;d.addresses=d.addresses||[];const _o=d.addresses.map(_a=>_a.domain_prefix?{address:"".concat(_a.domain_prefix,".").concat(_t[_i++%_t.length],":").concat(_a.port)}:_a.ip.match(/^[\.\:\d]+$/)?{ip:_a.ip,port:_a.port,address:"".concat(_a.ip.replace(/[^\d]/g,"-"),".").concat(_t[_i++%_t.length],":").concat(_a.port)}:(wE.info("Cannot recognized as IP address ".concat(_a.ip,". Used As Host instead")),{ip:_a.ip,port:_a.port,address:"".concat(_a.ip,":").concat(_a.port)}));if((g=d.detail)!==null&&g!==void 0&&g[18]&&typeof((j=d.detail)===null||j===void 0?void 0:j[18])=="string"){const _a=d.detail[18],_u=_a==null?void 0:_a.split(";");for(let _c=0;_c<_u.length;_c++){var ga;const _l=LO(ga=_u[_c]).call(ga);_o[_c]&&_l&&(_o[_c].ip6=_l)}}return{gatewayAddrs:_o,uid:d.uid,cid:d.cid,cert:d.cert,vid:d.detail&&d.detail[8],uni_lbs_ip:d.detail&&d.detail[1],res:d,csIp:d.detail&&d.detail[502]}}function VO(d){return typeof d=="number"?d:d.exact||d.ideal||d.max||d.min||0}function aW(d){const h=d._encoderConfig;if(!h)return{};const g={resolution:h.width&&h.height?"".concat(VO(h.width),"x").concat(VO(h.height)):void 0,maxVideoBW:h.bitrateMax,minVideoBW:h.bitrateMin};return typeof h.frameRate=="number"?(g.maxFrameRate=h.frameRate,g.minFrameRate=h.frameRate):h.frameRate&&(g.maxFrameRate=h.frameRate.max||h.frameRate.ideal||h.frameRate.exact||h.frameRate.min,g.minFrameRate=h.frameRate.min||h.frameRate.ideal||h.frameRate.exact||h.frameRate.max),g}function cW(d){return d>=0&&d<.17?1:d>=.17&&d<.36?2:d>=.36&&d<.59?3:d>=.59&&d<=1?4:d>1?5:0}function I5(d,h){let g,j,_t;switch(h){case yR.CHOOSE_SERVER:g=4096,j="choose server";break;case yR.CLOUD_PROXY:g=1048576,j="proxy";break;case yR.CLOUD_PROXY_5:g=4194304,j="proxy5";break;case yR.CLOUD_PROXY_FALLBACK:g=4194310,j="proxy fallback";break;default:throw new f_(c_.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:d.detail&&d.detail[502],retry:!1})}if(d.response_body.forEach(_i=>{_i.buffer&&_i.buffer.flag===g&&(_t={code:_i.buffer.code,addresses:(_i.buffer.edges_services||[]).map(_o=>LU(LU({},_o),{},{ticket:_i.buffer.cert})),server_ts:d.enter_ts,uid:_i.buffer.uid,cid:_i.buffer.cid,cname:_i.buffer.cname,detail:LU(LU({},_i.buffer.detail),d.detail),flag:_i.buffer.flag,opid:d.opid,cert:_i.buffer.cert})}),!_t)throw new f_(c_.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(j," from multi unilbs response"),{csIp:d.detail&&d.detail[502]});return _t}async function XQ(d,h){return await a0.all(d.addresses.map(async g=>({address:MU(g.ip),tcpport:g.port,udpport:g.port,username:h&&__("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?h.toString():YT.username,password:h&&__("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await LQ(h.toString()):YT.password})))}function QQ(d,h){const g=h._videoWidth||h.getMediaStreamTrack(!0).getSettings().width;return g||wE.warning("cannot get original video track's width, default scale down 4 times for low stream"),g?g/VO(d.width):4}function jU(d){let{candidateType:h,relayProtocol:g,type:j,address:_t,port:_i,protocol:_o}=d;return j==="local-candidate"?{candidateType:h,relayProtocol:g,protocol:_o}:{candidateType:h,relayProtocol:g,address:_t,port:_i,protocol:_o}}function uW(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function o1(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?uW(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):uW(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}function oP(d){return window.TextEncoder?new TextEncoder().encode(d).length:d.length}function KR(d){return new a0(h=>{window.setTimeout(h,d)})}function ZQ(d){const h=new f_(c_.TIMEOUT,"timeout");return new a0((g,j)=>{window.setTimeout(()=>j(h),d)})}function CS(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:7,h=arguments.length>1?arguments[1]:void 0;const g=Math.random().toString(16).substr(2,d).toLowerCase();return g.length===d?"".concat(h).concat(g):"".concat(h).concat(g)+CS(d-g.length,"")}function O5(){return CS(32,"").toUpperCase()}const UU=()=>{};function lW(d){return new a0((h,g)=>{let j=!1;const _t=document.createElement("video");_t.setAttribute("autoplay",""),_t.setAttribute("muted",""),_t.muted=!0,_t.autoplay=!0,_t.setAttribute("playsinline",""),_t.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(_t);const _i=aT()?"canplay":"playing";_t.addEventListener(_i,()=>{const _o=_t.videoWidth,ga=_t.videoHeight;!_o&&GS()||(j=!0,_t.srcObject=null,_t.remove(),h([_o,ga]))}),_t.srcObject=new MediaStream([d]),_t.play().catch(UU),setTimeout(()=>{j||(_t.srcObject=null,_t.remove(),h([_t.videoWidth,_t.videoHeight]))},4e3)})}function sP(d){return a0.all(d.map(h=>h.then(g=>{throw g},g=>g))).then(h=>{throw h},h=>h)}function YR(d,h){for(var g=arguments.length,j=new Array(g>2?g-2:0),_t=2;_t<g;_t++)j[_t-2]=arguments[_t];return d.getListeners(h).length===0?a0.reject(new f_(c_.UNEXPECTED_ERROR,"can not emit promise")):new a0((_i,_o)=>{d.emit(h,...j,_i,_o)})}function qS(d,h){if(d.getListeners(h).length===0)return a0.resolve();for(var g=arguments.length,j=new Array(g>2?g-2:0),_t=2;_t<g;_t++)j[_t-2]=arguments[_t];return YR(d,h,...j)}function PI(d,h){if(d.getListeners(h).length===0)return null;for(var g=arguments.length,j=new Array(g>2?g-2:0),_t=2;_t<g;_t++)j[_t-2]=arguments[_t];return s1(d,h,...j)}function s1(d,h){let g=null,j=null;for(var _t=arguments.length,_i=new Array(_t>2?_t-2:0),_o=2;_o<_t;_o++)_i[_o-2]=arguments[_o];if(d.emit(h,..._i,ga=>{g=ga},ga=>{j=ga}),j!==null)throw j;if(g===null)throw new f_(c_.UNEXPECTED_ERROR,"handler is not sync");return g}function A5(d,h){const g=d.indexOf(h);g!==-1&&d.splice(g,1)}function dW(d){const h=[];return d.forEach(g=>{h.indexOf(g)===-1&&h.push(g)}),h}function eO(d){a0.resolve().then(d)}function aR(d){return JSON.parse(JSON.stringify(d))}const pW={};function vL(d,h){pW[h]||(pW[h]=!0,d())}function N5(d){const h=window.atob(d),g=new Uint8Array(new ArrayBuffer(h.length));for(let j=0;j<h.length;j+=1)g[j]=h.charCodeAt(j);return g}function FU(d){let h="";for(let g=0;g<d.length;g+=1)h+=String.fromCharCode(d[g]);return window.btoa(h)}const hW=new class{constructor(){_h(this,"fnMap",new Map)}throttleByKey(d,h,g,j){for(var _t=arguments.length,_i=new Array(_t>4?_t-4:0),_o=4;_o<_t;_o++)_i[_o-4]=arguments[_o];if(this.fnMap.has(h)){const ga=this.fnMap.get(h);if(ga.threshold!==g){ga.fn(...ga.args),clearTimeout(ga.timer);const _a=window.setTimeout(()=>{const _u=this.fnMap.get(h);_u&&_u.fn(..._u.args),this.fnMap.delete(h)},g);this.fnMap.set(h,{fn:d,threshold:g,timer:_a,args:_i,skipFn:j})}else ga.skipFn&&ga.skipFn(...ga.args),this.fnMap.set(h,o1(o1({},ga),{},{fn:d,args:_i,skipFn:j}))}else{const ga=window.setTimeout(()=>{const _a=this.fnMap.get(h);_a&&_a.fn(..._a.args),this.fnMap.delete(h)},g);this.fnMap.set(h,{fn:d,threshold:g,timer:ga,args:_i,skipFn:j})}}},fW=hW.throttleByKey.bind(hW),_L=async d=>{let{fragementLength:h,referenceList:g,asyncMapHandler:j,allFailedhandler:_t,promisesCollector:_i}=d,_o=0;const ga=h;let _a,_u=0;const _c=async()=>{const _l=(()=>{const _g=_o*ga,r_=_g+ga;return g.slice(_g,r_).map(j)})();_i&&_i.push(..._l);try{_a=await sP(_l)}catch(_g){if(_u+=ga,_o++,!(_u>=g.length))return void await _c();_t(_g)}_l.forEach(_g=>_g.cancel())};return await _c(),_a};function mW(d){return typeof d=="object"&&d!==null&&!(d instanceof RegExp)}const eZ={[X1.ACCESS_POINT]:{[WR.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[WR.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[WR.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[WR.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[WR.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[WR.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voice service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[WR.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[X1.UNILBS]:{[JT.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[JT.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[JT.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[JT.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[JT.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[JT.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[JT.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[JT.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[JT.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[JT.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[JT.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[JT.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[X1.STRING_UID_ALLOCATOR]:{[hL.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[hL.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[hL.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function BU(d){const h=eZ[Math.floor(d/1e4)];if(!h)return{desc:"unkonw error",retry:!1};const g=h[d%1e4];if(!g){if(Math.floor(d/1e4)===X1.ACCESS_POINT){const j=d%1e4;if(j.toString()[0]==="1")return{desc:d.toString(),retry:!1};if(j.toString()[0]==="2")return{desc:d.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return g}const tZ={[S0.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[S0.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[S0.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[S0.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[S0.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[S0.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[S0.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[S0.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[S0.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[S0.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[S0.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[S0.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[S0.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[S0.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[S0.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[S0.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[S0.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[S0.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[S0.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[S0.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[S0.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[S0.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[S0.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[S0.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[S0.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[S0.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[S0.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[S0.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[S0.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[S0.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[S0.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[S0.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[S0.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[S0.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[S0.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[S0.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[S0.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[S0.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[S0.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[S0.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[S0.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[S0.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[S0.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[S0.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[S0.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[S0.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[S0.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[S0.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[S0.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[S0.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[S0.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[S0.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[S0.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[S0.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[S0.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[S0.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[S0.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[S0.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[S0.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[S0.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[S0.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[S0.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[S0.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[S0.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function yL(d){return tZ[d]||{desc:"UNKNOW_ERROR_".concat(d),action:"failed"}}function gW(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}class a1 extends US{get url(){return this.websocket?this.websocket.url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(h){["tryNext","recover"].includes(h)&&this.resetReconnectCount(h),this._reconnectMode=h}get state(){return this._state}set state(h){h!==this._state&&(this._state=h,this._state==="reconnecting"?this.emit(x0.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit(x0.CONNECTED):this._state==="closed"?this.emit(x0.CLOSED):this._state==="failed"&&this.emit(x0.FAILED))}resetReconnectCount(h){wE.debug("websocket reset reconnect count, reason: "+h),this.reconnectCount=0}constructor(h,g){let j=arguments.length>2&&arguments[2]!==void 0&&arguments[2],_t=arguments.length>3&&arguments[3]!==void 0&&arguments[3],_i=arguments.length>4?arguments[4]:void 0;super(),_h(this,"connectionID",0),_h(this,"currentURLIndex",0),_h(this,"urls",void 0),_h(this,"_reconnectMode","tryNext"),_h(this,"reconnectReason",void 0),_h(this,"_initMutex",new lT("websocket")),_h(this,"name",void 0),_h(this,"_state","closed"),_h(this,"reconnectInterrupter",void 0),_h(this,"websocket",void 0),_h(this,"retryConfig",void 0),_h(this,"reconnectCount",0),_h(this,"forceCloseTimeout",5e3),_h(this,"onlineReconnectListener",void 0),_h(this,"useCompress",void 0),_h(this,"tryDoubleDomain",!1),_h(this,"wsInflateLength",0),_h(this,"wsDeflateLength",0),_h(this,"closeEstablishingWs",()=>{}),_h(this,"store",void 0),_h(this,"joinChannelServiceRecordIndex",void 0),this.store=_i,this.name=h,this.retryConfig=function(_c){for(var _l=1;_l<arguments.length;_l++){var _g=arguments[_l]!=null?arguments[_l]:{};_l%2?gW(Object(_g),!0).forEach(function(r_){_h(_c,r_,_g[r_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_c,Object.getOwnPropertyDescriptors(_g)):gW(Object(_g)).forEach(function(r_){Object.defineProperty(_c,r_,Object.getOwnPropertyDescriptor(_g,r_))})}return _c}({},g),this.useCompress=j,this.tryDoubleDomain=_t;const{timeout:_o,timeoutFactor:ga}=g,_a=Math.max(300,Math.floor(3*_o/5)),_u=Math.max(1.2,Math.floor(8*ga)/10);eT.ONLINE&&(this.retryConfig.timeout=_a,this.retryConfig.timeoutFactor=_u),sR.on(dN.NETWORK_STATE_CHANGE,(_c,_l)=>{_c!==_l&&(this.resetReconnectCount("network state change: ".concat(_l," -> ").concat(_c)),_c===eT.ONLINE?(this.retryConfig.timeout=_a,this.retryConfig.timeoutFactor=_u):(this.retryConfig.timeout=_o,this.retryConfig.timeoutFactor=ga))})}getConnection(){return this.websocket||void 0}init(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;this.forceCloseTimeout=g;const j=(_t,_i)=>{this.urls=h;const _o=this.urls[this.currentURLIndex];this.state="connecting",this.createWebSocketConnection(_o).then(_t).catch(_i),this.once(x0.CLOSED,()=>_i(new f_(c_.WS_DISCONNECT))),this.once(x0.CONNECTED,()=>_t())};return this._initMutex.lock().then(_t=>new a0((_i,_o)=>{j(_i,_o)}).then(()=>{_t()}).catch(()=>{_t()}))}close(h,g){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const j=this.websocket;g?setTimeout(()=>j.close(),500):j.close(),this.websocket=void 0}this.state=h?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(h,g){if(!this.websocket)return void wE.warning("[".concat(this.name,"] can not reconnect, no websocket"));var j;h!==void 0&&(this.reconnectMode=h),wE.debug("[".concat(this.name,"] reconnect is triggered initiative")),typeof this.joinChannelServiceRecordIndex=="number"&&((j=this.store)===null||j===void 0||j.recordJoinChannelService({status:"error",errors:[new Error(g)]},this.joinChannelServiceRecordIndex));const _t=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),_t&&_t.bind(this.websocket)({code:9999,reason:g})}sendMessage(h){let g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new f_(c_.WS_ABORT,"websocket is not ready");try{g||(h=JSON.stringify(h)),this.websocket.send(h)}catch(j){throw new f_(c_.WS_ERR,"send websocket message error"+j.toString())}}setWsInflateData(h){this.wsDeflateLength=this.wsDeflateLength+h.originLength,this.wsInflateLength=this.wsInflateLength+h.compressedLength}getWsInflateData(){const h=this.wsInflateLength,g=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:h,wsDeflateLength:g}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(h,g){return this.connectionID+=1,this.connectionID,this.joinChannelServiceRecordIndex=void 0,new a0((j,_t)=>{var _i;const _o=_c=>{var _l;(_l=this.store)===null||_l===void 0||_l.signalChannelOpen(),wE.debug("[".concat(this.name,"] websocket opened:"),_c),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),j()},ga=async _c=>{if(wE.debug("[".concat(this.name,"] websocket close ").concat(this.websocket&&this.websocket.url,", code: ").concat(_c.code,", reason: ").concat(_c.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount<this.retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=_c.reason,this.state="reconnecting");const _l=PI(this,x0.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,_g=await this.reconnectWithAction(_l);if(this.state==="closed")return void wE.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!_g)return _t(new f_(c_.WS_DISCONNECT,"websocket reconnect failed: ".concat(_c.code))),void this.close(!0);j()}else _t(new f_(c_.WS_DISCONNECT,"websocket close: ".concat(_c.code))),this.close()},_a=_c=>{this.emit(x0.ON_MESSAGE,_c)};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),__("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(h=__("GATEWAY_WSS_ADDRESS")),wE.debug("[".concat(this.name,"] start connect, url: ").concat(h));const _u=(_i=this.store)===null||_i===void 0?void 0:_i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});this.chooseBestWebsocketConnection(h,!!g,_u).then(_c=>{var _l;this.websocket=_c,_o&&_o(_c.url),_c.onclose=ga,_c.onmessage=_a,(_l=this.store)===null||_l===void 0||_l.recordJoinChannelService({endTs:Date.now(),status:"success"},_u),this.joinChannelServiceRecordIndex=_u}).catch(_c=>{var _l;if((_l=this.store)===null||_l===void 0||_l.recordJoinChannelService({endTs:Date.now(),status:_c instanceof f_&&_c.code===c_.WS_ABORT?"aborted":"error",errors:[_c]},_u),this.state!=="closed"){if(_c instanceof f_&&_c.code===c_.WS_ERR){const _g=new f_(c_.WS_ERR,"init websocket failed! Error: ".concat(_c.toString()));return wE.error("[".concat(this.name,"]").concat(_g)),void _t(_g)}ga&&ga(_c)}else _t(new f_(c_.WS_DISCONNECT,"websocket is closed: ".concat(_c.toString())))})})}async reconnectWithAction(h){let g=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount||!this.urls||this.state==="closed")return!1;this.onlineReconnectListener||sR.networkState!==eT.OFFLINE||(this.onlineReconnectListener=sR.onlineWaiter&&sR.onlineWaiter.then(()=>{this.onlineReconnectListener=void 0}));let j=!0;if(this.reconnectInterrupter=()=>{j=!1},g){const _o=G3(this.reconnectCount,this.retryConfig);wE.debug("[".concat(this.name,"] wait ").concat(_o,"ms to reconnect websocket, mode: ").concat(h)),await a0.race([KR(_o),this.onlineReconnectListener||new a0(()=>{})])}if(this.state==="closed"||!j)return!1;this.reconnectCount+=1;const _t=async(_o,ga)=>{this.emit(x0.RECONNECT_CREATE_CONNECTION,ga),await this.createWebSocketConnection(_o)};try{if(h==="retry"){const _o=this.urls[this.currentURLIndex];this.emit(x0.RECONNECT_WAITTING_FINISH,h),await _t(_o,h)}else if(h==="tryNext"){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return await this.reconnectWithAction("recover",!1);wE.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex));const _o=this.urls[this.currentURLIndex];this.emit(x0.RECONNECT_WAITTING_FINISH,h),await _t(_o,h)}else if(h==="recover"){wE.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.emit(x0.RECONNECT_WAITTING_FINISH,h),this.urls=await YR(this,x0.REQUEST_NEW_URLS),this.currentURLIndex=0;const _o=this.urls[this.currentURLIndex];await _t(_o,h)}return!0}catch(_o){var _i;return wE.error("[".concat(this.name,"] reconnect failed"),_o.toString()),_o!=null&&(_i=_o.data)!==null&&_i!==void 0&&_i.desc&&Array.isArray(_o.data.desc)&&_o.data.desc.length&&_o.data.desc.includes("dynamic key expired")?(this.emit(x0.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(h,g)}}async chooseBestWebsocketConnection(h,g,j){return new a0((_t,_i)=>{let _o=!1;const ga=[];this.closeEstablishingWs=()=>{wE.debug("[choose-best-ws] close establishing websockets"),ga.forEach(d_=>{d_.onclose=null,d_.onopen=null,d_.onmessage=null,d_.close()}),_i(new f_(c_.WS_ABORT,"choose best websocket aborted"))};const _a=__("GATEWAY_DOMAINS");let _u;const _c=h.indexOf("?h="),_l=_a.find(d_=>_c!==-1?h.includes(d_,_c):h.includes(d_));wE.debug("[choose-best-ws] currentDomain: ",_l,", domains: ",_a);let _g=!this.tryDoubleDomain||g||!_l;if(!_g&&_l){var r_;const d_=Date.now();try{_a.forEach(p_=>{const C_=_c===-1?h.replace(_l,p_):h.substr(0,_c)+h.substr(_c).replace(_l,p_),O_=new WebSocket(C_);O_.binaryType="arraybuffer",ga.push(O_),wE.debug("[choose-best-ws] ws is connecting:",O_.url)})}catch{for(wE.debug("[choose-best-ws] ws create failed, fallback to single url"),ga.forEach(C_=>C_.close());ga.length;)ga.pop();_g=!0}(r_=this.store)===null||r_===void 0||r_.recordJoinChannelService({urls:ga.map(p_=>p_.url),service:"gateway"},j),ga.forEach(p_=>{p_.onopen=()=>{if(_o)return;const C_=Date.now()-d_;wE.debug("[choose-best-ws] ws open cost ".concat(C_,"ms")),ga.filter(O_=>O_!==p_).forEach(O_=>{wE.debug("[choose-best-ws]close backup websocket: ".concat(O_.url)),O_.close()}),_o=!0,_t(p_)},p_.onclose=C_=>{_u=C_,!_o&&(ga.find(O_=>!(O_.readyState===WebSocket.CLOSED||O_.readyState===WebSocket.CLOSING))||(wE.debug("[choose-best-ws] all websocket is closed"),_o=!0,_i(_u)))},p_.onmessage=C_=>{wE.debug("[choose-best-ws]".concat(p_.url," onmessage: ").concat(C_.data))}}),KR(this.forceCloseTimeout).then(()=>{ga.forEach(p_=>{p_.readyState!==WebSocket.OPEN&&p_.close()})})}if(_g){var l_;let d_;wE.debug("[choose-best-ws] use single url: ",h),(l_=this.store)===null||l_===void 0||l_.recordJoinChannelService({urls:[h],service:"gateway"},j);try{d_=new WebSocket(h),ga.push(d_),d_.binaryType="arraybuffer"}catch(p_){const C_=new f_(c_.WS_ERR,"init websocket failed! Error: ".concat(p_.toString()));return wE.error("[".concat(this.name,"]").concat(C_)),void _i(C_)}d_.onopen=()=>{_t(d_)},d_.onclose=p_=>{_i(p_)},d_.onmessage=p_=>{wE.debug("[choose-best-ws]".concat(d_.url," onmessage: ").concat(p_.data))},KR(this.forceCloseTimeout).then(()=>{d_&&d_.readyState!==WebSocket.OPEN&&d_.close()})}}).then(_t=>(this.closeEstablishingWs=void 0,_t)).catch(_t=>{throw this.closeEstablishingWs=void 0,_t})}}class EW{constructor(h){_h(this,"input",[]),_h(this,"size",void 0),this.size=h}add(h){this.input.push(h),this.input.length>this.size&&this.input.splice(0,1)}mean(){var h;return this.input.length===0?0:WI(h=this.input).call(h,(g,j)=>g+j)/this.input.length}}class vW extends US{get connectionState(){return this._connectionState}set connectionState(h){h!==this._connectionState&&(this._connectionState=h,h===pS.CONNECTED?this.emit(f0.WS_CONNECTED):h===pS.RECONNECTING?this.emit(f0.WS_RECONNECTING,this._websocketReconnectReason):h===pS.CLOSED&&this.emit(f0.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(h,g){super(),_h(this,"_disconnectedReason",void 0),_h(this,"_websocketReconnectReason",void 0),_h(this,"_connectionState",pS.CLOSED),_h(this,"reconnectToken",void 0),_h(this,"websocket",void 0),_h(this,"openConnectionTime",void 0),_h(this,"clientId",void 0),_h(this,"lastMsgTime",Date.now()),_h(this,"uploadCache",[]),_h(this,"uploadCacheInterval",void 0),_h(this,"rttRolling",new EW(5)),_h(this,"pingpongTimer",void 0),_h(this,"wsInflateDataTimer",void 0),_h(this,"pingpongTimeoutCount",0),_h(this,"joinResponse",void 0),_h(this,"multiIpOption",void 0),_h(this,"initError",void 0),_h(this,"spec",void 0),_h(this,"store",void 0),_h(this,"onWebsocketMessage",j=>{if(j.data instanceof ArrayBuffer)return void this.emit(f0.ON_BINARY_DATA,j.data);const _t=JSON.parse(j.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(_t,"_id")){const _i="res-@".concat(_t._id);this.emit(_i,_t._result,_t._message)}else if(Object.prototype.hasOwnProperty.call(_t,"_type")){if(this.emit(_t._type,_t._message),_t._type===F0.ON_NOTIFICATION&&this.handleNotification(_t._message),_t._type===F0.ON_USER_BANNED)switch(_t._message.error_code){case 14:this.close(aS.UID_BANNED);break;case 15:this.close(aS.IP_BANNED);break;case 16:this.close(aS.CHANNEL_BANNED)}if(_t._type===F0.ON_USER_LICENSE_BANNED)switch(_t._message.error_code){case S0.ERR_LICENSE_MISSING:this.close(aS.LICENSE_MISSING);break;case S0.ERR_LICENSE_EXPIRED:this.close(aS.LICENSE_EXPIRED);break;case S0.ERR_LICENSE_MINUTES_EXCEEDED:this.close(aS.LICENSE_MINUTES_EXCEEDED);break;case S0.ERR_LICENSE_PERIOD_INVALID:this.close(aS.LICENSE_PERIOD_INVALID);break;case S0.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(aS.LICENSE_MULTIPLE_SDK_SERVICE);break;case S0.ERR_LICENSE_ILLEGAL:this.close(aS.LICENSE_ILLEGAL);break;default:this.close()}}}),this.clientId=h.clientId,this.spec=h,this.store=g,this.websocket=new a1("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,g),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===pS.CONNECTED&&this.reconnect("retry",vT.OFFLINE)})}async request(h,g,j,_t){const _i=CS(6,""),_o={_id:_i,_type:h,_message:g},ga=this.websocket.connectionID,_a=()=>new a0((l_,d_)=>{if(this.connectionState===pS.CONNECTED)return l_();const p_=()=>{this.off(f0.WS_CLOSED,C_),l_()},C_=()=>{this.off(f0.WS_CONNECTED,p_),d_(new f_(c_.WS_ABORT))};this.once(f0.WS_CONNECTED,p_),this.once(f0.WS_CLOSED,C_),h!==C0.PUBLISH&&h!==C0.SUBSCRIBE&&h!==C0.UNSUBSCRIBE&&h!==C0.UNPUBLISH&&h!==C0.CONTROL&&h!==C0.RESTART_ICE||this.once(f0.DISCONNECT_P2P,()=>{d_(new f_(c_.DISCONNECT_P2P))}),h!==C0.PUBLISH&&h!==C0.RESTART_ICE||this.once(f0.ABORT_P2P_EXECUTION,()=>{d_(new f_(c_.DISCONNECT_P2P))})});if(this.connectionState!==pS.CONNECTING&&this.connectionState!==pS.RECONNECTING||h===C0.JOIN||h===C0.REJOIN||await _a(),this.websocket.sendMessage(_o,!0),_t)return;const _u=new a0((l_,d_)=>{let p_=!1;const C_=(q_,c0)=>{p_=!0,l_({isSuccess:q_==="success",message:c0||{}}),this.off(f0.WS_CLOSED,O_),this.off(f0.WS_RECONNECTING,O_),this.emit(f0.REQUEST_SUCCESS,h,g)};this.once("res-@".concat(_i),C_);const O_=()=>{d_(new f_(c_.WS_ABORT,"type: ".concat(h))),this.off(f0.WS_CLOSED,O_),this.off(f0.WS_RECONNECTING,O_),this.off("res-@".concat(_i),C_)};this.once(f0.WS_CLOSED,O_),this.once(f0.WS_RECONNECTING,O_),KR(__("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==ga||p_||(wE.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(h)),this.emit(f0.REQUEST_TIMEOUT,h,g))})});let _c=null;try{_c=await _u}catch(l_){if(this.connectionState===pS.CLOSED||h===C0.LEAVE)throw new f_(c_.WS_ABORT);return!this.spec.forceWaitGatewayResponse||j?l_.throw():h===C0.JOIN||h===C0.REJOIN?null:(await _a(),await this.request(h,g))}if(_c.isSuccess)return _c.message;const _l=Number(_c.message.error_code||_c.message.code),_g=yL(_l),r_=new f_(c_.UNEXPECTED_RESPONSE,"".concat(_g.desc,": ").concat(_c.message.error_str),{code:_l,data:_c.message});return _g.action==="success"?_c.message:(wE.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(h,", error_code: ").concat(_l,", message: ").concat(_g.desc,", action: ").concat(_g.action)),_l===S0.ERR_TOO_MANY_BROADCASTERS?((h===C0.JOIN||h===C0.REJOIN)&&(this.initError=r_,this.close()),r_.throw()):_g.action==="failed"?r_.throw():_g.action==="quit"?(this.initError=r_,this.close(),r_.throw()):(_l===S0.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=_c.message.option,wE.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",vT.MULTI_IP)):this.reconnect(_g.action,vT.SERVER_ERROR),h===C0.JOIN||h===C0.REJOIN?null:await this.request(h,g)))}waitMessage(h,g){return new a0(j=>{const _t=_i=>{(!g||g(_i))&&(this.off(h,_t),j(_i))};this.on(h,_t)})}upload(h,g){const j={_type:h,_message:g};try{this.websocket.sendMessage(j)}catch{const _i=__("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(j),this.uploadCache.length>_i&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==pS.CONNECTED)return;const _o=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(_o._type,_o._message)},__("UPLOAD_CACHE_INTERVAL")||2e3))}}send(h,g){const j={_type:h,_message:g};this.websocket.sendMessage(j)}init(h,g){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new a0((j,_t)=>{this.once(f0.WS_CONNECTED,()=>j(this.joinResponse)),this.once(f0.WS_CLOSED,()=>_t(this.initError||new f_(c_.WS_ABORT))),this.connectionState=pS.CONNECTING,this.websocket.init(h).catch(_t),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval(()=>{this.handleWsInflateData()},2e4),setTimeout(()=>{g&&this.openConnectionTime===void 0&&(wE.debug("[".concat(this.clientId,"] init websocket timeout while join with fallback to proxy")),_t(new f_(c_.INIT_WEBSOCKET_TIMEOUT)))},__("JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION"))})}close(h){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=h||aS.LEAVE,this.connectionState=pS.CLOSED,wE.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),h===aS.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new a1("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(f0.ABORT_P2P_EXECUTION);const h=await YR(this,f0.REQUEST_JOIN_INFO),g=await this.request(C0.JOIN,h);if(!g)return this.emit(f0.REPORT_JOIN_GATEWAY,c_.TIMEOUT,this.url||""),!1;this.joinResponse=g,this.emit(f0.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=pS.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new f_(c_.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const h=s1(this,f0.REQUEST_REJOIN_INFO);h.token=this.reconnectToken;const g=await this.request(C0.REJOIN,h);return!!g&&(this.connectionState=pS.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),g.peers&&g.peers.forEach(j=>{this.emit(F0.ON_USER_ONLINE,{uid:j.uid}),j.audio&&this.emit(F0.ON_ADD_AUDIO_STREAM,{uid:j.uid,uint_id:j.uint_id,audio:!0,ssrcId:j.audio_ssrc}),j.video&&this.emit(F0.ON_ADD_VIDEO_STREAM,{uid:j.uid,uint_id:j.uint_id,video:!0,ssrcId:j.video_ssrc}),j.audio_mute?this.emit(F0.MUTE_AUDIO,{uid:j.uid}):this.emit(F0.UNMUTE_AUDIO,{uid:j.uid}),j.video_mute?this.emit(F0.MUTE_VIDEO,{uid:j.uid}):this.emit(F0.UNMUTE_VIDEO,{uid:j.uid}),j.audio_enable_local?this.emit(F0.ENABLE_LOCAL_AUDIO,{uid:j.uid}):this.emit(F0.DISABLE_LOCAL_AUDIO,{uid:j.uid}),j.video_enable_local?this.emit(F0.ENABLE_LOCAL_VIDEO,{uid:j.uid}):this.emit(F0.DISABLE_LOCAL_VIDEO,{uid:j.uid}),j.audio||j.video||this.emit(F0.ON_REMOVE_STREAM,{uid:j.uid,uint_id:j.uint_id})}),!0)}reconnect(h,g){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(h,g)}handleNotification(h){wE.debug("[".concat(this.clientId,"] receive notification: "),h);const g=yL(h.code);if(g.action!=="success"){if(g.action!=="failed")return g.action==="quit"?(g.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(aS.UID_BANNED),void this.close()):void this.reconnect(g.action,vT.SERVER_ERROR);wE.error("[".concat(this.clientId,"] ignore error: "),g.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const h=__("PING_PONG_TIME_OUT"),g=Date.now();this.pingpongTimeoutCount>=h&&(wE.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(g-this.lastMsgTime,"ms")),g-this.lastMsgTime>__("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",vT.TIMEOUT):this.request(C0.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const j=Date.now()-g;this.rttRolling.add(j),__("REPORT_STATS")&&this.send(C0.PING_BACK,{pingpongElapse:j})}).catch(j=>{})}handleWsInflateData(){const{wsInflateLength:h,wsDeflateLength:g}=this.websocket.getWsInflateData();h!==0&&g!==0&&this.upload(jT.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:g,ws_inflate_length:h})}handleWebsocketEvents(){this.websocket.on(x0.RECONNECT_WAITTING_FINISH,h=>{this.emit(f0.WS_RECONNECT_WAITTING_FINISH,h)}),this.websocket.on(x0.RECONNECT_CREATE_CONNECTION,h=>{this.emit(f0.WS_RECONNECT_CREATE_CONNECTION,h)}),this.websocket.on(x0.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(x0.CLOSED,()=>{this.connectionState=pS.CLOSED}),this.websocket.on(x0.FAILED,()=>{this._disconnectedReason=aS.NETWORK_ERROR,this.connectionState=pS.CLOSED}),this.websocket.on(x0.RECONNECTING,h=>{this._websocketReconnectReason=h,this.joinResponse=void 0,this.connectionState===pS.CONNECTED?this.connectionState=pS.RECONNECTING:this.connectionState=pS.CONNECTING}),this.websocket.on(x0.WILL_RECONNECT,(h,g)=>{if(s1(this,f0.IS_P2P_DISCONNECTED)&&h==="retry")return wE.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(f0.NEED_RENEW_SESSION),this.emit(f0.DISCONNECT_P2P),g("tryNext");h!=="retry"&&(wE.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(h)),this.reconnectToken=void 0,this.emit(f0.NEED_RENEW_SESSION),this.emit(f0.DISCONNECT_P2P)),g(h)}),this.websocket.on(x0.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(h=>{wE.warning("[".concat(this.clientId,"] rejoin failed ").concat(h)),this.reconnect("tryNext",vT.SERVER_ERROR)}):this.join().catch(h=>{if(this.emit(f0.REPORT_JOIN_GATEWAY,h.message||h.code,this.url||""),h instanceof f_&&h.code===c_.UNEXPECTED_RESPONSE&&h.data.code===S0.ERR_NO_AUTHORIZED)return wE.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",vT.SERVER_ERROR);wE.error("[".concat(this.clientId,"] join gateway request failed"),h.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",vT.SERVER_ERROR):(this.initError=h,this.close())})}),this.websocket.on(x0.REQUEST_NEW_URLS,(h,g)=>{YR(this,f0.REQUEST_RECOVER,this.multiIpOption).then(h).catch(g)}),this.websocket.on(x0.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(F0.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})}}function _W(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}class nZ extends US{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(h){["tryNext","recover"].includes(h)&&this.resetReconnectCount(h),this._reconnectMode=h}get state(){return this._state}set state(h){h!==this._state&&(this._state=h,this._state==="reconnecting"?this.emit($S.RECONNECTING,this.reconnectReason):this._state==="connected"?this.emit($S.CONNECTED):this._state==="closed"?this.emit($S.CLOSED):this._state==="failed"&&this.emit($S.FAILED))}constructor(h,g,j,_t){super(),_h(this,"connectionID",0),_h(this,"currentURLIndex",0),_h(this,"reconnectReason",void 0),_h(this,"_reconnectMode","tryNext"),_h(this,"_initMutex",void 0),_h(this,"_name",void 0),_h(this,"_state","closed"),_h(this,"_reconnectInterrupter",void 0),_h(this,"_url",void 0),_h(this,"_retryConfig",void 0),_h(this,"_reconnectCount",0),_h(this,"_forceCloseTimeout",5e3),_h(this,"_onlineReconnectListener",void 0),_h(this,"_closeEstablishingTransmitter",()=>{}),_h(this,"_store",void 0),_h(this,"_joinChannelServiceRecordIndex",void 0),_h(this,"_transmitter",void 0),_h(this,"_useCompress",void 0),_h(this,"_inflateLength",0),_h(this,"_deflateLength",0),this._store=_t,this._name=h,this._retryConfig=function(_i){for(var _o=1;_o<arguments.length;_o++){var ga=arguments[_o]!=null?arguments[_o]:{};_o%2?_W(Object(ga),!0).forEach(function(_a){_h(_i,_a,ga[_a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_i,Object.getOwnPropertyDescriptors(ga)):_W(Object(ga)).forEach(function(_a){Object.defineProperty(_i,_a,Object.getOwnPropertyDescriptor(ga,_a))})}return _i}({},g),this._useCompress=j}resetReconnectCount(h){wE.debug("".concat(this._name," reset reconnect count, reason: ").concat(h)),this._reconnectCount=0}close(h,g){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const j=this._transmitter;g?setTimeout(()=>j.close(),500):j.close(),this._transmitter=void 0}this.state=h?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(h,g){if(!this._transmitter)return void wE.warning("[".concat(this._name,"] can not reconnect, no websocket"));var j;h!==void 0&&(this.reconnectMode=h),wE.debug("[".concat(this._name,"] reconnect is triggered initiative")),typeof this._joinChannelServiceRecordIndex=="number"&&((j=this._store)===null||j===void 0||j.recordJoinChannelService({status:"error",errors:[new Error(g)]},this._joinChannelServiceRecordIndex));const _t=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),_t&&_t.bind(this._transmitter)({code:9999,reason:g})}getInflateData(){const h=this._inflateLength,g=this._deflateLength;return this.clearInflateData(),{inflateLength:h,deflateLength:g}}setInflateData(h){this._deflateLength=this._deflateLength+h.originLength,this._inflateLength=this._inflateLength+h.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}function yW(d,h,g){if("getBigUint64"in DataView.prototype)return d.getBigUint64(h,g);const j=d.getUint32(h,g),_t=d.getUint32(h+4,g),_i=+!!g,_o=+!g;return BigInt(j*_o+_t*_i)<<BigInt(32)|BigInt(j*_i+_t*_o)}function bW(d,h,g,j){if("setBigUint64"in DataView.prototype)return d.setBigUint64(h,g,j);const _t=Number(g>>BigInt(32)),_i=Number(g&BigInt(4294967295));j?(d.setUint32(h+4,_t,j),d.setUint32(h,_i,j)):(d.setUint32(h,_t,j),d.setUint32(h+4,_i,j))}let fI;(function(d){d[d.Default=0]="Default",d[d.Ack=1]="Ack"})(fI||(fI={}));class rZ{constructor(h,g,j){_h(this,"version",1),_h(this,"initialRTO",void 0),_h(this,"maxBatchAckCount",void 0),_h(this,"maxRTO",void 0),_h(this,"initialRTT",void 0),_h(this,"ID",void 0),_h(this,"rtt",void 0),_h(this,"packetNumber",1),_h(this,"rtoRatioMap",new Map),_h(this,"timeoutMap",new Map),_h(this,"unorderedPacketQueue",[]),_h(this,"batchAckPacketQueue",[]),_h(this,"lastOrderedPacketNumber",0),_h(this,"batchAckTimer",void 0),_h(this,"sendImpl",void 0),_h(this,"receiveImpl",void 0),this.sendImpl=h,this.receiveImpl=g,this.ID=CS(7,"transmitter-"),this.initialRTO=(j==null?void 0:j.initialRTO)!==void 0?j.initialRTO:__("TRANSMITTER_INITIAL_RTO"),this.initialRTT=(j==null?void 0:j.initialRTT)!==void 0?j.initialRTT:__("TRANSMITTER_INITIAL_RTT"),this.rtt=(j==null?void 0:j.initialRTT)!==void 0?j.initialRTT:__("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=(j==null?void 0:j.maxBatchAckCount)!==void 0?j.maxBatchAckCount:__("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=(j==null?void 0:j.maxRTO)!==void 0?j.maxRTO:__("TRANSMITTER_MAX_RTO")}packetize(h,g){return{type:fI.Default,version:this.version,packetNumber:g,payload:h}}serialize(h){switch(h.type){case fI.Default:{let g;typeof h.payload=="string"?g=new TextEncoder().encode(h.payload):g=h.payload;const j=new ArrayBuffer(g.length+15),_t=new DataView(j);return _t.setUint16(0,h.version),_t.setUint8(2,h.type),_t.setUint32(3,h.packetNumber),bW(_t,7,BigInt(h.sendTs)),new Uint8Array(_t.buffer).set(g,15),j}case fI.Ack:{const g=new ArrayBuffer(16),j=new DataView(g);return j.setUint16(0,h.version),j.setUint8(2,h.type),j.setUint32(3,h.maxAckPacketNumber),j.setUint8(7,h.shift),bW(j,8,BigInt(h.ackSendTs)),g}}}deserialize(h){const g=new DataView(h),j=g.getUint16(0),_t=g.getUint8(2);switch(_t){case fI.Default:{const _i=g.getUint32(3),_o=yW(g,7),ga=h.slice(15),_a=new TextDecoder().decode(ga);return{version:j,type:_t,packetNumber:_i,sendTs:Number(_o),payload:_a}}case fI.Ack:{const _i=g.getUint32(3),_o=g.getUint8(7),ga=yW(g,8);return{version:j,type:_t,maxAckPacketNumber:_i,shift:_o,ackSendTs:Number(ga)}}default:throw wE.error("[".concat(this.ID,"] Unrecognized packet type ").concat(_t)),new Error("Unrecognized packet type ".concat(_t))}}sendMessage(h){const g=this.packetize(h,this.packetNumber);this.packetNumber=this.packetNumber===4294967295?1:this.packetNumber+1;const j=this.calculateRTO(g),_t=window.setTimeout(()=>{this.resendMessage(g)},j);this.timeoutMap.set(g.packetNumber,_t),this.sendPacket(g)}onData(h){const g=this.deserialize(h);g.type===fI.Default?this.ack(g):g.type===fI.Ack&&(this.updateRTT(g,Math.round(performance.now())),this.clearRTO(g))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach(h=>{let[g,j]=h;window.clearTimeout(j)}),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,this.batchAckTimer!==void 0&&window.clearTimeout(this.batchAckTimer)}resendMessage(h){const g=this.calculateRTO(h),j=window.setTimeout(()=>{this.resendMessage(h)},g);this.timeoutMap.set(h.packetNumber,j),this.sendPacket(h)}calculateRTO(h){const g=this.rtoRatioMap.get(h.packetNumber);if(g===void 0)return this.rtoRatioMap.set(h.packetNumber,1),this.initialRTO;{const j=9*this.rtt/8*g;return this.rtoRatioMap.set(h.packetNumber,g+1),j>this.maxRTO?this.maxRTO:j}}updateRTT(h,g){const j=h.ackSendTs;this.rtt=this.rtt*(7/8)+(g-j-this.rtt)/8}ack(h){if(h.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(h):(this.batchAckPacketQueue.push(h),this.batchAckTimer=window.setTimeout(()=>{this.batchAck()},this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(h.payload);;){const g=this.unorderedPacketQueue[0];if(!g){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(g.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else if(h.packetNumber<=this.lastOrderedPacketNumber){const g={ackSendTs:h.sendTs,maxAckPacketNumber:h.packetNumber,shift:0,type:fI.Ack,version:this.version};this.sendPacket(g)}else if(h.packetNumber>this.lastOrderedPacketNumber){this.unorderedPacketQueue[h.packetNumber-this.lastOrderedPacketNumber-2]=h;const g={ackSendTs:h.sendTs,maxAckPacketNumber:h.packetNumber,shift:0,type:fI.Ack,version:this.version};this.sendPacket(g)}}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0;const h={ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:fI.Ack,version:this.version};this.sendPacket(h),this.batchAckPacketQueue=[]}sendPacket(h){h.type===fI.Default&&(h.sendTs=Math.round(performance.now()));const g=this.serialize(h);this.sendImpl(g)}clearRTO(h){for(let g=h.maxAckPacketNumber-h.shift;g<=h.maxAckPacketNumber;g++){const j=this.timeoutMap.get(g);j!==void 0&&window.clearTimeout(j),this.timeoutMap.delete(g),this.rtoRatioMap.delete(g)}}}class SW extends nZ{constructor(h,g){super(h,g,arguments.length>2&&arguments[2]!==void 0&&arguments[2],arguments.length>3?arguments[3]:void 0),_h(this,"_initMutex",void 0),_h(this,"_reconnectInterrupter",void 0),_h(this,"_url",void 0),_h(this,"_transmitter",void 0),_h(this,"_addresses",void 0),_h(this,"_reliableTransmission",void 0),this._initMutex=new lT("datachannel");const{timeout:j,timeoutFactor:_t}=g,_i=Math.max(300,Math.floor(3*j/5)),_o=Math.max(1.2,Math.floor(8*_t)/10);eT.ONLINE&&(this._retryConfig.timeout=_i,this._retryConfig.timeoutFactor=_o),sR.on(dN.NETWORK_STATE_CHANGE,(ga,_a)=>{ga!==_a&&(this.resetReconnectCount("network state change: ".concat(_a," -> ").concat(ga)),ga===eT.ONLINE?(this._retryConfig.timeout=_i,this._retryConfig.timeoutFactor=_o):(this._retryConfig.timeout=j,this._retryConfig.timeoutFactor=_t))})}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}async init(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;this._forceCloseTimeout=g;const j=(_t,_i)=>{this._addresses=h,this.currentURLIndex=this._addresses.findIndex(ga=>ga.fingerprint||__("FINGERPRINT"));const _o=this._addresses[this.currentURLIndex];this.state="connecting",this.createTransmitterConnection(_o).then(_t).catch(_i),this.once($S.CLOSED,()=>_i(new f_(c_.WS_DISCONNECT))),this.once($S.CONNECTED,()=>_t())};return this._initMutex.lock().then(_t=>new a0((_i,_o)=>{j(_i,_o)}).then(()=>{_t()}).catch(()=>{_t()}))}sendMessage(h){let g=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new f_(c_.WS_ABORT,"datachannel is not ready");try{g||(h=JSON.stringify(h)),this._reliableTransmission.sendMessage(h)}catch(j){throw new f_(c_.WS_ERR,"send datachannel signal message error"+j.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(h){const g=JSON.stringify(h);return{compressed:g,compressedLength:g.length,origin:h}}sendMessageWithUint8Array(h){return{compressed:h,compressedLength:h.byteLength,origin:h}}createTransmitterConnection(h){return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(h.ip,":").concat(h.port),new a0((g,j)=>{var _t;const _i=()=>{wE.debug("[".concat(this._name,"] datachannel opened:"),this._url),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),g()},_o=async _c=>{var _l;if((_l=this._closeEstablishingTransmitter)===null||_l===void 0||_l.call(this),wE.debug("[".concat(this._name,"] datachannel close ").concat(this._url,", code: ").concat(_c.code,", reason: ").concat(_c.reason,", current mode: ").concat(this.reconnectMode)),this._reconnectCount<this._retryConfig.maxRetryCount){this.state==="connected"&&(this.reconnectReason=_c.reason,this.state="reconnecting");const _g=PI(this,$S.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,r_=await this.reconnectWithAction(_g);if(this.state==="closed")return void wE.debug("[".concat(this.connectionID,"] dc is closed, no need to reconnect"));if(!r_)return j(new f_(c_.WS_DISCONNECT,"datachannel reconnect failed: ".concat(_c.code))),void this.close(!0);g()}else j(new f_(c_.WS_DISCONNECT,"datachannel close: ".concat(_c.code))),this.close()},ga=_c=>{var _l;(_l=this._reliableTransmission)===null||_l===void 0||_l.onData(_c.data)};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),wE.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(h)));const _a=(_t=this._store)===null||_t===void 0?void 0:_t.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),_u=Date.now();YR(this,$S.TO_CONNECT_DATACHANNEL,h).then(_c=>{var _l,_g;if(!_c)throw new Error("transmissonInfo not exist yet");const{transmitter:r_,close:l_}=_c;this._transmitter=r_,(_l=this._store)===null||_l===void 0||_l.signalChannelOpen();const d_=Date.now()-_u;wE.debug("[choose dc] dc open cost ".concat(d_,"ms")),this._reliableTransmission=new rZ(p_=>{var C_;this._transmitter&&this._transmitter.readyState==="open"&&((C_=this._transmitter)===null||C_===void 0||C_.send(p_))},p_=>{typeof p_=="string"&&this.emit($S.ON_MESSAGE,p_)}),this._closeEstablishingTransmitter=()=>{var p_;(p_=this._reliableTransmission)===null||p_===void 0||p_.close(),this._reliableTransmission=void 0,l_()},_i&&_i(),r_.onclose=_o,r_.onmessage=ga,(_g=this._store)===null||_g===void 0||_g.recordJoinChannelService({endTs:Date.now(),status:"success"},_a),this._joinChannelServiceRecordIndex=_a}).catch(_c=>{var _l;if((_l=this._store)===null||_l===void 0||_l.recordJoinChannelService({endTs:Date.now(),status:_c instanceof f_&&_c.code===c_.WS_ABORT?"aborted":"error",errors:[_c]},_a),this.state!=="closed"){if(_c instanceof f_&&_c.code===c_.WS_ERR){const _g=new f_(c_.WS_ERR,"init datachannel failed! Error: ".concat(_c.toString()));return wE.error("[".concat(this._name,"]").concat(_g)),void j(_g)}_o&&_o(_c)}else j(new f_(c_.WS_DISCONNECT,"datachannel is closed: ".concat(_c.toString())))})})}async reconnectWithAction(h){let g=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this._reconnectCount>=this._retryConfig.maxRetryCount||!this._addresses||this.state==="closed")return!1;this._onlineReconnectListener||sR.networkState!==eT.OFFLINE||(this._onlineReconnectListener=sR.onlineWaiter&&sR.onlineWaiter.then(()=>{this._onlineReconnectListener=void 0}));let j=!0;if(this._reconnectInterrupter=()=>{j=!1},g){const _o=G3(this._reconnectCount,this._retryConfig);wE.debug("[".concat(this._name,"] wait ").concat(_o,"ms to reconnect datachannel, mode: ").concat(h)),await a0.race([KR(_o),this._onlineReconnectListener||new a0(()=>{})])}if(this.state==="closed"||!j)return!1;this._reconnectCount+=1;const _t=async(_o,ga)=>{this.emit($S.RECONNECT_CREATE_CONNECTION,ga),await this.createTransmitterConnection(_o)};try{if(h==="retry"){const _o=this._addresses[this.currentURLIndex];this.emit($S.RECONNECT_WAITTING_FINISH,h),await _t(_o,h)}else if(h==="tryNext"){this.currentURLIndex+=1;for(let ga=this.currentURLIndex;ga<this._addresses.length;ga++){if(this._addresses[ga].fingerprint||__("FINGERPRINT")){this.currentURLIndex=ga;break}this.currentURLIndex+=1}if(this.currentURLIndex>=this._addresses.length)return wE.debug("[".concat(this._name,"] the available addresses are exhausted, change to recover")),await this.reconnectWithAction("recover",!1);wE.debug("[".concat(this._name,"] datachannel url length: ").concat(this._addresses.length," current index: ").concat(this.currentURLIndex));const _o=this._addresses[this.currentURLIndex];this.emit($S.RECONNECT_WAITTING_FINISH,h),await _t(_o,h)}else h==="recover"&&(wE.debug("[".concat(this._name,"] start to failback to websocket")),this.resetReconnectCount("recover mode"),this.emit($S.RECONNECT_WAITTING_FINISH,h),this.emit($S.FAILBACK));return!0}catch(_o){var _i;return wE.error("[".concat(this._name,"] reconnect failed"),_o.toString()),_o!=null&&(_i=_o.data)!==null&&_i!==void 0&&_i.desc&&Array.isArray(_o.data.desc)&&_o.data.desc.length&&_o.data.desc.includes("dynamic key expired")?(this.emit($S.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(h,g)}}}class GO extends US{get connectionState(){return this._connectionState}set connectionState(h){h!==this._connectionState&&(this._connectionState=h,h===pS.CONNECTED?this.emit(f0.WS_CONNECTED):h===pS.RECONNECTING?this.emit(f0.WS_RECONNECTING,this._websocketReconnectReason):h===pS.CLOSED&&this.emit(f0.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(h,g){super(),_h(this,"_disconnectedReason",void 0),_h(this,"_websocketReconnectReason",void 0),_h(this,"_connectionState",pS.CLOSED),_h(this,"reconnectToken",void 0),_h(this,"websocket",void 0),_h(this,"openConnectionTime",void 0),_h(this,"clientId",void 0),_h(this,"lastMsgTime",Date.now()),_h(this,"uploadCache",[]),_h(this,"uploadCacheInterval",void 0),_h(this,"rttRolling",new EW(5)),_h(this,"pingpongTimer",void 0),_h(this,"inflateDataTimer",void 0),_h(this,"pingpongTimeoutCount",0),_h(this,"joinResponse",void 0),_h(this,"multiIpOption",void 0),_h(this,"initError",void 0),_h(this,"spec",void 0),_h(this,"store",void 0),_h(this,"onWebsocketMessage",j=>{if(j instanceof ArrayBuffer)return void this.emit(f0.ON_BINARY_DATA,j);const _t=JSON.parse(j);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(_t,"_id")){const _i="res-@".concat(_t._id);this.emit(_i,_t._result,_t._message)}else if(Object.prototype.hasOwnProperty.call(_t,"_type")&&(this.emit(_t._type,_t._message),_t._type===F0.ON_NOTIFICATION&&this.handleNotification(_t._message),_t._type===F0.ON_USER_BANNED))switch(_t._message.error_code){case 14:this.close(aS.UID_BANNED);break;case 15:this.close(aS.IP_BANNED);break;case 16:this.close(aS.CHANNEL_BANNED)}}),this.clientId=h.clientId,this.spec=h,this.store=g,this.websocket=new SW("gateway-".concat(this.clientId),this.spec.retryConfig,!0,g),this.handleWebsocketEvents(),window.addEventListener("offline",()=>{this.connectionState===pS.CONNECTED&&this.reconnect("retry",fO.OFFLINE)})}async request(h,g,j,_t){const _i=CS(6,""),_o={_id:_i,_type:h,_message:g},ga=this.websocket.connectionID,_a=()=>new a0((l_,d_)=>{if(this.connectionState===pS.CONNECTED)return l_();const p_=()=>{this.off(f0.WS_CLOSED,C_),l_()},C_=()=>{this.off(f0.WS_CONNECTED,p_),d_(new f_(c_.WS_ABORT))};this.once(f0.WS_CONNECTED,p_),this.once(f0.WS_CLOSED,C_),h!==C0.PUBLISH&&h!==C0.SUBSCRIBE&&h!==C0.UNSUBSCRIBE&&h!==C0.UNPUBLISH&&h!==C0.CONTROL&&h!==C0.RESTART_ICE||this.once(f0.DISCONNECT_P2P,()=>{d_(new f_(c_.DISCONNECT_P2P))}),h!==C0.PUBLISH&&h!==C0.RESTART_ICE||this.once(f0.ABORT_P2P_EXECUTION,()=>{d_(new f_(c_.DISCONNECT_P2P))})});if(this.connectionState!==pS.CONNECTING&&this.connectionState!==pS.RECONNECTING||h===C0.JOIN||h===C0.REJOIN||await _a(),h===C0.LEAVE&&(this.websocket.unbindDcCloseEventListener(),_t=!0),this.websocket.sendMessage(_o,!0,!1),_t)return;const _u=new a0((l_,d_)=>{let p_=!1;const C_=(q_,c0)=>{p_=!0,l_({isSuccess:q_==="success",message:c0||{}}),this.off(f0.WS_CLOSED,O_),this.off(f0.WS_RECONNECTING,O_),this.emit(f0.REQUEST_SUCCESS,h,g)};this.once("res-@".concat(_i),C_);const O_=()=>{d_(new f_(c_.WS_ABORT,"type: ".concat(h))),this.off(f0.WS_CLOSED,O_),this.off(f0.WS_RECONNECTING,O_),this.off("res-@".concat(_i),C_)};this.once(f0.WS_CLOSED,O_),this.once(f0.WS_RECONNECTING,O_),KR(__("SIGNAL_REQUEST_TIMEOUT")).then(()=>{this.websocket.connectionID!==ga||p_||(wE.warning("dc request timeout, type: ".concat(h)),this.emit(f0.REQUEST_TIMEOUT,h,g))})});let _c=null;try{_c=await _u}catch(l_){if(this.connectionState===pS.CLOSED||h===C0.LEAVE)throw new f_(c_.WS_ABORT);return!this.spec.forceWaitGatewayResponse||j?l_.throw():h===C0.JOIN||h===C0.REJOIN?null:(await _a(),await this.request(h,g))}if(_c.isSuccess)return _c.message;const _l=Number(_c.message.error_code||_c.message.code),_g=yL(_l),r_=new f_(c_.UNEXPECTED_RESPONSE,"".concat(_g.desc,": ").concat(_c.message.error_str),{code:_l,data:_c.message});return _g.action==="success"?_c.message:(wE.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(h,", error_code: ").concat(_l,", message: ").concat(_g.desc,", action: ").concat(_g.action)),_l===S0.ERR_TOO_MANY_BROADCASTERS?((h===C0.JOIN||h===C0.REJOIN)&&(this.initError=r_,this.close()),r_.throw()):_g.action==="failed"?r_.throw():_g.action==="quit"?(this.initError=r_,this.close(),r_.throw()):(_l===S0.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=_c.message.option,wE.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",fO.MULTI_IP)):this.reconnect(_g.action,fO.SERVER_ERROR),h===C0.JOIN||h===C0.REJOIN?null:await this.request(h,g)))}waitMessage(h,g){return new a0(j=>{const _t=_i=>{(!g||g(_i))&&(this.off(h,_t),j(_i))};this.on(h,_t)})}upload(h,g){const j={_type:h,_message:g};try{this.websocket.sendMessage(j)}catch{const _i=__("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(j),this.uploadCache.length>_i&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval(()=>{if(this.connectionState!==pS.CONNECTED)return;const _o=this.uploadCache.splice(0,1)[0];this.uploadCache.length===0&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(_o._type,_o._message)},__("UPLOAD_CACHE_INTERVAL")||2e3))}}send(h,g){const j={_type:h,_message:g};this.websocket.sendMessage(j)}init(h,g){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new a0((j,_t)=>{this.once(f0.WS_CONNECTED,()=>j(this.joinResponse)),this.once(f0.WS_CLOSED,()=>_t(this.initError||new f_(c_.WS_ABORT))),this.connectionState=pS.CONNECTING,this.websocket.init(h).catch(_t),this.websocket.once($S.FAILBACK,()=>{this.openConnectionTime===void 0&&_t(new f_(c_.INIT_DATACHANNEL_TIMEOUT))}),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval(()=>{this.handleInflateData()},2e4),setTimeout(()=>{g&&this.openConnectionTime===void 0&&(wE.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),_t(new f_(c_.INIT_DATACHANNEL_TIMEOUT)))},__("DC_JOIN_WITH_FAILBACK"))})}close(h){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=h||aS.LEAVE,this.connectionState=pS.CLOSED,wE.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),h===aS.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new SW("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(f0.ABORT_P2P_EXECUTION);const h=await YR(this,f0.DATACHANNEL_CONNECTING),g=await this.request(C0.JOIN,h);if(!g)return this.emit(f0.REPORT_JOIN_GATEWAY,c_.TIMEOUT,this.url||""),!1;this.joinResponse=g,this.emit(f0.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=pS.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new f_(c_.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const h=s1(this,f0.REQUEST_REJOIN_INFO);h.token=this.reconnectToken;const g=await this.request(C0.REJOIN,h);return!!g&&(this.connectionState=pS.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),g.peers&&g.peers.forEach(j=>{this.emit(F0.ON_USER_ONLINE,{uid:j.uid}),j.audio&&this.emit(F0.ON_ADD_AUDIO_STREAM,{uid:j.uid,uint_id:j.uint_id,audio:!0,ssrcId:j.audio_ssrc}),j.video&&this.emit(F0.ON_ADD_VIDEO_STREAM,{uid:j.uid,uint_id:j.uint_id,video:!0,ssrcId:j.video_ssrc}),j.audio_mute?this.emit(F0.MUTE_AUDIO,{uid:j.uid}):this.emit(F0.UNMUTE_AUDIO,{uid:j.uid}),j.video_mute?this.emit(F0.MUTE_VIDEO,{uid:j.uid}):this.emit(F0.UNMUTE_VIDEO,{uid:j.uid}),j.audio_enable_local?this.emit(F0.ENABLE_LOCAL_AUDIO,{uid:j.uid}):this.emit(F0.DISABLE_LOCAL_AUDIO,{uid:j.uid}),j.video_enable_local?this.emit(F0.ENABLE_LOCAL_VIDEO,{uid:j.uid}):this.emit(F0.DISABLE_LOCAL_VIDEO,{uid:j.uid}),j.audio||j.video||this.emit(F0.ON_REMOVE_STREAM,{uid:j.uid,uint_id:j.uint_id})}),!0)}reconnect(h,g){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(h,g)}handleNotification(h){wE.debug("[".concat(this.clientId,"] receive notification: "),h);const g=yL(h.code);if(g.action!=="success"){if(g.action!=="failed")return g.action==="quit"?(g.desc==="ERR_REPEAT_JOIN_CHANNEL"&&this.close(aS.UID_BANNED),void this.close()):void this.reconnect(g.action,fO.SERVER_ERROR);wE.error("[".concat(this.clientId,"] ignore error: "),g.desc)}}handlePingPong(){if(!this.websocket||this.websocket.state!=="connected")return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const h=__("PING_PONG_TIME_OUT"),g=Date.now();this.pingpongTimeoutCount>=h&&(wE.warning("PINGPONG Timeout. Last Socket Message: ".concat(g-this.lastMsgTime,"ms")),g-this.lastMsgTime>__("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",fO.TIMEOUT):this.request(C0.PING,void 0,!0).then(()=>{this.pingpongTimeoutCount=0;const j=Date.now()-g;this.rttRolling.add(j),__("REPORT_STATS")&&this.send(C0.PING_BACK,{pingpongElapse:j})}).catch(j=>{})}handleInflateData(){const{inflateLength:h,deflateLength:g}=this.websocket.getInflateData();h!==0&&g!==0&&this.upload(jT.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:g,ws_inflate_length:h})}handleWebsocketEvents(){this.websocket.on($S.RECONNECT_WAITTING_FINISH,h=>{this.emit(f0.WS_RECONNECT_WAITTING_FINISH,h)}),this.websocket.on($S.RECONNECT_CREATE_CONNECTION,h=>{this.emit(f0.WS_RECONNECT_CREATE_CONNECTION,h)}),this.websocket.on($S.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on($S.CLOSED,()=>{this.connectionState=pS.CLOSED}),this.websocket.on($S.FAILED,()=>{this._disconnectedReason=aS.NETWORK_ERROR,this.connectionState=pS.CLOSED}),this.websocket.on($S.RECONNECTING,h=>{this._websocketReconnectReason=h,this.joinResponse=void 0,this.connectionState===pS.CONNECTED?this.connectionState=pS.RECONNECTING:this.connectionState=pS.CONNECTING}),this.websocket.on($S.WILL_RECONNECT,(h,g)=>{if(s1(this,f0.IS_P2P_DISCONNECTED)&&h==="retry")return wE.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(f0.NEED_RENEW_SESSION),this.emit(f0.DISCONNECT_P2P),g("tryNext");h!=="retry"&&(wE.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(h)),this.reconnectToken=void 0,this.emit(f0.NEED_RENEW_SESSION),this.emit(f0.DISCONNECT_P2P)),g(h)}),this.websocket.on($S.CONNECTED,()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch(h=>{wE.warning("[".concat(this.clientId,"] rejoin failed ").concat(h)),this.reconnect("tryNext",fO.SERVER_ERROR)}):this.join().catch(h=>{if(this.emit(f0.REPORT_JOIN_GATEWAY,h.message||h.code,this.url||""),h instanceof f_&&h.code===c_.UNEXPECTED_RESPONSE&&h.data.code===S0.ERR_NO_AUTHORIZED)return wE.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",fO.SERVER_ERROR);wE.error("[".concat(this.clientId,"] join gateway request failed"),h.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",fO.SERVER_ERROR):(this.initError=h,this.close())})}),this.websocket.on($S.REQUEST_NEW_URLS,(h,g)=>{YR(this,f0.REQUEST_RECOVER,this.multiIpOption).then(h).catch(g)}),this.websocket.on($S.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{this.emit(F0.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}),this.websocket.on($S.TO_CONNECT_DATACHANNEL,async(h,g,j)=>YR(this,f0.DATACHANNEL_PRECONNECT,h).then(g).catch(j)),this.websocket.on($S.FAILBACK,()=>{this.openConnectionTime!==void 0&&this.emit(f0.DATACHANNEL_FAILBACK)})}}function RW(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function EO(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?RW(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):RW(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}const k5=new Map;class iZ extends US{get state(){return this._state}set state(h){if(h===this._state)return;const g=this._state;this._state=h,h==="DISCONNECTED"&&this._disconnectedReason?this.emit(PS.CONNECTION_STATE_CHANGE,h,g,this._disconnectedReason):this.emit(PS.CONNECTION_STATE_CHANGE,h,g)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(h){wE.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(h)),this._joinGatewayStartTime=h}constructor(h,g){super(),_h(this,"store",void 0),_h(this,"joinInfo",void 0),_h(this,"key",void 0),_h(this,"signal",void 0),_h(this,"role",void 0),_h(this,"inChannelInfo",{joinAt:null,duration:0}),_h(this,"spec",void 0),_h(this,"_state","DISCONNECTED"),_h(this,"_statsCollector",void 0),_h(this,"_disconnectedReason",void 0),_h(this,"isSignalRecover",!1),_h(this,"hasChangeBGPAddress",!1),_h(this,"trafficStatsInterval",void 0),_h(this,"networkQualityInterval",void 0),_h(this,"_joinGatewayStartTime",0),_h(this,"_signalTimeout",!1),_h(this,"_clientRoleOptions",void 0),_h(this,"_isProactiveJoin",!1),this.store=h,this.spec=g,this.signal=this.store.useDataChannel?new GO(EO(EO({},g),{},{retryConfig:g.websocketRetryConfig}),h):new vW(EO(EO({},g),{},{retryConfig:g.websocketRetryConfig}),h),this._statsCollector=g.statsCollector,this.role=g.role||"audience",this._clientRoleOptions=g.clientRoleOptions,this.handleSignalEvents()}async join(h,g,j){if(this.signal instanceof GO){let _a=!1;h.cloudProxyServer!=="disabled"?(wE.debug("[".concat(this.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(h.cloudProxyServer,")")),_a=!0):"".concat(h.apResponse.cid,"_").concat(h.apResponse.cert).length>255||"".concat(h.apResponse.cid,"_").concat(h.apResponse.cert).length<22?(wE.debug("[".concat(this.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),_a=!0):h.apResponse.addresses.some(_u=>_u.fingerprint)||__("FINGERPRINT")||(wE.debug("[".concat(this.store.clientId,"] Dc is not supported, because fingerprint does not exist")),_a=!0),_a&&this.resetSignal()}this.store.joinGatewayStart(),h.cloudProxyServer!=="disabled"&&(this.hasChangeBGPAddress=!0);const _t=Date.now();let _i=k5.get(h.cname);if(_i||(_i=new Map,k5.set(h.cname,_i)),this._isProactiveJoin=!0,_i.has(h.uid)){const _a=new f_(c_.UID_CONFLICT);throw p0.joinGateway(h.sid,{lts:_t,succ:!1,ec:_a.message,addr:null,uid:h.uid,cid:h.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!h.proxyServer,signalChannel:this.signal instanceof GO?"1":"0"}),this._isProactiveJoin=!1,_a}_i.set(h.uid,!0),this.joinInfo=h,this.key=g;let _o=0;this.joinGatewayStartTime=_t;const ga=h.proxyServer;try{let _a;if(wE.debug("[".concat(this.store.clientId,"] use ").concat(this.signal instanceof GO?"datachannel":"websocket"," join uid ").concat(_o)),this.signal instanceof GO)_a=await this.signal.init(h.apResponse.addresses,j);else{const _u=h.proxyServer,_c=_u?h.gatewayAddrs.map(_l=>{const _g=_l.address.split(":");return"wss://".concat(_u,"/ws/?h=").concat(_g[0],"&p=").concat(_g[1])}):h.gatewayAddrs.map(_l=>"wss://".concat(_l.address));_a=await this.signal.init(_c,j)}_o=_a.uid,wE.debug("[".concat(this.store.clientId,"] ").concat(this.signal instanceof GO?"datachannel":"websocket"," join uid ").concat(_o," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(_a){throw _a&&_a.code===c_.INIT_WEBSOCKET_TIMEOUT?(wE.warning("[".concat(this.store.clientId,"] User join failed"),_a.toString()),_a):_a&&_a.code===c_.INIT_DATACHANNEL_TIMEOUT?(wE.warning("[".concat(this.store.clientId,"] User join datachannel failed"),_a.toString()),this.resetSignal(),_a):(wE.error("[".concat(this.store.clientId,"] User join failed"),_a.toString()),p0.joinGateway(h.sid,{lts:_t,succ:!1,ec:_a.message,addr:this.signal.url,uid:h.uid,cid:h.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!ga,signalChannel:this.signal instanceof GO?"1":"0"}),this._isProactiveJoin=!1,_i.delete(h.uid),this.signal.close(),_a)}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),wE.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval(()=>{this.updateTrafficStats().catch(_a=>{wE.warning("[".concat(this.store.clientId,"] get traffic stats error"),_a.toString())})},3e3),this.networkQualityInterval=window.setInterval(()=>{navigator&&navigator.onLine!==void 0&&!navigator.onLine?this.emit(PS.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(PS.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):this.state==="CONNECTED"&&this._statsCollector.trafficStats?this.emit(PS.NETWORK_QUALITY,{uplinkNetworkQuality:cW(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:cW(this._statsCollector.trafficStats.B_dnq)}):this.emit(PS.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})},2e3),this.store.joinGatewayEnd(),_o}async leave(){let h=arguments.length>0&&arguments[0]!==void 0&&arguments[0],g=arguments.length>1?arguments[1]:void 0;if(this.state!=="DISCONNECTED"){g!==aS.FALLBACK&&(this.state="DISCONNECTING");try{h||this.signal.connectionState!==pS.CONNECTED||await function(j,_t){return _t===1/0?j:a0.race([j,ZQ(_t)])}(this.signal.request(C0.LEAVE,void 0,!0),3e3)}catch(j){wE.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),j)}this.signal.close(g),g!==aS.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(h,g,j){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new f_(c_.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const _t={state:"offer",p2p_id:this.store.p2pId,ortc:g,mode:this.spec.mode,extend:__("PUB_EXTEND"),twcc:!!__("PUBLISH_TWCC"),rtx:!!__("USE_PUB_RTX")};try{return(await this.signal.request(C0.PUBLISH,_t,!0))._message}catch(_i){if(j&&_i.data&&_i.data.code===S0.ERR_PUBLISH_REQUEST_INVALID)return wE.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),_i.toString()),await this.tryUnpubBeforeRepub(h,g),this.publish(h,g,!1);throw _i}}async unpublish(h,g){try{if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new f_(c_.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(C0.UNPUBLISH,{stream_id:g,ortc:h},!0)}catch(j){wE.warning("[".concat(this.store.clientId,"] unpublish warning: "),j)}}async subscribe(h,g,j){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new f_(c_.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const _t={stream_id:h,stream_type:g.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!__("SUBSCRIBE_TWCC"),rtx:!!__("USE_SUB_RTX"),extend:__("SUB_EXTEND"),ssrcId:g.ssrcId,svc:Array.isArray(__("SVC"))&&__("SVC").length!==0?__("SVC"):void 0};try{return(await this.signal.request(C0.SUBSCRIBE,_t,!0))._message}catch(_i){if(j&&_i.data&&_i.data.code===S0.ERR_SUBSCRIBE_REQUEST_INVALID)return wE.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),_i.toString()),await this.tryUnsubBeforeResub(h,g),await this.subscribe(h,g,!1);throw _i}}async subscribeAll(h,g){if(this.state!=="CONNECTED"&&this.state!=="RECONNECTING")throw new f_(c_.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const j={p2p_id:this.store.p2pId,users:h,dtx:!1,rtx:!!__("USE_SUB_RTX")};try{return await this.signal.request(C0.SUBSCRIBE_STREAMS,j,!0)}catch(_t){if(g&&_t.data&&_t.data.code===S0.ERR_SUBSCRIBE_REQUEST_INVALID)return wE.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),_t.toString()),await this.tryMassUnsubBeforeResub(h),await this.subscribeAll(h,!1);throw _t}}async setVideoProfile(h){const g=function(j){if(!(j.bitrateMax&&j.bitrateMin&&j.frameRate&&j.height&&j.width))return;let _t=j.frameRate,_i=j.width,_o=j.height,ga=!0;return typeof _t!="number"&&(_t=_t.exact||_t.ideal||_t.max||_t.min||0,_t||(ga=!1)),typeof _i!="number"&&(_i=_i.exact||_i.ideal||_i.max||_i.min||0,_i||(ga=!1)),typeof _o!="number"&&(_o=_o.exact||_o.ideal||_o.max||_o.min||0,_t||(ga=!1)),ga?{stream_type:0,width:_i,height:_o,fps:_t,start_bps:1e3*j.bitrateMax,min_bps:1e3*j.bitrateMin,target_bps:1e3*j.bitrateMax}:void 0}(h);if(g)return this.signal.request(C0.SET_VIDEO_PROFILE,g);wE.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(h,g){try{await this.signal.request(C0.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:h,stream_id:g},!0)}catch(j){wE.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),j)}}async massUnsubscribe(h){try{await this.signal.request(C0.UNSUBSCRIBE_STREAMS,h,!0)}catch(g){wE.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),g)}}async reconnectPC(h){const{iceParameters:g,dtlsParameters:j,rtpCapabilities:_t}=h;return{gatewayEstablishParams:await this.signal.request(C0.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:g,dtlsParameters:j,rtpCapabilities:_t}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(C0.GATEWAY_INFO)}async renewToken(h){await this.signal.request(C0.RENEW_TOKEN,h),this.key=h.token}async setClientRole(h,g){if(g&&(this._clientRoleOptions=Object.assign({},g)),this.state!=="CONNECTED")return void(this.role=h);let j;j=h==="audience"?this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:0,await this.signal.request(C0.SET_CLIENT_ROLE,{role:h,level:j,client_ts:Date.now()}),this.role=h}async setRemoteVideoStreamType(h,g){await this.signal.request(C0.SWITCH_VIDEO_STREAM,{stream_id:h,stream_type:g})}async setDefaultRemoteVideoStreamType(h){await this.signal.request(C0.DEFAULT_VIDEO_STREAM,{stream_type:h})}async setStreamFallbackOption(h,g){await this.signal.request(C0.SET_FALLBACK_OPTION,{stream_id:h,fallback_type:g})}async pickSVCLayer(h,g){await this.signal.request(C0.PICK_SVC_LAYER,{stream_id:h,spatial_layer:g.spatialLayer,temporal_layer:g.temporalLayer})}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),EO({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(C0.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const h=k5.get(this.joinInfo.cname);h&&h.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const h=function(g){let j;return j=g.startsWith("dc")?g.match(/(dc\:\/\/)?([^:]+):(\d+)/):g.match(/(wss\:\/\/)?([^:]+):(\d+)/),j?{username:YT.username,password:YT.password,turnServerURL:j[2],tcpport:parseInt(j[3])+30,udpport:parseInt(j[3])+30,forceturn:!1}:null}((this.joinInfo.cloudProxyServer==="disabled"?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],h&&this.joinInfo.turnServer.mode!=="off"&&this.joinInfo.cloudProxyServer==="disabled"&&this.joinInfo.turnServer.serversFromGateway.push(EO(EO({},YT),{},{turnServerURL:h.turnServerURL,tcpport:h.tcpport,udpport:h.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if(this.state!=="CONNECTED")return;const h=await this.signal.request(C0.TRAFFIC_STATS,void 0,!0);h.timestamp=Date.now(),h.peer_delay.forEach(g=>{const j=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find(_t=>_t.peer_uid===g.peer_uid);j&&j.B_st!==g.B_st&&eO(()=>{this.emit(PS.STREAM_TYPE_CHANGE,g.peer_uid,g.B_st)})}),this._statsCollector.updateTrafficStats(h)}getJoinMessage(h){if(!this.joinInfo||!this.key)throw new f_(c_.UNEXPECTED_ERROR,"can not generate join message, no join info");const g=Object.assign({},this.joinInfo.apResponse);let j=__("REPORT_APP_SCENARIO");if(typeof j!="string")try{j=JSON.stringify(j)}catch{j=void 0}j&&j.length>128&&(j=void 0);const _t=EO({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:dI,browser:navigator.userAgent,process_id:__("PROCESS_ID"),mode:this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:g,extend:__("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:this.joinInfo.cloudProxyServer==="proxy3"?"1":this.joinInfo.cloudProxyServer==="proxy5"?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:j,attributes:{userAttributes:{enablePublishedUserList:__("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:__("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:typeof __("SUBSCRIBE_AUDIO_FILTER_TOPN")=="number"?__("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:typeof __("ENABLE_PUBLISH_AUDIO_FILTER")=="boolean"?__("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:typeof __("ENABLE_USER_LICENSE_CHECK")=="boolean"?__("ENABLE_USER_LICENSE_CHECK"):void 0,enableRTX:__("USE_PUB_RTX")===!0||__("USE_SUB_RTX")===!0||void 0}},join_ts:this.joinGatewayStartTime},h);return this.joinInfo.stringUid&&(_t.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(_t.aes_mode=this.joinInfo.aesmode,__("ENCRYPT_AES")?(_t.aes_secret=this.joinInfo.aespassword,_t.aes_encrypt=!0):_t.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(_t.aes_salt=this.joinInfo.aessalt)),g.addresses[this.signal.websocket.currentURLIndex]&&(_t.ap_response.ticket=g.addresses[this.signal.websocket.currentURLIndex].ticket,delete g.addresses),this.joinInfo.defaultVideoStream!==void 0&&(_t.default_video_stream=this.joinInfo.defaultVideoStream),_t}getRejoinMessage(){if(!this.joinInfo)throw new f_(c_.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(f0.WS_RECONNECT_WAITTING_FINISH,h=>{["tryNext","recover"].includes(h)&&this.joinInfo&&p0.adjustSessionStartTime(this.joinInfo.sid)}),this.signal.on(f0.WS_RECONNECT_CREATE_CONNECTION,h=>{this.joinGatewayStartTime=Date.now()}),this.signal.on(f0.WS_RECONNECTING,h=>{this.joinInfo&&p0.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:h||vT.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",p0.sessionInit(this.joinInfo.sid,{lts:new Date().getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())}),this.signal.on(f0.WS_CLOSED,h=>{let g;switch(h){case aS.LEAVE:g=vT.LEAVE;break;case aS.UID_BANNED:case aS.IP_BANNED:case aS.CHANNEL_BANNED:case aS.SERVER_ERROR:g=vT.SERVER_ERROR;break;case aS.FALLBACK:g=vT.FALLBACK;break;case aS.LICENSE_MISSING:case aS.LICENSE_EXPIRED:case aS.LICENSE_MINUTES_EXCEEDED:case aS.LICENSE_PERIOD_INVALID:case aS.LICENSE_MULTIPLE_SDK_SERVICE:case aS.LICENSE_ILLEGAL:g=h;break;default:g=vT.NETWORK_ERROR}wE.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(g||"undefined -> "+vT.NETWORK_ERROR)),this.joinInfo&&p0.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:h===aS.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:g}),this._disconnectedReason=h,h!==aS.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}),this.signal.on(f0.WS_CONNECTED,()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&(this.role==="audience"&&this._clientRoleOptions&&this._clientRoleOptions.level&&(wE.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),this.setClientRole(this.role,this._clientRoleOptions)),p0.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof GO?"1":"0"}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&this.joinInfo.setLocalAPVersion===1)){const h=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!h)return void wE.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(h));ES("EVENT_REPORT_DOMAIN",h[1]),ES("EVENT_REPORT_BACKUP_DOMAIN",h[1]),ES("LOG_UPLOAD_SERVER","".concat(h[1],":6444"))}}),this.signal.on(F0.ON_UPLINK_STATS,h=>{this._statsCollector.updateUplinkStats(h)}),this.signal.on(f0.REQUEST_RECOVER,(h,g,j)=>{if(!this.joinInfo)return j(new f_(c_.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));h&&(this.joinInfo.multiIP=h,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,YR(this,PS.REQUEST_NEW_GATEWAY_LIST).then(g).catch(j)}),this.signal.on(f0.REQUEST_JOIN_INFO,async h=>{var g;this.updateTurnConfigFromSignal();const{iceParameters:j,dtlsParameters:_t,rtpCapabilities:_i}=await YR(this,PS.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:(g=this.joinInfo)===null||g===void 0?void 0:g.turnServer});h(this.getJoinMessage({ortc:{iceParameters:j,dtlsParameters:_t,rtpCapabilities:_i,version:"2"}}))}),this.signal.on(f0.REQUEST_REJOIN_INFO,h=>{h(this.getRejoinMessage())}),this.signal.on(f0.REPORT_JOIN_GATEWAY,(h,g)=>{this.joinInfo&&(p0.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:h,addr:g,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof GO?"1":"0"}),this._isProactiveJoin=!1)}),this.signal.on(f0.IS_P2P_DISCONNECTED,h=>{h(s1(this,PS.IS_P2P_DISCONNECTED))}),this.signal.on(f0.DISCONNECT_P2P,()=>{this.emit(PS.DISCONNECT_P2P)}),this.signal.on(f0.NEED_RENEW_SESSION,()=>{this.emit(PS.NEED_RENEW_SESSION)}),this.signal.on(f0.REQUEST_SUCCESS,()=>{this._signalTimeout=!1}),this.signal.on(f0.REQUEST_TIMEOUT,()=>{this._signalTimeout=!0}),this.signal.on(f0.JOIN_RESPONSE,h=>{const g=this.getCurrentGatewayAddress();this.emit(PS.JOIN_RESPONSE,h,g)}),this.signal.on(f0.DATACHANNEL_PRECONNECT,async(h,g,j)=>{this.updateTurnConfigFromSignal();const _t=this.getCurrentGatewayAddress();return YR(this,PS.DATACHANNEL_PRECONNECT,h,_t).then(g).catch(j)}),this.signal.on(f0.DATACHANNEL_CONNECTING,async h=>{const{iceParameters:g,dtlsParameters:j,rtpCapabilities:_t}=await YR(this,PS.REQUEST_DC_CONNECTION_PARAMS);h(this.getJoinMessage({ortc:{iceParameters:g,dtlsParameters:j,rtpCapabilities:_t,version:"2"}}))}),this.signal.on(f0.DATACHANNEL_FAILBACK,()=>{wE.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(PS.DATACHANNEL_FAILBACK)})}async tryUnsubBeforeResub(h,g){try{await this.signal.request(C0.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:h,ortc:[g]},!0)}catch(j){throw wE.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),j),j}}async tryUnpubBeforeRepub(h,g){try{await this.signal.request(C0.UNPUBLISH,{stream_id:h,ortc:g},!0)}catch(j){throw wE.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),j),j}}async tryMassUnsubBeforeResub(h){const g={users:h.map(j=>({stream_id:j.stream_id,stream_type:j.stream_type}))};try{await this.signal.request(C0.UNSUBSCRIBE_STREAMS,g,!0)}catch(j){throw wE.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),j),j}}async muteLocal(h,g){const j={action:h.find(_t=>_t.stream_type===hR.Audio)?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:h,stream_id:g};try{await this.signal.request(C0.CONTROL,j,!0,!0)}catch(_t){throw wE.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),_t),_t}}async unmuteLocal(h,g){const j={action:h.find(_t=>_t.stream_type===hR.Audio)?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:h,stream_id:g};try{await this.signal.request(C0.CONTROL,j,!0,!0)}catch(_t){throw wE.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),_t),_t}}uploadStats(h,g){this.signal.upload(h,g)}getSignalRTT(){return this.signal.rtt}async restartICE(h){const g={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:h};try{return await this.signal.request(C0.RESTART_ICE,g,!0)}catch(j){throw wE.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),j),j}}reconnect(){this.state==="CONNECTED"&&this.signal.reconnect(void 0,vT.P2P_FAILED)}getCurrentGatewayAddress(){var h;if(!__("GATEWAY_WSS_ADDRESS"))return(h=this.joinInfo)!==null&&h!==void 0&&h.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(h){await this.signal.request(C0.SET_PARAMETER,{enablePublishAudioFilter:h})}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(aS.FALLBACK)),this.store.useDataChannel=!1,this.signal=new vW(EO(EO({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(PS.RESET_SIGNAL,CU.websocket)}}/*! formdata-polyfill. MIT License. Jimmy W?rting <https://jimmy.warting.se/opensource> */(function(){var d;function h(L_){var z_=0;return function(){return z_<L_.length?{done:!1,value:L_[z_++]}:{done:!0}}}var g=typeof Object.defineProperties=="function"?Object.defineProperty:function(L_,z_,r0){return L_==Array.prototype||L_==Object.prototype||(L_[z_]=r0.value),L_},j,_t=function(L_){L_=[typeof globalThis=="object"&&globalThis,L_,typeof window=="object"&&window,typeof self=="object"&&self,typeof a=="object"&&a];for(var z_=0;z_<L_.length;++z_){var r0=L_[z_];if(r0&&r0.Math==Math)return r0}throw Error("Cannot find global object")}(this);function _i(L_,z_){if(z_)e:{var r0=_t;L_=L_.split(".");for(var O0=0;O0<L_.length-1;O0++){var eS=L_[O0];if(!(eS in r0))break e;r0=r0[eS]}(z_=z_(O0=r0[L_=L_[L_.length-1]]))!=O0&&z_!=null&&g(r0,L_,{configurable:!0,writable:!0,value:z_})}}function _o(L_){return(L_={next:L_})[Symbol.iterator]=function(){return this},L_}function ga(L_){var z_=typeof Symbol<"u"&&Symbol.iterator&&L_[Symbol.iterator];return z_?z_.call(L_):{next:h(L_)}}if(_i("Symbol",function(L_){function z_(eS,Z_){this.A=eS,g(this,"description",{configurable:!0,writable:!0,value:Z_})}if(L_)return L_;z_.prototype.toString=function(){return this.A};var r0="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",O0=0;return function eS(Z_){if(this instanceof eS)throw new TypeError("Symbol is not a constructor");return new z_(r0+(Z_||"")+"_"+O0++,Z_)}}),_i("Symbol.iterator",function(L_){if(L_)return L_;L_=Symbol("Symbol.iterator");for(var z_="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r0=0;r0<z_.length;r0++){var O0=_t[z_[r0]];typeof O0=="function"&&typeof O0.prototype[L_]!="function"&&g(O0.prototype,L_,{configurable:!0,writable:!0,value:function(){return _o(h(this))}})}return L_}),typeof Object.setPrototypeOf=="function")j=Object.setPrototypeOf;else{var _a;e:{var _u={};try{_u.__proto__={a:!0},_a=_u.a;break e}catch{}_a=!1}j=_a?function(L_,z_){if(L_.__proto__=z_,L_.__proto__!==z_)throw new TypeError(L_+" is not extensible");return L_}:null}var _c=j;function _l(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function _g(L_){if(L_.m)throw new TypeError("Generator is already running");L_.m=!0}function r_(L_,z_){return L_.h=3,{value:z_}}function l_(L_){this.g=new _l,this.G=L_}function d_(L_,z_,r0,O0){try{var eS=z_.call(L_.g.j,r0);if(!(eS instanceof Object))throw new TypeError("Iterator result "+eS+" is not an object");if(!eS.done)return L_.g.m=!1,eS;var Z_=eS.value}catch(_m){return L_.g.j=null,L_.g.s(_m),p_(L_)}return L_.g.j=null,O0.call(L_.g,Z_),p_(L_)}function p_(L_){for(;L_.g.h;)try{var z_=L_.G(L_.g);if(z_)return L_.g.m=!1,{value:z_.value,done:!1}}catch(r0){L_.g.v=void 0,L_.g.s(r0)}if(L_.g.m=!1,L_.g.l){if(z_=L_.g.l,L_.g.l=null,z_.F)throw z_.D;return{value:z_.return,done:!0}}return{value:void 0,done:!0}}function C_(L_){this.next=function(z_){return L_.o(z_)},this.throw=function(z_){return L_.s(z_)},this.return=function(z_){return function(r0,O0){_g(r0.g);var eS=r0.g.j;return eS?d_(r0,"return"in eS?eS.return:function(Z_){return{value:Z_,done:!0}},O0,r0.g.return):(r0.g.return(O0),p_(r0))}(L_,z_)},this[Symbol.iterator]=function(){return this}}function O_(L_,z_){return z_=new C_(new l_(z_)),_c&&L_.prototype&&_c(z_,L_.prototype),z_}if(_l.prototype.o=function(L_){this.v=L_},_l.prototype.s=function(L_){this.l={D:L_,F:!0},this.h=this.C||this.u},_l.prototype.return=function(L_){this.l={return:L_},this.h=this.u},l_.prototype.o=function(L_){return _g(this.g),this.g.j?d_(this,this.g.j.next,L_,this.g.o):(this.g.o(L_),p_(this))},l_.prototype.s=function(L_){return _g(this.g),this.g.j?d_(this,this.g.j.throw,L_,this.g.o):(this.g.s(L_),p_(this))},_i("Array.prototype.entries",function(L_){return L_||function(){return function(z_,r0){z_ instanceof String&&(z_+="");var O0=0,eS=!1,Z_={next:function(){if(!eS&&O0<z_.length){var _m=O0++;return{value:r0(_m,z_[_m]),done:!1}}return eS=!0,{done:!0,value:void 0}}};return Z_[Symbol.iterator]=function(){return Z_},Z_}(this,function(z_,r0){return[z_,r0]})}}),typeof Blob<"u"&&(typeof FormData>"u"||!FormData.prototype.keys)){var q_=function(L_,z_){for(var r0=0;r0<L_.length;r0++)z_(L_[r0])},c0=function(L_){return L_.replace(/\r?\n|\r/g,`\r
`)},K_=function(L_,z_,r0){return z_ instanceof Blob?(r0=r0!==void 0?r0+"":typeof z_.name=="string"?z_.name:"blob",z_.name===r0&&Object.prototype.toString.call(z_)!=="[object Blob]"||(z_=new File([z_],r0)),[String(L_),z_]):[String(L_),String(z_)]},Q_=function(L_,z_){if(L_.length<z_)throw new TypeError(z_+" argument required, but only "+L_.length+" present.")},$_=typeof globalThis=="object"?globalThis:typeof window=="object"?window:typeof self=="object"?self:this,_b=$_.FormData,iS=$_.XMLHttpRequest&&$_.XMLHttpRequest.prototype.send,y0=$_.Request&&$_.fetch,TS=$_.navigator&&$_.navigator.sendBeacon,hS=$_.Element&&$_.Element.prototype,eR=$_.Symbol&&Symbol.toStringTag;eR&&(Blob.prototype[eR]||(Blob.prototype[eR]="Blob"),"File"in $_&&!File.prototype[eR]&&(File.prototype[eR]="File"));try{new File([],"")}catch{$_.File=function(z_,r0,O0){return z_=new Blob(z_,O0||{}),Object.defineProperties(z_,{name:{value:r0},lastModified:{value:+(O0&&O0.lastModified!==void 0?new Date(O0.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),eR&&Object.defineProperty(z_,eR,{value:"File"}),z_}}var MR=function(L_){return L_.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},XS=function(L_){this.i=[];var z_=this;L_&&q_(L_.elements,function(r0){if(r0.name&&!r0.disabled&&r0.type!=="submit"&&r0.type!=="button"&&!r0.matches("form fieldset[disabled] *"))if(r0.type==="file"){var O0=r0.files&&r0.files.length?r0.files:[new File([],"",{type:"application/octet-stream"})];q_(O0,function(eS){z_.append(r0.name,eS)})}else r0.type==="select-multiple"||r0.type==="select-one"?q_(r0.options,function(eS){!eS.disabled&&eS.selected&&z_.append(r0.name,eS.value)}):r0.type==="checkbox"||r0.type==="radio"?r0.checked&&z_.append(r0.name,r0.value):(O0=r0.type==="textarea"?c0(r0.value):r0.value,z_.append(r0.name,O0))})};if((d=XS.prototype).append=function(L_,z_,r0){Q_(arguments,2),this.i.push(K_(L_,z_,r0))},d.delete=function(L_){Q_(arguments,1);var z_=[];L_=String(L_),q_(this.i,function(r0){r0[0]!==L_&&z_.push(r0)}),this.i=z_},d.entries=function L_(){var z_,r0=this;return O_(L_,function(O0){if(O0.h==1&&(z_=0),O0.h!=3)return z_<r0.i.length?O0=r_(O0,r0.i[z_]):(O0.h=0,O0=void 0),O0;z_++,O0.h=2})},d.forEach=function(L_,z_){Q_(arguments,1);for(var r0=ga(this),O0=r0.next();!O0.done;O0=r0.next()){var eS=ga(O0.value);O0=eS.next().value,eS=eS.next().value,L_.call(z_,eS,O0,this)}},d.get=function(L_){Q_(arguments,1);var z_=this.i;L_=String(L_);for(var r0=0;r0<z_.length;r0++)if(z_[r0][0]===L_)return z_[r0][1];return null},d.getAll=function(L_){Q_(arguments,1);var z_=[];return L_=String(L_),q_(this.i,function(r0){r0[0]===L_&&z_.push(r0[1])}),z_},d.has=function(L_){Q_(arguments,1),L_=String(L_);for(var z_=0;z_<this.i.length;z_++)if(this.i[z_][0]===L_)return!0;return!1},d.keys=function L_(){var z_,r0,O0,eS,Z_=this;return O_(L_,function(_m){if(_m.h==1&&(z_=ga(Z_),r0=z_.next()),_m.h!=3)return r0.done?void(_m.h=0):(O0=r0.value,eS=ga(O0),r_(_m,eS.next().value));r0=z_.next(),_m.h=2})},d.set=function(L_,z_,r0){Q_(arguments,2),L_=String(L_);var O0=[],eS=K_(L_,z_,r0),Z_=!0;q_(this.i,function(_m){_m[0]===L_?Z_&&(Z_=!O0.push(eS)):O0.push(_m)}),Z_&&O0.push(eS),this.i=O0},d.values=function L_(){var z_,r0,O0,eS,Z_=this;return O_(L_,function(_m){if(_m.h==1&&(z_=ga(Z_),r0=z_.next()),_m.h!=3)return r0.done?void(_m.h=0):(O0=r0.value,(eS=ga(O0)).next(),r_(_m,eS.next().value));r0=z_.next(),_m.h=2})},XS.prototype._asNative=function(){for(var L_=new _b,z_=ga(this),r0=z_.next();!r0.done;r0=z_.next()){var O0=ga(r0.value);r0=O0.next().value,O0=O0.next().value,L_.append(r0,O0)}return L_},XS.prototype._blob=function(){var L_="----formdata-polyfill-"+Math.random(),z_=[],r0="--"+L_+`\r
Content-Disposition: form-data; name="`;return this.forEach(function(O0,eS){return typeof O0=="string"?z_.push(r0+MR(c0(eS))+`"\r
\r
`+c0(O0)+`\r
`):z_.push(r0+MR(c0(eS))+'"; filename="'+MR(O0.name)+`"\r
Content-Type: `+(O0.type||"application/octet-stream")+`\r
\r
`,O0,`\r
`)}),z_.push("--"+L_+"--"),new Blob(z_,{type:"multipart/form-data; boundary="+L_})},XS.prototype[Symbol.iterator]=function(){return this.entries()},XS.prototype.toString=function(){return"[object FormData]"},hS&&!hS.matches&&(hS.matches=hS.matchesSelector||hS.mozMatchesSelector||hS.msMatchesSelector||hS.oMatchesSelector||hS.webkitMatchesSelector||function(L_){for(var z_=(L_=(this.document||this.ownerDocument).querySelectorAll(L_)).length;0<=--z_&&L_.item(z_)!==this;);return-1<z_}),eR&&(XS.prototype[eR]="FormData"),iS){var AT=$_.XMLHttpRequest.prototype.setRequestHeader;$_.XMLHttpRequest.prototype.setRequestHeader=function(L_,z_){AT.call(this,L_,z_),L_.toLowerCase()==="content-type"&&(this.B=!0)},$_.XMLHttpRequest.prototype.send=function(L_){L_ instanceof XS?(L_=L_._blob(),this.B||this.setRequestHeader("Content-Type",L_.type),iS.call(this,L_)):iS.call(this,L_)}}y0&&($_.fetch=function(L_,z_){return z_&&z_.body&&z_.body instanceof XS&&(z_.body=z_.body._blob()),y0.call(this,L_,z_)}),TS&&($_.navigator.sendBeacon=function(L_,z_){return z_ instanceof XS&&(z_=z_._asNative()),TS.call(this,L_,z_)}),$_.FormData=XS}})();const VU=()=>{const d=__("AREAS");return d.length===0&&d.push(z0.GLOBAL),WI(d).call(d,(h,g,j)=>{const _t=TW(g);return _t?j===0?_t:"".concat(h,",").concat(_t):h},"")},TW=d=>d===z0.OVERSEA?"".concat(OR.ASIA,",").concat(OR.EUROPE,",").concat(OR.AFRICA,",").concat(OR.NORTH_AMERICA,",").concat(OR.SOUTH_AMERICA,",").concat(OR.OCEANIA):OR[d],oZ=d=>{const h={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return d.map(g=>{const j=IU[g],_t=Object.keys(j);_t&&_t.map(_i=>{_i!=="CODE"&&(h[_i]=h[_i].concat(j[_i]))})}),h},GU={GLOBAL:{ASIA:[z0.CHINA,z0.JAPAN,z0.INDIA,z0.KOREA,z0.HKMC],EUROPE:[],NORTH_AMERICA:[z0.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},P5=Object.keys(GU[z0.GLOBAL]),wW=[z0.CHINA,z0.NORTH_AMERICA,z0.EUROPE,z0.ASIA,z0.JAPAN,z0.INDIA,z0.OCEANIA,z0.SOUTH_AMERICA,z0.AFRICA,z0.KOREA,z0.HKMC,z0.US],sZ=function(d,h){let g=[];if(d.includes(z0.GLOBAL)){const _i=[z0.GLOBAL,z0.OVERSEA],_o=Object.keys(IU);if(h===z0.GLOBAL)throw new f_(c_.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(h===z0.CHINA)g=[z0.OVERSEA];else if(_t=h,P5.includes(_t)){const ga=(j=h,GU[z0.GLOBAL][j]||[]),_a=[..._i,h,...ga];g=_o.filter(_u=>!_a.includes(_u))}else if(function(ga){let _a=!1;return P5.forEach(_u=>{GU[z0.GLOBAL][_u].includes(ga)&&(_a=!0)}),_a}(h)){const ga=function(_u){let _c;return P5.forEach(_l=>{GU[z0.GLOBAL][_l].includes(_u)&&(_c=_l)}),_c}(h),_a=[..._i,ga,h];g=_o.filter(_u=>!_a.includes(_u))}else g=d;g=function(ga){const _a=[];return wW.forEach(_u=>{ga.includes(_u)&&_a.push(_u)}),_a.concat(ga.filter(_u=>!wW.includes(_u)))}(g)}else g=d;var j,_t;return g};function CW(d){if(!d&&__("AREAS").includes(z0.EXTENSIONS))return wE.debug("update area from ap : reset"),void x5(u4,!0);if(!__("AREAS").includes(z0.GLOBAL)||!d)return;let h=IU.EXTENSIONS;h&&(h={CODE:TW(z0.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(d,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(d,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(d,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(d,".agora.io"),"cds-ap-web-2-".concat(d,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(d,".agora.io"),"sua-ap-web-2-".concat(d,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(d,".agora.io"),"uap-ap-web-2-".concat(d,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(d,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(d,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(d,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(d,".agora.io")]},wE.debug("update area from ap success: ".concat(d,",config is "),h),ES("AREAS",[z0.EXTENSIONS],!0),Object.keys(h).map(g=>{g==="LOG_UPLOAD_SERVER"||g==="EVENT_REPORT_DOMAIN"||g==="EVENT_REPORT_BACKUP_DOMAIN"||g==="PROXY_SERVER_TYPE3"?ES(g,h[g][0]):ES(g,h[g])}))}function x5(d){let h=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const g=p0.reportApiInvoke(null,{name:iR.SET_AREA,options:d,tag:kS.TRACER});try{let j=[];if(typeof d=="string"&&(j=[d]),Array.isArray(d)&&(d.forEach(_i=>{if(!xX.includes(_i))throw new f_(c_.INVALID_PARAMS,"invalid area code")}),j=d),Object.prototype.toString.call(d)==="[object Object]"){const{areaCode:_i,excludedArea:_o}=d;if(!_i)throw new f_(c_.INVALID_PARAMS,"area code is needed");let ga=_i;typeof _i=="string"&&(ga=[_i]),j=_o?sZ(ga,_o):ga}if(!h){if(QN.AREAS){const _i=new f_(c_.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return g.onError(_i),void wE.warning("setArea is prohibited because of config-distribute")}if(j.includes(z0.GLOBAL)&&__("AREAS")===z0.EXTENSIONS){const _i=new f_(c_.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return g.onError(_i),void wE.warning("setArea is prohibited because of ap extensions")}}ES("AREAS",j,h);const _t=oZ(j);Object.keys(_t).map(_i=>{_i==="LOG_UPLOAD_SERVER"||_i==="EVENT_REPORT_DOMAIN"||_i==="EVENT_REPORT_BACKUP_DOMAIN"||_i==="PROXY_SERVER_TYPE3"?ES(_i,_t[_i][0]):ES(_i,_t[_i])}),wE.debug("set area success:",j.join(","))}catch(j){throw g.onError(j),j}g.onSuccess()}function IW(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function OW(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?IW(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):IW(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}let D5=1;function aZ(d,h,g,j,_t){D5+=1;const _i={sid:g.sid,command:"convergeAllocateEdge",uid:"666",appId:g.appId,ts:Math.floor(Date.now()/1e3),seq:D5,requestId:D5,version:dI,cname:g.cname},_o={service_name:h,json_body:JSON.stringify(_i)};let ga,_a,_u=d[0];return JI(async()=>{ga=Date.now();const _c=await NI(_u,{data:_o,cancelToken:j,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(_a=Date.now()-ga,_c.code!==0){const r_=new f_(c_.UNEXPECTED_RESPONSE,"live streaming ap error, code"+_c.code,{retry:!0,responseTime:_a});throw wE.error(r_.toString()),r_}const _l=JSON.parse(_c.json_body);if(_l.code!==200){const r_=new f_(c_.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(_l.code,", reason: ").concat(_l.reason),{code:_l.code,responseTime:_a});throw wE.error(r_.toString()),r_}if(!_l.servers||_l.servers.length===0){const r_=new f_(c_.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:_l.code,responseTime:_a});throw wE.error(r_.toString()),r_}const _g=function(r_,l_){return{addressList:r_.servers.map(d_=>"wss://".concat(d_.address.replace(/\./g,"-"),".").concat(__("WORKER_DOMAIN"),":").concat(d_.wss,"?serviceName=").concat(encodeURIComponent(l_))),workerToken:r_.workerToken,vid:r_.vid}}(_l,h);return __("LIVE_STREAMING_ADDRESS")&&(_g.addressList=__("LIVE_STREAMING_ADDRESS")instanceof Array?__("LIVE_STREAMING_ADDRESS"):[__("LIVE_STREAMING_ADDRESS")]),OW(OW({},_g),{},{responseTime:_a})},(_c,_l)=>(p0.apworkerEvent(g.sid,{success:!0,sc:200,serviceName:h,responseDetail:JSON.stringify(_c.addressList),firstSuccess:_l===0,responseTime:_a,serverIp:d[_l%d.length]}),!1),(_c,_l)=>(p0.apworkerEvent(g.sid,{success:!1,sc:_c.data&&_c.data.code||200,serviceName:h,responseTime:_a,serverIp:d[_l%d.length]}),!!(_c.code!==c_.OPERATION_ABORTED&&_c.code!==c_.UNEXPECTED_RESPONSE||_c.data&&_c.data.retry)&&(_u=d[(_l+1)%d.length],!0)),_t)}let L5=1;function AW(d,h,g,j){let{url:_t,areaCode:_i}=d;const _o=Date.now();let ga;const[_a,_u]=xW(h,_i,[yR.CHOOSE_SERVER]);let _c=sR.networkState;return JI(async()=>{_c&&sR.networkState===eT.OFFLINE&&sR.onlineWaiter&&await a0.race([sR.onlineWaiter,KR(j&&j.maxRetryTimeout||rR.maxRetryTimeout)]),_c=sR.networkState;const{data:_l,headers:_g}=await NI(_t,{data:_a,cancelToken:g,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);ga=_g.http3==="1"?1:-1,p0.reportResourceTiming(_t,h.sid),kW(_l,_t,h,_o,[yR.CHOOSE_SERVER],ga);const r_=I5(_l,yR.CHOOSE_SERVER);return PW(r_),sW(r_,_t)},_l=>(_l&&p0.joinChooseServer(h.sid,{lts:_o,succ:!0,csAddr:_t,opid:_u,serverList:_l.gatewayAddrs.map(_g=>_g.address),ec:null,cid:_l.cid.toString(),uid:_l.uid.toString(),csIp:_l.csIp,unilbsServerIds:[yR.CHOOSE_SERVER].toString(),isHttp3:ga}),!1),_l=>_l.code!==c_.OPERATION_ABORTED&&(_l.code===c_.CAN_NOT_GET_GATEWAY_SERVER?_l.data.retry:(p0.joinChooseServer(h.sid,{lts:_o,succ:!1,csAddr:_t,serverList:null,opid:_u,ec:_l.code,csIp:_l.data&&_l.data.csIp,unilbsServerIds:[yR.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:_c}),isHttp3:ga}),wE.warning("[".concat(h.clientId,"] Choose server network error, retry"),_l),!0)),j)}function NW(d,h,g,j){let _t,{url:_i,areaCode:_o,serviceIds:ga}=d;const _a=Date.now(),[_u,_c]=xW(h,_o,ga);let _l;return JI(async()=>{_l&&sR.networkState===eT.OFFLINE&&sR.onlineWaiter&&await a0.race([sR.onlineWaiter,KR(j&&j.maxRetryTimeout||rR.maxRetryTimeout)]),_l=sR.networkState;const{data:_g,headers:r_}=await NI(_i,{data:_u,cancelToken:g,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);_t=r_.http3==="1"?1:-1,p0.reportResourceTiming(_i,h.sid),kW(_g,_i,h,_a,ga,_t);const l_=I5(_g,yR.CHOOSE_SERVER),d_=I5(_g,h.cloudProxyServer==="proxy5"?yR.CLOUD_PROXY_5:h.cloudProxyServer==="proxy3"||h.cloudProxyServer==="proxy4"?yR.CLOUD_PROXY:yR.CLOUD_PROXY_FALLBACK);return PW(l_),{gatewayInfo:sW(l_,_i),proxyInfo:d_,url:_i}},_g=>(_g.gatewayInfo&&p0.joinChooseServer(h.sid,{lts:_a,succ:!0,csAddr:_i,serverList:_g.gatewayInfo.gatewayAddrs.map(r_=>r_.address),ec:null,opid:_c,cid:_g.gatewayInfo.cid.toString(),uid:_g.gatewayInfo.uid.toString(),csIp:_g.gatewayInfo.csIp,unilbsServerIds:ga.toString(),isHttp3:_t}),_g.proxyInfo&&p0.joinWebProxyAP(h.sid,{lts:_a,sucess:1,apServerAddr:_i,turnServerAddrList:_g.proxyInfo.addresses.map(r_=>r_.ip).join(","),errorCode:null,eventType:h.cloudProxyServer,unilbsServerIds:ga.toString()}),!1),_g=>_g.code!==c_.OPERATION_ABORTED&&(_g.code===c_.CAN_NOT_GET_GATEWAY_SERVER?_g.data.retry:(p0.joinWebProxyAP(h.sid,{lts:_a,sucess:0,apServerAddr:_i,turnServerAddrList:null,errorCode:_g.code,eventType:h.cloudProxyServer,unilbsServerIds:ga.toString(),extend:JSON.stringify({networkState:_l})}),wE.warning("[".concat(h.clientId,"] multi unilbs network error, retry"),_g),!0)),j)}const kW=(d,h,g,j,_t,_i)=>{const _o=[],ga=_a=>{_a.flag===4096?p0.joinChooseServer(g.sid,{lts:j,succ:!1,csAddr:h,opid:d.opid,serverList:null,ec:_a.error.message,csIp:_a.error.data&&_a.error.data.csIp,unilbsServerIds:_t.toString(),isHttp3:_i}):_a.flag!==1048576&&_a.flag!==4194304&&_a.flag!==4194310||p0.joinWebProxyAP(g.sid,{lts:j,sucess:0,apServerAddr:h,turnServerAddrList:null,errorCode:_a.error.code,eventType:g.cloudProxyServer,unilbsServerIds:_t.toString()})};if(d.response_body.forEach(_a=>{const _u=_a.buffer.code;if(_a.uri===23&&_u===0&&!_a.buffer.edges_services)if(_a.buffer.flag===4194310)wE.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),_a.buffer.edges_services=[];else{const _c={error:new f_(c_.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:d.detail[502]}),flag:_a.buffer.flag};_o.push(_c),ga(_c)}if(_u!==0){const _c=BU(_u),_l={error:new f_(c_.CAN_NOT_GET_GATEWAY_SERVER,_c.desc,{desc:_c.desc,retry:_c.retry,csIp:d.detail[502]}),flag:_a.buffer.flag};_a.buffer.flag===4194310?wE.warning(_l.error.toString()):_o.push(_l),ga(_l)}}),_o.length)throw wE.warning("[".concat(g.clientId,"] multi unilbs ").concat(h," failed, ").concat(_o.map(_a=>"flag: ".concat(_a.flag,", message: ").concat(_a.error.message,", retry: ").concat(_a.error.data.retry)).join(" | "))),new f_(c_.CAN_NOT_GET_GATEWAY_SERVER,_o.map(_a=>"flag: ".concat(_a.flag,", message: ").concat(_a.error.message)).join(" | "),{retry:!!_o.find(_a=>_a.error.data.retry),csIp:d.detail[502],desc:[...new Set(_o.map(_a=>{var _u,_c;return _a==null||(_u=_a.error)===null||_u===void 0||(_c=_u.data)===null||_c===void 0?void 0:_c.desc}).filter(_a=>!!_a))]})},PW=d=>{var h,g,j,_t;if(d.addresses&&d.addresses.length===0&&d.code===0)throw new f_(c_.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:d.detail&&d.detail[502]});if(__("AP_AREA")&&((j=d.detail)!==null&&j!==void 0&&j[23]&&typeof((_t=d.detail)===null||_t===void 0?void 0:_t[23])=="string"?CW(d.detail[23].toLowerCase()):CW()),(h=d.detail)!==null&&h!==void 0&&h[19]&&typeof((g=d.detail)===null||g===void 0?void 0:g[19])=="string"){const _o=d.detail[19],ga=_o==null?void 0:_o.split(";");for(let _a=0;_a<ga.length;_a++){var _i;const _u=LO(_i=ga[_a]).call(_i);d.addresses[_a]&&ga&&(d.addresses[_a].fingerprint=_u)}}if(__("GATEWAY_ADDRESS")&&__("GATEWAY_ADDRESS").length>0){wE.debug("assign gateway address to",__("GATEWAY_ADDRESS"));const _o=__("GATEWAY_ADDRESS").map(ga=>{var _a,_u;const _c=(_a=(_u=d.addresses.find(_l=>_l.ip===ga.ip&&_l.port===ga.port))===null||_u===void 0?void 0:_u.fingerprint)!==null&&_a!==void 0?_a:"";return{ip:ga.ip,port:ga.port,ticket:d.addresses[0]&&d.addresses[0].ticket,fingerprint:_c}});d.addresses=_o}},cZ=(d,h)=>{if(d.response_body&&d.response_body.length){const g=d.response_body[0];if(g.buffer.code!==0){const j=BU(g.buffer.code);throw new f_(c_.UPDATE_TICKET_FAILED,"[".concat(g.buffer.code,"]: ").concat(j.desc),{retry:j.retry})}return g.buffer.ticket}throw wE.debug("update ticket request received ap response without response body:",h),new f_(c_.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},xW=(d,h,g)=>{const j=Math.floor(Math.random()*1e12),_t={appid:d.appId,client_ts:Date.now(),opid:j,sid:d.sid,request_bodies:[{uri:22,buffer:{cname:d.cname,detail:{6:d.stringUid,11:h,12:__("USE_NEW_TOKEN")?"1":void 0,22:h},key:d.token,service_ids:g,uid:d.uid||0}}]};_t.request_bodies.forEach(_o=>{d.multiIP&&d.multiIP.gateway_ip&&(_o.buffer.detail[5]=JSON.stringify({vocs_ip:[d.multiIP.uni_lbs_ip],vos_ip:[d.multiIP.gateway_ip]}))});const _i=new FormData;return _i.append("request",JSON.stringify(_t)),[_i,j]},uZ=(d,h)=>{const g=Math.floor(Math.random()*1e12),j={appid:d.appId,client_ts:Date.now(),opid:g,sid:d.sid,request_bodies:[{uri:28,buffer:{cname:d.cname,detail:{1:"",6:d.stringUid,12:"1"},token:d.token,service_ids:h,uid:d.uid||0,edges_services:d.apResponse.addresses.map(_i=>({ip:_i.ip,port:_i.port}))}}]},_t=new FormData;return _t.append("request",JSON.stringify(j)),[_t,g]};let aP=0;async function M5(d,h,g,j){return{gatewayInfo:await async function(_i,_o,ga,_a){let _u=null;const _c=[],_l=async()=>{const r_=__("WEBCS_DOMAIN").slice(0,__("AJAX_REQUEST_CONCURRENT")).map(p_=>({url:_i.proxyServer?"https://".concat(_i.proxyServer,"/ap/?url=").concat(p_+"/api/v2/transpond/webrtc?v=2"):"https://".concat(p_,"/api/v2/transpond/webrtc?v=2"),areaCode:VU()})),l_=_a.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:r_.map(p_=>p_.url)}),d_=await _L({fragementLength:__("FRAGEMENT_LENGTH"),referenceList:r_,asyncMapHandler:p_=>(wE.debug("[".concat(_i.clientId,"] Connect to choose_server:"),p_.url),AW(p_,_i,_o,ga)),allFailedhandler:p_=>{throw _a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:p_},l_),p_[0]},promisesCollector:_c});return _a.recordJoinChannelService({endTs:Date.now(),status:"success"},l_),d_},_g=async()=>{if(await KR(1e3),_u!==null)return _u;const r_=__("WEBCS_DOMAIN_BACKUP_LIST").map(p_=>({url:_i.proxyServer?"https://".concat(_i.proxyServer,"/ap/?url=").concat(p_+"/api/v2/transpond/webrtc?v=2"):"https://".concat(p_,"/api/v2/transpond/webrtc?v=2"),areaCode:VU()})),l_=_a.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:r_.map(p_=>p_.url)}),d_=await _L({fragementLength:__("FRAGEMENT_LENGTH"),referenceList:r_,asyncMapHandler:p_=>(wE.debug("[".concat(_i.clientId,"] Connect to backup choose_server:"),p_.url),AW(p_,_i,_o,ga)),allFailedhandler:p_=>{throw _a.recordJoinChannelService({endTs:Date.now(),status:"error",errors:p_},l_),p_[0]},promisesCollector:_c});return _a.recordJoinChannelService({endTs:Date.now(),status:"success"},l_),d_};try{return _u=await sP([_l(),_g()]),_c.length&&_c.forEach(r_=>r_.cancel&&typeof r_.cancel=="function"&&r_.cancel()),_u}catch(r_){throw r_[0]}}(d,h,g,j)}}async function DW(d,h,g,j,_t){const _i=d.cloudProxyServer;if(_i==="disabled"){if(!j)return;if(d.useLocalAccessPoint)return await M5(d,h,g,_t);if(__("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:_u,proxyInfo:_c}=await MW(d,h,g,_t);return d.turnServer&&d.turnServer.mode!=="auto"||(d.turnServer={mode:"manual",servers:_c.map(_l=>({turnServerURL:_l.address,tcpport:_l.tcpport||YT.tcpport,udpport:_l.udpport||YT.udpport,username:_l.username||YT.username,password:_l.password||YT.password,forceturn:!1,security:!0}))}),{gatewayInfo:_u}}return await M5(d,h,g,_t)}const{proxyInfo:_o,gatewayInfo:ga}=await MW(d,h,g,_t),_a={gatewayInfo:ga};return d.turnServer={mode:"manual",servers:_o.map(_u=>({turnServerURL:_u.address,tcpport:_i==="proxy3"?void 0:_u.tcpport?_u.tcpport:YT.tcpport,udpport:_i==="proxy4"?void 0:_u.udpport?_u.udpport:YT.udpport,username:_u.username||YT.username,password:_u.password||YT.password,forceturn:_i!=="proxy4",security:_i==="proxy5"}))},wE.debug("[".concat(d.clientId,"] set proxy server: ").concat(d.proxyServer,", mode: ").concat(_i)),_a}async function LW(d,h,g,j,_t){const _i=__("ACCOUNT_REGISTER").slice(0,__("AJAX_REQUEST_CONCURRENT"));let _o=[];_o=h.proxyServer?_i.map(_a=>"https://".concat(h.proxyServer,"/ap/?url=").concat(_a+"/api/v1")):_i.map(_a=>"https://".concat(_a,"/api/v1"));const ga=_t==null?void 0:_t.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:_o});try{const _a=await async function(_u,_c,_l,_g,r_){const l_=Date.now(),d_={sid:_l.sid,opid:10,appid:_l.appId,string_uid:_c};let p_=_u[0];const C_=await JI(()=>NI(p_+"".concat(p_.indexOf("?")===-1?"?":"&","action=stringuid"),{data:d_,cancelToken:_g,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}}),(O_,q_)=>{if(O_.code===0){if(O_.uid<=0||O_.uid>=Math.pow(2,32))throw wE.error("Invalid Uint Uid ".concat(_c," => ").concat(O_.uid),O_),p0.reqUserAccount(d_.sid,{lts:l_,success:!1,serverAddr:p_,stringUid:d_.string_uid,uid:O_.uid,errorCode:c_.INVALID_UINT_UID_FROM_STRING_UID,extend:d_}),new f_(c_.INVALID_UINT_UID_FROM_STRING_UID);return p0.reqUserAccount(d_.sid,{lts:l_,success:!0,serverAddr:p_,stringUid:d_.string_uid,uid:O_.uid,errorCode:null,extend:d_}),!1}const c0=BU(O_.code);return c0.retry&&(p_=_u[(q_+1)%_u.length]),p0.reqUserAccount(d_.sid,{lts:l_,success:!1,serverAddr:p_,stringUid:d_.string_uid,uid:O_.uid,errorCode:c0.desc,extend:d_}),c0.retry},(O_,q_)=>O_.code!==c_.OPERATION_ABORTED&&(p0.reqUserAccount(d_.sid,{lts:l_,success:!1,serverAddr:p_,stringUid:d_.string_uid,uid:null,errorCode:O_.code,extend:d_}),p_=_u[(q_+1)%_u.length],!0),r_);if(C_.code!==0){const O_=BU(C_.code);throw new f_(c_.UNEXPECTED_RESPONSE,O_.desc)}return C_}(_o,d,h,g,j);return _t==null||_t.recordJoinChannelService({status:"success",endTs:Date.now()},ga),_a.uid}catch(_a){throw _t==null||_t.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[_a]},ga),_a}}async function lZ(d,h,g){const j=__("CDS_AP").slice(0,__("AJAX_REQUEST_CONCURRENT")).map(ga=>d.proxyServer?"https://".concat(d.proxyServer,"/ap/?url=").concat(ga+"/api/v1"):"https://".concat(ga,"/api/v1?action=config")).map(ga=>function(_a,_u,_c,_l){const _g=sS(),r_={flag:64,cipher_method:0,features:{device:_g.name,system:_g.os,system_general:navigator.userAgent,vendor:_u.appId,version:dI,cname:_u.cname,sid:_u.sid,session_id:_u.sid,detail:"",proxyServer:_u.proxyServer}};return JI(()=>NI(_a,{data:r_,timeout:1e3,cancelToken:_c,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}}),void 0,l_=>l_.code!==c_.OPERATION_ABORTED,_l)}(ga,d,h,g));let _t=null,_i=null,_o={};try{_t=await sP(j)}catch(ga){if(ga.code===c_.OPERATION_ABORTED)throw ga;_i=ga}if(j.forEach(ga=>ga.cancel()),p0.reportApiInvoke(d.sid,{name:iR.REQUEST_CONFIG_DISTRIBUTE,options:{error:_i,res:_t}}).onSuccess(),_t&&_t.test_tags)try{_o=function(ga){if(!ga.test_tags)return{};const _a=ga.test_tags,_u=Object.keys(_a),_c={};return _u.forEach(_l=>{var _g;const r_=LO(_g=_l.slice(4)).call(_g),l_=JSON.parse(_a[_l])[1];_c[r_]=l_}),_c}(_t)}catch{}return _o}async function MW(d,h,g,j){const _t=__("PROXY_SERVER_TYPE3"),_i=(r_,l_,d_)=>{let p_=d_||_t;return Array.isArray(p_)&&(p_=l_%2==0?_t[1]:_t[0]),"https://".concat(p_,"/ap/?url=").concat(r_)};let _o=null;const ga=[],_a=async()=>{const r_=__("WEBCS_DOMAIN").slice(0,__("AJAX_REQUEST_CONCURRENT")).map((p_,C_)=>{let O_;return O_=d.cloudProxyServer==="disabled"&&d.proxyServer?_i("".concat(p_,"/api/v2/transpond/webrtc?v=2"),C_,d.proxyServer):d.cloudProxyServer==="disabled"||d.cloudProxyServer==="fallback"?"https://".concat(p_,"/api/v2/transpond/webrtc?v=2"):_i("".concat(p_,"/api/v2/transpond/webrtc?v=2"),C_),{url:O_,areaCode:VU(),serviceIds:[yR.CHOOSE_SERVER,d.cloudProxyServer==="proxy5"?yR.CLOUD_PROXY_5:d.cloudProxyServer==="proxy3"||d.cloudProxyServer==="proxy4"?yR.CLOUD_PROXY:yR.CLOUD_PROXY_FALLBACK]}}),l_=j.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:r_.map(p_=>p_.url)}),d_=await _L({fragementLength:__("FRAGEMENT_LENGTH"),referenceList:r_,asyncMapHandler:p_=>(wE.debug("[".concat(d.clientId,"] Connect to choose_server:"),p_.url),NW(p_,d,h,g)),allFailedhandler:p_=>{throw j.recordJoinChannelService({endTs:Date.now(),status:"error",errors:p_},l_),p_[0]},promisesCollector:ga});return j.recordJoinChannelService({endTs:Date.now(),status:"success"},l_),d_},_u=async()=>{if(await KR(1e3),_o!==null)return _o;const r_=__("WEBCS_DOMAIN_BACKUP_LIST").map((p_,C_)=>{let O_;return O_=d.cloudProxyServer==="disabled"&&d.proxyServer?_i("".concat(p_,"/api/v2/transpond/webrtc?v=2"),C_,d.proxyServer):d.cloudProxyServer==="disabled"||d.cloudProxyServer==="fallback"?"https://".concat(p_,"/api/v2/transpond/webrtc?v=2"):_i("".concat(p_,"/api/v2/transpond/webrtc?v=2"),C_),{url:O_,areaCode:VU(),serviceIds:[yR.CHOOSE_SERVER,d.cloudProxyServer==="proxy5"?yR.CLOUD_PROXY_5:d.cloudProxyServer==="proxy3"||d.cloudProxyServer==="proxy4"?yR.CLOUD_PROXY:yR.CLOUD_PROXY_FALLBACK]}}),l_=j.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:r_.map(p_=>p_.url)}),d_=await _L({fragementLength:__("FRAGEMENT_LENGTH"),referenceList:r_,asyncMapHandler:p_=>(wE.debug("[".concat(d.clientId,"] Connect to backup choose_server:"),p_.url),NW(p_,d,h,g)),allFailedhandler:p_=>{throw j.recordJoinChannelService({endTs:Date.now(),status:"error",errors:p_},l_),p_[0]},promisesCollector:ga});return j.recordJoinChannelService({endTs:Date.now(),status:"success"},l_),d_};let _c,_l,_g;try{({gatewayInfo:_c,proxyInfo:_l,url:_g}=await sP([_a(),_u()]))}catch(r_){throw r_[0]}if(ga.length&&ga.forEach(r_=>r_.cancel&&typeof r_.cancel=="function"&&r_.cancel()),!_c||!_l)throw new f_(c_.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(d.apUrl=_g,d.cloudProxyServer!=="disabled"&&Array.isArray(_t)&&_g){const r_=/^https?:\/\/(.+?)(\/.*)?$/.exec(_g)[1];_t.includes(r_)&&(d.proxyServer=r_,wE.setProxyServer(r_),p0.setProxyServer(r_))}return _o={gatewayInfo:_c,proxyInfo:await XQ(_l,_c.uid)},_o}async function jW(d,h,g,j){const _t=__("UAP_AP").slice(0,__("AJAX_REQUEST_CONCURRENT")).map(_i=>h.proxyServer?"https://".concat(h.proxyServer,"/ap/?url=").concat(_i+"/api/v1?action=uap"):"https://".concat(_i,"/api/v1?action=uap"));return await aZ(_t,d,h,g,j)}async function dZ(d,h,g){const j=__("UAP_AP").slice(0,__("AJAX_REQUEST_CONCURRENT")).map(_t=>d.proxyServer?"https://".concat(d.proxyServer,"/ap/?url=").concat(_t+"/api/v1?action=uap"):"https://".concat(_t,"/api/v1?action=uap")).map(_t=>function(_i,_o,ga,_a){const _u={command:"convergeAllocateEdge",sid:_o.sid,appId:_o.appId,token:_o.token,ts:Date.now(),version:dI,cname:_o.cname,uid:_o.uid.toString(),requestId:L5,seq:L5};L5+=1;const _c={service_name:"tele_channel",json_body:JSON.stringify(_u)};return JI(async()=>{const _l=await NI(_i,{data:_c,cancelToken:ga,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(_l.code!==0){const r_=new f_(c_.UNEXPECTED_RESPONSE,"cross channel ap error, code"+_l.code,{retry:!0});throw wE.error(r_.toString()),r_}const _g=JSON.parse(_l.json_body);if(_g.code!==200){const r_=new f_(c_.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(_g.code,", reason: ").concat(_g.reason));throw wE.error(r_.toString()),r_}if(!_g.servers||_g.servers.length===0){const r_=new f_(c_.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw wE.error(r_.toString()),r_}return{vid:_g.vid,workerToken:_g.workerToken,addressList:(__("CHANNEL_MEDIA_RELAY_SERVERS")||_g.servers).map(r_=>"wss://".concat(r_.address.replace(/\./g,"-"),".").concat(__("WORKER_DOMAIN"),":").concat(r_.wss))}},void 0,_l=>!!(_l.code!==c_.OPERATION_ABORTED&&_l.code!==c_.UNEXPECTED_RESPONSE||_l.data&&_l.data.retry),_a)}(_t,d,h,g));try{const _t=await sP(j);return j.forEach(_i=>_i.cancel()),_t}catch(_t){throw _t[0]}}async function pZ(d,h,g){let j=null;const _t=[],_i=async _o=>{const ga=__(_o?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map(_a=>d.proxyServer?"https://".concat(d.proxyServer,"/ap/?url=").concat(_a+"/api/v2/transpond/webrtc?v=2"):"https://".concat(_a,"/api/v2/transpond/webrtc?v=2"));return _o&&(await KR(1e3),j!==null)?j:await _L({fragementLength:__("FRAGEMENT_LENGTH"),referenceList:ga,asyncMapHandler:_a=>(wE.debug("[".concat(d.clientId,"] update ticket, Connect to ").concat(_o?"backup":""," choose_server:"),_a),function(_u,_c,_l,_g){const[r_]=uZ(_c,[yR.CHOOSE_SERVER]);let l_=sR.networkState;return JI(async()=>{l_&&sR.networkState===eT.OFFLINE&&sR.onlineWaiter&&await a0.race([sR.onlineWaiter,KR(_g&&_g.maxRetryTimeout||rR.maxRetryTimeout)]),l_=sR.networkState;const d_=await NI(_u,{data:r_,cancelToken:_l,headers:{"Content-Type":"multipart/form-data;"}},!0);return cZ(d_,_u)},()=>!1,d_=>d_.code!==c_.OPERATION_ABORTED&&(d_.code===c_.UPDATE_TICKET_FAILED?d_.data.retry:(wE.warning("[".concat(_c.clientId,"] update ticket network error, retry"),d_),!0)),_g)}(_a,d,h,g)),allFailedhandler:_a=>{throw _a[0]},promisesCollector:_t})};try{return j=await sP([_i(!1),_i(!0)]),_t.length&&_t.forEach(_o=>_o.cancel&&typeof _o.cancel=="function"&&_o.cancel()),j}catch(_o){throw _o[0]}}function UW(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function FW(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?UW(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):UW(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}class hZ extends US{constructor(){super(),_h(this,"configs",void 0),_h(this,"joinInfo",void 0),_h(this,"cancelToken",void 0),_h(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),_h(this,"interval",void 0),_h(this,"mutex",new lT("config-distribute")),_h(this,"mutableParamsRead",!1)}startGetConfigDistribute(h,g){this.joinInfo=h,this.cancelToken=g,this.interval&&this.stopGetConfigDistribute(),__("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval(()=>{this.updateConfigDistribute()},__("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,p0.reportApiInvoke(null,{options:void 0,name:iR.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:kS.TRACER}).onSuccess(JSON.stringify(QN))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void wE.debug("[config-distribute] get config distribute interrupted have no joininfo");let h;const g=await this.mutex.lock();try{h=await lZ(this.joinInfo,this.cancelToken,this.retryConfig),wE.debug("[config-distribute] get config distribute",JSON.stringify(h)),h.limit_bitrate&&this.handleBitrateLimit(h.limit_bitrate),this.cacheGlobalParameterConfig(h),this.configs=h}catch(j){const _t=new f_(c_.NETWORK_RESPONSE_ERROR,j);wE.warning("[config-distribute] ".concat(_t.toString()))}finally{g()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(h){var g;(g=h)&&g.uplink&&g.id&&g.uplink.max_bitrate!==void 0&&g.uplink.min_bitrate!==void 0&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==h.id&&this.emit(gL.UPDATE_BITRATE_LIMIT,h):this.emit(gL.UPDATE_BITRATE_LIMIT,h))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&FW({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(h){var g;const j=Q3(g=Object.keys(h).filter(_i=>/^webrtc_ng_global_parameter/.test(_i))).call(g);for(let _i=0;_i<j.length;_i++)for(let _o=j.length-1;_o>_i;_o--){const ga=j[_o];if(typeof h[ga].__priority=="number"){const _a=h[ga].__priority,_u=j[_o-1];if(typeof h[_u].__priority=="number"){if(!(_a>h[_u].__priority))continue;{const _c=ga;j[_o]=j[_o-1],j[_o-1]=_c}}else{const _c=ga;j[_o]=j[_o-1],j[_o-1]=_c}}}const _t={};j.forEach(_i=>{const _o=h[_i],ga=_o.__expires;Object.keys(_o).forEach(_a=>{_a==="__priority"||_a==="__expires"||Object.prototype.hasOwnProperty.call(_t,_a)||(_t[_a]=FW({value:_o[_a]},ga&&{expires:ga}))})});try{const _i=JSON.stringify(_t),_o=window.btoa(_i);window.localStorage.setItem("websdk_ng_global_parameter",_o),wE.debug("Caching global parameters ".concat(_i))}catch(_i){wE.error("Error caching global parameters:",_i.message)}}}function BW(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function bL(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?BW(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):BW(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}class fZ extends US{constructor(h,g,j,_t){super(),_h(this,"spec",void 0),_h(this,"token",void 0),_h(this,"websocket",void 0),_h(this,"pingpongTimer",void 0),_h(this,"reconnectMode","retry"),_h(this,"serviceMode",void 0),_h(this,"reqId",0),_h(this,"commandReqId",0),_h(this,"handleWebSocketOpen",()=>{this.reconnectMode="retry",this.startPingPong()}),_h(this,"handleWebSocketMessage",_i=>{if(!_i.data)return;const _o=JSON.parse(_i.data);_o.requestId?this.emit("@".concat(_o.requestId,"-").concat(_o.sid),_o):this.serviceMode===pR.INJECT?this.emit(AI.INJECT_STREAM_STATUS,_o):(p0.workerEvent(this.spec.sid,{actionType:"status",serverCode:_o.code,workerType:this.serviceMode===pR.TRANSCODE?1:2}),this.emit(AI.PUBLISH_STREAM_STATUS,_o))}),this.spec=g,this.token=h,this.serviceMode=_t,this.websocket=new a1("live-streaming",j),this.websocket.on(x0.CONNECTED,this.handleWebSocketOpen),this.websocket.on(x0.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(x0.REQUEST_NEW_URLS,(_i,_o)=>{YR(this,AI.REQUEST_NEW_ADDRESS).then(_i).catch(_o)}),this.websocket.on(x0.RECONNECTING,()=>{this.websocket.reconnectMode=this.reconnectMode})}init(h){return this.websocket.init(h)}async request(h,g,j,_t){this.reqId+=1,h==="request"&&(this.commandReqId+=1);const _i=this.commandReqId,_o=this.reqId;if(!_o||!this.websocket)throw new f_(c_.UNEXPECTED_ERROR);const ga=bL({command:h,sdkVersion:dI==="4.18.3"?"0.0.1":dI,seq:_o,requestId:_o,allocate:j,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},g);if(this.websocket.state==="closed")throw new f_(c_.WS_DISCONNECT);const _a=()=>new a0((_g,r_)=>{this.websocket.once(x0.CLOSED,()=>r_(new f_(c_.WS_ABORT))),this.websocket.once(x0.CONNECTED,_g)});this.websocket.state!=="connected"&&await _a(),ga.clientRequest&&(ga.clientRequest.workerToken=this.token);const _u=new a0((_g,r_)=>{const l_=()=>{r_(new f_(c_.WS_ABORT))};this.websocket.once(x0.RECONNECTING,l_),this.websocket.once(x0.CLOSED,l_),this.once("@".concat(_o,"-").concat(this.spec.sid),d_=>{_g(d_)})});_t&&p0.workerEvent(this.spec.sid,bL(bL({},_t),{},{requestId:_i,actionType:"request",payload:JSON.stringify(g.clientRequest),serverCode:0,code:0}));const _c=Date.now();this.websocket.sendMessage(ga);let _l=null;try{_l=await _u}catch(_g){if(this.websocket.state==="closed")throw _g;return await _a(),await this.request(h,g,j)}return _t&&p0.workerEvent(this.spec.sid,bL(bL({},_t),{},{requestId:_i,actionType:"response",payload:JSON.stringify(_l.serverResponse),serverCode:_l.code,success:_l.code===200,responseTime:Date.now()-_c})),_l.code!==200&&this.handleResponseError(_l),_l}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const h=dI==="4.18.3"?"0.0.1":dI;this.reqId+=1,this.websocket.state==="connected"?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:h,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(h){switch(h.code){case JS.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void wE.warning("live stream response already exists stream");case JS.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case JS.LIVE_STREAM_RESPONSE_BAD_STREAM:case JS.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new f_(c_.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:h.code}).throw();case JS.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if(h.serverResponse.command==="UnpublishStream"||h.serverResponse.command==="UninjectStream")return;throw new f_(c_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case JS.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new f_(c_.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:h.code}).throw();case JS.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const g=new f_(c_.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(AI.WARNING,g,h.serverResponse.url)}case JS.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const g=new f_(c_.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(AI.WARNING,g,h.serverResponse.url)}case JS.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new f_(c_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case JS.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new f_(c_.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:h.code}).throw();case JS.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const g=new f_(c_.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(AI.WARNING,g,h.serverResponse.url)}case JS.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new f_(c_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:h.code}).throw();case JS.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new f_(c_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case JS.LIVE_STREAM_RESPONSE_WORKER_LOST:case JS.LIVE_STREAM_RESPONSE_WORKER_QUIT:if(h.serverResponse.command==="UnpublishStream"||h.serverResponse.command==="UninjectStream")return;throw new f_(c_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case JS.ERROR_FAIL_SEND_MESSAGE:if(h.serverResponse.command==="UnpublishStream"||h.serverResponse.command==="UninjectStream")return;if(h.serverResponse.command==="UpdateTranscoding"||h.serverResponse.command==="ControlStream")return new f_(c_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:h.code}).throw();throw new f_(c_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case JS.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case JS.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case JS.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case JS.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new f_(c_.LIVE_STREAMING_CDN_ERROR,"",{code:h.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(()=>{this.websocket.state==="connected"&&this.request("ping",{}).catch(UU)},6e3)}}function VW(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function _T(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?VW(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):VW(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}class mZ extends US{constructor(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rR,j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:rR;super(),_h(this,"onLiveStreamWarning",void 0),_h(this,"onLiveStreamError",void 0),_h(this,"onInjectStatusChange",void 0),_h(this,"spec",void 0),_h(this,"retryTimeout",1e4),_h(this,"connection",void 0),_h(this,"httpRetryConfig",void 0),_h(this,"wsRetryConfig",void 0),_h(this,"streamingTasks",new Map),_h(this,"isStartingStreamingTask",!1),_h(this,"taskMutex",new lT("live-streaming")),_h(this,"cancelToken",KT.CancelToken.source()),_h(this,"transcodingConfig",void 0),_h(this,"injectConfig",_T({},PX)),_h(this,"injectLoopTimes",0),_h(this,"uapResponse",void 0),_h(this,"lastTaskId",1),_h(this,"statusError",new Map),this.spec=h,this.httpRetryConfig=j,this.wsRetryConfig=g}async setTranscodingConfig(h){const g=_T(_T({},kX),h);g.videoCodecProfile!==66&&g.videoCodecProfile!==77&&g.videoCodecProfile!==100&&(wE.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(g.videoCodecProfile," -> 100")),g.videoCodecProfile=100),g.transcodingUsers||(g.transcodingUsers=g.userConfigs),g.transcodingUsers&&(g.transcodingUsers=g.transcodingUsers.map(_o=>_T(_T(_T({},NX),_o),{},{zOrder:_o.zOrder?_o.zOrder+1:1}))),function(_o){AS(_o.width)||SS(_o.width,"config.width",0,1e4),AS(_o.height)||SS(_o.height,"config.height",0,1e4),AS(_o.videoBitrate)||SS(_o.videoBitrate,"config.videoBitrate",1,1e6),AS(_o.videoFrameRate)||SS(_o.videoFrameRate,"config.videoFrameRate"),AS(_o.lowLatency)||J1(_o.lowLatency,"config.lowLatency"),AS(_o.audioSampleRate)||IR(_o.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),AS(_o.audioBitrate)||SS(_o.audioBitrate,"config.audioBitrate",1,128),AS(_o.audioChannels)||IR(_o.audioChannels,"config.audioChannels",[1,2,3,4,5]),AS(_o.videoGop)||SS(_o.videoGop,"config.videoGop"),AS(_o.videoCodecProfile)||IR(_o.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),AS(_o.userCount)||SS(_o.userCount,"config.userCount",0,17),AS(_o.backgroundColor)||SS(_o.backgroundColor,"config.backgroundColor",0,16777215),AS(_o.userConfigExtraInfo)||GR(_o.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),_o.transcodingUsers&&!AS(_o.transcodingUsers)&&(UO(_o.transcodingUsers,"config.transcodingUsers"),_o.transcodingUsers.forEach((ga,_a)=>{t5(ga.uid),AS(ga.x)||SS(ga.x,"transcodingUser[".concat(_a,"].x"),0,1e4),AS(ga.y)||SS(ga.y,"transcodingUser[".concat(_a,"].y"),0,1e4),AS(ga.width)||SS(ga.width,"transcodingUser[".concat(_a,"].width"),0,1e4),AS(ga.height)||SS(ga.height,"transcodingUser[".concat(_a,"].height"),0,1e4),AS(ga.zOrder)||SS(ga.zOrder-1,"transcodingUser[".concat(_a,"].zOrder"),0,100),AS(ga.alpha)||SS(ga.alpha,"transcodingUser[".concat(_a,"].alpha"),0,1,!1)})),AS(_o.watermark)||c5(_o.watermark,"watermark"),AS(_o.backgroundImage)||c5(_o.backgroundImage,"backgroundImage"),_o.images&&!AS(_o.images)&&(UO(_o.images,"config.images"),_o.images.forEach((ga,_a)=>{c5(ga,"images[".concat(_a,"]"))}))}(g);const j=[];g.images&&j.push(...g.images.map(_o=>_T(_T(_T({},a5),_o),{},{zOrder:255}))),g.backgroundImage&&(j.push(_T(_T(_T({},a5),g.backgroundImage),{},{zOrder:0})),delete g.backgroundImage),g.watermark&&(j.push(_T(_T(_T({},a5),g.watermark),{},{zOrder:255})),delete g.watermark),g.images=j,g.transcodingUsers&&(g.userConfigs=g.transcodingUsers.map(_o=>_T({},_o)),g.userCount=g.transcodingUsers.length,delete g.transcodingUsers);const _t=(g.userConfigs||[]).map(_o=>typeof _o.uid=="number"?a0.resolve(_o.uid):LW(_o.uid,this.spec,this.cancelToken.token,this.httpRetryConfig));if((await a0.all(_t)).forEach((_o,ga)=>{g.userConfigs&&g.userConfigs[ga]&&(g.userConfigs[ga].uid=_o)}),this.transcodingConfig=g,this.connection)try{var _i;const _o=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(mO(_i=this.streamingTasks).call(_i)).map(ga=>ga.taskId).join("#")});wE.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(_o.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(_o){if(!_o.data||!_o.data.retry)throw _o;_o.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach(ga=>{wE.warning("[".concat(this.spec.clientId,"] live streaming receive error"),_o.toString(),"try to republish",ga.url),this.startLiveStreamingTask(ga.url,ga.mode,_o).then(()=>{wE.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(ga.url," success"))}).catch(_a=>{wE.error("[".concat(this.spec.clientId,"] live streaming republish failed"),ga.url,_a.toString()),this.onLiveStreamError&&this.onLiveStreamError(ga.url,_a)})})}}setInjectStreamConfig(h,g){this.injectConfig=Object.assign({},this.injectConfig,h),this.injectLoopTimes=g}async startLiveStreamingTask(h,g,j){var _t;if(Array.from(mO(_t=this.streamingTasks).call(_t)).find(_a=>_a.mode===pR.INJECT)&&g===pR.INJECT)return new f_(c_.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&g===pR.TRANSCODE)throw new f_(c_.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let _i={command:"PublishStream",ts:Date.now(),url:h,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};wE.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(h,", mode: ").concat(g));const _o=await this.taskMutex.lock();if(!this.connection&&j)return void _o();if(this.streamingTasks.get(h)&&!j)return _o(),new f_(c_.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(g))}catch(_a){throw _o(),_a}switch(g){case pR.TRANSCODE:_i.transcodingConfig=_T({},this.transcodingConfig);break;case pR.RAW:break;case pR.INJECT:_i={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:h,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(_i.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const ga=this.lastTaskId++;try{const _a=new a0((_c,_l)=>{KR(this.retryTimeout).then(()=>{if(j)return _l(j);const _g=this.statusError.get(h);return _g?(this.statusError.delete(h),_l(_g)):void 0})}),_u=await a0.race([this.connection.request("request",{clientRequest:_i},!0,{url:h,command:"PublishStream",workerType:g===pR.TRANSCODE?1:2,requestByUser:!j,tid:ga.toString()}),_a]);this.isStartingStreamingTask=!1,wE.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(_u.code)),this.streamingTasks.set(h,{clientRequest:_i,mode:g,url:h,taskId:ga}),_o()}catch(_a){if(_o(),this.isStartingStreamingTask=!1,!_a.data||!_a.data.retry||j)throw _a;return _a.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(h,g,_a)):await this.startLiveStreamingTask(h,g,_a)}}stopLiveStreamingTask(h){return new a0((g,j)=>{const _t=this.streamingTasks.get(h);if(!_t||!this.connection)return new f_(c_.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const _i=_t.mode;_t.abortTask=()=>{wE.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(h),g()},this.connection.request("request",{clientRequest:{command:_i===pR.INJECT?"UninjectStream":"UnpublishStream",url:_t.url}},!1,{url:h,command:"UnPublishStream",workerType:_i===pR.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then(_o=>{wE.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(_o.code)),this.streamingTasks.delete(h),this.streamingTasks.size===0&&_i!==pR.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),g(),_i===pR.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(cN.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,h)}).catch(j)})}async controlInjectStream(h,g,j,_t){const _i=this.streamingTasks.get(h);if(!_i||!this.connection||_i.mode!==pR.INJECT)throw new f_(c_.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:h,control:g,audioVolume:j,position:_t}})).serverResponse}resetAllTask(){var h;const g=Array.from(mO(h=this.streamingTasks).call(h));this.terminate();for(const j of g)this.startLiveStreamingTask(j.url,j.mode).catch(_t=>{this.onLiveStreamError&&this.onLiveStreamError(j.url,_t)})}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=KT.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(h){if(this.connection)throw new f_(c_.UNEXPECTED_ERROR,"live streaming connection has already connected");const g=await YR(this,Q1.REQUEST_WORKER_MANAGER_LIST,h);return this.uapResponse=g,this.connection=new fZ(g.workerToken,this.spec,this.wsRetryConfig,h),this.connection.on(AI.WARNING,(j,_t)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(_t,j)),this.connection.on(AI.PUBLISH_STREAM_STATUS,j=>this.handlePublishStreamServer(j)),this.connection.on(AI.INJECT_STREAM_STATUS,j=>this.handleInjectStreamServerStatus(j)),this.connection.on(AI.REQUEST_NEW_ADDRESS,(j,_t)=>{if(!this.connection)return _t(new f_(c_.UNEXPECTED_ERROR,"can not get new live streaming address list"));YR(this,Q1.REQUEST_WORKER_MANAGER_LIST,h).then(_i=>{this.uapResponse=_i,j(_i.addressList)}).catch(_t)}),await this.connection.init(g.addressList),this.connection}handlePublishStreamServer(h){const g=h.serverStatus&&h.serverStatus.url||"empty_url",j=this.streamingTasks.get(g),_t=h.reason;switch(h.code){case JS.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case JS.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case JS.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case JS.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const _o=new f_(c_.LIVE_STREAMING_CDN_ERROR,"",{code:h.code});if(j)return wE.error(_o.toString()),this.onLiveStreamError&&this.onLiveStreamError(g,_o);if(!this.isStartingStreamingTask)return;this.statusError.set(g,_o)}case JS.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const _o=new f_(c_.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,_t);return this.onLiveStreamWarning&&this.onLiveStreamWarning(g,_o)}case JS.LIVE_STREAM_RESPONSE_WORKER_LOST:case JS.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var _i;if(!this.connection)return;this.connection.tryNextAddress();const _o=Array.from(mO(_i=this.streamingTasks).call(_i));for(const ga of _o)ga.abortTask?ga.abortTask():(wE.warning("[".concat(this.spec.clientId,"] publish stream status code"),h.code,"try to republish",ga.url),this.startLiveStreamingTask(ga.url,ga.mode,new f_(c_.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:h.code})).then(()=>{wE.debug("[".concat(this.spec.clientId,"] republish live stream success"),ga.url)}).catch(_a=>{wE.error(_a.toString()),this.onLiveStreamError&&this.onLiveStreamError(ga.url,_a)}));return}}}handleInjectStreamServerStatus(h){const g=Number(h.uid),j=h.serverStatus&&h.serverStatus.url;switch(h.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(cN.INJECT_STREAM_STATUS_START_SUCCESS,g,j));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(cN.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,g,j),void this.streamingTasks.delete(j);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(cN.INJECT_STREAM_STATUS_START_UNAUTHORIZED,g,j),void this.streamingTasks.delete(j);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(cN.INJECT_STREAM_STATUS_BROKEN,g,j),void this.streamingTasks.delete(j);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(cN.INJECT_STREAM_STATUS_START_TIMEOUT,g,j),void this.streamingTasks.delete(j);default:return void wE.debug("inject stream server status",h)}}hasUrl(h){return this.streamingTasks.has(h)}}class GW{constructor(){_h(this,"destChannelMediaInfos",new Map),_h(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(h){x4(h),this.srcChannelMediaInfo=h}addDestChannelInfo(h){x4(h),this.destChannelMediaInfos.set(h.channelName,h)}removeDestChannelInfo(h){e5(h),this.destChannelMediaInfos.delete(h)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function $W(d){if(!(d instanceof GW))return new f_(c_.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const h=d.getSrcChannelMediaInfo(),g=d.getDestChannelMediaInfo();if(!h)return new f_(c_.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw();if(g.size===0)return new f_(c_.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw()}class gZ extends US{constructor(h,g,j){super(),_h(this,"ws",void 0),_h(this,"requestId",1),_h(this,"heartBeatTimer",void 0),_h(this,"joinInfo",void 0),_h(this,"clientId",void 0),_h(this,"onOpen",()=>{this.emit("open"),this.startHeartBeatCheck()}),_h(this,"onClose",_t=>{this.emit("close"),this.dispose()}),_h(this,"onMessage",_t=>{const _i=JSON.parse(_t.data);if(!_i||_i.command!=="serverResponse"||!_i.requestId)return _i&&_i.command==="serverStatus"&&_i.serverStatus&&_i.serverStatus.command?(this.emit("status",_i.serverStatus),void this.emit(_i.serverStatus.command,_i.serverStatus)):void 0;this.emit("req_".concat(_i.requestId),_i)}),this.joinInfo=h,this.clientId=g,this.ws=new a1("cross-channel-".concat(this.clientId),j),this.ws.on(x0.RECONNECTING,()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")}),this.ws.on(x0.CONNECTED,this.onOpen),this.ws.on(x0.ON_MESSAGE,this.onMessage),this.ws.on(x0.CLOSED,this.onClose)}isConnect(){return this.ws.state==="connected"}sendMessage(h){const g=this.requestId++;return h.requestId=g,h.seq=g,this.ws.sendMessage(h),g}waitStatus(h){return new a0((g,j)=>{const _t=window.setTimeout(()=>{j(new f_(c_.TIMEOUT,"wait status timeout, status: ".concat(h)))},5e3);this.once(h,_i=>{window.clearTimeout(_t),_i.state&&_i.state!==0?j(new f_(c_.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(h))):g(void 0)}),this.once("dispose",()=>{window.clearTimeout(_t),j(new f_(c_.WS_ABORT))})})}async request(h){if(this.ws.state==="closed")throw new f_(c_.WS_DISCONNECT);const g=()=>new a0((_o,ga)=>{this.ws.once(x0.CLOSED,()=>ga(new f_(c_.WS_ABORT))),this.ws.once(x0.CONNECTED,_o)});this.ws.state!=="connected"&&await g();const j=this.sendMessage(h),_t=new a0((_o,ga)=>{const _a=()=>{ga(new f_(c_.WS_ABORT))};this.ws.once(x0.RECONNECTING,_a),this.ws.once(x0.CLOSED,_a),this.once("req_".concat(j),_o),KR(3e3).then(()=>{this.removeAllListeners("req_".concat(j)),this.ws.off(x0.RECONNECTING,_a),this.ws.off(x0.CLOSED,_a),ga(new f_(c_.TIMEOUT,"cross channel ws request timeout"))})}),_i=await _t;if(!_i||_i.code!==200)throw new f_(c_.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(_i)));return _i}async connect(h){this.ws.removeAllListeners(x0.REQUEST_NEW_URLS),this.ws.on(x0.REQUEST_NEW_URLS,g=>{g(h)}),await this.ws.init(h)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(h){const g=this.requestId++;return h.requestId=g,this.ws.sendMessage(h),g}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval(()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})},3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class EZ extends US{set state(h){h!==this._state&&(h!==uT.RELAY_STATE_FAILURE&&(this.errorCode=uN.RELAY_OK),this.emit("state",h,this.errorCode),this._state=h)}get state(){return this._state}constructor(h,g,j,_t,_i){super(),_h(this,"joinInfo",void 0),_h(this,"sid",void 0),_h(this,"clientId",void 0),_h(this,"cancelToken",KT.CancelToken.source()),_h(this,"workerToken",void 0),_h(this,"requestId",0),_h(this,"signal",void 0),_h(this,"prevChannelMediaConfig",void 0),_h(this,"httpRetryConfig",void 0),_h(this,"_resolution",void 0),_h(this,"_state",uT.RELAY_STATE_IDLE),_h(this,"errorCode",uN.RELAY_OK),_h(this,"onStatus",_o=>{wE.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(_o))),_o&&_o.command&&(_o.command==="onAudioPacketReceived"&&this.emit("event",XI.PACKET_RECEIVED_AUDIO_FROM_SRC),_o.command==="onVideoPacketReceived"&&this.emit("event",XI.PACKET_RECEIVED_VIDEO_FROM_SRC),_o.command==="onSrcTokenPrivilegeDidExpire"&&(this.errorCode=uN.SRC_TOKEN_EXPIRED,this.state=uT.RELAY_STATE_FAILURE),_o.command==="onDestTokenPrivilegeDidExpire"&&(this.errorCode=uN.DEST_TOKEN_EXPIRED,this.state=uT.RELAY_STATE_FAILURE))}),_h(this,"onReconnect",async()=>{wE.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",XI.NETWORK_DISCONNECTED),this.state=uT.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch(_o=>{this.state!==uT.RELAY_STATE_IDLE&&(wE.error("auto restart channel media relay failed",_o.toString()),this.errorCode=uN.SERVER_CONNECTION_LOST,this.state=uT.RELAY_STATE_FAILURE)})}),this.joinInfo=h,this.clientId=g,this.sid=O5(),this.signal=new gZ(this.joinInfo,this.clientId,j),this.httpRetryConfig=_t,this._resolution=_i}async startChannelMediaRelay(h){if(this.state!==uT.RELAY_STATE_IDLE)throw new f_(c_.INVALID_OPERATION);this.state=uT.RELAY_STATE_CONNECTING,await this.connect(),wE.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(h)}catch(g){throw g.data&&g.data.serverResponse&&g.data.serverResponse.command==="SetSourceChannel"?new f_(c_.CROSS_CHANNEL_FAILED_JOIN_SRC):g.data&&g.data.serverResponse&&g.serverResponse.command==="SetDestChannelStatus"?new f_(c_.CROSS_CHANNEL_FAILED_JOIN_DEST):g.data&&g.data.serverResponse&&g.serverResponse.command==="StartPacketTransfer"?new f_(c_.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST):g}this.prevChannelMediaConfig=h}async updateChannelMediaRelay(h){if(this.state!==uT.RELAY_STATE_RUNNING)throw new f_(c_.INVALID_OPERATION);await this.sendUpdateMessage(h),this.prevChannelMediaConfig=h}async setVideoProfile(h){if(this._resolution=h,this.state!==uT.RELAY_STATE_RUNNING)throw new f_(c_.INVALID_OPERATION);const g=this.genMessage(HR.SetVideoProfile);await this.signal.request(g),wE.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),wE.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=uT.RELAY_STATE_IDLE,this.dispose()}dispose(){wE.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=KT.CancelToken.source(),this.state=uT.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const h=await dZ(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=h.workerToken,await this.signal.connect(h.addressList),this.emit("event",XI.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(h){const g=this.genMessage(HR.StopPacketTransfer);await this.signal.request(g),await this.signal.waitStatus("Normal Quit"),wE.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const j=this.genMessage(HR.SetSdkProfile,h);await this.signal.request(j),wE.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const _t=this.genMessage(HR.SetSourceChannel,h);await this.signal.request(_t),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",XI.PACKET_JOINED_SRC_CHANNEL),wE.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const _i=this.genMessage(HR.SetSourceUserId,h);await this.signal.request(_i),wE.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const _o=this.genMessage(HR.SetDestChannel,h);await this.signal.request(_o),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",XI.PACKET_JOINED_DEST_CHANNEL),wE.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const ga=this.genMessage(HR.StartPacketTransfer,h);await this.signal.request(ga),this.emit("event",XI.PACKET_SENT_TO_DEST_CHANNEL),this.state=uT.RELAY_STATE_RUNNING,wE.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(h){const g=this.genMessage(HR.UpdateDestChannel,h);await this.signal.request(g),this.emit("event",XI.PACKET_UPDATE_DEST_CHANNEL),wE.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const h=this.genMessage(HR.StopPacketTransfer);await this.signal.request(h),wE.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(h,g){const j=[],_t=[],_i=[];this.requestId+=1;const _o={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:dI,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};_o.sdkVersion==="4.18.3"&&(_o.sdkVersion="0.0.1");let ga=null,_a=null;switch(h){case HR.SetSdkProfile:return _o.clientRequest={command:"SetSdkProfile",type:"multi_channel"},_o;case HR.SetSourceChannel:if(_a=g&&g.getSrcChannelMediaInfo(),!_a)throw new f_(c_.UNEXPECTED_ERROR,"can not find source config");return _o.clientRequest={command:"SetSourceChannel",uid:"0",channelName:_a.channelName,token:_a.token||this.joinInfo.appId},_o;case HR.SetSourceUserId:if(_a=g&&g.getSrcChannelMediaInfo(),!_a)throw new f_(c_.UNEXPECTED_ERROR,"can not find source config");return _o.clientRequest={command:"SetSourceUserId",uid:_a.uid+""},_o;case HR.SetDestChannel:if(ga=g&&g.getDestChannelMediaInfo(),!ga)throw new f_(c_.UNEXPECTED_ERROR,"can not find dest config");return ga.forEach(_u=>{j.push(_u.channelName),_t.push(_u.uid+""),_i.push(_u.token||this.joinInfo.appId)}),_o.clientRequest={command:"SetDestChannel",channelName:j,uid:_t,token:_i},_o;case HR.StartPacketTransfer:return _o.clientRequest={command:"StartPacketTransfer"},_o;case HR.Reconnect:return _o.clientRequest={command:"Reconnect"},_o;case HR.StopPacketTransfer:return _o.clientRequest={command:"StopPacketTransfer"},_o;case HR.UpdateDestChannel:if(ga=g&&g.getDestChannelMediaInfo(),!ga)throw new f_(c_.UNEXPECTED_ERROR,"can not find dest config");return ga.forEach(_u=>{j.push(_u.channelName),_t.push(_u.uid+""),_i.push(_u.token||this.joinInfo.appId)}),_o.clientRequest={command:"UpdateDestChannel",channelName:j,uid:_t,token:_i},_o;case HR.SetVideoProfile:_o.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return _o}}const j5=d=>{const h=document.createElement("canvas");return h.width=2,h.height=2,new a0((g,j)=>{h.toBlob(async _t=>{if(h.remove(),_t){const _i=await WW(_t);g({buffer:_i,width:h.width,height:h.height})}else j(new f_(c_.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},d,1)})},WW=async d=>{const h=await d.arrayBuffer();return new Uint8Array(h)};function HW(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function qW(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?HW(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):HW(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}class U5{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(h){h!==this._videoElementStatus&&(wE.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(h)),this._videoElementStatus=h)}constructor(h){_h(this,"trackId",void 0),_h(this,"config",void 0),_h(this,"onFirstVideoFrameDecoded",void 0),_h(this,"freezeTimeCounterList",[]),_h(this,"renderFreezeAccTime",0),_h(this,"isKeepLastFrame",!1),_h(this,"timeUpdatedCount",0),_h(this,"freezeTime",0),_h(this,"playbackTime",0),_h(this,"lastTimeUpdatedTime",0),_h(this,"autoplayFailed",!1),_h(this,"videoTrack",void 0),_h(this,"videoElement",void 0),_h(this,"cacheVideoElement",void 0),_h(this,"videoElementCheckInterval",void 0),_h(this,"_videoElementStatus",$R.NONE),_h(this,"isGettingVideoDimensions",!1),_h(this,"startGetVideoDimensions",()=>{const g=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return wE.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(g,500)};!this.isGettingVideoDimensions&&g()}),_h(this,"autoResumeAfterInterruption",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&cS.curState==="running"&&(wE.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(R2())),O2()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),_h(this,"handleVideoEvents",g=>{switch(g.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=$R.PLAYING;break;case"loadeddata":if(this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch{}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=$R.CANPLAY;break;case"stalled":this.videoElementStatus=$R.STALLED;break;case"suspend":this.videoElementStatus=$R.SUSPEND;break;case"pause":this.videoElementStatus=$R.PAUSED,aT()||hO()||sT()&&this.autoplayFailed||!this.videoTrack||this.videoTrack.readyState!=="live"||(wE.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=$R.WAITING;break;case"abort":this.videoElementStatus=$R.ABORT;break;case"ended":this.videoElementStatus=$R.ENDED;break;case"emptied":this.videoElementStatus=$R.EMPTIED;break;case"error":{this.videoElementStatus=$R.ERROR;const j=this.videoElement.error;j&&wE.error("[".concat(this.trackId,"] media error, code: ").concat(j.code,", message: ").concat(j.message));break}case"timeupdate":{const j=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=j);const _t=j-this.lastTimeUpdatedTime,_i=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=j,BO.lastVisibleTime<BO.lastHiddenTime||_i<BO.lastHiddenTime||_i<BO.lastVisibleTime)return;for(_t>__("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=_t),this.playbackTime+=_t;this.playbackTime>=6e3;){this.playbackTime-=6e3;const _o=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(_o),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}}),_h(this,"autoResumeAfterInterruptionOnIOS15_16",()=>{this.videoTrack&&this.videoTrack.readyState==="live"&&(wE.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(R2())),O2()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))}),this.trackId=h.trackId,this.config=h,h.element instanceof HTMLVideoElement?this.videoElement=h.element:this.videoElement=document.createElement("video"),cS.on(bR.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),cS.on(bR.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var h;return(h=this.videoElement.parentElement)!==null&&h!==void 0?h:void 0}updateConfig(h){this.config=h,this.trackId=h.trackId,h.element!==this.videoElement&&(this.destroy(),this.videoElement=h.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(h){this.videoTrack!==h&&(this.videoTrack=h,this.initVideoElement())}play(h){const g=this.videoElement.play();g&&g.catch&&g.catch(_t=>{h&&p0.autoplayFailed(h,"video",_t.message,this.trackId),_t.name==="NotAllowedError"?(wE.warning("detected video element autoplay failed",_t),this.autoplayFailed=!0,this.handleAutoPlayFailed()):wE.warning("[".concat(this.trackId,"] play warning: "),_t)});const j=sS();if((j.name==="Safari"&&Number(j.version)===15||G1())&&g&&g.then&&g.catch){const _t=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};g.then(_t).catch(_t)}}getCurrentFrame(){const h=document.createElement("canvas");h.width=this.videoElement.videoWidth,h.height=this.videoElement.videoHeight;const g=h.getContext("2d");if(!g)return wE.error("create canvas context failed!"),new ImageData(2,2);g.drawImage(this.videoElement,0,0,h.width,h.height);const j=g.getImageData(0,0,h.width,h.height);return h.remove(),j}async getCurrentFrameToUint8Array(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const j=document.createElement("canvas");j.width=this.videoElement.videoWidth,j.height=this.videoElement.videoHeight;const _t=j.getContext("2d");return _t?(_t.drawImage(this.videoElement,0,0,j.width,j.height),new a0((_i,_o)=>{j.toBlob(async ga=>{if(j.remove(),ga){const _a=await WW(ga);_i({buffer:_a,width:j.width,height:j.height})}else _o(new f_(c_.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))},h,g<0?.1:g>1?1:g)})):await j5(h)}destroy(){cS.off(bR.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),cS.off(bR.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[]}initVideoElement(){if(this.videoElementStatus=$R.INIT,!this.videoElementCheckInterval&&(zW.forEach(_i=>{this.videoElement.addEventListener(_i,this.handleVideoEvents)}),this.videoElementCheckInterval=window.setInterval(()=>{(function(_i){return _i!==document.body&&document.body.contains(_i)})(this.videoElement)||(this.videoElementStatus=$R.DESTROYED)},1e3),__("ENABLE_VIDEO_FRAME_CALLBACK"))){var h,g;let _i;const _o=(ga,_a)=>{if(this.videoElementStatus===$R.PLAYING){if(_i){const _l=_a.presentationTime-_i.presentationTime;_l>__("VIDEO_FREEZE_DURATION")&&BO.lastVisibleTime>=BO.lastHiddenTime&&_i.timestamp>BO.lastVisibleTime&&_i.timestamp>BO.lastHiddenTime&&(this.renderFreezeAccTime+=_l)}_i=qW(qW({},_a),{},{timestamp:ga})}var _u,_c;__("ENABLE_VIDEO_FRAME_CALLBACK")&&((_u=(_c=this.videoElement).requestVideoFrameCallback)===null||_u===void 0||_u.call(_c,_o))};(h=(g=this.videoElement).requestVideoFrameCallback)===null||h===void 0||h.call(g,_o)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),hU()&&(this.videoElement.poster="noposter");const j=sS();j.name==="Safari"&&Number(j.version)===15||G1()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,GS()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,GS()&&this.videoElement.load());const _t=this.videoElement.play();_t!==void 0&&_t.catch(_i=>{wE.debug("[".concat(this.trackId,"] playback interrupted"),_i.toString())})}resetVideoElement(){zW.forEach(h=>{this.videoElement&&this.videoElement.removeEventListener(h,this.handleVideoEvents)}),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=$R.NONE}handleAutoPlayFailed(){const h=g=>{g.preventDefault(),this.videoElement.play().then(()=>{wE.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))}).catch(j=>{wE.error(j)}),this.autoplayFailed=!1,uL()?document.body.removeEventListener("click",h,!0):(document.body.removeEventListener("touchstart",h,!0),document.body.removeEventListener("mousedown",h,!0))};uL()?document.body.addEventListener("click",h,!0):(document.body.addEventListener("touchstart",h,!0),document.body.addEventListener("mousedown",h,!0)),J4()}}const zW=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class KW extends U5{constructor(h){super(h),_h(this,"container",void 0),_h(this,"slot",void 0),this.slot=h.element,this.updateConfig(h)}updateConfig(h){this.config=h,this.trackId=h.trackId;const g=h.element;g!==this.slot&&(this.destroy(),this.slot=g),this.createElements()}updateVideoTrack(h){this.videoTrack!==h&&(this.videoTrack=h,this.createElements())}play(h){var g;(g=this.container)!==null&&g!==void 0&&g.contains(this.videoElement)&&super.play(h)}getCurrentFrame(){var h;return(h=this.container)!==null&&h!==void 0&&h.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(h){var g;let j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return(g=this.container)!==null&&g!==void 0&&g.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(h,j):await j5(h)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch{}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",__("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var h;!this.container||(h=this.container)!==null&&h!==void 0&&h.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var h;if((h=this.container)!==null&&h!==void 0&&h.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch{}this.videoElement=document.createElement("video")}}resetVideoElement(){var h;(h=this.container)!==null&&h!==void 0&&h.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}function $U(d){const h={};d.facingMode&&(h.facingMode=d.facingMode),d.cameraId&&(h.deviceId={exact:d.cameraId});const g=XN(d.encoderConfig);return h.width=g.width,h.height=g.height,!N2()&&g.frameRate&&(h.frameRate=g.frameRate),sS().name===dS.EDGE&&typeof h.frameRate=="object"&&(h.frameRate.max=60),GS()&&(h.frameRate={ideal:30,max:30}),h}function vZ(d){const h={};d.screenSourceType&&(h.mediaSource=d.screenSourceType),d.extensionId&&T3()&&(h.extensionId=d.extensionId);const{displaySurface:g,selfBrowserSurface:j,surfaceSwitching:_t,systemAudio:_i}=d;(w3(107)||T2(107)||w2(93))&&(g&&(IR(g,"displaySurface",["browser","window","monitor"]),h.displaySurface=g),j?(IR(j,"selfBrowserSurface",["exclude","include"]),h.selfBrowserSurface=j):h.selfBrowserSurface="include",_t&&(IR(_t,"surfaceSwitching",["exclude","include"]),h.surfaceSwitching=_t)),(w3(105)||T2(105)||w2(91))&&_i&&(IR(_i,"systemAudio",["exclude","include"]),h.systemAudio=_i),d.electronScreenSourceId&&(h.sourceId=d.electronScreenSourceId);const _o=d.encoderConfig?q3(d.encoderConfig):null;return h.mandatory={chromeMediaSource:"desktop",maxWidth:_o?_o.width:void 0,maxHeight:_o?_o.height:void 0},_o&&(_o.frameRate&&(typeof _o.frameRate=="number"?(h.mandatory.maxFrameRate=_o.frameRate,h.mandatory.minFrameRate=_o.frameRate):(h.mandatory.maxFrameRate=_o.frameRate.max||_o.frameRate.ideal||_o.frameRate.exact||void 0,h.mandatory.minFrameRate=_o.frameRate.min||_o.frameRate.ideal||_o.frameRate.exact||void 0),h.frameRate=_o.frameRate),_o.width&&(h.width=_o.width),_o.height&&(h.height=_o.height)),h}function YW(d){const h={};if(N2()||(d.AGC!==void 0&&(h.autoGainControl=d.AGC),d.AEC!==void 0&&(h.echoCancellation=d.AEC),d.ANS!==void 0&&(h.noiseSuppression=d.ANS,T3()&&d.ANS&&(h.googHighpassFilter=d.ANS))),d.encoderConfig){const g=wU(d.encoderConfig);h.channelCount=g.stereo?2:1,h.sampleRate=g.sampleRate,h.sampleSize=g.sampleSize}return d.microphoneId&&(h.deviceId={exact:d.microphoneId}),hU()&&(h.sampleRate=void 0),h}var cP,WU;(function(d){d.COVERED="COVERED",d.POSITION="POSITION",d.SIZE="SIZE",d.STYLE="STYLE"})(cP||(cP={})),function(d){d.UNMOUNTED="UNMOUNTED",d.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(WU||(WU={}));var JW,XW,QW,ZW,e8,t8,n8,r8,i8,o8,s8,a8,c8,u8,l8,d8,p8,h8,f8,m8,g8,E8,v8,_8,G0,y8,b8,S8,R8,T8,w8,C8,I8,mI,O8=new class{constructor(){_h(this,"_clientSize",null),_h(this,"getClientWidth",()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth),_h(this,"getClientHeight",()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight),_h(this,"getStyle",d=>window.getComputedStyle(d,null)),_h(this,"checkCssVisibleProperty",d=>{let h=!0;const g=this.getStyle(d),{display:j,visibility:_t,opacity:_i,filter:_o}=g;return(j==="none"||["hidden","collapse"].includes(_t)||Number(_i)<.1)&&(h=!1),h?(_o&&_o.split(" ").filter(ga=>{const _a=ga.split("(")[0];return["brightness","blur","opacity"].includes(_a)}).map(ga=>{const[_a,_u]=ga.split(/\(|\)/);return[_a,Number(_u.match(/^[0-9\.]+/))]}).forEach(ga=>{const[_a,_u]=ga;switch(_a){case"brightness":(_u<.1||_u>3)&&(h=!1);break;case"blur":_u>3&&(h=!1);break;case"opacity":_u<.1&&(h=!1)}}),h):!1}),_h(this,"checkPropertyUpToAllParentNodes",(d,h)=>{let g=!0,j=!0;const _t=_o=>h(_o);let _i=d;for(;_i&&j;)_t(_i)||(g=!1,j=!1),_i=_i.parentElement,_i||(j=!1);return g}),_h(this,"checkActualCssVisibleIncludeInherit",d=>this.checkPropertyUpToAllParentNodes(d,this.checkCssVisibleProperty)),_h(this,"getSizeAboutClient",d=>{const{width:h,height:g,left:j,right:_t,top:_i,bottom:_o}=d.getBoundingClientRect(),ga=this.getClientWidth(),_a=this.getClientHeight();return{width:h,height:g,left:j,right:_t,top:_i,bottom:_o,clientWidth:ga,clientHeight:_a,clientMin:Math.min(ga,_a)}}),_h(this,"checkActualSize",()=>{const{width:d,height:h,clientMin:g}=this._clientSize;return this.checkSizeIsVisible(d,h,g)}),_h(this,"elementFromPoint",(d,h)=>document.elementFromPoint?document.elementFromPoint(d,h):null),_h(this,"checkCoverForAPoint",(d,h,g)=>{const j=this.elementFromPoint(d,h);return j!==null&&j!==g}),_h(this,"getPointPositionList",()=>{const{width:d,height:h,left:g,top:j}=this._clientSize,_t=d/6,_i=h/6,_o=[],ga=10**6;for(let _a=0;_a<5;_a++)for(let _u=0;_u<5;_u++){const _c=(g*ga+(_a===0?.1:_a===4?(_t*_a*ga-1e5)/ga:_t*_a)*ga)/ga,_l=(j*ga+(_u===0?.1:_u===4?(_i*_u*ga-1e5)/ga:_i*_u)*ga)/ga;_o.push({x:_c,y:_l})}return[..._o]}),_h(this,"checkElementCover",d=>this.getPointPositionList().map(h=>this.checkCoverForAPoint(h.x,h.y,d)).filter(h=>!!h).length>6),_h(this,"checkSizeIsVisible",(d,h,g)=>(d>50||g/d<=10)&&(h>50||g/h<=10)),_h(this,"checkSizeOfPartInClient",()=>{const{left:d,right:h,top:g,bottom:j,clientHeight:_t,clientWidth:_i,clientMin:_o}=this._clientSize;let ga,_a,_u,_c;if(d<0)ga=0;else{if(!(d<_i))return!1;ga=d}if(h<0)return!1;if(_a=h<_i?h:_i,g<0)_u=0;else{if(!(g<_t))return!1;_u=g}if(j<0)return!1;_c=j<_t?j:_t;const _l=_a-ga,_g=_c-_u;return this.checkSizeIsVisible(_l,_g,_o)}),_h(this,"returnHiddenResult",d=>(this._clientSize=null,{visible:!1,reason:d})),_h(this,"checkOneElementVisible",d=>{if(d instanceof HTMLElement){if(this.checkElementIsMountedOnDom(d)){if(this.checkActualCssVisibleIncludeInherit(d)){if(this._clientSize=this.getSizeAboutClient(d),this.checkElementCover(d))return this.returnHiddenResult(cP.COVERED);{const h=this.checkActualSize(),g=this.checkSizeOfPartInClient();return h&&!g?this.returnHiddenResult(cP.POSITION):h?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(cP.SIZE)}}return this.returnHiddenResult(cP.STYLE)}return this.returnHiddenResult(WU.UNMOUNTED)}return this.returnHiddenResult(WU.INVALID_HTML_ELEMENT)}),_h(this,"checkElementIsMountedOnDom",d=>this.checkPropertyUpToAllParentNodes(d,h=>h.nodeName.toUpperCase()!=="HTML"?h.parentElement!==null:!!document.documentElement))}};function A8(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function SL(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?A8(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):A8(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}let cR=(JW=b0({argsMap:(d,h,g)=>[d.getTrackId(),typeof h=="string"?h:h instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",g]}),XW=HS(),QW=b0({argsMap:d=>[d.getTrackId()]}),ZW=eP("LocalVideoTrack","_enabledMutex"),e8=b0({argsMap:(d,h)=>[d.getTrackId(),h]}),t8=HS(),n8=eP("LocalVideoTrack","_enabledMutex"),r8=b0({argsMap:(d,h)=>[d.getTrackId(),h]}),i8=HS(),o8=b0({argsMap:(d,h)=>[d.getTrackId(),h]}),s8=HS(),a8=HS(),c8=b0({argsMap:(d,h,g)=>[d.getTrackId(),h,g]}),u8=HS(),l8=HS(),d8=HS(),p8=HS(),h8=HS(),f8=HS(),m8=HS(),g8=b0({argsMap:(d,h)=>[d.getTrackId(),h.name]}),E8=b0({argsMap:d=>[d.getTrackId()]}),v8=b0({argsMap:d=>[d.getTrackId()]}),_8=b0({argsMap:(d,h,g)=>[d.getTrackId(),h.label,g]}),G_((G0=class g7 extends _5{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==$R.PLAYING)}get processorContext(){return this._processorContext}set processorContext(h){this._processorContext=h}get __className__(){return"LocalVideoTrack"}constructor(h,g,j,_t,_i,_o){if(super(h,_i),_h(this,"trackMediaType","video"),_h(this,"_player",void 0),_h(this,"_videoVisibleTimer",null),_h(this,"_previousVideoVisibleStatus",void 0),_h(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),_h(this,"_encoderConfig",void 0),_h(this,"_scalabiltyMode",{numSpatialLayers:1,numTemporalLayers:1}),_h(this,"_optimizationMode",void 0),_h(this,"_videoHeight",void 0),_h(this,"_videoWidth",void 0),_h(this,"_forceBitrateLimit",void 0),_h(this,"_enabled",!0),_h(this,"processorDestination",void 0),_h(this,"_processorContext",void 0),sT()){const{width:ga,height:_a}=h.getSettings();this._videoWidth=ga,this._videoHeight=_a}else this.updateMediaStreamTrackResolution();this._encoderConfig=g,this._scalabiltyMode=j,this._optimizationMode=_t,this._hints=_o||[],this._hints.indexOf(ER.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile(),g&&this._hints.indexOf(ER.CUSTOM_TRACK)!==-1&&this.setEncoderConfiguration(g),this.processorContext=new f$(this.getTrackId(),"local"),this.processorDestination=new h$(this.processorContext),this.bindProcessorDestinationEvents()}play(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof h=="string"){const _t=document.getElementById(h);_t?h=_t:(wE.warning("[".concat(this.getTrackId(),'] can not find "#').concat(h,'" element, use document.body')),h=document.body)}wE.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(h instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(g));const j=SL(SL(SL({},this._getDefaultPlayerConfig()),g),{},{trackId:this.getTrackId(),element:h});this._player?this._player.updateConfig(j):(h instanceof HTMLVideoElement?this._player=new U5(j):this._player=new KW(j),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const _t=this.getVideoElementVisibleStatus();this.safeEmit(lN.VIDEO_ELEMENT_VISIBLE_STATUS,_t)}catch{}},__("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,wE.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(h,g){if(!g){if(h===this._enabled)return;this.stateCheck("enabled",h)}if(wE.info("[".concat(this.getTrackId(),"] start setEnabled"),h),!h){this._originMediaStreamTrack.enabled=!1;try{await qS(this,I0.NEED_DISABLE_TRACK,this)}catch(j){throw wE.error("[".concat(this.getTrackId(),"] setEnabled to false error"),j.toString()),j}return g||(this._enabled=!1),void wE.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await qS(this,I0.NEED_ENABLE_TRACK,this)}catch(j){throw wE.error("[".concat(this.getTrackId(),"] setEnabled to true error"),j.toString()),j}wE.info("[".concat(this.getTrackId(),"] setEnabled to true success")),g||(this._enabled=!0)}async setMuted(h){h!==this._muted&&(this.stateCheck("muted",h),this._muted=h,this._originMediaStreamTrack.enabled=!h,wE.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(h)),h?await qS(this,I0.NEED_MUTE_TRACK,this):await qS(this,I0.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(h,g){if(!this._enabled)throw new f_(c_.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if(h=XN(h),this._forceBitrateLimit&&(h.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:h.bitrateMax,h.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:h.bitrateMin),h.width||h.height||h.frameRate){const j=$U({encoderConfig:h});(sT()||aT()||hO())&&(j.deviceId=void 0),wE.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(h),JSON.stringify(j));try{await this._originMediaStreamTrack.applyConstraints(j),this.updateMediaStreamTrackResolution()}catch(_t){const _i=new f_(c_.UNEXPECTED_ERROR,_t.toString());throw wE.error("[".concat(this.getTrackId(),"] applyConstraints error"),_i.toString()),_i}}this._encoderConfig=h,this._hints.indexOf(ER.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await qS(this,I0.NEED_UPDATE_VIDEO_ENCODER,this)}catch(j){return j.throw()}}getStats(){return vL(()=>{wE.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")},"localVideoTrackGetStatsWarning"),PI(this,I0.GET_STATS)||SL({},s5)}async setBeautyEffect(h){wE.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(h,g):await j5(h)}clone(h,g,j,_t){const _i=this._mediaStreamTrack.clone();return new g7(_i,h,g,j,_t)}async setBitrateLimit(h){if(wE.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(h))),h){this._forceBitrateLimit=h,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<h.max_bitrate?this._encoderConfig.bitrateMax:h.max_bitrate:this._encoderConfig.bitrateMax=h.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=h.min_bitrate);try{await qS(this,I0.NEED_UPDATE_VIDEO_ENCODER,this)}catch(g){return g.throw()}}}async setOptimizationMode(h){if(h!=="motion"&&h!=="detail"&&h!=="balanced")return void wE.error(c_.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const g=this._optimizationMode;try{this._optimizationMode=h,await qS(this,I0.SET_OPTIMIZATION_MODE,this)}catch(j){throw this._optimizationMode=g,wE.error("[".concat(this.getTrackId(),"] set optimization mode failed"),j.toString()),j}wE.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(h,")"))}setScalabiltyMode(h){if(h.numSpatialLayers===1&&h.numTemporalLayers!==1)return wE.error(c_.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabiltyMode=h,wE.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(h,")"))}updateMediaStreamTrackResolution(){lW(this._originMediaStreamTrack).then(h=>{let[g,j]=h;this._videoHeight=j,this._videoWidth=g}).catch(UU)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:h,height:g,frameRate:j}=this.getMediaStreamTrackSettings();if(!h||!g||!j)return;const[_t,_i]=function(_o,ga,_a){const _u=__("BITRATE_ADAPTER_TYPE");let _c;const _l=200*Math.pow(_a/15,.6)*Math.pow(_o*ga/640/360,.75),_g=_l;if(_u==="STANDARD_BITRATE")_c=4*_l;else{if(_u!=="COMPATIABLE_BITRATE")return;_c=2*_l}return[Math.floor(_c),Math.floor(_g)]}(h,g,j)||[void 0,void 0];this._encoderConfig.bitrateMin||this._encoderConfig.bitrateMax||(this._encoderConfig.bitrateMin=_i,this._encoderConfig.bitrateMax=_t,wE.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(h,", h: ").concat(g,", fps: ").concat(j,"] => [brMax: ").concat(_t,", brMin: ").concat(_i,"]")))}getVideoElementVisibleStatus(){try{var h,g;const j=this==null||(h=this._player)===null||h===void 0?void 0:h.getContainerElement(),_t={track:this,element:this==null||(g=this._player)===null||g===void 0?void 0:g.getVideoElement(),slot:j==null?void 0:j.parentElement},{element:_i,slot:_o}=_t;if(this.isPlaying&&_i instanceof HTMLVideoElement&&_o instanceof HTMLElement){const ga=O8.checkOneElementVisible(_i),_a=Object.assign({},ga);if(_a.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=_a.visible;const _u=p0.reportApiInvoke(null,{tag:kS.TRACER,name:iR.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});_a.visible?_u.onSuccess("Video is visible"):_u.onSuccess("Invisible because of ".concat(_a.reason))}return _a}return}catch(j){throw new f_(c_.GET_VIDEO_ELEMENT_VISIBLE_ERROR,j.message)}}async renewMediaStreamTrack(h){}pipe(h){if(this.processor===h)return h;if(h._source)throw new f_(c_.INVALID_OPERATION,"Processor ".concat(h.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=h,this.processor._source=this,h.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),h}unpipe(){if(!this.processor)return;const h=this.processor;this.processor._source=void 0,this.processor=void 0,h.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}async replaceTrack(h,g){if(!(h instanceof MediaStreamTrack))throw new f_(c_.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if(h.kind!=="video")throw new f_(c_.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(h,g,!0),this.updateMediaStreamTrackResolution()}bindProcessorDestinationEvents(){this.processorDestination.on(qR.ON_TRACK,async h=>{h?h!==this._mediaStreamTrack&&(this._mediaStreamTrack=h,this._updatePlayerSource(),await qS(this,I0.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await qS(this,I0.NEED_REPLACE_TRACK,this))})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(qR.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(CT.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(CT.REQUEST_CONSTRAINTS)}}).prototype,"play",[JW,XW],Object.getOwnPropertyDescriptor(G0.prototype,"play"),G0.prototype),G_(G0.prototype,"stop",[QW],Object.getOwnPropertyDescriptor(G0.prototype,"stop"),G0.prototype),G_(G0.prototype,"setEnabled",[ZW,e8,t8],Object.getOwnPropertyDescriptor(G0.prototype,"setEnabled"),G0.prototype),G_(G0.prototype,"setMuted",[n8,r8,i8],Object.getOwnPropertyDescriptor(G0.prototype,"setMuted"),G0.prototype),G_(G0.prototype,"setEncoderConfiguration",[o8,s8],Object.getOwnPropertyDescriptor(G0.prototype,"setEncoderConfiguration"),G0.prototype),G_(G0.prototype,"getStats",[a8],Object.getOwnPropertyDescriptor(G0.prototype,"getStats"),G0.prototype),G_(G0.prototype,"setBeautyEffect",[c8,u8],Object.getOwnPropertyDescriptor(G0.prototype,"setBeautyEffect"),G0.prototype),G_(G0.prototype,"getCurrentFrameData",[l8],Object.getOwnPropertyDescriptor(G0.prototype,"getCurrentFrameData"),G0.prototype),G_(G0.prototype,"getCurrentFrameImage",[d8],Object.getOwnPropertyDescriptor(G0.prototype,"getCurrentFrameImage"),G0.prototype),G_(G0.prototype,"setBitrateLimit",[p8],Object.getOwnPropertyDescriptor(G0.prototype,"setBitrateLimit"),G0.prototype),G_(G0.prototype,"setOptimizationMode",[h8],Object.getOwnPropertyDescriptor(G0.prototype,"setOptimizationMode"),G0.prototype),G_(G0.prototype,"setScalabiltyMode",[f8],Object.getOwnPropertyDescriptor(G0.prototype,"setScalabiltyMode"),G0.prototype),G_(G0.prototype,"updateMediaStreamTrackResolution",[m8],Object.getOwnPropertyDescriptor(G0.prototype,"updateMediaStreamTrackResolution"),G0.prototype),G_(G0.prototype,"pipe",[g8],Object.getOwnPropertyDescriptor(G0.prototype,"pipe"),G0.prototype),G_(G0.prototype,"unpipe",[E8],Object.getOwnPropertyDescriptor(G0.prototype,"unpipe"),G0.prototype),G_(G0.prototype,"close",[v8],Object.getOwnPropertyDescriptor(G0.prototype,"close"),G0.prototype),G_(G0.prototype,"replaceTrack",[_8],Object.getOwnPropertyDescriptor(G0.prototype,"replaceTrack"),G0.prototype),G0),N8=(y8=b0({argsMap:(d,h)=>[d.getTrackId(),h]}),b8=HS(),S8=eP("CameraVideoTrack","_enabledMutex"),R8=b0({argsMap:(d,h)=>[d.getTrackId(),h]}),T8=HS(),w8=b0({argsMap:(d,h)=>[d.getTrackId(),h]}),C8=HS(),I8=b0({argsMap:d=>[d.getTrackId()]}),G_((mI=class extends cR{get __className__(){return"CameraVideoTrack"}constructor(d,h,g,j,_t,_i){super(d,XN(h.encoderConfig),j,_t,_i),_h(this,"_config",void 0),_h(this,"_originalConstraints",void 0),_h(this,"_constraints",void 0),_h(this,"_enabled",!0),_h(this,"_deviceName","default"),_h(this,"tryResumeVideoForIOS15_16WeChat",async()=>{(G1()||C3())&&!function(){const _o=sS();if(_o.os!==VR.IOS||!_o.osVersion)return!1;const ga=_o.osVersion.split(".");return Number(ga[0])===15&&Number(ga[1])>=2}()&&A2()&&this._enabled&&!this._isClosed&&(wE.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())}),this._config=h,this._originalConstraints=g,this._constraints=g,this._deviceName=d.label,this._encoderConfig=XN(this._config.encoderConfig),cS.on(bR.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),cS.on(bR.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(d){if(wE.info("[".concat(this.getTrackId(),"] set device to ").concat(d)),this._enabled)try{const h=await _C.getDeviceById(d),g={};g.video=SL({},this._constraints),g.video.deviceId={exact:d},g.video.facingMode=void 0,this._originMediaStreamTrack.stop();let j=null;try{j=await kI(g,this.getTrackId())}catch(_t){throw wE.error("[".concat(this.getTrackId(),"] setDevice failed"),_t.toString()),j=await kI({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(j.getVideoTracks()[0],!1),_t}await this._updateOriginMediaStreamTrack(j.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=h.label,this._config.cameraId=d,this._constraints.deviceId={exact:d}}catch(h){throw wE.error("[".concat(this.getTrackId(),"] setDevice error"),h.toString()),h}else try{const h=await _C.getDeviceById(d);this._deviceName=h.label,this._config.cameraId=d,this._constraints.deviceId={exact:d}}catch(h){throw wE.error("[".concat(this.getTrackId(),"] setDevice error"),h.toString()),h}wE.info("[".concat(this.getTrackId(),"] setDevice success"))}async setEnabled(d,h){if(!h){if(d===this._enabled)return;this.stateCheck("enabled",d)}if(wE.info("[".concat(this.getTrackId(),"] start setEnabled"),d),d){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const g=await kI({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(g.getVideoTracks()[0],!1)}await qS(this,I0.NEED_ENABLE_TRACK,this)}catch(g){throw wE.error("[".concat(this.getTrackId(),"] setEnabled true error"),g.toString()),g}this.updateMediaStreamTrackResolution(),wE.info("[".concat(this.getTrackId(),"] setEnabled to true success")),h||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),h||(this._enabled=!1);try{await qS(this,I0.NEED_DISABLE_TRACK,this)}catch(g){throw wE.error("[".concat(this.getTrackId(),"] setEnabled to false error"),g.toString()),g}wE.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(d,h){if(!this._enabled)throw new f_(c_.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");d=XN(d),this._forceBitrateLimit&&(d.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:d.bitrateMax,d.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:d.bitrateMin);const g=aR(this._config);g.encoderConfig=d;const j=$U(g);(sT()||aT()||hO())&&(j.deviceId=void 0),wE.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(d),JSON.stringify(j));try{await this._originMediaStreamTrack.applyConstraints(j),this.updateMediaStreamTrackResolution()}catch(_t){const _i=new f_(c_.UNEXPECTED_ERROR,_t.toString());throw wE.error("[".concat(this.getTrackId(),"] applyConstraints error"),_i.toString()),_i}this._config=g,this._constraints=j,this._originalConstraints=j,this._encoderConfig=d,this._hints.indexOf(ER.SCREEN_TRACK)===-1&&this.updateBitrateFromProfile();try{await qS(this,I0.NEED_UPDATE_VIDEO_ENCODER,this)}catch(_t){return _t.throw()}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((aT()||hO())&&this._enabled&&!this._isClosed&&cS.duringInterruption){const d=async()=>{cS.off(bR.IOS_INTERRUPTION_END,d),this._enabled&&!this._isClosed&&(wE.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};cS.on(bR.IOS_INTERRUPTION_END,d)}else wE.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit(lN.TRACK_ENDED)}async renewMediaStreamTrack(d){const h=d||this._constraints,g=_C.searchDeviceIdByName(this._deviceName);if(g&&!h.deviceId&&(h.deviceId={exact:g}),this._enabled){const j=await kI({video:h},this.getTrackId());this._constraints=h,await this._updateOriginMediaStreamTrack(j.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),cS.off(bR.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),cS.off(bR.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}bindProcessorContextEvents(){this.processorContext.on(CT.REQUEST_UPDATE_CONSTRAINTS,async(d,h,g)=>{try{const j=Object.assign({},this._originalConstraints,...d);await this.renewMediaStreamTrack(j),h()}catch(j){g(j)}}),this.processorContext.on(CT.REQUEST_CONSTRAINTS,async d=>{d(this._originMediaStreamTrack.getSettings())})}}).prototype,"setDevice",[y8,b8],Object.getOwnPropertyDescriptor(mI.prototype,"setDevice"),mI.prototype),G_(mI.prototype,"setEnabled",[S8,R8,T8],Object.getOwnPropertyDescriptor(mI.prototype,"setEnabled"),mI.prototype),G_(mI.prototype,"setEncoderConfiguration",[w8,C8],Object.getOwnPropertyDescriptor(mI.prototype,"setEncoderConfiguration"),mI.prototype),G_(mI.prototype,"close",[I8],Object.getOwnPropertyDescriptor(mI.prototype,"close"),mI.prototype),mI);class F5{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio)return this._audioTrack}get videoTrack(){if(this.hasVideo)return this._videoTrack}constructor(h,g){_h(this,"uid",void 0),_h(this,"_uintid",void 0),_h(this,"_trust_in_room_",!0),_h(this,"_trust_audio_enabled_state_",!0),_h(this,"_trust_video_enabled_state_",!0),_h(this,"_trust_audio_mute_state_",!0),_h(this,"_trust_video_mute_state_",!0),_h(this,"_audio_muted_",!1),_h(this,"_video_muted_",!1),_h(this,"_audio_enabled_",!0),_h(this,"_video_enabled_",!0),_h(this,"_audio_added_",!1),_h(this,"_video_added_",!1),_h(this,"_trust_video_stream_added_state_",!0),_h(this,"_trust_audio_stream_added_state_",!0),_h(this,"_audioTrack",void 0),_h(this,"_videoTrack",void 0),_h(this,"_audioSSRC",void 0),_h(this,"_videoSSRC",void 0),_h(this,"_audioOrtc",void 0),_h(this,"_videoOrtc",void 0),_h(this,"_cname",void 0),_h(this,"_rtxSsrcId",void 0),this.uid=h,this._uintid=g}}var _Z=VG,yZ=j1,bZ=eU;PR({target:"Promise",stat:!0},{try:function(d){var h=yZ.f(this),g=bZ(d);return(g.error?h.reject:h.resolve)(g.value),h.promise}});var B5=_Z,SZ=PR,RZ=_E,TZ=_,wZ=EL,CZ=u0,IZ=hT,OZ=$I,k8=K3,AZ=F4,NZ=H4,kZ=yS,P8=wR("isConcatSpreadable"),x8=9007199254740991,D8="Maximum allowed index exceeded",L8=RZ.TypeError,PZ=kZ>=51||!TZ(function(){var d=[];return d[P8]=!1,d.concat()[0]!==d}),xZ=NZ("concat"),DZ=function(d){if(!CZ(d))return!1;var h=d[P8];return h!==void 0?!!h:wZ(d)};SZ({target:"Array",proto:!0,forced:!PZ||!xZ},{concat:function(d){var h,g,j,_t,_i,_o=IZ(this),ga=AZ(_o,0),_a=0;for(h=-1,j=arguments.length;h<j;h++)if(DZ(_i=h===-1?_o:arguments[h])){if(_a+(_t=OZ(_i))>x8)throw L8(D8);for(g=0;g<_t;g++,_a++)g in _i&&k8(ga,_a,_i[g])}else{if(_a>=x8)throw L8(D8);k8(ga,_a++,_i)}return ga.length=_a,ga}});var M8={},LZ=a_,MZ=m0,j8=jN.f,jZ=d4,U8=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];M8.f=function(d){return U8&&LZ(d)=="Window"?function(h){try{return j8(h)}catch{return jZ(U8)}}(d):j8(MZ(d))};var RL={},UZ=wR;RL.f=UZ;var F8=s0,FZ=IS,BZ=RL,VZ=oI.f,LR=function(d){var h=F8.Symbol||(F8.Symbol={});FZ(h,d)||VZ(h,d,{value:BZ.f(d)})},uP=PR,V5=_E,GZ=A0,$Z=o_,TL=_y,WZ=ba,lP=w_,c1=mR,G5=_,JR=IS,HZ=EL,qZ=m_,zZ=u0,KZ=_p,$5=bT,W5=DT,YZ=hT,HU=m0,H5=mT,B8=Z0,q5=I_,wL=I1,V8=ZO,JZ=jN,G8=M8,z5=HP,$8=b_,W8=oI,XZ=zI,H8=v_,QZ=VV,K5=QM,CL=RI.exports,q8=R1,z8=TI,K8=wR,ZZ=RL,eee=LR,tee=rL,Y8=XM,qU=V4.forEach,eI=LN("hidden"),zU="Symbol",J8=K8("toPrimitive"),nee=Y8.set,X8=Y8.getterFor(zU),tO=Object.prototype,fN=V5.Symbol,u1=fN&&fN.prototype,Q8=V5.TypeError,Y5=V5.QObject,IL=GZ("JSON","stringify"),Z8=$8.f,mN=W8.f,eH=G8.f,ree=H8.f,tH=WZ([].push),$O=CL("symbols"),OL=CL("op-symbols"),J5=CL("string-to-symbol-registry"),X5=CL("symbol-to-string-registry"),iee=CL("wks"),Q5=!Y5||!Y5.prototype||!Y5.prototype.findChild,Z5=lP&&G5(function(){return wL(mN({},"a",{get:function(){return mN(this,"a",{value:7}).a}})).a!=7})?function(d,h,g){var j=Z8(tO,h);j&&delete tO[h],mN(d,h,g),j&&d!==tO&&mN(tO,h,j)}:mN,e6=function(d,h){var g=$O[d]=wL(u1);return nee(g,{type:zU,tag:d,description:h}),lP||(g.description=h),g},KU=function(d,h,g){d===tO&&KU(OL,h,g),W5(d);var j=H5(h);return W5(g),JR($O,j)?(g.enumerable?(JR(d,eI)&&d[eI][j]&&(d[eI][j]=!1),g=wL(g,{enumerable:q5(0,!1)})):(JR(d,eI)||mN(d,eI,q5(1,{})),d[eI][j]=!0),Z5(d,j,g)):mN(d,j,g)},t6=function(d,h){W5(d);var g=HU(h),j=V8(g).concat(n6(g));return qU(j,function(_t){lP&&!TL(nH,g,_t)||KU(d,_t,g[_t])}),d},nH=function(d){var h=H5(d),g=TL(ree,this,h);return!(this===tO&&JR($O,h)&&!JR(OL,h))&&(!(g||!JR(this,h)||!JR($O,h)||JR(this,eI)&&this[eI][h])||g)},rH=function(d,h){var g=HU(d),j=H5(h);if(g!==tO||!JR($O,j)||JR(OL,j)){var _t=Z8(g,j);return!_t||!JR($O,j)||JR(g,eI)&&g[eI][j]||(_t.enumerable=!0),_t}},iH=function(d){var h=eH(HU(d)),g=[];return qU(h,function(j){JR($O,j)||JR(q8,j)||tH(g,j)}),g},n6=function(d){var h=d===tO,g=eH(h?OL:HU(d)),j=[];return qU(g,function(_t){!JR($O,_t)||h&&!JR(tO,_t)||tH(j,$O[_t])}),j};if(c1||(K5(u1=(fN=function(){if(KZ(u1,this))throw Q8("Symbol is not a constructor");var d=arguments.length&&arguments[0]!==void 0?B8(arguments[0]):void 0,h=z8(d),g=function(j){this===tO&&TL(g,OL,j),JR(this,eI)&&JR(this[eI],h)&&(this[eI][h]=!1),Z5(this,h,q5(1,j))};return lP&&Q5&&Z5(tO,h,{configurable:!0,set:g}),e6(h,d)}).prototype,"toString",function(){return X8(this).tag}),K5(fN,"withoutSetter",function(d){return e6(z8(d),d)}),H8.f=nH,W8.f=KU,XZ.f=t6,$8.f=rH,JZ.f=G8.f=iH,z5.f=n6,ZZ.f=function(d){return e6(K8(d),d)},lP&&mN(u1,"description",{configurable:!0,get:function(){return X8(this).description}})),uP({global:!0,wrap:!0,forced:!c1,sham:!c1},{Symbol:fN}),qU(V8(iee),function(d){eee(d)}),uP({target:zU,stat:!0,forced:!c1},{for:function(d){var h=B8(d);if(JR(J5,h))return J5[h];var g=fN(h);return J5[h]=g,X5[g]=h,g},keyFor:function(d){if(!$5(d))throw Q8(d+" is not a symbol");if(JR(X5,d))return X5[d]},useSetter:function(){Q5=!0},useSimple:function(){Q5=!1}}),uP({target:"Object",stat:!0,forced:!c1,sham:!lP},{create:function(d,h){return h===void 0?wL(d):t6(wL(d),h)},defineProperty:KU,defineProperties:t6,getOwnPropertyDescriptor:rH}),uP({target:"Object",stat:!0,forced:!c1},{getOwnPropertyNames:iH,getOwnPropertySymbols:n6}),uP({target:"Object",stat:!0,forced:G5(function(){z5.f(1)})},{getOwnPropertySymbols:function(d){return z5.f(YZ(d))}}),IL&&uP({target:"JSON",stat:!0,forced:!c1||G5(function(){var d=fN();return IL([d])!="[null]"||IL({a:d})!="{}"||IL(Object(d))!="{}"})},{stringify:function(d,h,g){var j=QZ(arguments),_t=h;if((zZ(h)||d!==void 0)&&!$5(d))return HZ(h)||(h=function(_i,_o){if(qZ(_t)&&(_o=TL(_t,this,_i,_o)),!$5(_o))return _o}),j[1]=h,$Z(IL,null,j)}}),!u1[J8]){var oee=u1.valueOf;K5(u1,J8,function(d){return TL(oee,this)})}tee(fN,zU),q8[eI]=!0,LR("asyncIterator"),LR("hasInstance"),LR("isConcatSpreadable"),LR("iterator"),LR("match"),LR("matchAll"),LR("replace"),LR("search"),LR("species"),LR("split"),LR("toPrimitive"),LR("toStringTag"),LR("unscopables"),rL(_E.JSON,"JSON",!0);var see=s0.Symbol;LR("asyncDispose"),LR("dispose"),LR("matcher"),LR("metadata"),LR("observable"),LR("patternMatch"),LR("replaceAll");var oH=see,sH=RL.f("asyncIterator"),aee=sH;function aH(d){this.wrapped=d}function AL(d){var h,g;function j(_i,_o){try{var ga=d[_i](_o),_a=ga.value,_u=_a instanceof aH;B5.resolve(_u?_a.wrapped:_a).then(function(_c){_u?j(_i==="return"?"return":"next",_c):_t(ga.done?"return":"normal",_c)},function(_c){j("throw",_c)})}catch(_c){_t("throw",_c)}}function _t(_i,_o){switch(_i){case"return":h.resolve({value:_o,done:!0});break;case"throw":h.reject(_o);break;default:h.resolve({value:_o,done:!1})}(h=h.next)?j(h.key,h.arg):g=null}this._invoke=function(_i,_o){return new B5(function(ga,_a){var _u={key:_i,arg:_o,resolve:ga,reject:_a,next:null};g?g=g.next=_u:(h=g=_u,j(_i,_o))})},typeof d.return!="function"&&(this.return=void 0)}function xI(d){return function(){return new AL(d.apply(this,arguments))}}function $0(d){return new aH(d)}AL.prototype[typeof oH=="function"&&aee||"@@asyncIterator"]=function(){return this},AL.prototype.next=function(d){return this._invoke("next",d)},AL.prototype.throw=function(d){return this._invoke("throw",d)},AL.prototype.return=function(d){return this._invoke("return",d)};var cee=RL.f("iterator");function YU(d,h){var g={},j=!1;function _t(_i,_o){return j=!0,_o=new B5(function(ga){ga(d[_i](_o))}),{done:!1,value:h(_o)}}return g[oH!==void 0&&cee||"@@iterator"]=function(){return this},g.next=function(_i){return j?(j=!1,_i):_t("next",_i)},typeof d.throw=="function"&&(g.throw=function(_i){if(j)throw j=!1,_i;return _t("throw",_i)}),typeof d.return=="function"&&(g.return=function(_i){return j?(j=!1,_i):_t("return",_i)}),g}var cH=sH,uR={exports:{}};function uH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function lH(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?uH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):uH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}function r6(d,h,g,j,_t,_i,_o){let ga=[],_a=[],_u=[],_c=[],_l=!1,_g=!1;if(uR.exports.parse(d).mediaDescriptions.forEach(r_=>{_o&&_o!==r_.attributes.direction||(r_.media.mediaType!=="video"||_l||(_a=r_.attributes.payloads,_c=r_.attributes.extmaps,_l=!0),r_.media.mediaType!=="audio"||_g||(ga=r_.attributes.payloads,_u=r_.attributes.extmaps,_g=!0))}),!_c||_a.length===0)throw new Error("Cannot get video capabilities from SDP.");if(!_u||ga.length===0)throw new Error("Cannot get audio capabilities from SDP.");return _a.forEach(r_=>{var l_;(l_=r_.rtpMap)!==null&&l_!==void 0&&l_.clockRate&&(r_.rtpMap.clockRate=parseInt(r_.rtpMap.clockRate))}),ga.forEach(r_=>{var l_;(l_=r_.rtpMap)!==null&&l_!==void 0&&l_.clockRate&&(r_.rtpMap.clockRate=parseInt(r_.rtpMap.clockRate))}),h&&(ga=ga.filter(r_=>{var l_;return((l_=r_.rtpMap)===null||l_===void 0?void 0:l_.encodingName.toLowerCase())!=="rtx"}),_a=_a.filter(r_=>{var l_;return((l_=r_.rtpMap)===null||l_===void 0?void 0:l_.encodingName.toLowerCase())!=="rtx"})),g&&(_a=_a.filter(r_=>{var l_;return!/(red)|(ulpfec)|(flexfec)/i.test(((l_=r_.rtpMap)===null||l_===void 0?void 0:l_.encodingName)||"")})),j&&(ga=ga.filter(r_=>{var l_;return!/(red)|(ulpfec)|(flexfec)/i.test(((l_=r_.rtpMap)===null||l_===void 0?void 0:l_.encodingName)||"")})),_t&&(_t==null?void 0:_t.length)>0&&(ga=ga.filter(r_=>{var l_;return _t.includes(((l_=r_.rtpMap)===null||l_===void 0?void 0:l_.encodingName.toLowerCase())||"")})),_i&&(_i==null?void 0:_i.length)>0&&(_a=_a.filter(r_=>{var l_;return _i.includes(((l_=r_.rtpMap)===null||l_===void 0?void 0:l_.encodingName.toLowerCase())||"")})),{audioCodecs:ga,videoCodecs:_a,audioExtensions:_u,videoExtensions:_c}}function l1(d){const h=uR.exports.parse(d);let g,j;for(const _t of h.mediaDescriptions){if(!g){const _i=_t.attributes.iceUfrag,_o=_t.attributes.icePwd;if(!_i||!_o)throw new Error("Cannot get iceUfrag or icePwd from SDP.");g={iceUfrag:_i,icePwd:_o}}if(!j){const _i=_t.attributes.fingerprints;_i.length>0&&(j={fingerprints:_i})}}if(!j&&h.attributes.fingerprints.length>0&&(j={fingerprints:h.attributes.fingerprints}),!j||!g)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:g,dtlsParameters:j}}function dH(d,h){const g=[],j=d.attributes.ssrcGroups.filter(_o=>_o.semantic==="FID"),_t=d.attributes.ssrcGroups.find(_o=>_o.semantic==="SIM"),_i=d.attributes.ssrcs;if(_t)_t.ssrcIds.forEach(_o=>{var ga;const _a=(ga=j.find(_u=>_u.ssrcIds[0]===_o))===null||ga===void 0?void 0:ga.ssrcIds[1];g.push({ssrcId:_o,rtx:h?_a:void 0})});else if(j.length>0){const _o=j[0].ssrcIds[0],ga=j[0].ssrcIds[1];g.push({ssrcId:_o,rtx:h?ga:void 0})}else{if(_i.length===0)throw new Error("No ssrcs found on local media description.");g.push({ssrcId:_i[0].ssrcId})}return g}function pH(d,h){const{cname:g}=d;let j;h&&h.ip&&typeof h.port=="number"?(j=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:h.ip,port:h.port.toString(),type:"host",extension:{}}],wE.debug("Using remote candidate from AP ".concat(h.ip,":").concat(h.port)),h.ip6&&(j.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:h.ip6,port:h.port.toString(),type:"host",extension:{}}),wE.debug("Using IPV6 remote candidate from AP ".concat(h.ip6,":").concat(h.port)))):j=d.iceParameters.candidates.map(ga=>({foundation:ga.foundation,componentId:"1",transport:ga.protocol,priority:ga.priority.toString(),connectionAddress:ga.ip,port:ga.port.toString(),type:ga.type,extension:{}}));const _t={fingerprints:d.dtlsParameters.fingerprints.map(ga=>({hashFunction:ga.algorithm,fingerprint:ga.fingerprint}))},_i={iceUfrag:d.iceParameters.iceUfrag,icePwd:d.iceParameters.icePwd};let _o;switch(d.dtlsParameters.role){case"server":_o="passive";break;case"client":_o="active";break;case"auto":_o="actpass"}return{dtlsParameters:_t,iceParameters:_i,candidates:j,rtpCapabilities:s6(d.rtpCapabilities),setup:_o,cname:g}}function gI(d,h,g){const j=[],_t=[];return d.forEach(_i=>{let{ssrcId:_o,rtx:ga}=_i;const _a=CS(8,"track-"),_u={ssrcId:_o,attributes:lH({label:_a,mslabel:g=g||CS(10,""),msid:"".concat(g," ").concat(_a)},h&&{cname:h})};if(j.push(_u),ga!==void 0){const _c={ssrcId:ga,attributes:lH({label:_a,mslabel:g,msid:"".concat(g," ").concat(_a)},h&&{cname:h})};j.push(_c),_t.push({semantic:"FID",ssrcIds:[_o,ga]})}}),d.length>1&&_t.push({semantic:"SIM",ssrcIds:d.map(_i=>{let{ssrcId:_o}=_i;return _o})}),{ssrcs:j,ssrcGroups:_t}}function dP(d,h){h instanceof zR&&d.attributes.payloads.forEach(g=>{var j;const _t=(j=g.rtpMap)===null||j===void 0?void 0:j.encodingName.toLowerCase();if(!_t||["opus","pcmu","pcma","g722"].indexOf(_t)===-1)return;g.fmtp||(g.fmtp={parameters:{}}),g.fmtp.parameters.minptime="10",g.fmtp.parameters.useinbandfec="1";const _i=h._encoderConfig;_i&&_t!=="pcmu"&&_t!=="pcma"&&_t!=="g722"&&(_i.bitrate&&!GS()&&(g.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*_i.bitrate))),_i.sampleRate&&(g.fmtp.parameters.maxplaybackrate="".concat(_i.sampleRate),g.fmtp.parameters["sprop-maxcapturerate"]="".concat(_i.sampleRate)),_i.stereo&&(g.fmtp.parameters.stereo="1",g.fmtp.parameters["sprop-stereo"]="1"))})}function i6(d){const h=d.attributes.unrecognized.findIndex(g=>g.attField==="x-google-flag"&&g.attValue==="conference");h!==-1&&d.attributes.unrecognized.splice(h,1)}function o6(d,h){if(!(h instanceof cR&&h._encoderConfig&&h._hints.indexOf(ER.SCREEN_TRACK)===-1))return;const g=h._encoderConfig;QS().supportMinBitrate&&g.bitrateMin&&d.attributes.payloads.forEach(j=>{var _t;["h264","h265","vp8","vp9","av1"].includes(((_t=j.rtpMap)===null||_t===void 0?void 0:_t.encodingName.toLowerCase())||"")&&(j.fmtp||(j.fmtp={parameters:{}}),j.fmtp.parameters["x-google-min-bitrate"]="".concat(g.bitrateMin))}),QS().supportMinBitrate&&!h._hints.includes(ER.LOW_STREAM)&&g.bitrateMax&&d.attributes.payloads.forEach(j=>{var _t;["h264","h265","vp8","vp9","av1"].includes(((_t=j.rtpMap)===null||_t===void 0?void 0:_t.encodingName.toLowerCase())||"")&&(j.fmtp||(j.fmtp={parameters:{}}),j.fmtp.parameters["x-google-start-bitrate"]="".concat(__("X_GOOGLE_START_BITRATE")||Math.floor(g.bitrateMax)))})}function hH(d){if(d.media.mediaType!=="video")return;const h=sS();if(h.name!==dS.SAFARI&&h.os!==VR.IOS)return;const g=d.attributes.extmaps.findIndex(j=>/video-orientation/g.test(j.extensionName));g!==-1&&d.attributes.extmaps.splice(g,1)}function JU(d,h,g){if(!h)return;let j,_t;if(d.media.mediaType==="video"?(j=g.videoExtensions,_t=g.videoCodecs):(j=g.audioExtensions,_t=g.audioCodecs),h.twcc===!0){const _i=j.find(_o=>_o.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");_i&&(d.attributes.extmaps.find(_o=>_o.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01")||d.attributes.extmaps.push({entry:_i.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(_o,ga){return ga.filter(_a=>!!_o.find(_u=>_u.payloadType===_a.payloadType&&!!_u.rtcpFeedbacks.find(_c=>_c.type==="transport-cc")))}(_t,d.attributes.payloads).forEach(_o=>{_o.rtcpFeedbacks.find(ga=>ga.type==="transport-cc")||_o.rtcpFeedbacks.push({type:"transport-cc"})}))}else if(h.twcc===!1){const _i=d.attributes.extmaps.findIndex(_o=>_o.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");_i!==-1&&d.attributes.extmaps.splice(_i,1),d.attributes.payloads.forEach(_o=>{const ga=_o.rtcpFeedbacks.findIndex(_a=>_a.type==="transport-cc");ga!==-1&&_o.rtcpFeedbacks.splice(ga,1)})}if(h.remb===!0){const _i=j.find(_o=>_o.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");_i&&(d.attributes.extmaps.find(_o=>_o.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time")||d.attributes.extmaps.push({entry:_i.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(_o,ga){return ga.filter(_a=>!!_o.find(_u=>_u.payloadType===_a.payloadType&&!!_u.rtcpFeedbacks.find(_c=>_c.type==="goog-remb")))}(_t,d.attributes.payloads).forEach(_o=>{_o.rtcpFeedbacks.find(ga=>ga.type==="goog-remb")||_o.rtcpFeedbacks.push({type:"goog-remb"})}))}else if(h.remb===!1){const _i=d.attributes.extmaps.findIndex(_o=>_o.extensionName==="http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time");_i!==-1&&d.attributes.extmaps.splice(_i,1),d.attributes.payloads.forEach(_o=>{const ga=_o.rtcpFeedbacks.findIndex(_a=>_a.type==="goog-remb");ga!==-1&&_o.rtcpFeedbacks.splice(ga,1)})}}function fH(d,h,g){if(GS()||d.media.mediaType!=="video"||!(h instanceof cR)||g!=="vp9"&&g!=="vp8"||g==="vp8"&&!__("SIMULCAST")||h._scalabiltyMode===void 0||h._scalabiltyMode.numSpatialLayers<=1)return;const j=g==="vp8"?2:h._scalabiltyMode.numSpatialLayers,_t=d.attributes.ssrcs[0],_i=d.attributes.ssrcGroups.find(ga=>ga.semantic==="FID"&&ga.ssrcIds[0]===_t.ssrcId),_o={semantic:"SIM",ssrcIds:[_t.ssrcId]};for(let ga=1;ga<j;ga++)d.attributes.ssrcs.push({ssrcId:_t.ssrcId+ga,attributes:aR(_t.attributes)}),_o.ssrcIds.push(_t.ssrcId+ga),_i&&(d.attributes.ssrcs.push({ssrcId:_i.ssrcIds[1]+ga,attributes:aR(_t.attributes)}),d.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[_t.ssrcId+ga,_i.ssrcIds[1]+ga]}));d.attributes.ssrcGroups.unshift(_o)}async function mH(d,h,g,j,_t){const _i=new RTCPeerConnection;_i.addTransceiver("video",{direction:"sendonly"}),_i.addTransceiver("audio",{direction:"sendonly"}),_i.addTransceiver("video",{direction:"recvonly"}),_i.addTransceiver("audio",{direction:"recvonly"});const _o=(await _i.createOffer()).sdp,ga=r6(_o,d,h,g,j,_t,"sendonly"),_a=r6(_o,d,h,g,j,_t,"recvonly"),_u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_c={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(XU(ga,_a,"videoExtensions",_u,_c,_l),XU(ga,_a,"videoCodecs",_u,_c,_l),XU(ga,_a,"audioExtensions",_u,_c,_l),XU(ga,_a,"audioCodecs",_u,_c,_l),__("RAISE_H264_BASELINE_PRIORITY")){const _g=_l.videoCodecs.findIndex(r_=>{var l_,d_;return((l_=r_.rtpMap)===null||l_===void 0?void 0:l_.encodingName.toLocaleLowerCase())==="h264"&&((d_=r_.fmtp)===null||d_===void 0?void 0:d_.parameters["profile-level-id"])==="42001f"});if(_g!==-1){const r_=_l.videoCodecs.findIndex(l_=>{var d_;return((d_=l_.rtpMap)===null||d_===void 0?void 0:d_.encodingName.toLocaleLowerCase())==="h264"});if(r_<_g){wE.debug("raising H264 baseline profile priority");const l_=_l.videoCodecs[_g];_l.videoCodecs.splice(_g,1),_l.videoCodecs.splice(r_,0,l_)}r_!==-1&&(_c.videoCodecs=_c.videoCodecs.filter(l_=>{var d_,p_;return!(((d_=l_.rtpMap)===null||d_===void 0?void 0:d_.encodingName.toLocaleLowerCase())==="h264"&&((p_=l_.fmtp)===null||p_===void 0?void 0:p_.parameters["profile-level-id"])!=="42001f")})),r_!==-1&&__("FILTER_SEND_H264_BASELINE")&&(_u.videoCodecs=_u.videoCodecs.filter(l_=>{var d_,p_;return!(((d_=l_.rtpMap)===null||d_===void 0?void 0:d_.encodingName.toLocaleLowerCase())==="h264"&&((p_=l_.fmtp)===null||p_===void 0?void 0:p_.parameters["profile-level-id"])!=="42001f")}))}}try{_i.close()}catch{}return{send:_u,recv:_c,sendrecv:_l}}function XU(d,h,g,j,_t,_i){if(g==="videoExtensions"||g==="audioExtensions"){const _o=[];return d[g].forEach(ga=>{h[g].some((_a,_u)=>{if(ga.entry===_a.entry&&ga.extensionName===_a.extensionName)return _o.push(_u),!0})?_i[g].push(ga):j[g].push(ga)}),void h[g].forEach((ga,_a)=>{_o.indexOf(_a)===-1&&_t[g].push(ga)})}if(g==="videoCodecs"||g==="audioCodecs"){const _o=[];return d[g].forEach(ga=>{h[g].some((_a,_u)=>{if(ga.payloadType===_a.payloadType&&JSON.stringify(ga)===JSON.stringify(_a))return _o.push(_u),!0})?_i[g].push(ga):j[g].push(ga)}),void h[g].forEach((ga,_a)=>{_o.indexOf(_a)===-1&&_t[g].push(ga)})}}function s6(d){const{send:h,recv:g,sendrecv:j}=d;if(!j){if(!h||!g)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:h,recv:g}}let _t,_i;return h?(_t={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_t.audioCodecs=[...h.audioCodecs,...j.audioCodecs],_t.videoCodecs=[...h.videoCodecs,...j.videoCodecs],_t.audioExtensions=[...h.audioExtensions,...j.audioExtensions],_t.videoExtensions=[...h.videoExtensions,...j.videoExtensions]):_t=j,g?(_i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},_i.audioCodecs=[...g.audioCodecs,...j.audioCodecs],_i.videoCodecs=[...g.videoCodecs,...j.videoCodecs],_i.audioExtensions=[...g.audioExtensions,...j.audioExtensions],_i.videoExtensions=[...g.videoExtensions,...j.videoExtensions]):_i=j,{send:_t,recv:_i}}function gN(d){d.media.mediaType==="audio"&&d.attributes.payloads.filter(h=>{var g;return((g=h.rtpMap)===null||g===void 0?void 0:g.encodingName.toLowerCase())==="opus"}).forEach(h=>{h.fmtp||(h.fmtp={parameters:{}}),h.fmtp.parameters.stereo="1",h.fmtp.parameters["sprop-stereo"]="1"})}function gH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function EH(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?gH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):gH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}(function(d,h){d.exports=(()=>{var g={8:(_i,_o,ga)=>{ga.r(_o),ga.d(_o,{Parser:()=>TS,Printer:()=>AT,parse:()=>O0,print:()=>eS});const _a=`
`,_u="".concat("\r").concat(_a),_c=" ";let _l;function _g(Z_){return Z_>="0"&&Z_<="9"}function r_(Z_){return Z_>="!"&&Z_<="~"}function l_(Z_){return r_(Z_)||Z_>=""&&Z_<=""}function d_(Z_){return Z_==="!"||Z_>="#"&&Z_<="'"||Z_>="*"&&Z_<="+"||Z_>="-"&&Z_<="."||Z_>="0"&&Z_<="9"||Z_>="A"&&Z_<="Z"||Z_>="^"&&Z_<="~"}function p_(Z_){return Z_>="1"&&Z_<="9"}function C_(Z_){return Z_>="A"&&Z_<="Z"||Z_>="a"&&Z_<="z"}function O_(Z_){return Z_==="d"||Z_==="h"||Z_==="m"||Z_==="s"}function q_(Z_){return Z_>""&&Z_<"	"||Z_>"\v"&&Z_<"\f"||Z_>""&&Z_<""}function c0(Z_){return C_(Z_)||_g(Z_)||Z_==="+"||Z_==="/"}function K_(Z_){return _g(Z_)||C_(Z_)||Z_==="+"||Z_==="/"||Z_==="-"||Z_==="_"}function Q_(Z_){return C_(Z_)||_g(Z_)||Z_==="+"||Z_==="/"}function $_(Z_,_m){var h_=Object.keys(Z_);if(Object.getOwnPropertySymbols){var E_=Object.getOwnPropertySymbols(Z_);_m&&(E_=E_.filter(function(B_){return Object.getOwnPropertyDescriptor(Z_,B_).enumerable})),h_.push.apply(h_,E_)}return h_}function _b(Z_){for(var _m=1;_m<arguments.length;_m++){var h_=arguments[_m]!=null?arguments[_m]:{};_m%2?$_(Object(h_),!0).forEach(function(E_){iS(Z_,E_,h_[E_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z_,Object.getOwnPropertyDescriptors(h_)):$_(Object(h_)).forEach(function(E_){Object.defineProperty(Z_,E_,Object.getOwnPropertyDescriptor(h_,E_))})}return Z_}function iS(Z_,_m,h_){return _m in Z_?Object.defineProperty(Z_,_m,{value:h_,enumerable:!0,configurable:!0,writable:!0}):Z_[_m]=h_,Z_}(function(Z_){Z_.VERSION="v",Z_.ORIGIN="o",Z_.SESSION_NAME="s",Z_.INFORMATION="i",Z_.URI="u",Z_.EMAIL="e",Z_.PHONE="p",Z_.CONNECTION="c",Z_.BANDWIDTH="b",Z_.TIME="t",Z_.REPEAT="r",Z_.ZONE_ADJUSTMENTS="z",Z_.KEY="k",Z_.ATTRIBUTE="a",Z_.MEDIA="m"})(_l||(_l={}));class y0{consumeText(_m,h_){let E_=h_;for(;E_<_m.length;){const B_=_m[E_];if(B_==="\0"||B_==="\r"||B_===_a)break;E_+=1}if(E_-h_==0)throw new Error("Invalid text, at ".concat(_m));return E_}consumeUnicastAddress(_m,h_,E_){return this.consumeTill(_m,h_,_c)}consumeOneOrMore(_m,h_,E_){let B_=h_;for(;E_(_m[B_]);)B_++;if(B_-h_==0)throw new Error("Invalid rule at ".concat(h_,"."));return B_}consumeSpace(_m,h_){if(_m[h_]===_c)return h_+1;throw new Error("Invalid space at ".concat(h_,"."))}consumeIP4Address(_m,h_){let E_=h_;for(let B_=0;B_<4;B_++)if(E_=this.consumeDecimalUChar(_m,E_),B_!==3){if(_m[E_]!==".")throw new Error("Invalid IP4 address.");E_++}return E_}consumeDecimalUChar(_m,h_){let E_=h_;for(let D0=0;D0<3&&_g(_m[E_]);D0++,E_++);if(E_-h_==0)throw new Error("Invalid decimal uchar.");const B_=parseInt(_m.slice(h_,E_));if(B_>=0&&B_<=255)return E_;throw new Error("Invalid decimal uchar")}consumeIP6Address(_m,h_){let E_=this.consumeHexpart(_m,h_);return _m[E_]===":"&&(E_+=1,E_=this.consumeIP4Address(_m,E_)),E_}consumeHexpart(_m,h_){let E_=h_;if(_m[E_]===":"&&_m[E_+1]===":"){E_+=2;try{E_=this.consumeHexseq(_m,E_)}catch{}return E_}if(E_=this.consumeHexseq(_m,E_),_m[E_]===":"&&_m[E_+1]===":"){E_+=2;try{E_=this.consumeHexseq(_m,E_)}catch{}return E_}return E_}consumeHexseq(_m,h_){let E_=h_;for(;E_=this.consumeHex4(_m,E_),_m[E_]===":"&&_m[E_+1]!==":";)E_+=1;return E_}consumeHex4(_m,h_){let E_=0;for(;E_<4;E_++)if(!((B_=_m[h_+E_])>="0"&&B_<="9"||B_>="a"&&B_<="f"||B_>="A"&&B_<="F")){if(E_===0)throw new Error("Invalid hex 4");break}var B_;return h_+E_}consumeFQDN(_m,h_){let E_=h_;for(;_g(_m[E_])||C_(_m[E_])||_m[E_]==="-"||_m[E_]===".";)E_+=1;if(E_-h_<4)throw new Error("Invalid FQDN");return E_}consumeExtnAddr(_m,h_){return this.consumeOneOrMore(_m,h_,l_)}consumeMulticastAddress(_m,h_,E_){switch(E_){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(_m,h_);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(_m,h_);default:try{return this.consumeFQDN(_m,h_)}catch{return this.consumeExtnAddr(_m,h_)}}}consumeIP6MulticastAddress(_m,h_){const E_=this.consumeHexpart(_m,h_);return _m[E_]==="/"?this.consumeInteger(_m,E_+1):E_}consumeIP4MulticastAddress(_m,h_){let E_=h_+3;const B_=_m.slice(h_,E_),D0=parseInt(B_);if(D0<224||D0>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let wS=0;wS<3;wS++){if(_m[E_]!==".")throw new Error("Invalid IP4 multicast address.");E_+=1,E_=this.consumeDecimalUChar(_m,E_)}return _m[E_]==="/"&&(E_+=1),E_=this.consumeTTL(_m,E_),_m[E_]==="/"&&(E_=this.consumeInteger(_m,E_)),E_}consumeInteger(_m,h_){if(!p_(_m[h_]))throw new Error("Invalid integer.");for(h_+=1;_g(_m[h_]);)h_+=1;return h_}consumeTTL(_m,h_){if(_m[h_]==="0")return h_+1;if(!p_(_m[h_]))throw new Error("Invalid TTL.");h_+=1;for(let E_=0;E_<2&&_g(_m[h_]);E_++)h_+=1;return h_}consumeToken(_m,h_){return this.consumeOneOrMore(_m,h_,d_)}consumeTime(_m,h_){let E_=h_;if(_m[E_]==="0")return E_+1;for(p_(_m[E_])&&(E_+=1);_g(_m[E_]);)E_++;if(E_-h_<10)throw new Error("Invalid time");return E_}consumeAddress(_m,h_){return this.consumeTill(_m,h_,_c)}consumeTypedTime(_m,h_){let E_=h_;return E_=this.consumeOneOrMore(_m,E_,_g),O_(_m[E_])?E_+1:E_}consumeRepeatInterval(_m,h_){if(!p_(_m[h_]))throw new Error("Invalid repeat interval");for(h_+=1;_g(_m[h_]);)h_+=1;return O_(_m[h_])&&(h_+=1),h_}consumePort(_m,h_){return this.consumeOneOrMore(_m,h_,_g)}consume(_m,h_,E_){for(let B_=0;B_<E_.length;B_++){if(h_+B_>=_m.length)throw new Error("consume exceeding value length");if(_m[h_+B_]!==E_[B_])throw new Error("consume ".concat(E_," failed at ").concat(B_))}return h_+E_.length}consumeTill(_m,h_,E_){let B_=h_;for(;B_<_m.length&&(typeof E_!="string"||_m[B_]!==E_)&&(typeof E_!="function"||!E_(_m[B_]));)B_++;return B_}}class TS extends y0{constructor(){super(),iS(this,"records",[]),iS(this,"currentLine",0)}parse(_m){const h_=this.probeEOL(_m);this.records=_m.split(h_).filter(yT=>!!yT.trim()).map(this.parseLine),this.currentLine=0;const E_=this.parseVersion(),B_=this.parseOrigin(),D0=this.parseSessionName(),wS=this.parseInformation(),jR=this.parseUri(),jI=this.parseEmail(),SN=this.parsePhone(),yI=this.parseConnection(),RN=this.parseBandWidth(),EP=this.parseTimeFields(),zS=this.parseKey(),lR=this.parseSessionAttribute(),_S=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:E_,origin:B_,sessionName:D0,information:wS,uri:jR,emails:jI,phones:SN,connection:yI,bandwidths:RN,timeFields:EP,key:zS,attributes:lR,mediaDescriptions:_S}}getCurrentRecord(){const _m=this.records[this.currentLine];if(!_m)throw new Error("Record doesn't exit.");return _m}probeEOL(_m){for(let h_=0;h_<_m.length;h_++)if(_m[h_]===_a)return _m[h_-1]==="\r"?_u:_a;throw new Error("Invalid newline character.")}parseLine(_m,h_){if(_m.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const E_=_m[0];if(_m[1]!=="=")throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:E_,value:_m.slice(2),line:h_,cur:0}}parseSessionAttribute(){const _m=new eR;for(;this.currentLine<this.records.length;){const h_=this.getCurrentRecord();if(h_.type!==_l.ATTRIBUTE)break;const E_={attField:this.extractOneOrMore(h_,B_=>d_(B_)&&B_!==":"),_cur:0};h_.value[h_.cur]===":"&&(h_.cur+=1,E_.attValue=this.extractOneOrMore(h_,q_)),_m.parse(E_),this.currentLine++}return _m.digest()}parseMediaAttributes(_m){const h_=new MR(_m);for(;this.currentLine<this.records.length;){const E_=this.getCurrentRecord();if(E_.type!==_l.ATTRIBUTE)break;const B_={attField:this.extractOneOrMore(E_,D0=>d_(D0)&&D0!==":"),_cur:0};E_.value[E_.cur]===":"&&(E_.cur+=1,B_.attValue=this.extractOneOrMore(E_,q_)),h_.parse(B_),this.currentLine++}return h_.digest()}parseKey(){const _m=this.getCurrentRecord();if(_m.type===_l.KEY){if(_m.value==="prompt"||_m.value==="clear:"||_m.value==="base64:"||_m.value==="uri:")return _m.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const _m=this.getCurrentRecord();if(_m.type===_l.ZONE_ADJUSTMENTS){const h_=[];for(;;)try{const E_=this.extract(_m,this.consumeTime);this.consumeSpaceForRecord(_m);let B_=!1;_m.value[_m.cur]==="-"&&(B_=!0,_m.cur+=1);const D0=this.extract(_m,this.consumeTypedTime);h_.push({time:E_,typedTime:D0,back:B_})}catch{break}if(h_.length===0)throw new Error("Invalid zone adjustments");return this.currentLine++,h_}return[]}parseRepeat(){const _m=[];for(;;){const h_=this.getCurrentRecord();if(h_.type!==_l.REPEAT)break;{const E_=this.extract(h_,this.consumeRepeatInterval),B_=this.parseTypedTime(h_);_m.push({repeatInterval:E_,typedTimes:B_}),this.currentLine++}}return _m}parseTypedTime(_m){const h_=[];for(;;)try{this.consumeSpaceForRecord(_m),h_.push(this.extract(_m,this.consumeTypedTime))}catch{break}if(h_.length===0)throw new Error("Invalid typed time.");return h_}parseTime(){const _m=this.getCurrentRecord(),h_=this.extract(_m,this.consumeTime);this.consumeSpaceForRecord(_m);const E_=this.extract(_m,this.consumeTime);return this.currentLine++,{startTime:h_,stopTime:E_}}parseBandWidth(){const _m=[];for(;this.currentLine<this.records.length;){const h_=this.getCurrentRecord();if(h_.type!==_l.BANDWIDTH)break;{const E_=this.extractOneOrMore(h_,d_);if(h_.value[h_.cur]!==":")throw new Error("Invalid bandwidth field.");h_.cur++;const B_=this.extractOneOrMore(h_,_g);_m.push({bwtype:E_,bandwidth:B_}),this.currentLine++}}return _m}parseVersion(){const _m=this.getCurrentRecord();if(_m.type!==_l.VERSION)throw new Error("first sdp record must be version");const h_=_m.value.slice(0,this.consumeOneOrMore(_m.value,0,_g));if(h_.length!==_m.value.length)throw new Error('invalid proto version, "v='.concat(_m.value,'"'));return this.currentLine++,h_}parseOrigin(){const _m=this.getCurrentRecord();if(_m.type!==_l.ORIGIN)throw new Error("second line of sdp must be origin");const h_=this.extractOneOrMore(_m,l_);this.consumeSpaceForRecord(_m);const E_=this.extractOneOrMore(_m,_g);this.consumeSpaceForRecord(_m);const B_=this.extractOneOrMore(_m,_g);this.consumeSpaceForRecord(_m);const D0=this.extractOneOrMore(_m,d_);this.consumeSpaceForRecord(_m);const wS=this.extractOneOrMore(_m,d_);this.consumeSpaceForRecord(_m);const jR=this.extract(_m,this.consumeUnicastAddress);return this.currentLine++,{username:h_,sessId:E_,sessVersion:B_,nettype:D0,addrtype:wS,unicastAddress:jR}}parseSessionName(){const _m=this.getCurrentRecord();if(_m.type===_l.SESSION_NAME){const h_=this.extract(_m,this.consumeText);return this.currentLine++,h_}}parseInformation(){const _m=this.getCurrentRecord();if(_m.type!==_l.INFORMATION)return;const h_=this.extract(_m,this.consumeText);return this.currentLine++,h_}parseUri(){const _m=this.getCurrentRecord();if(_m.type===_l.URI)return this.currentLine++,_m.value}parseEmail(){const _m=[];for(;;){const h_=this.getCurrentRecord();if(h_.type!==_l.EMAIL)break;_m.push(h_.value),this.currentLine++}return _m}parsePhone(){const _m=[];for(;;){const h_=this.getCurrentRecord();if(h_.type!==_l.PHONE)break;_m.push(h_.value),this.currentLine++}return _m}parseConnection(){const _m=this.getCurrentRecord();if(_m.type===_l.CONNECTION){const h_=this.extractOneOrMore(_m,d_);this.consumeSpaceForRecord(_m);const E_=this.extractOneOrMore(_m,d_);this.consumeSpaceForRecord(_m);const B_=this.extract(_m,this.consumeAddress);return this.currentLine++,{nettype:h_,addrtype:E_,address:B_}}}parseMedia(){const _m=this.getCurrentRecord(),h_=this.extract(_m,this.consumeToken);this.consumeSpaceForRecord(_m);let E_=this.extract(_m,this.consumePort);_m.value[_m.cur]==="/"&&(_m.cur+=1,E_+=this.extract(_m,this.consumeInteger)),this.consumeSpaceForRecord(_m);const B_=[];for(B_.push(this.extract(_m,this.consumeToken));_m.value[_m.cur]==="/";)_m.cur+=1,B_.push(this.extract(_m,this.consumeToken));if(B_.length===0)throw new Error("Invalid proto");const D0=this.parseFmt(_m);return this.currentLine++,{mediaType:h_,port:E_,protos:B_,fmts:D0}}parseTimeFields(){const _m=[];for(;this.getCurrentRecord().type===_l.TIME;){const h_=this.parseTime(),E_=this.parseRepeat(),B_=this.parseZone();_m.push({time:h_,repeats:E_,zones:B_})}return _m}parseMediaDescription(){const _m=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===_l.MEDIA;){const h_=this.parseMedia(),E_=this.parseInformation(),B_=this.parseConnections(),D0=this.parseBandWidth(),wS=this.parseKey(),jR=this.parseMediaAttributes(h_);_m.push({media:h_,information:E_,connections:B_,bandwidths:D0,key:wS,attributes:jR})}return _m}parseConnections(){const _m=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===_l.CONNECTION;)_m.push(this.parseConnection());return _m}parseFmt(_m){const h_=[];for(;;)try{this.consumeSpaceForRecord(_m),h_.push(this.extract(_m,this.consumeToken))}catch{break}if(h_.length===0)throw new Error("Invalid fmts");return h_}extract(_m,h_,...E_){const B_=h_.call(this,_m.value,_m.cur,...E_),D0=_m.value.slice(_m.cur,B_);return _m.cur=B_,D0}extractOneOrMore(_m,h_){const E_=this.consumeOneOrMore(_m.value,_m.cur,h_),B_=_m.value.slice(_m.cur,E_);return _m.cur=E_,B_}consumeSpaceForRecord(_m){if(_m.value[_m.cur]!==_c)throw new Error("Invalid space at ".concat(_m.cur,"."));_m.cur+=1}}class hS extends y0{constructor(..._m){super(..._m),iS(this,"attributes",void 0),iS(this,"digested",!1)}extractOneOrMore(_m,h_,E_){const B_=this.consumeOneOrMore(_m.attValue,_m._cur,h_),D0=_m.attValue.slice(_m._cur,B_),[wS,jR]=E_||[];if(typeof wS=="number"&&D0.length<wS)throw new Error("error in length, should be more or equal than ".concat(wS," characters."));if(typeof jR=="number"&&D0.length>jR)throw new Error("error in length, should be less or equal than ".concat(jR," characters."));return _m._cur=B_,D0}consumeAttributeSpace(_m){if(_m.attValue[_m._cur]!==_c)throw new Error("Invalid space at ".concat(_m._cur,"."));_m._cur+=1}extract(_m,h_,...E_){if(!_m.attValue)throw new Error("Nothing to extract from attValue.");const B_=h_.call(this,_m.attValue,_m._cur,...E_),D0=_m.attValue.slice(_m._cur,B_);return _m._cur=B_,D0}atEnd(_m){if(!_m.attValue)throw new Error;return _m._cur>=_m.attValue.length}peekChar(_m){if(!_m.attValue)throw new Error;return _m.attValue[_m._cur]}peek(_m,h_){if(!_m.attValue)throw new Error;for(let E_=0;E_<h_.length;E_++)if(h_[E_]!==_m.attValue[_m._cur+E_])return!1;return!0}parseIceUfrag(_m){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(_m,c0,[4,256])}parseIcePwd(_m){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(_m,c0,[22,256])}parseIceOptions(_m){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const h_=[];for(;!this.atEnd(_m);){h_.push(this.extractOneOrMore(_m,c0));try{this.consumeAttributeSpace(_m)}catch(E_){if(this.atEnd(_m))break;throw E_}}this.attributes.iceOptions=h_}parseFingerprint(_m){const h_=this.extract(_m,this.consumeToken);this.consumeAttributeSpace(_m);const E_=this.extract(_m,this.consumeTill);this.attributes.fingerprints.push({hashFunction:h_,fingerprint:E_})}parseExtmap(_m){const h_=this.extractOneOrMore(_m,_g);let E_;this.peekChar(_m)==="/"&&(this.extract(_m,this.consume,"/"),E_=this.extract(_m,this.consumeToken)),this.consumeAttributeSpace(_m);const B_=this.extract(_m,this.consumeTill,_c),D0=_b(_b({entry:parseInt(h_,10)},E_&&{direction:E_}),{},{extensionName:B_});this.peekChar(_m)===_c&&(this.consumeAttributeSpace(_m),D0.extensionAttributes=this.extract(_m,this.consumeTill)),this.attributes.extmaps.push(D0)}parseSetup(_m){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const h_=this.extract(_m,this.consumeTill);if(h_!=="active"&&h_!=="passive"&&h_!=="actpass"&&h_!=="holdconn")throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=h_}}class eR extends hS{constructor(..._m){super(..._m),iS(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(_m){if(this.digested)throw new Error("already digested");try{switch(_m.attField){case"group":this.parseGroup(_m);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(_m);break;case"ice-pwd":this.parseIcePwd(_m);break;case"ice-options":this.parseIceOptions(_m);break;case"fingerprint":this.parseFingerprint(_m);break;case"setup":this.parseSetup(_m);break;case"tls-id":this.parseTlsId(_m);break;case"identity":this.parseIdentity(_m);break;case"extmap":this.parseExtmap(_m);break;case"msid-semantic":this.parseMsidSemantic(_m);break;default:_m.ignored=!0,this.attributes.unrecognized.push(_m)}}catch(h_){throw console.error("parsing session attribute ".concat(_m.attField,' error, "a=').concat(_m.attField,":").concat(_m.attValue,'"')),h_}if(!_m.ignored&&_m.attValue&&!this.atEnd(_m))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(_m){const h_=this.extract(_m,this.consumeToken),E_=[];for(;!this.atEnd(_m)&&this.peekChar(_m)===_c;)this.consumeAttributeSpace(_m),E_.push(this.extract(_m,this.consumeToken));this.attributes.groups.push({semantic:h_,identificationTag:E_})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(_m){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(_m,K_)}parseIdentity(_m){const h_=this.extractOneOrMore(_m,Q_),E_=[];for(;!this.atEnd(_m)&&this.peekChar(_m)===_c;){this.consumeAttributeSpace(_m);const B_=this.extract(_m,this.consumeToken);this.extract(_m,this.consume,"=");const D0=this.extractOneOrMore(_m,wS=>wS!==_c&&q_(wS));E_.push({name:B_,value:D0})}this.attributes.identities.push({assertionValue:h_,extensions:E_})}parseMsidSemantic(_m){this.peekChar(_m)===_c&&this.consumeAttributeSpace(_m);const h_={semantic:this.extract(_m,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(_m)}catch{break}if(this.peekChar(_m)==="*"){this.extract(_m,this.consume,"*"),h_.applyForAll=!0;break}{const E_=this.extract(_m,this.consumeTill,_c);h_.identifierList.push(E_)}}this.attributes.msidSemantic=h_}}class MR extends hS{constructor(_m){super(),iS(this,"attributes",void 0),_m.protos.indexOf("RTP")!==-1||_m.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(_m){if(this.digested)throw new Error("already digested");try{switch(_m.attField){case"extmap":this.parseExtmap(_m);break;case"setup":this.parseSetup(_m);break;case"ice-ufrag":this.parseIceUfrag(_m);break;case"ice-pwd":this.parseIcePwd(_m);break;case"ice-options":this.parseIceOptions(_m);break;case"candidate":this.parseCandidate(_m);break;case"remote-candidate":this.parseRemoteCandidate(_m);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(_m);break;case"rtpmap":this.parseRtpmap(_m);break;case"ptime":this.parsePtime(_m);break;case"maxptime":this.parseMaxPtime(_m);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(_m);break;case"ssrc":this.parseSSRC(_m);break;case"fmtp":this.parseFmtp(_m);break;case"rtcp-fb":this.parseRtcpFb(_m);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(_m);break;case"mid":this.parseMid(_m);break;case"msid":this.parseMsid(_m);break;case"imageattr":this.parseImageAttr(_m);break;case"rid":this.parseRid(_m);break;case"simulcast":this.parseSimulcast(_m);break;case"sctp-port":this.parseSctpPort(_m);break;case"max-message-size":this.parseMaxMessageSize(_m);break;case"ssrc-group":this.parseSSRCGroup(_m);break;default:_m.ignored=!0,this.attributes.unrecognized.push(_m)}}catch(h_){throw console.error("parsing media attribute ".concat(_m.attField,' error, "a=').concat(_m.attField,":").concat(_m.attValue,'"')),h_}if(!_m.ignored&&_m.attValue&&!this.atEnd(_m))throw new Error("attribute parsing error")}parseCandidate(_m){const h_=this.extractOneOrMore(_m,c0,[1,32]);this.consumeAttributeSpace(_m);const E_=this.extractOneOrMore(_m,_g,[1,5]);this.consumeAttributeSpace(_m);const B_=this.extract(_m,this.consumeToken);this.consumeAttributeSpace(_m);const D0=this.extractOneOrMore(_m,_g,[1,10]);this.consumeAttributeSpace(_m);const wS=this.extract(_m,this.consumeAddress);this.consumeAttributeSpace(_m);const jR=this.extract(_m,this.consumePort);this.consumeAttributeSpace(_m),this.extract(_m,this.consume,"typ"),this.consumeAttributeSpace(_m);const jI={foundation:h_,componentId:E_,transport:B_,priority:D0,connectionAddress:wS,port:jR,type:this.extract(_m,this.consumeToken),extension:{}};for(this.peek(_m," raddr")&&(this.extract(_m,this.consume," raddr"),this.consumeAttributeSpace(_m),jI.relAddr=this.extract(_m,this.consumeAddress)),this.peek(_m," rport")&&(this.extract(_m,this.consume," rport"),this.consumeAttributeSpace(_m),jI.relPort=this.extract(_m,this.consumePort));this.peekChar(_m)===_c;){this.consumeAttributeSpace(_m);const SN=this.extract(_m,this.consumeToken);this.consumeAttributeSpace(_m),jI.extension[SN]=this.extractOneOrMore(_m,r_)}this.attributes.candidates.push(jI)}parseRemoteCandidate(_m){const h_=[];for(;;){const E_=this.extractOneOrMore(_m,_g,[1,5]);this.consumeAttributeSpace(_m);const B_=this.extract(_m,this.consumeAddress);this.consumeAttributeSpace(_m);const D0=this.extract(_m,this.consumePort);h_.push({componentId:E_,connectionAddress:B_,port:D0});try{this.consumeAttributeSpace(_m)}catch{break}}this.attributes.remoteCandidatesList.push(h_)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(_m){const h_=this.extract(_m,this.consumeToken);this.consumeAttributeSpace(_m);const E_=this.extract(_m,this.consumeTill,"/");this.extract(_m,this.consume,"/");const B_={encodingName:E_,clockRate:this.extractOneOrMore(_m,_g)};this.atEnd(_m)||this.peekChar(_m)!=="/"||(this.extract(_m,this.consume,"/"),B_.encodingParameters=parseInt(this.extract(_m,this.consumeTill),10));const D0=this.attributes.payloads.find(wS=>wS.payloadType===parseInt(h_,10));D0?D0.rtpMap=B_:this.attributes.payloads.push({payloadType:parseInt(h_,10),rtpMap:B_,rtcpFeedbacks:[]})}parsePtime(_m){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(_m,this.consumeTill)}parseMaxPtime(_m){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(_m,this.consumeTill)}parseDirection(_m){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=_m.attField}parseSSRC(_m){const h_=this.extractOneOrMore(_m,_g);this.consumeAttributeSpace(_m);const E_=this.extract(_m,this.consumeTill,":");let B_;this.peekChar(_m)===":"&&(this.extract(_m,this.consume,":"),B_=this.extract(_m,this.consumeTill));const D0=this.attributes.ssrcs.find(wS=>wS.ssrcId===parseInt(h_,10));D0?D0.attributes[E_]=B_:this.attributes.ssrcs.push({ssrcId:parseInt(h_,10),attributes:{[E_]:B_}})}parseFmtp(_m){const h_=this.extract(_m,this.consumeTill,_c);this.consumeAttributeSpace(_m);const E_=this.extract(_m,this.consumeTill),B_={};E_.split(";").forEach(wS=>{let[jR,jI]=wS.split("=");jR=jR.trim();const SN=typeof jI=="string"?jI.trim():null;typeof jR=="string"&&jR.length>0&&(B_[jR]=SN)});const D0=this.attributes.payloads.find(wS=>wS.payloadType===parseInt(h_,10));D0?D0.fmtp={parameters:B_}:this.attributes.payloads.push({payloadType:parseInt(h_,10),rtcpFeedbacks:[],fmtp:{parameters:B_}})}parseFmtParameters(_m){const h_={},E_=this.extract(_m,this.consumeTill,"=");_m._cur++;const B_=this.extract(_m,this.consumeTill,";");for(h_[E_]=B_;_m.attValue[_m._cur]===";";){const D0=this.extract(_m,this.consumeTill,"=");_m._cur++;const wS=this.extract(_m,this.consumeTill,";");h_[D0]=wS}return h_}parseRtcpFb(_m){let h_="";h_=this.peekChar(_m)==="*"?this.extract(_m,this.consume,"*"):this.extract(_m,this.consumeTill,_c),this.consumeAttributeSpace(_m);const E_=this.extract(_m,this.consumeTill,_c);let B_;switch(E_){case"trr-int":B_={type:E_,interval:this.extract(_m,this.consumeTill)};break;case"ack":case"nack":default:{const D0={type:E_};this.peekChar(_m)===_c&&(this.consumeAttributeSpace(_m),D0.parameter=this.extract(_m,this.consumeToken),this.peekChar(_m)===_c&&(D0.additional=this.extract(_m,this.consumeTill))),B_=D0}}if(h_==="*")this.attributes.rtcpFeedbackWildcards.push(B_);else{const D0=this.attributes.payloads.find(wS=>wS.payloadType===parseInt(h_,10));D0?D0.rtcpFeedbacks.push(B_):this.attributes.payloads.push({payloadType:parseInt(h_,10),rtcpFeedbacks:[B_]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(_m){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const h_={port:this.extract(_m,this.consumePort)};this.peekChar(_m)===_c&&(this.consumeAttributeSpace(_m),h_.netType=this.extractOneOrMore(_m,d_),this.consumeAttributeSpace(_m),h_.addressType=this.extractOneOrMore(_m,d_),this.consumeAttributeSpace(_m),h_.address=this.extract(_m,this.consumeAddress)),this.attributes.rtcp=h_}parseMsid(_m){const h_={id:this.extractOneOrMore(_m,d_,[1,64])};this.peekChar(_m)===_c&&(this.consumeAttributeSpace(_m),h_.appdata=this.extractOneOrMore(_m,d_,[1,64])),this.attributes.msids.push(h_)}parseImageAttr(_m){this.attributes.imageattr.push(_m.attValue)}parseRid(_m){const h_=this.extractOneOrMore(_m,B_=>C_(B_)||_g(B_)||B_==="_"||B_==="-");this.consumeAttributeSpace(_m);const E_={id:h_,direction:this.extract(_m,this.consumeToken),params:[]};if(this.peekChar(_m)===_c){if(this.consumeAttributeSpace(_m),this.peek(_m,"pt=")){this.extract(_m,this.consume,"pt=");const B_=[];for(;;){const D0=this.extract(_m,this.consumeToken);B_.push(D0);try{this.extract(_m,this.consume,",")}catch{break}}E_.payloads=B_,this.peekChar(_m)===_c&&this.extract(_m,this.consume,_c)}for(;;){const B_=this.extract(_m,this.consumeToken);switch(B_){case"depend":{const D0={type:B_,rids:this.extract(_m,this.consume,"=").split(",")};E_.params.push(D0);break}case"max-width":case"height-width":case"max-fps":case"max-fs":case"max-br":case"max-pps":case"max-bpp":default:{const D0={type:B_};this.peekChar(_m)==="="&&(this.extract(_m,this.consume,"="),D0.val=this.extract(_m,this.consumeTill,";")),E_.params.push(D0)}}try{this.extract(_m,this.consume,";")}catch{break}}}this.attributes.rids.push(E_)}parseSimulcast(_m){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=_m.attValue,this.extract(_m,this.consumeTill)}parseSctpPort(_m){this.attributes.sctpPort=this.extractOneOrMore(_m,_g,[1,5])}parseMaxMessageSize(_m){this.attributes.maxMessageSize=this.extractOneOrMore(_m,_g,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(_m){this.attributes.mid=this.extract(_m,this.consumeToken)}parseSSRCGroup(_m){const h_=this.extract(_m,this.consumeToken),E_=[];for(;;)try{this.consumeAttributeSpace(_m);const B_=this.extract(_m,this.consumeInteger);E_.push(parseInt(B_,10))}catch{break}this.attributes.ssrcGroups.push({semantic:h_,ssrcIds:E_})}}function XS(Z_,_m,h_){return _m in Z_?Object.defineProperty(Z_,_m,{value:h_,enumerable:!0,configurable:!0,writable:!0}):Z_[_m]=h_,Z_}class AT{constructor(){XS(this,"eol",_u)}print(_m,h_){let E_="";return h_&&(this.eol=h_),E_+=this.printVersion(_m.version),E_+=this.printOrigin(_m.origin),E_+=this.printSessionName(_m.sessionName),E_+=this.printInformation(_m.information),E_+=this.printUri(_m.uri),E_+=this.printEmail(_m.emails),E_+=this.printPhone(_m.phones),E_+=this.printConnection(_m.connection),E_+=this.printBandwidth(_m.bandwidths),E_+=this.printTimeFields(_m.timeFields),E_+=this.printKey(_m.key),E_+=this.printSessionAttributes(_m.attributes),E_+=this.printMediaDescription(_m.mediaDescriptions),E_}printVersion(_m){return"v=".concat(_m).concat(this.eol)}printOrigin(_m){return"o=".concat(_m.username," ").concat(_m.sessId," ").concat(_m.sessVersion," ").concat(_m.nettype," ").concat(_m.addrtype," ").concat(_m.unicastAddress).concat(this.eol)}printSessionName(_m){return _m?"s=".concat(_m).concat(this.eol):""}printInformation(_m){return _m?"i=".concat(_m).concat(this.eol):""}printUri(_m){return _m?"u=".concat(_m).concat(this.eol):""}printEmail(_m){let h_="";for(const E_ of _m)h_+="e=".concat(E_).concat(this.eol);return h_}printPhone(_m){let h_="";for(const E_ of _m)h_+="e=".concat(E_).concat(this.eol);return h_}printConnection(_m){return _m?"c=".concat(_m.nettype," ").concat(_m.addrtype," ").concat(_m.address).concat(this.eol):""}printBandwidth(_m){let h_="";for(const E_ of _m)h_+="b=".concat(E_.bwtype,":").concat(E_.bandwidth).concat(this.eol);return h_}printTimeFields(_m){let h_="";for(const E_ of _m){h_+="t=".concat(E_.time.startTime," ").concat(E_.time.startTime).concat(this.eol);for(const B_ of E_.repeats)h_+="r=".concat(B_.repeatInterval," ").concat(B_.typedTimes.join(" ")).concat(this.eol);E_.zoneAdjustments&&(h_+="z=",h_+="z=".concat(E_.zoneAdjustments.map(B_=>"".concat(B_.time," ").concat(B_.back?"-":""," ").concat(B_.typedTime)).join(" ")).concat(this.eol),h_+=this.eol)}return h_}printKey(_m){return _m?"k=".concat(_m).concat(this.eol):""}printAttributes(_m){let h_="";for(const E_ of _m)h_+="a=".concat(E_.attField).concat(E_.attValue?":".concat(E_.attValue):"").concat(this.eol);return h_}printMediaDescription(_m){let h_="";for(const E_ of _m)h_+=this.printMedia(E_.media),h_+=this.printInformation(E_.information),h_+=this.printConnections(E_.connections),h_+=this.printBandwidth(E_.bandwidths),h_+=this.printKey(E_.key),h_+=this.printMediaAttributes(E_);return h_}printConnections(_m){let h_="";for(const E_ of _m)h_+=this.printConnection(E_);return h_}printMedia(_m){return"m=".concat(_m.mediaType," ").concat(_m.port," ").concat(_m.protos.join("/")," ").concat(_m.fmts.join(" ")).concat(this.eol)}printSessionAttributes(_m){return new z_(this.eol).print(_m)}printMediaAttributes(_m){return new r0(this.eol).print(_m)}}class L_{constructor(_m){XS(this,"eol",void 0),this.eol=_m}printIceUfrag(_m){return _m===void 0?"":"a=ice-ufrag:".concat(_m).concat(this.eol)}printIcePwd(_m){return _m===void 0?"":"a=ice-pwd:".concat(_m).concat(this.eol)}printIceOptions(_m){return _m===void 0?"":"a=ice-options:".concat(_m.join(_c)).concat(this.eol)}printFingerprints(_m){return _m.length>0?_m.map(h_=>"a=fingerprint:".concat(h_.hashFunction).concat(_c).concat(h_.fingerprint)).join(this.eol)+this.eol:""}printExtmap(_m){return _m.map(h_=>"a=extmap:".concat(h_.entry).concat(h_.direction?"/".concat(h_.direction):"").concat(_c).concat(h_.extensionName).concat(h_.extensionAttributes?"".concat(_c).concat(h_.extensionAttributes):"").concat(this.eol)).join("")}printSetup(_m){return _m===void 0?"":"a=setup:".concat(_m).concat(this.eol)}printUnrecognized(_m){return _m.map(h_=>"a=".concat(h_.attField).concat(h_.attValue?":".concat(h_.attValue):"").concat(this.eol)).join("")}}class z_ extends L_{print(_m){let h_="";return h_+=this.printGroups(_m.groups),h_+=this.printMsidSemantic(_m.msidSemantic),h_+=this.printIceLite(_m.iceLite),h_+=this.printIceUfrag(_m.iceUfrag),h_+=this.printIcePwd(_m.icePwd),h_+=this.printIceOptions(_m.iceOptions),h_+=this.printFingerprints(_m.fingerprints),h_+=this.printSetup(_m.setup),h_+=this.printTlsId(_m.tlsId),h_+=this.printIdentity(_m.identities),h_+=this.printExtmap(_m.extmaps),h_+=this.printUnrecognized(_m.unrecognized),h_}printGroups(_m){let h_="";return _m.length>0&&(h_+=_m.map(E_=>"a=group:".concat(E_.semantic).concat(E_.identificationTag.map(B_=>"".concat(_c).concat(B_)).join("")).concat(this.eol)).join("")),h_}printIceLite(_m){return _m===void 0?"":"a=ice-lite"+this.eol}printTlsId(_m){return _m?"a=tls-id:".concat(_m).concat(this.eol):""}printIdentity(_m){return _m.length===0?"":_m.map(h_=>"a=identity:".concat(h_.assertionValue).concat(h_.extensions.map(E_=>"".concat(_c).concat(E_.name).concat(E_.value?"=".concat(E_.value):"")))).join(this.eol)+this.eol}printMsidSemantic(_m){if(!_m)return"";let h_="a=msid-semantic:".concat(_m.semantic);return _m.applyForAll?h_+="".concat(_c,"*"):_m.identifierList.length>0&&(h_+=_m.identifierList.map(E_=>"".concat(_c).concat(E_))),h_+this.eol}}class r0 extends L_{print(_m){const h_=_m.attributes;let E_="";return E_+=this.printRTCP(h_.rtcp),E_+=this.printIceUfrag(h_.iceUfrag),E_+=this.printIcePwd(h_.icePwd),E_+=this.printIceOptions(h_.iceOptions),E_+=this.printCandidates(h_.candidates),E_+=this.printRemoteCandidatesList(h_.remoteCandidatesList),E_+=this.printEndOfCandidates(h_.endOfCandidates),E_+=this.printFingerprints(h_.fingerprints),E_+=this.printSetup(h_.setup),E_+=this.printMid(h_.mid),E_+=this.printExtmap(h_.extmaps),E_+=this.printRTPRelated(h_),E_+=this.printPtime(h_.ptime),E_+=this.printMaxPtime(h_.maxPtime),E_+=this.printDirection(h_.direction),E_+=this.printSSRCGroups(h_.ssrcGroups),E_+=this.printSSRC(h_.ssrcs),E_+=this.printRTCPMux(h_.rtcpMux),E_+=this.printRTCPMuxOnly(h_.rtcpMuxOnly),E_+=this.printRTCPRsize(h_.rtcpRsize),E_+=this.printMSId(h_.msids),E_+=this.printImageattr(h_.imageattr),E_+=this.printRid(h_.rids),E_+=this.printSimulcast(h_.simulcast),E_+=this.printSCTPPort(h_.sctpPort),E_+=this.printMaxMessageSize(h_.maxMessageSize),E_+=this.printUnrecognized(h_.unrecognized),E_}printCandidates(_m){return _m.map(h_=>"a=candidate:".concat(h_.foundation).concat(_c).concat(h_.componentId).concat(_c).concat(h_.transport).concat(_c).concat(h_.priority).concat(_c).concat(h_.connectionAddress).concat(_c).concat(h_.port).concat(_c,"typ").concat(_c).concat(h_.type).concat(h_.relAddr?"".concat(_c,"raddr").concat(_c).concat(h_.relAddr):"").concat(h_.relPort?"".concat(_c,"rport").concat(_c).concat(h_.relPort):"").concat(Object.keys(h_.extension).map(E_=>"".concat(_c).concat(E_).concat(_c).concat(h_.extension[E_])).join("")).concat(this.eol)).join("")}printRemoteCandidatesList(_m){return _m.map(h_=>"a=remote-candidates:".concat(h_.join(_c)).concat(this.eol)).join("")}printEndOfCandidates(_m){return _m===void 0?"":"a=end-of-candidates"+this.eol}printRTPRelated(_m){if(!_m.payloads)return"";const h_=_m.payloads;let E_="";E_+=_m.rtcpFeedbackWildcards.map(B_=>this.printRTCPFeedback("*",B_)).join("");for(const B_ of h_)E_+=this.printRtpMap(B_.payloadType,B_.rtpMap),E_+=this.printFmtp(B_.payloadType,B_.fmtp),E_+=B_.rtcpFeedbacks.map(D0=>this.printRTCPFeedback(B_.payloadType,D0)).join("");return E_}printFmtp(_m,h_){if(!h_)return"";const E_=Object.keys(h_.parameters);return E_.length===1&&h_.parameters[E_[0]]===null?"a=fmtp:".concat(_m).concat(_c).concat(E_[0]).concat(this.eol):"a=fmtp:".concat(_m).concat(_c).concat(Object.keys(h_.parameters).map(B_=>"".concat(B_,"=").concat(h_.parameters[B_])).join(";")).concat(this.eol)}printRtpMap(_m,h_){return h_?"a=rtpmap:".concat(_m).concat(_c).concat(h_.encodingName,"/").concat(h_.clockRate).concat(h_.encodingParameters?"/".concat(h_.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(_m,h_){let E_="a=rtcp-fb:".concat(_m).concat(_c),B_=h_;switch(B_.type){case"trr-int":E_+="ttr-int".concat(_c).concat(B_.interval);break;case"ack":case"nack":default:B_=B_,E_+="".concat(B_.type),B_.parameter&&(E_+="".concat(_c).concat(B_.parameter),B_.additional&&(E_+="".concat(_c).concat(B_.additional)))}return E_+this.eol}printPtime(_m){return _m===void 0?"":"a=ptime:".concat(_m).concat(this.eol)}printMaxPtime(_m){return _m===void 0?"":"a=maxptime:".concat(_m).concat(this.eol)}printDirection(_m){return _m===void 0?"":"a=".concat(_m).concat(this.eol)}printSSRC(_m){return _m.map(h_=>Object.keys(h_.attributes).map(E_=>"a=ssrc:".concat(h_.ssrcId.toString(10)).concat(_c).concat(E_).concat(h_.attributes[E_]?":".concat(h_.attributes[E_]):"").concat(this.eol)).join("")).join("")}printRTCPMux(_m){return _m===void 0?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(_m){return _m===void 0?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(_m){return _m===void 0?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(_m){if(_m===void 0)return"";let h_="a=rtcp:".concat(_m.port);return _m.netType&&(h_+="".concat(_c).concat(_m.netType)),_m.addressType&&(h_+="".concat(_c).concat(_m.addressType)),_m.address&&(h_+="".concat(_c).concat(_m.address)),h_+this.eol}printMSId(_m){return _m.map(h_=>"a=msid:".concat(h_.id).concat(h_.appdata?"".concat(_c).concat(h_.appdata):"").concat(this.eol)).join("")}printImageattr(_m){return _m.map(h_=>"a=imageattr:".concat(h_).concat(this.eol)).join("")}printRid(_m){return _m.map(h_=>{let E_="a=rid:".concat(h_.id).concat(_c).concat(h_.direction);return h_.payloads&&(E_+="".concat(_c,"pt=").concat(h_.payloads.join(","))),h_.params.length>0&&(E_+="".concat(_c).concat(h_.params.map(B_=>B_.type==="depend"?"depend=".concat(B_.rids.join(",")):"".concat(B_.type,"=").concat(B_.val)).join(";"))),E_+this.eol}).join("")}printSimulcast(_m){return _m===void 0?"":"a=simulcast:".concat(_m).concat(this.eol)}printSCTPPort(_m){return _m===void 0?"":"a=sctp-port:".concat(_m).concat(this.eol)}printMaxMessageSize(_m){return _m===void 0?"":"a=max-message-size:".concat(_m).concat(this.eol)}printMid(_m){return _m===void 0?"":"a=mid:".concat(_m).concat(this.eol)}printSSRCGroups(_m){return _m.map(h_=>"a=ssrc-group:".concat(h_.semantic).concat(h_.ssrcIds.map(E_=>"".concat(_c).concat(E_.toString(10))).join("")).concat(this.eol)).join("")}}function O0(Z_){return new TS().parse(Z_)}function eS(Z_,_m){return new AT().print(Z_,_m)}}},j={};function _t(_i){if(j[_i])return j[_i].exports;var _o=j[_i]={exports:{}};return g[_i](_o,_o.exports,_t),_o.exports}return _t.d=(_i,_o)=>{for(var ga in _o)_t.o(_o,ga)&&!_t.o(_i,ga)&&Object.defineProperty(_i,ga,{enumerable:!0,get:_o[ga]})},_t.o=(_i,_o)=>Object.prototype.hasOwnProperty.call(_i,_o),_t.r=_i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(_i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_i,"__esModule",{value:!0})},_t(8)})()})(uR);class uee{constructor(h){_h(this,"sessionDesc",void 0),_h(this,"localCapabilities",void 0),_h(this,"rtpCapabilities",void 0),_h(this,"candidates",void 0),_h(this,"iceParameters",void 0),_h(this,"dtlsParameters",void 0),_h(this,"setup",void 0),_h(this,"currentMidIndex",void 0),_h(this,"cname",void 0),h=aR(h);const{remoteIceParameters:g,remoteDtlsParameters:j,candidates:_t,remoteRTPCapabilities:_i,remoteSetup:_o,localCapabilities:ga,sdkCodec:_a,cname:_u}=h,_c=uR.exports.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE audio video
a=msid-semantic: WMS
a=ice-lite
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:audio
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendrecv
a=rtcp-mux
a=rtcp-rsize
a=mid:video
`);this.rtpCapabilities=_i,this.candidates=_t,this.iceParameters=g,this.dtlsParameters=j,this.setup=_o,this.localCapabilities=ga,this.cname=_u;for(let _l=0;_l<_c.mediaDescriptions.length;_l++){const _g=_c.mediaDescriptions[_l];_g.attributes.iceUfrag=g.iceUfrag,_g.attributes.icePwd=g.icePwd,_g.attributes.fingerprints=j.fingerprints,_g.attributes.candidates=_t,_g.attributes.setup=_o,_g.media.mediaType==="video"&&(_g.media.fmts=_i.videoCodecs.map(r_=>r_.payloadType.toString(10)),_g.attributes.payloads=_i.videoCodecs,_g.attributes.extmaps=_i.videoExtensions),_g.media.mediaType==="audio"&&(_g.media.fmts=_i.audioCodecs.map(r_=>r_.payloadType.toString(10)),_g.attributes.payloads=_i.audioCodecs,_g.attributes.extmaps=_i.audioExtensions),_c.mediaDescriptions[_l]=this.mungMediaDesc(_g)}this.sessionDesc=_c,this.currentMidIndex=_c.mediaDescriptions.length-1}toString(){return uR.exports.print(this.sessionDesc)}send(h,g,j){const{ssrcs:_t,ssrcGroups:_i}=gI(g,this.cname),_o=this.sessionDesc.mediaDescriptions.find(_u=>h===L0.VIDEO?_u.media.mediaType==="video":_u.media.mediaType==="audio"),ga=_t[0].attributes.label,_a=_t[0].attributes.mslabel;return _o.attributes.ssrcs=_o.attributes.ssrcs.concat(_t),_o.attributes.ssrcGroups=_o.attributes.ssrcGroups.concat(_i),{id:ga,mslabel:_a}}batchSend(h){return h.map(g=>{let{kind:j,ssrcMsg:_t}=g;return this.send(j,_t,void 0)})}stopSending(h){this.sessionDesc.mediaDescriptions.forEach(g=>{const j=[],_t=[],_i=[];g.attributes.ssrcs.forEach(_o=>{h.includes(_o.attributes.label||"")?_i.push(_o):j.push(_o)}),g.attributes.ssrcGroups.forEach(_o=>{_i.map(ga=>ga.ssrcId).includes(_o.ssrcIds[0])||_t.push(_o)}),g.attributes.ssrcs=j,g.attributes.ssrcGroups=_t})}mute(h){const g=this.sessionDesc.mediaDescriptions.find(j=>j.attributes.mid===h);if(!g)throw new Error("mediaDescription not found with ".concat(h," in remote SDP when calling RemoteSDP.mute."));g.attributes.direction="inactive"}unmute(h){const g=this.sessionDesc.mediaDescriptions.find(j=>j.attributes.mid===h);if(!g)throw new Error("mediaDescription not found with ".concat(h," in remote SDP when calling RemoteSDP.unmute."));g.attributes.direction="sendonly"}receive(h,g,j){h.forEach((_t,_i)=>{const _o=_t._mediaStreamTrack,ga=this.sessionDesc.mediaDescriptions.findIndex(_u=>_u.attributes.mid===_o.kind),_a=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[ga],_t);this.sessionDesc.mediaDescriptions[ga]=_a})}stopReceiving(h){}updateCandidates(h){h===DR.TCP?this.candidates.forEach(g=>{this.candidates.findIndex(j=>j.transport==="tcp"&&j.connectionAddress===g.connectionAddress&&j.port===g.port)===-1&&this.candidates.push(EH(EH({},g),{},{foundation:"tcpcandidate",priority:Number(g.priority)-1+"",transport:"tcp",port:Number(g.port)+90+""}))}):this.candidates=this.candidates.filter(g=>g.transport!=="tcp");for(const g of this.sessionDesc.mediaDescriptions)g.attributes.candidates=this.candidates}restartICE(h){h=aR(h),this.iceParameters=h,this.sessionDesc.mediaDescriptions.forEach(g=>{g.attributes.iceUfrag=h.iceUfrag,g.attributes.icePwd=h.icePwd})}predictReceivingMids(h){const g=[];for(let j=0;j<h;j++)g.push((this.currentMidIndex+j+1).toString(10));return g}mungRecvMediaDsec(h,g){const j=aR(h);return dP(j,g),o6(j,g),j}updateRecvMedia(h,g){const j=this.sessionDesc.mediaDescriptions.findIndex(_t=>_t.attributes.mid===h);if(j!==-1){const _t=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[j],g);this.sessionDesc.mediaDescriptions[j]=_t}}bumpMid(h){this.currentMidIndex+=h}updateTrackLabel(h,g,j){const _t=this.sessionDesc.mediaDescriptions.find(_o=>h===L0.VIDEO?_o.attributes.mid==="video":_o.attributes.mid==="audio");if(_t){const _o=_t.attributes.ssrcs.find(ga=>ga.attributes.label===g);var _i;_o&&(_o.attributes.label=j,(_i=_o.attributes.msid)===null||_i===void 0||_i.replace(g,j))}}mungMediaDesc(h){const g=aR(h);return i6(g),function(j){const _t=j.attributes.extmaps.find(_i=>_i.extensionName==="http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01");_t&&j.attributes.extmaps.splice(j.attributes.extmaps.indexOf(_t),1),j.attributes.payloads.forEach(_i=>{const _o=_i.rtcpFeedbacks.findIndex(ga=>ga.type==="transport-cc");_o!==-1&&_i.rtcpFeedbacks.splice(_o,1)})}(g),g}getSSRC(h){for(const g of this.sessionDesc.mediaDescriptions)for(const j of g.attributes.ssrcs)if(j.attributes.label===h)return[j]}}function DI(d){if(Array.isArray(d))return d.map(g=>g);if(!vH(d))return d;const h={};for(const g in d)vH(d[g])||Array.isArray(d[g])?h[g]=DI(d[g]):h[g]=d[g];return h}function vH(d){return!(typeof d!="object"||Array.isArray(d)||!d)}function lee(){const d=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return d&&d[0]?Number(d[0].split("/")[1]):null}function dee(d){return window.RTCStatsReport?d.getStats()instanceof a0:!1}class a6{constructor(h){_h(this,"input",[]),_h(this,"size",void 0),this.size=h}add(h){this.input.push(h),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return this.input.length===0?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}}const EN={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},NL={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:EN,remoteCandidate:EN}},_H={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},yH={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,qpSumPerFrame:0},bH={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},SH={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};function RH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function TH(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?RH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):RH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}class c6{constructor(h,g){_h(this,"onFirstVideoReceived",void 0),_h(this,"onFirstVideoDecoded",void 0),_h(this,"onFirstAudioReceived",void 0),_h(this,"onFirstVideoDecodedTimeout",void 0),_h(this,"onFirstAudioDecoded",void 0),_h(this,"onSelectedLocalCandidateChanged",void 0),_h(this,"onSelectedRemoteCandidateChanged",void 0),_h(this,"videoIsReady",!1),_h(this,"videoIsReady2",{}),_h(this,"pc",void 0),_h(this,"options",void 0),_h(this,"intervalTimer",void 0),_h(this,"stats",DI(NL)),_h(this,"isFirstVideoReceived",{}),_h(this,"isFirstVideoDecoded",{}),_h(this,"isFirstAudioReceived",{}),_h(this,"isFirstAudioDecoded",{}),_h(this,"isFirstVideoDecodedTimeout",{}),_h(this,"lossRateWindowStats",[]),this.pc=h,this.options=g,this.intervalTimer=window.setInterval(async()=>{this.updateStats()},this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new a0(h=>{h({local:TH({},EN),remote:TH({},EN)})})}setVideoIsReady(h){this.videoIsReady=h}setVideoIsReady2(h,g){this.videoIsReady2[h]=g}getVideoIsReady(h){return this.videoIsReady2[h]||!1}setIsFirstAudioDecoded(h){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(h){this.lossRateWindowStats.push(h),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const g=this.lossRateWindowStats.length,j=["videoSend","audioSend","videoRecv","audioRecv"];let _t=0,_i=0,_o=0,ga=0;for(const _a of j)h[_a].forEach((_u,_c)=>{if(!this.lossRateWindowStats[g-1][_a][_c]||!this.lossRateWindowStats[0][_a][_c])return;const _l=this.lossRateWindowStats[g-1][_a][_c].packets-this.lossRateWindowStats[0][_a][_c].packets,_g=this.lossRateWindowStats[g-1][_a][_c].packetsLost-this.lossRateWindowStats[0][_a][_c].packetsLost;_a==="videoSend"||_a==="audioSend"?(_t+=_l,_o+=_g):(_i+=_l,ga+=_g),Number.isNaN(_l)||Number.isNaN(_l)?_u.packetLostRate=0:_u.packetLostRate=_l<=0||_g<=0?0:_g/(_l+_g)});h.sendPacketLossRate=_t<=0||_o<=0?0:_o/(_t+_o),h.recvPacketLossRate=_i<=0||ga<=0?0:ga/(_i+ga)}}function wH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function pee(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?wH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):wH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}class hee extends c6{constructor(){super(...arguments),_h(this,"_stats",NL),_h(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const h=await this._getStats(),g=this.statsResponsesToObjects(h);this._stats=DI(NL);const j=g.filter(_i=>_i.type==="ssrc");this.processSSRCStats(j);const _t=g.find(_i=>_i.type==="VideoBwe");_t&&this.processBandwidthStats(_t),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(h){this._stats.bitrate={actualEncoded:Number(h.googActualEncBitrate),targetEncoded:Number(h.googTargetEncBitrate),retransmit:Number(h.googRetransmitBitrate),transmit:Number(h.googTransmitBitrate)},this._stats.sendBandwidth=Number(h.googAvailableSendBandwidth)}processSSRCStats(h){h.forEach(g=>{const j=g.id.includes("send");switch("".concat(g.mediaType,"_").concat(j?"send":"recv")){case"video_send":{const _t=DI(yH);_t.codec=g.googCodecName,_t.adaptionChangeReason="none",g.googCpuLimitedResolution&&(_t.adaptionChangeReason="cpu"),g.googBandwidthLimitedResolution&&(_t.adaptionChangeReason="bandwidth"),_t.avgEncodeMs=Number(g.googAvgEncodeMs),_t.inputFrame={width:Number(g.googFrameWidthInput)||Number(g.googFrameWidthSent),height:Number(g.googFrameHeightInput)||Number(g.googFrameHeightSent),frameRate:Number(g.googFrameRateInput)},_t.sentFrame={width:Number(g.googFrameWidthSent),height:Number(g.googFrameHeightSent),frameRate:Number(g.googFrameRateInput)},_t.firsCount=Number(g.googFirReceived),_t.nacksCount=Number(g.googNacksReceived),_t.plisCount=Number(g.googPlisReceived),_t.frameCount=Number(g.framesEncoded),_t.bytes=Number(g.bytesSent),_t.packets=Number(g.packetsSent),_t.packetsLost=Number(g.packetsLost),_t.ssrc=Number(g.ssrc),_t.rttMs=Number(g.googRtt||0),this._stats.videoSend.push(_t),this._stats.rtt=_t.rttMs;break}case"video_recv":{const _t=DI(_H),_i=this.lastDecodeVideoReceiverStats.get(Number(g.ssrc));if(_t.codec=g.googCodecName,_t.targetDelayMs=Number(g.googTargetDelayMs),_t.renderDelayMs=Number(g.googRenderDelayMs),_t.currentDelayMs=Number(g.googCurrentDelayMs),_t.minPlayoutDelayMs=Number(g.googMinPlayoutDelayMs),_t.decodeMs=Number(g.googDecodeMs),_t.maxDecodeMs=Number(g.googMaxDecodeMs),_t.receivedFrame={width:Number(g.googFrameWidthReceived),height:Number(g.googFrameHeightReceived),frameRate:Number(g.googFrameRateReceived)},_t.decodedFrame={width:Number(g.googFrameWidthReceived),height:Number(g.googFrameHeightReceived),frameRate:Number(g.googFrameRateDecoded)},_t.decodeFrameRate=Number(g.googFrameRateDecoded),_t.outputFrame={width:Number(g.googFrameWidthReceived),height:Number(g.googFrameHeightReceived),frameRate:Number(g.googFrameRateOutput)},_t.jitterBufferMs=Number(g.googJitterBufferMs),_t.firsCount=Number(g.googFirsSent),_t.nacksCount=Number(g.googNacksSent),_t.plisCount=Number(g.googPlisSent),_t.framesDecodeCount=Number(g.framesDecoded),_t.bytes=Number(g.bytesReceived),_t.packets=Number(g.packetsReceived),_t.packetsLost=Number(g.packetsLost),_t.ssrc=Number(g.ssrc),_t.packets>0&&!this.isFirstVideoReceived[_t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(_t.ssrc),this.isFirstVideoReceived[_t.ssrc]=!0),_t.framesDecodeCount>0&&!this.isFirstVideoDecoded[_t.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(_t.ssrc,_t.decodedFrame.width,_t.decodedFrame.height),this.isFirstVideoDecoded[_t.ssrc]=!0),_i){const _o=_i.stats,ga=Date.now()-_i.lts;_t.framesDecodeFreezeTime=_o.framesDecodeFreezeTime,_t.framesDecodeInterval=_o.framesDecodeInterval,_t.framesDecodeCount>_o.framesDecodeCount&&this.isFirstVideoDecoded[_t.ssrc]?(_i.lts=Date.now(),_t.framesDecodeInterval=ga,_t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(g.ssrc,10))?_t.framesDecodeFreezeTime+=_t.framesDecodeInterval:this.setVideoIsReady2(parseInt(g.ssrc,10),!0))):_t.framesDecodeCount<_i.stats.framesDecodeCount&&(_t.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(_t.ssrc,{stats:pee({},_t),lts:Date.now()}),this._stats.videoRecv.push(_t);break}case"audio_recv":{const _t=DI(SH);_t.codec=g.googCodecName,_t.outputLevel=Math.abs(Number(g.audioOutputLevel))/32767,_t.decodingCNG=Number(g.googDecodingCNG),_t.decodingCTN=Number(g.googDecodingCTN),_t.decodingCTSG=Number(g.googDecodingCTSG),_t.decodingNormal=Number(g.googDecodingNormal),_t.decodingPLC=Number(g.googDecodingPLC),_t.decodingPLCCNG=Number(g.googDecodingPLCCNG),_t.expandRate=Number(g.googExpandRate),_t.accelerateRate=Number(g.googAccelerateRate),_t.preemptiveExpandRate=Number(g.googPreemptiveExpandRate),_t.secondaryDecodedRate=Number(g.googSecondaryDecodedRate),_t.speechExpandRate=Number(g.googSpeechExpandRate),_t.preferredJitterBufferMs=Number(g.googPreferredJitterBufferMs),_t.jitterBufferMs=Number(g.googJitterBufferMs),_t.jitterMs=Number(g.googJitterReceived),_t.bytes=Number(g.bytesReceived),_t.packets=Number(g.packetsReceived),_t.packetsLost=Number(g.packetsLost),_t.ssrc=Number(g.ssrc),_t.receivedFrames=Number(g.googDecodingCTN)||Number(g.packetsReceived),_t.droppedFrames=Number(g.googDecodingPLC)+Number(g.googDecodingPLCCNG)||Number(g.packetsLost),_t.receivedFrames>0&&!this.isFirstAudioReceived[_t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(_t.ssrc),this.isFirstAudioReceived[_t.ssrc]=!0),_t.decodingNormal>0&&!this.isFirstAudioDecoded[_t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(_t.ssrc),this.isFirstAudioDecoded[_t.ssrc]=!0),this._stats.audioRecv.push(_t);break}case"audio_send":{const _t=DI(bH);_t.codec=g.googCodecName,_t.inputLevel=Math.abs(Number(g.audioInputLevel))/32767,_t.aecReturnLoss=Number(g.googEchoCancellationReturnLoss||0),_t.aecReturnLossEnhancement=Number(g.googEchoCancellationReturnLossEnhancement||0),_t.residualEchoLikelihood=Number(g.googResidualEchoLikelihood||0),_t.residualEchoLikelihoodRecentMax=Number(g.googResidualEchoLikelihoodRecentMax||0),_t.bytes=Number(g.bytesSent),_t.packets=Number(g.packetsSent),_t.packetsLost=Number(g.packetsLost),_t.ssrc=Number(g.ssrc),_t.rttMs=Number(g.googRtt||0),this._stats.rtt=_t.rttMs,this._stats.audioSend.push(_t);break}}})}_getStats(){return new a0((h,g)=>{this.pc.getStats(h,g)})}statsResponsesToObjects(h){const g=[];return h.result().forEach(j=>{const _t={id:j.id,timestamp:j.timestamp.valueOf().toString(),type:j.type};j.names().forEach(_i=>{_t[_i]=j.stat(_i)}),g.push(_t)}),g}}function CH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function d1(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?CH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):CH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}class IH extends c6{constructor(){super(...arguments),_h(this,"_stats",NL),_h(this,"report",void 0),_h(this,"lastDecodeVideoReceiverStats",new Map),_h(this,"lastVideoFramesRecv",new Map),_h(this,"lastVideoFramesSent",new Map),_h(this,"lastVideoFramesDecode",new Map),_h(this,"lastVideoJBDelay",new Map),_h(this,"lastAudioJBDelay",new Map),_h(this,"mediaBytesSent",new Map),_h(this,"mediaBytesRetransmit",new Map),_h(this,"mediaBytesTargetEncode",new Map),_h(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=DI(NL),this.report.forEach(h=>{switch(h.type){case RT.OUTBOUND:case RT.INBOUND:{const g=h.mediaType||h.kind,j=!g&&"frameWidth"in h,_t=!g&&!("frameWidth"in h);h.type===RT.OUTBOUND?g==="audio"||_t?this.processAudioOutboundStats(h):(g==="video"||j)&&this.processVideoOutboundStats(h):h.type===RT.INBOUND&&(g==="audio"||_t?this.processAudioInboundStats(h):(g==="video"||j)&&this.processVideoInboundStats(h));break}case RT.TRANSPORT:{const g=this.report.get(h.selectedCandidatePairId);g&&this.processCandidatePairStats(g);break}case RT.CANDIDATE_PAIR:h.selected&&this.processCandidatePairStats(h)}}),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const h=await this.pc.getStats(),g={local:d1({},EN),remote:d1({},EN)};return h.forEach(j=>{let _t;if(j.type===RT.TRANSPORT&&(_t=h.get(j.selectedCandidatePairId)),j.type===RT.CANDIDATE_PAIR&&j.selected&&(_t=j),_t){const _i=(_o,ga)=>{_o.type=ga.type,_o.id=ga.id,ga.address&&(_o.address=ga.address),ga.candidateType&&(_o.candidateType=ga.candidateType),ga.port&&(_o.port=ga.port),ga.priority&&(_o.priority=ga.priority),ga.protocol&&(_o.protocol=ga.protocol),ga.relayProtocol&&(_o.relayProtocol=ga.relayProtocol)};if(_t.localCandidateId){const _o=h.get(_t.localCandidateId);_o&&_i(g.local,_o)}if(_t.remoteCandidateId){const _o=h.get(_t.remoteCandidateId);_o&&_i(g.remote,_o)}}}),g}processCandidatePairStats(h){if(this._stats.sendBandwidth=h.availableOutgoingBitrate||0,h.currentRoundTripTime&&(this._stats.rtt=1e3*h.currentRoundTripTime),this._stats.videoSend.forEach(g=>{h.currentRoundTripTime&&(g.rttMs=1e3*h.currentRoundTripTime)}),this._stats.audioSend.forEach(g=>{h.currentRoundTripTime&&(g.rttMs=1e3*h.currentRoundTripTime)}),this._stats.selectedCandidatePair.id=h.id,h.localCandidateId){const g=this.report.get(h.localCandidateId);g&&this.processCandidateStats(g)}if(h.remoteCandidateId){const g=this.report.get(h.remoteCandidateId);g&&this.processCandidateStats(g)}}processCandidateStats(h){let g;h.type===RT.LOCAL_CANDIDATE&&(g=this._stats.selectedCandidatePair.localCandidate),h.type===RT.REMOTE_CANDIDATE&&(g=this._stats.selectedCandidatePair.remoteCandidate),g&&(g.type=h.type,g.id=h.id,h.address&&(g.address=h.address),h.candidateType&&(g.candidateType=h.candidateType),h.port&&(g.port=h.port),h.priority&&(g.priority=h.priority),h.protocol&&(g.protocol=h.protocol),h.relayProtocol&&(g.relayProtocol=h.relayProtocol),h.type===RT.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==g.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(d1({},g),d1({},this.stats.selectedCandidatePair.localCandidate)),h.type===RT.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==g.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(d1({},g),d1({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(h){let g=this._stats.audioRecv.find(j=>j.ssrc===h.ssrc);g||(g=DI(SH),this._stats.audioRecv.push(g)),g.ssrc=h.ssrc,g.packets=h.packetsReceived,g.packetsLost=h.packetsLost,g.bytes=h.bytesReceived,g.jitterMs=1e3*h.jitter,this.processAudioTrackReceiverStats(h,h.trackId,g),h.codecId&&(g.codec=this.getCodecFromCodecStats(h.codecId)),g.receivedFrames||(g.receivedFrames=h.packetsReceived),g.droppedFrames||(g.droppedFrames=h.packetsLost),g.receivedFrames>0&&!this.isFirstAudioReceived[g.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(g.ssrc),this.isFirstAudioReceived[g.ssrc]=!0),g.outputLevel&&g.outputLevel>0&&!this.isFirstAudioDecoded[g.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(g.ssrc),this.isFirstAudioDecoded[g.ssrc]=!0),typeof h.concealedSamples=="number"&&(g.concealedSamples=h.concealedSamples)}processVideoInboundStats(h){let g=this._stats.videoRecv.find(_o=>_o.ssrc===h.ssrc);g||(g=DI(_H),this._stats.videoRecv.push(g)),g.ssrc=h.ssrc,g.packets=h.packetsReceived,g.packetsLost=h.packetsLost,g.bytes=h.bytesReceived,g.firsCount=h.firCount,g.nacksCount=h.nackCount,g.plisCount=h.pliCount,g.framesDecodeCount=h.framesDecoded,g.totalInterFrameDelay=h.totalInterFrameDelay,g.totalSquaredInterFrameDelay=h.totalSquaredInterFrameDelay;const j=this.lastDecodeVideoReceiverStats.get(g.ssrc),_t=this.lastVideoFramesDecode.get(g.ssrc),_i=Date.now();if(g.framesDecodeCount>0&&!this.isFirstVideoDecoded[g.ssrc]){const _o=g.decodedFrame?g.decodedFrame.width:0,ga=g.decodedFrame?g.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(g.ssrc,_o,ga),this.isFirstVideoDecoded[g.ssrc]=!0}if(j){const _o=j.stats,ga=_i-j.lts;g.framesDecodeFreezeTime=_o.framesDecodeFreezeTime,g.framesDecodeInterval=_o.framesDecodeInterval,!this.isFirstVideoDecoded[g.ssrc]&&ga>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[g.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(g.ssrc),this.isFirstVideoDecodedTimeout[g.ssrc]=!0),g.framesDecodeCount>_o.framesDecodeCount&&this.isFirstVideoDecoded[g.ssrc]?(j.lts=Date.now(),g.framesDecodeInterval=ga,g.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(h.ssrc))?g.framesDecodeFreezeTime+=g.framesDecodeInterval:this.setVideoIsReady2(parseInt(h.ssrc,10),!0))):g.framesDecodeCount<_o.framesDecodeCount&&(g.framesDecodeInterval=0),h.framesDecoded&&h.qpSum&&(j.stats.framesDecodeCount>h.framesDecoded?g.qpSumPerFrame=h.qpSum/h.framesDecoded:g.qpSumPerFrame=(h.qpSum-j.qpSum)/(h.framesDecoded-j.stats.framesDecodeCount))}_t&&_i-_t.lts>=800?(g.decodeFrameRate=Math.round((g.framesDecodeCount-_t.count)/((_i-_t.lts)/1e3)),this.lastVideoFramesDecode.set(g.ssrc,{count:g.framesDecodeCount,lts:_i,rate:g.decodeFrameRate})):_t?g.decodeFrameRate=_t.rate:this.lastVideoFramesDecode.set(g.ssrc,{count:g.framesDecodeCount,lts:_i,rate:0}),h.totalDecodeTime&&(g.decodeMs=1e3*h.totalDecodeTime),this.processVideoTrackReceiverStats(h,h.trackId,g),h.codecId&&(g.codec=this.getCodecFromCodecStats(h.codecId)),h.framerateMean&&(g.framesRateFirefox=h.framerateMean),g.packets>0&&!this.isFirstVideoReceived[g.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(g.ssrc),this.isFirstVideoReceived[g.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(g.ssrc,{stats:d1({},g),lts:j?j.lts:Date.now(),qpSum:h.qpSum})}processVideoOutboundStats(h){let g=this._stats.videoSend.find(_t=>_t.ssrc===h.ssrc);g||(g=DI(yH),this._stats.videoSend.push(g));const j=this.mediaBytesSent.get(h.ssrc);if(j)j.add(h.bytesSent);else{const _t=new a6(10);_t.add(h.bytesSent),this.mediaBytesSent.set(h.ssrc,_t)}if(h.retransmittedBytesSent!==void 0){const _t=this.mediaBytesRetransmit.get(h.ssrc);if(_t)_t.add(h.retransmittedBytesSent);else{const _i=new a6(10);_i.add(h.retransmittedBytesSent),this.mediaBytesRetransmit.set(h.ssrc,_i)}}if(h.totalEncodedBytesTarget){const _t=this.mediaBytesTargetEncode.get(h.ssrc);if(_t)_t.add(h.totalEncodedBytesTarget);else{const _i=new a6(10);_i.add(h.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(h.ssrc,_i)}}if(g.ssrc=h.ssrc,g.bytes=h.bytesSent,g.packets=h.packetsSent,g.firsCount=h.firCount,g.nacksCount=h.nackCount,g.plisCount=h.pliCount,g.frameCount=h.framesEncoded,g.adaptionChangeReason=h.qualityLimitationReason,g.scalabilityMode=h.scalabilityMode,h.totalEncodeTime&&h.framesEncoded){const _t=this.lastEncoderMs.get(h.ssrc);if(!_t||_t.lastFrameCount>h.framesEncoded)g.avgEncodeMs=1e3*h.totalEncodeTime/h.framesEncoded;else{const _i=h.framesEncoded-_t.lastFrameCount,_o=h.totalEncodeTime-_t.lastEncoderTime;g.avgEncodeMs=1e3*_o/_i}}if(h.framesEncoded&&h.qpSum){const _t=this.lastEncoderMs.get(h.ssrc);!_t||_t.lastFrameCount>h.framesEncoded?g.qpSumPerFrame=h.qpSum/h.framesEncoded:g.qpSumPerFrame=(h.qpSum-_t.lastQpSum)/(h.framesEncoded-_t.lastFrameCount)}if(this.lastEncoderMs.set(h.ssrc,{lastFrameCount:h.framesEncoded,lastEncoderTime:h.totalEncodeTime,lastQpSum:h.qpSum,lts:Date.now()}),h.codecId&&(g.codec=this.getCodecFromCodecStats(h.codecId)),h.mediaSourceId&&this.processVideoMediaSource(h.mediaSourceId,g),this.processVideoTrackSenderStats(h,h.trackId,g),h.remoteId)this.processRemoteInboundStats(h.remoteId,g);else{const _t=this.findRemoteStatsId(h.ssrc,RT.REMOTE_INBOUND);_t&&this.processRemoteInboundStats(_t,g)}}processAudioOutboundStats(h){let g=this._stats.audioSend.find(j=>j.ssrc===h.ssrc);if(g||(g=DI(bH),this._stats.audioSend.push(g)),g.ssrc=h.ssrc,g.packets=h.packetsSent,g.bytes=h.bytesSent,h.mediaSourceId&&this.processAudioMediaSource(h.mediaSourceId,g),h.codecId&&(g.codec=this.getCodecFromCodecStats(h.codecId)),this.processAudioTrackSenderStats(h,h.trackId,g),h.remoteId)this.processRemoteInboundStats(h.remoteId,g);else{const j=this.findRemoteStatsId(h.ssrc,RT.REMOTE_INBOUND);j&&this.processRemoteInboundStats(j,g)}}findRemoteStatsId(h,g){var j;const _t=Array.from(mO(j=this.report).call(j)).find(_i=>_i.type===g&&_i.ssrc===h);return _t?_t.id:null}processVideoMediaSource(h,g){const j=this.report.get(h);j&&j.width&&j.height&&j.framesPerSecond&&(g.inputFrame={width:j.width,height:j.height,frameRate:j.framesPerSecond})}processAudioMediaSource(h,g){const j=this.report.get(h);j&&(g.inputLevel=j.audioLevel)}processVideoTrackSenderStats(h,g,j){var _t,_i,_o;const ga=g?this.report.get(g):void 0,_a=(_t=ga==null?void 0:ga.framesSent)!==null&&_t!==void 0?_t:h.framesSent;let _u=(_i=ga==null?void 0:ga.frameWidth)!==null&&_i!==void 0?_i:h.frameWidth,_c=(_o=ga==null?void 0:ga.frameHeight)!==null&&_o!==void 0?_o:h.frameHeight;if(typeof _a!="number")return;typeof _u=="number"&&typeof _c=="number"||(_u=0,_c=0);let _l=0;const _g=Date.now(),r_=this.lastVideoFramesSent.get(j.ssrc);r_&&_g-r_.lts>=800?(_l=Math.round((_a-r_.count)/((_g-r_.lts)/1e3)),this.lastVideoFramesSent.set(j.ssrc,{count:_a,lts:_g,rate:_l})):r_?_l=r_.rate:this.lastVideoFramesSent.set(j.ssrc,{count:_a,lts:_g,rate:0}),j.sentFrame={width:_u,height:_c,frameRate:Math.max(0,_l)}}processVideoTrackReceiverStats(h,g,j){var _t,_i,_o,ga,_a;const _u=g?this.report.get(g):void 0,_c=(_t=_u==null?void 0:_u.framesReceived)!==null&&_t!==void 0?_t:h.framesReceived,_l=(_i=_u==null?void 0:_u.frameWidth)!==null&&_i!==void 0?_i:h.frameWidth,_g=(_o=_u==null?void 0:_u.frameHeight)!==null&&_o!==void 0?_o:h.frameHeight,r_=(ga=_u==null?void 0:_u.jitterBufferDelay)!==null&&ga!==void 0?ga:h.jitterBufferDelay,l_=(_a=_u==null?void 0:_u.jitterBufferEmittedCount)!==null&&_a!==void 0?_a:h.jitterBufferEmittedCount;if(typeof _c=="number"){const d_=this.lastVideoFramesRecv.get(j.ssrc),p_=Date.now();j.framesReceivedCount=_c;let C_=0;d_&&p_-d_.lts>=800?(C_=Math.round((_c-d_.count)/((p_-d_.lts)/1e3)),this.lastVideoFramesRecv.set(j.ssrc,{count:_c,lts:p_,rate:C_})):d_?C_=d_.rate:this.lastVideoFramesRecv.set(j.ssrc,{count:_c,lts:p_,rate:0}),j.receivedFrame={width:_l||0,height:_g||0,frameRate:C_||0},j.decodedFrame={width:_l||0,height:_g||0,frameRate:j.decodeFrameRate||0},j.outputFrame={width:_l||0,height:_g||0,frameRate:j.decodeFrameRate||0}}if(r_&&l_){let d_=this.lastVideoJBDelay.get(j.ssrc);this.lastVideoJBDelay.set(j.ssrc,{jitterBufferDelay:r_,jitterBufferEmittedCount:l_}),d_||(d_={jitterBufferDelay:0,jitterBufferEmittedCount:0});const p_=1e3*(r_-d_.jitterBufferDelay)/(l_-d_.jitterBufferEmittedCount);j.jitterBufferMs=p_,j.currentDelayMs=Math.round(p_)}}processAudioTrackSenderStats(h,g,j){var _t,_i,_o,ga;const _a=g?this.report.get(g):void 0,_u=(_t=(_i=_a==null?void 0:_a.echoReturnLoss)!==null&&_i!==void 0?_i:h.echoReturnLoss)!==null&&_t!==void 0?_t:0,_c=(_o=(ga=_a==null?void 0:_a.echoReturnLossEnhancement)!==null&&ga!==void 0?ga:h.echoReturnLossEnhancement)!==null&&_o!==void 0?_o:0;j.aecReturnLoss=_u,j.aecReturnLossEnhancement=_c}processAudioTrackReceiverStats(h,g,j){var _t,_i,_o,ga,_a,_u,_c;const _l=g?this.report.get(g):void 0,_g=(_t=_l==null?void 0:_l.removedSamplesForAcceleration)!==null&&_t!==void 0?_t:h.removedSamplesForAcceleration,r_=(_i=_l==null?void 0:_l.totalSamplesReceived)!==null&&_i!==void 0?_i:h.totalSamplesReceived,l_=(_o=_l==null?void 0:_l.jitterBufferDelay)!==null&&_o!==void 0?_o:h.jitterBufferDelay,d_=(ga=_l==null?void 0:_l.jitterBufferEmittedCount)!==null&&ga!==void 0?ga:h.jitterBufferEmittedCount,p_=(_a=_l==null?void 0:_l.audioLevel)!==null&&_a!==void 0?_a:h==null?void 0:h.audioLevel,C_=(_u=_l==null?void 0:_l.totalSamplesDuration)!==null&&_u!==void 0?_u:h==null?void 0:h.totalSamplesDuration,O_=(_c=_l==null?void 0:_l.concealedSamples)!==null&&_c!==void 0?_c:h.concealedSamples;if(_g&&r_&&(j.accelerateRate=_g/r_),l_&&d_){let c0=this.lastAudioJBDelay.get(j.ssrc);this.lastAudioJBDelay.set(j.ssrc,{jitterBufferDelay:l_,jitterBufferEmittedCount:d_}),c0||(c0={jitterBufferDelay:0,jitterBufferEmittedCount:0});const K_=1e3*(l_-c0.jitterBufferDelay)/(d_-c0.jitterBufferEmittedCount);j.jitterBufferMs=Math.round(K_)}j.outputLevel=p_;let q_=1920;C_&&r_&&(q_=r_/C_/50,j.receivedFrames=Math.round(r_/q_)),O_&&(j.droppedFrames=Math.round(O_/q_))}processRemoteInboundStats(h,g){const j=this.report.get(h);j&&(g.packetsLost=j.packetsLost,j.roundTripTime&&(g.rttMs=1e3*j.roundTripTime))}getCodecFromCodecStats(h){const g=this.report.get(h);if(!g)return"";const j=g.mimeType.match(/\/(.*)$/);return j&&j[1]?j[1]:""}updateSendBitrate(){let h=0,g=null,j=null;this.mediaBytesSent.forEach(_i=>{h+=_i.diffMean()}),this.mediaBytesRetransmit.forEach(_i=>{g=g===null?_i.diffMean():g+_i.diffMean()}),this.mediaBytesTargetEncode.forEach(_i=>{j=j===null?_i.diffMean():j+_i.diffMean()});const _t=g!==null?h-g:h;this._stats.bitrate={actualEncoded:8*_t/(this.options.updateInterval/1e3),transmit:8*h/(this.options.updateInterval/1e3)},g!==null&&(this._stats.bitrate.retransmit=8*g/(this.options.updateInterval/1e3)),j!==null&&(this._stats.bitrate.targetEncoded=8*j/(this.options.updateInterval/1e3))}}class fee extends c6{updateStats(){return a0.resolve()}}function u6(d){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:250,g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:8,j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:500,_t=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1e4;const _i=lee();return _i?_i<76?new hee(d,{updateInterval:h,lossRateInterval:g,freezeRateLimit:j,firstVideoDecodedTimeout:_t}):new IH(d,{updateInterval:h,lossRateInterval:g,freezeRateLimit:j,firstVideoDecodedTimeout:_t}):dee(d)?new IH(d,{updateInterval:h,lossRateInterval:g,freezeRateLimit:j,firstVideoDecodedTimeout:_t}):new fee(d,{updateInterval:h,lossRateInterval:g,freezeRateLimit:j,firstVideoDecodedTimeout:_t})}var mS;function OH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function AH(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?OH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):OH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}let kL=(G_((mS=class LL extends OU{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}constructor(h,g){super(h,g),_h(this,"store",void 0),_h(this,"peerConnection",void 0),_h(this,"remoteSDP",void 0),_h(this,"initialOffer",void 0),_h(this,"statsFilter",void 0),_h(this,"useRTX",!1),_h(this,"localCapabilities",void 0),_h(this,"localCandidateCount",0),_h(this,"allCandidatesReceived",!1),_h(this,"establishPromise",void 0),_h(this,"mutex",new lT("P2PConnection-mutex")),this.store=g,this.peerConnection=new RTCPeerConnection(LL.resolvePCConfiguration(h),{optional:[{googDscp:!0}]}),this.statsFilter=u6(this.peerConnection,__("STATS_UPDATE_INTERVAL"),void 0,GS()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const h=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!h.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const g=l1(h.sdp),j=r6(h.sdp,!this.useRTX,__("FILTER_VIDEO_FEC"),__("FILTER_AUDIO_FEC"),["opus"]);return this.localCapabilities=j,this.initialOffer=h,AH(AH({},g),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:j},offerSDP:h.sdp})}catch(h){throw new f_(c_.GET_LOCAL_CONNECTION_PARAMS_FAILED,h.toString())}}async connect(h,g,j,_t,_i,_o){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new uee({remoteIceParameters:h,remoteDtlsParameters:g,candidates:j,remoteRTPCapabilities:_t.send,remoteSetup:_i,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:_o});const ga=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:ga})}catch(ga){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(ga.toString()))}}send(h,g){var j=this;return xI(function*(){const _t=yield $0(j.mutex.lock());try{if(!j.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const _i=h.map(_g=>j.peerConnection.addTrack(_g._mediaStreamTrack)),_o=yield $0(j.peerConnection.createOffer()),ga=uR.exports.parse(_o.sdp),_a=h.map(_g=>{const r_=_g._mediaStreamTrack,l_=ga.mediaDescriptions.find(d_=>d_.attributes.mid===r_.kind);if(!l_)throw new Error("Cannot extract ssrc from mediaDescription.");return function(d_,p_,C_){const O_=d_.attributes.ssrcs.filter(c0=>c0.attributes.label===p_),q_=d_.attributes.ssrcGroups;if(O_.length===0)throw new Error("Cannot extract ssrc from plan-b SDP.");if(q_&&O_.length>1){const c0=q_.find(K_=>K_.ssrcIds.indexOf(O_[0].ssrcId)!==-1);return c0?[{ssrcId:c0.ssrcIds[0],rtx:C_?c0.ssrcIds[1]:void 0}]:[{ssrcId:O_[0].ssrcId}]}return[{ssrcId:O_[0].ssrcId}]}(l_,r_.id,j.useRTX)});let _u;try{_u=yield _a}catch(_g){throw _i.forEach(r_=>{sT()&&r_.replaceTrack(null),j.peerConnection.removeTrack(r_)}),_g}const _c=j.mungSendOfferSDP(_o.sdp,h);j.remoteSDP.receive(h,g,_u);const _l=j.remoteSDP.toString();return yield $0(j.peerConnection.setLocalDescription({type:"offer",sdp:_c})),yield $0(j.applySendEncodings(_i,h)),yield $0(j.peerConnection.setRemoteDescription({type:"answer",sdp:_l})),h.map((_g,r_)=>{const l_=_g._mediaStreamTrack.id;return{localSSRC:_a[r_],id:l_}})}catch(_i){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(_i.toString()))}finally{_t()}})()}async stopSending(h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const g=this.peerConnection.getSenders().filter(_i=>{var _o;return h.indexOf(((_o=_i.track)===null||_o===void 0?void 0:_o.id)||"")!==-1});if(g.length!==h.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");g.map(_i=>{sT()&&_i.replaceTrack(null),this.peerConnection.removeTrack(_i)});const j=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(j),this.remoteSDP.stopReceiving(h);const _t=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:_t})}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(g.toString()))}}async receive(h,g,j,_t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(h," before remoteSDP created."));const{id:_i,mslabel:_o}=this.remoteSDP.send(h,g,_t),ga=new a0((_c,_l)=>{const _g=setTimeout(()=>{_l(new Error("Cannot receive track, id: ".concat(_i)))},1e4),r_=l_=>{const d_=sS();if((d_.name==="Safari"&&Number(d_.version)===11||aT())&&l_.track.id!==_i&&l_.streams[0].id===_o){var p_;const C_=l_.streams[0].getTracks()[0];return(p_=this.remoteSDP)===null||p_===void 0||p_.updateTrackLabel(h,_i,l_.track.id),this.peerConnection.removeEventListener("track",r_),clearTimeout(_g),void _c(C_)}if(l_.track.id===_i)return this.peerConnection.removeEventListener("track",r_),clearTimeout(_g),void _c(l_.track)};this.peerConnection.addEventListener("track",r_)}),_a=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_a});const _u=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(_u),{track:await ga,id:_i}}catch(_i){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_i.toString()))}}async stopReceiving(h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(h);const g=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const j=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(j)}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(g.toString()))}}async muteRemote(h){}async unmuteRemote(h){}async muteLocal(h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const g=this.peerConnection.getSenders().filter(j=>{var _t;return h.indexOf(((_t=j.track)===null||_t===void 0?void 0:_t.id)||"")!==-1});if(g.length!==h.length)throw new Error("sender' length doesn't match mids' length.");g.map(j=>{if(sT()&&j.track)j.track.enabled=!1;else{const _t=j.getParameters();_t.encodings.forEach(_i=>_i.active=!1),j.setParameters(_t)}})}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(g.toString()))}}async unmuteLocal(h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const g=this.peerConnection.getSenders().filter(_i=>{var _o;return h.indexOf(((_o=_i.track)===null||_o===void 0?void 0:_o.id)||"")!==-1});if(g.length!==h.length)throw new Error("Senders' length doesn't match mids' length.");g.map(async _i=>{if(sT()&&_i.track)_i.track.enabled=!0;else{const _o=_i.getParameters();_o.encodings.forEach(ga=>ga.active=!0),await _i.setParameters(_o)}});const j=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(j);const _t=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:_t})}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(g.toString()))}}restartICE(h){var g=this;return xI(function*(){const j=yield $0(g.mutex.lock("From P2PConnection.restartICE"));try{if(!g.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(QS().supportPCSetConfiguration){const _a=g.peerConnection.getConfiguration(),_u=h===DR.RELAY?"relay":"all";_a.iceTransportPolicy!==_u&&(wE.debug("[".concat(g.store.clientId,"] restartICE change iceTransportPolicy from [").concat(_a.iceTransportPolicy,"] to [").concat(_u,"]")),_a.iceTransportPolicy=_u,g.peerConnection.setConfiguration(_a))}else if(h===DR.RELAY)return;h!==DR.RELAY&&g.remoteSDP.updateCandidates(h);const _t=yield $0(g.peerConnection.createOffer({iceRestart:!0}));if(!_t.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const _i=l1(_t.sdp),{remoteIceParameters:_o}=yield _i.iceParameters;g.remoteSDP.restartICE(_o);const ga=g.remoteSDP.toString();yield $0(g.peerConnection.setLocalDescription(_t)),yield $0(g.peerConnection.setRemoteDescription({type:"answer",sdp:ga}))}catch(_t){wE.warning("[".concat(g.store.clientId,"] restart ICE failed, abort operation"),_t)}finally{j()}})()}close(){var h;this.peerConnection.close(),(h=this.onConnectionStateChange)===null||h===void 0||h.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(h){return this.statsFilter.getVideoIsReady(h)}async updateEncoderConfig(h,g){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const j=await this.peerConnection.createOffer(),_t=this.mungSendOfferSDP(j.sdp,[g]);this.remoteSDP.updateRecvMedia(g._mediaStreamTrack.kind,g);const _i=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:_t}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(j){throw new f_(c_.EXCHANGE_SDP_FAILED,j.toString())}}async updateSendParameters(h,g){const j=this.peerConnection.getSenders().filter(_t=>{var _i;return((_i=_t.track)===null||_i===void 0?void 0:_i.id)===h});j.length===1&&await this.applySendEncodings(j,[g])}setStatsRemoteVideoIsReady(h,g){this.statsFilter.setVideoIsReady2(h,g)}async replaceTrack(h,g){const j=this.peerConnection.getSenders().find(_t=>{var _i;return((_i=_t.track)===null||_i===void 0?void 0:_i.id)===g});j&&await j.replaceTrack(h._mediaStreamTrack)}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var h;(h=this.onICEConnectionStateChange)===null||h===void 0||h.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var h;(h=this.onConnectionStateChange)===null||h===void 0||h.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=h=>{h.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,wE.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,wE.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},__("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(h){const g={iceServers:[],sdpSemantics:"plan-b"};return h.iceServers?g.iceServers=h.iceServers:h.turnServer&&h.turnServer.mode!=="off"&&(fL(h.turnServer.servers)?g.iceServers=h.turnServer.servers:(g.iceServers&&g.iceServers.push(...LL.turnServerConfigToIceServers(h.turnServer.servers)),__("USE_TURN_SERVER_OF_GATEWAY")&&g.iceServers&&h.turnServer.serversFromGateway&&g.iceServers.push(...LL.turnServerConfigToIceServers(h.turnServer.serversFromGateway)),h.turnServer.servers.concat(h.turnServer.serversFromGateway||[]).forEach(j=>{j.forceturn&&(g.iceTransportPolicy="relay")}))),g}static turnServerConfigToIceServers(h){const g=[];return h.forEach(j=>{j.security?j.tcpport&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turns:".concat(j.turnServerURL,":").concat(j.tcpport,"?transport=tcp")}):(j.udpport&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turn:".concat(j.turnServerURL,":").concat(j.udpport,"?transport=udp")}),j.tcpport&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turn:".concat(j.turnServerURL,":").concat(j.tcpport,"?transport=tcp")}))}),g}async applySendEncodings(h,g){try{if(!QS().supportSetRtpSenderParameters||h.length!==g.length)return;for(let _t=0;_t<h.length;_t++){var j;const _i=h[_t],_o=g[_t];if(!_o)continue;const ga={},_a={};if(_o instanceof cR)switch(_o._optimizationMode){case"motion":ga.degradationPreference="maintain-framerate";break;case"detail":ga.degradationPreference="maintain-resolution";break;default:ga.degradationPreference="balanced"}if(__("DSCP_TYPE")&&YN()){const _l=__("DSCP_TYPE");["very-low","low","medium","high"].includes(_l)&&(_a.networkPriority=_l)}const _u=_i.getParameters(),_c=(j=_u.encodings)===null||j===void 0?void 0:j[0];_c&&Object.assign(_c,_a),Object.assign(_u,ga),await _i.setParameters(_u)}}catch{wE.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(h,g){const j=uR.exports.parse(h);return g.forEach((_t,_i)=>{const _o=_t._mediaStreamTrack,ga=j.mediaDescriptions.find(_a=>_a.attributes.mid===_o.kind);ga&&dP(ga,_t)}),uR.exports.print(j)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=h=>{var g;(g=this.onFirstAudioReceived)===null||g===void 0||g.call(this,h)},this.statsFilter.onFirstVideoReceived=h=>{var g;(g=this.onFirstVideoReceived)===null||g===void 0||g.call(this,h)},this.statsFilter.onFirstAudioDecoded=h=>{var g;(g=this.onFirstAudioDecoded)===null||g===void 0||g.call(this,h)},this.statsFilter.onFirstVideoDecoded=(h,g,j)=>{var _t;(_t=this.onFirstVideoDecoded)===null||_t===void 0||_t.call(this,h,g,j)},this.statsFilter.onSelectedLocalCandidateChanged=(h,g)=>{var j;(j=this.onSelectedLocalCandidateChanged)===null||j===void 0||j.call(this,h,g)},this.statsFilter.onSelectedRemoteCandidateChanged=(h,g)=>{var j;(j=this.onSelectedRemoteCandidateChanged)===null||j===void 0||j.call(this,h,g)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const g=this.remoteSDP.batchSend(h).map((_i,_o)=>{let{id:ga,mslabel:_a}=_i;const{kind:_u}=h[_o];return new a0((_c,_l)=>{const _g=setTimeout(()=>{_l(new Error("Cannot receive track, id: ".concat(ga)))},1e4),r_=l_=>{const d_=sS();if(d_.name==="Safari"&&Number(d_.version)===11&&l_.track.id!==ga&&l_.streams[0].id===_a){var p_;const C_=l_.streams[0].getTracks()[0];return(p_=this.remoteSDP)===null||p_===void 0||p_.updateTrackLabel(_u,ga,l_.track.id),this.peerConnection.removeEventListener("track",r_),clearTimeout(_g),void _c({track:C_,id:ga})}if(l_.track.id===ga)return this.peerConnection.removeEventListener("track",r_),clearTimeout(_g),void _c({track:l_.track,id:ga})};this.peerConnection.addEventListener("track",r_)})}),j=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:j});const _t=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(_t),await a0.all(g)}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(g.toString()))}}async getRemoteSSRC(h){if(!this.remoteSDP)return;const g=this.remoteSDP.getSSRC(h);return g==null?void 0:g[0].ssrcId}setConfiguration(h){if(QS().supportPCSetConfiguration){const g=LL.resolvePCConfiguration(h);this.peerConnection.setConfiguration(g)}}}).prototype,"connect",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"connect"),mS.prototype),G_(mS.prototype,"stopSending",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"stopSending"),mS.prototype),G_(mS.prototype,"receive",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"receive"),mS.prototype),G_(mS.prototype,"stopReceiving",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"stopReceiving"),mS.prototype),G_(mS.prototype,"muteRemote",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"muteRemote"),mS.prototype),G_(mS.prototype,"unmuteRemote",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"unmuteRemote"),mS.prototype),G_(mS.prototype,"muteLocal",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"muteLocal"),mS.prototype),G_(mS.prototype,"unmuteLocal",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"unmuteLocal"),mS.prototype),G_(mS.prototype,"close",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"close"),mS.prototype),G_(mS.prototype,"updateEncoderConfig",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"updateEncoderConfig"),mS.prototype),G_(mS.prototype,"updateSendParameters",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"updateSendParameters"),mS.prototype),G_(mS.prototype,"replaceTrack",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"replaceTrack"),mS.prototype),G_(mS.prototype,"getRemoteSSRC",[EI],Object.getOwnPropertyDescriptor(mS.prototype,"getRemoteSSRC"),mS.prototype),mS);function EI(d,h,g){const j=d[h];if(typeof j!="function")throw new Error("Cannot use mutex on object property.");return g.value=async function(){const _t=this.mutex,_i=await _t.lock("Locking from P2PConnection.".concat(h));try{for(var _o=arguments.length,ga=new Array(_o),_a=0;_a<_o;_a++)ga[_a]=arguments[_a];return await j.apply(this,ga)}finally{_i()}},g}function NH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function kH(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?NH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):NH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}const QU="9",PH=4e4;class mee{get localCapabilities(){return aR(this._localCapabilities)}get rtpCapabilities(){return aR(this._rtpCapabilities)}get candidates(){return aR(this._candidates)}get iceParameters(){return aR(this._iceParameters)}get dtlsParameters(){return aR(this._dtlsParameters)}constructor(h){_h(this,"sessionDesc",void 0),_h(this,"_localCapabilities",void 0),_h(this,"_rtpCapabilities",void 0),_h(this,"_candidates",void 0),_h(this,"_iceParameters",void 0),_h(this,"_dtlsParameters",void 0),_h(this,"setup",void 0),_h(this,"currentMidIndex",void 0),_h(this,"cname",void 0),_h(this,"firefoxSsrcMidMap",new Map),h=aR(h);const{remoteIceParameters:g,remoteDtlsParameters:j,candidates:_t,remoteRTPCapabilities:_i,remoteSetup:_o,localCapabilities:ga,cname:_a}=h,_u=uR.exports.parse(`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0 1
a=msid-semantic: WMS
a=ice-lite
m=video 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:0
m=audio 9 UDP/TLS/RTP/SAVPF 0
c=IN IP4 127.0.0.1
a=rtcp:9 IN IP4 0.0.0.0
a=sendonly
a=rtcp-mux
a=rtcp-rsize
a=mid:1
`);this._rtpCapabilities=_i,this._candidates=_t,this._iceParameters=g,this._dtlsParameters=j,this._localCapabilities=ga,this.setup=_o,this.cname=_a;const _c=this.rtpCapabilities.send;for(const _l of _u.mediaDescriptions){if(_l.attributes.iceUfrag=g.iceUfrag,_l.attributes.icePwd=g.icePwd,_l.attributes.fingerprints=j.fingerprints,_l.attributes.candidates=_t,_l.attributes.setup=_o,_l.media.mediaType==="video"&&(_l.media.fmts=_c.videoCodecs.map(_g=>_g.payloadType.toString(10)),_l.attributes.payloads=_c.videoCodecs,_l.attributes.extmaps=_c.videoExtensions,__("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_g,ssrcGroups:r_}=gI([{ssrcId:PH,rtx:__("USE_SUB_RTX")?40001:void 0}],this.cname);_l.attributes.ssrcs=_g,_l.attributes.ssrcGroups=r_}if(_l.media.mediaType==="audio"&&(_l.media.fmts=_c.audioCodecs.map(_g=>_g.payloadType.toString(10)),_l.attributes.payloads=_c.audioCodecs,_l.attributes.extmaps=_c.audioExtensions,gN(_l),__("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_g,ssrcGroups:r_}=gI([{ssrcId:2e4}],this.cname);_l.attributes.ssrcs=_g,_l.attributes.ssrcGroups=r_}}this.sessionDesc=_u,this.currentMidIndex=_u.mediaDescriptions.length-1}preloadRemoteMedia(){const h=__("PRELOAD_MEDIA_COUNT");this.rtpCapabilities;const g=this.candidates,j=this.dtlsParameters,_t=this.iceParameters,_i=this.rtpCapabilities.send;for(let _o=1;_o<h;_o++){const ga=2*_o+2e4,_a=2*_o+PH,{ssrcs:_u,ssrcGroups:_c}=gI([{ssrcId:ga}],this.cname),{ssrcs:_l,ssrcGroups:_g}=gI([{ssrcId:_a,rtx:__("USE_SUB_RTX")?_a+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:QU,protos:["UDP","TLS","RTP","SAVPF"],fmts:_i.videoCodecs.map(r_=>r_.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:_t.iceUfrag,icePwd:_t.icePwd,unrecognized:[],candidates:g,extmaps:_i.videoExtensions,fingerprints:j.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_l,ssrcGroups:_g,rtcpFeedbackWildcards:[],payloads:_i.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*_o)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:QU,protos:["UDP","TLS","RTP","SAVPF"],fmts:_i.audioCodecs.map(r_=>r_.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:_t.iceUfrag,icePwd:_t.icePwd,unrecognized:[],candidates:g,extmaps:_i.audioExtensions,fingerprints:j.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_u,ssrcGroups:_c,rtcpFeedbackWildcards:[],payloads:_i.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*_o+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return uR.exports.print(this.sessionDesc)}send(h,g,j,_t){const{ssrcs:_i,ssrcGroups:_o}=gI(g,this.cname,__("SYNC_GROUP")?j:void 0),ga=this.findPreloadMediaDesc(_i);if(ga){if(GS()&&this.firefoxSsrcMidMap.set(_i[0].ssrcId,ga.attributes.mid),_t&&(_t.twcc||_t.remb)){const _a=this.sessionDesc.mediaDescriptions.indexOf(ga);return this.sessionDesc.mediaDescriptions[_a]=this.mungSendMediaDesc(ga,_t),{mid:ga.attributes.mid,needExchangeSDP:!0}}return{mid:ga.attributes.mid,needExchangeSDP:!1}}{const _a=this.findAvailableMediaIndex(h,_i);let _u;return _a===-1||_a===1&&(sT()||C2())||_a===0&&__("USE_SUB_RTX")||I2()?(_u=this.createOrRecycleSendMedia(h,_i,_o,"sendonly",_t),this.updateBundleMids()):(_u=aR(this.sessionDesc.mediaDescriptions[_a]),_u.attributes.direction="sendonly",_u.attributes.ssrcs=_i,_u.attributes.ssrcGroups=_o,this.sessionDesc.mediaDescriptions[_a]=this.mungSendMediaDesc(_u,_t)),GS()&&this.firefoxSsrcMidMap.set(_i[0].ssrcId,_u.attributes.mid),{mid:_u.attributes.mid,needExchangeSDP:!0}}}batchSend(h){const g=h.map(_i=>{let{kind:_o,ssrcMsg:ga,mslabel:_a}=_i;return this.send(_o,ga,_a)}),j=[];let _t=!1;return g.forEach(_i=>{let{mid:_o,needExchangeSDP:ga}=_i;ga&&(_t=!0),j.push(_o)}),{mids:j,needExchangeSDP:_t}}stopSending(h){const g=this.sessionDesc.mediaDescriptions.filter(j=>j.attributes.mid&&h.indexOf(j.attributes.mid)!==-1);if(g.length!==h.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");g.forEach(j=>{j.attributes.mid==="0"||GS()||I2()?j.attributes.ssrcs=[]:(j.attributes.ssrcs=[],j.attributes.direction="inactive",j.media.port="0")}),this.updateBundleMids()}mute(h){const g=this.sessionDesc.mediaDescriptions.find(j=>j.attributes.mid===h);if(!g)throw new Error("mediaDescription not found with ".concat(h," in remote SDP when calling RemoteSDP.mute."));g.attributes.direction="inactive"}unmute(h){const g=this.sessionDesc.mediaDescriptions.find(j=>j.attributes.mid===h);if(!g)throw new Error("mediaDescription not found with ".concat(h," in remote SDP when calling RemoteSDP.unmute."));g.attributes.direction="sendonly"}muteRemote(h){const g=this.sessionDesc.mediaDescriptions.filter(j=>h.includes(j.attributes.mid||""));if(g.length!==h.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");g.forEach(j=>{j.attributes.direction="inactive"})}unmuteRemote(h){const g=this.sessionDesc.mediaDescriptions.filter(j=>h.includes(j.attributes.mid||""));if(g.length!==h.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");g.forEach(j=>{j.attributes.direction="recvonly"})}receive(h,g,j,_t){h.forEach((_i,_o)=>{this.createOrRecycleRecvMedia(_i,[],"recvonly",g,j,_t[_o])}),this.updateBundleMids()}stopReceiving(h){const g=this.sessionDesc.mediaDescriptions.filter(j=>h.indexOf(j.attributes.mid)!==-1);if(g.length!==h.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");g.forEach(j=>{j.media.port="0",j.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(h){h===DR.TCP?this._candidates.forEach(g=>{this._candidates.findIndex(j=>j.transport==="tcp"&&j.connectionAddress===g.connectionAddress&&j.port===g.port)===-1&&this._candidates.push(kH(kH({},g),{},{foundation:"tcpcandidate",priority:Number(g.priority)-1+"",transport:"tcp",port:Number(g.port)+90+""}))}):this._candidates=this._candidates.filter(g=>g.transport!=="tcp");for(const g of this.sessionDesc.mediaDescriptions)g.attributes.candidates=this.candidates}restartICE(h){h=aR(h),this._iceParameters=h,this.sessionDesc.mediaDescriptions.forEach(g=>{g.attributes.iceUfrag=h.iceUfrag,g.attributes.icePwd=h.icePwd})}predictReceivingMids(h){const g=[];for(let j=0;j<h;j++)g.push((this.currentMidIndex+j+1).toString(10));return g}findAvailableMediaIndex(h,g){return this.sessionDesc.mediaDescriptions.findIndex(j=>{const _t=j.media.mediaType===h&&j.media.port!=="0"&&(j.attributes.direction==="sendonly"||j.attributes.direction==="sendrecv")&&j.attributes.ssrcs.length===0;if(GS()){if(_t){const _i=this.firefoxSsrcMidMap.get(g[0].ssrcId);return!(_i||j.attributes.mid!=="0"&&j.attributes.mid!=="1")||!(!_i||_i!==j.attributes.mid)}return!1}return _t})}createOrRecycleRecvMedia(h,g,j,_t,_i,_o){const ga=h._mediaStreamTrack.kind,_a=this.rtpCapabilities.recv,_u=this.localCapabilities.send;let _c=[];if(ga===L0.VIDEO){var _l,_g;if(__("H264_PROFILE_LEVEL_ID")&&_t==="h264"&&(_c=_a.videoCodecs.filter(C_=>{var O_,q_;return(((O_=C_.rtpMap)===null||O_===void 0?void 0:O_.encodingName.toLowerCase())||"").includes(_t)&&(C_==null||(q_=C_.fmtp)===null||q_===void 0?void 0:q_.parameters["profile-level-id"])===__("H264_PROFILE_LEVEL_ID")})),!_c||((_l=_c)===null||_l===void 0?void 0:_l.length)===0){const C_=_u.videoCodecs.filter(O_=>{var q_;return(((q_=O_.rtpMap)===null||q_===void 0?void 0:q_.encodingName.toLowerCase())||"").includes(_t)});C_.length!==0&&(_c=_a.videoCodecs.filter(O_=>C_.some(q_=>q_.payloadType===O_.payloadType)))}if(__("USE_PUB_RTX")){const C_=_c.map(q_=>q_.payloadType.toString()),O_=_a.videoCodecs.filter(q_=>{var c0,K_;return((c0=q_.rtpMap)===null||c0===void 0?void 0:c0.encodingName)==="rtx"&&C_.includes(((K_=q_.fmtp)===null||K_===void 0?void 0:K_.parameters.apt)||"")});_c=[..._c,...O_]}_c.length===0&&(wE.warning("codec ".concat(_t," not included in rtpCapabilities, fallback to default payloads: ").concat((_g=_a.videoCodecs[0].rtpMap)===null||_g===void 0?void 0:_g.encodingName)),_c=_a.videoCodecs)}else _c=_a.audioCodecs.filter(C_=>{var O_;return(((O_=C_.rtpMap)===null||O_===void 0?void 0:O_.encodingName.toLowerCase())||"").includes(_i)}),_c.length===0&&(wE.warning("codec ".concat(_i," not included in rtpCapabilities, fallback to opus")),_c=_a.audioCodecs.filter(C_=>{var O_;return(((O_=C_.rtpMap)===null||O_===void 0?void 0:O_.encodingName.toLowerCase())||"").includes("opus")}));const r_=ga===L0.VIDEO?_a.videoExtensions:_a.audioExtensions;this.currentMidIndex+=1;const l_="".concat(this.currentMidIndex);let d_={media:{mediaType:ga,port:QU,protos:["UDP","TLS","RTP","SAVPF"],fmts:_c.map(C_=>C_.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:r_,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:g,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:_c,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:j,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(l_)}};d_=this.mungRecvMediaDsec(d_,h,_o);const p_=this.findFirstClosedMedia(ga);if(p_){const C_=this.sessionDesc.mediaDescriptions.indexOf(p_);this.sessionDesc.mediaDescriptions[C_]=d_}else this.sessionDesc.mediaDescriptions.push(d_);return d_}createOrRecycleSendMedia(h,g,j,_t,_i){const _o=this.rtpCapabilities.send,ga=h===L0.VIDEO?_o.videoCodecs:_o.audioCodecs,_a=h===L0.VIDEO?_o.videoExtensions:_o.audioExtensions;this.currentMidIndex+=1;const _u="".concat(this.currentMidIndex);let _c={media:{mediaType:h,port:QU,protos:["UDP","TLS","RTP","SAVPF"],fmts:ga.map(_g=>_g.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:_a,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:g,ssrcGroups:j,rtcpFeedbackWildcards:[],payloads:ga,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:_t,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_u)}};_c=this.mungSendMediaDesc(_c,_i);const _l=this.findFirstClosedMedia(h);if(_l){const _g=this.sessionDesc.mediaDescriptions.indexOf(_l);this.sessionDesc.mediaDescriptions[_g]=_c}else this.sessionDesc.mediaDescriptions.push(_c);return _c}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(h=>h.media.port!=="0").map(h=>h.attributes.mid)}mungRecvMediaDsec(h,g,j){const _t=aR(h);return i6(_t),dP(_t,g),o6(_t,g),hH(_t),JU(_t,j,this.localCapabilities.send),_t}mungSendMediaDesc(h,g){const j=aR(h);return JU(j,g,this.localCapabilities.recv),gN(j),j}updateRecvMedia(h,g){const j=this.sessionDesc.mediaDescriptions.findIndex(_t=>_t.attributes.mid===h);if(j!==-1){const _t=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[j],g);this.sessionDesc.mediaDescriptions[j]=_t}}bumpMid(h){this.currentMidIndex+=h}findFirstClosedMedia(h){return this.sessionDesc.mediaDescriptions.find(g=>GS()?g.media.port==="0"&&g.media.mediaType===h:g.media.port==="0")}findPreloadMediaDesc(h){return this.sessionDesc.mediaDescriptions.find(g=>{var j,_t;return((j=g.attributes)===null||j===void 0||(_t=j.ssrcs[0])===null||_t===void 0?void 0:_t.ssrcId)===h[0].ssrcId})}getSSRC(h){var g;return(g=this.sessionDesc.mediaDescriptions.find(j=>j.attributes.mid===h))===null||g===void 0?void 0:g.attributes.ssrcs}}var gS;function xH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function pP(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?xH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):xH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}let WO=(G_((gS=class ML extends OU{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var h,g,j;return(h=(g=this.peerConnection.getReceivers()[0])===null||g===void 0||(j=g.transport)===null||j===void 0?void 0:j.state)!==null&&h!==void 0?h:null}constructor(h,g){super(h,g),_h(this,"store",void 0),_h(this,"peerConnection",void 0),_h(this,"remoteSDP",void 0),_h(this,"initialOffer",void 0),_h(this,"transportEventReceiver",void 0),_h(this,"statsFilter",void 0),_h(this,"localCapabilities",void 0),_h(this,"localCandidateCount",0),_h(this,"allCandidatesReceived",!1),_h(this,"selectedCandidatePairTimer",void 0),_h(this,"establishPromise",void 0),_h(this,"mutex",new lT("P2PConnection-mutex")),this.store=g,this.peerConnection=new RTCPeerConnection(ML.resolvePCConfiguration(h),{optional:[{googDscp:!0}]}),this.statsFilter=u6(this.peerConnection,__("STATS_UPDATE_INTERVAL"),void 0,GS()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const h=await this.peerConnection.createOffer();if(!h.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const g=l1(h.sdp),j=await mH(!__("USE_PUB_RTX")&&!__("USE_SUB_RTX"),__("FILTER_VIDEO_FEC"),__("FILTER_AUDIO_FEC"));return this.localCapabilities=s6(j),this.initialOffer=h,pP(pP({},g),{},{rtpCapabilities:j,offerSDP:h.sdp})}catch(h){throw new f_(c_.GET_LOCAL_CONNECTION_PARAMS_FAILED,h.toString())}}async connect(h,g,j,_t,_i,_o){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new mee({remoteIceParameters:h,remoteDtlsParameters:g,candidates:j,remoteRTPCapabilities:_t,remoteSetup:_i,localCapabilities:this.localCapabilities,cname:_o});const ga=this.remoteSDP.toString(),_a=uR.exports.parse(this.initialOffer.sdp),_u=_a.mediaDescriptions.find(r_=>r_.media.mediaType==="audio");_u&&gN(_u);const _c=uR.exports.print(_a),_l=this.logSDPExchange(_c||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:_c}),_l==null||_l(ga),await this.peerConnection.setRemoteDescription({type:"answer",sdp:ga});const _g=this.peerConnection.getTransceivers()[0];if(_g!=null&&_g.receiver&&this.tryBindTransportEvents(_g.receiver),__("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const r_=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:r_});const l_=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(l_)}}catch(ga){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(ga.toString()))}}send(h,g,j){var _t=this;return xI(function*(){const _i=yield $0(_t.mutex.lock("From P2PConnection.send"));try{if(!_t.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const _o=[];h.forEach(d_=>{const p_=_t.peerConnection.addTransceiver(d_._mediaStreamTrack,{direction:"sendonly"});_o.push(p_),d_._updateRtpTransceiver(p_)}),GS()&&__("SIMULCAST")===!0&&(yield $0(_t.applySimulcastForFirefox(_o,h)));const ga=yield $0(_t.peerConnection.createOffer()),_a=_t.remoteSDP.predictReceivingMids(h.length),_u=_t.mungSendOfferSDP(ga.sdp,h,_a),_c=uR.exports.parse(_u),_l=_a.map(d_=>{const p_=_c.mediaDescriptions.find(C_=>C_.attributes.mid===d_);if(!p_)throw new Error("Cannot extract ssrc from mediaDescription.");return dH(p_,__("USE_PUB_RTX"))});let _g;try{_g=yield _l}catch(d_){_g=[],_t.remoteSDP.receive(h,g,j,_g);const p_=_t.remoteSDP.toString();throw yield $0(_t.peerConnection.setLocalDescription({type:"offer",sdp:_u})),yield $0(_t.peerConnection.setRemoteDescription({type:"answer",sdp:p_})),yield $0(_t.stopSending(_a,!0)),d_}_t.remoteSDP.receive(h,g,j,_g);const r_=_t.remoteSDP.toString(),l_=_t.logSDPExchange(_u,"offer","local","send");return yield $0(_t.peerConnection.setLocalDescription({type:"offer",sdp:_u})),yield $0(_t.applySimulcastEncodings(_o,h)),yield $0(_t.applySendEncodings(_o,h)),l_==null||l_(r_),yield $0(_t.peerConnection.setRemoteDescription({type:"answer",sdp:r_})),_o.map((d_,p_)=>{const C_=_a[p_];return{localSSRC:_l[p_],id:C_,transceiver:d_}})}catch(_o){throw _o instanceof f_?_o:new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(_o.toString()))}finally{_i()}})()}async stopSending(h,g){const j=g?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const _t=this.peerConnection.getTransceivers().filter(_a=>h.indexOf(_a.mid)!==-1);if(_t.length!==h.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");_t.map(_a=>{var _u;_a.direction="inactive",(_u=_a.stop)===null||_u===void 0||_u.call(_a)});const _i=await this.peerConnection.createOffer(),_o=this.logSDPExchange(_i.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(_i),this.remoteSDP.stopReceiving(h);const ga=this.remoteSDP.toString();_o==null||_o(ga),await this.peerConnection.setRemoteDescription({type:"answer",sdp:ga})}catch(_t){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(_t.toString()))}finally{j&&j()}}async receive(h,g,j,_t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(h," before remoteSDP created."));const{mid:_i,needExchangeSDP:_o}=this.remoteSDP.send(h,g,j,_t);if(_o){const _a=this.remoteSDP.toString(),_u=this.logSDPExchange(_a,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_a});const _c=await this.peerConnection.createAnswer(),_l=this.mungReceiveAnswerSDP(_c.sdp,_i,h);_u==null||_u(_l||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:_l}),wE.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(h," by exchanging SDP."))}else wE.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(h," no need to exchange SDP."));const ga=this.peerConnection.getTransceivers().find(_a=>_a.mid===_i);if(!ga)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:ga.receiver.track,id:_i,transceiver:ga}}catch(_i){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(_i.toString()))}}async batchReceive(h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:g,needExchangeSDP:j}=this.remoteSDP.batchSend(h);if(j){const _t=this.remoteSDP.toString(),_i=this.logSDPExchange(_t,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_t});const _o=await this.peerConnection.createAnswer();_i==null||_i(_o.sdp||""),await this.peerConnection.setLocalDescription(_o),wE.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))}else wE.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive no need to exchange SDP."));return g.map(_t=>{const _i=this.peerConnection.getTransceivers().find(_o=>_o.mid===_t);if(!_i)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_i.receiver.track,id:_t,transceiver:_i}})}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(g.toString()))}}async stopReceiving(h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(h);const g=this.remoteSDP.toString(),j=this.logSDPExchange(g,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const _t=await this.peerConnection.createAnswer();j==null||j(_t.sdp||""),await this.peerConnection.setLocalDescription(_t)}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(g.toString()))}}async muteRemote(h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(h," before remote SDP created."));this.remoteSDP.mute(h);const g=this.remoteSDP.toString(),j=this.logSDPExchange(g,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const _t=await this.peerConnection.createAnswer();j==null||j(_t.sdp||""),await this.peerConnection.setLocalDescription(_t)}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(g.toString()))}}async unmuteRemote(h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(h," before remote SDP created."));this.remoteSDP.unmute(h);const g=this.remoteSDP.toString(),j=this.logSDPExchange(g,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const _t=await this.peerConnection.createAnswer();j==null||j(_t.sdp||""),await this.peerConnection.setLocalDescription(_t)}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(g.toString()))}}async muteLocal(h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const g=this.peerConnection.getTransceivers().filter(_o=>_o.mid&&h.indexOf(_o.mid)!==-1);if(g.length!==h.length)throw new Error("Transceivers' length doesn't match mids' length.");g.map(_o=>{_o.direction="inactive"});const j=await this.peerConnection.createOffer(),_t=this.logSDPExchange(j.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(j),this.remoteSDP.muteRemote(h);const _i=this.remoteSDP.toString();_t==null||_t(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(g.toString()))}}async unmuteLocal(h){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const g=this.peerConnection.getTransceivers().filter(_o=>_o.mid&&h.indexOf(_o.mid)!==-1);if(g.length!==h.length)throw new Error("Transceivers' length doesn't match mids' length.");g.map(async(_o,ga)=>{_o.direction="sendonly"});const j=await this.peerConnection.createOffer(),_t=this.logSDPExchange(j.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(j),this.remoteSDP.unmuteRemote(h);const _i=this.remoteSDP.toString();_t==null||_t(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(g.toString()))}}restartICE(h){var g=this;return xI(function*(){const j=yield $0(g.mutex.lock("From P2PConnection.restartICE"));try{if(!g.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(QS().supportPCSetConfiguration){const _u=g.peerConnection.getConfiguration(),_c=h===DR.RELAY?"relay":"all";_u.iceTransportPolicy!==_c&&(wE.debug("[".concat(g.store.clientId,"] restartICE change iceTransportPolicy from [").concat(_u.iceTransportPolicy,"] to [").concat(_c,"]")),_u.iceTransportPolicy=_c,g.peerConnection.setConfiguration(_u))}else if(h===DR.RELAY)return;h!==DR.RELAY&&g.remoteSDP.updateCandidates(h);const _t=yield $0(g.peerConnection.createOffer({iceRestart:!0}));if(!_t.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const _i=l1(_t.sdp),{remoteIceParameters:_o}=yield _i.iceParameters;g.remoteSDP.restartICE(_o);const ga=g.remoteSDP.toString(),_a=g.logSDPExchange(_t.sdp||"","offer","local","restartICE");g.store.descriptionStart(),yield $0(g.peerConnection.setLocalDescription(_t)),_a==null||_a(ga),yield $0(g.peerConnection.setRemoteDescription({type:"answer",sdp:ga}))}catch(_t){wE.warning("[".concat(g.store.clientId,"] restart ICE failed, abort operation"),_t)}finally{j()}})()}close(){var h;this.peerConnection.close(),(h=this.onConnectionStateChange)===null||h===void 0||h.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(h){return this.statsFilter.getVideoIsReady(h)}async updateEncoderConfig(h,g){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const j=await this.peerConnection.createOffer(),_t=this.mungSendOfferSDP(j.sdp,[g],[h]);this.remoteSDP.updateRecvMedia(h,g);const _i=this.remoteSDP.toString(),_o=this.logSDPExchange(_t,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:_t}),_o==null||_o(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(j){throw new f_(c_.EXCHANGE_SDP_FAILED,j.toString())}}async updateSendParameters(h,g){const j=this.peerConnection.getTransceivers().filter(_t=>_t.mid===h);j.length===1&&(this.isVP8Simulcast(g)?GS()||await this.applySimulcastEncodings(j,[g]):await this.applySendEncodings(j,[g]))}setStatsRemoteVideoIsReady(h,g){this.statsFilter.setVideoIsReady2(h,g)}async replaceTrack(h,g){const j=this.peerConnection.getTransceivers().find(_t=>_t.mid===g);j&&await j.sender.replaceTrack(h._mediaStreamTrack)}async getSelectedCandidatePair(){const h=this.peerConnection.getReceivers();if(h.length>0&&h[0].transport&&h[0].transport.iceTransport&&h[0].transport.iceTransport.getSelectedCandidatePair&&h[0].transport.iceTransport.getSelectedCandidatePair()){const g=h[0].transport.iceTransport,{local:j,remote:_t}=g.getSelectedCandidatePair();return{local:pP(pP({},EN),{},{candidateType:j.type,protocol:j.protocol,address:j.address,port:j.port}),remote:pP(pP({},EN),{},{candidateType:_t.type,protocol:_t.protocol,address:_t.address,port:_t.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var h;(h=this.onICEConnectionStateChange)===null||h===void 0||h.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var h;(h=this.onConnectionStateChange)===null||h===void 0||h.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=h=>{h.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,wE.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,wE.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},__("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(h){const g={iceServers:[]};return h.iceServers?g.iceServers=h.iceServers:h.turnServer&&h.turnServer.mode!=="off"&&(fL(h.turnServer.servers)?g.iceServers=h.turnServer.servers:(g.iceServers&&g.iceServers.push(...ML.turnServerConfigToIceServers(h.turnServer.servers)),__("USE_TURN_SERVER_OF_GATEWAY")&&g.iceServers&&h.turnServer.serversFromGateway&&g.iceServers.push(...ML.turnServerConfigToIceServers(h.turnServer.serversFromGateway)),__("FORCE_TURN_TCP")?g.iceTransportPolicy="relay":h.turnServer.servers.concat(h.turnServer.serversFromGateway||[]).forEach(j=>{j.forceturn&&(g.iceTransportPolicy="relay")}))),__("ENABLE_ENCODED_TRANSFORM")&&QS().supportWebRTCEncodedTransform&&(g.encodedInsertableStreams=!0),g}static turnServerConfigToIceServers(h){const g=[];return h.forEach(j=>{j.security?j.tcpport&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turns:".concat(MU(j.turnServerURL),":").concat(j.tcpport,"?transport=tcp")}):(j.udpport&&!__("FORCE_TURN_TCP")&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turn:".concat(j.turnServerURL,":").concat(j.udpport,"?transport=udp")}),j.tcpport&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turn:".concat(j.turnServerURL,":").concat(j.tcpport,"?transport=tcp")}))}),g}tryBindTransportEvents(h){const g=h.transport;if(g){this.transportEventReceiver=h,g.onstatechange=()=>{var _t;g!=null&&g.state&&((_t=this.onDTLSTransportStateChange)===null||_t===void 0||_t.call(this,g.state))},g.onerror=_t=>{var _i;(_i=this.onDTLSTransportError)===null||_i===void 0||_i.call(this,"error"in _t?_t.error:_t)};const j=g.iceTransport;j&&(j.onstatechange=()=>{const _t=g==null?void 0:g.iceTransport.state;var _i;_t&&((_i=this.onICETransportStateChange)===null||_i===void 0||_i.call(this,_t))},j.getSelectedCandidatePair&&(j.onselectedcandidatepairchange=()=>{if(j.getSelectedCandidatePair()){const{local:_t,remote:_i}=j.getSelectedCandidatePair();wE.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:_t.type,protocol:_t.protocol}),", remote ").concat(JSON.stringify({candidateType:_i.type,protocol:_i.protocol,address:_i.address,port:_i.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async applySendEncodings(h,g){try{if(!QS().supportSetRtpSenderParameters||h.length!==g.length)return;for(let _u=0;_u<h.length;_u++){const _c=h[_u],_l=g[_u];if(_l&&_l instanceof cR){var j,_t;if(this.isVP8Simulcast(_l))continue;const _g={},r_={};switch(_l._optimizationMode){case"motion":_g.degradationPreference="maintain-framerate";break;case"detail":_g.degradationPreference="maintain-resolution";break;default:_g.degradationPreference="balanced"}var _i,_o,ga,_a;if((j=_l._encoderConfig)!==null&&j!==void 0&&j.bitrateMax&&(r_.maxBitrate=1e3*((_i=_l._encoderConfig)===null||_i===void 0?void 0:_i.bitrateMax)),_l._hints.includes(ER.LOW_STREAM)&&((_o=_l._encoderConfig)!==null&&_o!==void 0&&_o.frameRate&&(r_.maxFramerate=VO(_l._encoderConfig.frameRate)),(ga=_l._encoderConfig)!==null&&ga!==void 0&&ga.scaleResolutionDownBy&&((_a=_l._encoderConfig)===null||_a===void 0?void 0:_a.scaleResolutionDownBy)>1&&(r_.scaleResolutionDownBy=_l._encoderConfig.scaleResolutionDownBy)),__("DSCP_TYPE")&&YN()){const p_=__("DSCP_TYPE");["very-low","low","medium","high"].includes(p_)&&(r_.networkPriority=p_)}const l_=_c.sender.getParameters(),d_=(_t=l_.encodings)===null||_t===void 0?void 0:_t[0];GS()&&!d_&&(_g.encodings=[r_]),d_&&Object.assign(d_,r_),Object.assign(l_,_g),await _c.sender.setParameters(l_)}}}catch{wE.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(h,g,j){const _t=uR.exports.parse(h);return g.forEach((_i,_o)=>{const ga=j[_o],_a=_t.mediaDescriptions.find(_u=>_u.attributes.mid===ga);_a&&(dP(_a,_i),fH(_a,_i,this.store.codec))}),uR.exports.print(_t)}mungReceiveAnswerSDP(h,g,j){const _t=uR.exports.parse(h),_i=_t.mediaDescriptions.find(_o=>_o.attributes.mid===g);return _i&&j===L0.AUDIO&&_i.media.mediaType==="audio"&&gN(_i),uR.exports.print(_t)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=h=>{var g;(g=this.onFirstAudioReceived)===null||g===void 0||g.call(this,h)},this.statsFilter.onFirstVideoReceived=h=>{var g;(g=this.onFirstVideoReceived)===null||g===void 0||g.call(this,h)},this.statsFilter.onFirstAudioDecoded=h=>{var g;(g=this.onFirstAudioDecoded)===null||g===void 0||g.call(this,h)},this.statsFilter.onFirstVideoDecoded=(h,g,j)=>{var _t;(_t=this.onFirstVideoDecoded)===null||_t===void 0||_t.call(this,h,g,j)},this.statsFilter.onSelectedLocalCandidateChanged=(h,g)=>{var j;(j=this.onSelectedLocalCandidateChanged)===null||j===void 0||j.call(this,h,g)},this.statsFilter.onSelectedRemoteCandidateChanged=(h,g)=>{var j;(j=this.onSelectedRemoteCandidateChanged)===null||j===void 0||j.call(this,h,g)},this.statsFilter.onFirstVideoDecodedTimeout=h=>{var g;(g=this.onFirstVideoDecodedTimeout)===null||g===void 0||g.call(this,h)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(h,g){if(h.length===g.length)for(let ga=0;ga<h.length;ga++){var j,_t,_i,_o;const _a=h[ga],_u=g[ga];if(_u instanceof cR&&!_u._hints.includes(ER.LOW_STREAM)&&(j=_u._encoderConfig)!==null&&j!==void 0&&j.bitrateMax&&((_t=_u._encoderConfig)===null||_t===void 0?void 0:_t.bitrateMax)>200&&(_i=_u._scalabiltyMode)!==null&&_i!==void 0&&_i.numSpatialLayers&&((_o=_u._scalabiltyMode)===null||_o===void 0?void 0:_o.numSpatialLayers)>1&&this.store.codec==="vp8"){const _c={},_l={high:1e3*(_u._encoderConfig.bitrateMax-50),medium:5e4};_c.encodings=[{rid:"m",active:!0,maxBitrate:_l.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:_l.high}];const _g=_a.sender.getParameters();await _a.sender.setParameters(Object.assign(_g,_c))}}}async applySimulcastEncodings(h,g){if(!GS()&&h.length===g.length)for(let j=0;j<h.length;j++){const _t=g[j];if(_t instanceof cR&&this.isVP8Simulcast(_t)){const _i=h[j],_o={},ga={high:1e3*(_t._encoderConfig.bitrateMax-50),medium:5e4};_o.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:ga.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:ga.medium,scaleResolutionDownBy:4}];const _a=_i.sender.getParameters();await _i.sender.setParameters(Object.assign(_a,_o))}}}isVP8Simulcast(h){var g,j,_t,_i;return!!(h instanceof cR&&__("SIMULCAST")&&this.store.codec==="vp8"&&!h._hints.includes(ER.LOW_STREAM)&&(g=h._encoderConfig)!==null&&g!==void 0&&g.bitrateMax&&((j=h._encoderConfig)===null||j===void 0?void 0:j.bitrateMax)>200&&(_t=h._scalabiltyMode)!==null&&_t!==void 0&&_t.numSpatialLayers&&((_i=h._scalabiltyMode)===null||_i===void 0?void 0:_i.numSpatialLayers)>1)}logSDPExchange(h,g,j,_t){if(__("SDP_LOGGING"))return wE.upload("[".concat(this.store.clientId,"] exchanging ").concat(j," ").concat(g," SDP during P2PConnection.").concat(_t,`
`),h),g==="offer"?_i=>{this.logSDPExchange(_i,"answer",j==="local"?"remote":"local",_t)}:void 0}async getRemoteSSRC(h){if(!this.remoteSDP)return;const g=this.remoteSDP.getSSRC(h);return g==null?void 0:g[0].ssrcId}setConfiguration(h){if(QS().supportPCSetConfiguration){const g=ML.resolvePCConfiguration(h);this.peerConnection.setConfiguration(g)}}}).prototype,"connect",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"connect"),gS.prototype),G_(gS.prototype,"receive",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"receive"),gS.prototype),G_(gS.prototype,"batchReceive",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"batchReceive"),gS.prototype),G_(gS.prototype,"stopReceiving",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"stopReceiving"),gS.prototype),G_(gS.prototype,"muteRemote",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"muteRemote"),gS.prototype),G_(gS.prototype,"unmuteRemote",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"unmuteRemote"),gS.prototype),G_(gS.prototype,"muteLocal",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"muteLocal"),gS.prototype),G_(gS.prototype,"unmuteLocal",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"unmuteLocal"),gS.prototype),G_(gS.prototype,"close",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"close"),gS.prototype),G_(gS.prototype,"updateEncoderConfig",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"updateEncoderConfig"),gS.prototype),G_(gS.prototype,"updateSendParameters",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"updateSendParameters"),gS.prototype),G_(gS.prototype,"replaceTrack",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"replaceTrack"),gS.prototype),G_(gS.prototype,"getRemoteSSRC",[vI],Object.getOwnPropertyDescriptor(gS.prototype,"getRemoteSSRC"),gS.prototype),gS);function vI(d,h,g){const j=d[h];if(typeof j!="function")throw new Error("Cannot use mutex on object property.");return g.value=async function(){const _t=this.mutex,_i=await _t.lock("From P2PConnection.".concat(h));try{for(var _o=arguments.length,ga=new Array(_o),_a=0;_a<_o;_a++)ga[_a]=arguments[_a];return await j.apply(this,ga)}finally{_i()}},g}function DH(d,h){let g=document.createElement("video"),j=document.createElement("canvas");g.setAttribute("style","display:none"),j.setAttribute("style","display:none"),g.setAttribute("muted",""),g.muted=!0,g.setAttribute("autoplay",""),g.autoplay=!0,g.setAttribute("playsinline",""),j.width=VO(h.width),j.height=VO(h.height);const _t=VO(h.framerate||15);document.body.append(g),document.body.append(j);let _i=d._mediaStreamTrack;g.srcObject=new MediaStream([_i]),g.play();const _o=j.getContext("2d");if(!_o)throw new f_(c_.UNEXPECTED_ERROR,"can not get canvas context");const ga=QS(),_a=j.captureStream(ga.supportRequestFrame?0:_t).getVideoTracks()[0],_u=r$(()=>(()=>{if(g.paused&&g.play(),g.videoHeight>2&&g.videoWidth>2){const _l=g.videoWidth,_g=g.videoHeight/_l,r_=j.width*_g;Math.abs(r_-j.height)>=2&&(wE.debug("adjust low stream resolution","".concat(j.width,"x").concat(j.height," -> ").concat(j.width,"x").concat(r_)),j.height=r_)}_o.drawImage(g,0,0,j.width,j.height),_a.requestFrame&&_a.requestFrame(),_i!==d._mediaStreamTrack&&(_i=d._mediaStreamTrack,g.srcObject=new MediaStream([_i]))})(),_t),_c=_a.stop;return _a.stop=()=>{_c.call(_a),_u(),g&&(g.remove(),g=null),j&&(j.width=0,j.remove(),j=null),wE.debug("clean low stream renderer")},_a}var LH,MH,jH,UH,_I,FH,BH,VH,GH,$H,WH,rT;function HH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function ZU(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?HH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):HH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}class qH extends Z4{getUserId(){return this._userId}constructor(h,g,j,_t){super(h,"track-".concat(h.kind,"-").concat(g,"-").concat(_t.clientId,"_").concat(CS(5,""))),_h(this,"_userId",void 0),_h(this,"_uintId",void 0),_h(this,"_isDestroyed",!1),_h(this,"store",void 0),_h(this,"processor",void 0),_h(this,"processorContext",void 0),this._userId=g,this._uintId=j,this.store=_t}_updateOriginMediaStreamTrack(h){this._originMediaStreamTrack=h,this._mediaStreamTrack=h,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,wE.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}let EF=(LH=b0({argsMap:(d,h,g)=>[d.getTrackId(),typeof h=="string"?h:h instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",g]}),MH=b0({argsMap:d=>[d.getTrackId()]}),jH=b0({argsMap:(d,h)=>[d.getTrackId(),h.name]}),UH=b0({argsMap:d=>[d.getTrackId()]}),G_((_I=class extends qH{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==$R.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(d,h,g,j){super(d,h,g,j),_h(this,"_videoVisibleTimer",null),_h(this,"_previousVideoVisibleStatus",void 0),_h(this,"_clearPreviousVideoVisibleStatus",()=>this._previousVideoVisibleStatus=void 0),_h(this,"trackMediaType","video"),_h(this,"_videoWidth",void 0),_h(this,"_videoHeight",void 0),_h(this,"_player",void 0),_h(this,"processorDestination",void 0),_h(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new f$(this.getTrackId(),"remote"),this.processorDestination=new h$(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return vL(()=>{wE.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")},"remoteVideoTrackGetStatsWarning"),PI(this,I0.GET_STATS)||ZU({},k4)}play(d){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof d=="string"){const j=document.getElementById(d);j?d=j:(wE.warning("[".concat(this.getTrackId(),'] can not find "#').concat(d,'" element, use document.body')),d=document.body)}wE.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(d instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(h));const g=ZU(ZU({fit:"cover"},h),{},{trackId:this.getTrackId(),element:d});this._player?this._player.updateConfig(g):(d instanceof HTMLVideoElement?this._player=new U5(g):this._player=new KW(g),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(_k.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval(()=>{try{const j=this.getVideoElementVisibleStatus();this.safeEmit(_k.VIDEO_ELEMENT_VISIBLE_STATUS,j)}catch{}},__("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,wE.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){lW(this._originMediaStreamTrack).then(d=>{let[h,g]=d;this._videoHeight=g,this._videoWidth=h}).catch(UU)}_updatePlayerSource(){wE.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var d,h;const g=this==null||(d=this._player)===null||d===void 0?void 0:d.getContainerElement(),j={track:this,element:this==null||(h=this._player)===null||h===void 0?void 0:h.getVideoElement(),slot:g==null?void 0:g.parentElement},{element:_t,slot:_i}=j;if(this.isPlaying&&_t instanceof HTMLVideoElement&&_i instanceof HTMLElement){const _o=O8.checkOneElementVisible(_t),ga=Object.assign({},_o);if(ga.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=ga.visible;const _a=p0.reportApiInvoke(null,{tag:kS.TRACER,name:iR.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});ga.visible?_a.onSuccess("Video is visible"):_a.onSuccess("Invisible because of ".concat(ga.reason))}return ga}return}catch(g){throw new f_(c_.GET_VIDEO_ELEMENT_VISIBLE_ERROR,g.message)}}pipe(d){if(this.processor===d)return d;if(d._source)throw new f_(c_.INVALID_OPERATION,"Processor ".concat(d.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=d,this.processor._source=this,d.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),d}unpipe(){if(!this.processor)return;const d=this.processor;this.processor._source=void 0,this.processor=void 0,d.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(qR.ON_TRACK,async d=>{d?d!==this._mediaStreamTrack&&(this._mediaStreamTrack=d,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(qR.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}}).prototype,"play",[LH],Object.getOwnPropertyDescriptor(_I.prototype,"play"),_I.prototype),G_(_I.prototype,"stop",[MH],Object.getOwnPropertyDescriptor(_I.prototype,"stop"),_I.prototype),G_(_I.prototype,"pipe",[jH],Object.getOwnPropertyDescriptor(_I.prototype,"pipe"),_I.prototype),G_(_I.prototype,"unpipe",[UH],Object.getOwnPropertyDescriptor(_I.prototype,"unpipe"),_I.prototype),_I),_F=(FH=b0({argsMap:(d,h)=>[d.getTrackId(),h],throttleTime:300}),BH=b0({argsMap:(d,h)=>[d.getTrackId(),h]}),VH=b0({argsMap:d=>[d.getTrackId()]}),GH=b0({argsMap:d=>[d.getTrackId()]}),$H=b0({argsMap:(d,h)=>[d.getTrackId(),h.name]}),WH=b0({argsMap:d=>[d.getTrackId()]}),G_((rT=class extends qH{get isPlaying(){return this._useAudioElement?FT.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(d,h,g,j){super(d,h,g,j),_h(this,"trackMediaType","audio"),_h(this,"_source",void 0),_h(this,"_useAudioElement",!0),_h(this,"_volume",100),_h(this,"processorContext",void 0),_h(this,"processorDestination",void 0),_h(this,"_played",!1),_h(this,"_bypassWebAudio",!1),__("DISABLE_WEBAUDIO")?(this._source=new T5,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new b5(d,!0),__("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(wT.RECEIVE_TRACK_BUFFER,()=>{this.safeEmit(_k.FIRST_FRAME_DECODED)}),this.processorContext=new g$(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new m$(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(wT.UPDATE_SOURCE,()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})})}setAudioFrameCallback(d){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4096;if(!d)return this._source.removeAllListeners(wT.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(h),this._source.removeAllListeners(wT.ON_AUDIO_BUFFER),this._source.on(wT.ON_AUDIO_BUFFER,g=>d(g))}setVolume(d){this._volume=d,this._useAudioElement?FT.setVolume(this.getTrackId(),d):this._source.setVolume(d/100)}async setPlaybackDevice(d){if(!this._useAudioElement)throw new f_(c_.NOT_SUPPORTED,"your browser does not support setting the audio output device");await FT.setSinkID(this.getTrackId(),d)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return vL(()=>{wE.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")},"remoteAudioTrackGetStatsWarning"),PI(this,I0.GET_STATS)||ZU({},N4)}play(){wE.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(wE.debug("[".concat(this.getTrackId(),"] use audio element to play")),FT.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){wE.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?FT.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let d=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];wE.debug("[".concat(this.getTrackId(),"] update player source track")),d&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&FT.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(d){if(this._bypassWebAudio)throw new f_(c_.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===d)return d;if(d._source)throw new f_(c_.INVALID_OPERATION,"Processor ".concat(d.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=d,this.processor._source=this,d.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),d}unpipe(){var d;if(this._bypassWebAudio)throw new f_(c_.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const h=this.processor;(d=this._source.processSourceNode)===null||d===void 0||d.disconnect(),this.processor._source=!1,this.processor=void 0,h.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(qR.ON_TRACK,async d=>{d?d!==this._mediaStreamTrack&&(this._mediaStreamTrack=d,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(d)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}),this.processorDestination.on(qR.ON_NODE,d=>{this._source.processedNode=d;const h=!d;this._useAudioElement!==h&&(this._played?(this.stop(),this._useAudioElement=h,this.play()):this._useAudioElement=h)})}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(qR.ON_TRACK),this.processorDestination.removeAllListeners(qR.ON_NODE)}}).prototype,"setVolume",[FH],Object.getOwnPropertyDescriptor(rT.prototype,"setVolume"),rT.prototype),G_(rT.prototype,"setPlaybackDevice",[BH],Object.getOwnPropertyDescriptor(rT.prototype,"setPlaybackDevice"),rT.prototype),G_(rT.prototype,"play",[VH],Object.getOwnPropertyDescriptor(rT.prototype,"play"),rT.prototype),G_(rT.prototype,"stop",[GH],Object.getOwnPropertyDescriptor(rT.prototype,"stop"),rT.prototype),G_(rT.prototype,"pipe",[$H],Object.getOwnPropertyDescriptor(rT.prototype,"pipe"),rT.prototype),G_(rT.prototype,"unpipe",[WH],Object.getOwnPropertyDescriptor(rT.prototype,"unpipe"),rT.prototype),rT);function zH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function KH(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?zH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):zH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}class gee extends US{constructor(){super(),_h(this,"uplinkStatsUploadInterval",void 0),_h(this,"uplinkRelatedStatsUploadInterval",void 0),_h(this,"uplinkDenoiserStatsUploadInterval",void 0),_h(this,"transportStatsUploadInterval",void 0),_h(this,"uplinkExtensionStatsUploadInterval",void 0),_h(this,"downlinkExtensionStatsUploadInterval",void 0),_h(this,"extensionUsageStatsUploadInterval",void 0),_h(this,"downlinkStatsUploadInterval",void 0),_h(this,"downlinkRelatedStatsUploadInterval",void 0),_h(this,"lastStats",void 0),_h(this,"uploadUnplinkStarted",!1),_h(this,"uploadDownlinkStarted",!1),_h(this,"uploadTransportStarted",!1),_h(this,"uploadExtensionUsageStarted",!1),_h(this,"requestStats",void 0),_h(this,"requestLocalMedia",void 0),_h(this,"requestRemoteMedia",void 0),_h(this,"requestAllTracks",void 0),_h(this,"requestVideoIsReady",void 0),_h(this,"requestUpload",void 0)}startUploadTransportStats(){this.uploadTransportStarted||(this.uploadTransportStarted=!0,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=window.setInterval(()=>{var h;const g=(h=this.requestStats)===null||h===void 0?void 0:h.call(this);g&&this.uploadTransportStats(g)},1e3))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.extensionUsageStatsUploadInterval&&window.clearInterval(this.extensionUsageStatsUploadInterval);const h=new Map;this.extensionUsageStatsUploadInterval=window.setInterval(async()=>{var g,j,_t;const _i=Date.now(),_o={connectionInterval:__("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:_i};let ga=[];const _a=((g=this.requestAllTracks)===null||g===void 0?void 0:g.call(this))||[];for(const _g of _a)!_g.muted&&_g.enabled&&(ga=ga.concat(await _g.getProcessorUsage()));const _u=((j=this.requestRemoteMedia)===null||j===void 0?void 0:j.call(this))||[];for(const[_g,r_]of _u)r_.has(L0.VIDEO)&&_g.videoTrack&&(ga=ga.concat(await _g.videoTrack.getProcessorUsage())),r_.has(L0.AUDIO)&&_g.audioTrack&&(ga=ga.concat(await _g.audioTrack.getProcessorUsage()));if(ga.length===0)return;_o.details=function(_g,r_){const l_={};for(const{id:O_,value:q_,level:c0,direction:K_}of _g){var d_;const Q_=(d_=r_.get(O_))!==null&&d_!==void 0?d_:0,$_=q_===2?Q_+__("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:Q_;var p_,C_;r_.set(O_,$_),l_[O_]?(q_===2&&(l_[O_].value=q_),c0>l_[O_].level&&(l_[O_].level=c0),K_==="remote"&&(l_[O_].remoteUidCount+=1),l_[O_].totalTs=(p_=r_.get(O_))!==null&&p_!==void 0?p_:0):l_[O_]={value:q_,level:c0,remoteUidCount:K_==="local"?0:1,totalTs:(C_=r_.get(O_))!==null&&C_!==void 0?C_:0}}return Object.keys(l_).map(O_=>{const{level:q_,value:c0,totalTs:K_}=l_[O_];return{id:O_,level:q_,value:c0,totalTs:K_}})}(ga,h);const _c=Date.now(),_l=_c>_i?_c:_i+1;(_t=this.requestUpload)===null||_t===void 0||_t.call(this,jT.EXTENSION_USAGE_STATS,{usageStats:_o,sendTs:_l})},__("EXTENSION_USAGE_UPLOAD_INTERVAL"))}startUploadUplinkStats(){this.uploadUnplinkStarted||(this.uploadUnplinkStarted=!0,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkStatsUploadInterval=window.setInterval(()=>{var h;const g=(h=this.requestStats)===null||h===void 0?void 0:h.call(this);g&&(this.uploadUplinkStats(g),this.lastStats=g)},3e3),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkRelatedStatsUploadInterval=window.setInterval(()=>{var h;const g=(h=this.requestStats)===null||h===void 0?void 0:h.call(this);g&&this.uploadRelatedUplinkStats(g,this.lastStats),this.lastStats=g},1e3),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval=window.setInterval(()=>{var h;const g=(h=this.requestAllTracks)===null||h===void 0?void 0:h.call(this);g&&this.uploadDenoiserStats(g)},2e3),this.uplinkExtensionStatsUploadInterval&&window.clearInterval(this.uplinkExtensionStatsUploadInterval),this.uplinkExtensionStatsUploadInterval=window.setInterval(()=>{var h;const g=(h=this.requestAllTracks)===null||h===void 0?void 0:h.call(this);g&&this.uploadExtensionStats(g)},2e3))}uploadTransportStats(h){eO(()=>{var g;(g=this.requestUpload)===null||g===void 0||g.call(this,jT.TRANSPORT_STATS,function(j){const _t={connectionType:100,googRtt:j.rtt};if(j.selectedCandidatePair.localCandidate.candidateType==="relay"){const _i=j.selectedCandidatePair.localCandidate.relayProtocol;_i==="udp"&&(_t.connectionType=101),_i==="tcp"&&(_t.connectionType=103),_i==="tls"&&(_t.connectionType=104)}return _t}(h))})}uploadUplinkStats(h){var g;(((g=this.requestLocalMedia)===null||g===void 0?void 0:g.call(this))||[]).forEach(j=>{let[_t,{track:_i,ssrcs:_o}]=j;switch(_t){case l0.LocalVideoLowTrack:case l0.LocalVideoTrack:{const ga=function(_c,_l,_g){var r_;const l_=_l.videoSend.find(p_=>p_.ssrc===_c);if(!l_)return null;const d_={id:CS(10,""),timestamp:new Date(_l.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:l_.ssrc.toString()};switch(d_.A_vstd=_g._originMediaStreamTrack&&!_g._originMediaStreamTrack.enabled||_g._mediaStreamTrack&&!_g._mediaStreamTrack.enabled?"1":"0",l_.sentFrame&&(d_.A_fhs=l_.sentFrame.height.toString(),d_.A_frs=l_.sentFrame.frameRate.toString(),d_.A_fws=l_.sentFrame.width.toString()),l_.adaptionChangeReason){case"none":d_.A_ac="0";break;case"cpu":d_.A_ac="1";break;case"bandwidth":d_.A_ac="2";break;case"other":d_.A_ac="3"}return d_.A_lvps=n5[_g._player?_g._player.videoElementStatus:"uninit"].toString(),d_.A_nr=(r_=l_.nacksCount)===null||r_===void 0?void 0:r_.toString(),l_.avgEncodeMs&&(d_.A_aem=l_.avgEncodeMs.toFixed(0).toString()),d_}(_o[0].ssrcId,h,_i),_a=_t===l0.LocalVideoTrack?function(_c,_l,_g){var r_,l_,d_,p_,C_,O_,q_,c0;const K_=_l.videoSend.find(y0=>y0.ssrc===_c);if(!K_)return null;const Q_={id:CS(10,""),timestamp:new Date(_l.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:K_.ssrc.toString()},$_=(r_=(l_=(d_=K_.inputFrame)===null||d_===void 0?void 0:d_.height)!==null&&l_!==void 0?l_:_g==null?void 0:_g._videoHeight)!==null&&r_!==void 0?r_:0,_b=(p_=(C_=(O_=K_.inputFrame)===null||O_===void 0?void 0:O_.width)!==null&&C_!==void 0?C_:_g==null?void 0:_g._videoWidth)!==null&&p_!==void 0?p_:0,iS=(q_=(c0=K_.inputFrame)===null||c0===void 0?void 0:c0.frameRate)!==null&&q_!==void 0?q_:0;return $_&&(Q_.A_fhi=$_+""),_b&&(Q_.A_fwi=_b+""),iS&&(Q_.A_fri=iS+""),Q_}(_o[0].ssrcId,h,_i):null;ga&&eO(()=>{var _c;return(_c=this.requestUpload)===null||_c===void 0?void 0:_c.call(this,jT.PUBLISH_STATS,{stream_type:_t===l0.LocalVideoLowTrack?"low":"high",stats:KH(KH({},ga),_a)})});const _u=function(_c){const _l={id:"bweforvideo",timestamp:new Date(_c.timestamp).toISOString(),type:"VideoBwe"};return _c.bitrate.retransmit&&(_l.A_rb=_c.bitrate.retransmit.toString()),_c.bitrate.targetEncoded&&(_l.A_teb=_c.bitrate.targetEncoded.toString()),_l.A_aeb=_c.bitrate.actualEncoded.toString(),_l.A_tb=_c.bitrate.transmit.toString(),_c.sendBandwidth!==void 0&&(_l.A_asb=_c.sendBandwidth.toString()),_l}(h);_u&&setTimeout(()=>{var _c;return(_c=this.requestUpload)===null||_c===void 0?void 0:_c.call(this,jT.PUBLISH_STATS,{stream_type:_t===l0.LocalVideoLowTrack?"low":"high",stats:_u})},1e3);break}case l0.LocalAudioTrack:{const ga=function(_a,_u,_c){const _l=_u.audioSend.find(r_=>r_.ssrc===_a);if(!_l)return null;const _g={id:CS(10,""),timestamp:new Date(_u.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:_l.ssrc.toString()};return _g.A_astd=_c._originMediaStreamTrack&&!_c._originMediaStreamTrack.enabled||_c._mediaStreamTrack&&!_c._mediaStreamTrack.enabled?"1":"0",_l.inputLevel?_g.A_ail=Math.round(100*_l.inputLevel).toString():_g.A_ail=Math.round(100*_c._source.getAccurateVolumeLevel()).toString(),_g.A_apil=Math.round(100*_c._source.getAccurateVolumeLevel()).toString(),_l.aecReturnLoss&&(_g.A_ecrl=Math.round(_l.aecReturnLoss).toString()),_l.aecReturnLossEnhancement&&(_g.A_ecrle=Math.round(_l.aecReturnLossEnhancement).toString()),_g}(_o[0].ssrcId,h,_i);ga&&eO(()=>{var _a;return(_a=this.requestUpload)===null||_a===void 0?void 0:_a.call(this,jT.PUBLISH_STATS,{stream_type:"high",stats:ga})});break}}})}uploadRelatedUplinkStats(h,g){var j;(((j=this.requestLocalMedia)===null||j===void 0?void 0:j.call(this))||[]).filter(_t=>{let[_i]=_t;return _i===l0.LocalVideoLowTrack||_i===l0.LocalVideoTrack}).forEach(_t=>{let[_i,{ssrcs:_o}]=_t;const ga=function(_a,_u){const _c=_u.videoSend.find(_l=>_l.ssrc===_a);return _c?{mediaType:"video",isVideoMute:!1,frameRateInput:_c.inputFrame&&_c.inputFrame.frameRate.toString(),frameRateSent:_c.sentFrame&&_c.sentFrame.frameRate.toString(),googRtt:_c.rttMs.toString(),qpSumPerFrame:Math.floor(_c.qpSumPerFrame).toString()}:null}(_o[0].ssrcId,h);ga&&eO(()=>{var _a;(_a=this.requestUpload)===null||_a===void 0||_a.call(this,jT.PUBLISH_RELATED_STATS,{stream_type:_i===l0.LocalVideoLowTrack?"low":"high",stats:ga})})})}uploadDenoiserStats(h){for(let _i=0;_i<h.length;_i++){const _o=h[_i];if(_o instanceof DU){var g,j,_t;const ga=(g=(j=_o._external).getDenoiserStats)===null||g===void 0?void 0:g.call(j);return void(ga&&((_t=this.requestUpload)===null||_t===void 0||_t.call(this,jT.DENOISER_STATS,ga)))}}}uploadExtensionStats(h){for(let g=0;g<h.length;g++)h[g].getProcessorStats().forEach(j=>{var _t;(_t=this.requestUpload)===null||_t===void 0||_t.call(this,j.type,j.stats)})}stopUploadUplinkStats(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkStatsUploadInterval=void 0,this.uplinkRelatedStatsUploadInterval=void 0,this.uplinkDenoiserStatsUploadInterval=void 0)}startUploadDownlinkStats(){if(this.uploadDownlinkStarted)return;let h;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);let g=!1;this.downlinkStatsUploadInterval=window.setInterval(()=>{var j;const _t=(j=this.requestStats)===null||j===void 0?void 0:j.call(this);_t&&(this.uploadDownlinkStats(_t,g,h),h=_t),g=!g},3e3),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkRelatedStatsUploadInterval=window.setInterval(()=>{var j;const _t=(j=this.requestStats)===null||j===void 0?void 0:j.call(this);_t&&(this.uploadRelatedDownlinkStats(_t,this.lastStats),this.lastStats=_t)},1e3),this.downlinkExtensionStatsUploadInterval&&window.clearInterval(this.downlinkExtensionStatsUploadInterval),this.downlinkExtensionStatsUploadInterval=window.setInterval(()=>{var j;const _t=(j=this.requestRemoteMedia)===null||j===void 0?void 0:j.call(this);_t&&this.uploadDownlinkExtensionStats(_t)},2e3)}uploadDownlinkStats(h,g,j){var _t;(((_t=this.requestRemoteMedia)===null||_t===void 0?void 0:_t.call(this))||[]).forEach(_i=>{let[_o,ga]=_i;if(ga.has(L0.VIDEO)&&_o.videoTrack){const _a=_o.videoTrack?function(_u,_c,_l,_g,r_){const l_=_c.videoRecv.find(O_=>O_.ssrc===_u);if(!l_)return null;const d_={id:CS(10,""),timestamp:new Date(_c.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:l_.ssrc.toString()};var p_,C_;if(d_.bytesReceived=l_.bytes.toString(),d_.packetsLost=l_.packetsLost.toString(),d_.packetsReceived=l_.packets.toString(),l_.framesRateFirefox&&(d_.A_frr=l_.framesRateFirefox.toString()),l_.receivedFrame?(d_.A_frr=l_.receivedFrame.frameRate.toString(),d_.A_fhr=l_.receivedFrame.height.toString(),d_.A_fwr=l_.receivedFrame.width.toString()):(d_.A_fhr=(p_=_g._videoHeight)===null||p_===void 0?void 0:p_.toString(),d_.A_fwr=(C_=_g._videoWidth)===null||C_===void 0?void 0:C_.toString()),d_.A_frd=l_.decodeFrameRate.toString(),l_.outputFrame&&(d_.A_fro=l_.outputFrame.frameRate.toString()),l_.jitterBufferMs!==void 0&&(d_.A_jbm=Math.floor(l_.jitterBufferMs).toString()),l_.currentDelayMs!==void 0&&(d_.A_cdm=Math.floor(l_.currentDelayMs).toString()),d_.A_fs=l_.firsCount.toString(),d_.A_ns=l_.nacksCount.toString(),d_.A_ps=l_.plisCount.toString(),_g&&(d_.A_vrtd=_g._originMediaStreamTrack.enabled&&_g._mediaStreamTrack.enabled?"0":"1"),_g._player&&_g._player.freezeTimeCounterList.length>0&&(d_.A_vrft=Math.round(_g._player.freezeTimeCounterList.splice(0,1)[0]).toString()),r_&&_g._player&&BO.visibility==="visible"){const O_=Math.min(6e3,_g._player.renderFreezeAccTime);d_.A_vrrft=Math.round(O_).toString(),_g._player.renderFreezeAccTime=Math.max(0,_g._player.renderFreezeAccTime-O_)}if(d_.A_rvps=n5[_g._player?_g._player.videoElementStatus:"uninit"].toString(),_l){const O_=_l.videoRecv.find(q_=>q_.ssrc===_u);if(O_&&l_.totalInterFrameDelay!==void 0&&l_.totalSquaredInterFrameDelay!==void 0&&O_.totalInterFrameDelay!==void 0&&O_.totalSquaredInterFrameDelay!==void 0){const q_=l_.totalInterFrameDelay-O_.totalInterFrameDelay,c0=l_.totalSquaredInterFrameDelay-O_.totalSquaredInterFrameDelay,K_=l_.framesDecodeCount-O_.framesDecodeCount,Q_=q_/K_*1e3,$_=Math.round(1e3*Math.sqrt((c0-Math.pow(q_,2)/K_)/K_));!isNaN($_)&&Q_+$_>Math.max(3*Q_,Q_+150)&&(d_.A_ifdsd=$_.toString())}}return d_}(_o._videoSSRC,h,j,_o.videoTrack,g):void 0;_a&&eO(()=>{var _u;return(_u=this.requestUpload)===null||_u===void 0?void 0:_u.call(this,jT.SUBSCRIBE_STATS,{stream_id:_o.uid,stats:_a})})}if(ga.has(L0.AUDIO)&&_o.audioTrack){const _a=_o.audioTrack?function(_u,_c,_l,_g){const r_=_c.audioRecv.find(d_=>d_.ssrc===_u);if(!r_)return null;const l_={id:CS(10,""),timestamp:new Date(_c.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:r_.ssrc.toString()};if(l_.bytesReceived=r_.bytes.toString(),l_.packetsLost=r_.packetsLost.toString(),l_.packetsReceived=r_.packets.toString(),r_.outputLevel?l_.A_aol=Math.round(100*r_.outputLevel).toString():l_.A_aol=Math.round(100*_g._source.getAccurateVolumeLevel()).toString(),l_.A_apol=Math.round(100*_g._source.getAccurateVolumeLevel()).toString(),_g&&(l_.A_artd=_g._originMediaStreamTrack.enabled&&_g._mediaStreamTrack.enabled?"0":"1"),l_.A_jr=r_.jitterMs.toString(),l_.A_jbm=Math.floor(r_.jitterBufferMs).toString(),l_.A_cdm=Math.floor(r_.jitterBufferMs).toString(),l_.A_raps=n5[FT.getPlayerState(_g.getTrackId())].toString(),_l){const d_=_l.audioRecv.find(p_=>p_.ssrc===_u);if(d_){const p_=r_.concealedSamples-d_.concealedSamples;p_>0&&(l_.A_cs=Math.round(p_).toString())}}return l_}(_o._audioSSRC,h,j,_o.audioTrack):void 0;_a&&eO(()=>{var _u;return(_u=this.requestUpload)===null||_u===void 0?void 0:_u.call(this,jT.SUBSCRIBE_STATS,{stream_id:_o.uid,stats:_a})})}})}uploadRelatedDownlinkStats(h,g){var j;(((j=this.requestRemoteMedia)===null||j===void 0?void 0:j.call(this))||[]).forEach(_t=>{let[_i,_o]=_t;if(_o.has(L0.VIDEO)&&_i.videoTrack){var ga;const _a=(_i._videoSSRC&&((ga=this.requestVideoIsReady)===null||ga===void 0?void 0:ga.call(this,_i._videoSSRC))||!1)===!0,_u=function(_c,_l,_g,r_,l_,d_){const p_=_g.videoRecv.find(c0=>c0.ssrc===_c),C_=l_?l_.videoRecv.find(c0=>c0.ssrc===_c):void 0;if(!p_)return null;const O_=iP.isRemoteVideoFreeze(d_,p_,C_)&&_l,q_={mediaType:"video",isVideoMute:!1,peerId:r_,frameRateReceived:p_.receivedFrame&&p_.receivedFrame.frameRate.toString(),frameRateDecoded:p_.decodedFrame&&p_.decodedFrame.frameRate.toString(),isFreeze:O_,bytesReceived:p_.bytes.toString(),packetsReceived:p_.packets.toString(),packetsLost:p_.packetsLost.toString(),qpSumPerFrame:Math.floor(p_.qpSumPerFrame).toString()};return p_.framesRateFirefox&&(q_.frameRateDecoded=p_.framesRateFirefox.toString(),q_.frameRateReceived=p_.framesRateFirefox.toString()),q_}(_i._videoSSRC,_a,h,_i.uid,g,_i.videoTrack);_u&&eO(()=>{var _c;(_c=this.requestUpload)===null||_c===void 0||_c.call(this,jT.SUBSCRIBE_RELATED_STATS,{stream_id:_i.uid,stats:_u})})}if(_o.has(L0.AUDIO)&&_i.audioTrack){const _a=function(_u,_c,_l,_g){const r_=_c.audioRecv.find(d_=>d_.ssrc===_u);if(!r_)return null;const l_=iP.isRemoteAudioFreeze(_g);return{mediaType:"audio",isAudioMute:!1,peerId:_l,googJitterReceived:r_.jitterMs.toString(),isFreeze:l_,bytesReceived:r_.bytes.toString(),packetsReceived:r_.packets.toString(),packetsLost:r_.packetsLost.toString(),frameReceived:r_.receivedFrames.toString(),frameDropped:r_.droppedFrames.toString()}}(_i._audioSSRC,h,_i.uid,_i.audioTrack);_a&&eO(()=>{var _u;(_u=this.requestUpload)===null||_u===void 0||_u.call(this,jT.SUBSCRIBE_RELATED_STATS,{stream_id:_i.uid,stats:_a})})}})}stopUploadDownlinkStats(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkStatsUploadInterval=void 0,this.downlinkRelatedStatsUploadInterval=void 0)}stopUploadTransportStats(){this.uploadTransportStarted&&(this.uploadTransportStarted=!1,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=void 0)}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.extensionUsageStatsUploadInterval&&window.clearInterval(this.extensionUsageStatsUploadInterval),this.extensionUsageStatsUploadInterval=void 0)}uploadDownlinkExtensionStats(h){h.forEach(g=>{let[j,_t]=g;_t.has(L0.VIDEO)&&j.videoTrack&&j.videoTrack.getProcessorStats().forEach(_i=>{var _o;(_o=this.requestUpload)===null||_o===void 0||_o.call(this,_i.type,_i.stats)}),_t.has(L0.AUDIO)&&j.audioTrack&&j.audioTrack.getProcessorStats().forEach(_i=>{var _o;(_o=this.requestUpload)===null||_o===void 0||_o.call(this,_i.type,_i.stats)})})}}function YH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function JH(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?YH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):YH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}const XH=`v=0
o=- 0 0 IN IP4 127.0.0.1
s=AgoraGateway
t=0 0
a=group:BUNDLE 0
a=msid-semantic: WMS
a=ice-lite
m=application 9 UDP/DTLS/SCTP webrtc-datachannel
c=IN IP4 127.0.0.1
a=mid:0
`,yF="9",l6=2e4,d6=4e4;class Eee{get localCapabilities(){return aR(this._localCapabilities)}get rtpCapabilities(){return aR(this._rtpCapabilities)}get candidates(){return aR(this._candidates)}get iceParameters(){return aR(this._iceParameters)}get dtlsParameters(){return aR(this._dtlsParameters)}constructor(h){_h(this,"sessionDesc",void 0),_h(this,"_localCapabilities",void 0),_h(this,"_rtpCapabilities",void 0),_h(this,"_candidates",void 0),_h(this,"_iceParameters",void 0),_h(this,"_dtlsParameters",void 0),_h(this,"setup",void 0),_h(this,"currentMidIndex",void 0),_h(this,"cname",void 0),_h(this,"firefoxSsrcMidMap",new Map),h=aR(h);const{remoteIceParameters:g,remoteDtlsParameters:j,candidates:_t,remoteRTPCapabilities:_i,remoteSetup:_o,localCapabilities:ga,cname:_a}=h,_u=uR.exports.parse(XH);this._rtpCapabilities=_i,this._candidates=_t,this._iceParameters=g,this._dtlsParameters=j,this._localCapabilities=ga,this.setup=_o,this.cname=_a;const _c=this.rtpCapabilities.send;for(const _l of _u.mediaDescriptions){if(_l.attributes.iceUfrag=g.iceUfrag,_l.attributes.icePwd=g.icePwd,_l.attributes.fingerprints=j.fingerprints,_l.attributes.candidates=_t,_l.attributes.setup=_o,_l.media.mediaType==="application"&&(_l.attributes.sctpPort="5000"),_l.media.mediaType==="video"&&(_l.media.fmts=_c.videoCodecs.map(_g=>_g.payloadType.toString(10)),_l.attributes.payloads=_c.videoCodecs,_l.attributes.extmaps=_c.videoExtensions,__("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_g,ssrcGroups:r_}=gI([{ssrcId:d6,rtx:__("USE_SUB_RTX")?40001:void 0}],this.cname);_l.attributes.ssrcs=_g,_l.attributes.ssrcGroups=r_}if(_l.media.mediaType==="audio"&&(_l.media.fmts=_c.audioCodecs.map(_g=>_g.payloadType.toString(10)),_l.attributes.payloads=_c.audioCodecs,_l.attributes.extmaps=_c.audioExtensions,gN(_l),__("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_g,ssrcGroups:r_}=gI([{ssrcId:l6}],this.cname);_l.attributes.ssrcs=_g,_l.attributes.ssrcGroups=r_}}this.sessionDesc=_u,this.currentMidIndex=_u.mediaDescriptions.length-1}updateRemoteRTPCapabilities(h){const g=uR.exports.parse(XH);this._rtpCapabilities=h;const j=this.rtpCapabilities.send;for(const _t of g.mediaDescriptions){if(_t.attributes.iceUfrag=this._iceParameters.iceUfrag,_t.attributes.icePwd=this._iceParameters.icePwd,_t.attributes.fingerprints=this._dtlsParameters.fingerprints,_t.attributes.candidates=this._candidates,_t.attributes.setup=this.setup,_t.media.mediaType==="application"&&(_t.attributes.sctpPort="5000"),_t.media.mediaType==="video"&&(_t.media.fmts=j.videoCodecs.map(_i=>_i.payloadType.toString(10)),_t.attributes.payloads=j.videoCodecs,_t.attributes.extmaps=j.videoExtensions,__("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_i,ssrcGroups:_o}=gI([{ssrcId:d6,rtx:__("USE_SUB_RTX")?40001:void 0}],this.cname);_t.attributes.ssrcs=_i,_t.attributes.ssrcGroups=_o}if(_t.media.mediaType==="audio"&&(_t.media.fmts=j.audioCodecs.map(_i=>_i.payloadType.toString(10)),_t.attributes.payloads=j.audioCodecs,_t.attributes.extmaps=j.audioExtensions,__("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:_i,ssrcGroups:_o}=gI([{ssrcId:l6}],this.cname);_t.attributes.ssrcs=_i,_t.attributes.ssrcGroups=_o}}this.sessionDesc=g,this.currentMidIndex=g.mediaDescriptions.length-1}preloadRemoteMedia(h){this.rtpCapabilities;const g=this.candidates,j=this.dtlsParameters,_t=this.iceParameters,_i=this.rtpCapabilities.send;for(let _o=1;_o<h;_o++){const ga=2*_o+l6,_a=2*_o+d6,{ssrcs:_u,ssrcGroups:_c}=gI([{ssrcId:ga}],this.cname),{ssrcs:_l,ssrcGroups:_g}=gI([{ssrcId:_a,rtx:__("USE_SUB_RTX")?_a+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:yF,protos:["UDP","TLS","RTP","SAVPF"],fmts:_i.videoCodecs.map(r_=>r_.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:_t.iceUfrag,icePwd:_t.icePwd,unrecognized:[],candidates:g,extmaps:_i.videoExtensions,fingerprints:j.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_l,ssrcGroups:_g,rtcpFeedbackWildcards:[],payloads:_i.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*_o-1)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:yF,protos:["UDP","TLS","RTP","SAVPF"],fmts:_i.audioCodecs.map(r_=>r_.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:_t.iceUfrag,icePwd:_t.icePwd,unrecognized:[],candidates:g,extmaps:_i.audioExtensions,fingerprints:j.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:_u,ssrcGroups:_c,rtcpFeedbackWildcards:[],payloads:_i.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*_o)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return uR.exports.print(this.sessionDesc)}send(h,g,j,_t){const{ssrcs:_i,ssrcGroups:_o}=gI(g,this.cname,__("SYNC_GROUP")?j:void 0),ga=this.findPreloadMediaDesc(_i);if(ga){if(GS()&&this.firefoxSsrcMidMap.set(_i[0].ssrcId,ga.attributes.mid),_t&&(_t.twcc||_t.remb)){const _a=this.sessionDesc.mediaDescriptions.indexOf(ga);return this.sessionDesc.mediaDescriptions[_a]=this.mungSendMediaDesc(ga,_t),{mid:ga.attributes.mid,needExchangeSDP:!0}}return{mid:ga.attributes.mid,needExchangeSDP:!1}}{const _a=this.findAvailableMediaIndex(h,_i);let _u;return _a===-1||sT()||aT()||C2()||_a===0&&__("USE_SUB_RTX")?(_u=this.createOrRecycleSendMedia(h,_i,_o,"sendonly",_t),this.updateBundleMids()):(_u=aR(this.sessionDesc.mediaDescriptions[_a]),_u.attributes.direction="sendonly",_u.attributes.ssrcs=_i,_u.attributes.ssrcGroups=_o,this.sessionDesc.mediaDescriptions[_a]=this.mungSendMediaDesc(_u,_t)),GS()&&this.firefoxSsrcMidMap.set(_i[0].ssrcId,_u.attributes.mid),{mid:_u.attributes.mid,needExchangeSDP:!0}}}batchSend(h){const g=h.map(_i=>{let{kind:_o,ssrcMsg:ga,mslabel:_a}=_i;return this.send(_o,ga,_a)}),j=[];let _t=!1;return g.forEach(_i=>{let{mid:_o,needExchangeSDP:ga}=_i;ga&&(_t=!0),j.push(_o)}),{mids:j,needExchangeSDP:_t}}stopSending(h){const g=this.sessionDesc.mediaDescriptions.filter(j=>j.attributes.mid&&h.indexOf(j.attributes.mid)!==-1);if(g.length!==h.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");g.forEach(j=>{j.attributes.mid==="0"||GS()||sT()||aT()?j.attributes.ssrcs=[]:(j.attributes.ssrcs=[],j.attributes.direction="inactive",j.media.port="0")}),this.updateBundleMids()}mute(h){const g=this.sessionDesc.mediaDescriptions.find(j=>j.attributes.mid===h);if(!g)throw new Error("mediaDescription not found with ".concat(h," in remote SDP when calling RemoteSDP.mute."));g.attributes.direction="inactive"}unmute(h){const g=this.sessionDesc.mediaDescriptions.find(j=>j.attributes.mid===h);if(!g)throw new Error("mediaDescription not found with ".concat(h," in remote SDP when calling RemoteSDP.unmute."));g.attributes.direction="sendonly"}muteRemote(h){const g=this.sessionDesc.mediaDescriptions.filter(j=>h.includes(j.attributes.mid||""));if(g.length!==h.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");g.forEach(j=>{j.attributes.direction="inactive"})}unmuteRemote(h){const g=this.sessionDesc.mediaDescriptions.filter(j=>h.includes(j.attributes.mid||""));if(g.length!==h.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");g.forEach(j=>{j.attributes.direction="recvonly"})}receive(h,g,j,_t){h.forEach((_i,_o)=>{this.createOrRecycleRecvMedia(_i,[],"recvonly",g,j,_t[_o])}),this.updateBundleMids()}stopReceiving(h){const g=this.sessionDesc.mediaDescriptions.filter(j=>h.indexOf(j.attributes.mid)!==-1);if(g.length!==h.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");g.forEach(j=>{j.media.port="0",j.attributes.direction="inactive"}),this.updateBundleMids()}updateCandidates(h){h===DR.TCP?this._candidates.forEach(g=>{this._candidates.findIndex(j=>j.transport==="tcp"&&j.connectionAddress===g.connectionAddress&&j.port===g.port)===-1&&this._candidates.push(JH(JH({},g),{},{foundation:"tcpcandidate",priority:Number(g.priority)-1+"",transport:"tcp",port:Number(g.port)+90+""}))}):this._candidates=this._candidates.filter(g=>g.transport!=="tcp");for(const g of this.sessionDesc.mediaDescriptions)g.attributes.candidates=this.candidates}restartICE(h){h=aR(h),this._iceParameters=h,this.sessionDesc.mediaDescriptions.forEach(g=>{g.attributes.iceUfrag=h.iceUfrag,g.attributes.icePwd=h.icePwd})}predictReceivingMids(h){const g=[];for(let j=0;j<h;j++)g.push((this.currentMidIndex+j+1).toString(10));return g}findAvailableMediaIndex(h,g){return this.sessionDesc.mediaDescriptions.findIndex(j=>{const _t=j.media.mediaType===h&&j.media.port!=="0"&&(j.attributes.direction==="sendonly"||j.attributes.direction==="sendrecv")&&j.attributes.ssrcs.length===0;if(GS()){if(_t){const _i=this.firefoxSsrcMidMap.get(g[0].ssrcId);return!(_i||j.attributes.mid!=="0"&&j.attributes.mid!=="1")||!(!_i||_i!==j.attributes.mid)}return!1}return _t})}createOrRecycleRecvMedia(h,g,j,_t,_i,_o){const ga=h._mediaStreamTrack.kind,_a=this.rtpCapabilities.recv,_u=this.localCapabilities.send;let _c=[];if(ga===L0.VIDEO){var _l,_g;if(__("H264_PROFILE_LEVEL_ID")&&_t==="h264"&&(_c=_a.videoCodecs.filter(C_=>{var O_,q_;return(((O_=C_.rtpMap)===null||O_===void 0?void 0:O_.encodingName.toLowerCase())||"").includes(_t)&&(C_==null||(q_=C_.fmtp)===null||q_===void 0?void 0:q_.parameters["profile-level-id"])===__("H264_PROFILE_LEVEL_ID")})),!_c||((_l=_c)===null||_l===void 0?void 0:_l.length)===0){const C_=_u.videoCodecs.filter(O_=>{var q_;return(((q_=O_.rtpMap)===null||q_===void 0?void 0:q_.encodingName.toLowerCase())||"").includes(_t)});C_.length!==0&&(_c=_a.videoCodecs.filter(O_=>C_.some(q_=>q_.payloadType===O_.payloadType)))}if(__("USE_PUB_RTX")){const C_=_c.map(q_=>q_.payloadType.toString()),O_=_a.videoCodecs.filter(q_=>{var c0,K_;return((c0=q_.rtpMap)===null||c0===void 0?void 0:c0.encodingName)==="rtx"&&C_.includes(((K_=q_.fmtp)===null||K_===void 0?void 0:K_.parameters.apt)||"")});_c=[..._c,...O_]}_c.length===0&&(wE.warning("codec ".concat(_t," not included in rtpCapabilities, fallback to default payloads: ").concat((_g=_a.videoCodecs[0].rtpMap)===null||_g===void 0?void 0:_g.encodingName)),_c=_a.videoCodecs)}else _c=_a.audioCodecs.filter(C_=>{var O_;return(((O_=C_.rtpMap)===null||O_===void 0?void 0:O_.encodingName.toLowerCase())||"").includes(_i)}),_c.length===0&&(wE.warning("codec ".concat(_i," not included in rtpCapabilities, fallback to opus")),_c=_a.audioCodecs.filter(C_=>{var O_;return(((O_=C_.rtpMap)===null||O_===void 0?void 0:O_.encodingName.toLowerCase())||"").includes("opus")}));const r_=ga===L0.VIDEO?_a.videoExtensions:_a.audioExtensions;this.currentMidIndex+=1;const l_="".concat(this.currentMidIndex);let d_={media:{mediaType:ga,port:yF,protos:["UDP","TLS","RTP","SAVPF"],fmts:_c.map(C_=>C_.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:r_,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:g,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:_c,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:j,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(l_)}};d_=this.mungRecvMediaDsec(d_,h,_o);const p_=this.findFirstClosedMedia(ga);if(p_){const C_=this.sessionDesc.mediaDescriptions.indexOf(p_);this.sessionDesc.mediaDescriptions[C_]=d_}else this.sessionDesc.mediaDescriptions.push(d_);return d_}createOrRecycleSendMedia(h,g,j,_t,_i){const _o=this.rtpCapabilities.send,ga=h===L0.VIDEO?_o.videoCodecs:_o.audioCodecs,_a=h===L0.VIDEO?_o.videoExtensions:_o.audioExtensions;this.currentMidIndex+=1;const _u="".concat(this.currentMidIndex);let _c={media:{mediaType:h,port:yF,protos:["UDP","TLS","RTP","SAVPF"],fmts:ga.map(_g=>_g.payloadType.toString(10))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:_a,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:g,ssrcGroups:j,rtcpFeedbackWildcards:[],payloads:ga,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:_t,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(_u)}};_c=this.mungSendMediaDesc(_c,_i);const _l=this.findFirstClosedMedia(h);if(_l){const _g=this.sessionDesc.mediaDescriptions.indexOf(_l);this.sessionDesc.mediaDescriptions[_g]=_c}else this.sessionDesc.mediaDescriptions.push(_c);return _c}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter(h=>h.media.port!=="0").map(h=>h.attributes.mid)}mungRecvMediaDsec(h,g,j){const _t=aR(h);return i6(_t),dP(_t,g),o6(_t,g),hH(_t),JU(_t,j,this.localCapabilities.send),_t}mungSendMediaDesc(h,g){const j=aR(h);return JU(j,g,this.localCapabilities.recv),gN(j),j}updateRecvMedia(h,g){const j=this.sessionDesc.mediaDescriptions.findIndex(_t=>_t.attributes.mid===h);if(j!==-1){const _t=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[j],g);this.sessionDesc.mediaDescriptions[j]=_t}}bumpMid(h){this.currentMidIndex+=h}findFirstClosedMedia(h){return this.sessionDesc.mediaDescriptions.find(g=>GS()?g.media.port==="0"&&g.media.mediaType===h:g.media.port==="0")}findPreloadMediaDesc(h){return this.sessionDesc.mediaDescriptions.find(g=>{var j,_t;return((j=g.attributes)===null||j===void 0||(_t=j.ssrcs[0])===null||_t===void 0?void 0:_t.ssrcId)===h[0].ssrcId})}getSSRC(h){var g;return(g=this.sessionDesc.mediaDescriptions.find(j=>j.attributes.mid===h))===null||g===void 0?void 0:g.attributes.ssrcs}}var lS;function QH(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function SF(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?QH(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):QH(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}let vee=(G_((lS=class AF extends OU{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(h,g,j){super(h,g),_h(this,"store",void 0),_h(this,"peerConnection",void 0),_h(this,"remoteSDP",void 0),_h(this,"initialOffer",void 0),_h(this,"transportEventReceiver",void 0),_h(this,"statsFilter",void 0),_h(this,"localCapabilities",void 0),_h(this,"localCandidateCount",0),_h(this,"allCandidatesReceived",!1),_h(this,"establishPromise",void 0),_h(this,"mutex",new lT("NVExtentionsConnection-mutex")),_h(this,"rtcMedia",void 0),this.store=g,this.peerConnection=j,this.statsFilter=u6(this.peerConnection,__("STATS_UPDATE_INTERVAL"),void 0,GS()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(h){try{const g=await this.peerConnection.createOffer();if(!g.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const j=l1(g.sdp),_t=await mH(!__("USE_PUB_RTX")&&!__("USE_SUB_RTX"),__("FILTER_VIDEO_FEC"),__("FILTER_AUDIO_FEC"));return this.localCapabilities=_t,this.initialOffer=g,SF(SF({},j),{},{rtpCapabilities:_t,offerSDP:g.sdp})}catch(g){throw new f_(c_.GET_LOCAL_CONNECTION_PARAMS_FAILED,g.toString())}}async connect(h,g,j,_t,_i,_o){try{if(!this.initialOffer)throw new Error("Cannot establish NVConnection without initial offer.");this.remoteSDP=new Eee({remoteIceParameters:h,remoteDtlsParameters:g,candidates:j,remoteRTPCapabilities:_t,remoteSetup:_i,localCapabilities:s6(this.localCapabilities),cname:_o});const ga=this.remoteSDP.toString(),_a=uR.exports.parse(this.initialOffer.sdp),_u=_a.mediaDescriptions.find(_g=>_g.media.mediaType==="audio");_u&&gN(_u);const _c=uR.exports.print(_a),_l=this.logSDPExchange(_c||"","offer","local","connect");await this.peerConnection.setLocalDescription({type:"offer",sdp:_c}),_l==null||_l(ga),await this.peerConnection.setRemoteDescription({type:"answer",sdp:ga})}catch(ga){throw new f_(c_.EXCHANGE_SDP_FAILED,"NV.connect failed; ".concat(ga.toString()))}}async updateRemoteConnect(h){var g,j,_t;(g=this.remoteSDP)===null||g===void 0||g.updateRemoteRTPCapabilities(h),(j=this.remoteSDP)===null||j===void 0||j.preloadRemoteMedia(2);const _i=(_t=this.remoteSDP)===null||_t===void 0?void 0:_t.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:_i});const _o=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(_o),wE.debug("[NVExtentionsConnection] updateRemoteRTPCapabilities by exchanging SDP.")}send(h,g,j){var _t=this;return xI(function*(){const _i=yield $0(_t.mutex.lock("From NVExtentionsConnection.send"));try{if(!_t.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.send before remote SDP created");const _o=[];h.forEach(d_=>{const p_=_t.peerConnection.addTransceiver(d_._mediaStreamTrack,{direction:"sendonly"});_o.push(p_)}),GS()&&__("SIMULCAST")===!0&&(yield $0(_t.applySimulcastForFirefox(_o,h)));const ga=yield $0(_t.peerConnection.createOffer()),_a=_t.remoteSDP.predictReceivingMids(h.length),_u=_t.mungSendOfferSDP(ga.sdp,h,_a),_c=uR.exports.parse(_u),_l=_a.map(d_=>{const p_=_c.mediaDescriptions.find(C_=>C_.attributes.mid===d_);if(!p_)throw new Error("Cannot extract ssrc from mediaDescription.");return dH(p_,__("USE_PUB_RTX"))});let _g;try{_g=yield _l}catch(d_){_g=[],_t.remoteSDP.receive(h,g,j,_g);const p_=_t.remoteSDP.toString();throw yield $0(_t.peerConnection.setLocalDescription({type:"offer",sdp:_u})),yield $0(_t.peerConnection.setRemoteDescription({type:"answer",sdp:p_})),yield $0(_t.stopSending(_a,!0)),d_}_t.remoteSDP.receive(h,g,j,_g);const r_=_t.remoteSDP.toString(),l_=_t.logSDPExchange(_u,"offer","local","send");return yield $0(_t.peerConnection.setLocalDescription({type:"offer",sdp:_u})),yield $0(_t.applySimulcastEncodings(_o,h)),yield $0(_t.applySendEncodings(_o,h)),l_==null||l_(r_),yield $0(_t.peerConnection.setRemoteDescription({type:"answer",sdp:r_})),_o.map((d_,p_)=>{const C_=_a[p_];return{localSSRC:_l[p_],id:C_,transceiver:d_}})}catch(_o){throw _o instanceof f_?_o:new f_(c_.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.send failed; ".concat(_o.toString()))}finally{_i()}})()}async stopSending(h,g){const j=g?void 0:await this.mutex.lock("From NVExtentionsConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopSending before remote SDP created");const _t=this.peerConnection.getTransceivers().filter(_a=>h.indexOf(_a.mid)!==-1);if(_t.length!==h.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVExtentionsConnection.stopSending.");_t.map(_a=>{var _u;_a.direction="inactive",(_u=_a.stop)===null||_u===void 0||_u.call(_a)});const _i=await this.peerConnection.createOffer(),_o=this.logSDPExchange(_i.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(_i),this.remoteSDP.stopReceiving(h);const ga=this.remoteSDP.toString();_o==null||_o(ga),await this.peerConnection.setRemoteDescription({type:"answer",sdp:ga})}catch(_t){throw new f_(c_.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.stopSending failed; ".concat(_t.toString()))}finally{j&&j()}}async receive(h,g,j,_t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.receive ".concat(h," before remoteSDP created."));const{mid:_i,needExchangeSDP:_o}=this.remoteSDP.send(h,g,j,_t);if(_o){const _a=this.remoteSDP.toString(),_u=this.logSDPExchange(_a,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_a});const _c=await this.peerConnection.createAnswer(),_l=this.mungReceiveAnswerSDP(_c.sdp,_i,h);_u==null||_u(_l||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:_l}),wE.debug("[NVExtentionsConnection] receive ".concat(h," by exchanging SDP."))}else wE.debug("[NVExtentionsConnection] receive ".concat(h," no need to exchange SDP."));const ga=this.peerConnection.getTransceivers().find(_a=>_a.mid===_i);if(!ga)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:ga.receiver.track,id:_i}}catch(_i){throw new f_(c_.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(_i.toString()))}}async batchReceive(h){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.batchReceive before remoteSDP created.");const{mids:g,needExchangeSDP:j}=this.remoteSDP.batchSend(h);if(j){const _t=this.remoteSDP.toString(),_i=this.logSDPExchange(_t,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:_t});const _o=await this.peerConnection.createAnswer();_i==null||_i(_o.sdp||""),await this.peerConnection.setLocalDescription(_o),wE.debug("[NVExtentionsConnection] batchReceive by exchanging SDP.")}else wE.debug("[NVExtentionsConnection] batchReceive no need to exchange SDP.");return g.map(_t=>{const _i=this.peerConnection.getTransceivers().find(_o=>_o.mid===_t);if(!_i)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:_i.receiver.track,id:_t}})}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(g.toString()))}}async stopReceiving(h){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(h);const g=this.remoteSDP.toString(),j=this.logSDPExchange(g,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const _t=await this.peerConnection.createAnswer();j==null||j(_t.sdp||""),await this.peerConnection.setLocalDescription(_t)}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"NVExtentionsConnection stopReceiving failed; ".concat(g.toString()))}}async muteRemote(h){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteRemote mid=".concat(h," before remote SDP created."));this.remoteSDP.mute(h);const g=this.remoteSDP.toString(),j=this.logSDPExchange(g,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const _t=await this.peerConnection.createAnswer();j==null||j(_t.sdp||""),await this.peerConnection.setLocalDescription(_t)}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteRemote failed; ".concat(g.toString()))}}async unmuteRemote(h){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteRemote mid=".concat(h," before remote SDP created."));this.remoteSDP.unmute(h);const g=this.remoteSDP.toString(),j=this.logSDPExchange(g,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:g});const _t=await this.peerConnection.createAnswer();j==null||j(_t.sdp||""),await this.peerConnection.setLocalDescription(_t)}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteRemote failed; ".concat(g.toString()))}}async muteLocal(h){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteLocal before remote SDP created.");const g=this.peerConnection.getTransceivers().filter(_o=>_o.mid&&h.indexOf(_o.mid)!==-1);if(g.length!==h.length)throw new Error("Transceivers' length doesn't match mids' length.");g.map(_o=>{_o.direction="inactive"});const j=await this.peerConnection.createOffer(),_t=this.logSDPExchange(j.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(j),this.remoteSDP.muteRemote(h);const _i=this.remoteSDP.toString();_t==null||_t(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteLocal failed; ".concat(g.toString()))}}async unmuteLocal(h){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteLocal before remote SDP created.");const g=this.peerConnection.getTransceivers().filter(_o=>_o.mid&&h.indexOf(_o.mid)!==-1);if(g.length!==h.length)throw new Error("Transceivers' length doesn't match mids' length.");g.map(async(_o,ga)=>{_o.direction="sendonly"});const j=await this.peerConnection.createOffer(),_t=this.logSDPExchange(j.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(j),this.remoteSDP.unmuteRemote(h);const _i=this.remoteSDP.toString();_t==null||_t(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(g){throw new f_(c_.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteLocal failed; ".concat(g.toString()))}}restartICE(h){var g=this;return xI(function*(){const j=yield $0(g.mutex.lock("From NVExtentionsConnection.restartICE"));try{if(!g.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(QS().supportPCSetConfiguration){const _u=g.peerConnection.getConfiguration(),_c=h===DR.RELAY?"relay":"all";_u.iceTransportPolicy!==_c&&(wE.debug("restartICE change iceTransportPolicy from [".concat(_u.iceTransportPolicy,"] to [").concat(_c,"]")),_u.iceTransportPolicy=_c,g.peerConnection.setConfiguration(_u))}else if(h===DR.RELAY)return;h!==DR.RELAY&&g.remoteSDP.updateCandidates(h);const _t=yield $0(g.peerConnection.createOffer({iceRestart:!0}));if(!_t.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const _i=l1(_t.sdp),{remoteIceParameters:_o}=yield _i.iceParameters;g.remoteSDP.restartICE(_o);const ga=g.remoteSDP.toString(),_a=g.logSDPExchange(_t.sdp||"","offer","local","restartICE");yield $0(g.peerConnection.setLocalDescription(_t)),_a==null||_a(ga),yield $0(g.peerConnection.setRemoteDescription({type:"answer",sdp:ga}))}catch(_t){wE.warning("restart ICE failed, abort operation",_t)}finally{j()}})()}close(){var h;(h=this.onConnectionStateChange)===null||h===void 0||h.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(h){return this.statsFilter.getVideoIsReady(h)}async updateEncoderConfig(h,g){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.updateEncoderConfig before remote SDP created.");const j=await this.peerConnection.createOffer(),_t=this.mungSendOfferSDP(j.sdp,[g],[h]);this.remoteSDP.updateRecvMedia(h,g);const _i=this.remoteSDP.toString(),_o=this.logSDPExchange(_t,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:_t}),_o==null||_o(_i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:_i})}catch(j){throw new f_(c_.EXCHANGE_SDP_FAILED,j.toString())}}async updateSendParameters(h,g){const j=this.peerConnection.getTransceivers().filter(_t=>_t.mid===h);j.length===1&&(this.isVP8Simulcast(g)?GS()||await this.applySimulcastEncodings(j,[g]):await this.applySendEncodings(j,[g]))}setStatsRemoteVideoIsReady(h,g){this.statsFilter.setVideoIsReady2(h,g)}async replaceTrack(h,g){const j=this.peerConnection.getTransceivers().find(_t=>_t.mid===g);j&&await j.sender.replaceTrack(h._mediaStreamTrack)}getP2PConnectionParams(){var h;if((h=this.peerConnection.currentLocalDescription)===null||h===void 0||!h.sdp||!this.localCapabilities)throw new Error;return SF(SF({},l1(this.peerConnection.currentLocalDescription.sdp)),{},{rtpCapabilities:this.localCapabilities})}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var h;(h=this.onICEConnectionStateChange)===null||h===void 0||h.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var h;(h=this.onConnectionStateChange)===null||h===void 0||h.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=h=>{h.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,wE.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout(()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,wE.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))},__("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(h){const g={iceServers:[]};return h.iceServers?g.iceServers=h.iceServers:h.turnServer&&h.turnServer.mode!=="off"&&(fL(h.turnServer.servers)?g.iceServers=h.turnServer.servers:(g.iceServers&&g.iceServers.push(...AF.turnServerConfigToIceServers(h.turnServer.servers)),__("USE_TURN_SERVER_OF_GATEWAY")&&g.iceServers&&h.turnServer.serversFromGateway&&g.iceServers.push(...AF.turnServerConfigToIceServers(h.turnServer.serversFromGateway)),__("FORCE_TURN_TCP")?g.iceTransportPolicy="relay":h.turnServer.servers.concat(h.turnServer.serversFromGateway||[]).forEach(j=>{j.forceturn&&(g.iceTransportPolicy="relay")}))),g}static turnServerConfigToIceServers(h){const g=[];return h.forEach(j=>{j.security?j.tcpport&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turns:".concat(MU(j.turnServerURL),":").concat(j.tcpport,"?transport=tcp")}):(j.udpport&&!__("FORCE_TURN_TCP")&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turn:".concat(j.turnServerURL,":").concat(j.udpport,"?transport=udp")}),j.tcpport&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turn:".concat(j.turnServerURL,":").concat(j.tcpport,"?transport=tcp")}))}),g}async applySendEncodings(h,g){try{if(!QS().supportSetRtpSenderParameters||h.length!==g.length)return;for(let _u=0;_u<h.length;_u++){const _c=h[_u],_l=g[_u];if(_l&&_l instanceof cR){var j,_t;if(this.isVP8Simulcast(_l))continue;const _g={},r_={};switch(_l._optimizationMode){case"motion":_g.degradationPreference="maintain-framerate";break;case"detail":_g.degradationPreference="maintain-resolution";break;default:_g.degradationPreference="balanced"}var _i,_o,ga,_a;if((j=_l._encoderConfig)!==null&&j!==void 0&&j.bitrateMax&&(r_.maxBitrate=1e3*((_i=_l._encoderConfig)===null||_i===void 0?void 0:_i.bitrateMax)),_l._hints.includes(ER.LOW_STREAM)&&((_o=_l._encoderConfig)!==null&&_o!==void 0&&_o.frameRate&&(r_.maxFramerate=VO(_l._encoderConfig.frameRate)),(ga=_l._encoderConfig)!==null&&ga!==void 0&&ga.scaleResolutionDownBy&&((_a=_l._encoderConfig)===null||_a===void 0?void 0:_a.scaleResolutionDownBy)>1&&(r_.scaleResolutionDownBy=_l._encoderConfig.scaleResolutionDownBy)),__("DSCP_TYPE")&&YN()){const p_=__("DSCP_TYPE");["very-low","low","medium","high"].includes(p_)&&(r_.networkPriority=p_)}const l_=_c.sender.getParameters(),d_=(_t=l_.encodings)===null||_t===void 0?void 0:_t[0];GS()&&!d_&&(_g.encodings=[r_]),d_&&Object.assign(d_,r_),Object.assign(l_,_g),await _c.sender.setParameters(l_)}}}catch{wE.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(h,g,j){const _t=uR.exports.parse(h);return g.forEach((_i,_o)=>{const ga=j[_o],_a=_t.mediaDescriptions.find(_u=>_u.attributes.mid===ga);_a&&(dP(_a,_i),fH(_a,_i,this.store.codec))}),uR.exports.print(_t)}mungReceiveAnswerSDP(h,g,j){const _t=uR.exports.parse(h),_i=_t.mediaDescriptions.find(_o=>_o.attributes.mid===g);return _i&&j===L0.AUDIO&&_i.media.mediaType==="audio"&&gN(_i),uR.exports.print(_t)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=h=>{var g;(g=this.onFirstAudioReceived)===null||g===void 0||g.call(this,h)},this.statsFilter.onFirstVideoReceived=h=>{var g;(g=this.onFirstVideoReceived)===null||g===void 0||g.call(this,h)},this.statsFilter.onFirstAudioDecoded=h=>{var g;(g=this.onFirstAudioDecoded)===null||g===void 0||g.call(this,h)},this.statsFilter.onFirstVideoDecoded=(h,g,j)=>{var _t;(_t=this.onFirstVideoDecoded)===null||_t===void 0||_t.call(this,h,g,j)},this.statsFilter.onSelectedLocalCandidateChanged=(h,g)=>{var j;(j=this.onSelectedLocalCandidateChanged)===null||j===void 0||j.call(this,h,g)},this.statsFilter.onSelectedRemoteCandidateChanged=(h,g)=>{var j;(j=this.onSelectedRemoteCandidateChanged)===null||j===void 0||j.call(this,h,g)},this.statsFilter.onFirstVideoDecodedTimeout=h=>{var g;(g=this.onFirstVideoDecodedTimeout)===null||g===void 0||g.call(this,h)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(h,g){if(h.length===g.length)for(let ga=0;ga<h.length;ga++){var j,_t,_i,_o;const _a=h[ga],_u=g[ga];if(_u instanceof cR&&!_u._hints.includes(ER.LOW_STREAM)&&(j=_u._encoderConfig)!==null&&j!==void 0&&j.bitrateMax&&((_t=_u._encoderConfig)===null||_t===void 0?void 0:_t.bitrateMax)>200&&(_i=_u._scalabiltyMode)!==null&&_i!==void 0&&_i.numSpatialLayers&&((_o=_u._scalabiltyMode)===null||_o===void 0?void 0:_o.numSpatialLayers)>1&&this.store.codec==="vp8"){const _c={},_l={high:1e3*(_u._encoderConfig.bitrateMax-50),medium:5e4};_c.encodings=[{rid:"m",active:!0,maxBitrate:_l.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:_l.high}];const _g=_a.sender.getParameters();await _a.sender.setParameters(Object.assign(_g,_c))}}}async applySimulcastEncodings(h,g){if(!GS()&&h.length===g.length)for(let j=0;j<h.length;j++){const _t=g[j];if(_t instanceof cR&&this.isVP8Simulcast(_t)){const _i=h[j],_o={},ga={high:1e3*(_t._encoderConfig.bitrateMax-50),medium:5e4};_o.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:ga.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:ga.medium,scaleResolutionDownBy:4}];const _a=_i.sender.getParameters();await _i.sender.setParameters(Object.assign(_a,_o))}}}isVP8Simulcast(h){var g,j,_t,_i;return!!(h instanceof cR&&__("SIMULCAST")&&this.store.codec==="vp8"&&!h._hints.includes(ER.LOW_STREAM)&&(g=h._encoderConfig)!==null&&g!==void 0&&g.bitrateMax&&((j=h._encoderConfig)===null||j===void 0?void 0:j.bitrateMax)>200&&(_t=h._scalabiltyMode)!==null&&_t!==void 0&&_t.numSpatialLayers&&((_i=h._scalabiltyMode)===null||_i===void 0?void 0:_i.numSpatialLayers)>1)}logSDPExchange(h,g,j,_t){if(__("SDP_LOGGING"))return wE.upload("exchanging ".concat(j," ").concat(g," SDP during NVExtentionsConnection.").concat(_t,`
`),h),g==="offer"?_i=>{this.logSDPExchange(_i,"answer",j==="local"?"remote":"local",_t)}:void 0}async getRemoteSSRC(h){if(!this.remoteSDP)return;const g=this.remoteSDP.getSSRC(h);return g==null?void 0:g[0].ssrcId}setConfiguration(h){if(QS().supportPCSetConfiguration){const g=AF.resolvePCConfiguration(h);this.peerConnection.setConfiguration(g)}}}).prototype,"connect",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"connect"),lS.prototype),G_(lS.prototype,"updateRemoteConnect",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"updateRemoteConnect"),lS.prototype),G_(lS.prototype,"receive",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"receive"),lS.prototype),G_(lS.prototype,"batchReceive",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"batchReceive"),lS.prototype),G_(lS.prototype,"stopReceiving",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"stopReceiving"),lS.prototype),G_(lS.prototype,"muteRemote",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"muteRemote"),lS.prototype),G_(lS.prototype,"unmuteRemote",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"unmuteRemote"),lS.prototype),G_(lS.prototype,"muteLocal",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"muteLocal"),lS.prototype),G_(lS.prototype,"unmuteLocal",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"unmuteLocal"),lS.prototype),G_(lS.prototype,"close",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"close"),lS.prototype),G_(lS.prototype,"updateEncoderConfig",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"updateEncoderConfig"),lS.prototype),G_(lS.prototype,"updateSendParameters",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"updateSendParameters"),lS.prototype),G_(lS.prototype,"replaceTrack",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"replaceTrack"),lS.prototype),G_(lS.prototype,"getRemoteSSRC",[tI],Object.getOwnPropertyDescriptor(lS.prototype,"getRemoteSSRC"),lS.prototype),lS);function tI(d,h,g){const j=d[h];if(typeof j!="function")throw new Error("Cannot use mutex on object property.");return g.value=async function(){const _t=this.mutex,_i=await _t.lock("From NVExtentionsConnection.".concat(h));try{for(var _o=arguments.length,ga=new Array(_o),_a=0;_a<_o;_a++)ga[_a]=arguments[_a];return await j.apply(this,ga)}finally{_i()}},g}var RS;function ZH(d){var h,g,j,_t=2;for(typeof Symbol<"u"&&(g=cH,j=Symbol.iterator);_t--;){if(g&&(h=d[g])!=null)return h.call(d);if(j&&(h=d[j])!=null)return new p6(h.call(d));g="@@asyncIterator",j="@@iterator"}throw new TypeError("Object is not async iterable")}function p6(d){function h(g){if(Object(g)!==g)return a0.reject(new TypeError(g+" is not an object."));var j=g.done;return a0.resolve(g.value).then(function(_t){return{value:_t,done:j}})}return(p6=function(g){this.s=g,this.n=g.next}).prototype={s:null,n:null,next:function(){return h(this.n.apply(this.s,arguments))},return:function(g){var j=this.s.return;return j===void 0?a0.resolve({value:g,done:!0}):h(j.apply(this.s,arguments))},throw:function(g){var j=this.s.return;return j===void 0?a0.reject(g):h(j.apply(this.s,arguments))}},new p6(d)}let vN=(G_((RS=class NF extends OU{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(h,g){super(h,g),_h(this,"store",void 0),_h(this,"peerConnection",void 0),_h(this,"cname",void 0),_h(this,"mutex",new lT("DataChannelConnection-mutex")),_h(this,"dataChannel",void 0),_h(this,"_p2pConnection",void 0),_h(this,"establishPromise",void 0),_h(this,"_nvMedia",void 0),this.store=g,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection(NF.resolvePCConfiguration(h),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new vee(h,g,this.peerConnection),this.bindPCEvents(),this.establishPromise=this._p2pConnection.establishPromise}async establish(){var h;const g=(h=this._nvMedia)===null||h===void 0?void 0:h.getLocalRtpCapabilities();return await this._p2pConnection.establish(g)}getP2PConnectionParams(){return this._p2pConnection.getP2PConnectionParams()}async connect(h,g,j,_t,_i,_o){return this.cname=_o,await this._p2pConnection.connect(h,g,j,_t,_i,_o),await new a0((ga,_a)=>{const _u=setTimeout(()=>{this.closeSignal(),_a(new f_(c_.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(j))))},2e3);this.dataChannel.onopen=()=>{if(this.dataChannel.readyState==="open")return clearTimeout(_u),void ga()},this.dataChannel.onerror=_c=>{this.closeSignal(),_a(_c)}}),{transmitter:this.dataChannel,close:this.closeSignal.bind(this)}}send(h,g,j){var _t=this;return xI(function*(){const _i=yield $0(_t.mutex.lock("From DataChannelConnection.send"));try{return yield*YU(ZH(_t._p2pConnection.send(h,g,j)),$0)}finally{_i()}})()}async stopSending(h,g){return this._p2pConnection.stopSending(h,g)}async receive(h,g,j,_t){return this._nvMedia?(wE.debug("[DataChannelConnection] receive ".concat(h," by DataChannel.")),await this._nvMedia.reveiveByRTCMedia(h,g,this.cname)):(wE.debug("[DataChannelConnection] receive ".concat(h," by WebRTC.")),await this._p2pConnection.receive(h,g,j,_t))}async batchReceive(h){return[...await this._p2pConnection.batchReceive(h)]}async stopReceiving(h){return await this._p2pConnection.stopReceiving(h)}async muteRemote(h){return await this._p2pConnection.muteRemote(h)}async unmuteRemote(h){return await this._p2pConnection.unmuteRemote(h)}async muteLocal(h){return await this._p2pConnection.muteLocal(h)}async unmuteLocal(h){return await this._p2pConnection.unmuteLocal(h)}restartICE(h){var g=this;return xI(function*(){return yield*YU(ZH(g._p2pConnection.restartICE(h)),$0)})()}close(){var h;(h=this._nvMedia)===null||h===void 0||h.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(h){return this._p2pConnection.getRemoteVideoIsReady(h)}updateRemoteConnect(h){var g;(g=this._nvMedia)===null||g===void 0||g.setRemoteRtpCapabilities(h),this._p2pConnection.updateRemoteConnect(h)}async updateEncoderConfig(h,g){return await this._p2pConnection.updateEncoderConfig(h,g)}async updateSendParameters(h,g){return await this._p2pConnection.updateSendParameters(h,g)}setStatsRemoteVideoIsReady(h,g){this._p2pConnection.setStatsRemoteVideoIsReady(h,g)}async replaceTrack(h,g){return await this._p2pConnection.replaceTrack(h,g)}async getRemoteSSRC(h){return this._p2pConnection.getRemoteSSRC(h)}logSDPExchange(h,g,j,_t){if(__("SDP_LOGGING"))return wE.upload("exchanging ".concat(j," ").concat(g," SDP during DataChannelConnection.").concat(_t,`
`),h),g==="offer"?_i=>{this.logSDPExchange(_i,"answer",j==="local"?"remote":"local",_t)}:void 0}static resolvePCConfiguration(h){const g={iceServers:[]};return h.iceServers?g.iceServers=h.iceServers:h.turnServer&&h.turnServer.mode!=="off"&&(fL(h.turnServer.servers)?g.iceServers=h.turnServer.servers:(g.iceServers&&g.iceServers.push(...NF.turnServerConfigToIceServers(h.turnServer.servers)),__("USE_TURN_SERVER_OF_GATEWAY")&&g.iceServers&&h.turnServer.serversFromGateway&&g.iceServers.push(...NF.turnServerConfigToIceServers(h.turnServer.serversFromGateway)),__("FORCE_TURN_TCP")?g.iceTransportPolicy="relay":h.turnServer.servers.concat(h.turnServer.serversFromGateway||[]).forEach(j=>{j.forceturn&&(g.iceTransportPolicy="relay")}))),g}static turnServerConfigToIceServers(h){const g=[];return h.forEach(j=>{j.security?j.tcpport&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turns:".concat(MU(j.turnServerURL),":").concat(j.tcpport,"?transport=tcp")}):(j.udpport&&!__("FORCE_TURN_TCP")&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turn:".concat(j.turnServerURL,":").concat(j.udpport,"?transport=udp")}),j.tcpport&&g.push({username:j.username,credential:j.password,credentialType:"password",urls:"turn:".concat(j.turnServerURL,":").concat(j.tcpport,"?transport=tcp")}))}),g}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=h=>{var g;return(g=this.onICEConnectionStateChange)===null||g===void 0?void 0:g.call(this,h)},this._p2pConnection.onConnectionStateChange=h=>{var g;return(g=this.onConnectionStateChange)===null||g===void 0?void 0:g.call(this,h)},this._p2pConnection.onDTLSTransportStateChange=h=>{var g;return(g=this.onDTLSTransportStateChange)===null||g===void 0?void 0:g.call(this,h)},this._p2pConnection.onDTLSTransportError=h=>{var g;return(g=this.onDTLSTransportError)===null||g===void 0?void 0:g.call(this,h)},this._p2pConnection.onICETransportStateChange=h=>{var g;return(g=this.onICETransportStateChange)===null||g===void 0?void 0:g.call(this,h)},this._p2pConnection.onFirstAudioReceived=h=>{var g;return(g=this.onFirstAudioReceived)===null||g===void 0?void 0:g.call(this,h)},this._p2pConnection.onFirstVideoReceived=h=>{var g;return(g=this.onFirstVideoReceived)===null||g===void 0?void 0:g.call(this,h)},this._p2pConnection.onFirstAudioDecoded=h=>{var g;return(g=this.onFirstAudioDecoded)===null||g===void 0?void 0:g.call(this,h)},this._p2pConnection.onFirstVideoDecoded=(h,g,j)=>{var _t;return(_t=this.onFirstVideoDecoded)===null||_t===void 0?void 0:_t.call(this,h,g,j)},this._p2pConnection.onFirstVideoDecodedTimeout=h=>{var g;return(g=this.onFirstVideoDecodedTimeout)===null||g===void 0?void 0:g.call(this,h)},this._p2pConnection.onSelectedLocalCandidateChanged=(h,g)=>{var j;return(j=this.onSelectedLocalCandidateChanged)===null||j===void 0?void 0:j.call(this,h,g)},this._p2pConnection.onSelectedRemoteCandidateChanged=(h,g)=>{var j;return(j=this.onSelectedRemoteCandidateChanged)===null||j===void 0?void 0:j.call(this,h,g)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(h){h.onConnectionStateChange=void 0,h.onICEConnectionStateChange=void 0,h.onICETransportStateChange=void 0,h.onDTLSTransportStateChange=void 0,h.onDTLSTransportError=void 0,h.onFirstAudioDecoded=void 0,h.onFirstAudioReceived=void 0,h.onFirstVideoDecoded=void 0,h.onFirstVideoReceived=void 0,h.onSelectedLocalCandidateChanged=void 0,h.onSelectedRemoteCandidateChanged=void 0,h.onFirstVideoDecodedTimeout=void 0}setConfiguration(h){this._p2pConnection.setConfiguration(h)}}).prototype,"connect",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"connect"),RS.prototype),G_(RS.prototype,"receive",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"receive"),RS.prototype),G_(RS.prototype,"stopReceiving",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"stopReceiving"),RS.prototype),G_(RS.prototype,"muteRemote",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"muteRemote"),RS.prototype),G_(RS.prototype,"unmuteRemote",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"unmuteRemote"),RS.prototype),G_(RS.prototype,"muteLocal",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"muteLocal"),RS.prototype),G_(RS.prototype,"unmuteLocal",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"unmuteLocal"),RS.prototype),G_(RS.prototype,"close",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"close"),RS.prototype),G_(RS.prototype,"updateEncoderConfig",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"updateEncoderConfig"),RS.prototype),G_(RS.prototype,"updateSendParameters",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"updateSendParameters"),RS.prototype),G_(RS.prototype,"replaceTrack",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"replaceTrack"),RS.prototype),G_(RS.prototype,"getRemoteSSRC",[LI],Object.getOwnPropertyDescriptor(RS.prototype,"getRemoteSSRC"),RS.prototype),RS);function LI(d,h,g){const j=d[h];if(typeof j!="function")throw new Error("Cannot use mutex on object property.");return g.value=async function(){const _t=this.mutex,_i=await _t.lock("From DataChannelConnection.".concat(h));try{for(var _o=arguments.length,ga=new Array(_o),_a=0;_a<_o;_a++)ga[_a]=arguments[_a];return await j.apply(this,ga)}finally{_i()}},g}var nS;function _q(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function _N(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?_q(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):_q(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}function _z(d){var h,g,j,_t=2;for(typeof Symbol<"u"&&(g=cH,j=Symbol.iterator);_t--;){if(g&&(h=d[g])!=null)return h.call(d);if(j&&(h=d[j])!=null)return new h6(h.call(d));g="@@asyncIterator",j="@@iterator"}throw new TypeError("Object is not async iterable")}function h6(d){function h(g){if(Object(g)!==g)return a0.reject(new TypeError(g+" is not an object."));var j=g.done;return a0.resolve(g.value).then(function(_t){return{value:_t,done:j}})}return(h6=function(g){this.s=g,this.n=g.next}).prototype={s:null,n:null,next:function(){return h(this.n.apply(this.s,arguments))},return:function(g){var j=this.s.return;return j===void 0?a0.resolve({value:g,done:!0}):h(j.apply(this.s,arguments))},throw:function(g){var j=this.s.return;return j===void 0?a0.reject(g):h(j.apply(this.s,arguments))}},new h6(d)}let _ee=(G_((nS=class extends US{get state(){return this._state}set state(d){const h=this._state;this._state=d,this.emit(Y0.StateChange,h,this._state)}constructor(d,h){super(),_h(this,"store",void 0),_h(this,"statsUploader",void 0),_h(this,"connection",void 0),_h(this,"localTrackMap",new Map),_h(this,"remoteUserMap",new Map),_h(this,"pendingLocalTracks",[]),_h(this,"pendingRemoteTracks",[]),_h(this,"statsCollector",void 0),_h(this,"isPlanB",!1),_h(this,"shouldForwardP2PCreation",void 0),_h(this,"iceFailedCount",0),_h(this,"dtlsFailedCount",0),_h(this,"mutex",new lT("P2PChannel-mutex")),_h(this,"_state",vR.Disconnected),_h(this,"_pcStatsUploadType",__("NEW_ICE_RESTART")?QI.FIRST_CONNECTION:QI.OLD_FIRST_CONNECTION),_h(this,"_isInRestartIce",!1),_h(this,"_isStartRestartIce",!1),_h(this,"_restartStates",["disconnected","failed"]),_h(this,"_restartTimer",void 0),_h(this,"_isFirstConnected",!0),_h(this,"handleMuteLocalTrack",async(g,j,_t)=>{const _i=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==vR.Connected)return void _t(new f_(c_.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const _o=this.filterTobeMutedTracks(g);if(_o.length===0)return void j();const ga=_o.find(_u=>_u[0]==="videoLowTrack");ga&&ga[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(_o.map(_u=>{let[,{id:_c}]=_u;return _c}));const _a=this.createMuteMessage(_o);await qS(this,Y0.RequestMuteLocal,_a),j()}catch(_o){_t(_o)}finally{_i()}}),_h(this,"handleUnmuteLocalTrack",async(g,j,_t)=>{const _i=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==vR.Connected)return void _t(new f_(c_.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const _o=this.filterTobeUnmutedTracks(g);if(_o.length===0)return void j();const ga=_o.find(_u=>_u[0]==="videoLowTrack");if(ga){const _u=ga[1];if(_u.track._originMediaStreamTrack.stop(),QS().supportDualStreamEncoding){const _c=g._mediaStreamTrack.clone();_u.track._mediaStreamTrack=_c,_u.track._originMediaStreamTrack=_c}else{const _c=DH(g,s1(this,Y0.RequestLowStreamParameter));_u.track._mediaStreamTrack=_c,_u.track._originMediaStreamTrack=_c}await new a0((_c,_l)=>{this.handleReplaceTrack(_u.track,_c,_l,!0)})}await this.connection.unmuteLocal(_o.map(_u=>{let[,{id:_c}]=_u;return _c}));const _a=this.createUnmuteMessage(_o);await qS(this,Y0.RequestUnmuteLocal,_a),j()}catch(_o){_t(_o)}finally{_i()}}),_h(this,"handleUpdateVideoEncoder",async(g,j,_t)=>{const _i=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const _o=this.localTrackMap.get(l0.LocalVideoTrack);if(!this.connection||!_o||_o.track!==g||this.state!==vR.Connected)return void j();const{id:ga,track:_a}=_o;await this.connection.updateSendParameters(ga,_a),await this.connection.updateEncoderConfig(ga,_a),this.emit(Y0.UpdateVideoEncoder,_a),j()}catch(_o){_t(_o)}finally{_i()}}),_h(this,"handleSetOptimizationMode",async(g,j,_t)=>{const _i=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const _o=this.localTrackMap.get(l0.LocalVideoTrack);if(!this.connection||!_o||_o.track!==g||this.state!==vR.Connected)return;const{id:ga,track:_a}=_o;await this.connection.updateSendParameters(ga,_a),j()}catch(_o){_t(_o)}finally{_i()}}),_h(this,"handleReplaceTrack",async(g,j,_t,_i)=>{let _o;wE.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(g.getTrackId(),"]")),typeof _i=="boolean"&&_i||(_o=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var ga;const _u=Array.from(this.localTrackMap.entries()).find(_c=>{let[,{track:_l}]=_c;return g===_l});if(!this.connection||!_u||this.state!==vR.Connected)return void j();if(await((ga=this.connection)===null||ga===void 0?void 0:ga.replaceTrack(g,_u[1].id)),this.isPlanB){const _c=_u[1];_c.id=g._mediaStreamTrack.id,this.localTrackMap.set(_u[0],_c)}if(_u[0]===l0.LocalVideoTrack&&QS().supportDualStreamEncoding){const _c=this.localTrackMap.get(l0.LocalVideoLowTrack);if(_c){const _l=g._mediaStreamTrack.clone();_c.track._originMediaStreamTrack.stop(),_c.track._mediaStreamTrack=_l,_c.track._originMediaStreamTrack=_l,await new a0((_g,r_)=>{this.handleReplaceTrack(_c.track,_g,r_,!0)})}}j()}catch(_u){_t(_u)}finally{var _a;(_a=_o)===null||_a===void 0||_a()}}),_h(this,"handleGetLocalVideoStats",g=>{g(this.statsCollector.getLocalVideoTrackStats())}),_h(this,"handleGetLocalAudioStats",g=>{g(this.statsCollector.getLocalAudioTrackStats())}),_h(this,"handleGetRemoteVideoStats",g=>this.statsCollector.getRemoteVideoTrackStats(g.uid)[g.uid]),_h(this,"handleGetRemoteAudioStats",g=>this.statsCollector.getRemoteAudioTrackStats(g.uid)[g.uid]),this.store=d,this.statsCollector=h,this.statsCollector.addP2PChannel(this),this.statsUploader=new gee,this.bindStatsUploaderEvents(),this.isPlanB=!QS().supportUnifiedPlan||__("CHROME_FORCE_PLAN_B")&&YN(),this.shouldForwardP2PCreation=__("FORWARD_P2P_CREATION")&&QS().supportPCSetConfiguration,this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new vN({},this.store):this.isPlanB?new kL({},this.store):new WO({},this.store),this.bindConnectionEvents(this.connection))}async startP2PConnection(d,h){var g;this.state=vR.New;const j=this.shouldForwardP2PCreation&&((g=this.connection)===null||g===void 0?void 0:g.peerConnectionState)==="closed";if(this.shouldForwardP2PCreation&&!j||(j&&this.connection&&(wE.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.connection.close(),this.unbindConnectionEvents(this.connection)),this.connection=this.store.useDataChannel?new vN(d,this.store):this.isPlanB?new kL(d,this.store):new WO(d,this.store),this.bindConnectionEvents(this.connection)),!this.connection)throw new f_(c_.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=__("NEW_ICE_RESTART")?QI.FIRST_CONNECTION:QI.OLD_FIRST_CONNECTION,this._isFirstConnected=!0,this._isInRestartIce=!1,this._isStartRestartIce=!1,this.connection.setConfiguration(d),this.connection.establishPromise}async connect(d,h,g,j,_t,_i){if(!this.connection)throw new f_(c_.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.connection instanceof vN?this.connection.updateRemoteConnect(j):(this.store.peerConnectionStart(),await this.connection.connect(d,h,g,j,_t,_i),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=vR.Connected)}async preConnect(d,h,g,j,_t,_i){if(!this.connection)throw new f_(c_.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.store.peerConnectionStart();const _o=await this.connection.connect(d,h,g,j,_t,_i);return this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=vR.Connected,_o}getEstablishParams(){if(this.connection instanceof vN)return this.connection.getP2PConnectionParams();throw new Error("Only DataChannelConnection needs to obtain establishParams")}publish(d,h,g){var j=this;return xI(function*(){const _t=yield $0(j.mutex.lock("From P2PChannel.publish"));try{if(!j.connection||j.state!==vR.Connected){if(j.state===vR.Disconnected)throw new f_(c_.UNEXPECTED_ERROR,"PeerConnection already disconnected.");j.throwIfTrackTypeNotMatch(d);const _o=d.filter(ga=>j.pendingLocalTracks.indexOf(ga)===-1);return void(j.pendingLocalTracks=j.pendingLocalTracks.concat(_o))}j.store.pubId=j.store.pubId+1,hI.markPublishStart(j.store.clientId,j.store.pubId);const _i=j.filterTobePublishedTracks(d,h,g);if(_i.length===0)return void(yield $0(j.tryToUnmuteAudio(d)));yield*YU(_z(j.doPublish(j.connection,_i)),$0)}finally{_t()}})()}doPublish(d,h){var g=this;return xI(function*(){h.forEach(_u=>{let{track:_c,type:_l}=_u;const _g=Date.now();g.store.publish(_c.getTrackId(),_l===l0.LocalAudioTrack?"audio":"video",_g)}),g.bindLocalTrackEvents(h);const j=yield $0(d.send(h.map(_u=>{let{track:_c}=_u;return _c}),g.store.codec,g.store.audioCodec)),_t=(yield $0(j.next())).value,_i=g.createGatewayPublishMessage(h,_t);let _o;try{_o=yield _i}catch(_u){throw j.throw(_u),(_u==null?void 0:_u.code)===c_.WS_ABORT&&h.forEach(_c=>{let{track:_l}=_c;g.pendingLocalTracks.indexOf(_l)===-1&&g.pendingLocalTracks.push(_l)}),g.unbindLocalTrackEvents(h),_u}const ga=g.mapPubResToRemoteConfig(_i,_o),_a=(yield $0(j.next(ga))).value;h.forEach(_u=>{let{type:_c}=_u;g.statsCollector.addLocalStats(_c)}),g.assignLocalTracks(h,_a),g.statsUploader.startUploadUplinkStats(),h.forEach(_u=>{let{track:_c,type:_l}=_u;const _g=Date.now();g.store.publish(_c.getTrackId(),_l===l0.LocalAudioTrack?"audio":"video",void 0,_g)})})()}publishLowStream(d){var h=this;return xI(function*(){if(!h.connection||h.state!==vR.Connected)return;const g=yield $0(h.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const _t=h.localTrackMap.get(l0.LocalVideoTrack);if(!_t)throw new f_(c_.UNEXPECTED_ERROR,"Could not find high stream");if(h.localTrackMap.has(l0.LocalVideoLowTrack))throw new f_(c_.UNEXPECTED_ERROR,"[".concat(h.store.clientId,"] Can't publish low stream when stream already publish"));const _i=[{track:h.getLowVideoTrack(_t.track,d),type:l0.LocalVideoLowTrack}];if(yield*YU(_z(h.doPublish(h.connection,_i)),$0),_t.track.muted||!_t.track.enabled){var j;const _o=(j=h.localTrackMap.get(l0.LocalVideoLowTrack))===null||j===void 0?void 0:j.id;_o!==void 0&&(yield $0(h.connection.muteLocal([_o])))}}finally{g()}})()}async republish(){this.pendingLocalTracks.length>0&&(wE.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await YR(this,Y0.RequestRePublish,this.pendingLocalTracks),this.emit(Y0.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async reSubscribe(d){for(let h=this.pendingRemoteTracks.length-1;h>=0;h--){const{user:g,kind:j}=this.pendingRemoteTracks[h];(j!==L0.AUDIO||g._audio_added_&&g._audioSSRC)&&(j!==L0.VIDEO||g._video_added_&&g._videoSSRC)||this.pendingRemoteTracks.splice(h,1)}if(d)await YR(this,Y0.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:h,kind:g}of this.pendingRemoteTracks)await this.subscribe(h,g,g===L0.VIDEO?h._videoSSRC:h._audioSSRC);this.pendingRemoteTracks.forEach(h=>{let{user:g}=h;this.emit(Y0.MediaReconnectEnd,g.uid)}),this.pendingRemoteTracks=[]}async unpublish(d){if(!this.connection||this.state!==vR.Connected)return void d.forEach(j=>{const _t=this.pendingLocalTracks.indexOf(j);_t!==-1&&this.pendingLocalTracks.splice(_t,1)});const h=this.filterTobeUnpublishedTracks(d);if(h.length===0)return;const g=h.find(j=>j[0]==="videoLowTrack");return g&&g[1].track.close(),this.doUnpublish(this.connection,h)}async unpublishLowStream(){if(!this.connection||this.state!==vR.Connected)return;const d=this.localTrackMap.get(l0.LocalVideoLowTrack);if(!d)return;d.track.close();const h=[[l0.LocalVideoLowTrack,d]];return this.doUnpublish(this.connection,h)}async doUnpublish(d,h){const g=this.createGatewayUnpublishMessage(h);return await d.stopSending(h.map(j=>{let[,{id:_t}]=j;return _t})),this.withdrawLocalTracks(h),this.unbindLocalTrackEvents(h.map(j=>{let[_t,{track:_i}]=j;return{type:_t,track:_i}})),h.forEach(j=>{let[_t]=j;this.statsCollector.removeLocalStats(_t)}),this.localTrackMap.size===0&&this.statsUploader.stopUploadUplinkStats(),g}async subscribe(d,h,g,j,_t){var _i;if(!this.connection||this.state!==vR.Connected)throw new f_(c_.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if((_i=this.remoteUserMap.get(d))!==null&&_i!==void 0&&_i.has(h))return;let _o,ga,_a;if(_t){const _l=_t.find(r_=>{let{stream_type:l_}=r_;return l_===h});if(!_l)throw new f_(c_.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(h," for user: ").concat(d.uid," because subscribe answer from gateway does not contain stream_type: ").concat(h,"."));const _g=await this.connection.receive(h,_l.ssrcs,String(d._uintid),_l.attributes);this.connection instanceof WO&&(_a=_g.transceiver),_o=_g.track,ga=_g.id}else{const _l=await this.connection.receive(h,[{ssrcId:g,rtx:j}],String(d._uintid),void 0);this.connection instanceof WO&&(_a=_l.transceiver),_o=_l.track,ga=_l.id}h===L0.AUDIO?(d._audioTrack?d._audioTrack._updateOriginMediaStreamTrack(_o):(d._audioTrack=new _F(_o,d.uid,d._uintid,this.store),wE.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(d._audioTrack.getTrackId()))),_a&&d._audioTrack._updateRtpTransceiver(_a),this.bindRemoteTrackEvents(d,d._audioTrack)):(d._videoTrack?d._videoTrack._updateOriginMediaStreamTrack(_o):(d._videoTrack=new EF(_o,d.uid,d._uintid,this.store),wE.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(d._videoTrack.getTrackId()))),_a&&d._videoTrack._updateRtpTransceiver(_a),this.bindRemoteTrackEvents(d,d._videoTrack));const _u=this.remoteUserMap.get(d);_u?_u.set(h,ga):this.remoteUserMap.set(d,new Map([[h,ga]])),this.statsCollector.addRemoteStats(d.uid),this.statsUploader.startUploadDownlinkStats();const _c=this.pendingRemoteTracks.findIndex(_l=>{let{user:_g,kind:r_}=_l;return _g.uid===d.uid&&h===r_});_c!==-1&&(this.pendingRemoteTracks.splice(_c,1),this.emit(Y0.MediaReconnectEnd,d.uid))}async massSubscribe(d){return this.massSubscribeNoLock(d)}async massSubscribeNoLock(d){if(!this.connection||this.state!==vR.Connected)throw new f_(c_.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");d=d.filter(g=>{var j;let{user:_t,mediaType:_i}=g;return!((j=this.remoteUserMap.get(_t))!==null&&j!==void 0&&j.has(_i))});const h=await this.connection.batchReceive(d.map(g=>{let{user:j,mediaType:_t,ssrcId:_i,rtxSsrcId:_o}=g;return{kind:_t,ssrcMsg:[{ssrcId:_i,rtx:_o}],mslabel:String(j._uintid)}}));d.forEach((g,j)=>{let{user:_t,mediaType:_i}=g;const{track:_o,id:ga,transceiver:_a}=h[j];_i===L0.AUDIO?(_t._audioTrack?_t._audioTrack._updateOriginMediaStreamTrack(_o):(_t._audioTrack=new _F(_o,_t.uid,_t._uintid,this.store),wE.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(_t._audioTrack.getTrackId()))),_a&&_t._audioTrack._updateRtpTransceiver(_a),this.bindRemoteTrackEvents(_t,_t._audioTrack)):(_t._videoTrack?_t._videoTrack._updateOriginMediaStreamTrack(_o):(_t._videoTrack=new EF(_o,_t.uid,_t._uintid,this.store),wE.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(_t._videoTrack.getTrackId()))),_a&&_t._videoTrack._updateRtpTransceiver(_a),this.bindRemoteTrackEvents(_t,_t._videoTrack));const _u=this.remoteUserMap.get(_t);_u?_u.set(_i,ga):this.remoteUserMap.set(_t,new Map([[_i,ga]])),this.statsCollector.addRemoteStats(_t.uid),this.statsUploader.startUploadDownlinkStats();const _c=this.pendingRemoteTracks.findIndex(_l=>{let{user:_g,kind:r_}=_l;return _g.uid===_t.uid&&_i===r_});_c!==-1&&(this.pendingRemoteTracks.splice(_c,1),this.emit(Y0.MediaReconnectEnd,_t.uid))})}async unsubscribe(d,h,g){const j=this.pendingRemoteTracks.filter(_o=>{let{user:ga,kind:_a}=_o;return h!==void 0?ga.uid===d.uid&&h===_a:ga.uid===d.uid});if(j.forEach(_o=>{const ga=this.pendingRemoteTracks.indexOf(_o);this.pendingRemoteTracks.splice(ga,1)}),this.connection&&this.state===vR.Connected||g||j.forEach(_o=>{let{kind:ga}=_o;var _a;if(ga===L0.AUDIO)(_a=d._audioTrack)===null||_a===void 0||_a._destroy(),d._audioTrack=void 0;else if(ga===L0.VIDEO){var _u;(_u=d._videoTrack)===null||_u===void 0||_u._destroy(),d._videoTrack=void 0}}),!this.connection||this.state!==vR.Connected)return;const _t=this.filterTobeUnSubscribedTracks(d,h);if(_t.length===0)return;await this.connection.stopReceiving(_t.map(_o=>{let[,{id:ga}]=_o;return ga}));const _i=this.createUnsubscribeMessage(_t);return this.withdrawRemoteTracks(_t),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),_t.forEach(_o=>{let[ga,{kind:_a}]=_o;var _u,_c;if(_a===L0.VIDEO&&ga._videoSSRC&&((_u=this.connection)===null||_u===void 0||_u.setStatsRemoteVideoIsReady(ga._videoSSRC,!1)),_a===L0.VIDEO)this.unbindRemoteTrackEvents(ga._videoTrack),g||((_c=ga._videoTrack)===null||_c===void 0||_c._destroy(),ga._videoTrack=void 0);else if(_a===L0.AUDIO){var _l;this.unbindRemoteTrackEvents(ga._audioTrack),!g&&((_l=ga._audioTrack)===null||_l===void 0||_l._destroy(),ga._audioTrack=void 0)}}),_i}async massUnsubscribe(d){return this.massUnsubscribeNoLock(d)}async massUnsubscribeNoLock(d){let h=[];for(const{user:_t,mediaType:_i}of d){const _o=this.pendingRemoteTracks.filter(ga=>{let{user:_a,kind:_u}=ga;return _i!==void 0?_a.uid===_t.uid&&_i===_u:_a.uid===_t.uid});_o.forEach(ga=>{const _a=this.pendingRemoteTracks.indexOf(ga);this.pendingRemoteTracks.splice(_a,1)}),h=h.concat(_o)}if(!this.connection||this.state!==vR.Connected)return void h.forEach(_t=>{let{user:_i,kind:_o}=_t;var ga;if(_o===L0.AUDIO)(ga=_i._audioTrack)===null||ga===void 0||ga._destroy(),_i._audioTrack=void 0;else if(_o===L0.VIDEO){var _a;(_a=_i._videoTrack)===null||_a===void 0||_a._destroy(),_i._videoTrack=void 0}});const g=WI(d).call(d,(_t,_i)=>{let{user:_o,mediaType:ga}=_i;const _a=this.filterTobeUnSubscribedTracks(_o,ga);return _t.concat(_a)},[]);if(g.length===0)return;await this.connection.stopReceiving(g.map(_t=>{let[,{id:_i}]=_t;return _i}));const j=this.createUnsubscribeAllMessage(g);return this.withdrawRemoteTracks(g),this.remoteUserMap.size===0&&this.statsUploader.stopUploadDownlinkStats(),g.forEach(_t=>{let[_i,{kind:_o}]=_t;var ga,_a;if(_o===L0.VIDEO&&_i._videoSSRC&&((ga=this.connection)===null||ga===void 0||ga.setStatsRemoteVideoIsReady(_i._videoSSRC,!1)),_o===L0.VIDEO)this.unbindRemoteTrackEvents(_i._videoTrack),(_a=_i._videoTrack)===null||_a===void 0||_a._destroy(),_i._videoTrack=void 0;else if(_o===L0.AUDIO){var _u;this.unbindRemoteTrackEvents(_i._audioTrack),(_u=_i._audioTrack)===null||_u===void 0||_u._destroy(),_i._audioTrack=void 0}}),j}async muteRemote(d,h){if(!this.connection)return;const g=this.remoteUserMap.get(d);if(!g)return void wE.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(d.uid,"."));if(!g.get(h))return void wE.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(d.uid," media type ").concat(h,"."));const j=h===L0.VIDEO?d._videoSSRC:d._audioSSRC;j!==void 0&&this.connection.setStatsRemoteVideoIsReady(j,!1)}async unmuteRemote(d,h){return this.unmuteRemoteNoLock(d,h)}async unmuteRemoteNoLock(d,h){if(!this.connection)return;const g=this.remoteUserMap.get(d);if(!g)return void wE.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(d.uid,"."));g.get(h)||wE.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(d.uid," media type ").concat(h,"."))}getAllTracks(d){const h=this.localTrackMap.get(l0.LocalAudioTrack);if((h==null?void 0:h.track)instanceof IT){const g=h.track;return Array.from(this.localTrackMap.entries()).filter(j=>{let[_t]=j;return _t!==l0.LocalAudioTrack}).filter(j=>{let[_t]=j;return!(d&&_t===l0.LocalVideoLowTrack)}).map(j=>{let[,{track:_t}]=j;return _t}).concat(g.trackList)}return Array.from(this.localTrackMap.entries()).filter(g=>{let[j]=g;return!(d&&j===l0.LocalVideoLowTrack)}).map(g=>{let[,{track:j}]=g;return j})}reportPublishEvent(d,h,g,j,_t){if(d){const _o=this.localTrackMap.get(l0.LocalAudioTrack),ga=j?this.localTrackMap.get(l0.LocalVideoLowTrack):this.localTrackMap.get(l0.LocalVideoTrack);p0.publish(this.store.sessionId,{eventElapse:hI.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:d,ec:h,audioName:_o==null?void 0:_o.track.getTrackLabel(),videoName:ga==null?void 0:ga.track.getTrackLabel(),screenshare:(ga==null?void 0:ga.track._hints.indexOf(ER.SCREEN_TRACK))!==-1,audio:!!_o,video:!!ga,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:_t})}else{var _i;g||(g=[]);const _o=g.find(_a=>_a instanceof zR),ga=j?(_i=this.localTrackMap.get(l0.LocalVideoTrack))===null||_i===void 0?void 0:_i.track:g.find(_a=>_a instanceof cR);p0.publish(this.store.sessionId,{eventElapse:hI.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:d,ec:h,audioName:_o==null?void 0:_o.getTrackLabel(),videoName:ga==null?void 0:ga.getTrackLabel(),screenshare:(ga==null?void 0:ga._hints.indexOf(ER.SCREEN_TRACK))!==-1,audio:!!_o,video:!!ga,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:_t})}}reportSubscribeEvent(d,h,g,j){const _t=j===L0.VIDEO?g._videoSSRC:g._audioSSRC;_t&&p0.subscribe(this.store.sessionId,{succ:d,ec:h,video:j===L0.VIDEO,audio:j===L0.AUDIO,peerid:g.uid,subscribeRequestid:j===L0.VIDEO?g._videoSSRC:g._audioSSRC,p2pid:this.store.p2pId,eventElapse:hI.measureFromSubscribeStart(this.store.clientId,_t)})}reset(){wE.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new lT("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new vN({},this.store):this.isPlanB?new kL({},this.store):new WO({},this.store),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const d=this.localTrackMap.get(l0.LocalAudioTrack);if((d==null?void 0:d.track)instanceof IT){if(d.track.trackList.length>0){const h=d.track;d.track.trackList.forEach(g=>{h.removeAudioTrack(g)})}d.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.state=vR.Disconnected}getStats(){var d;return(d=this.connection)===null||d===void 0?void 0:d.getStats()}getRemoteVideoIsReady(d){var h;return((h=this.connection)===null||h===void 0?void 0:h.getRemoteVideoIsReady(d))||!1}getLocalAudioVolume(){const d=this.localTrackMap.get(l0.LocalAudioTrack);if(d)return d.track.getVolumeLevel()}getLocalVideoSize(){const d=this.localTrackMap.get(l0.LocalVideoTrack);if(d)return{width:d.track._videoWidth||0,height:d.track._videoHeight||0}}getEncoderConfig(d){const h=this.localTrackMap.get(d);return h&&h.track instanceof cR||h&&h.track instanceof zR?h.track._encoderConfig:void 0}getLocalMedia(d){return this.localTrackMap.get(d)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(d,h){if(!d)return this.remoteUserMap.size>0;const g=this.remoteUserMap.get(d);return!!g&&(!h||g.has(h))}async hasRemoteMediaWithLock(d,h){if(!d)return this.remoteUserMap.size>0;const g=this.remoteUserMap.get(d);return!!g&&(!h||g.has(h))}getRemoteMedia(d){var h;const g=Array.from(n1(h=this.remoteUserMap).call(h)).find(j=>j.uid===d);return g?{audioTrack:g.audioTrack,audioSSRC:g._audioSSRC,videoTrack:g.videoTrack,videoSSRC:g._videoSSRC}:{}}getAudioLevels(){let d=Array.from(this.remoteUserMap.entries()).map(g=>{let[j]=g;return{uid:j.uid,level:j.audioTrack?100*j.audioTrack._source.getAccurateVolumeLevel():0}});const h=this.localTrackMap.get(l0.LocalAudioTrack);return h&&d.push({level:100*h.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),d=Q3(d).call(d,(g,j)=>g.level-j.level),d}async disconnectForReconnect(){this.connection&&(wE.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=vR.Reconnecting,__("KEEP_LAST_FRAME")&&this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(d=>{let[h]=d;var g;h._videoTrack&&h._videoTrack._player&&((g=h._videoTrack._player.getVideoElement())===null||g===void 0||g.pause(),h._videoTrack._player.isKeepLastFrame=!0,h._videoTrack._originMediaStreamTrack.stop())}),this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new vN({},this.store):this.isPlanB?new kL({},this.store):new WO({},this.store),this.bindConnectionEvents(this.connection)),this.localTrackMap.size!==0&&(Array.from(this.localTrackMap.entries()).forEach(d=>{let[h,{track:g}]=d;switch(h){case l0.LocalVideoTrack:g._hints.includes(ER.LOW_STREAM)?g.close():this.pendingLocalTracks.push(g);break;case l0.LocalAudioTrack:g instanceof IT?this.pendingLocalTracks=this.pendingLocalTracks.concat(g.trackList):this.pendingLocalTracks.push(g);break;case l0.LocalVideoLowTrack:}}),this.emit(Y0.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.size!==0&&Array.from(this.remoteUserMap.entries()).forEach(d=>{let[h,g]=d;Array.from(n1(g).call(g)).forEach(j=>{this.setPendingRemoteMedia(h,j)}),this.emit(Y0.MediaReconnectStart,h.uid)}),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),wE.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(d,h){for(const g of this.pendingRemoteTracks){const{user:j,kind:_t}=g;if((d instanceof F5?d.uid:d)===j.uid&&h===_t)return!0}return!1}setPendingRemoteMedia(d,h){this.hasPendingRemoteMedia(d,h)||this.pendingRemoteTracks.push({user:d,kind:h})}restartICE(d){var h=this;return xI(function*(){if(!h.connection||h.state!==vR.Connected||h.connection instanceof vN)return;const g=yield $0(h.mutex.lock("From P2PChannel.restartICE"));let j;try{j=yield $0(h.connection.restartICE(d));const _i=yield $0(j.next());if(_i.done)return;const _o=_i.value,ga=yield _o;switch(h.reportPCDisconnectedOrFailed(d),d){case DR.TCP:h._pcStatsUploadType=QI.TCP_RESTART;break;case DR.RELAY:h._pcStatsUploadType=QI.RELAY_RESTART;break;default:h._pcStatsUploadType=QI.OLD_RESTART}h._isInRestartIce=!0,j.next(ga)}catch(_i){var _t;(_t=j)===null||_t===void 0||_t.throw(_i)}finally{g()}})()}getUplinkNetworkQuality(){if(!this.connection)return 0;const d=this.connection.getStats(),h=this.localTrackMap.get(l0.LocalVideoTrack),g=this.localTrackMap.get(l0.LocalAudioTrack),j=d.videoSend.find(r_=>r_.ssrc===(h==null?void 0:h.ssrcs[0].ssrcId)),_t=d.audioSend.find(r_=>r_.ssrc===(g==null?void 0:g.ssrcs[0].ssrcId));if(!j||!_t)return 1;const _i=PI(this,Y0.NeedSignalRTT),_o=j?j.rttMs:void 0,ga=_t?_t.rttMs:void 0,_a=_o&&ga?(_o+ga)/2:_o||ga,_u=(_a&&_i?(_a+_i)/2:_a||_i)||0,_c=100*d.sendPacketLossRate*.7/50+.3*_u/1500,_l=_c<.17?1:_c<.36?2:_c<.59?3:_c<.1?4:5,_g=h==null?void 0:h.track;if(_g&&_g._encoderConfig&&_g._hints.indexOf(ER.SCREEN_TRACK)===-1){const r_=_g._encoderConfig.bitrateMax,l_=d.bitrate.actualEncoded;if(r_&&l_){const d_=(1e3*r_-l_)/(1e3*r_);return YJ[d_<.15?0:d_<.3?1:d_<.45?2:d_<.6?3:4][_l]}}return _l}getDownlinkNetworkQuality(){if(!this.connection)return 0;const d=this.connection.getStats();let h=0;return Array.from(this.remoteUserMap.entries()).forEach(g=>{let[j]=g;const _t=j._audioSSRC,_i=j._videoSSRC,_o=d.audioRecv.find(l_=>l_.ssrc===_t),ga=d.videoRecv.find(l_=>l_.ssrc===_i);if(!_o&&!ga)return void(h+=1);const _a=PI(this,Y0.NeedSignalRTT),_u=d.rtt,_c=(_u&&_a?(_u+_a)/2:_u||_a)||0,_l=_o?_o.jitterMs:void 0,_g=d.recvPacketLossRate;let r_=.7*_g*100/50+.3*_c/1500;_l&&(r_=.6*_g*100/50+.2*_c/1500+.2*_l/400),h+=r_<.1?1:r_<.17?2:r_<.36?3:r_<.59?4:5}),this.remoteUserMap.size>0?Math.round(h/this.remoteUserMap.size):h}async muteLocalTrack(d){return new a0((h,g)=>{this.handleMuteLocalTrack(d,h,g)})}filterTobePublishedTracks(d,h,g){const j=[],_t=QS(),_i=this.getAllTracks();d=dW(d=d.filter(_a=>_i.indexOf(_a)===-1));let _o=!1,ga=!1;for(const _a of d){if(_a instanceof cR&&(this.localTrackMap.has(l0.LocalVideoTrack)||_o?new f_(c_.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(j.push({track:_a,type:l0.LocalVideoTrack}),_o=!0),h)){const _u=this.getLowVideoTrack(_a,g);j.push({track:_u,type:l0.LocalVideoLowTrack})}if(_a instanceof zR){const _u=this.localTrackMap.get(l0.LocalAudioTrack);if(_u){if(!(_u.track instanceof IT))throw new f_(c_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_a._bypassWebAudio)throw new f_(c_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");_u.track.addAudioTrack(_a),this.bindLocalAudioTrackEvents(_a,!0)}else if(ga){const _c=j.find(_l=>{let{type:_g}=_l;return _g===l0.LocalAudioTrack});if(!(_c.track instanceof IT))throw new f_(c_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(_a._bypassWebAudio)throw new f_(c_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");_c.track.addAudioTrack(_a)}else{if(!_t.webAudioMediaStreamDest||_a instanceof IT||_a._bypassWebAudio)j.push({track:_a,type:l0.LocalAudioTrack});else{const _c=new IT;_c.addAudioTrack(_a),j.push({track:_c,type:l0.LocalAudioTrack})}ga=!0}}}return j}filterTobeUnpublishedTracks(d){const h=[],g=this.getAllTracks();d=dW(d=d.filter(j=>g.indexOf(j)!==-1));for(const j of d){if(j instanceof zR){const _t=this.localTrackMap.get(l0.LocalAudioTrack);if(!_t)continue;_t.track instanceof IT?(_t.track.removeAudioTrack(j),this.unbindLocalAudioTrackEvents(j),_t.track.trackList.length===0&&(h.push([l0.LocalAudioTrack,_t]),_t.track.close())):h.push([l0.LocalAudioTrack,_t])}if(j instanceof cR){const _t=this.localTrackMap.get(l0.LocalVideoTrack);if(!_t)continue;h.push([l0.LocalVideoTrack,_t]);const _i=this.localTrackMap.get(l0.LocalVideoLowTrack);_i&&h.push([l0.LocalVideoLowTrack,_i])}}return h}bindLocalTrackEvents(d){d.forEach(h=>{let{track:g,type:j}=h;switch(j){case l0.LocalVideoTrack:g.addListener(I0.GET_STATS,this.handleGetLocalVideoStats),g.addListener(I0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),g.addListener(I0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),g.addListener(I0.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),g.addListener(I0.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),g.addListener(I0.NEED_REPLACE_TRACK,this.handleReplaceTrack),g.addListener(I0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),g.addListener(I0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case l0.LocalAudioTrack:this.bindLocalAudioTrackEvents(g);break;case l0.LocalVideoLowTrack:}})}bindLocalAudioTrackEvents(d,h){d instanceof IT?d.trackList.forEach(g=>{g.addListener(I0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),g.addListener(I0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),g.addListener(I0.GET_STATS,this.handleGetLocalAudioStats),g.addListener(I0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),g.addListener(I0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(d.addListener(I0.GET_STATS,this.handleGetLocalAudioStats),d.addListener(I0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),d.addListener(I0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),d.addListener(I0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),d.addListener(I0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),h||d.addListener(I0.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(d){d||(d=Array.from(this.localTrackMap.entries()).map(h=>{let[g,{track:j}]=h;return{track:j,type:g}})),d.forEach(h=>{let{track:g,type:j}=h;switch(j){case l0.LocalVideoTrack:g.off(I0.GET_STATS,this.handleGetLocalVideoStats),g.off(I0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),g.off(I0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),g.off(I0.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),g.off(I0.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),g.off(I0.NEED_REPLACE_TRACK,this.handleReplaceTrack),g.off(I0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),g.off(I0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case l0.LocalAudioTrack:this.unbindLocalAudioTrackEvents(g);break;case l0.LocalVideoLowTrack:}})}unbindLocalAudioTrackEvents(d){d instanceof IT?d.trackList.forEach(h=>{h.off(I0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),h.off(I0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),h.off(I0.GET_STATS,this.handleGetLocalAudioStats),h.off(I0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),h.off(I0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)}):(d.off(I0.GET_STATS,this.handleGetLocalAudioStats),d.off(I0.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),d.off(I0.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),d.off(I0.NEED_REPLACE_TRACK,this.handleReplaceTrack),d.off(I0.NEED_MUTE_TRACK,this.handleMuteLocalTrack),d.off(I0.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(d,h){h instanceof EF&&h.addListener(I0.GET_STATS,g=>{g(this.handleGetRemoteVideoStats(d))}),h instanceof _F&&h.addListener(I0.GET_STATS,g=>{g(this.handleGetRemoteAudioStats(d))})}unbindRemoteTrackEvents(d){d&&d.removeAllListeners(I0.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach(d=>{let[h,g]=d;g.has(L0.AUDIO)&&this.unbindRemoteTrackEvents(h._audioTrack),g.has(L0.VIDEO)&&this.unbindRemoteTrackEvents(h._videoTrack)})}createGatewayPublishMessage(d,h){return d.map((g,j)=>{let _t,_i,{track:_o,type:ga}=g;switch(ga){case l0.LocalAudioTrack:_t=hR.Audio,_i={dtx:_o instanceof DU&&_o._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case l0.LocalVideoTrack:_t=_o._hints.includes(ER.SCREEN_TRACK)?hR.Screen:hR.High,_i=_N(_N({},aW(_o)),{},{codec:this.store.codec});break;case l0.LocalVideoLowTrack:_t=hR.Low,_i=_N(_N({},aW(_o)),{},{codec:this.store.codec})}return{stream_type:_t,attributes:_i,ssrcs:h[j]}})}createGatewayUnpublishMessage(d){return d.map(h=>{let g,[j,{track:_t,ssrcs:_i,id:_o}]=h;switch(j){case l0.LocalVideoTrack:g=_t._hints.includes(ER.SCREEN_TRACK)?hR.Screen:hR.High;break;case l0.LocalAudioTrack:g=hR.Audio;break;case l0.LocalVideoLowTrack:g=hR.Low}return{stream_type:g,ssrcs:_i,mid:_o}})}assignLocalTracks(d,h){d.forEach((g,j)=>{let{track:_t,type:_i}=g;this.localTrackMap.set(_i,{track:_t,id:h[j].id,ssrcs:h[j].localSSRC})})}withdrawLocalTracks(d){d.forEach(h=>{let[g]=h;this.localTrackMap.delete(g)})}bindConnectionEvents(d){d.onConnectionStateChange=async h=>{if(wE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(h,")")),this.emit(Y0.PeerConnectionStateChange,h),h!=="connected"||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),h==="connected"&&(this._restartTimer&&(clearTimeout(this._restartTimer),this._restartTimer=void 0),(this._isFirstConnected||this._isInRestartIce)&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isInRestartIce=!1,this._isFirstConnected=!1,this._isStartRestartIce=!1),__("NEW_ICE_RESTART")){if(this._restartStates.includes(h)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const g=_i=>{(d.iceConnectionState==="disconnected"||d.iceConnectionState==="checking"||d.iceConnectionState==="failed")&&(wE.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE, type is ").concat(_i)),PI(this,Y0.QueryClientConnectionState)==="CONNECTED"&&this.emit(Y0.RequestRestartICE,_i))},j=()=>{d.iceConnectionState!=="disconnected"&&d.iceConnectionState!=="checking"&&d.iceConnectionState!=="failed"||(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),wE.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout(()=>this.emit(Y0.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},_t=__("ICE_RESTART_INTERVAL");return void(this._restartTimer=window.setTimeout(()=>{if(__("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&QS().supportPCSetConfiguration)g(DR.RELAY),this._restartTimer=window.setTimeout(j,_t);else if(GS())g(DR.UDP),this._restartTimer=window.setTimeout(j,4e3);else{if(g(DR.TCP),QS().supportPCSetConfiguration)return void(this._restartTimer=window.setTimeout(()=>{g(DR.RELAY),this._restartTimer=window.setTimeout(j,_t)},_t));this._restartTimer=window.setTimeout(j,_t)}},800))}}else{if(h==="disconnected"&&d.iceConnectionState==="disconnected")return setTimeout(()=>{d.iceConnectionState==="disconnected"&&__("ICE_RESTART")&&PI(this,Y0.QueryClientConnectionState)==="CONNECTED"&&this.emit(Y0.RequestRestartICE)},800),void setTimeout(()=>{d.peerConnectionState==="disconnected"&&(wE.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isInRestartIce=!1,setTimeout(()=>this.emit(Y0.P2PLost),0),this.iceFailedCount+=1,this.requestReconnect())},4e3);h==="failed"&&(wE.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCDisconnectedOrFailed(),setTimeout(()=>this.emit(Y0.P2PLost),0),this.iceFailedCount+=1,await this.requestReconnect())}},d.onICEConnectionStateChange=h=>{h!=="connected"||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),wE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(h,")")),p0.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:h,tag:kS.TRACER}).onSuccess(),this.emit(Y0.IceConnectionStateChange,h)},d.onICETransportStateChange=h=>{wE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(h,")"))},d.onDTLSTransportStateChange=h=>{wE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(h,")"))},d.onDTLSTransportError=h=>{wE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(h,")"))},d.onFirstAudioDecoded=h=>{var g;const j=Array.from(n1(g=this.remoteUserMap).call(g)).find(_i=>_i._audioSSRC===h);var _t;j&&(this.store.subscribe(j.uid,"audio",void 0,void 0,void 0,Date.now()),(_t=j.audioTrack)===null||_t===void 0||_t.emit(_k.FIRST_FRAME_DECODED),p0.firstRemoteFrame(this.store.sessionId,xR.FIRST_AUDIO_DECODE,FS.FIRST_AUDIO_DECODE,{peer:j._uintid,subscribeElapse:hI.measureFromSubscribeStart(this.store.clientId,h),subscribeRequestid:h,p2pid:this.store.p2pId}))},d.onFirstAudioReceived=h=>{var g;const j=Array.from(n1(g=this.remoteUserMap).call(g)).find(_t=>_t._audioSSRC===h);j&&p0.firstRemoteFrame(this.store.sessionId,xR.FIRST_AUDIO_RECEIVED,FS.FIRST_AUDIO_RECEIVED,{peer:j._uintid,subscribeElapse:hI.measureFromSubscribeStart(this.store.clientId,h),subscribeRequestid:h,p2pid:this.store.p2pId})},d.onFirstVideoDecoded=(h,g,j)=>{this.reportVideoFirstFrameDecoded(h,g,j)},d.onFirstVideoReceived=h=>{var g;const j=Array.from(n1(g=this.remoteUserMap).call(g)).find(_t=>_t._videoSSRC===h);j&&p0.firstRemoteFrame(this.store.sessionId,xR.FIRST_VIDEO_RECEIVED,FS.FIRST_VIDEO_RECEIVED,{peer:j._uintid,subscribeElapse:hI.measureFromSubscribeStart(this.store.clientId,h),subscribeRequestid:h,p2pid:this.store.p2pId})},d.onSelectedLocalCandidateChanged=(h,g)=>{const j=h.candidateType==="relay",_t=g.candidateType==="relay";g.candidateType!=="unknown"&&j===_t||this.emit(Y0.ConnectionTypeChange,j),wE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(jU(g))," -> ").concat(JSON.stringify(jU(h)),")"))},d.onSelectedRemoteCandidateChanged=(h,g)=>{wE.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(jU(g))," -> ").concat(JSON.stringify(jU(h)),")"))},d.onFirstVideoDecodedTimeout=h=>{this.reportVideoFirstFrameDecoded(h,void 0,void 0,!0)}}unbindConnectionEvents(d){d.onConnectionStateChange=void 0,d.onICEConnectionStateChange=void 0,d.onICETransportStateChange=void 0,d.onDTLSTransportStateChange=void 0,d.onDTLSTransportError=void 0,d.onFirstAudioDecoded=void 0,d.onFirstAudioReceived=void 0,d.onFirstVideoDecoded=void 0,d.onFirstVideoReceived=void 0,d.onSelectedLocalCandidateChanged=void 0,d.onSelectedRemoteCandidateChanged=void 0,d.onFirstVideoDecodedTimeout=void 0}filterTobeMutedTracks(d){const h=[];if(this.getAllTracks().indexOf(d)===-1)return h;const g=this.localTrackMap.get(l0.LocalAudioTrack);if(d instanceof zR&&(g==null?void 0:g.track)instanceof IT)return g.track.isActive||h.push([l0.LocalAudioTrack,g]),h;const j=Array.from(this.localTrackMap.entries()).find(_t=>{let[,{track:_i}]=_t;return d===_i});if(j&&(h.push(j),j[0]===l0.LocalVideoTrack)){const _t=this.localTrackMap.get(l0.LocalVideoLowTrack);_t&&h.push([l0.LocalVideoLowTrack,_t])}return h}filterTobeUnmutedTracks(d){const h=[],g=this.localTrackMap.get(l0.LocalAudioTrack);if(d instanceof zR&&(g==null?void 0:g.track)instanceof IT)return g.track.isActive&&h.push([l0.LocalAudioTrack,g]),h;const j=Array.from(this.localTrackMap.entries()).find(_t=>{let[,{track:_i}]=_t;return d===_i});if(j)if(j[0]===l0.LocalVideoTrack){h.push(j);const _t=this.localTrackMap.get(l0.LocalVideoLowTrack);_t&&h.push([l0.LocalVideoLowTrack,_t])}else h.push(j);return h}createMuteMessage(d){return d.map(h=>{let g,[j,{track:_t,ssrcs:_i,id:_o}]=h;switch(j){case l0.LocalAudioTrack:g=hR.Audio;break;case l0.LocalVideoTrack:g=_t._hints.includes(ER.SCREEN_TRACK)?hR.Screen:hR.High;break;case l0.LocalVideoLowTrack:g=hR.Low}return{stream_type:g,ssrcs:_i,mid:_o}})}createUnmuteMessage(d){return d.map(h=>{let g,[j,{track:_t,ssrcs:_i,id:_o}]=h;switch(j){case l0.LocalAudioTrack:g=hR.Audio;break;case l0.LocalVideoTrack:g=_t._hints.includes(ER.SCREEN_TRACK)?hR.Screen:hR.High;break;case l0.LocalVideoLowTrack:g=hR.Low}return{stream_type:g,ssrcs:_i,mid:_o}})}filterTobeUnSubscribedTracks(d,h){const g=[],j=this.remoteUserMap.get(d);if(!j)return g;if(h){const _t=j.get(h);if(!_t)return g;g.push([d,{kind:h,id:_t}])}else Array.from(j.entries()).forEach(_t=>{let[_i,_o]=_t;g.push([d,{kind:_i,id:_o}])});return g}createUnsubscribeMessage(d){const h=[];return d.forEach(g=>{let[j,{kind:_t,id:_i}]=g;switch(_t){case L0.VIDEO:return void(j._videoSSRC&&h.push({stream_type:L0.VIDEO,ssrcId:j._videoSSRC}));case L0.AUDIO:return void(j._audioSSRC&&h.push({stream_type:L0.AUDIO,ssrcId:j._audioSSRC}))}}),h}createUnsubscribeAllMessage(d){const h=new Map;return d.forEach(g=>{let[j,{kind:_t}]=g;if(h.has(j)){let _i=h.get(j);_t===L0.VIDEO?_i|=oR.Video:_i|=oR.Audio,h.set(j,_i)}else _t===L0.VIDEO?h.set(j,oR.Video):h.set(j,oR.Audio)}),{users:Array.from(h.entries()).map(g=>{let[j,_t]=g;return{stream_id:j.uid,stream_type:_t}})}}withdrawRemoteTracks(d){d.forEach(h=>{let[g,{kind:j}]=h;const _t=this.remoteUserMap.get(g);_t&&(_t.delete(j),Array.from(_t.entries()).length===0&&this.remoteUserMap.delete(g))})}async updateBitrateLimit(d){const h=this.localTrackMap.get(l0.LocalVideoTrack),g=this.localTrackMap.get(l0.LocalVideoLowTrack);h&&await h.track.setBitrateLimit(d.uplink),g&&d.low_stream_uplink&&await g.track.setBitrateLimit({max_bitrate:d.low_stream_uplink.bitrate,min_bitrate:d.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return this.connection?this.connection.peerConnectionState!=="connected":!0}mapPubResToRemoteConfig(d,h){return d.map((g,j)=>{var _t;let{stream_type:_i}=g;return(_t=h.find(_o=>{let{stream_type:ga}=_o;return _i===ga}))===null||_t===void 0?void 0:_t.attributes})}async tryToUnmuteAudio(d){for(let g=0;g<d.length;g++)if(d[g]instanceof zR){var h;const j=this.filterTobeUnmutedTracks(d[g]);if(j.length===0)continue;await((h=this.connection)===null||h===void 0?void 0:h.unmuteLocal(j.map(_i=>{let[,{id:_o}]=_i;return _o})));const _t=this.createUnmuteMessage(j);return void await qS(this,Y0.RequestUnmuteLocal,_t)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=d=>{var h;return!((h=this.connection)===null||h===void 0||!h.getRemoteVideoIsReady(d))},this.statsUploader.requestUpload=(d,h)=>this.emit(Y0.RequestUploadStats,d,h),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await KR(G3(this.dtlsFailedCount,rR)),this.emit(Y0.RequestReconnect)}async reconnectP2P(){const d=Array.from(this.localTrackMap.entries()),h=this.createGatewayUnpublishMessage(d);Array.from(this.remoteUserMap.entries()),h.length>0&&await YR(this,Y0.RequestUnpublishForReconnectPC,h),this.disconnectForReconnect(),this.emit(Y0.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(l0.LocalVideoTrack)||this.pendingLocalTracks.some(d=>d instanceof cR)}throwIfTrackTypeNotMatch(d){if(d.filter(h=>h instanceof cR).length>1)throw new f_(c_.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(d.filter(h=>h instanceof zR).length>1&&(d.some(h=>h instanceof zR&&h._bypassWebAudio)||!QS().webAudioMediaStreamDest))throw new f_(c_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const h of d){if(h instanceof cR&&this.pendingLocalTracks.some(g=>g instanceof cR))throw new f_(c_.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(h instanceof zR&&this.pendingLocalTracks.some(g=>g instanceof zR)&&(!QS().webAudioMediaStreamDest||h._bypassWebAudio||this.pendingLocalTracks.some(g=>g instanceof zR&&g._bypassWebAudio)))throw new f_(c_.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(d,h){const g=QS().supportDualStreamEncoding,j=_N(_N({},{width:160,height:120,framerate:15,bitrate:50}),h);let _t;_t=g?d._mediaStreamTrack.clone():DH(d,j);const _i=CS(8,"track-low-"),_o=new cR(_t,_N(_N({},g&&{scaleResolutionDownBy:QQ(j,d)}),{},{frameRate:j.framerate,bitrateMax:j.bitrate,bitrateMin:j.bitrate}),void 0,void 0,_i);return _o.on(mL.TRANSCEIVER_UPDATED,ga=>{d._updateRtpTransceiver(ga,Z1.LOW_STREAM)}),_o._hints.push(ER.LOW_STREAM),d.addListener(I0.NEED_CLOSE,()=>{_o.close()}),_o}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(d,h,g){let j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(this.connection&&this.connection instanceof WO){var _t,_i,_o,ga;const _a=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:_u,dtlsTransportState:_c,peerConnectionState:_l}=this.connection,{local:_g,remote:r_}=await this.connection.getSelectedCandidatePair();p0.pcStats(this.store.sessionId,{startTime:_a,eventElapse:d-_a||0,iceconnectionsate:_u,dtlsstate:_c,connectionstate:_l,intSucc:h?1:2,error:j,selectedLocalCandidateProtocol:(_t=_g==null?void 0:_g.protocol)!==null&&_t!==void 0?_t:"",selectedLocalCandidateType:(_i=_g.candidateType)!==null&&_i!==void 0?_i:"",selectedLocalCandidateAddress:"".concat(_g.address,":").concat(_g.port),selectedRemoteCandidateProtocol:(_o=r_.protocol)!==null&&_o!==void 0?_o:"",selectedRemoteCandidateType:(ga=r_.candidateType)!==null&&ga!==void 0?ga:"",selectedRemoteCandidateAddress:"".concat(r_.address,":").concat(r_.port),restartCnt:g})}}reportVideoFirstFrameDecoded(d,h,g,j){var _t;const _i=Array.from(n1(_t=this.remoteUserMap).call(_t)).find(_o=>_o._videoSSRC===d);if(_i){j||this.store.subscribe(_i.uid,"video",void 0,void 0,void 0,void 0,Date.now());const _o=this.store.keyMetrics,ga=_o.subscribe.find(_a=>_a.userId===_i.uid&&_a.type==="video");p0.firstRemoteVideoDecode(this.store.sessionId,xR.FIRST_VIDEO_DECODE,FS.FIRST_VIDEO_DECODE,{peer:_i._uintid,videowidth:h,videoheight:g,subscribeElapse:hI.measureFromSubscribeStart(this.store.clientId,d),subscribeRequestid:d,p2pid:this.store.p2pId,apEnd:_o.requestAPEnd||0,apStart:_o.requestAPStart||0,joinGwEnd:_o.joinGatewayEnd||0,joinGwStart:_o.joinGatewayStart||0,pcEnd:_o.peerConnectionEnd||0,pcStart:_o.peerConnectionStart||0,subscriberEnd:(ga==null?void 0:ga.subscribeEnd)||0,subscriberStart:(ga==null?void 0:ga.subscribeStart)||0,videoAddNotify:(ga==null?void 0:ga.streamAdded)||0,state:j?1:0})}}async remoteMediaSsrcChanged(d,h,g){if(!this.connection)return!1;const j=this.remoteUserMap.get(d);if(!j)return!1;const _t=j.get(h);if(!_t)return!1;const _i=await this.connection.getRemoteSSRC(_t);return _i!==void 0&&_i!==g}resetConnection(d){wE.debug("[".concat(this.store.clientId,"] [P2PChannel] reset connection to ").concat(d)),this.state===vR.Connected?(wE.debug("[".concat(this.store.clientId,"] [P2PChannel] fallback to websocket but P2PChannel state still connected, disconnect first")),this.disconnectForReconnect()):(this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=d===CU.datachannel?new vN({},this.store):this.isPlanB?new kL({},this.store):new WO({},this.store),this.bindConnectionEvents(this.connection)))}unbindRtpTransceiver(){this.localTrackMap.size!==0&&Array.from(this.localTrackMap.entries()).forEach(d=>{let[h,{track:g}]=d;h===l0.LocalVideoLowTrack?g._updateRtpTransceiver(void 0,Z1.LOW_STREAM):g._updateRtpTransceiver(void 0)})}reportPCDisconnectedOrFailed(d){this.connection&&this.connection instanceof WO&&(this.connection.iceConnectionState!=="disconnected"&&this.connection.iceConnectionState!=="checking"&&this.connection.iceConnectionState!=="failed"||(this._isFirstConnected?(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isFirstConnected=!1):this._pcStatsUploadType===QI.TCP_RESTART&&d===DR.RELAY?this.reportPCStats(Date.now(),!1,this._pcStatsUploadType):this.reportPCStats(Date.now(),!1,QI.DISCONNECTED_OR_FAILED)))}}).prototype,"startP2PConnection",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"startP2PConnection"),nS.prototype),G_(nS.prototype,"connect",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"connect"),nS.prototype),G_(nS.prototype,"preConnect",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"preConnect"),nS.prototype),G_(nS.prototype,"unpublish",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"unpublish"),nS.prototype),G_(nS.prototype,"unpublishLowStream",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"unpublishLowStream"),nS.prototype),G_(nS.prototype,"subscribe",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"subscribe"),nS.prototype),G_(nS.prototype,"massSubscribe",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"massSubscribe"),nS.prototype),G_(nS.prototype,"unsubscribe",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"unsubscribe"),nS.prototype),G_(nS.prototype,"massUnsubscribe",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"massUnsubscribe"),nS.prototype),G_(nS.prototype,"muteRemote",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"muteRemote"),nS.prototype),G_(nS.prototype,"unmuteRemote",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"unmuteRemote"),nS.prototype),G_(nS.prototype,"hasRemoteMediaWithLock",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"hasRemoteMediaWithLock"),nS.prototype),G_(nS.prototype,"disconnectForReconnect",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"disconnectForReconnect"),nS.prototype),G_(nS.prototype,"updateBitrateLimit",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"updateBitrateLimit"),nS.prototype),G_(nS.prototype,"remoteMediaSsrcChanged",[BT],Object.getOwnPropertyDescriptor(nS.prototype,"remoteMediaSsrcChanged"),nS.prototype),nS);function BT(d,h,g){const j=d[h];if(typeof j!="function")throw new Error("Cannot use mutex on object property.");return g.value=async function(){const _t=this.mutex,_i=await _t.lock("From P2PChannel.".concat(h));try{for(var _o=arguments.length,ga=new Array(_o),_a=0;_a<_o;_a++)ga[_a]=arguments[_a];return await j.apply(this,ga)}finally{_i()}},g}function eK(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function h0(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?eK(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):eK(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}var B0;(function(d){d.SET_SESSION_ID="SET_SESSION_ID",d.SET_P2P_ID="SET_P2P_id",d.SET_DC_ID="SET_DC_id",d.SET_UID="SET_UID",d.SET_PUB_ID="SET_PUB_ID",d.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",d.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",d.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",d.AVOID_JOIN_START="AVOID_JOIN_START",d.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",d.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",d.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",d.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",d.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",d.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",d.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",d.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",d.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",d.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",d.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",d.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",d.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",d.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",d.RESET_KEY_METRICS="RESET_KEY_METRICS",d.SET_USE_DATACHANNEL="SET_USE_DATACHANNEL"})(B0||(B0={}));class yee{constructor(h,g,j,_t){_h(this,"state",void 0),this.state={codec:h,audioCodec:g,mode:j,clientId:_t,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useDataChannel:!1}}dispatch(h){this.state=function(g,j){switch(j.type){case B0.SET_SESSION_ID:return h0(h0({},g),{},{sessionId:j.sessionId});case B0.SET_P2P_ID:return h0(h0({},g),{},{p2pId:j.p2pId});case B0.SET_UID:return h0(h0({},g),{},{uid:j.uid});case B0.SET_PUB_ID:return h0(h0({},g),{},{pubId:j.pubId});case B0.KEY_METRIC_CLIENT_CREATED:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{clientCreated:j.metric})});case B0.KEY_METRIC_JOIN_START:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{joinStart:j.metric})});case B0.AVOID_JOIN_START:return h0(h0({},g),{},{avoidJoinStart:j.avoidJoinStart});case B0.KEY_METRIC_JOIN_END:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{joinEnd:j.metric})});case B0.KEY_METRIC_REQUEST_AP_START:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{requestAPStart:j.metric})});case B0.KEY_METRIC_REQUEST_AP_END:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{requestAPEnd:j.metric})});case B0.KEY_METRIC_JOIN_GATEWAY_START:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{joinGatewayStart:j.metric})});case B0.KEY_METRIC_JOIN_GATEWAY_END:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{joinGatewayEnd:j.metric})});case B0.KEY_METRIC_PEER_CONNECTION_START:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{peerConnectionStart:j.metric})});case B0.KEY_METRIC_PEER_CONNECTION_END:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{peerConnectionEnd:j.metric})});case B0.KEY_METRIC_DESCRIPTION_START:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{descriptionStart:j.metric})});case B0.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{signalChannelOpen:j.metric})});case B0.KEY_METRIC_ICE_CONNECTION_END:return h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{iceConnectionEnd:j.metric})});case B0.KEY_METRIC_PUBLISH:{const _t=g.keyMetrics.publish,_i=_t.findIndex(_o=>_o.trackId===j.metric.trackId);return _i!==-1?(_t[_i]=h0(h0({},_t[_i]),j.metric),h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{publish:[..._t]})})):h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{publish:[...g.keyMetrics.publish,j.metric]})})}case B0.KEY_METRIC_SUBSCRIBE:{const _t=g.keyMetrics.subscribe,_i=_t.findIndex(_o=>_o.userId===j.metric.userId&&_o.type===j.metric.type);return _i!==-1?(_t[_i]=h0(h0({},_t[_i]),j.metric),h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{subscribe:[..._t]})})):h0(h0({},g),{},{keyMetrics:h0(h0({},g.keyMetrics),{},{subscribe:[...g.keyMetrics.subscribe,j.metric]})})}case B0.SET_CLOUD_PROXY_SERVER_MODE:return g.cloudProxyServerMode=j.mode,g;case B0.RECORD_JOIN_CHANNEL_SERVICE:return typeof j.index!="number"?g.joinChannelServiceRecords=[...g.joinChannelServiceRecords,j.record]:(g.joinChannelServiceRecords[j.index]=h0(h0({},g.joinChannelServiceRecords[j.index]),j.record),g.joinChannelServiceRecords=[...g.joinChannelServiceRecords]),g;case B0.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return g.joinChannelServiceRecords=[],g;case B0.RESET_KEY_METRICS:return g.keyMetrics={publish:[],subscribe:[]},g;case B0.SET_USE_DATACHANNEL:return h0(h0({},g),{},{useDataChannel:j.val});default:return g}}(this.state,h)}set sessionId(h){this.dispatch({type:B0.SET_SESSION_ID,sessionId:h})}get sessionId(){return this.state.sessionId}get codec(){return this.state.codec}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(h){this.dispatch({type:B0.SET_P2P_ID,p2pId:h})}get p2pId(){return this.state.p2pId}set dcId(h){this.dispatch({type:B0.SET_DC_ID,dcId:h})}get dcId(){return this.state.dcId}set uid(h){this.dispatch({type:B0.SET_UID,uid:h})}get uid(){return this.state.uid}set pubId(h){this.dispatch({type:B0.SET_PUB_ID,pubId:h})}get pubId(){return this.state.pubId}set cloudProxyServerMode(h){this.dispatch({type:B0.SET_CLOUD_PROXY_SERVER_MODE,mode:h})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useDataChannel(h){this.dispatch({type:B0.SET_USE_DATACHANNEL,val:h})}get useDataChannel(){return this.state.useDataChannel}clientCreated(){this.dispatch({type:B0.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:B0.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:B0.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:B0.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:B0.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:B0.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:B0.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:B0.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:B0.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:B0.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:B0.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:B0.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(h,g,j,_t){this.dispatch({type:B0.KEY_METRIC_PUBLISH,metric:h0(h0({trackId:h,type:g},j&&{publishStart:j}),_t&&{publishEnd:_t})})}subscribe(h,g,j,_t,_i,_o,ga){this.dispatch({type:B0.KEY_METRIC_SUBSCRIBE,metric:h0(h0(h0(h0(h0({userId:h,type:g},j&&{subscribeStart:j}),_t&&{subscribeEnd:_t}),_i&&{firstFrame:_i}),_o&&{streamAdded:_o}),ga&&{firstDecoded:ga})})}massSubscribe(h,g,j,_t){h.forEach(_i=>{this.dispatch({type:B0.KEY_METRIC_SUBSCRIBE,metric:h0(h0(h0({userId:_i.userId,type:_i.type},g&&{subscribeStart:g}),j&&{subscribeEnd:j}),_t&&{firstFrame:_t})})})}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(h,g){h.service==="gateway"&&Array.isArray(h.urls)&&(h.urls=h.urls.map(j=>j.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2")));try{return typeof g!="number"?(this.dispatch({type:B0.RECORD_JOIN_CHANNEL_SERVICE,record:h0(h0({},h),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(g<0||g>=this.state.joinChannelServiceRecords.length||this.dispatch({type:B0.RECORD_JOIN_CHANNEL_SERVICE,record:h,index:g}),g)}catch{return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:B0.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:B0.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch{return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(h){this.dispatch({type:B0.AVOID_JOIN_START,avoidJoinStart:h})}}let RF;const bee=()=>(RF||RF||(RF=(window.location.protocol.split(":")[0]||"").toUpperCase(),RF))==="HTTPS",tK=()=>window.isSecureContext!==void 0;function See(d){let h=iK();return function(g,j){let _t=g.appId;_t!==void 0&&(rS(j,10),vO(j,_t));let _i=g.cid;_i!==void 0&&(rS(j,16),rS(j,_i));let _o=g.cname;_o!==void 0&&(rS(j,26),vO(j,_o));let ga=g.deviceId;ga!==void 0&&(rS(j,34),vO(j,ga));let _a=g.elapse;_a!==void 0&&(rS(j,40),yN(j,_a));let _u=g.fileSize;_u!==void 0&&(rS(j,48),yN(j,hP(_u)));let _c=g.height;_c!==void 0&&(rS(j,56),yN(j,hP(_c)));let _l=g.jpg;_l!==void 0&&(rS(j,66),rS(j,_l.length),function(AT,L_){let z_=fP(AT,L_.length);AT.bytes.set(L_,z_)}(j,_l));let _g=g.networkType;_g!==void 0&&(rS(j,72),yN(j,hP(_g)));let r_=g.osType;r_!==void 0&&(rS(j,80),yN(j,hP(r_)));let l_=g.requestId;l_!==void 0&&(rS(j,90),vO(j,l_));let d_=g.sdkVersion;d_!==void 0&&(rS(j,98),vO(j,d_));let p_=g.sequence;p_!==void 0&&(rS(j,104),yN(j,hP(p_)));let C_=g.sid;C_!==void 0&&(rS(j,114),vO(j,C_));let O_=g.timestamp;O_!==void 0&&(rS(j,120),yN(j,O_));let q_=g.uid;q_!==void 0&&(rS(j,128),rS(j,q_));let c0=g.vid;c0!==void 0&&(rS(j,136),rS(j,c0));let K_=g.width;K_!==void 0&&(rS(j,144),yN(j,hP(K_)));let Q_=g.service;Q_!==void 0&&(rS(j,152),rS(j,Q_));let $_=g.callbackData;$_!==void 0&&(rS(j,162),vO(j,$_));let _b=g.jpgEncryption;_b!==void 0&&(rS(j,168),rS(j,_b));let iS=g.requestType;iS!==void 0&&(rS(j,176),rS(j,iS));let y0=g.scorePorn;y0!==void 0&&(rS(j,185),v6(j,y0));let TS=g.scoreSexy;TS!==void 0&&(rS(j,193),v6(j,TS));let hS=g.scoreNeutral;hS!==void 0&&(rS(j,201),v6(j,hS));let eR=g.scene;eR!==void 0&&(rS(j,208),rS(j,eR));let MR=g.ossFilePrefix;MR!==void 0&&(rS(j,218),vO(j,MR));let XS=g.serviceVendor;if(XS!==void 0)for(let AT of XS){rS(j,226);let L_=iK();wee(AT,L_),rS(j,L_.limit),Aee(j,L_),Oee(L_)}}(d,h),function(g){let j=g.bytes,_t=g.limit;return j.length===_t?j:j.subarray(0,_t)}(h)}function Ree(d){return function(g){let j={};e:for(;!oK(g);){let _t=_O(g);switch(_t>>>3){case 0:break e;case 1:j.code=_O(g);break;case 2:j.msg=sK(g,_O(g));break;case 3:{let _i=Cee(g);j.data=Tee(g),g.limit=_i;break}default:nK(g,7&_t)}}return j}({bytes:h=d,offset:0,limit:h.length});var h}function Tee(d){let h={};e:for(;!oK(d);){let g=_O(d);switch(g>>>3){case 0:break e;case 1:h.requestId=sK(d,_O(d));break;case 2:h.requestType=_O(d)>>>0;break;case 3:h.scorePorn=E6(d);break;case 4:h.scoreSexy=E6(d);break;case 5:h.scoreNeutral=E6(d);break;case 6:h.requestScene=_O(d)>>>0;break;case 7:h.scene=_O(d)>>>0;break;default:nK(d,7&g)}}return h}function wee(d,h){let g=d.service;g!==void 0&&(rS(h,8),rS(h,g));let j=d.vendor;j!==void 0&&(rS(h,16),rS(h,j));let _t=d.token;_t!==void 0&&(rS(h,26),vO(h,_t));let _i=d.callbackUrl;_i!==void 0&&(rS(h,34),vO(h,_i))}function Cee(d){let h=_O(d),g=d.limit;return d.limit=d.offset+h,g}function nK(d,h){switch(h){case 0:for(;128&aK(d););break;case 2:m6(d,_O(d));break;case 5:m6(d,4);break;case 1:m6(d,8);break;default:throw new Error("Unimplemented type: "+h)}}let Iee=new Float32Array(1);new Uint8Array(Iee.buffer);let f6=new Float64Array(1),OT=new Uint8Array(f6.buffer);function hP(d){return{low:d|=0,high:d>>31,unsigned:d>=0}}let rK=[];function iK(){const d=rK.pop();return d?(d.offset=d.limit=0,d):{bytes:new Uint8Array(64),offset:0,limit:0}}function Oee(d){rK.push(d)}function m6(d,h){if(d.offset+h>d.limit)throw new Error("Skip past limit");d.offset+=h}function oK(d){return d.offset>=d.limit}function fP(d,h){let g=d.bytes,j=d.offset,_t=d.limit,_i=j+h;if(_i>g.length){let _o=new Uint8Array(2*_i);_o.set(g),d.bytes=_o}return d.offset=_i,_i>_t&&(d.limit=_i),j}function g6(d,h){let g=d.offset;if(g+h>d.limit)throw new Error("Read past limit");return d.offset+=h,g}function sK(d,h){let g=g6(d,h),j=String.fromCharCode,_t=d.bytes,_i="",_o="";for(let ga=0;ga<h;ga++){let _a,_u,_c,_l,_g=_t[ga+g];128&_g?(224&_g)==192?ga+1>=h?_o+=_i:(_a=_t[ga+g+1],(192&_a)!=128?_o+=_i:(_l=(31&_g)<<6|63&_a,_l<128?_o+=_i:(_o+=j(_l),ga++))):(240&_g)==224?ga+2>=h?_o+=_i:(_a=_t[ga+g+1],_u=_t[ga+g+2],(49344&(_a|_u<<8))!=32896?_o+=_i:(_l=(15&_g)<<12|(63&_a)<<6|63&_u,_l<2048||_l>=55296&&_l<=57343?_o+=_i:(_o+=j(_l),ga+=2))):(248&_g)==240?ga+3>=h?_o+=_i:(_a=_t[ga+g+1],_u=_t[ga+g+2],_c=_t[ga+g+3],(12632256&(_a|_u<<8|_c<<16))!=8421504?_o+=_i:(_l=(7&_g)<<18|(63&_a)<<12|(63&_u)<<6|63&_c,_l<65536||_l>1114111?_o+=_i:(_l-=65536,_o+=j(55296+(_l>>10),56320+(1023&_l)),ga+=3))):_o+=_i:_o+=j(_g)}return _o}function vO(d,h){let g=h.length,j=0;for(let _o=0;_o<g;_o++){let ga=h.charCodeAt(_o);ga>=55296&&ga<=56319&&_o+1<g&&(ga=(ga<<10)+h.charCodeAt(++_o)-56613888),j+=ga<128?1:ga<2048?2:ga<65536?3:4}rS(d,j);let _t=fP(d,j),_i=d.bytes;for(let _o=0;_o<g;_o++){let ga=h.charCodeAt(_o);ga>=55296&&ga<=56319&&_o+1<g&&(ga=(ga<<10)+h.charCodeAt(++_o)-56613888),ga<128?_i[_t++]=ga:(ga<2048?_i[_t++]=ga>>6&31|192:(ga<65536?_i[_t++]=ga>>12&15|224:(_i[_t++]=ga>>18&7|240,_i[_t++]=ga>>12&63|128),_i[_t++]=ga>>6&63|128),_i[_t++]=63&ga|128)}}function Aee(d,h){let g=fP(d,h.limit),j=d.bytes,_t=h.bytes;for(let _i=0,_o=h.limit;_i<_o;_i++)j[_i+g]=_t[_i]}function aK(d){return d.bytes[g6(d,1)]}function cK(d,h){let g=fP(d,1);d.bytes[g]=h}function E6(d){let h=g6(d,8),g=d.bytes;return OT[0]=g[h++],OT[1]=g[h++],OT[2]=g[h++],OT[3]=g[h++],OT[4]=g[h++],OT[5]=g[h++],OT[6]=g[h++],OT[7]=g[h++],f6[0]}function v6(d,h){let g=fP(d,8),j=d.bytes;f6[0]=h,j[g++]=OT[0],j[g++]=OT[1],j[g++]=OT[2],j[g++]=OT[3],j[g++]=OT[4],j[g++]=OT[5],j[g++]=OT[6],j[g++]=OT[7]}function _O(d){let h,g=0,j=0;do h=aK(d),g<32&&(j|=(127&h)<<g),g+=7;while(128&h);return j}function rS(d,h){for(h>>>=0;h>=128;)cK(d,127&h|128),h>>>=7;cK(d,h)}function yN(d,h){let g=h.low>>>0,j=(h.low>>>28|h.high<<4)>>>0,_t=h.high>>>24,_i=_t===0?j===0?g<16384?g<128?1:2:g<1<<21?3:4:j<16384?j<128?5:6:j<1<<21?7:8:_t<128?9:10,_o=fP(d,_i),ga=d.bytes;switch(_i){case 10:ga[_o+9]=_t>>>7&1;case 9:ga[_o+8]=_i!==9?128|_t:127&_t;case 8:ga[_o+7]=_i!==8?j>>>21|128:j>>>21&127;case 7:ga[_o+6]=_i!==7?j>>>14|128:j>>>14&127;case 6:ga[_o+5]=_i!==6?j>>>7|128:j>>>7&127;case 5:ga[_o+4]=_i!==5?128|j:127&j;case 4:ga[_o+3]=_i!==4?g>>>21|128:g>>>21&127;case 3:ga[_o+2]=_i!==3?g>>>14|128:g>>>14&127;case 2:ga[_o+1]=_i!==2?g>>>7|128:g>>>7&127;case 1:ga[_o]=_i!==1?128|g:127&g}}const Nee=async(d,h,g)=>{const j=function(_o){const ga=[];for(let _a=0;_a<_o.length;_a+=2)ga.push(parseInt(_o.slice(_a,_a+2),16));return Uint8Array.from(ga)}(function(_o){const ga="0123456789abcdef";function _a(iS){let y0,TS="";for(y0=0;y0<=3;y0++)TS+=ga.charAt(iS>>8*y0+4&15)+ga.charAt(iS>>8*y0&15);return TS}function _u(iS,y0){const TS=(65535&iS)+(65535&y0);return(iS>>16)+(y0>>16)+(TS>>16)<<16|65535&TS}function _c(iS,y0,TS,hS,eR,MR){return _u(function(XS,AT){return XS<<AT|XS>>>32-AT}(_u(_u(y0,iS),_u(hS,MR)),eR),TS)}function _l(iS,y0,TS,hS,eR,MR,XS){return _c(y0&TS|~y0&hS,iS,y0,eR,MR,XS)}function _g(iS,y0,TS,hS,eR,MR,XS){return _c(y0&hS|TS&~hS,iS,y0,eR,MR,XS)}function r_(iS,y0,TS,hS,eR,MR,XS){return _c(y0^TS^hS,iS,y0,eR,MR,XS)}function l_(iS,y0,TS,hS,eR,MR,XS){return _c(TS^(y0|~hS),iS,y0,eR,MR,XS)}const d_=function(iS){let y0;const TS=1+(iS.length+8>>6),hS=new Array(16*TS);for(y0=0;y0<16*TS;y0++)hS[y0]=0;for(y0=0;y0<iS.length;y0++)hS[y0>>2]|=iS.charCodeAt(y0)<<y0%4*8;return hS[y0>>2]|=128<<y0%4*8,hS[16*TS-2]=8*iS.length,hS}(_o);let p_,C_,O_,q_,c0,K_=1732584193,Q_=-271733879,$_=-1732584194,_b=271733878;for(p_=0;p_<d_.length;p_+=16)C_=K_,O_=Q_,q_=$_,c0=_b,K_=_l(K_,Q_,$_,_b,d_[p_+0],7,-680876936),_b=_l(_b,K_,Q_,$_,d_[p_+1],12,-389564586),$_=_l($_,_b,K_,Q_,d_[p_+2],17,606105819),Q_=_l(Q_,$_,_b,K_,d_[p_+3],22,-1044525330),K_=_l(K_,Q_,$_,_b,d_[p_+4],7,-176418897),_b=_l(_b,K_,Q_,$_,d_[p_+5],12,1200080426),$_=_l($_,_b,K_,Q_,d_[p_+6],17,-1473231341),Q_=_l(Q_,$_,_b,K_,d_[p_+7],22,-45705983),K_=_l(K_,Q_,$_,_b,d_[p_+8],7,1770035416),_b=_l(_b,K_,Q_,$_,d_[p_+9],12,-1958414417),$_=_l($_,_b,K_,Q_,d_[p_+10],17,-42063),Q_=_l(Q_,$_,_b,K_,d_[p_+11],22,-1990404162),K_=_l(K_,Q_,$_,_b,d_[p_+12],7,1804603682),_b=_l(_b,K_,Q_,$_,d_[p_+13],12,-40341101),$_=_l($_,_b,K_,Q_,d_[p_+14],17,-1502002290),Q_=_l(Q_,$_,_b,K_,d_[p_+15],22,1236535329),K_=_g(K_,Q_,$_,_b,d_[p_+1],5,-165796510),_b=_g(_b,K_,Q_,$_,d_[p_+6],9,-1069501632),$_=_g($_,_b,K_,Q_,d_[p_+11],14,643717713),Q_=_g(Q_,$_,_b,K_,d_[p_+0],20,-373897302),K_=_g(K_,Q_,$_,_b,d_[p_+5],5,-701558691),_b=_g(_b,K_,Q_,$_,d_[p_+10],9,38016083),$_=_g($_,_b,K_,Q_,d_[p_+15],14,-660478335),Q_=_g(Q_,$_,_b,K_,d_[p_+4],20,-405537848),K_=_g(K_,Q_,$_,_b,d_[p_+9],5,568446438),_b=_g(_b,K_,Q_,$_,d_[p_+14],9,-1019803690),$_=_g($_,_b,K_,Q_,d_[p_+3],14,-187363961),Q_=_g(Q_,$_,_b,K_,d_[p_+8],20,1163531501),K_=_g(K_,Q_,$_,_b,d_[p_+13],5,-1444681467),_b=_g(_b,K_,Q_,$_,d_[p_+2],9,-51403784),$_=_g($_,_b,K_,Q_,d_[p_+7],14,1735328473),Q_=_g(Q_,$_,_b,K_,d_[p_+12],20,-1926607734),K_=r_(K_,Q_,$_,_b,d_[p_+5],4,-378558),_b=r_(_b,K_,Q_,$_,d_[p_+8],11,-2022574463),$_=r_($_,_b,K_,Q_,d_[p_+11],16,1839030562),Q_=r_(Q_,$_,_b,K_,d_[p_+14],23,-35309556),K_=r_(K_,Q_,$_,_b,d_[p_+1],4,-1530992060),_b=r_(_b,K_,Q_,$_,d_[p_+4],11,1272893353),$_=r_($_,_b,K_,Q_,d_[p_+7],16,-155497632),Q_=r_(Q_,$_,_b,K_,d_[p_+10],23,-1094730640),K_=r_(K_,Q_,$_,_b,d_[p_+13],4,681279174),_b=r_(_b,K_,Q_,$_,d_[p_+0],11,-358537222),$_=r_($_,_b,K_,Q_,d_[p_+3],16,-722521979),Q_=r_(Q_,$_,_b,K_,d_[p_+6],23,76029189),K_=r_(K_,Q_,$_,_b,d_[p_+9],4,-640364487),_b=r_(_b,K_,Q_,$_,d_[p_+12],11,-421815835),$_=r_($_,_b,K_,Q_,d_[p_+15],16,530742520),Q_=r_(Q_,$_,_b,K_,d_[p_+2],23,-995338651),K_=l_(K_,Q_,$_,_b,d_[p_+0],6,-198630844),_b=l_(_b,K_,Q_,$_,d_[p_+7],10,1126891415),$_=l_($_,_b,K_,Q_,d_[p_+14],15,-1416354905),Q_=l_(Q_,$_,_b,K_,d_[p_+5],21,-57434055),K_=l_(K_,Q_,$_,_b,d_[p_+12],6,1700485571),_b=l_(_b,K_,Q_,$_,d_[p_+3],10,-1894986606),$_=l_($_,_b,K_,Q_,d_[p_+10],15,-1051523),Q_=l_(Q_,$_,_b,K_,d_[p_+1],21,-2054922799),K_=l_(K_,Q_,$_,_b,d_[p_+8],6,1873313359),_b=l_(_b,K_,Q_,$_,d_[p_+15],10,-30611744),$_=l_($_,_b,K_,Q_,d_[p_+6],15,-1560198380),Q_=l_(Q_,$_,_b,K_,d_[p_+13],21,1309151649),K_=l_(K_,Q_,$_,_b,d_[p_+4],6,-145523070),_b=l_(_b,K_,Q_,$_,d_[p_+11],10,-1120210379),$_=l_($_,_b,K_,Q_,d_[p_+2],15,718787259),Q_=l_(Q_,$_,_b,K_,d_[p_+9],21,-343485551),K_=_u(K_,C_),Q_=_u(Q_,O_),$_=_u($_,q_),_b=_u(_b,c0);return _a(K_)+_a(Q_)+_a($_)+_a(_b)}(""+h+g)).slice(0,16),_t=j.slice(0,12),_i=await window.crypto.subtle.importKey("raw",j,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:_t},_i,d))},uK=async(d,h,g)=>await Nee(d.buffer,h,g);function lK(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}const kee=new Map([["moderation",1],["supervise",2]]);class TF extends US{get connectionState(){return this._connectionState}set connectionState(h){if(this._connectionState===h)return;const g=this._connectionState;this._connectionState=h,this.emit(fR.CONNECTION_STATE_CHANGE,g,h)}get inspectType(){return this._inspectType}set inspectType(h){var g;this._inspectMode=WI(g=h.map(j=>kee.get(j)||0)).call(g,(j,_t)=>j+_t),this._inspectType=h}get quality(){return this._quality}set quality(h){this._quality=h>1?1:h<.1?.1:h,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this.qualityRatio},6e4))}constructor(h){super(),_h(this,"name","AgoraRTCVideoContentInspect"),_h(this,"_connectionState",XT.CONNECTING),_h(this,"_innerConnectionState",void 0),_h(this,"sequence",0),_h(this,"inspectStartTime",void 0),_h(this,"workerManagerConnection",void 0),_h(this,"workerConnection",void 0),_h(this,"workerMessageLengthLimit",void 0),_h(this,"inspectIntervalMinimum",void 0),_h(this,"qualityRatio",void 0),_h(this,"_connectInfo",void 0),_h(this,"_cancelTokenSource",KT.CancelToken.source()),_h(this,"_retryConfig",void 0),_h(this,"wmSequence",0),_h(this,"inspectInterval",void 0),_h(this,"inspectTimer",null),_h(this,"ossFilePrefix",void 0),_h(this,"extraInfo",void 0),_h(this,"_inspectType",void 0),_h(this,"_inspectMode",void 0),_h(this,"_quality",1),_h(this,"qualityTimer",null),_h(this,"_inspectId",void 0),_h(this,"_needWorkUrlOnly",!1),_h(this,"inspectImage",()=>{if(this.connectionState!==XT.CONNECTED)throw new f_(c_.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval(()=>{this.connectionState===XT.CONNECTED?this.requestToInspectImage():wE.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)},this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()}),this._inspectId=CS(5,"inspect-"),this.workerMessageLengthLimit=__("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=__("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=__("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=h.interval,this.ossFilePrefix=h.ossFilePrefix,this.extraInfo=h.extraInfo,this.inspectType=h.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new a1("worker-manager-"+this._inspectId,rR),this.on(fR.STATE_CHANGE,(g,j)=>{this._innerConnectionState=g,wE.debug("[".concat(this._inspectId,"] Inspect operation :").concat(QT[g]," ").concat(j||""))}),this.handleWorkerManagerEvents(),this.workerConnection=new a1("worker-"+this._inspectId,rR),this.handleWorkerEvents()}async init(h,g){this.emit(fR.STATE_CHANGE,QT.CONNECT_AP),this._connectInfo=h;const j=this._cancelTokenSource.token;return this._retryConfig=g,new a0((_t,_i)=>{this.on(fR.CONNECTION_STATE_CHANGE,(_o,ga)=>{ga===XT.CONNECTED&&_t()}),this.requestAP(h,j,g).then(_o=>{this.connectWorkerManager(_o)}).catch(_o=>{_i(_o)})})}async requestAP(h,g,j){const _t=__("WEBCS_DOMAIN").map(ga=>"https://".concat(ga,"/api/v1")),_i=await function(ga,_a,_u,_c){let{appId:_l,areaCode:_g,cname:r_,sid:l_,token:d_,uid:p_}=_a;aP++;const C_="image_moderation_api",O_={service_name:C_,json_body:JSON.stringify({appId:_l,areaCode:_g,cname:r_,command:"allocateEdge",requestId:aP,seq:aP,sid:l_,token:d_,ts:Date.now(),uid:p_+""})};let q_,c0,K_=ga[0];return JI(async()=>{q_=Date.now();const Q_=await NI(K_,{data:O_,cancelToken:_u,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(c0=Date.now()-q_,Q_.code!==0){const y0=new f_(c_.UNEXPECTED_RESPONSE,"image inspect ap error, code"+Q_.code,{retry:!0,responseTime:c0});throw wE.error(y0.toString()),y0}const $_=JSON.parse(Q_.json_body);if($_.code!==200){const y0=new f_(c_.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat($_.code,", reason: ").concat($_.reason),{code:$_.code,responseTime:c0});throw wE.error(y0.toString()),y0}if(!$_.servers||!Array.isArray($_.servers)||$_.servers.length===0){const y0=new f_(c_.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:$_.code,responseTime:c0});throw wE.error(y0.toString()),y0}const _b=__("VIDEO_INSPECT_WORKER_MANAGER_HOST"),iS=__("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:$_.servers.map(y0=>{let{address:TS,wss:hS}=y0;if(TS&&hS)return"wss://".concat(TS.replace(/\./g,"-"),".").concat(_b,":").concat(iS||hS)}).filter(y0=>!!y0),workerToken:$_.workerToken,vid:$_.vid,responseTime:c0}},(Q_,$_)=>(p0.apworkerEvent(l_,{success:!0,sc:200,serviceName:C_,responseDetail:JSON.stringify(Q_.addressList),firstSuccess:$_===0,responseTime:c0,serverIp:ga[$_%ga.length]}),!1),(Q_,$_)=>(p0.apworkerEvent(l_,{success:!1,sc:Q_.data&&Q_.data.code||200,serviceName:C_,responseTime:c0,serverIp:ga[$_%ga.length]}),!!(Q_.code!==c_.OPERATION_ABORTED&&Q_.code!==c_.UNEXPECTED_RESPONSE||Q_.data&&Q_.data.retry)&&(K_=ga[($_+1)%ga.length],!0)),_c)}(_t,h,g,j);this.emit(fR.STATE_CHANGE,QT.AP_CONNECTED);const{addressList:_o}=_i;return this.wmSequence++,_o}async connectWorkerManager(h){let g=arguments.length>1&&arguments[1]!==void 0&&arguments[1];this._needWorkUrlOnly=g,this.emit(fR.STATE_CHANGE,QT.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(h,1e4)}async connectWorker(h){await this.workerConnection.init([h])}handleWorkerManagerEvents(){this.workerManagerConnection.on(x0.CONNECTED,async()=>{this.emit(fR.STATE_CHANGE,QT.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.18.3",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)}),this.workerManagerConnection.on(x0.CLOSED,()=>{this._innerConnectionState<QT.GET_WORKER_MANAGER_RESPONSE&&wE.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))}),this.workerManagerConnection.on(x0.FAILED,()=>{this._innerConnectionState<QT.GET_WORKER_MANAGER_RESPONSE&&wE.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))}),this.workerManagerConnection.on(x0.RECONNECTING,()=>{this._innerConnectionState<QT.GET_WORKER_MANAGER_RESPONSE&&wE.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))}),this.workerManagerConnection.on(x0.ON_MESSAGE,async h=>{this.emit(fR.STATE_CHANGE,QT.GET_WORKER_MANAGER_RESPONSE);const g=this.workerManagerConnection.url;this.workerManagerConnection.close();const j=JSON.parse(h.data);if(j.code!==200)throw wE.error("[".concat(this._inspectId,"] Unexpected code ").concat(j.code," from worker manager")),new f_(c_.UNEXPECTED_RESPONSE,"response code of worker is unexpected",j);if(!(j.serverResponse&&j.serverResponse.portWss&&g))throw wE.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(j))),new f_(c_.UNEXPECTED_RESPONSE,"response content of worker is unexpected",j);{const _t=__("VIDEO_INSPECT_WORKER_PORT")||j.serverResponse.portWss,_i=g.replace(/:\d+\/?$/,":".concat(_t));this.emit(fR.STATE_CHANGE,QT.CONNECT_WORKER,_i),this._needWorkUrlOnly?this.emit(fR.REQUEST_NEW_WORKER_URL,_i):await this.connectWorker(_i)}}),this.workerManagerConnection.on(x0.WILL_RECONNECT,(h,g)=>{g(h)}),this.workerManagerConnection.on(x0.REQUEST_NEW_URLS,(h,g)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(h).catch(g)})}handleWorkerEvents(){this.workerConnection.on(x0.CONNECTED,async()=>{this.emit(fR.STATE_CHANGE,QT.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=XT.CONNECTED}),this.workerConnection.on(x0.ON_MESSAGE,async h=>{if(h.data instanceof ArrayBuffer){const j=Ree(new Uint8Array(h.data));if(__("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&wE.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(j)),j.code===200){if(Array.isArray(this.inspectType)&&this.inspectType.length===1&&this.inspectType[0]==="supervise")return void this.emit(fR.INSPECT_RESULT,void 0,void 0);if(j.data&&j.data.scorePorn&&j.data.scoreSexy&&j.data.scoreNeutral){var g;const _t={porn:j.data.scorePorn,sexy:j.data.scoreSexy,neutral:j.data.scoreNeutral},_i=WI(g=Object.keys(_t)).call(g,(ga,_a)=>_t[ga]>_t[_a]?ga:_a,"porn"),_o=Object.keys(_t).find(ga=>ga===_i);this.emit(fR.INSPECT_RESULT,_o)}else this.emit(fR.INSPECT_RESULT,void 0,new f_(c_.UNEXPECTED_RESPONSE,j.code+"","There is an unexpected data on message"))}else this.emit(fR.INSPECT_RESULT,void 0,new f_(c_.UNEXPECTED_RESPONSE,j.code+"",j.msg))}else wE.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(fR.INSPECT_RESULT,void 0,new f_(c_.UNEXPECTED_RESPONSE,"invalid worker message type"))}),this.workerConnection.on(x0.CLOSED,()=>{this.connectionState=XT.CLOSED}),this.workerConnection.on(x0.FAILED,()=>{this.connectionState=XT.CLOSED}),this.workerConnection.on(x0.RECONNECTING,()=>{this.connectionState=this.connectionState===XT.CONNECTED?XT.RECONNECTING:XT.CONNECTING}),this.workerConnection.on(x0.WILL_RECONNECT,(h,g)=>{h==="recover"&&g(h),g("tryNext")}),this.workerConnection.on(x0.REQUEST_NEW_URLS,(h,g)=>{this.workerManagerConnection.close(),this.once(fR.REQUEST_NEW_WORKER_URL,j=>{h([j])}),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(j=>{this.connectWorkerManager(j,!0)}).catch(j=>{g(j)})})}static intToLong(h){return{low:h|=0,high:h>>31,unsigned:h>=0}}async requestToInspectImage(){this.sequence++;const h=PI(this,fR.CLIENT_LOCAL_VIDEO_TRACK),g={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(h){if(!h.isPlaying)return void this.emit(fR.INSPECT_RESULT,void 0,new f_(c_.INVALID_OPERATION,"Only the track being played can be inspected"));const j=await this.generateRequestData(h,g);this.workerConnection.sendMessage(j,!0,!0)}else this.emit(fR.INSPECT_RESULT,void 0,new f_(c_.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(h,g){let{appId:j,cname:_t,cid:_i,vid:_o,sid:ga,uid:_a}=g;const _u=Date.now(),_c=await h.getCurrentFrameImage("image/jpeg",this.quality),_l=await uK(_c,j,_t),_g=this.sequence+"-"+_i+"-"+_a+"-"+_u+"-"+CS(12,""),r_={appId:j,cid:_i,cname:_t,deviceId:"",elapse:TF.intToLong(Number(_u-this.inspectStartTime)),fileSize:_l.byteLength,jpgEncryption:2,height:_c.height,width:_c.width,jpg:_l,networkType:6,osType:7,requestId:_g,sdkVersion:"4.18.3",sequence:this.sequence,sid:ga,timestamp:TF.intToLong(_u),uid:_a,vid:_o,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};this.extraInfo===void 0&&delete r_.callbackData,this.ossFilePrefix===void 0&&delete r_.ossFilePrefix;const l_=See(r_);if(l_.byteLength<this.workerMessageLengthLimit){if(__("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const d_=function(p_){for(var C_=1;C_<arguments.length;C_++){var O_=arguments[C_]!=null?arguments[C_]:{};C_%2?lK(Object(O_),!0).forEach(function(q_){_h(p_,q_,O_[q_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p_,Object.getOwnPropertyDescriptors(O_)):lK(Object(O_)).forEach(function(q_){Object.defineProperty(p_,q_,Object.getOwnPropertyDescriptor(O_,q_))})}return p_}({},r_);delete d_.jpg,wE.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(d_))}return l_}{const d_=this.quality*this.qualityRatio;return this.quality=d_,await this.generateRequestData(h,{appId:j,cname:_t,cid:_i,vid:_o,sid:ga,uid:_a})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=KT.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=XT.CLOSED,this.emit(fR.STATE_CHANGE,QT.CLOSED)}}function Pee(d){let h=function(){const g=Lee.pop();return g?(g.offset=g.limit=0,g):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(g,j){let _t=g.appId;_t!==void 0&&(ZS(j,10),p1(j,_t));let _i=g.cid;_i!==void 0&&(ZS(j,16),ZS(j,_i));let _o=g.cname;_o!==void 0&&(ZS(j,26),p1(j,_o));let ga=g.deviceId;ga!==void 0&&(ZS(j,34),p1(j,ga));let _a=g.elapse;_a!==void 0&&(ZS(j,40),bN(j,_a));let _u=g.fileSize;_u!==void 0&&(ZS(j,48),bN(j,mP(_u)));let _c=g.height;_c!==void 0&&(ZS(j,56),bN(j,mP(_c)));let _l=g.jpg;_l!==void 0&&(ZS(j,66),ZS(j,_l.length),pK(j,_l));let _g=g.networkType;_g!==void 0&&(ZS(j,72),bN(j,mP(_g)));let r_=g.osType;r_!==void 0&&(ZS(j,80),bN(j,mP(r_)));let l_=g.requestId;l_!==void 0&&(ZS(j,90),p1(j,l_));let d_=g.sdkVersion;d_!==void 0&&(ZS(j,98),p1(j,d_));let p_=g.sequence;p_!==void 0&&(ZS(j,104),bN(j,mP(p_)));let C_=g.sid;C_!==void 0&&(ZS(j,114),p1(j,C_));let O_=g.timestamp;O_!==void 0&&(ZS(j,120),bN(j,O_));let q_=g.uid;q_!==void 0&&(ZS(j,128),ZS(j,q_));let c0=g.vid;c0!==void 0&&(ZS(j,136),ZS(j,c0));let K_=g.width;K_!==void 0&&(ZS(j,144),bN(j,mP(K_)));let Q_=g.service;Q_!==void 0&&(ZS(j,152),ZS(j,Q_));let $_=g.callbackData;$_!==void 0&&(ZS(j,162),ZS(j,$_.length),pK(j,$_));let _b=g.ticket;_b!==void 0&&(ZS(j,170),p1(j,_b))}(d,h),function(g){let j=g.bytes,_t=g.limit;return j.length===_t?j:j.subarray(0,_t)}(h)}function xee(d){return function(g){let j={};e:for(;!Mee(g);){let _t=PL(g);switch(_t>>>3){case 0:break e;case 1:j.code=PL(g);break;case 2:j.msg=hK(g,PL(g));break;case 3:j.requestId=hK(g,PL(g));break;case 4:j.timestamp=jee(g,!1);break;default:Dee(g,7&_t)}}return j}({bytes:h=d,offset:0,limit:h.length});var h}function Dee(d,h){switch(h){case 0:for(;128&MI(d););break;case 2:_6(d,PL(d));break;case 5:_6(d,4);break;case 1:_6(d,8);break;default:throw new Error("Unimplemented type: "+h)}}function mP(d){return{low:d|=0,high:d>>31,unsigned:d>=0}}let Lee=[];function _6(d,h){if(d.offset+h>d.limit)throw new Error("Skip past limit");d.offset+=h}function Mee(d){return d.offset>=d.limit}function CF(d,h){let g=d.bytes,j=d.offset,_t=d.limit,_i=j+h;if(_i>g.length){let _o=new Uint8Array(2*_i);_o.set(g),d.bytes=_o}return d.offset=_i,_i>_t&&(d.limit=_i),j}function dK(d,h){let g=d.offset;if(g+h>d.limit)throw new Error("Read past limit");return d.offset+=h,g}function pK(d,h){let g=CF(d,h.length);d.bytes.set(h,g)}function hK(d,h){let g=dK(d,h),j=String.fromCharCode,_t=d.bytes,_i="",_o="";for(let ga=0;ga<h;ga++){let _a,_u,_c,_l,_g=_t[ga+g];128&_g?(224&_g)==192?ga+1>=h?_o+=_i:(_a=_t[ga+g+1],(192&_a)!=128?_o+=_i:(_l=(31&_g)<<6|63&_a,_l<128?_o+=_i:(_o+=j(_l),ga++))):(240&_g)==224?ga+2>=h?_o+=_i:(_a=_t[ga+g+1],_u=_t[ga+g+2],(49344&(_a|_u<<8))!=32896?_o+=_i:(_l=(15&_g)<<12|(63&_a)<<6|63&_u,_l<2048||_l>=55296&&_l<=57343?_o+=_i:(_o+=j(_l),ga+=2))):(248&_g)==240?ga+3>=h?_o+=_i:(_a=_t[ga+g+1],_u=_t[ga+g+2],_c=_t[ga+g+3],(12632256&(_a|_u<<8|_c<<16))!=8421504?_o+=_i:(_l=(7&_g)<<18|(63&_a)<<12|(63&_u)<<6|63&_c,_l<65536||_l>1114111?_o+=_i:(_l-=65536,_o+=j(55296+(_l>>10),56320+(1023&_l)),ga+=3))):_o+=_i:_o+=j(_g)}return _o}function p1(d,h){let g=h.length,j=0;for(let _o=0;_o<g;_o++){let ga=h.charCodeAt(_o);ga>=55296&&ga<=56319&&_o+1<g&&(ga=(ga<<10)+h.charCodeAt(++_o)-56613888),j+=ga<128?1:ga<2048?2:ga<65536?3:4}ZS(d,j);let _t=CF(d,j),_i=d.bytes;for(let _o=0;_o<g;_o++){let ga=h.charCodeAt(_o);ga>=55296&&ga<=56319&&_o+1<g&&(ga=(ga<<10)+h.charCodeAt(++_o)-56613888),ga<128?_i[_t++]=ga:(ga<2048?_i[_t++]=ga>>6&31|192:(ga<65536?_i[_t++]=ga>>12&15|224:(_i[_t++]=ga>>18&7|240,_i[_t++]=ga>>12&63|128),_i[_t++]=ga>>6&63|128),_i[_t++]=63&ga|128)}}function MI(d){return d.bytes[dK(d,1)]}function fK(d,h){let g=CF(d,1);d.bytes[g]=h}function PL(d){let h,g=0,j=0;do h=MI(d),g<32&&(j|=(127&h)<<g),g+=7;while(128&h);return j}function ZS(d,h){for(h>>>=0;h>=128;)fK(d,127&h|128),h>>>=7;fK(d,h)}function jee(d,h){let g,j=0,_t=0,_i=0;return g=MI(d),j=127&g,128&g&&(g=MI(d),j|=(127&g)<<7,128&g&&(g=MI(d),j|=(127&g)<<14,128&g&&(g=MI(d),j|=(127&g)<<21,128&g&&(g=MI(d),_t=127&g,128&g&&(g=MI(d),_t|=(127&g)<<7,128&g&&(g=MI(d),_t|=(127&g)<<14,128&g&&(g=MI(d),_t|=(127&g)<<21,128&g&&(g=MI(d),_i=127&g,128&g&&(g=MI(d),_i|=(127&g)<<7))))))))),{low:j|_t<<28,high:_t>>>4|_i<<24,unsigned:h}}function bN(d,h){let g=h.low>>>0,j=(h.low>>>28|h.high<<4)>>>0,_t=h.high>>>24,_i=_t===0?j===0?g<16384?g<128?1:2:g<1<<21?3:4:j<16384?j<128?5:6:j<1<<21?7:8:_t<128?9:10,_o=CF(d,_i),ga=d.bytes;switch(_i){case 10:ga[_o+9]=_t>>>7&1;case 9:ga[_o+8]=_i!==9?128|_t:127&_t;case 8:ga[_o+7]=_i!==8?j>>>21|128:j>>>21&127;case 7:ga[_o+6]=_i!==7?j>>>14|128:j>>>14&127;case 6:ga[_o+5]=_i!==6?j>>>7|128:j>>>7&127;case 5:ga[_o+4]=_i!==5?128|j:127&j;case 4:ga[_o+3]=_i!==4?g>>>21|128:g>>>21&127;case 3:ga[_o+2]=_i!==3?g>>>14|128:g>>>14&127;case 2:ga[_o+1]=_i!==2?g>>>7|128:g>>>7&127;case 1:ga[_o]=_i!==1?128|g:127&g}}const mK={},gK={},EK=4294967296,vK=18446744073709552e3,_K=vK/2,y6=bK(0,!0),yK=bK(0),Uee=gP(0,-2147483648,!1),Fee=gP(-1,2147483647,!1),Bee=gP(-1,-1,!0);function bK(d,h){let g,j,_t;return h?(_t=0<=(d>>>=0)&&d<256)&&(j=gK[d],j)?j:(g=gP(d,0,!0),_t&&(gK[d]=g),g):(_t=-128<=(d|=0)&&d<128)&&(j=mK[d],j)?j:(g=gP(d,d<0?-1:0,!1),_t&&(mK[d]=g),g)}function gP(d,h,g){return{low:0|d,high:0|h,unsigned:!!g}}function Vee(d,h){if(isNaN(d))return h?y6:yK;if(h){if(d<0)return y6;if(d>=vK)return Bee}else{if(d<=-_K)return Uee;if(d+1>=_K)return Fee}return d<0?h?y6:yK:gP(d%EK|0,d/EK|0,h)}function SK(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}class b6 extends US{get connectionState(){return this._connectionState}set connectionState(h){if(this._connectionState===h)return;const g=this._connectionState;this._connectionState=h,this.emit(pI.CONNECTION_STATE_CHANGE,h,g)}get quality(){return this._quality}set quality(h){this._quality=h>1?1:h<.1?.1:h,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout(()=>{this.quality=this._quality/this._qualityRatio},6e4))}constructor(h){var g;super(),_h(this,"name","AgoraRTCImageModeration"),_h(this,"_connectionState",UT.CONNECTING),_h(this,"_sequence",0),_h(this,"_moderationStartTime",void 0),_h(this,"_workerConnection",void 0),_h(this,"_workerMessageLengthLimit",void 0),_h(this,"_qualityRatio",void 0),_h(this,"_connectInfo",void 0),_h(this,"_cancelTokenSource",KT.CancelToken.source()),_h(this,"_retryConfig",void 0),_h(this,"_moderationInterval",void 0),_h(this,"_moderationTimer",null),_h(this,"_moderationMode",1),_h(this,"_quality",1),_h(this,"_qualityTimer",null),_h(this,"_ticket",void 0),_h(this,"_moderationIntervalMinimum",void 0),_h(this,"_uploadFailedNum",0),_h(this,"_uploadNum",0),_h(this,"_uploadTimer",null),_h(this,"_moderationId",void 0),_h(this,"inspectImage",()=>{if(this.connectionState!==UT.CONNECTED)throw new f_(c_.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval(()=>{this.connectionState===UT.CONNECTED?this.requestToInspectImage():wE.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)},this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()}),this._moderationId=CS(5,"image-moderation-"),this._workerMessageLengthLimit=__("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=__("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=(g=h.interval)!==null&&g!==void 0?g:1e3,this._qualityRatio=__("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new a1("worker-"+this._moderationId,rR),this.on(pI.STATE_CHANGE,(j,_t)=>{wE.debug("[".concat(this._moderationId,"] Moderation operation :").concat(pN[j]," ").concat(_t||""))}),this.handleWorkerEvents()}async init(h,g){this.emit(pI.STATE_CHANGE,pN.CONNECT_AP),this._connectInfo=h;const j=this._cancelTokenSource.token;return this._retryConfig=g,new a0((_t,_i)=>{this.on(pI.CONNECTION_STATE_CHANGE,(_o,ga)=>{_o===UT.CONNECTED&&_t()}),this.requestAP(h,j,g).then(_o=>{this.connectWorker(_o)}).catch(_o=>{_i(_o)})})}updateConfig(h){var g;this._moderationInterval=(g=h.interval)!==null&&g!==void 0?g:1e3,wE.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(h))),this.connectionState===UT.CONNECTED&&this.inspectImage()}async requestAP(h,g,j){const _t=__("WEBCS_DOMAIN").map(_a=>"https://".concat(_a,"/api/v1")),_i=await function(_a,_u,_c,_l){let{appId:_g,areaCode:r_,cname:l_,sid:d_,token:p_,uid:C_}=_u;aP++;const O_="moderation_plugin",q_={service_name:O_,json_body:JSON.stringify({appId:_g,areaCode:r_,cname:l_,command:"allocateEdge",requestId:aP,seq:aP,sid:d_,appToken:p_,ts:Date.now(),uid:C_+""})};let c0,K_,Q_=_a[0];return JI(async()=>{c0=Date.now();const $_=await NI(Q_,{data:q_,cancelToken:_c,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(K_=Date.now()-c0,$_.code!==0){const y0=new f_(c_.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+$_.code,{retry:!0,responseTime:K_});throw wE.error(y0.toString()),y0}const _b=JSON.parse($_.json_body);if(_b.code!==200){const y0=new f_(c_.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(_b.code,", reason: ").concat(_b.reason),{code:_b.code,responseTime:K_});throw wE.error(y0.toString()),y0}if(!_b.servers||!Array.isArray(_b.servers)||_b.servers.length===0){const y0=new f_(c_.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:_b.code,responseTime:K_});throw wE.error(y0.toString()),y0}if(!_b.servers.some(y0=>!!y0.wss)){const y0=new f_(c_.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:_b.code,responseTime:K_});throw wE.error(y0.toString()),y0}const iS=__("IMAGE_MODERATION_WORKER_HOST");return{addressList:_b.servers.map(y0=>{let{address:TS,wss:hS}=y0;if(TS&&hS)return"wss://".concat(TS.replace(/\./g,"-"),".").concat(iS,":").concat(hS,"/moderation")}).filter(y0=>!!y0),workerToken:_b.workerToken,vid:_b.vid,ticket:_b.appTicket,responseTime:K_}},($_,_b)=>(p0.apworkerEvent(d_,{success:!0,sc:200,serviceName:O_,responseDetail:JSON.stringify($_.addressList),firstSuccess:_b===0,responseTime:K_,serverIp:_a[_b%_a.length]}),!1),($_,_b)=>(p0.apworkerEvent(d_,{success:!1,sc:$_.data&&$_.data.code||200,serviceName:O_,responseTime:K_,serverIp:_a[_b%_a.length]}),!!($_.code!==c_.OPERATION_ABORTED&&$_.code!==c_.UNEXPECTED_RESPONSE||$_.data&&$_.data.retry)&&(Q_=_a[(_b+1)%_a.length],!0)),_l)}(_t,h,g,j);this.emit(pI.STATE_CHANGE,pN.AP_CONNECTED);const{addressList:_o,ticket:ga}=_i;return this._ticket=ga,_o}async connectWorker(h){this.emit(pI.STATE_CHANGE,pN.CONNECT_WORKER),await this._workerConnection.init(h,1e4)}handleWorkerEvents(){this._workerConnection.on(x0.CONNECTED,async()=>{this.emit(pI.STATE_CHANGE,pN.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=UT.CONNECTED}),this._workerConnection.on(x0.CLOSED,()=>{this.connectionState=UT.CLOSED}),this._workerConnection.on(x0.FAILED,()=>{this.connectionState=UT.CLOSED}),this._workerConnection.on(x0.RECONNECTING,()=>{this.connectionState=this.connectionState===UT.CONNECTED?UT.RECONNECTING:UT.CONNECTING}),this._workerConnection.on(x0.ON_MESSAGE,async h=>{if(h.data instanceof ArrayBuffer){const g=xee(new Uint8Array(h.data));__("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&wE.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(g)),this._uploadNum++,g.code===void 0||g.code===0||(this._uploadFailedNum++,wE.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(g.code,", msg is ").concat(g.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout(()=>{p0.reportApiInvoke(this._connectInfo.sid||null,{name:iR.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,g.code],tag:kS.TRACER}).onError(new f_(c_.IMAGE_MODERATION_UPLOAD_FAILED,g.msg)),this._uploadTimer=null},__("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else wE.error("[".concat(this._moderationId,"] Unexpected message type from worker"))}),this._workerConnection.on(x0.WILL_RECONNECT,(h,g)=>{h==="recover"&&g(h),g("tryNext")}),this._workerConnection.on(x0.REQUEST_NEW_URLS,(h,g)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(h).catch(g)})}static intToLong(h){return{low:h|=0,high:h>>31,unsigned:h>=0}}async requestToInspectImage(){const h=PI(this,pI.CLIENT_LOCAL_VIDEO_TRACK),g={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(h){if(!h.isPlaying)return void(__("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&wE.debug("Only the track being played can be inspected"));this._sequence++;const j=await this.generateRequestData(h,g);this._workerConnection.sendMessage(j,!0,!0)}else __("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&wE.debug("Only the track being published can be inspected")}async generateRequestData(h,g){let{appId:j,cname:_t,cid:_i,vid:_o,sid:ga,uid:_a}=g;const _u=Date.now(),_c=await h.getCurrentFrameImage("image/jpeg",this.quality),_l=await uK(_c,j,_t),_g=this._sequence+"-"+_i+"-"+_a+"-"+_u+"-"+CS(12,""),r_={appId:j,cid:_i,cname:_t,deviceId:"",elapse:b6.intToLong(Number(_u-this._moderationStartTime)),fileSize:_c.buffer.byteLength,height:_c.height,width:_c.width,jpg:_l,networkType:6,osType:7,requestId:_g,sdkVersion:"4.18.3",sequence:this._sequence,sid:ga,timestamp:Vee(_u),uid:_a,vid:_o,service:this._moderationMode,ticket:this._ticket},l_=Pee(r_);if(l_.byteLength<this._workerMessageLengthLimit){if(__("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const d_=function(p_){for(var C_=1;C_<arguments.length;C_++){var O_=arguments[C_]!=null?arguments[C_]:{};C_%2?SK(Object(O_),!0).forEach(function(q_){_h(p_,q_,O_[q_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p_,Object.getOwnPropertyDescriptors(O_)):SK(Object(O_)).forEach(function(q_){Object.defineProperty(p_,q_,Object.getOwnPropertyDescriptor(O_,q_))})}return p_}({},r_);delete d_.jpg,wE.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(d_))}return l_}{const d_=this.quality*this._qualityRatio;return this.quality=d_,await this.generateRequestData(h,{appId:j,cname:_t,cid:_i,vid:_o,sid:ga,uid:_a})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=KT.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=UT.CLOSED,this.emit(pI.STATE_CHANGE,pN.CLOSED)}}var RK,TK,wK,CK,IK,OK,AK,NK,kK,PK,xK,DK,LK,MK,jK,UK,FK,BK,VK,GK,$K,WK,HK,qK,zK,KK,YK,JK,XK,QK,ZK,e7,t7,n7,r7,i7,o7,s7,a7,t0;function c7(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function xL(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?c7(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):c7(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}let Gee=(RK=b0(),TK=b0({argsMap:(d,h)=>(Array.isArray(h)||(h=[h]),h.map(g=>g?Object(g).toString():"null"))}),wK=b0({argsMap:(d,h)=>(h||(h=[]),Array.isArray(h)||(h=[h]),h.map(g=>g.getTrackId()))}),CK=b0({argsMap:(d,h,g)=>[h.uid,g]}),IK=b0({argsMap:(d,h)=>h.map(g=>{let{user:j,mediaType:_t}=g;return[j==null?void 0:j.uid,_t]})}),OK=b0({argsMap:(d,h,g)=>[h.uid,g]}),AK=b0({argsMap:(d,h)=>h.map(g=>{let{user:j,mediaType:_t}=g;return{uid:j==null?void 0:j.uid,mediaType:_t}})}),NK=b0(),kK=b0(),PK=b0(),xK=b0(),DK=b0(),LK=b0(),MK=b0(),jK=b0(),UK=b0(),FK=b0(),BK=b0(),VK=b0(),GK=b0(),$K=b0(),WK=b0({argsMap:(d,h)=>[h]}),HK=b0(),qK=b0(),zK=b0(),KK=b0(),YK=b0(),JK=b0(),XK=b0(),QK=b0(),ZK=b0(),e7=b0(),t7=b0({argsMap:(d,h)=>(Array.isArray(h)||(h=[h]),[JSON.stringify(h)])}),n7=b0(),r7=b0(),i7=b0(),o7=b0(),s7=b0({reportResult:!0}),a7=b0(),G_((t0=class extends US{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get mode(){return this._config.mode}get role(){var d;return((d=this._config)===null||d===void 0?void 0:d.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(d){let h;if(super(),_h(this,"store",void 0),_h(this,"_uid",void 0),_h(this,"_channelName",void 0),_h(this,"_uintUid",void 0),_h(this,"_users",[]),_h(this,"_config",void 0),_h(this,"_clientId",void 0),_h(this,"_appId",void 0),_h(this,"_sessionId",null),_h(this,"_key",void 0),_h(this,"_joinInfo",void 0),_h(this,"_gateway",void 0),_h(this,"_statsCollector",void 0),_h(this,"_configDistribute",void 0),_h(this,"_leaveMutex",new lT("client-leave")),_h(this,"_publishMutex",new lT("client-publish")),_h(this,"_renewTokenMutex",new lT("client-renewtoken")),_h(this,"_subscribeMutex",new lT("client-subscribe")),_h(this,"_encryptionMode","none"),_h(this,"_encryptionSecret",null),_h(this,"_encryptionSalt",null),_h(this,"_proxyServer",void 0),_h(this,"_turnServer",{servers:[],mode:"auto"}),_h(this,"_cloudProxyServerMode","disabled"),_h(this,"_isDualStreamEnabled",!1),_h(this,"_defaultStreamFallbackType",void 0),_h(this,"_lowStreamParameter",void 0),_h(this,"_streamFallbackTypeCacheMap",new Map),_h(this,"_remoteStreamTypeCacheMap",new Map),_h(this,"_axiosCancelSource",KT.CancelToken.source()),_h(this,"_audioVolumeIndicationInterval",void 0),_h(this,"_networkQualityInterval",void 0),_h(this,"_userOfflineTimeout",void 0),_h(this,"_streamRemovedTimeout",void 0),_h(this,"_injectStreamingClient",void 0),_h(this,"_liveTranscodeStreamingClient",void 0),_h(this,"_liveRawStreamingClient",void 0),_h(this,"_channelMediaRelayClient",void 0),_h(this,"_networkQualitySensitivity","normal"),_h(this,"_p2pChannel",void 0),_h(this,"_useLocalAccessPoint",!1),_h(this,"_setLocalAPVersion",void 0),_h(this,"_joinAndNotLeaveYet",!1),_h(this,"_numberOfJoinCount",0),_h(this,"_remoteDefaultVideoStreamType",void 0),_h(this,"_inspect",void 0),_h(this,"_moderation",void 0),_h(this,"_license",void 0),_h(this,"_handleLocalTrackEnable",(g,j,_t)=>{this.publish(g,!1).then(j).catch(_t)}),_h(this,"_handleLocalTrackDisable",(g,j,_t)=>{this.unpublish(g).then(j).catch(_t)}),_h(this,"_handleUserOnline",g=>{if(__("BLOCK_LOCAL_CLIENT")&&e1(g.uid,this.channelName))return void wE.debug("[".concat(g.uid,"] will be ignored in local"));this.isStringUID&&typeof g.uid!="string"&&wE.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const j=this._users.find(_t=>_t.uid===g.uid);if(j)j._trust_in_room_=!0;else{const _t=new F5(g.uid,g.uint_id||g.uid);this._users.push(_t),wE.debug("[".concat(this._clientId,"] user online"),g.uid),this.safeEmit(V0.USER_JOINED,_t)}}),_h(this,"_handleUserOffline",g=>{if(__("BLOCK_LOCAL_CLIENT")&&e1(g.uid,this.channelName))return;const j=this._users.find(_t=>_t.uid===g.uid);j&&(this._handleRemoveStream(g),A5(this._users,j),this._remoteStreamTypeCacheMap.delete(j.uid),this._streamFallbackTypeCacheMap.delete(j.uid),wE.debug("[".concat(this._clientId,"] user offline"),g.uid,"reason:",g.reason),this.safeEmit(V0.USER_LEAVED,j,g.reason))}),_h(this,"_handleAddAudioOrVideoStream",(g,j,_t,_i,_o,ga,_a)=>{if(__("BLOCK_LOCAL_CLIENT")&&e1(j,this.channelName))return;const _u=this._users.find(_l=>_l.uid===j);if(!_u)return void wE.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));wE.debug("[".concat(this._clientId,"] stream added with uid ").concat(j,", type ").concat(g)),this.store.subscribe(_u.uid,g,void 0,void 0,void 0,Date.now());const _c=g==="audio"?_u.hasAudio:_u.hasVideo;_u._uintid||(_u._uintid=_o||j),g==="audio"?_u._trust_audio_stream_added_state_=!0:_u._trust_video_stream_added_state_=!0,g==="audio"?(_u._audio_added_=!0,_t!==void 0&&(_u._audioSSRC=_t),_i!==void 0&&(_u._cname=_i),ga&&(_u._audioOrtc=ga)):(_u._video_added_=!0,_t!==void 0&&(_u._videoSSRC=_t),_i!==void 0&&(_u._cname=_i),_a!==void 0&&(_u._rtxSsrcId=_a),ga&&(_u._videoOrtc=ga)),(g==="audio"?_u.hasAudio:_u.hasVideo)&&!_c&&(wE.info("[".concat(this._clientId,"] remote user ").concat(_u.uid," published ").concat(g)),this.safeEmit(V0.USER_PUBLISHED,_u,g)),g==="video"?p0.onGatewayStream(this._sessionId,xR.ON_ADD_VIDEO_STREAM,FS.ON_ADD_VIDEO_STREAM,{peer:_o||j}):p0.onGatewayStream(this._sessionId,xR.ON_ADD_AUDIO_STREAM,FS.ON_ADD_AUDIO_STREAM,{peer:_o||j}),this._p2pChannel.remoteMediaSsrcChanged(_u,g,_t).then(_l=>{if(_l)return wE.debug("[".concat(this._clientId,"] resubscribe ").concat(g," for user ").concat(_u.uid," after rejoin because SSRC id changed.")),this._p2pChannel.unsubscribe(_u,g,!0).then(()=>this._subscribe(_u,g,!0).catch(_g=>{wE.error("[".concat(this._clientId,"] resubscribe error"),_g.toString())}))}),this._p2pChannel.hasPendingRemoteMedia(_u,g)&&(wE.debug("[".concat(this._clientId,"] resubscribe ").concat(g," for user ").concat(_u.uid," after reconnect.")),this._subscribe(_u,g,!0).catch(_l=>{wE.error("[".concat(this._clientId,"] resubscribe error"),_l.toString())}))}),_h(this,"_handleRemoveStream",g=>{if(__("BLOCK_LOCAL_CLIENT")&&e1(g.uid,this.channelName))return;const j=this._users.find(_i=>_i.uid===g.uid);if(!j)return void wE.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));wE.debug("[".concat(this._clientId,"] stream removed with uid ").concat(g.uid));let _t=()=>{};j.hasAudio&&j.hasVideo?_t=()=>{wE.info("[".concat(this._clientId,"] remote user ").concat(j.uid," unpublished audio track")),this.safeEmit(V0.USER_UNPUBLISHED,j,"audio"),wE.info("[".concat(this._clientId,"] remote user ").concat(j.uid," unpublished video track")),this.safeEmit(V0.USER_UNPUBLISHED,j,"video")}:j.hasVideo?_t=()=>{wE.info("[".concat(this._clientId,"] remote user ").concat(j.uid," unpublished video track")),this.safeEmit(V0.USER_UNPUBLISHED,j,"video")}:j.hasAudio&&(_t=()=>{wE.info("[".concat(this._clientId,"] remote user ").concat(j.uid," unpublished audio track")),this.safeEmit(V0.USER_UNPUBLISHED,j,"audio")}),j._trust_audio_stream_added_state_=!0,j._trust_video_stream_added_state_=!0,j._audio_added_=!1,j._video_added_=!1,this._p2pChannel.unsubscribe(j).then(_i=>{if(_i)return this._gateway.unsubscribe(_i,j.uid)}),j._audioSSRC=void 0,j._videoSSRC=void 0,j._audioOrtc=void 0,j._videoOrtc=void 0,j._rtxSsrcId=void 0,p0.onGatewayStream(this._sessionId,xR.ON_REMOVE_STREAM,FS.ON_REMOVE_STREAM,{peer:g.uint_id||g.uid}),_t()}),_h(this,"_handleSetStreamLocalEnable",(g,j,_t)=>{if(__("BLOCK_LOCAL_CLIENT")&&e1(j,this.channelName))return;const _i=this._users.find(_a=>_a.uid===j);if(!_i)return void wE.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));wE.debug("[".concat(this._clientId,"] local ").concat(g," ").concat(_t?"enabled":"disabled"," with uid ").concat(j));const _o=g==="audio"?_i.hasAudio:_i.hasVideo;if(g==="audio"){_i._trust_audio_enabled_state_=!0;const _a=_i._audio_enabled_;if(_i._audio_enabled_=_t,_i._audio_enabled_===_a)return;{const _u=_i._audio_enabled_?"enable-local-audio":"disable-local-audio";wE.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(j,", msg: ").concat(_u)),this.safeEmit(V0.USER_INFO_UPDATED,j,_u)}}else{_i._trust_video_enabled_state_=!0;const _a=_i._video_enabled_;if(_i._video_enabled_=_t,_i._video_enabled_===_a)return;{const _u=_i._video_enabled_?"enable-local-video":"disable-local-video";wE.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(j,", msg: ").concat(_u)),this.safeEmit(V0.USER_INFO_UPDATED,j,_u)}}const ga=g==="audio"?_i.hasAudio:_i.hasVideo;return _o!==ga?!_o&&ga?(wE.info("[".concat(this._clientId,"] remote user ").concat(j," published ").concat(g)),void this.safeEmit(V0.USER_PUBLISHED,_i,g)):(g==="video"&&_i._videoTrack&&_i._videoTrack._destroy(),g==="audio"&&_i._audioTrack,this._p2pChannel.muteRemote(_i,g),wE.info("[".concat(this._clientId,"] remote user ").concat(j," unpublished ").concat(g)),void this.safeEmit(V0.USER_UNPUBLISHED,_i,g)):void 0}),_h(this,"_handleMuteStream",(g,j,_t)=>{if(__("BLOCK_LOCAL_CLIENT")&&e1(g,this.channelName))return;wE.debug("[".concat(this._clientId,"] receive mute message"),g,j,_t);const _i=this._users.find(_a=>_a.uid===g);if(!_i)return void wE.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(g));const _o=j==="audio"?_i.hasAudio:_i.hasVideo;if(j==="audio"){_i._trust_audio_mute_state_=!0;const _a=_i._audio_muted_;if(_i._audio_muted_=_t,_i._audio_muted_===_a)return;{const _u=_i._audio_muted_?"mute-audio":"unmute-audio";wE.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(g,", msg: ").concat(_u)),this.safeEmit(V0.USER_INFO_UPDATED,g,_u)}}else{_i._trust_video_mute_state_=!0;const _a=_i._video_muted_;if(_i._video_muted_=_t,_i._video_muted_===_a)return;{const _u=_i._video_muted_?"mute-video":"unmute-video";wE.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(g,", msg: ").concat(_u)),this.safeEmit(V0.USER_INFO_UPDATED,g,_u)}}const ga=j==="audio"?_i.hasAudio:_i.hasVideo;if(_o!==ga){if(!_o&&ga)return(j==="audio"?_i._audioSSRC:_i._videoSSRC)?(wE.info("[".concat(this._clientId,"] remote user ").concat(g," published ").concat(j)),void this.safeEmit(V0.USER_PUBLISHED,_i,j)):void wE.warning("[".concat(this._clientId,"] remote user ").concat(g," receive ").concat(j," unmute message  before add stream message, ").concat(j," SSRC doesn't exist yet."));j==="video"&&_i._videoTrack&&_i._videoTrack._destroy(),j==="audio"&&_i._audioTrack,this._p2pChannel.muteRemote(_i,j),wE.info("[".concat(this._clientId,"] remote user ").concat(g," unpublished ").concat(j)),this.safeEmit(V0.USER_UNPUBLISHED,_i,j)}}),_h(this,"_handleP2PLost",async g=>{wE.debug("[".concat(this._clientId,"] receive p2p lost"),g),parseInt(g.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():wE.warning("[".concat(this._clientId,"] P2PLost stream not found"),g)}),_h(this,"_handleTokenWillExpire",()=>{wE.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(V0.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)}),_h(this,"_handleBeforeUnload",g=>{g.type==="beforeunload"&&g.returnValue!==void 0&&g.returnValue!==""||(this.leave(),wE.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))}),_h(this,"_handleUpdateNetworkQuality",()=>{if(this._networkQualitySensitivity==="normal")return;if(navigator&&navigator.onLine!==void 0&&!navigator.onLine)return void this.safeEmit(V0.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const g={downlinkNetworkQuality:0,uplinkNetworkQuality:0};g.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),g.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(V0.NETWORK_QUALITY,g)}),this._config=d,this._clientId=CS(5,"client-"),this.store=new yee(d.codec,d.audioCodec,d.mode,this._clientId),this.store.clientCreated(),d.proxyServer&&this.setProxyServer(d.proxyServer,!0),d.turnServer&&this.setTurnServer(d.turnServer,!0),wE.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(dI," build: ").concat(W3,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),d.clientRoleOptions)try{A4(d.clientRoleOptions),h=Object.assign({},d.clientRoleOptions)}catch(g){wE.warning("[".concat(this._clientId,"] ").concat(g.toString()))}this._statsCollector=new iP(this.store),this._statsCollector.onStatsException=(g,j,_t)=>{wE.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(g,", msg: ").concat(j,", uid: ").concat(_t)),this.safeEmit(V0.EXCEPTION,{code:g,msg:j,uid:_t})},this._statsCollector.onUploadPublishDuration=(g,j,_t,_i)=>{const _o=this._users.find(ga=>ga.uid===g);_o&&p0.peerPublishStatus(this._sessionId,{subscribeElapse:_i,audioPublishDuration:j,videoPublishDuration:_t,peer:_o._uintid})},this.store.useDataChannel=QS().supportDataChannel&&__("SIGNAL_CHANNEL"),this._gateway=new iZ(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:d.websocketRetryConfig||rR,httpRetryConfig:d.httpRetryConfig||rR,forceWaitGatewayResponse:d.forceWaitGatewayResponse===void 0||d.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:d.role,clientRoleOptions:h}),this._configDistribute=new hZ,this._p2pChannel=new _ee(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async join(d,h,g,j,_t){const _i=++this._numberOfJoinCount;this.store.joinStart(),j&&(this.store.uid=j);const _o=bee(),ga=tK()?window.isSecureContext:"Browser Not Support";if(!tK()&&!_o||!window.isSecureContext){const r_="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";wE.warning(r_)}const _a=O5();this.connectionState==="DISCONNECTED"&&(this.store.avoidJoinStart=Math.round(Date.now()),wE.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)));const _u=p0.reportApiInvoke(_a,{name:iR.JOIN,options:[d,h,g,j],states:{isHttps:_o,isSecureContext:ga},tag:kS.TRACER});p0.setAppId(d);try{if(!g&&g!==null)throw new f_(c_.INVALID_PARAMS,"Invalid token: ".concat(g,". If you don not use token, set it to null"));g&&GR(g,"token",1,2047),GR(d,"appid",1,2047),e5(h),j&&t5(j),_t&&GR(_t,"optionalInfo",1,2047)}catch(r_){throw _u.onError(r_),r_}if(wE.info("[".concat(this._clientId,"] start join channel ").concat(h,", join number: ").concat(_i)),this._leaveMutex.isLocked&&(wE.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),wE.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,this.connectionState!=="DISCONNECTED"){const r_=new f_(c_.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw _u.onError(r_),r_}this._sessionId||(this._sessionId=_a,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const _c=xL({clientId:this._clientId,appId:d,sid:this._sessionId,cname:h,uid:typeof j!="string"?j:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:g||d,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:_t,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint},this._remoteDefaultVideoStreamType!==void 0&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(this._useLocalAccessPoint&&(_c.setLocalAPVersion=this._setLocalAPVersion),typeof j=="string"&&(_c.stringUid=j,this._uintUid?(_c.uid=this._uintUid,this._uintUid=void 0):_c.uid=0),this._encryptionMode!=="none"&&this._encryptionSecret){if(_c.aesmode=this._encryptionMode,_c.aespassword=await(async r_=>{const l_=N5(`MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu
STM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+
HvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy
xQiYDz3vqa6bP29adwIDAQAB`),d_=await window.crypto.subtle.importKey("spki",l_,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),p_=v5(r_),C_=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},d_,p_);return FU(new Uint8Array(C_))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new f_(c_.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(_c.aessalt=this._encryptionSalt)}this._startSession(this._sessionId,{channel:h,appId:d});const _l=this._sessionId;setTimeout(()=>{this.connectionState==="CONNECTING"&&_l===this._sessionId&&p0.joinChannelTimeout(this._sessionId,5)},5e3);try{let r_;const l_=_c.cloudProxyServer;if(["proxy3","proxy4","proxy5"].includes(l_)){const O_=__("PROXY_SERVER_TYPE3");Array.isArray(O_)?_c.proxyServer=O_[0]:_c.proxyServer=O_}if(p0.setProxyServer(_c.proxyServer),wE.setProxyServer(_c.proxyServer),this.store.requestAPStart(),_c.stringUid&&!_c.uid){const O_=await LW(_c.stringUid,_c,this._axiosCancelSource.token,this._config.httpRetryConfig||rR,this.store);wE.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(_c.stringUid," => ").concat(O_)),_c.uid=O_,r_=await DW(_c,this._axiosCancelSource.token,this._config.httpRetryConfig||rR,!0,this.store)}else r_=await DW(_c,this._axiosCancelSource.token,this._config.httpRetryConfig||rR,!0,this.store);if(!this._joinAndNotLeaveYet)throw new f_(c_.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),setTimeout(()=>{this._configDistribute.startGetConfigDistribute(_c,this._axiosCancelSource.token),this._configDistribute.on(gL.UPDATE_BITRATE_LIMIT,O_=>{this._p2pChannel.updateBitrateLimit(O_)})},0),this._key=g||d;const d_=r_.gatewayInfo;this._joinInfo=xL(xL({},_c),{},{cid:d_.cid,uid:_c.uid?_c.uid:d_.uid,vid:d_.vid,apResponse:d_.res,uni_lbs_ip:d_.uni_lbs_ip,gatewayAddrs:d_.gatewayAddrs});const p_=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new f_(c_.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));_u.onSuccess(p_),this._appId=d,this._channelName=_c.cname,this._uid=p_,this.store.uid=p_,setTimeout(()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(sT()?"beforeunload":"pagehide",this._handleBeforeUnload)},0);const C_=_c.stringUid?"string uid: ".concat(_c.stringUid,",uid: ").concat(_c.uid):"uid: ".concat(this._uid);return wE.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(h,",").concat(C_)),setTimeout(()=>{wE.startUpload()},5e3),this.store.joinEnd(),_g=this,ZN.includes(_g)||ZN.push(_g),p_}catch(r_){const l_=Array.isArray(r_)?r_[0]:r_;throw l_&&l_.code===c_.OPERATION_ABORTED?wE.warning("[".concat(this._clientId,"] join number: ").concat(_i,", Joining channel failed, rollback"),l_):wE.error("[".concat(this._clientId,"] join number: ").concat(_i,", Joining channel failed, rollback"),l_),l_.code!==c_.OPERATION_ABORTED&&this._numberOfJoinCount===_i&&(this._gateway.state="DISCONNECTED",this._reset()),_u.onError(l_),l_}var _g}_joinGateway(){if(!this._joinInfo||!this._key)throw new f_(c_.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!(this._joinInfo.cloudProxyServer!=="disabled"||this._joinInfo.proxyServer||!__("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then(d=>d).catch(d=>{if(d.code===c_.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,aS.FALLBACK),d;if(d.code===c_.INIT_DATACHANNEL_TIMEOUT)return this._gateway.leave(!0,aS.FALLBACK),d;throw d}).then(d=>{if(d instanceof f_){if(d.code===c_.INIT_WEBSOCKET_TIMEOUT){if(wE.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new f_(c_.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const h=__("PROXY_SERVER_TYPE3");if(Array.isArray(h))if(this._joinInfo.apUrl){const j=/^https?:\/\/(.+?)(\/.*)?$/.exec(this._joinInfo.apUrl)[1].split("."),_t=j.slice(j.length-2).join(".");h.forEach(_i=>{this._joinInfo&&_i.includes(_t)&&(this._joinInfo.proxyServer=_i)}),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=h[0])}else this._joinInfo.proxyServer=h[0];else this._joinInfo.proxyServer=h;const g=__("LOG_UPLOAD_SERVER").match(/.+:(\d{1,5})$/);return g&&g[1]&&g[1]!=="443"&&wE.setProxyServer(this._joinInfo.proxyServer),__("STATS_COLLECTOR_PORT").toString()!=="443"&&p0.setProxyServer(this._joinInfo.proxyServer),p0.reportApiInvoke(this._sessionId,{name:iR.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:kS.TRACER}).onSuccess(),this.safeEmit(V0.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),__("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&this._joinInfo.turnServer.servers.forEach(j=>{"forceturn"in j&&(j.forceturn=!0)}),this._gateway.join(this._joinInfo,this._key)}if(wE.info("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new f_(c_.INVALID_OPERATION);return p0.reportApiInvoke(this._sessionId,{name:iR.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:kS.TRACER}).onSuccess(),this._joinGateway()}return d}).then(d=>d)}async leave(){wE.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(sT()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(h){const g=ZN.indexOf(h);g!==-1&&ZN.splice(g,1)}(this);const d=await this._leaveMutex.lock();if(this.connectionState==="DISCONNECTED")return wE.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void d();await this._gateway.leave(this.connectionState!=="CONNECTED"),wE.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),d()}async publish(d){let h=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(Array.isArray(d)||(d=[d]),d.length===0)throw new f_(c_.INVALID_PARAMS,"track list is empty");if(this._gateway.role==="audience")throw new f_(c_.INVALID_OPERATION,"audience can not publish stream");for(const j of d){if(!(j instanceof _5))throw new f_(c_.INVALID_PARAMS,"parameter is not local track");if(!j._enabled&&h)throw new f_(c_.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(j.getTrackId()))}wE.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(d.map(j=>"".concat(j.getTrackId()," "))));const g=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),h&&d.forEach(j=>{const _t=this._configDistribute.getBitrateLimit();j instanceof cR&&_t&&j.setBitrateLimit(_t.uplink)});try{await this._publishHighStream(d),wE.info("[".concat(this._clientId,"] Publish success, id ").concat(d.map(j=>"".concat(j.getTrackId()," "))))}catch(j){throw wE.error("[".concat(this._clientId,"] publish error"),j.toString()),j}finally{g()}}async unpublish(d){if(!this._joinInfo||this._uid===void 0)throw new f_(c_.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");d?Array.isArray(d)||(d=[d]):d=this._p2pChannel.getAllTracks(!0),wE.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(d.map(g=>"".concat(g.getTrackId()," "))," "));const h=await this._publishMutex.lock();try{const g=await this._p2pChannel.unpublish(d);g&&await this._gateway.unpublish(g,this._uid),wE.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(d.map(j=>"".concat(j.getTrackId()))))}catch(g){throw wE.error("[".concat(this._clientId,"] unpublish error"),g.toString()),g}finally{h&&h()}}async subscribe(d,h){return this._subscribe(d,h)}async _subscribe(d,h,g){if(IR(h,"mediaType",["audio","video"]),!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new f_(c_.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find(_a=>_a===d)){const _a=new f_(c_.INVALID_REMOTE_USER,"user is not in the channel");throw wE.error("[".concat(this._clientId,"] can not subscribe ").concat(d.uid,", this user is not in the channel")),_a}if(!d.hasAudio&&!d.hasVideo){const _a=new f_(c_.INVALID_REMOTE_USER,"user is not published");throw wE.error("[".concat(this._clientId,"] can not subscribe ").concat(d.uid,", user is not published")),_a}if(!(g||(h!=="audio"||d.hasAudio&&d._audioSSRC!==void 0)&&(h!=="video"||d.hasVideo&&d._videoSSRC!==void 0))){const _a=new f_(c_.REMOTE_USER_IS_NOT_PUBLISHED);throw wE.error("[".concat(this._clientId,"] can not subscribe ").concat(d.uid," with mediaType ").concat(h,", remote track is not published")),_a}const j=h==="audio"?d._audioSSRC:d._videoSSRC,_t=h==="audio"?d._audioOrtc:d._videoOrtc,_i=h==="video"?d._rtxSsrcId:void 0,_o={stream_type:h==="audio"?L0.AUDIO:L0.VIDEO,ssrcId:j},ga=await this._subscribeMutex.lock();wE.info("[".concat(this._clientId,"] subscribe user ").concat(d.uid,", mediaType: ").concat(h));try{if(await this._p2pChannel.hasRemoteMediaWithLock(d,h))await this._p2pChannel.unmuteRemote(d,h);else try{hI.markSubscribeStart(this.store.clientId,j),this.store.subscribe(d.uid,h,Date.now()),await this._p2pChannel.subscribe(d,h,j,_i,_t);try{await this._gateway.subscribe(d.uid,_o,!0)}catch(_u){if((_u==null?void 0:_u.code)!==c_.WS_ABORT)throw await this._p2pChannel.unsubscribe(d,h),_u;await this._p2pChannel.unsubscribe(d,h,!0),this._p2pChannel.setPendingRemoteMedia(d,h)}this.store.subscribe(d.uid,h,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,d,h)}catch(_u){throw this._p2pChannel.reportSubscribeEvent(!1,_u==null?void 0:_u.code,d,h),_u}wE.info("[".concat(this._clientId,"] subscribe success user ").concat(d.uid,", mediaType: ").concat(h)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(d.uid,this._defaultStreamFallbackType).catch(_u=>{wE.warning("[".concat(this._clientId,"] auto set fallback failed"),_u)});const _a=h==="audio"?d._audioTrack:d._videoTrack;if(!_a)throw new f_(c_.UNEXPECTED_ERROR,"can not find remote track in user object");return _a}catch(_a){throw wE.error("[".concat(this._clientId,"] subscribe user ").concat(d.uid," error"),_a),_a}finally{ga()}}async massSubscribe(d){if(UO(d,"subscribeList"),!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"Can't subscribe stream, not joined");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new f_(c_.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const h=Date.now(),g=new Map,j=await this._subscribeMutex.lock();wE.info("[".concat(this._clientId,"]start massSubscribe user ").concat(d.map(ga=>{let{user:_a,mediaType:_u}=ga;return"user: ".concat(_a==null?void 0:_a.uid,", mediaType: ").concat(_u)}).join("; ")));const _t=(d=[...d]).map(ga=>{let{user:_a,mediaType:_u}=ga;return{user:_a,mediaType:_u}}),_i=await this._p2pChannel.globalLock();try{var _o;for(let _a=d.length-1;_a>=0;_a--){const _u=d[_a],{user:_c,mediaType:_l}=_u;if(IR(_l,"mediaType",["audio","video"]),!_c){const l_=new f_(c_.INVALID_PARAMS,"user property does not exist in subscribeList item");throw wE.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),l_}if(!this._users.find(l_=>l_===_c)){const l_=new f_(c_.INVALID_REMOTE_USER,"user is not in the channel");wE.error("[".concat(this._clientId,"] can not massSubscribe ").concat(_c.uid,", this user is not in the channel")),_t[_a].error=l_,d.splice(_a,1);continue}if(_l==="audio"&&(!_c.hasAudio||_c._audioSSRC===void 0)||_l==="video"&&(!_c.hasVideo||_c._videoSSRC===void 0)){const l_=new f_(c_.REMOTE_USER_IS_NOT_PUBLISHED);wE.error("[".concat(this._clientId,"] can not subscribe ").concat(_c.uid," with mediaType ").concat(_l,", remote user is not published")),_t[_a].error=l_,d.splice(_a,1);continue}const _g=oR.Video|oR.LwoVideo,r_=g.get(_c);if(r_){if(_l==="video"?r_&_g:r_&oR.Audio){d.splice(_a,1),wE.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(_c.uid,", mediaType:").concat(_l," twice"));continue}g.set(_c,r_|(_l==="video"?_g:oR.Audio))}else g.set(_c,_l==="video"?_g:oR.Audio)}for(let _a=d.length-1;_a>=0;_a--){const _u=d[_a],{user:_c,mediaType:_l}=_u,_g=oR.Video|oR.LwoVideo;if(this._p2pChannel.hasRemoteMedia(_c,_l)){await this._p2pChannel.unmuteRemoteNoLock(_c,_l);const r_=g.get(_c);g.set(_c,_l==="video"?r_^_g:r_^oR.Audio),d.splice(_a,1)}}this.store.massSubscribe(d.map(_a=>({userId:_a.user.uid,type:_a.mediaType})),h);const ga=WI(_o=Array.from(g.entries())).call(_o,(_a,_u)=>{let[_c,_l]=_u;if(_l===0)return _a;const _g={stream_id:_c.uid,stream_type:_l};return _l&oR.Audio&&(_g.audio_ssrc=_c._audioSSRC),_l&oR.Video&&(_g.video_ssrc=_c._videoSSRC),_a.push(_g),_a},[]);try{d.length>0&&await this._p2pChannel.massSubscribeNoLock(d.map(_u=>{let{user:_c,mediaType:_l}=_u;return{user:_c,mediaType:_l,ssrcId:_l===L0.VIDEO?_c._videoSSRC:_c._audioSSRC,rtxSsrcId:_l===L0.VIDEO?_c._rtxSsrcId:void 0}}));const _a=new Map;if(ga.length>0){const _u=await this._gateway.subscribeAll(ga,!0);((_u==null?void 0:_u.users)||[]).forEach(_c=>{let{stream_id:_l,video_error_code:_g,audio_error_code:r_,error_code:l_}=_c;(_g||r_||l_)&&_a.set(_l,{video_error_code:_g,audio_error_code:r_,error_code:l_})})}if(Array.from(_a.entries()).length>0){const _u=Array.from(_a.entries()).map(_c=>{let _l,[_g,r_]=_c;return r_.error_code||r_.video_error_code&&r_.audio_error_code?_l=void 0:r_.video_error_code?_l=L0.VIDEO:r_.audio_error_code&&(_l=L0.AUDIO),{user:this.remoteUsers.find(l_=>l_.uid===_g),mediaType:_l}});await this._p2pChannel.massUnsubscribeNoLock(_u)}for(const _u of _t){const _c=_a.get(_u.user.uid);if(_c){const _l=_c.error_code||_u.mediaType==="audio"&&_c.audio_error_code||_u.mediaType==="video"&&_c.video_error_code;if(_l){const _g=yL(_l);wE.error("user:".concat(_u.user.uid," mediaType:").concat(_u.mediaType," has massSubscribe error ").concat(_g.desc)),_u.error=new f_(c_.SUBSCRIBE_FAILED,"code ".concat(_l,": ").concat(_g.desc))}}_u.error||(_u.mediaType==="video"?_u.track=_u.user.videoTrack:_u.track=_u.user.audioTrack)}return this.store.massSubscribe(_t.filter(_u=>!_u.error).map(_u=>({userId:_u.user.uid,type:_u.mediaType})),void 0,Date.now()),_t.forEach(_u=>{var _c;p0.subscribe(this.store.sessionId,{succ:!!_u.error,ec:((_c=_u.error)===null||_c===void 0?void 0:_c.code)||null,video:_u.mediaType===L0.VIDEO,audio:_u.mediaType===L0.AUDIO,peerid:_u.user.uid,subscribeRequestid:_u.mediaType===L0.VIDEO?_u.user._videoSSRC:_u.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-h)},!0)}),wE.info("[".concat(this._clientId,"] massSubscribe success ").concat(d.map(_u=>{let{user:_c,mediaType:_l}=_u;return"user: ".concat(_c==null?void 0:_c.uid,", mediaType: ").concat(_l)}).join("; "))),_t}catch(_a){throw await this._p2pChannel.massUnsubscribeNoLock(d),_a}}finally{_i(),j()}}async unsubscribe(d,h){if(h&&IR(h,"mediaType",["audio","video"]),!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find(j=>j===d)){const j=new f_(c_.INVALID_REMOTE_USER,"user is not in the channel");throw wE.error("[".concat(this._clientId,"] can not unsubscribe ").concat(d.uid,", user is not in the channel")),j}wE.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(d.uid,", mediaType: ").concat(h));const g=await this._subscribeMutex.lock();try{const j=await this._p2pChannel.unsubscribe(d,h);j&&await this._gateway.unsubscribe(j,d.uid),wE.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(d.uid,", mediaType: ").concat(h))}catch(j){if(j.code===c_.DISCONNECT_P2P)return void wE.warning("disconnecting p2p, abort unsubscribe request.");throw wE.error("[".concat(this._clientId,"] unsubscribe user ").concat(d.uid," error"),j.toString()),j}finally{g()}}async massUnsubscribe(d){if(UO(d,"unsubscribeList"),!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");wE.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(d.map(g=>{let{user:j,mediaType:_t}=g;return"user: ".concat(j==null?void 0:j.uid,", mediaType: ").concat(_t,";")}).join())),d=[...d];const h=new Map;for(let g=d.length-1;g>=0;g--){const{user:j,mediaType:_t}=d[g];if(!j){const _o=new f_(c_.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw wE.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),_o}if(IR(_t,"mediaType",["video","audio",void 0]),!this._users.find(_o=>_o===j)){wE.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(j.uid,", user is not in the channel")),d.splice(g,1);continue}const _i=oR.Video|oR.LwoVideo;if(h.has(j)){const _o=h.get(j);let ga;switch(_t){case"video":ga=_o&_i;break;case"audio":ga=_o&oR.Audio;break;default:ga=_o&(oR.Audio|_i)}if(ga){wE.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(j.uid,",mediaType:").concat(_t," twice.")),d.splice(g,1);continue}_t?_t==="audio"?h.set(j,_o|oR.Audio):_t==="video"&&h.set(j,_o|_i):h.set(j,_o|oR.Audio|_i)}else _t?_t==="audio"?h.set(j,oR.Audio):_t==="video"&&h.set(j,_i):h.set(j,oR.Audio|_i)}try{const g=await this._p2pChannel.massUnsubscribe(d);g&&await this._gateway.massUnsubscribe(g),wE.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(d.map(j=>{let{user:_t,mediaType:_i}=j;return"user: ".concat(_t==null?void 0:_t.uid,", mediaType: ").concat(_i,";")}).join()))}catch(g){if(g.code===c_.DISCONNECT_P2P)return void wE.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw wE.error("[".concat(this._clientId,"] massUnsubscribe error"),g.toString()),g}}setLowStreamParameter(d){(function(g){if(!g)throw new f_(c_.INVALID_PARAMS);AS(g.width)||Z3(g.width,"streamParameter.width"),AS(g.height)||Z3(g.height,"streamParameter.height"),AS(g.framerate)||Z3(g.framerate,"streamParameter.framerate"),AS(g.bitrate)||SS(g.bitrate,"streamParameter.bitrate")})(d),(!d.width&&d.height||d.width&&!d.height)&&wE.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),wE.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(d));const h=this._configDistribute.getLowStreamConfigDistribute();h&&h.bitrate&&d.bitrate&&h.bitrate<d.bitrate&&(d.bitrate=h.bitrate),this._lowStreamParameter=d}async enableDualStream(){if(!QS().supportDualStream)throw p0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new f_(c_.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new f_(c_.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(d){throw p0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),d}this._isDualStreamEnabled=!0,p0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),wE.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(l0.LocalVideoLowTrack))try{const d=await this._p2pChannel.unpublishLowStream();d&&await this._gateway.unpublish(d,this._joinInfo.stringUid||this._joinInfo.uid)}catch(d){throw p0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),d}this._isDualStreamEnabled=!1,p0.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),wE.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(d,h){if(function(g){IR(g,"role",["audience","host"])}(d),h&&A4(h),this.mode==="rtc")throw wE.warning("[".concat(this._clientId,"]rtc mode can not use setClientRole")),new f_(c_.INVALID_OPERATION,"rtc mode can not use setClientRole");if(h&&h.level&&d==="host")throw new f_(c_.INVALID_OPERATION,"host mode can not set audience latency level");if(d==="audience"&&this._p2pChannel.hasLocalMedia())throw new f_(c_.INVALID_OPERATION,"can not set client role to audience when publishing stream");await this._gateway.setClientRole(d,h),this._config.role=d,wE.info("[".concat(this._clientId,"] set client role to ").concat(d,", level: ").concat(h&&h.level))}setProxyServer(d,h){if(GR(d,"proxyServer"),!h){if(this.connectionState!=="DISCONNECTED")throw new f_(c_.INVALID_OPERATION,"Set proxy server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new f_(c_.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=d,p0.setProxyServer(this._proxyServer),wE.setProxyServer(this._proxyServer),wE.info("[".concat(this._clientId,"] Set proxy server ").concat(h?"by initialize call":""," success."))}setTurnServer(d,h){if(Array.isArray(d)||(d=[d]),!h){if(this.connectionState!=="DISCONNECTED")throw new f_(c_.INVALID_OPERATION,"Set turn server before join channel");if(this._cloudProxyServerMode!=="disabled"||this._useLocalAccessPoint)throw new f_(c_.INVALID_OPERATION,"You have already set the proxy")}if(fL(d))return this._turnServer={servers:d,mode:"original-manual"},void wE.info("[".concat(this._clientId,"] Set original turnserver ").concat(h?"by initialize call":""," success: ").concat(d.map(g=>g.urls).join(","),"."));d.forEach(g=>O4(g)),this._turnServer={servers:d,mode:"manual"},wE.info("[".concat(this._clientId,"] Set turnserver ").concat(h?"by initialize call":""," success."))}setLicense(d){if(this.connectionState!=="DISCONNECTED")throw new f_(c_.INVALID_OPERATION,"you should set license before join channel");if(GR(d,"license",32,32),!/^[A-Za-z\d]+$/.test(d))throw new f_(c_.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=d,wE.info("[".concat(this._clientId,"] set license success"),d)}startProxyServer(d){if(this.connectionState!=="DISCONNECTED")throw new f_(c_.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||this._turnServer.mode==="manual"||this._useLocalAccessPoint)throw new f_(c_.INVALID_OPERATION,"You have already set the proxy");const h=[3,4,5];let g;switch(d===void 0&&(d=3),d){case 1:case 2:throw new f_(c_.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:g="proxy3";break;case 4:g="proxy4";break;case 5:g="proxy5";break;default:throw new f_(c_.INVALID_PARAMS,"proxy server mode must be ".concat(h.join("|")))}this._cloudProxyServerMode=g,this.store.cloudProxyServerMode=g,wE.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if(this.connectionState!=="DISCONNECTED")throw new f_(c_.INVALID_OPERATION,"Stop proxy server after leave channel");p0.setProxyServer(),wE.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",wE.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(d){if(!d.accessPoints)throw new f_(c_.INVALID_PARAMS,"accessPoints is required.");UO(d.accessPoints.serverList,"accessPoints.serverList"),GR(d.accessPoints.domain,"accessPoints.domain");const h=(_g,r_)=>{SS(_g,r_,0,65535,!0)};let g=443;if(d.accessPoints.port&&(h(d.accessPoints.port,"accessPoints.port"),g=d.accessPoints.port),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new f_(c_.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");__("CLOSE_AFB_FOR_LOCAL_AP")&&(ES("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),ES("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const j=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,_t=d.accessPoints.domain,_i=d.accessPoints.serverList.map(_g=>j.test(_g)?"".concat(_g.replace(/\./g,"-"),".").concat(_t):_g),_o=_i.map(_g=>"".concat(_g,":").concat(g));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,ES("WEBCS_DOMAIN",_o),ES("WEBCS_DOMAIN_BACKUP_LIST",_o),ES("GATEWAY_DOMAINS",[_t]),d.report&&d.report.hostname&&Array.isArray(d.report.hostname)&&d.report.hostname.length?(UO(d.report.hostname,"report.hostname"),ES("EVENT_REPORT_DOMAIN",d.report.hostname[0]),ES("EVENT_REPORT_BACKUP_DOMAIN",d.report.hostname[1]||d.report.hostname[0])):(ES("EVENT_REPORT_DOMAIN",_i[0]),ES("EVENT_REPORT_BACKUP_DOMAIN",_i[1]||_i[0]));let ga=6443;d.report&&d.report.port&&(h(d.report.port,"report.port"),ga=d.report.port),ES("STATS_COLLECTOR_PORT",ga),d.report?ES("ENABLE_EVENT_REPORT",!0):ES("ENABLE_EVENT_REPORT",!1);let _a="";d.log&&d.log.hostname&&Array.isArray(d.log.hostname)&&d.log.hostname.length?(UO(d.log.hostname,"log.hostname"),_a=d.log.hostname[0]):_a=_i[0];let _u=6444;d.log&&d.log.port&&(h(d.log.port,"log.port"),_u=d.log.port),ES("LOG_UPLOAD_SERVER","".concat(_a,":").concat(_u));let _c=[];d.cds&&d.cds.hostname&&Array.isArray(d.cds.hostname)&&d.cds.hostname.length?(UO(d.cds.hostname,"cds.hostname"),_c=d.cds.hostname):_c=_i;let _l=443;d.cds&&d.cds.port&&(h(d.cds.port,"cds.port"),_l=d.cds.port),ES("CDS_AP",_c.map(_g=>"".concat(_g,":").concat(_l))),d.cds?ES("ENABLE_CONFIG_DISTRIBUTE",!0):ES("ENABLE_CONFIG_DISTRIBUTE",!1),wE.info("set local access point v2 success")}setLocalAccessPoints(d,h){if(UO(d,"serverList"),GR(h,"domain"),this._proxyServer||this._cloudProxyServerMode!=="disabled")throw new f_(c_.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const g=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;d=d.map(j=>g.test(j)?"".concat(j.replace(/\./g,"-"),".").concat(h):j),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,ES("WEBCS_DOMAIN",d),ES("WEBCS_DOMAIN_BACKUP_LIST",d),ES("GATEWAY_DOMAINS",[h]),ES("EVENT_REPORT_DOMAIN",d[0]),ES("EVENT_REPORT_BACKUP_DOMAIN",d[1]||d[0]),ES("LOG_UPLOAD_SERVER","".concat(d[0],":6444")),wE.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(d){if(IR(d,"streamType",[0,1]),this._remoteDefaultVideoStreamType=d,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(d),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(h){throw wE.error("[".concat(this._clientId,"] set default remote video stream type error"),h.toString()),h}else wE.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(d))}async setRemoteVideoStreamType(d,h){IR(h,"streamType",[0,1]);try{await this._gateway.setRemoteVideoStreamType(d,h),setTimeout(()=>{const g=this._users.find(j=>j.uid===d);g&&g.videoTrack&&g.videoTrack.updateMediaStreamTrackResolution()},2e3)}catch(g){throw wE.error("[".concat(this._clientId,"] set remote video stream type error"),g.toString()),g}wE.info("[".concat(this._clientId,"] set remote ").concat(d," video stream type to ").concat(h)),this._remoteStreamTypeCacheMap.set(d,h)}async setStreamFallbackOption(d,h){IR(h,"fallbackType",[0,1,2]);try{await this._gateway.setStreamFallbackOption(d,h)}catch(g){throw wE.error("[".concat(this._clientId,"] set stream fallback option"),g.toString()),g}wE.info("[".concat(this._clientId,"] set remote ").concat(d," stream fallback type to ").concat(h)),this._streamFallbackTypeCacheMap.set(d,h)}setEncryptionConfig(d,h,g){if(function(j){IR(j,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])}(d),GR(h,"secret"),["aes-128-gcm2","aes-256-gcm2"].includes(d)){if(!g||!(g instanceof Uint8Array&&g.length===32))throw new f_(c_.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(g)throw new f_(c_.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\\[\\]])(?=.{8,})`).test(h)||wE.warning(`The secret is not strong:
      The secret must contain at least 1 lowercase alphabetical character,
      The secret must contain at least 1 uppercase alphabetical character,
      The secret must contain at least 1 numeric character,
      The secret must contain at least one special character,
      The secret must be eight characters or longer.
      `),this._encryptionMode=d,this._encryptionSecret=h,g&&(this._encryptionSalt=FU(g))}async renewToken(d){if(GR(d,"token",1,2047),!this._key||!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"renewToken should not be called before user join");const h=this._key;this._key=d,this._joinInfo&&(this._joinInfo.token=d);const g=await this._renewTokenMutex.lock();try{if(__("USE_NEW_TOKEN")){wE.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const j=await pZ(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||rR);wE.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:d,ticket:j})}else wE.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:d});wE.debug("[".concat(this._clientId,"] renewToken success"))}catch(j){throw this._key=h,this._joinInfo.token=h,wE.error("[".concat(this._clientId,"] renewToken failed"),j.toString()),j}finally{g()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?wE.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval(()=>{const d=this._p2pChannel.getAudioLevels();this.safeEmit(V0.VOLUME_INDICATOR,d)},__("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const d=this._statsCollector.getRTCStats(),h=this._gateway.getInChannelInfo();return d.Duration=Math.round(h.duration/1e3),d}async startLiveStreaming(d,h){if(!h){if(this.codec!=="h264")throw new f_(c_.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new f_(c_.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(d)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(d))throw new f_(c_.LIVE_STREAMING_TASK_CONFLICT);const g=h?pR.TRANSCODE:pR.RAW;return this._createLiveStreamingClient(g).startLiveStreamingTask(d,g)}setLiveTranscoding(d){return this._createLiveStreamingClient(pR.TRANSCODE).setTranscodingConfig(d)}async stopLiveStreaming(d){const h=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter(g=>g&&g.hasUrl(d));if(!h.length)throw new f_(c_.INVALID_PARAMS,"can not find live streaming url to stop");await a0.all(h.map(g=>g&&g.stopLiveStreamingTask(d)))}async addInjectStreamUrl(d,h){if(!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const g=this._createLiveStreamingClient(pR.INJECT);g.setInjectStreamConfig(h,0),await g.startLiveStreamingTask(d,pR.INJECT)}async removeInjectStreamUrl(){var d;const h=this._createLiveStreamingClient(pR.INJECT),g=Array.from(mO(d=h.streamingTasks).call(d)).find(j=>j.mode===pR.INJECT);if(!this._joinInfo||!g)throw new f_(c_.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await h.stopLiveStreamingTask(g.url)}async startChannelMediaRelay(d){$W(d),await this._createChannelMediaRelayClient().startChannelMediaRelay(d)}async updateChannelMediaRelay(d){$W(d),await this._createChannelMediaRelayClient().updateChannelMediaRelay(d)}async stopChannelMediaRelay(){await this._createChannelMediaRelayClient().stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendStreamMessage(d){let h=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"can not send data stream, not joined");if(typeof d=="string"&&(d=new TextEncoder().encode(d)),new Blob([d]).size>1024)throw new f_(c_.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(C0.DATA_STREAM,{payload:FU(d)},!h)}sendMetadata(d){if(!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([d]).size>1024)throw new f_(c_.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(C0.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:FU(d)})}async sendCustomReportMessage(d){if(Array.isArray(d)||(d=[d]),d.forEach(CX),!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"can not send custom report, not joined");await p0.sendCustomReportMessage(this._joinInfo.sid,d)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(d,h){IR(h.spatialLayer,"spatialLayer",[0,1,2,3]),IR(h.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(d,h)}catch(g){throw wE.error("[".concat(this._clientId,"] pick SVC layer failed"),g.toString()),g}}_reset(){if(wE.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=KT.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._users.forEach(d=>{d._audioTrack&&d._audioTrack._destroy(),d._videoTrack&&d._videoTrack._destroy()}),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._cloudProxyServerMode==="fallback"&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new lT("client-publish"),this._subscribeMutex=new lT("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch{}if(this._moderation)try{this.setImageModeration(!1)}catch{}}_startSession(d,h){const g=d||O5();d?wE.debug("[".concat(this._clientId,"] new Session ").concat(g)):wE.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(g)),this._sessionId=g,this.store.sessionId=g,h?p0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:h.channel,appid:h.appId,mode:this.mode}):this._joinInfo?p0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this.mode}):this._gateway.joinInfo&&p0.sessionInit(this._sessionId,{lts:new Date().getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this.mode}),this._joinInfo&&(this._joinInfo.sid=g),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=g)}async _publishHighStream(d){if(!this._joinInfo||this._uid===void 0)throw new f_(c_.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new f_(c_.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if(this._turnServer.mode==="auto"&&__("FORCE_TURN")&&!__("TURN_ENABLE_TCP")&&!__("TURN_ENABLE_UDP"))throw new f_(c_.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");wE.debug("[".concat(this._clientId,"] publish high stream"));try{const g=await this._p2pChannel.publish(d,this._isDualStreamEnabled,this._lowStreamParameter),j=(await g.next()).value;if(j){var h;let _t;try{_t=await this._gateway.publish(this._uid,j,!0)}catch(_i){if(_i.code!==c_.DISCONNECT_P2P)throw g.throw(_i),_i}await g.next(((h=_t)===null||h===void 0?void 0:h.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const _t of d)_t instanceof cR&&_t._encoderConfig&&this._gateway.setVideoProfile(_t._encoderConfig),!_t.muted&&_t.enabled||await this._p2pChannel.muteLocalTrack(_t)}catch(g){if(this._p2pChannel.reportPublishEvent(!1,g==null?void 0:g.code,d),(g==null?void 0:g.code)===c_.WS_ABORT)return;throw g}}async _publishLowStream(){if(!this._joinInfo||this._uid===void 0)throw new f_(c_.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this.connectionState!=="CONNECTED"&&this.connectionState!=="RECONNECTING")throw new f_(c_.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));wE.debug("[".concat(this._clientId,"] publish low stream"));const d=this._configDistribute.getLowStreamConfigDistribute();d&&d.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&d.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=d.bitrate));try{const g=await this._p2pChannel.publishLowStream(this._lowStreamParameter),j=(await g.next()).value;if(j){var h;let _t;try{_t=await this._gateway.publish(this._uid,j,!0)}catch(_i){if(_i.code!==c_.DISCONNECT_P2P)throw g.throw(_i),_i}g.next(((h=_t)===null||h===void 0?void 0:h.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(g){if(this._p2pChannel.reportPublishEvent(!1,g==null?void 0:g.code,void 0,!0),(g==null?void 0:g.code)===c_.WS_ABORT)return;throw g}}_createLiveStreamingClient(d){if(!this._joinInfo||!this._appId)return new f_(c_.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const h=()=>new mZ(this._joinInfo,this._config.websocketRetryConfig||rR,this._config.httpRetryConfig||rR),g=j=>{j.onLiveStreamError=(_t,_i)=>{p0.reportApiInvoke(this._sessionId,{name:iR.ON_LIVE_STREAM_ERROR,options:[_t,_i],tag:kS.TRACER}).onSuccess(),this.safeEmit(V0.LIVE_STREAMING_ERROR,_t,_i)},j.onLiveStreamWarning=(_t,_i)=>{p0.reportApiInvoke(this._sessionId,{name:iR.ON_LIVE_STREAM_WARNING,options:[_t,_i],tag:kS.TRACER}).onSuccess(),this.safeEmit(V0.LIVE_STREAMING_WARNING,_t,_i)},j.on(Q1.REQUEST_WORKER_MANAGER_LIST,(_t,_i,_o)=>{if(!this._joinInfo)return _o(new f_(c_.INVALID_OPERATION,"can not find join info to get worker manager"));jW(_t,this._joinInfo,this._axiosCancelSource.token,rR).then(_i).catch(_o)})};switch(d){case pR.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=h(),g(this._liveRawStreamingClient)),this._liveRawStreamingClient;case pR.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=h(),g(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case pR.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=h(),this._injectStreamingClient.on(Q1.REQUEST_WORKER_MANAGER_LIST,(j,_t,_i)=>{if(!this._joinInfo)return _i(new f_(c_.INVALID_OPERATION,"can not find join info to get worker manager"));jW(j,this._joinInfo,this._axiosCancelSource.token,rR).then(_t).catch(_i)}),this._injectStreamingClient.onInjectStatusChange=(j,_t,_i)=>{this.emit(V0.INJECT_STREAM_STATUS,j,_t,_i)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){if(!this._joinInfo)return new f_(c_.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:d,sendResolutionHeight:h}=this.getLocalVideoStats(),g={width:d,height:h};this._channelMediaRelayClient=new EZ(this._joinInfo,this._clientId,this._config.websocketRetryConfig||rR,this._config.httpRetryConfig||rR,g),this._channelMediaRelayClient.on("state",j=>{j===uT.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.safeEmit(V0.CHANNEL_MEDIA_RELAY_STATE,j)}),this._channelMediaRelayClient.on("event",j=>{this.safeEmit(V0.CHANNEL_MEDIA_RELAY_EVENT,j)}),this._statsCollector.onStatsChanged=(j,_t)=>{var _i;j==="resolution"&&((_i=this._channelMediaRelayClient)===null||_i===void 0||_i.setVideoProfile(_t))}}return this._channelMediaRelayClient}_handleGatewayEvents(){this._gateway.on(PS.DISCONNECT_P2P,async()=>{await this._p2pChannel.disconnectForReconnect()}),this._gateway.on(PS.CONNECTION_STATE_CHANGE,(d,h,g)=>{var j;if(g===aS.FALLBACK)return;const _t=()=>{this.safeEmit(V0.CONNECTION_STATE_CHANGE,d,h,g)};if(p0.reportApiInvoke(this._sessionId||((j=this._gateway.joinInfo)===null||j===void 0?void 0:j.sid)||null,{name:iR.CONNECTION_STATE_CHANGE,options:[d,h,g],tag:kS.TRACER}).onSuccess(JSON.stringify({cur:d,prev:h,reason:g})),wE.info("[".concat(this._clientId,"] connection state change: ").concat(h," -> ").concat(d)),d==="DISCONNECTED")return this._reset(),void _t();if(d==="RECONNECTING")this._users.forEach(_o=>{_o._trust_in_room_=!1,_o._trust_audio_enabled_state_=!1,_o._trust_video_enabled_state_=!1,_o._trust_audio_mute_state_=!1,_o._trust_video_mute_state_=!1,_o._trust_audio_stream_added_state_=!1,_o._trust_video_stream_added_state_=!1,_o._audioSSRC=void 0,_o._videoSSRC=void 0,_o._videoOrtc=void 0,_o._audioOrtc=void 0,_o._cname=void 0,_o._rtxSsrcId=void 0}),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if(d==="CONNECTED"){var _i;this._streamFallbackTypeCacheMap.forEach((_o,ga)=>{this._gateway.setStreamFallbackOption(ga,_o).catch(_a=>{wE.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),_a)})}),this._remoteStreamTypeCacheMap.forEach((_o,ga)=>{this._gateway.setRemoteVideoStreamType(ga,_o).catch(_a=>{wE.warning("[".concat(this._clientId,"] auto set remote stream type failed"),_a)})}),this._remoteDefaultVideoStreamType!==void 0&&((_i=this._joinInfo)===null||_i===void 0?void 0:_i.defaultVideoStream)===void 0&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then(()=>{wE.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))}).catch(_o=>{wE.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(_o))}),this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._userOfflineTimeout=void 0,this._users.filter(_o=>!_o._trust_in_room_).forEach(_o=>{wE.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(_o.uid)),this._handleUserOffline({uid:_o.uid})}))},3e3),this._streamRemovedTimeout=window.setTimeout(()=>{this.connectionState==="CONNECTED"&&(this._streamRemovedTimeout=void 0,this._users.forEach(_o=>{_o._trust_audio_mute_state_||(wE.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(_o.uid)),this._handleMuteStream(_o.uid,"audio",!1)),_o._trust_video_mute_state_||(wE.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(_o.uid)),this._handleMuteStream(_o.uid,"video",!1)),_o._trust_audio_enabled_state_||(wE.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(_o.uid)),this._handleSetStreamLocalEnable("audio",_o.uid,!0)),_o._trust_video_enabled_state_||(wE.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(_o.uid)),this._handleSetStreamLocalEnable("video",_o.uid,!0)),_o._trust_video_stream_added_state_||(wE.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(_o.uid)),this._handleResetAddStream(_o,"video")),_o._trust_audio_stream_added_state_||(wE.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(_o.uid)),this._handleResetAddStream(_o,"audio")),_o._video_added_||_o._audio_added_||(wE.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(_o.uid)),this._handleRemoveStream({uid:_o.uid,uint_id:_o._uintid}))}))},1e3)}_t()}),this._gateway.on(PS.REQUEST_NEW_GATEWAY_LIST,(d,h)=>{if(!this._joinInfo)return h(new f_(c_.UNEXPECTED_ERROR,"can not recover, no join info"));M5(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||rR,this.store).then(g=>{this._joinInfo&&(this._joinInfo.apResponse=g.gatewayInfo.res,this._joinInfo.gatewayAddrs=g.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=g.gatewayInfo.uni_lbs_ip),d(g.gatewayInfo.gatewayAddrs.map(j=>{if(this._joinInfo&&this._joinInfo.proxyServer){const _t=j.address.split(":");return"wss://".concat(this._joinInfo.proxyServer,"/ws/?h=").concat(_t[0],"&p=").concat(_t[1])}return"wss://".concat(j.address)}))}).catch(h)}),this._gateway.on(PS.NETWORK_QUALITY,d=>{this._networkQualitySensitivity==="normal"&&this.safeEmit(V0.NETWORK_QUALITY,d)}),this._gateway.on(PS.STREAM_TYPE_CHANGE,(d,h)=>{this.safeEmit(V0.STREAM_TYPE_CHANGED,d,h),p0.reportApiInvoke(this._sessionId,{name:iR.STREAM_TYPE_CHANGE,options:[d,h],tag:kS.TRACER}).onSuccess(JSON.stringify({uid:d,streamType:h}))}),this._gateway.on(PS.IS_P2P_DISCONNECTED,d=>{this._p2pChannel.isP2PDisconnected()?d(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?d(!1):d(!0)}),this._gateway.on(PS.NEED_RENEW_SESSION,()=>{this._startSession()}),this._gateway.on(PS.REQUEST_P2P_CONNECTION_PARAMS,async(d,h,g)=>{try{h(await this._p2pChannel.startP2PConnection(d))}catch(j){g(j)}}),this._gateway.on(PS.JOIN_RESPONSE,(d,h)=>{const{dtlsParameters:g,iceParameters:j,candidates:_t,rtpCapabilities:_i,setup:_o,cname:ga}=pH(d.ortc,h);this._p2pChannel.connect(j,g,_t,_i,_o,ga)}),this._gateway.on(PS.REQUEST_DC_CONNECTION_PARAMS,d=>{d(this._p2pChannel.getEstablishParams())}),this._gateway.on(PS.RESET_SIGNAL,d=>{this._p2pChannel.resetConnection(d),this._handleGatewaySignalEvents()}),this._gateway.on(PS.DATACHANNEL_FAILBACK,()=>{this._joinGateway()}),this._gateway.on(PS.DATACHANNEL_PRECONNECT,async(d,h,g,j)=>{var _t,_i,_o,ga,_a,_u;await this._p2pChannel.startP2PConnection({turnServer:(_t=this._joinInfo)===null||_t===void 0?void 0:_t.turnServer},!0);const _c=function(_l,_g){let r_;return _g&&_g.ip&&typeof _g.port=="number"?(r_=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:_g.ip,port:_g.port.toString(),type:"host",extension:{}}],wE.debug("Using remote candidate from AP ".concat(_g.ip,":").concat(_g.port)),_g.ip6&&(r_.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:_g.ip6,port:_g.port.toString(),type:"host",extension:{}}),wE.debug("Using IPV6 remote candidate from AP ".concat(_g.ip6,":").concat(_g.port)))):r_=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:_l.ip,port:_l.port.toString(),type:"host",extension:{}}],r_}(d,h);return this._p2pChannel.preConnect({iceUfrag:"".concat((_i=this._joinInfo)===null||_i===void 0?void 0:_i.apResponse.cid,"_").concat((_o=this._joinInfo)===null||_o===void 0?void 0:_o.apResponse.cert),icePwd:"".concat((ga=this._joinInfo)===null||ga===void 0?void 0:ga.apResponse.cid,"_").concat((_a=this._joinInfo)===null||_a===void 0?void 0:_a.apResponse.cert)},{fingerprints:[{hashFunction:"sha-256",fingerprint:(_u=__("FINGERPRINT"))!==null&&_u!==void 0?_u:d.fingerprint}]},_c,{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},"active","o/i14u9pJrxRKAsu").then(g).catch(j)})}_handleGatewaySignalEvents(){this._gateway.signal.on(F0.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(F0.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(F0.ON_ADD_AUDIO_STREAM,d=>this._handleAddAudioOrVideoStream("audio",d.uid,d.ssrcId,d.cname,d.uint_id,d.ortc)),this._gateway.signal.on(F0.ON_ADD_VIDEO_STREAM,d=>this._handleAddAudioOrVideoStream("video",d.uid,d.ssrcId,d.cname,d.uint_id,d.ortc,d.rtxSsrcId)),this._gateway.signal.on(F0.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(F0.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(F0.MUTE_AUDIO,d=>this._handleMuteStream(d.uid,"audio",!0)),this._gateway.signal.on(F0.UNMUTE_AUDIO,d=>this._handleMuteStream(d.uid,"audio",!1)),this._gateway.signal.on(F0.MUTE_VIDEO,d=>this._handleMuteStream(d.uid,"video",!0)),this._gateway.signal.on(F0.UNMUTE_VIDEO,d=>this._handleMuteStream(d.uid,"video",!1)),this._gateway.signal.on(F0.RECEIVE_METADATA,d=>{const h=N5(d.metadata);this.safeEmit(V0.RECEIVE_METADATA,d.uid,h)}),this._gateway.signal.on(F0.ON_DATA_STREAM,d=>{d.seq&&delete d.seq,d.payload=N5(d.payload),this.safeEmit(V0.STREAM_MESSAGE,d.uid,d.payload),this.onStreamMessage&&this.onStreamMessage(d)}),this._gateway.signal.on(F0.ON_CRYPT_ERROR,()=>{vL(()=>{wE.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(V0.CRYPT_ERROR)},this._sessionId)}),this._gateway.signal.on(F0.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(F0.ON_TOKEN_PRIVILEGE_DID_EXPIRE,()=>{wE.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0),this.safeEmit(V0.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()}),this._gateway.signal.on(F0.ON_STREAM_FALLBACK_UPDATE,d=>{wE.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(d.stream_id,", attr: ").concat(d.stream_type)),this.safeEmit(V0.STREAM_FALLBACK,d.stream_id,d.stream_type===1?"fallback":"recover")}),this._gateway.signal.on(F0.ON_PUBLISH_STREAM,d=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:d.proxy})),wE.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(d))))}),this._gateway.signal.on(F0.ENABLE_LOCAL_VIDEO,d=>{this._handleSetStreamLocalEnable("video",d.uid,!0)}),this._gateway.signal.on(F0.DISABLE_LOCAL_VIDEO,d=>{this._handleSetStreamLocalEnable("video",d.uid,!1)}),this._gateway.signal.on(f0.REQUEST_TIMEOUT,(d,h)=>{if(this._joinInfo)switch(d){case C0.PUBLISH:{if(!h)return;const _o=(h=h).ortc;if(_o){var g,j,_t,_i;const ga=_o.some(_c=>{let{stream_type:_l}=_c;return _l===hR.Audio}),_a=_o.some(_c=>{let{stream_type:_l}=_c;return _l!==hR.Audio}),_u=_o.some(_c=>{let{stream_type:_l}=_c;return _l===hR.Screen||_l===hR.ScreenLow});h.state==="offer"&&p0.publish(this._joinInfo.sid,{eventElapse:hI.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:c_.TIMEOUT,audio:ga,video:_a,p2pid:h.p2p_id,publishRequestid:this.store.pubId,screenshare:_u,audioName:ga?(g=_o.find(_c=>{let{stream_type:_l}=_c;return _l===hR.Audio}))===null||g===void 0||(j=g.ssrcs[0])===null||j===void 0?void 0:j.ssrcId.toString():void 0,videoName:_a?(_t=_o.find(_c=>{let{stream_type:_l}=_c;return _l!==hR.Audio}))===null||_t===void 0||(_i=_t.ssrcs[0])===null||_i===void 0?void 0:_i.ssrcId.toString():void 0})}break}case C0.SUBSCRIBE:(h=h)&&p0.subscribe(this._joinInfo.sid,{succ:!1,ec:c_.TIMEOUT,audio:h.stream_type===L0.AUDIO,video:h.stream_type===L0.VIDEO,peerid:h.stream_id,subscribeRequestid:h.ssrcId,p2pid:this.store.p2pId,eventElapse:hI.measureFromSubscribeStart(this.store.clientId,h.ssrcId)})}}),this._gateway.signal.on(F0.ON_P2P_OK,d=>{this.uid,this._uid}),this._gateway.signal.on(F0.ON_PUBLISHED_USER_LIST,d=>{if(d==null||!d.users)return;__("BLOCK_LOCAL_CLIENT")&&(d.users=d.users.filter(j=>!e1(j.audio_ssrc,this.channelName)));const h=[],g=[];for(const j of d.users){let _t=this._users.find(_u=>_u.uid===j.stream_id);_t?_t._trust_in_room_=!0:(_t=new F5(j.stream_id,j.stream_id),this._users.push(_t),this.getListeners(V0.PUBLISHED_USER_LIST).length===0&&(wE.debug("[".concat(this._clientId,"] user online"),j.stream_id),this.safeEmit(V0.USER_JOINED,_t)));const _i=oR.Audio&j.stream_type,_o=(oR.Video|oR.LwoVideo)&j.stream_type,ga=_i&&_t.hasAudio,_a=_o&&_t.hasVideo;_o&&(_t._trust_video_stream_added_state_=!0,_t._video_added_=!0,_t._videoSSRC=j.video_ssrc,_t._rtxSsrcId=j.video_rtx),_i&&(_t._trust_audio_stream_added_state_=!0,_t._audio_added_=!0,_t._audioSSRC=j.audio_ssrc),_i&&!ga&&this.getListeners(V0.PUBLISHED_USER_LIST).length===0&&(wE.info("[".concat(this._clientId,"] remote user ").concat(_t.uid," published audio")),this.safeEmit(V0.USER_PUBLISHED,_t,"audio")),_o&&!_a&&this.getListeners(V0.PUBLISHED_USER_LIST).length===0&&(wE.info("[".concat(this._clientId,"] remote user ").concat(_t.uid," published video")),this.safeEmit(V0.USER_PUBLISHED,_t,"video")),(_i&&!ga||_o&&!_a)&&h.push(_t),_o&&this._p2pChannel.hasPendingRemoteMedia(_t,"video")&&g.push({user:_t,mediaType:"video"}),_i&&this._p2pChannel.hasPendingRemoteMedia(_t,"audio")&&g.push({user:_t,mediaType:"audio"})}g.length>0&&(wE.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(g.map(j=>"user: ".concat(j.user.uid,", mediaType: ").concat(j.mediaType)).join("; ")," ")),this.massSubscribe(g).catch(j=>{wE.error("[".concat(this._clientId,"] mass resubscribe error"),j.toString())})),this.getListeners(V0.PUBLISHED_USER_LIST).length>0?(wE.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(h.map(j=>j.uid).join(", "))),this.safeEmit(V0.PUBLISHED_USER_LIST,h)):wE.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(h.map(j=>j.uid).join(", ")))})}_handleP2PChannelEvents(){this._p2pChannel.on(Y0.RequestMuteLocal,async(d,h,g)=>{if(this._joinInfo)try{await this._gateway.muteLocal(d,this._joinInfo.stringUid||this._joinInfo.uid),h()}catch(j){j.code===c_.DISCONNECT_P2P?h():g(j)}else h()}),this._p2pChannel.on(Y0.RequestUnmuteLocal,async(d,h,g)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(d,this._joinInfo.stringUid||this._joinInfo.uid),h()}catch(j){j.code===c_.DISCONNECT_P2P?h():g(j)}else h()}),this._p2pChannel.on(Y0.RequestRePublish,(d,h,g)=>{this.publish(d,!1).then(h).catch(g)}),this._p2pChannel.on(Y0.RequestReSubscribe,async(d,h,g)=>{try{for(const{user:j,kind:_t}of d)_t===L0.VIDEO?await this.subscribe(j,"video"):await this.subscribe(j,"audio");h()}catch(j){g(j)}}),this._p2pChannel.on(Y0.RequestUploadStats,(d,h)=>{this._gateway.uploadStats(d,h)}),this._p2pChannel.on(Y0.MediaReconnectStart,d=>{this.safeEmit(V0.MEDIA_RECONNECT_START,d)}),this._p2pChannel.on(Y0.MediaReconnectEnd,d=>{this.safeEmit(V0.MEDIA_RECONNECT_END,d)}),this._p2pChannel.on(Y0.NeedSignalRTT,d=>{d(this._gateway.getSignalRTT())}),this._p2pChannel.on(Y0.RequestRestartICE,async d=>{const h=await this._p2pChannel.restartICE(d),g=await h.next();if(g.done)return;const j=g.value;let _t;try{_t=await this._gateway.restartICE({iceParameters:j})}catch(_o){return void h.throw(_o)}const{iceParameters:_i}=function(_o){const ga=_o.iceParameters;return{iceParameters:{iceUfrag:ga.iceUfrag,icePwd:ga.icePwd}}}(_t);await h.next({remoteIceParameters:_i})}),this._p2pChannel.on(Y0.RequestReconnect,async()=>{this._gateway.reconnect()}),this._p2pChannel.on(Y0.RequestReconnectPC,async()=>{var d;const{iceParameters:h,dtlsParameters:g,rtpCapabilities:j}=await this._p2pChannel.startP2PConnection({turnServer:(d=this._joinInfo)===null||d===void 0?void 0:d.turnServer}),{gatewayEstablishParams:_t,gatewayAddress:_i}=await this._gateway.reconnectPC({iceParameters:h,dtlsParameters:g,rtpCapabilities:j}),{dtlsParameters:_o,iceParameters:ga,candidates:_a,rtpCapabilities:_u,setup:_c,cname:_l}=pH(_t,_i);await this._p2pChannel.connect(ga,_o,_a,_u,_c,_l),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()}),this._p2pChannel.on(Y0.RequestUnpublishForReconnectPC,async(d,h,g)=>{this._joinInfo&&this._uid!==void 0?(await this._gateway.unpublish(d,this._uid),h()):g()}),this._p2pChannel.on(Y0.P2PLost,()=>{this.safeEmit(V0.P2P_LOST,this.store.uid)}),this._p2pChannel.on(Y0.UpdateVideoEncoder,d=>{d._encoderConfig&&this._gateway.setVideoProfile(d._encoderConfig)}),this._p2pChannel.on(Y0.ConnectionTypeChange,d=>{this.safeEmit(V0.IS_USING_CLOUD_PROXY,d)}),this._p2pChannel.on(Y0.RequestLowStreamParameter,d=>{d(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}),this._p2pChannel.on(Y0.QueryClientConnectionState,d=>{d(this.connectionState)})}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(d){if(this.connectionState!=="CONNECTED"||!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"[".concat(this._clientId,"] Client did not join channel"));if(this._inspect)throw new f_(c_.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));if(!d)throw new f_(c_.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig is necessary"));if(!d.inspectType||!Array.isArray(d.inspectType))throw new f_(c_.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.inspectType is necessary and is an instance of Array."));{const h=[...new Set(d.inspectType)];h.forEach(g=>{if(!["supervise","moderation"].includes(g))throw new f_(c_.INVALID_PARAMS,"[".concat(this._clientId,"] ").concat(g," is not a valid inspect type."))}),d.inspectType=h}if(d&&d.extraInfo&&d.extraInfo.length>1024)throw new f_(c_.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.extraInfo length cannot exceed 1024 bytes"));try{const h=new TF(d);this._inspect=h,this.handleVideoInspectEvents(this._inspect),await h.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},rR)}catch(h){throw Array.isArray(h)?h[0]:h}}async disableContentInspect(){if(!this._inspect)throw new f_(c_.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(d){throw Array.isArray(d)?d[0]:d}}async setImageModeration(d,h){if(J1(d,"enabled"),d){if(!h)throw new f_(c_.INVALID_PARAMS,"[".concat(this._clientId,"] config is necessary"));if(SS(h.interval,"interval",1e3,1/0),this.connectionState!=="CONNECTED"||!this._joinInfo)throw new f_(c_.INVALID_OPERATION,"[".concat(this._clientId,'] can not enable image moderation, not joined"'));try{if(this._moderation)return void this._moderation.updateConfig(h);const g=new b6(h);this._moderation=g,this.handleImageModerationEvents(this._moderation),await g.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},rR)}catch(g){throw Array.isArray(g)?g[0]:g}}else{if(!this._moderation)throw new f_(c_.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(g){throw Array.isArray(g)?g[0]:g}}}handleImageModerationEvents(d){d.on(pI.CONNECTION_STATE_CHANGE,(h,g)=>{switch(this.emit(V0.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,h,g),h){case UT.CONNECTED:if(this.connectionState!=="CONNECTED")throw this.setImageModeration(!1),new f_(c_.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");d.inspectImage()}}),d.on(pI.CLIENT_LOCAL_VIDEO_TRACK,h=>{h(this.localTracks.filter(g=>g.trackMediaType==="video")[0])})}handleVideoInspectEvents(d){d.on(fR.CONNECTION_STATE_CHANGE,(h,g)=>{switch(this.emit(V0.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,h,g),g){case XT.CONNECTED:if(this.connectionState!=="CONNECTED")return void this.emit(V0.CONTENT_INSPECT_ERROR,new f_(c_.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));d.inspectImage()}}),d.on(fR.INSPECT_RESULT,(h,g)=>{var j;if((g==null?void 0:g.code)===c_.INVALID_OPERATION&&this.connectionState==="DISCONNECTED")return wE.debug("Stop inspect content because that has left channel"),this==null||(j=this._inspect)===null||j===void 0||j.close(),void(this._inspect=void 0);this.emit(V0.CONTENT_INSPECT_RESULT,h,g)}),d.on(fR.CLIENT_LOCAL_VIDEO_TRACK,h=>{h(this.localTracks.filter(g=>g.trackMediaType==="video")[0])})}getJoinChannelServiceRecords(){return wE.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(d){J1(d,"enabled"),ES("ENABLE_PUBLISH_AUDIO_FILTER",d),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(d)}_handleResetAddStream(d,h){switch(h){case"audio":d._audio_added_=!1,d._trust_audio_stream_added_state_=!0;break;case"video":d._video_added_=!1,d._trust_video_stream_added_state_=!0}}}).prototype,"leave",[RK],Object.getOwnPropertyDescriptor(t0.prototype,"leave"),t0.prototype),G_(t0.prototype,"publish",[TK],Object.getOwnPropertyDescriptor(t0.prototype,"publish"),t0.prototype),G_(t0.prototype,"unpublish",[wK],Object.getOwnPropertyDescriptor(t0.prototype,"unpublish"),t0.prototype),G_(t0.prototype,"subscribe",[CK],Object.getOwnPropertyDescriptor(t0.prototype,"subscribe"),t0.prototype),G_(t0.prototype,"massSubscribe",[IK],Object.getOwnPropertyDescriptor(t0.prototype,"massSubscribe"),t0.prototype),G_(t0.prototype,"unsubscribe",[OK],Object.getOwnPropertyDescriptor(t0.prototype,"unsubscribe"),t0.prototype),G_(t0.prototype,"massUnsubscribe",[AK],Object.getOwnPropertyDescriptor(t0.prototype,"massUnsubscribe"),t0.prototype),G_(t0.prototype,"setLowStreamParameter",[NK],Object.getOwnPropertyDescriptor(t0.prototype,"setLowStreamParameter"),t0.prototype),G_(t0.prototype,"enableDualStream",[kK],Object.getOwnPropertyDescriptor(t0.prototype,"enableDualStream"),t0.prototype),G_(t0.prototype,"disableDualStream",[PK],Object.getOwnPropertyDescriptor(t0.prototype,"disableDualStream"),t0.prototype),G_(t0.prototype,"setClientRole",[xK],Object.getOwnPropertyDescriptor(t0.prototype,"setClientRole"),t0.prototype),G_(t0.prototype,"setProxyServer",[DK],Object.getOwnPropertyDescriptor(t0.prototype,"setProxyServer"),t0.prototype),G_(t0.prototype,"setTurnServer",[LK],Object.getOwnPropertyDescriptor(t0.prototype,"setTurnServer"),t0.prototype),G_(t0.prototype,"setLicense",[MK],Object.getOwnPropertyDescriptor(t0.prototype,"setLicense"),t0.prototype),G_(t0.prototype,"startProxyServer",[jK],Object.getOwnPropertyDescriptor(t0.prototype,"startProxyServer"),t0.prototype),G_(t0.prototype,"stopProxyServer",[UK],Object.getOwnPropertyDescriptor(t0.prototype,"stopProxyServer"),t0.prototype),G_(t0.prototype,"setLocalAccessPointsV2",[FK],Object.getOwnPropertyDescriptor(t0.prototype,"setLocalAccessPointsV2"),t0.prototype),G_(t0.prototype,"setLocalAccessPoints",[BK],Object.getOwnPropertyDescriptor(t0.prototype,"setLocalAccessPoints"),t0.prototype),G_(t0.prototype,"setRemoteDefaultVideoStreamType",[VK],Object.getOwnPropertyDescriptor(t0.prototype,"setRemoteDefaultVideoStreamType"),t0.prototype),G_(t0.prototype,"setRemoteVideoStreamType",[GK],Object.getOwnPropertyDescriptor(t0.prototype,"setRemoteVideoStreamType"),t0.prototype),G_(t0.prototype,"setStreamFallbackOption",[$K],Object.getOwnPropertyDescriptor(t0.prototype,"setStreamFallbackOption"),t0.prototype),G_(t0.prototype,"setEncryptionConfig",[WK],Object.getOwnPropertyDescriptor(t0.prototype,"setEncryptionConfig"),t0.prototype),G_(t0.prototype,"renewToken",[HK],Object.getOwnPropertyDescriptor(t0.prototype,"renewToken"),t0.prototype),G_(t0.prototype,"enableAudioVolumeIndicator",[qK],Object.getOwnPropertyDescriptor(t0.prototype,"enableAudioVolumeIndicator"),t0.prototype),G_(t0.prototype,"startLiveStreaming",[zK],Object.getOwnPropertyDescriptor(t0.prototype,"startLiveStreaming"),t0.prototype),G_(t0.prototype,"setLiveTranscoding",[KK],Object.getOwnPropertyDescriptor(t0.prototype,"setLiveTranscoding"),t0.prototype),G_(t0.prototype,"stopLiveStreaming",[YK],Object.getOwnPropertyDescriptor(t0.prototype,"stopLiveStreaming"),t0.prototype),G_(t0.prototype,"addInjectStreamUrl",[JK],Object.getOwnPropertyDescriptor(t0.prototype,"addInjectStreamUrl"),t0.prototype),G_(t0.prototype,"removeInjectStreamUrl",[XK],Object.getOwnPropertyDescriptor(t0.prototype,"removeInjectStreamUrl"),t0.prototype),G_(t0.prototype,"startChannelMediaRelay",[QK],Object.getOwnPropertyDescriptor(t0.prototype,"startChannelMediaRelay"),t0.prototype),G_(t0.prototype,"updateChannelMediaRelay",[ZK],Object.getOwnPropertyDescriptor(t0.prototype,"updateChannelMediaRelay"),t0.prototype),G_(t0.prototype,"stopChannelMediaRelay",[e7],Object.getOwnPropertyDescriptor(t0.prototype,"stopChannelMediaRelay"),t0.prototype),G_(t0.prototype,"sendCustomReportMessage",[t7],Object.getOwnPropertyDescriptor(t0.prototype,"sendCustomReportMessage"),t0.prototype),G_(t0.prototype,"pickSVCLayer",[n7],Object.getOwnPropertyDescriptor(t0.prototype,"pickSVCLayer"),t0.prototype),G_(t0.prototype,"enableContentInspect",[r7],Object.getOwnPropertyDescriptor(t0.prototype,"enableContentInspect"),t0.prototype),G_(t0.prototype,"disableContentInspect",[i7],Object.getOwnPropertyDescriptor(t0.prototype,"disableContentInspect"),t0.prototype),G_(t0.prototype,"setImageModeration",[o7],Object.getOwnPropertyDescriptor(t0.prototype,"setImageModeration"),t0.prototype),G_(t0.prototype,"getJoinChannelServiceRecords",[s7],Object.getOwnPropertyDescriptor(t0.prototype,"getJoinChannelServiceRecords"),t0.prototype),G_(t0.prototype,"setPublishAudioFilterEnabled",[a7],Object.getOwnPropertyDescriptor(t0.prototype,"setPublishAudioFilterEnabled"),t0.prototype),t0);class $ee extends o${set currentState(h){h!==this._currentState&&(this._currentState=h,this.safeEmit(wT.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(h){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),_h(this,"audioBuffer",void 0),_h(this,"sourceNode",void 0),_h(this,"startPlayTime",0),_h(this,"startPlayOffset",0),_h(this,"pausePlayTime",0),_h(this,"options",void 0),_h(this,"currentLoopCount",0),_h(this,"currentPlaybackSpeed",100),_h(this,"_currentState","stopped"),this.audioBuffer=h,this.options=g,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer.duration}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.currentState==="stopped"?0:this.currentState==="paused"?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration}updateOptions(h){this.currentState==="stopped"?(this.options=h,this.startPlayOffset=this.options.startPlayTime||0):wE.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&this.currentState==="playing"&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(h){this.sourceNode&&(this.sourceNode.onended=null,this.currentState==="playing"&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),this.currentState==="playing"?(this.startPlayOffset=h,this.startSourceNode()):this.currentState==="paused"&&(this.pausePlayTime=h))}resumeProcessAudioBuffer(){this.currentState==="paused"&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch{}this.reset()}}setAudioBufferPlaybackSpeed(h){this.sourceNode&&(this.currentState==="playing"&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=h/100),this.currentPlaybackSpeed=h}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const h=this.context.createBufferSource();return h.buffer=this.audioBuffer,h.loop=!!this.options.loop,h.connect(this.outputNode),h.playbackRate.value=this.currentPlaybackSpeed/100,h}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const u7=new Map;async function Wee(d,h){let g=null;if(typeof d=="string"){const _t=u7.get(d);if(_t)return wE.debug("use cached audio resource: ",d),_t;try{g=(await JI(()=>KT.get(d,{responseType:"arraybuffer"}),void 0,void 0,{maxRetryCount:3})).data}catch(_i){throw new f_(c_.FETCH_AUDIO_FILE_FAILED,_i.toString())}}else g=await new a0((_i,_o)=>{const ga=new FileReader;ga.onload=_a=>{_a.target?_i(_a.target.result):_o(new f_(c_.READ_LOCAL_AUDIO_FILE_ERROR))},ga.onerror=()=>{_o(new f_(c_.READ_LOCAL_AUDIO_FILE_ERROR))},ga.readAsArrayBuffer(d)});const j=await function(_t){const _i=tP();return new a0((_o,ga)=>{_i.decodeAudioData(_t,_a=>{_o(_a)},_a=>{ga(new f_(c_.DECODE_AUDIO_FILE_FAILED,_a.toString()))})})}(g);return typeof d=="string"&&h&&u7.set(d,j),j}function l7(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function IF(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?l7(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):l7(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}function S6(d,h,g,j){g.optimizationMode&&(j&&j.width&&j.height?(g.encoderConfig=IF(IF({},j),{},{bitrateMin:j.bitrateMin,bitrateMax:j.bitrateMax}),g.optimizationMode!=="motion"&&g.optimizationMode!=="detail"||(h.contentHint=g.optimizationMode,h.contentHint===g.optimizationMode?wE.debug("[".concat(d,"] set content hint to"),g.optimizationMode):wE.debug("[".concat(d,"] set content hint failed")))):wE.warning("[".concat(d,"] can not apply optimization mode bitrate config, no encoderConfig")))}const Hee=sS().name;function qee(d,h,g,j){let _t,_i=0,_o=null;return new a0((ga,_a)=>{setTimeout(()=>{_t&&(_t(),ga(_i))},h),_t=r$(()=>{(function(){_i>j&&_t&&(_t(),ga(_i));const _u=g.getContext("2d");if(!_u){const _g=new f_(c_.UNEXPECTED_ERROR,"can not get canvas 2d context.");return wE.error(_g.toString()),void _a(_g)}_u.drawImage(d,0,0,160,120);const _c=_u.getImageData(0,0,g.width,g.height),_l=Math.floor(_c.data.length/3);if(_o){for(let _g=0;_g<_l;_g+=3)if(_c.data[_g]!==_o[_g])return _i+=1,void(_o=_c.data);_o=_c.data}else _o=_c.data})()},30)})}class DL{constructor(h,g){_h(this,"id",0),_h(this,"element",void 0),_h(this,"peerPair",void 0),_h(this,"context",void 0),_h(this,"audioPlayerElement",void 0),_h(this,"audioTrack",void 0),DL.count+=1,this.id=DL.count,this.element=h,this.context=g}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=h=>{const g=document.createElement("audio");g.srcObject=new MediaStream([h.track]),g.play(),this.audioPlayerElement=g}}async switchSdp(){if(!this.peerPair)return;const h=async(j,_t)=>{const _i=_t==="offer"?await j.createOffer():await j.createAnswer();return await j.setLocalDescription(_i),j.iceGatheringState==="complete"?j.localDescription:new a0(_o=>{j.onicegatheringstatechange=()=>{j.iceGatheringState==="complete"&&_o(j.localDescription)}})},g=async(j,_t)=>await j.setRemoteDescription(_t);try{const j=await h(this.peerPair[0],"offer");await g(this.peerPair[1],j);const _t=await h(this.peerPair[1],"answer");await g(this.peerPair[0],_t)}catch(j){throw new f_(c_.LOCAL_AEC_ERROR,j.toString()).print()}}async getTracksFromMediaElement(h){if(this.audioTrack)return this.audioTrack;let g;try{h instanceof HTMLVideoElement&&(h.captureStream?h.captureStream():h.mozCaptureStream()),g=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(h).connect(g)}catch(_t){throw new f_(c_.LOCAL_AEC_ERROR,_t.toString()).print()}if(!g)throw new f_(c_.LOCAL_AEC_ERROR,"no dest node when local aec").print();const j=g.stream.getAudioTracks()[0];return this.audioTrack=j,j}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const h=this.element,g=await this.getTracksFromMediaElement(h);this.peerPair&&this.peerPair[0].addTrack(g),await this.switchSdp()}close(){wE.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach(h=>{h.close()}),this.peerPair=void 0,this.audioPlayerElement=void 0}}var d7,OF;_h(DL,"count",0);const zee=window.AudioContext||window.webkitAudioContext,Kee=new(d7=b0({report:p0}),G_((OF=class{constructor(){_h(this,"units",[]),_h(this,"context",void 0)}processExternalMediaAEC(d){if(!this._doesEnvironmentNeedAEC())return wE.debug("the system does not need to process local aec"),-1;this.context||(this.context=new zee);let h=this.units.find(g=>g&&g.getElement()===d);return h||(h=new DL(d,this.context),this.units.push(h)),h.startEchoCancellation(),wE.debug("start processing local audio echo cancellation, id is",h.id),h.id}_doesEnvironmentNeedAEC(){return sS().name!==dS.SAFARI}}).prototype,"processExternalMediaAEC",[d7],Object.getOwnPropertyDescriptor(OF.prototype,"processExternalMediaAEC"),OF.prototype),OF);function p7(d,h){var g=Object.keys(d);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(d);h&&(j=j.filter(function(_t){return Object.getOwnPropertyDescriptor(d,_t).enumerable})),g.push.apply(g,j)}return g}function h7(d){for(var h=1;h<arguments.length;h++){var g=arguments[h]!=null?arguments[h]:{};h%2?p7(Object(g),!0).forEach(function(j){_h(d,j,g[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(g)):p7(Object(g)).forEach(function(j){Object.defineProperty(d,j,Object.getOwnPropertyDescriptor(g,j))})}return d}const R6=window||document;function f7(d){let h=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!R6)return;const g=_R._cspEventHandlerPointer;if(g&&h)return void console.error(g,h);const j=_t=>{if(!(_t&&_t.blockedURI&&(_R.onSecurityPolicyViolation||_R.getListeners(ZI.SECURITY_POLICY_VIOLATION).length>0)))return;const _i=_t.blockedURI;__("CSP_DETECTED_HOSTNAME_LIST").some(_o=>_i.includes(_o))&&(_R.onSecurityPolicyViolation&&typeof _R.onSecurityPolicyViolation=="function"&&_R.onSecurityPolicyViolation(_t),_R.getListeners(ZI.SECURITY_POLICY_VIOLATION).length>0&&_R.safeEmit(ZI.SECURITY_POLICY_VIOLATION,_t))};g&&R6.removeEventListener("securitypolicyviolation",g),(h||d&&typeof d=="function"||_R.getListeners(ZI.SECURITY_POLICY_VIOLATION).length>0)&&R6.addEventListener("securitypolicyviolation",j),_R._cspEventHandlerPointer=j}ES("PROCESS_ID","process-".concat(CS(8,""),"-").concat(CS(4,""),"-").concat(CS(4,""),"-").concat(CS(4,""),"-").concat(CS(12,""))),function(){const d=sS();tT.getDisplayMedia=function(h){return!!(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)}(),tT.getStreamFromExtension=d.name===dS.CHROME&&Number(d.version)>34,tT.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const h=new RTCPeerConnection;let g=!1;try{h.addTransceiver("audio"),g=!0}catch{}return h.close(),g}(),tT.supportMinBitrate=d.name===dS.CHROME||d.name===dS.EDGE,tT.supportSetRtpSenderParameters=function(){const h=sS();return!window.RTCRtpSender||!window.RTCRtpSender.prototype.setParameters||!window.RTCRtpSender.prototype.getParameters?!1:!!YN()||!(!sT()&&!pU())||h.name===dS.FIREFOX&&Number(h.version)>=64}(),d.name===dS.SAFARI&&(Number(d.version)>=14?tT.supportDualStream=!0:tT.supportDualStream=!1),tT.webAudioMediaStreamDest=function(){const h=sS();return!(h.name===dS.SAFARI&&Number(h.version)<12)}(),tT.supportReplaceTrack=function(){return window.RTCRtpSender?typeof RTCRtpSender.prototype.replaceTrack=="function":!1}(),tT.supportWebGL=typeof WebGLRenderingContext<"u",tT.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,YN()||(tT.webAudioWithAEC=!0),tT.supportShareAudio=function(){const h=sS();return(h.os===VR.WIN_10||h.os===VR.WIN_81||h.os===VR.WIN_7||h.os===VR.LINUX||h.os===VR.MAC_OS)&&h.name===dS.CHROME&&Number(h.version)>=74}(),tT.supportDualStreamEncoding=function(){const h=sS();return __("DISABLE_WEBAUDIO")?!0:h.name==="Safari"&&Number(h.version)>=14||!!(h.name==="Chrome"&&/Windows/i.test(h.os||"")&&Number(h.version)>=100&&__("CHROME_DUAL_STREAM_USE_ENCODING"))}(),tT.supportDataChannel=function(){return!!(w3(76)||function(h){const g=sS();return!(g.name!==dS.FIREFOX||!g.osVersion)&&Number(g.version)>=h}(68)||function(h){const g=sS();return!(g.name!==dS.SAFARI||!g.osVersion)&&Number(g.version)>=h}(14))}(),tT.supportPCSetConfiguration=function(){const h=window.RTCPeerConnection;return!GS()&&!!h&&h.prototype.setConfiguration instanceof Function}(),tT.supportWebRTCEncodedTransform=function(){const h=sS();return h.name==="Chrome"&&Number(h.version)>=86}(),wE.info("browser compatibility",JSON.stringify(tT),JSON.stringify(d))}(),function(){let d;try{d=window.localStorage.getItem("websdk_ng_global_parameter")}catch(h){return void wE.error("Error loading sdk config",h.message)}if(d)try{const h=JSON.parse(window.atob(d)),g=Date.now();wE.debug("Loading global parameters from cache",h),Object.keys(h).forEach(j=>{if(Object.prototype.hasOwnProperty.call(TT,j)){const{value:_t,expires:_i}=h[j];if(_i&&_i<=g)return;QN[j]=_t,TT[j]=_t}})}catch(h){wE.error("Error loading mutableParamsCache: ".concat(d),h.message)}}(),Array.isArray(QN.AREAS)&&QN.AREAS.length>0&&x5(QN.AREAS,!0);const _R=function(d){const h=new US,g=d,j={getListeners:h.getListeners.bind(h),on:(_t,_i)=>(function(_o,ga){_o===ZI.SECURITY_POLICY_VIOLATION&&f7(ga,!0)}(_t,_i),h.on.bind(h)(_t,_i)),addListener:h.addListener.bind(h),once:h.once.bind(h),off:h.off.bind(h),removeAllListeners:h.removeAllListeners.bind(h),emit:h.emit.bind(h),safeEmit:h.safeEmit.bind(h)};return h7(h7({},g),j)}({__CLIENT_LIST__:ZN,__TRACK_LIST__:pL,VERSION:dI,BUILD:W3,setParameter:(d,h,g)=>{wE.debug("setParameter key:".concat(d,", value:").concat(JSON.stringify(h))),ES(d,h,g)},getParameter:__,getSupportedCodec:async function(){let d={audio:[],video:[]};try{let h=new RTCPeerConnection;h.addTransceiver("video",{direction:"recvonly"}),h.addTransceiver("audio",{direction:"recvonly"});const g=(await h.createOffer()).sdp;if(!g)return d;h.close(),h=null,d=function(j){const _t={video:[],audio:[]};return j.match(/ VP8/i)&&_t.video.push("VP8"),j.match(/ VP9/i)&&_t.video.push("VP9"),j.match(/ AV1/i)&&_t.video.push("AV1"),j.match(/ H264/i)&&_t.video.push("H264"),j.match(/ H265/i)&&_t.video.push("H265"),j.match(/ opus/i)&&_t.audio.push("OPUS"),j.match(/ PCMU/i)&&_t.audio.push("PCMU"),j.match(/ PCMA/i)&&_t.audio.push("PCMA"),j.match(/ G722/i)&&_t.audio.push("G722"),_t}(g)}catch(h){throw new f_(c_.CREATE_OFFER_FAILED,h.toString&&h.toString()).print()}return d},checkSystemRequirements:function(){const d=p0.reportApiInvoke(null,{name:iR.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:kS.TRACER});let h=!1;try{const _i=window.RTCPeerConnection,_o=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,ga=window.WebSocket;h=!!(_i&&_o&&ga)}catch(_i){return wE.error("check system requirement failed: ",_i),!1}let g=!1;const j=sS();j.name===dS.CHROME&&Number(j.version)>=58&&(!ZY()||QY())&&(g=!0),j.name===dS.FIREFOX&&Number(j.version)>=56&&(g=!0),j.name===dS.OPERA&&Number(j.version)>=45&&(g=!0),j.name===dS.SAFARI&&Number(j.version)>=11&&(g=!0),(A2()||sS().name===dS.QQ)&&(g=!0),wE.debug("checkSystemRequirements, api:",h,"browser",g);const _t=h&&g;return d.onSuccess(_t),_t},getDevices:function(d){return _C.enumerateDevices(!0,!0,d)},getMicrophones:function(d){return _C.getRecordingDevices(d)},getCameras:function(d){return _C.getCamerasDevices(d)},getElectronScreenSources:a$,getPlaybackDevices:function(d){return _C.getSpeakers(d)},createClient:function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const h=p0.reportApiInvoke(null,{name:iR.CREATE_CLIENT,options:[d],tag:kS.TRACER});try{OX(d)}catch(g){throw h.onError(g),g}return d.audioCodec===void 0&&(d.audioCodec="opus"),h.onSuccess(),new Gee(xL(xL({forceWaitGatewayResponse:!0},d),{},{role:d.mode==="rtc"?"host":d.role||"audience"}))},createCameraVideoTrack:async function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const h=p0.reportApiInvoke(null,{tag:kS.TRACER,name:iR.CREATE_CAM_VIDEO_TRACK,options:[IF({},d)]}),g=$U(d),j=CS(8,"track-cam-");let _t=null;wE.info("start create camera video track with config",JSON.stringify(d),"trackId",j);try{_t=(await kI({video:g},j)).getVideoTracks()[0]||null}catch(_o){throw h.onError(_o),_o}if(!_t){const _o=new f_(c_.UNEXPECTED_ERROR,"can not find track in media stream");return h.onError(_o),_o.throw()}d.optimizationMode&&S6(j,_t,d,XN(d.encoderConfig));const _i=new N8(_t,d,g,d.scalabiltyMode?TU(d.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},d.optimizationMode,j);return h.onSuccess(_i.getTrackId()),wE.info("create camera video success, trackId:",j),_i},createCustomVideoTrack:function(d){const h=p0.reportApiInvoke(null,{tag:kS.TRACER,name:iR.CREATE_CUSTOM_VIDEO_TRACK,options:[d]}),g=new cR(d.mediaStreamTrack,{width:d.width,height:d.height,frameRate:d.frameRate,bitrateMax:d.bitrateMax,bitrateMin:d.bitrateMin},d.scalabiltyMode?TU(d.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},d.optimizationMode,CS(8,"track-cus-"),[ER.CUSTOM_TRACK]);return h.onSuccess(g.getTrackId()),wE.info("create custom video track success with config",d,"trackId",g.getTrackId()),g},createScreenVideoTrack:async function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"disable";const g=p0.reportApiInvoke(null,{tag:kS.TRACER,name:iR.CREATE_SCREEN_VIDEO_TRACK,options:[IF({},d),h]});d.encoderConfig?typeof d.encoderConfig=="string"||d.encoderConfig.width&&d.encoderConfig.height||(d.encoderConfig.width={max:1920},d.encoderConfig.height={max:1080}):d.encoderConfig="1080p_2";const j=vZ(d),_t=CS(8,"track-scr-v-");let _i=null,_o=null;const ga=QS();if(!ga.supportShareAudio&&h==="enable"){const _c=new f_(c_.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return g.onError(_c),_c.throw()}wE.info("start create screen video track with config",d,"withAudio",h,"trackId",_t);try{const _c=await kI({screen:j,screenAudio:h==="auto"?ga.supportShareAudio:h==="enable"},_t);_i=_c.getVideoTracks()[0]||null,_o=_c.getAudioTracks()[0]||null}catch(_c){throw g.onError(_c),_c}if(!_i){const _c=new f_(c_.UNEXPECTED_ERROR,"can not find track in media stream");return g.onError(_c),_c.throw()}if(!_o&&h==="enable"){_i&&_i.stop();const _c=new f_(c_.SHARE_AUDIO_NOT_ALLOWED);return g.onError(_c),_c.throw()}d.optimizationMode||(d.optimizationMode="detail"),d.optimizationMode&&(S6(_t,_i,d,d.encoderConfig&&q3(d.encoderConfig)),d.encoderConfig&&typeof d.encoderConfig!="string"&&(d.encoderConfig.bitrateMin=d.encoderConfig.bitrateMax));const _a=new cR(_i,d.encoderConfig?q3(d.encoderConfig):{},d.scalabiltyMode?TU(d.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},d.optimizationMode,_t,[ER.SCREEN_TRACK]);if(!_o)return g.onSuccess(_a.getTrackId()),wE.info("create screen video track success","video:",_a.getTrackId()),_a;const _u=new zR(_o,void 0,CS(8,"track-scr-a-"),!1,!0);return g.onSuccess([_a.getTrackId(),_u.getTrackId()]),wE.info("create screen video track success","video:",_a.getTrackId(),"audio:",_u.getTrackId()),[_a,_u]},createMicrophoneAndCameraTracks:async function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const g=p0.reportApiInvoke(null,{tag:kS.TRACER,name:iR.CREATE_MIC_AND_CAM_TRACKS,options:[d,h]}),j=$U(h),_t=YW(d),_i=CS(8,"track-mic-"),_o=CS(8,"track-cam-");let ga=null,_a=null;wE.info("start create camera video track(".concat(_o,") and microphone audio track(").concat(_i,") with config, audio: ").concat(JSON.stringify(d),", video: ").concat(JSON.stringify(h)));try{const _l=await kI({audio:_t,video:j},"".concat(_i,"-").concat(_o));ga=_l.getAudioTracks()[0],_a=_l.getVideoTracks()[0]}catch(_l){throw g.onError(_l),_l}if(!ga||!_a){const _l=new f_(c_.UNEXPECTED_ERROR,"can not find tracks in media stream");return g.onError(_l),_l.throw()}h.optimizationMode&&S6(_o,_a,h,XN(h.encoderConfig));const _u=new DU(ga,d,_t,_i),_c=new N8(_a,h,j,h.scalabiltyMode?TU(h.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},h.optimizationMode,_o);return g.onSuccess([_u.getTrackId(),_c.getTrackId()]),wE.info("create camera video track(".concat(_o,") and microphone audio track(").concat(_i,") success")),[_u,_c]},createMicrophoneAudioTrack:async function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const h=p0.reportApiInvoke(null,{tag:kS.TRACER,name:iR.CREATE_MIC_AUDIO_TRACK,options:[d]}),g=YW(d),j=CS(8,"track-mic-");let _t=null;wE.info("start create microphone audio track with config",JSON.stringify(d),"trackId",j);try{_t=(await kI({audio:g},j)).getAudioTracks()[0]||null}catch(_o){throw h.onError(_o),_o}if(!_t){const _o=new f_(c_.UNEXPECTED_ERROR,"can not find track in media stream");return h.onError(_o),_o.throw()}const _i=new DU(_t,d,g,j);return h.onSuccess(_i.getTrackId()),wE.info("create microphone audio track success, trackId:",j),_i},createCustomAudioTrack:function(d){const h=p0.reportApiInvoke(null,{tag:kS.TRACER,name:iR.CREATE_CUSTOM_AUDIO_TRACK,options:[d]}),g=new zR(d.mediaStreamTrack,d.encoderConfig?wU(d.encoderConfig):{},CS(8,"track-cus-"),!1,!0);return wE.info("create custom audio track success with config",d,"trackId",g.getTrackId()),h.onSuccess(g.getTrackId()),g},createBufferSourceAudioTrack:async function(d){const h=p0.reportApiInvoke(null,{tag:kS.TRACER,name:iR.CREATE_BUFFER_AUDIO_TRACK,options:[d]});if(__("DISABLE_WEBAUDIO"))throw new f_(c_.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const g=CS(8,"track-buf-");wE.info("start create buffer source audio track with config",JSON.stringify(d),"trackId",g);const j=d.source;if(!(d.source instanceof AudioBuffer))try{d.source=await Wee(d.source,d.cacheOnlineFile)}catch(_o){return h.onError(_o),_o.throw()}const _t=new $ee(d.source),_i=new YQ(j,_t,d.encoderConfig?wU(d.encoderConfig):{},g);return wE.info("create buffer source audio track success, trackId:",g),h.onSuccess(_i.getTrackId()),_i},setAppType:function(d){if(wE.debug("setAppType: ".concat(d)),!(Number.isInteger(d)&&d>=0))throw wE.debug("Invalid appType"),new f_(c_.INVALID_PARAMS,"invalid app type",d);ES("APP_TYPE",Math.floor(d))},setLogLevel:function(d){wE.setLogLevel(d)},enableLogUpload:function(){__("USE_NEW_LOG")?ES("UPLOAD_LOG",!0):wE.enableLogUpload()},disableLogUpload:function(){__("USE_NEW_LOG")?ES("UPLOAD_LOG",!1):wE.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new GW},checkAudioTrackIsActive:async function(d){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const g=p0.reportApiInvoke(null,{tag:kS.TRACER,name:iR.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[h]});if(!(d instanceof zR||d instanceof _F)){const _a=new f_(c_.INVALID_TRACK,"the parameter is not a audio track");return g.onError(_a),_a.throw()}h&&h<1e3&&(h=1e3);const j=d instanceof zR?d.getTrackLabel():"remote_track",_t=d.getVolumeLevel();let _i=_t,_o=_t;const ga=Date.now();return new a0(_a=>{const _u=setInterval(()=>{const _c=d.getVolumeLevel();_i=_c>_i?_c:_i,_o=_c<_o?_c:_o;const _l=_i-_o>1e-4,_g=Date.now()-ga;if(_l||_g>h){clearInterval(_u);const r_=_l,l_={duration:_g,deviceLabel:j,maxVolumeLevel:_i,result:r_};wE.info("[track-".concat(d.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(l_))),g.onSuccess(l_),_a(r_)}},200)})},checkVideoTrackIsActive:async function(d){let h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5e3;const g=p0.reportApiInvoke(null,{tag:kS.TRACER,name:iR.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[h]});if(!(d instanceof cR||d instanceof EF)){const _g=new f_(c_.INVALID_TRACK,"the parameter is not a video track");return g.onError(_g),_g.throw()}const j=4;h&&h<1e3&&(h=1e3);const _t=d instanceof cR?d.getTrackLabel():"remote_track",_i=d.getMediaStreamTrack(!0),_o=document.createElement("video");_o.style.width="1px",_o.style.height="1px",_o.setAttribute("muted",""),_o.muted=!0,_o.setAttribute("playsinline",""),_o.controls=!1,(sT()||pU())&&(_o.style.opacity="0.01",_o.style.position="fixed",_o.style.left="0",_o.style.top="0",document.body.appendChild(_o)),_o.srcObject=new MediaStream([_i]),_o.play();const ga=document.createElement("canvas");ga.width=160,ga.height=120;let _a=0,_u=0;try{const _g=Date.now();_a=await qee(_o,h,ga,j),_u=Date.now()-_g}catch(_g){throw g.onError(_g),_g}Hee===dS.SAFARI&&(_o.pause(),_o.remove()),_o.srcObject=null;const _c=_a>j,_l={duration:_u,changedPicNum:_a,deviceLabel:_t,result:_c};return wE.info("[track-".concat(d.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(_l))),g.onSuccess(_l),_c},setArea:x5,audioElementPlayCenter:FT,processExternalMediaAEC:function(d){Kee.processExternalMediaAEC(d)},registerExtensions:function(d){d.forEach(h=>{const g=h;g.__registered__=!0,g.logger.hookLog=wE.extLog,g.reporter.hookApiInvoke=p0.extApiInvoke,g.parameters&&Object.keys(g.parameters).forEach(j=>{g.parameters[j]=__(j)})})},ChannelMediaRelayError:uN,ChannelMediaRelayEvent:XI,ChannelMediaRelayState:uT,RemoteStreamFallbackType:l5,RemoteStreamType:u5,ConnectionDisconnectedReason:aS,AudienceLatencyLevelType:i5,AREAS:z0});return Object.defineProperties(_R,{onAudioAutoplayFailed:{get:()=>ZT.onAudioAutoplayFailed,set:d=>{ZT.onAudioAutoplayFailed=d}},onAutoplayFailed:{get:()=>ZT.onAutoplayFailed,set:d=>{ZT.onAutoplayFailed=d}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>_R._onSecurityPolicyViolation,set(d){_R._onSecurityPolicyViolation=d,f7(d)}}}),_C.on(FO.CAMERA_DEVICE_CHANGED,d=>{wE.info("camera device changed",JSON.stringify(d)),_R.onCameraChanged&&_R.onCameraChanged(d),_R.safeEmit(ZI.CAMERA_CHANGED,d)}),_C.on(FO.RECORDING_DEVICE_CHANGED,d=>{wE.info("microphone device changed",JSON.stringify(d)),_R.onMicrophoneChanged&&_R.onMicrophoneChanged(d),_R.safeEmit(ZI.MICROPHONE_CHANGED,d)}),_C.on(FO.PLAYOUT_DEVICE_CHANGED,d=>{wE.debug("playout device changed",JSON.stringify(d)),_R.onPlaybackDeviceChanged&&_R.onPlaybackDeviceChanged(d),_R.safeEmit(ZI.PLAYBACK_DEVICE_CHANGED,d)}),FT.onAutoplayFailed=()=>{wE.info("detect audio element autoplay failed"),ZT.onAudioAutoplayFailed&&ZT.onAudioAutoplayFailed()},cS.on("autoplay-failed",()=>{wE.info("detect webaudio autoplay failed"),ZT.onAudioAutoplayFailed&&ZT.onAudioAutoplayFailed(),_R.safeEmit(ZI.AUTOPLAY_FAILED)}),window&&(window.__ARTC__=_R),_R})})(AgoraRTC_NProduction);var AgoraRTC_NProductionExports=AgoraRTC_NProduction.exports;const AgoraRTC=getDefaultExportFromCjs(AgoraRTC_NProductionExports);function _objectWithoutPropertiesLoose(e,o){if(e==null)return{};var s={},a=Object.keys(e),_,$;for($=0;$<a.length;$++)_=a[$],!(o.indexOf(_)>=0)&&(s[_]=e[_]);return s}var AgoraRTCErrorCode;(function(e){e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE"})(AgoraRTCErrorCode||(AgoraRTCErrorCode={}));var createClient=function(o){var s;function a(){return s||(s=AgoraRTC.createClient(o)),s}return function(){return a()}};function createMicrophoneAndCameraTracks(e,o){var s=function(){try{return Promise.resolve(AgoraRTC.createMicrophoneAndCameraTracks(e,o)).then(function($){return a=$,a})}catch($){return Promise.reject($)}},a=null;return function(){var $=reactExports.useState(!1),_e=$[0],_n=$[1],_r=reactExports.useState(null),_s=_r[0],na=_r[1],ba=reactExports.useRef(a);return reactExports.useEffect(function(){return ba.current===null?s().then(function(_p){ba.current=_p,_n(!0)},function(_p){na(_p)}):_n(!0),function(){a=null}},[]),{ready:_e,tracks:ba.current,error:_s}}}var AgoraVideoPlayer=function(o){var s=reactExports.useRef(null),a=o.videoTrack,_=o.config,$=_objectWithoutPropertiesLoose(o,["videoTrack","config"]);return reactExports.useLayoutEffect(function(){return s.current!==null&&a.play(s.current,_),function(){a.stop()}},[a]),React.createElement("div",Object.assign({},$,{ref:s}))},agoraRtmSdk={exports:{}};agoraRtmSdk.exports;(function(module,exports){var define_process_env_default={};/*
 @preserve
 AgoraRTM Web SDK 1.5.1 - commit: v1.5.1-0-g5bbbcd72
 Copyright (C) 2018-2022 Agora Lab.
 This file is licensed under the AGORA, INC. SDK LICENSE AGREEMENT
 A copy of this license may be found at https://www.agora.io/en/sdk-license-agreement/
*/(function(e,o){module.exports=o()})(commonjsGlobal,function(){function Be(e,o){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);o&&(a=a.filter(function(_){return Object.getOwnPropertyDescriptor(e,_).enumerable})),s.push.apply(s,a)}return s}function Wa(e){for(var o=1;o<arguments.length;o++){var s=arguments[o]!=null?arguments[o]:{};o%2?Be(Object(s),!0).forEach(function(a){x(e,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Be(Object(s)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(s,a))})}return e}function qa(e){return(qa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(e)}function wm(e,o,s,a,_,$,_e){try{var _n=e[$](_e),_r=_n.value}catch(_s){return void s(_s)}_n.done?o(_r):Promise.resolve(_r).then(a,_)}function ma(e){return function(){var o=this,s=arguments;return new Promise(function(a,_){function $(_r){wm(_n,a,_,$,_e,"next",_r)}function _e(_r){wm(_n,a,_,$,_e,"throw",_r)}var _n=e.apply(o,s);$(void 0)})}}function va(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function xm(e,o){for(var s=0;s<o.length;s++){var a=o[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function eb(e,o,s){return o&&xm(e.prototype,o),s&&xm(e,s),e}function x(e,o,s){return o in e?Object.defineProperty(e,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[o]=s,e}function Ga(e,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),o&&Jf(e,o)}function Td(e){return(Td=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(e)}function Jf(e,o){return(Jf=Object.setPrototypeOf||function(s,a){return s.__proto__=a,s})(e,o)}function ym(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Ji(e,o,s){return(Ji=ym()?Reflect.construct:function(a,_,$){var _e=[null];return _e.push.apply(_e,_),a=new(Function.bind.apply(a,_e)),$&&Jf(a,$.prototype),a}).apply(null,arguments)}function Kf(e){var o=typeof Map=="function"?new Map:void 0;return(Kf=function(s){function a(){return Ji(s,arguments,Td(this).constructor)}if(s===null||Function.toString.call(s).indexOf("[native code]")===-1)return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(o!==void 0){if(o.has(s))return o.get(s);o.set(s,a)}return a.prototype=Object.create(s.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),Jf(a,s)})(e)}function Ki(e,o){if(e==null)return{};if(e==null)var s={};else{s={};var a,_=Object.keys(e);for(a=0;a<_.length;a++){var $=_[a];0<=o.indexOf($)||(s[$]=e[$])}}if(Object.getOwnPropertySymbols)for(a=Object.getOwnPropertySymbols(e),$=0;$<a.length;$++)_=a[$],0<=o.indexOf(_)||Object.prototype.propertyIsEnumerable.call(e,_)&&(s[_]=e[_]);return s}function z(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ha(e){var o=ym();return function(){var s=Td(e);if(o){var a=Td(this).constructor;s=Reflect.construct(s,arguments,a)}else s=s.apply(this,arguments);return s=!s||typeof s!="object"&&typeof s!="function"?z(this):s}}function Li(e,o,s){return(Li=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(a,_,$){for(;!Object.prototype.hasOwnProperty.call(a,_)&&(a=Td(a))!==null;);if(a)return(_=Object.getOwnPropertyDescriptor(a,_)).get?_.get.call($):_.value})(e,o,s||e)}function $a(e,o){var s=Array.isArray(e)?e:void 0;if(!s)if((s=e&&(typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"]))==null)s=void 0;else{var a,_=[],$=!0,_e=!1;try{for(s=s.call(e);!($=(a=s.next()).done)&&(_.push(a.value),!o||_.length!==o);$=!0);}catch(_r){_e=!0;var _n=_r}finally{try{$||s.return==null||s.return()}finally{if(_e)throw _n}}s=_}if(!(e=s||zm(e,o)))throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return e}function Z(e){var o=Array.isArray(e)?Mi(e):void 0;if(o||(o=typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null?Array.from(e):void 0),!(e=o||zm(e)))throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`);return e}function zm(e,o){if(e){if(typeof e=="string")return Mi(e,o);var s=Object.prototype.toString.call(e).slice(8,-1);if(s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set")return Array.from(e);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Mi(e,o)}}function Mi(e,o){(o==null||o>e.length)&&(o=e.length);for(var s=0,a=Array(o);s<o;s++)a[s]=e[s];return a}function Da(e,o,s,a,_){var $={};return Object.keys(a).forEach(function(_e){$[_e]=a[_e]}),$.enumerable=!!$.enumerable,$.configurable=!!$.configurable,("value"in $||$.initializer)&&($.writable=!0),$=s.slice().reverse().reduce(function(_e,_n){return _n(e,o,_e)||_e},$),_&&$.initializer!==void 0&&($.value=$.initializer?$.initializer.call(_):void 0,$.initializer=void 0),$.initializer===void 0&&(Object.defineProperty(e,o,$),$=null),$}function xb(e){var o={exports:{}};return e(o,o.exports),o.exports}function Ce(e){e||(e={});var o=e.ua;if(o||typeof navigator>"u"||(o=navigator.userAgent),o&&o.headers&&typeof o.headers["user-agent"]=="string"&&(o=o.headers["user-agent"]),typeof o!="string")return!1;var s=Zt.test(o)&&!$t.test(o)||!!e.tablet&&au.test(o);return!s&&e.tablet&&e.featureDetect&&navigator&&1<navigator.maxTouchPoints&&o.indexOf("Macintosh")!==-1&&o.indexOf("Safari")!==-1&&(s=!0),s}function Am(e,o){var s,a=3>arguments.length?e:arguments[2];return Ia(e)===a?e[o]:(s=dc.f(e,o))?ka(s,"value")?s.value:s.get===void 0?void 0:s.get.call(a):xa(s=uc(e))?Am(s,o,a):void 0}function bu(e){var o=e.charCodeAt(0)<<24,s=0|cu(~o),a=0,_=0|e.length,$="";if(5>s&&_>=s){for(o=o<<s>>>24+s,a=1;a<s;a=a+1|0)o=o<<6|63&e.charCodeAt(a);65535>=o?$+=Ud(o):1114111>=o?$+=Ud(55296+((o=o-65536|0)>>10)|0,56320+(1023&o)|0):a=0}for(;a<_;a=a+1|0)$+="";return $}function Bm(){}function du(e){var o=0|e.charCodeAt(0);if(55296<=o&&56319>=o){var s=0|e.charCodeAt(1);if(!(s==s&&56320<=s&&57343>=s))return Ud(239,191,189);if(65535<(o=(o-55296<<10)+s-56320+65536|0))return Ud(240|o>>>18,128|o>>>12&63,128|o>>>6&63,128|63&o)}return 127>=o?e:2047>=o?Ud(192|o>>>6,128|63&o):Ud(224|o>>>12,128|o>>>6&63,128|63&o)}function Cm(){}function Ba(){Ba.init.call(this)}function Wg(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+qa(e))}function Dm(e,o,s,a){Wg(s);var _=e._events;if(_===void 0)_=e._events=Object.create(null),e._eventsCount=0;else{_.newListener!==void 0&&(e.emit("newListener",o,s.listener?s.listener:s),_=e._events);var $=_[o]}return $===void 0?(_[o]=s,++e._eventsCount):(typeof $=="function"?$=_[o]=a?[s,$]:[$,s]:a?$.unshift(s):$.push(s),0<(s=e._maxListeners===void 0?Ba.defaultMaxListeners:e._maxListeners)&&$.length>s&&!$.warned&&($.warned=!0,(s=Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(o)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",s.emitter=e,s.type=o,s.count=$.length,console&&console.warn&&console.warn(s))),e}function eu(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Em(e,o,s){return e={fired:!1,wrapFn:void 0,target:e,type:o,listener:s},(o=eu.bind(e)).listener=s,e.wrapFn=o}function Fm(e,o,s){if((e=e._events)===void 0)return[];if((o=e[o])===void 0)return[];if(typeof o=="function")return s?[o.listener||o]:[o];if(s)for(s=Array(o.length),e=0;e<s.length;++e)s[e]=o[e].listener||o[e];else s=Gm(o,o.length);return s}function Hm(e){var o=this._events;if(o!==void 0){if(typeof(e=o[e])=="function")return 1;if(e!==void 0)return e.length}return 0}function Gm(e,o){for(var s=Array(o),a=0;a<o;++a)s[a]=e[a];return s}function fu(e,o,s){typeof e.on=="function"&&Im(e,"error",o,s)}function Im(e,o,s,a){if(typeof e.on=="function")a.once?e.once(o,s):e.on(o,s);else{if(typeof e.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+qa(e));e.addEventListener(o,function _($){a.once&&e.removeEventListener(o,_),s($)})}}function gu(e){return e?Z(e):hu(function(){return[]},function(o,s){return o.push(s),o})}function Jm(e,o){var s,a,_,$;return N.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:s=Km(e)([Lm,Lm,function(_n,_r){return _r}])[2],a=0;case 2:if(!(a<o.length)){_e.next=17;break}if(_=o[a],!(($=s(Ni,_))instanceof Xg)){_e.next=11;break}if(($=Oi($.deref()))===Ni){_e.next=10;break}return _e.next=10,$;case 10:return _e.abrupt("return");case 11:if($===Ni){_e.next=14;break}return _e.next=14,$;case 14:a++,_e.next=2;break;case 17:case"end":return _e.stop()}},iu)}function Yg(e,o){return o!=null&&typeof o[Symbol.iterator]=="function"?Jm(Yg(e),o):function(s){var a=s[2];return ju(s,function(_,$){return a(_,e($))})}}function $c(e){return Object.prototype.toString.call(e).slice(8,-1)}function De(e){return $c(e)==="Object"&&e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function Mm(e){var o;return(o=$c(e)==="Boolean"||$c(e)==="Null"||$c(e)==="Undefined")||(o=$c(e)==="Number"&&!isNaN(e)),o||$c(e)==="String"||$c(e)==="Symbol"}function Vd(e){var o=-1,s=e==null?0:e.length;for(this.clear();++o<s;){var a=e[o];this.set(a[0],a[1])}}function Ee(e){var o=-1,s=e==null?0:e.length;for(this.clear();++o<s;){var a=e[o];this.set(a[0],a[1])}}function Fe(e){var o=-1,s=e==null?0:e.length;for(this.clear();++o<s;){var a=e[o];this.set(a[0],a[1])}}function Lf(e){var o=-1,s=e==null?0:e.length;for(this.__data__=new Zg;++o<s;)this.add(e[o])}function Ge(e){this.size=(this.__data__=new $g(e)).size}function He(e,o,s,a,_,$){var _e,_n=1&o,_r=2&o,_s=4&o;if(s&&(_e=_?s(e,a,_,$):s(e)),_e!==void 0)return _e;if(!Gb(e))return e;if(a=ub(e)){if(_e=ku(e),!_n)return Pi(e,_e)}else{var na=Mf(e),ba=na=="[object Function]"||na=="[object GeneratorFunction]";if(Nf(e))return Nm(e,_n);if(na=="[object Object]"||na=="[object Arguments]"||ba&&!_){if(_e=_r||ba?{}:Om(e),!_n)return _r?lu(e,mu(_e,e)):nu(e,ou(_e,e))}else{if(!Oa[na])return _?e:{};_e=pu(e,na,_n)}}if($||($=new Ie),_=$.get(e))return _;$.set(e,_e),qu(e)?e.forEach(function(_f){_e.add(He(_f,o,s,_f,e,$))}):ru(e)&&e.forEach(function(_f,_E){_e.set(_E,He(_f,o,s,_E,e,$))}),_r=_s?_r?Pm:Qi:_r?Of:Wd;var _p=a?void 0:_r(e);return su(_p||e,function(_f,_E){_p&&(_f=e[_E=_f]),Qm(_e,_E,He(_f,o,s,_E,e,$))}),_e}function Ri(e,o){if(typeof e!="function"||o!=null&&typeof o!="function")throw new TypeError("Expected a function");var s=function a(){var _=arguments,$=o?o.apply(this,_):_[0],_e=a.cache;return _e.has($)?_e.get($):(_=e.apply(this,_),a.cache=_e.set($,_)||_e,_)};return s.cache=new(Ri.Cache||Zg),s}function Rm(e){if(typeof e=="string")return e;if(ub(e))return Je(e,Rm)+"";if(Ke(e))return Sm?Sm.call(e):"";var o=e+"";return o=="0"&&1/e==-tu?"-0":o}function Si(e,o,s,a,_){var $=-1,_e=e.length;for(s||(s=uu),_||(_=[]);++$<_e;){var _n=e[$];0<o&&s(_n)?1<o?Si(_n,o-1,s,a,_):Ti(_,_n):a||(_[_.length]=_n)}return _}function Le(e,o,s,a,_){if(e===o)o=!0;else if(e==null||o==null||!Hc(e)&&!Hc(o))o=e!=e&&o!=o;else e:{var $=ub(e),_e=ub(o),_n=$?"[object Array]":Mf(e),_r=_e?"[object Array]":Mf(o),_s=(_n=_n=="[object Arguments]"?"[object Object]":_n)=="[object Object]";if(_e=(_r=_r=="[object Arguments]"?"[object Object]":_r)=="[object Object]",(_r=_n==_r)&&Nf(e)){if(!Nf(o)){o=!1;break e}$=!0,_s=!1}if(_r&&!_s)_||(_=new Ie),o=$||Ui(e)?Tm(e,o,s,a,Le,_):vu(e,o,_n,s,a,Le,_);else{if(!(1&s)&&($=_s&&Um.call(e,"__wrapped__"),_n=_e&&Um.call(o,"__wrapped__"),$||_n)){e=$?e.value():e,o=_n?o.value():o,_||(_=new Ie),o=Le(e,o,s,a,_);break e}if(_r)t:if(_||(_=new Ie),$=1&s,_n=Qi(e),_e=_n.length,_r=Qi(o).length,_e==_r||$){for(_r=_e;_r--;){var na=_n[_r];if(!($?na in o:wu.call(o,na))){o=!1;break t}}if(_s=_.get(e),na=_.get(o),_s&&na)o=_s==o&&na==e;else{_s=!0,_.set(e,o),_.set(o,e);for(var ba=$;++_r<_e;){var _p=e[na=_n[_r]],_f=o[na];if(a)var _E=$?a(_f,_p,na,o,e,_):a(_p,_f,na,e,o,_);if(_E===void 0?_p!==_f&&!Le(_p,_f,s,a,_):!_E){_s=!1;break}ba||(ba=na=="constructor")}_s&&!ba&&(s=e.constructor)!=(a=o.constructor)&&"constructor"in e&&"constructor"in o&&!(typeof s=="function"&&s instanceof s&&typeof a=="function"&&a instanceof a)&&(_s=!1),_.delete(e),_.delete(o),o=_s}}else o=!1;else o=!1}}return o}function Pa(e,o,s){this.low=0|e,this.high=0|o,this.unsigned=!!s}function Hb(e){return(e&&e.__isLong__)===!0}function Xd(e,o){var s;if(o){if((o=0<=(e>>>=0)&&256>e)&&(s=Vm[e]))return s;s=Qa(e,0>(0|e)?-1:0,!0),o&&(Vm[e]=s)}else{if((o=-128<=(e|=0)&&128>e)&&(s=Wm[e]))return s;s=Qa(e,0>e?-1:0,!1),o&&(Wm[e]=s)}return s}function ec(e,o){if(isNaN(e))return o?Yd:fc;if(o){if(0>e)return Yd;if(e>=Xm)return Ym}else{if(e<=-Zm)return Ib;if(e+1>=Zm)return $m}return 0>e?ec(-e,o).neg():Qa(e%Me|0,e/Me|0,o)}function Qa(e,o,s){return new Pa(e,o,s)}function Vi(e,o,s){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return fc;if(typeof o=="number"?(s=o,o=!1):o=!!o,2>(s=s||10)||36<s)throw RangeError("radix");var a;if(0<(a=e.indexOf("-")))throw Error("interior hyphen");if(a===0)return Vi(e.substring(1),o,s).neg();a=ec(ah(s,8));for(var _=fc,$=0;$<e.length;$+=8){var _e=Math.min(8,e.length-$),_n=parseInt(e.substring($,$+_e),s);8>_e?(_e=ec(ah(s,_e)),_=_.mul(_e).add(ec(_n))):_=(_=_.mul(a)).add(ec(_n))}return _.unsigned=o,_}function vc(e,o){return typeof e=="number"?ec(e,o):typeof e=="string"?Vi(e,o):Qa(e.low,e.high,typeof o=="boolean"?o:e.unsigned)}function ha(e,o){function s(){this.constructor=e}Wi(e,o),e.prototype=o===null?Object.create(o):(s.prototype=o.prototype,new s)}function Ne(e){return typeof e=="function"}function Oe(e){setTimeout(function(){throw e},0)}function Xi(e){return e!==null&&qa(e)==="object"}function an(e){return e.reduce(function(o,s){return o.concat(s instanceof Pf?s.errors:s)},[])}function Yi(e){for(;e;){var o=e.destination,s=e.isStopped;if(e.closed||s)return!1;e=o&&o instanceof za?o:null}return!0}function wd(e){return e}function Zi(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return bn(e)}function bn(e){return e.length===0?wd:e.length===1?e[0]:function(o){return e.reduce(function(s,a){return a(s)},o)}}function cn(e){if(e||(e=gc.Promise||Promise),!e)throw Error("no Promise impl found");return e}function dn(){return function(e){return e.lift(new xu(e))}}function Qf(e){return e?yu(e):Sb}function yu(e){return new ua(function(o){return e.schedule(function(){return o.complete()})})}function ad(e){return e&&typeof e.schedule=="function"}function $i(e,o){return new ua(function(s){var a=new nb,_=0;return a.add(o.schedule(function(){_===e.length?s.complete():(s.next(e[_++]),s.closed||a.add(this.schedule()))})),a})}function Rf(e,o){return o?$i(e,o):new ua(en(e))}function ob(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return ad(o=e[e.length-1])?(e.pop(),$i(e,o)):Rf(e)}function ra(e,o){return new ua(o?function(s){return o.schedule(zu,0,{error:e,subscriber:s})}:function(s){return s.error(e)})}function zu(e){e.subscriber.error(e.error)}function Au(e,o){return o===void 0&&(o=0),function(s){return s.lift(new Bu(e,o))}}function fn(e){return e in aj&&(delete aj[e],!0)}function Ic(){}function Ea(e,o){return function(s){if(typeof e!="function")throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return s.lift(new Cu(e,o))}}function gn(e,o,s){if(o){if(!ad(o))return function(){for(var a=[],_=0;_<arguments.length;_++)a[_]=arguments[_];return gn(e,s).apply(void 0,a).pipe(Ea(function($){return hc($)?o.apply(void 0,$):o($)}))};s=o}return function(){for(var a=[],_=0;_<arguments.length;_++)a[_]=arguments[_];var $,_e=this,_n={context:_e,subject:$,callbackFunc:e,scheduler:s};return new ua(function(_r){if(s)return s.schedule(Du,0,{args:a,subscriber:_r,params:_n});if(!$){$=new Sf;try{e.apply(_e,a.concat([function(){for(var _s=[],na=0;na<arguments.length;na++)_s[na]=arguments[na];$.next(1>=_s.length?_s[0]:_s),$.complete()}]))}catch(_s){Yi($)?$.error(_s):console.warn(_s)}}return $.subscribe(_r)})}}function Du(e){var o=this,s=e.args,a=e.subscriber,_=e.params;e=_.callbackFunc;var $=_.context,_e=_.scheduler,_n=_.subject;if(!_n){_n=_.subject=new Sf,_=function(){for(var _r=[],_s=0;_s<arguments.length;_s++)_r[_s]=arguments[_s];o.add(_e.schedule(Eu,0,{value:1>=_r.length?_r[0]:_r,subject:_n}))};try{e.apply($,s.concat([_]))}catch(_r){_n.error(_r)}}this.add(_n.subscribe(a))}function Eu(e){var o=e.subject;o.next(e.value),o.complete()}function hn(e,o,s){if(o){if(!ad(o))return function(){for(var a=[],_=0;_<arguments.length;_++)a[_]=arguments[_];return hn(e,s).apply(void 0,a).pipe(Ea(function($){return hc($)?o.apply(void 0,$):o($)}))};s=o}return function(){for(var a=[],_=0;_<arguments.length;_++)a[_]=arguments[_];var $={subject:void 0,args:a,callbackFunc:e,scheduler:s,context:this};return new ua(function(_e){var _n=$.context,_r=$.subject;if(s)return s.schedule(Fu,0,{params:$,subscriber:_e,context:_n});if(!_r){_r=$.subject=new Sf;try{e.apply(_n,a.concat([function(){for(var _s=[],na=0;na<arguments.length;na++)_s[na]=arguments[na];(na=_s.shift())?_r.error(na):(_r.next(1>=_s.length?_s[0]:_s),_r.complete())}]))}catch(_s){Yi(_r)?_r.error(_s):console.warn(_s)}}return _r.subscribe(_e)})}}function Fu(e){var o=this,s=e.params,a=e.subscriber;e=e.context;var _=s.callbackFunc,$=s.args,_e=s.scheduler,_n=s.subject;if(!_n){_n=s.subject=new Sf,s=function(){for(var _r=[],_s=0;_s<arguments.length;_s++)_r[_s]=arguments[_s];(_s=_r.shift())?o.add(_e.schedule(jn,0,{err:_s,subject:_n})):o.add(_e.schedule(Gu,0,{value:1>=_r.length?_r[0]:_r,subject:_n}))};try{_.apply(e,$.concat([s]))}catch(_r){this.add(_e.schedule(jn,0,{err:_r,subject:_n}))}}this.add(_n.subscribe(a))}function Gu(e){var o=e.subject;o.next(e.value),o.complete()}function jn(e){e.subject.error(e.err)}function kn(e){return!!e&&typeof e.subscribe!="function"&&typeof e.then=="function"}function bj(e,o,s,a,_){if(_===void 0&&(_=new Hu(e,s,a)),!_.closed)return o instanceof ua?o.subscribe(_):Tf(o)(_)}function Iu(e,o){return new ua(function(s){var a=new nb;return a.add(o.schedule(function(){var _=e[Pe]();a.add(_.subscribe({next:function($){a.add(o.schedule(function(){return s.next($)}))},error:function($){a.add(o.schedule(function(){return s.error($)}))},complete:function(){a.add(o.schedule(function(){return s.complete()}))}}))})),a})}function Ju(e,o){return new ua(function(s){var a=new nb;return a.add(o.schedule(function(){return e.then(function(_){a.add(o.schedule(function(){s.next(_),a.add(o.schedule(function(){return s.complete()}))}))},function(_){a.add(o.schedule(function(){return s.error(_)}))})})),a})}function Ku(e,o){if(!e)throw Error("Iterable cannot be null");return new ua(function(s){var a,_=new nb;return _.add(function(){a&&typeof a.return=="function"&&a.return()}),_.add(o.schedule(function(){a=e[xd](),_.add(o.schedule(function(){if(!s.closed){try{var $=a.next(),_e=$.value,_n=$.done}catch(_r){return void s.error(_r)}_n?s.complete():(s.next(_e),this.schedule())}}))})),_})}function ln(e,o){if(e!=null){if(e&&typeof e[Pe]=="function")return Iu(e,o);if(kn(e))return Ju(e,o);if(mn(e))return $i(e,o);if(e&&typeof e[xd]=="function"||typeof e=="string")return Ku(e,o)}throw new TypeError((e!==null&&qa(e)||e)+" is not observable")}function Jc(e,o){return o?ln(e,o):e instanceof ua?e:new ua(Tf(e))}function bd(e,o){if(!o.closed){if(e instanceof ua)return e.subscribe(o);try{var s=Tf(e)(o)}catch(a){o.error(a)}return s}}function Cb(e,o,s){return s===void 0&&(s=Number.POSITIVE_INFINITY),typeof o=="function"?function(a){return a.pipe(Cb(function(_,$){return Jc(e(_,$)).pipe(Ea(function(_e,_n){return o(_,_e,$,_n)}))},s))}:(typeof o=="number"&&(s=o),function(a){return a.lift(new Lu(e,s))})}function bh(e){return e===void 0&&(e=Number.POSITIVE_INFINITY),Cb(wd,e)}function nn(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return bh(1)(ob.apply(void 0,e))}function yd(e){return new ua(function(o){try{var s=e()}catch(a){return void o.error(a)}return(s?Jc(s):Qf()).subscribe(o)})}function ch(e,o){return new ua(function(s){var a=e.length;if(a===0)s.complete();else for(var _=Array(a),$=0,_e=0,_n=function(_s){var na=Jc(e[_s]),ba=!1;s.add(na.subscribe({next:function(_p){ba||(ba=!0,_e++),_[_s]=_p},error:function(_p){return s.error(_p)},complete:function(){++$!==a&&ba||(_e===a&&s.next(o?o.reduce(function(_p,_f,_E){return _p[_f]=_[_E],_p},{}):_),s.complete())}}))},_r=0;_r<a;_r++)_n(_r)})}function Db(e,o,s,a){return Ne(s)&&(a=s,s=void 0),a?Db(e,o,s).pipe(Ea(function(_){return hc(_)?a.apply(void 0,_):a(_)})):new ua(function(_){on(e,o,function($){1<arguments.length?_.next(Array.prototype.slice.call(arguments)):_.next($)},_,s)})}function on(e,o,s,a,_){if(e&&typeof e.addEventListener=="function"&&typeof e.removeEventListener=="function"){e.addEventListener(o,s,_);var $=function(){return e.removeEventListener(o,s,_)}}else if(e&&typeof e.on=="function"&&typeof e.off=="function")e.on(o,s),$=function(){return e.off(o,s)};else if(e&&typeof e.addListener=="function"&&typeof e.removeListener=="function")e.addListener(o,s),$=function(){return e.removeListener(o,s)};else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var _e=0,_n=e.length;_e<_n;_e++)on(e[_e],o,s,a,_)}a.add($)}function pn(e,o,s){return s?pn(e,o).pipe(Ea(function(a){return hc(a)?s.apply(void 0,a):s(a)})):new ua(function(a){var _=function(){for(var _e=[],_n=0;_n<arguments.length;_n++)_e[_n]=arguments[_n];return a.next(_e.length===1?_e[0]:_e)};try{var $=e(_)}catch(_e){return void a.error(_e)}if(Ne(o))return function(){return o(_,$)}})}function Mu(e){var o=e.subscriber,s=e.condition;if(!o.closed){if(e.needIterate)try{e.state=e.iterate(e.state)}catch($){return void o.error($)}else e.needIterate=!0;if(s){var a=void 0;try{a=s(e.state)}catch($){return void o.error($)}if(!a)return void o.complete();if(o.closed)return}try{var _=e.resultSelector(e.state)}catch($){return void o.error($)}if(!o.closed&&(o.next(_),!o.closed))return this.schedule(e)}}function cj(e){return!hc(e)&&0<=e-parseFloat(e)+1}function Qe(e,o){return e===void 0&&(e=0),o===void 0&&(o=cd),(!cj(e)||0>e)&&(e=0),o&&typeof o.schedule=="function"||(o=cd),new ua(function(s){return s.add(o.schedule(Nu,e,{subscriber:s,counter:0,period:e})),s})}function Nu(e){var o=e.subscriber,s=e.counter;e=e.period,o.next(s),this.schedule({subscriber:o,counter:s+1,period:e},e)}function Jb(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];o=Number.POSITIVE_INFINITY;var s=null,a=e[e.length-1];return ad(a)?(s=e.pop(),1<e.length&&typeof e[e.length-1]=="number"&&(o=e.pop())):typeof a=="number"&&(o=e.pop()),s===null&&e.length===1&&e[0]instanceof ua?e[0]:bh(o)(Rf(e,s))}function dj(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(e.length===0)return Sb;var s=e[0],a=e.slice(1);return e.length===1&&hc(s)?dj.apply(void 0,s):new ua(function(_){var $=function(){return _.add(dj.apply(void 0,a).subscribe(_))};return Jc(s).subscribe({next:function(_e){_.next(_e)},error:$,complete:$})})}function Ou(e){var o=e.keys,s=e.index,a=e.subscriber,_=e.subscription;if(e=e.obj,!a.closed)if(s<o.length){var $=o[s];a.next([$,e[$]]),_.add(this.schedule({keys:o,index:s+1,subscriber:a,subscription:_,obj:e}))}else a.complete()}function Pu(e,o){function s(){return!s.pred.apply(s.thisArg,arguments)}return s.pred=e,s.thisArg=o,s}function yb(e,o){return function(s){return s.lift(new Qu(e,o))}}function fb(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(e.length===1){if(!hc(e[0]))return e[0];e=e[0]}return Rf(e,void 0).lift(new Ru)}function Su(e){var o=e.start,s=e.index,a=e.subscriber;s>=e.count?a.complete():(a.next(o),a.closed||(e.index=s+1,e.start=o+1,this.schedule(e)))}function dd(e,o,s){e===void 0&&(e=0);var a=-1;return cj(o)?a=1>Number(o)?1:Number(o):ad(o)&&(s=o),ad(s)||(s=cd),new ua(function(_){var $=cj(e)?e:+e-s.now();return s.schedule(Tu,$,{index:0,period:a,subscriber:_})})}function Tu(e){var o=e.index,s=e.period,a=e.subscriber;if(a.next(o),!a.closed){if(s===-1)return a.complete();e.index=o+1,this.schedule(e,s)}}function ej(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return typeof(o=e[e.length-1])=="function"&&e.pop(),Rf(e,void 0).lift(new Uu(o))}function dh(e){var o=arguments.length,s=cd;ad(arguments[arguments.length-1])&&(s=arguments[arguments.length-1],o--);var a=null;2<=o&&(a=arguments[1]);var _=Number.POSITIVE_INFINITY;return 3<=o&&(_=arguments[2]),function($){return $.lift(new Vu(e,a,_,s))}}function qn(e){var o=e.subscriber,s=e.context;s&&o.closeContext(s),o.closed||(e.context=o.openContext(),e.context.closeAction=this.schedule(e,e.bufferTimeSpan))}function Wu(e){var o=e.bufferCreationInterval,s=e.bufferTimeSpan,a=e.subscriber,_=e.scheduler,$=a.openContext();a.closed||(a.add($.closeAction=_.schedule(rn,s,{subscriber:a,context:$})),this.schedule(e,o))}function rn(e){e.subscriber.closeContext(e.context)}function ab(e){return function(o){var s=new Xu(e);return o=o.lift(s),s.caught=o}}function fj(e,o){return Cb(e,o,1)}function sn(e){return e===void 0&&(e=null),function(o){return o.lift(new Yu(e))}}function Zd(e,o){o===void 0&&(o=cd);var s=e instanceof Date&&!isNaN(+e)?+e-o.now():Math.abs(e);return function(a){return a.lift(new Zu(s,o))}}function tn(e,o){return function(s){return s.lift(new $u(e,o))}}function $d(e){return e===void 0&&(e=av),function(o){return o.lift(new bv(e))}}function av(){return new eh}function hb(e){return function(o){return e===0?Qf():o.lift(new cv(e))}}function fh(e){return function(o){return o.lift(new dv(e))}}function Ca(e,o){var s=2<=arguments.length;return function(a){return a.pipe(e?yb(function(_,$){return e(_,$,a)}):wd,hb(1),s?sn(o):$d(function(){return new eh}))}}function ev(){return function(e){return e.lift(new fv)}}function un(e){return function(o){return e===0?Qf():o.lift(new gv(e))}}function Uf(e){return function(o){return o.lift(new hv(e))}}function gh(e,o){var s=!1;return 2<=arguments.length&&(s=!0),function(a){return a.lift(new iv(e,o,s))}}function vn(e,o){return 2<=arguments.length?function(s){return Zi(gh(e,o),un(1),sn(o))(s)}:function(s){return Zi(gh(function(a,_,$){return e(a,_,$+1)}),un(1))(s)}}function jv(e,o){return function(s){var a=typeof e=="function"?e:function(){return e};if(typeof o=="function")return s.lift(new kv(a,o));var _=Object.create(s,lv);return _.source=s,_.subjectFactory=a,_}}function Re(e){return function(o){return o.lift(new mv(e,o))}}function nv(){return new rb}function Se(){return function(e){return dn()(jv(nv)(e))}}function wn(e,o,s){var a=e&&qa(e)==="object"?e:{bufferSize:e,windowTime:o,refCount:!1,scheduler:s};return function(_){return _.lift(ov(a))}}function ov(e){var o,s,a=e.bufferSize,_=a===void 0?Number.POSITIVE_INFINITY:a,$=(a=e.windowTime)===void 0?Number.POSITIVE_INFINITY:a,_e=e.refCount,_n=e.scheduler,_r=0,_s=!1,na=!1;return function(ba){if(_r++,!o||_s){_s=!1;var _p=(o=new Te(_,$,_n)).subscribe(this);s=ba.subscribe({next:function(_f){o.next(_f)},error:function(_f){_s=!0,o.error(_f)},complete:function(){na=!0,s=void 0,o.complete()}}),na&&(s=void 0)}else _p=o.subscribe(this);this.add(function(){_r--,_p.unsubscribe(),_p=void 0,s&&!na&&_e&&_r===0&&(s.unsubscribe(),o=s=void 0)})}}function Kb(e,o){return typeof o=="function"?function(s){return s.pipe(Kb(function(a,_){return Jc(e(a,_)).pipe(Ea(function($,_e){return o(a,$,_,_e)}))}))}:function(s){return s.lift(new pv(e))}}function Kc(e){return function(o){return o.lift(new qv(e))}}function sa(e,o,s){return function(a){return a.lift(new rv(e,o,s))}}function sv(e,o,s){return o===void 0&&(o=cd),s===void 0&&(s=tv),function(a){return a.lift(new uv(e,o,s.leading,s.trailing))}}function vv(e){e.subscriber.clearThrottle()}function wv(e,o,s){return s===void 0&&(s=cd),function(a){var _=e instanceof Date&&!isNaN(+e),$=_?+e-s.now():Math.abs(e);return a.lift(new xv($,_,o,s))}}function Lb(e,o){return o===void 0&&(o=cd),wv(e,ra(new Tb),o)}function yv(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return function(s){var a;return typeof e[e.length-1]=="function"&&(a=e.pop()),s.lift(new zv(e,a))}}function xn(e){(gj||e)&&(yn.abort(),e&&(yn=new AbortController),gj=e)}function zn(e,o,s,a,_){e!==o&&An(o,function($,_e){if(_||(_=new Ie),Gb($)){$=_;var _n=hj(e,_e),_r=hj(o,_e),_s=$.get(_r);if(_s)ij(e,_e,_s);else{var na=(_s=a?a(_n,_r,_e+"",e,o,$):void 0)===void 0;if(na){var ba=ub(_r),_p=!ba&&Nf(_r),_f=!ba&&!_p&&Ui(_r);_s=_r,ba||_p||_f?ub(_n)?_s=_n:Hc(_n)&&ae(_n)?_s=Pi(_n):_p?(na=!1,_s=Nm(_r,!0)):_f?(na=!1,_s=Bn(_r,!0)):_s=[]:Cn(_r)||Vf(_r)?(_s=_n,Vf(_n)?_s=Ue(_n,Of(_n)):Gb(_n)&&!jj(_n)||(_s=Om(_r))):na=!1}na&&($.set(_r,_s),zn(_s,_r,s,a,$),$.delete(_r)),ij(e,_e,_s)}}else(_n=a?a(hj(e,_e),$,_e+"",e,o,_):void 0)===void 0&&(_n=$),ij(e,_e,_n)},Of)}function Av(e){var o=1,s=kj;(1>=arguments.length?0:arguments.length-1)==1?typeof(1>=arguments.length?void 0:arguments[1])=="number"?o=1>=arguments.length?void 0:arguments[1]:s=1>=arguments.length?void 0:arguments[1]:(1>=arguments.length?0:arguments.length-1)==2&&(o=1>=arguments.length?void 0:arguments[1],s=2>=arguments.length?void 0:arguments[2]);var a=o||1;return function(_){return _.pipe(gh(function($,_e){var _n=s.now(),_r=_n-e;if(($=$.filter(function(ba){return ba.until>_r})).length>=a){var _s=$[$.length-1],na=$[0].until+e*Math.floor($.length/a);$.push({delay:_s.until<_n?na-_n:na-_s.until,until:na,value:_e})}else $.push({delay:0,until:_n,value:_e});return $},[]),Ea(function($){return $[$.length-1]}),fj(function($){var _e=ob($.value);return $.delay?_e.pipe(Zd($.delay,s)):_e}))}}function Bv(e,o){var s=(o=o===void 0?{protocols:Dn,makeWebSocket:En}:o).protocols,a=s===void 0?Dn:s,_=(o=o.makeWebSocket)===void 0?En:o;return new ua(function($){var _e,_n=new rb,_r=_(e,a),_s=!1,na=!1,ba=!1,_p=function(_f){if(_e)throw _s=!0,_f=Error("Web socket message factory function called more than once"),$.error(_f),_f;return _e=_f.subscribe(function(_E){_r.send(_E)}),_n};return _r.onopen=function(){ba=!0,na?(_s=!0,_r.close()):$.next(_p)},_r.onmessage=function(_f){_n.next(_f.data)},_r.onerror=function(_f){_s=!0,$.error(Error(_f.message))},_r.onclose=function(_f){_s||(_s=!0,na?($.complete(),_n.complete()):$.error(Error(_f.code===1e3?"Normal closure":_f.reason)))},function(){na=!0,_e&&_e.unsubscribe(),_s||(_s=!0,ba&&_r.close())}})}function hh(){this._listeners={}}function Fn(e){return typeof Float32Array<"u"?function(){function o(_r,_s,na){$[0]=_r,_s[na]=_e[0],_s[na+1]=_e[1],_s[na+2]=_e[2],_s[na+3]=_e[3]}function s(_r,_s,na){$[0]=_r,_s[na]=_e[3],_s[na+1]=_e[2],_s[na+2]=_e[1],_s[na+3]=_e[0]}function a(_r,_s){return _e[0]=_r[_s],_e[1]=_r[_s+1],_e[2]=_r[_s+2],_e[3]=_r[_s+3],$[0]}function _(_r,_s){return _e[3]=_r[_s],_e[2]=_r[_s+1],_e[1]=_r[_s+2],_e[0]=_r[_s+3],$[0]}var $=new Float32Array([-0]),_e=new Uint8Array($.buffer),_n=_e[3]===128;e.writeFloatLE=_n?o:s,e.writeFloatBE=_n?s:o,e.readFloatLE=_n?a:_,e.readFloatBE=_n?_:a}():function(){function o(a,_,$,_e){var _n=0>_?1:0;if(_n&&(_=-_),_===0)a(0<1/_?0:2147483648,$,_e);else if(isNaN(_))a(2143289344,$,_e);else if(34028234663852886e22<_)a((_n<<31|2139095040)>>>0,$,_e);else if(11754943508222875e-54>_)a((_n<<31|Math.round(_/1401298464324817e-60))>>>0,$,_e);else{var _r=Math.floor(Math.log(_)/Math.LN2);a((_n<<31|_r+127<<23|8388607&Math.round(_*Math.pow(2,-_r)*8388608))>>>0,$,_e)}}function s(a,_,$){return $=a(_,$),a=2*($>>31)+1,_=$>>>23&255,$&=8388607,_===255?$?NaN:1/0*a:_===0?1401298464324817e-60*a*$:a*Math.pow(2,_-150)*($+8388608)}e.writeFloatLE=o.bind(null,Gn),e.writeFloatBE=o.bind(null,Hn),e.readFloatLE=s.bind(null,In),e.readFloatBE=s.bind(null,Jn)}(),typeof Float64Array<"u"?function(){function o(_r,_s,na){$[0]=_r,_s[na]=_e[0],_s[na+1]=_e[1],_s[na+2]=_e[2],_s[na+3]=_e[3],_s[na+4]=_e[4],_s[na+5]=_e[5],_s[na+6]=_e[6],_s[na+7]=_e[7]}function s(_r,_s,na){$[0]=_r,_s[na]=_e[7],_s[na+1]=_e[6],_s[na+2]=_e[5],_s[na+3]=_e[4],_s[na+4]=_e[3],_s[na+5]=_e[2],_s[na+6]=_e[1],_s[na+7]=_e[0]}function a(_r,_s){return _e[0]=_r[_s],_e[1]=_r[_s+1],_e[2]=_r[_s+2],_e[3]=_r[_s+3],_e[4]=_r[_s+4],_e[5]=_r[_s+5],_e[6]=_r[_s+6],_e[7]=_r[_s+7],$[0]}function _(_r,_s){return _e[7]=_r[_s],_e[6]=_r[_s+1],_e[5]=_r[_s+2],_e[4]=_r[_s+3],_e[3]=_r[_s+4],_e[2]=_r[_s+5],_e[1]=_r[_s+6],_e[0]=_r[_s+7],$[0]}var $=new Float64Array([-0]),_e=new Uint8Array($.buffer),_n=_e[7]===128;e.writeDoubleLE=_n?o:s,e.writeDoubleBE=_n?s:o,e.readDoubleLE=_n?a:_,e.readDoubleBE=_n?_:a}():function(){function o(a,_,$,_e,_n,_r){var _s=0>_e?1:0;if(_s&&(_e=-_e),_e===0)a(0,_n,_r+_),a(0<1/_e?0:2147483648,_n,_r+$);else if(isNaN(_e))a(0,_n,_r+_),a(2146959360,_n,_r+$);else if(17976931348623157e292<_e)a(0,_n,_r+_),a((_s<<31|2146435072)>>>0,_n,_r+$);else if(22250738585072014e-324>_e)a((_e/=5e-324)>>>0,_n,_r+_),a((_s<<31|_e/4294967296)>>>0,_n,_r+$);else{var na=Math.floor(Math.log(_e)/Math.LN2);na===1024&&(na=1023),a(4503599627370496*(_e*=Math.pow(2,-na))>>>0,_n,_r+_),a((_s<<31|na+1023<<20|1048576*_e&1048575)>>>0,_n,_r+$)}}function s(a,_,$,_e,_n){return _=a(_e,_n+_),_e=a(_e,_n+$),a=2*(_e>>31)+1,_=4294967296*(1048575&_e)+_,($=_e>>>20&2047)===2047?_?NaN:1/0*a:$===0?5e-324*a*_:a*Math.pow(2,$-1075)*(_+4503599627370496)}e.writeDoubleLE=o.bind(null,Gn,0,4),e.writeDoubleBE=o.bind(null,Hn,4,0),e.readDoubleLE=s.bind(null,In,0,4),e.readDoubleBE=s.bind(null,Jn,4,0)}(),e}function Gn(e,o,s){o[s]=255&e,o[s+1]=e>>>8&255,o[s+2]=e>>>16&255,o[s+3]=e>>>24}function Hn(e,o,s){o[s]=e>>>24,o[s+1]=e>>>16&255,o[s+2]=e>>>8&255,o[s+3]=255&e}function In(e,o){return(e[o]|e[o+1]<<8|e[o+2]<<16|e[o+3]<<24)>>>0}function Jn(e,o){return(e[o]<<24|e[o+1]<<16|e[o+2]<<8|e[o+3])>>>0}function vb(e,o){this.lo=e>>>0,this.hi=o>>>0}function Wf(e,o,s){this.fn=e,this.len=o,this.next=void 0,this.val=s}function lj(){}function Cv(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Aa(){this.len=0,this.tail=this.head=new Wf(lj,0,0),this.states=null}function mj(e,o,s){o[s]=255&e}function nj(e,o){this.len=e,this.next=void 0,this.val=o}function oj(e,o,s){for(;e.hi;)o[s++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;127<e.lo;)o[s++]=127&e.lo|128,e.lo>>>=7;o[s++]=e.lo}function pj(e,o,s){o[s]=255&e,o[s+1]=e>>>8&255,o[s+2]=e>>>16&255,o[s+3]=e>>>24}function Lc(){qj.call(this)}function Dv(e,o,s){40>e.length?pa.utf8.write(e,o,s):o.utf8Write?o.utf8Write(e,s):o.write(e,s)}function wc(e,o){return RangeError("index out of range: "+e.pos+" + "+(o||1)+" > "+e.len)}function ib(e){this.buf=e,this.pos=0,this.len=e.length}function rj(){var e=new Kn(0,0),o=0;if(!(4<this.len-this.pos)){for(;3>o;++o){if(this.pos>=this.len)throw wc(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*o)>>>0,128>this.buf[this.pos++])return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*o)>>>0,e}for(;4>o;++o)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*o)>>>0,128>this.buf[this.pos++])return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,128>this.buf[this.pos++])return e;if(o=0,4<this.len-this.pos){for(;5>o;++o)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*o+3)>>>0,128>this.buf[this.pos++])return e}else for(;5>o;++o){if(this.pos>=this.len)throw wc(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*o+3)>>>0,128>this.buf[this.pos++])return e}throw Error("invalid varint encoding")}function ih(e,o){return(e[o-4]|e[o-3]<<8|e[o-2]<<16|e[o-1]<<24)>>>0}function Ln(){if(this.pos+8>this.len)throw wc(this,8);return new Kn(ih(this.buf,this.pos+=4),ih(this.buf,this.pos+=4))}function be(e){sj.call(this,e)}function Xf(e,o,s){if(typeof e!="function")throw TypeError("rpcImpl must be a function");pa.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!o,this.responseDelimited=!!s}function Mn(e){var o=[];return function s(a){if(a===null||qa(a)!=="object")return a;if(o.indexOf(a)!==-1)return"[Circular]";if(o.push(a),typeof a.toJSON=="function")try{var _=s(a.toJSON());return o.pop(),_}catch($){return"[Throws: "+($?$.message:"?")+"]"}return Array.isArray(a)?(_=a.map(s),o.pop(),_):(_=Object.keys(a).reduce(function($,_e){e:{if(Ev.call(a,_e))try{var _n=a[_e];break e}catch(_r){_n="[Throws: "+(_r?_r.message:"?")+"]";break e}_n=a[_e]}return $[_e]=s(_n),$},{}),o.pop(),_)}(e)}function Fv(e){if(!(100<(e=String(e)).length)&&(e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e))){var o=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return 864e5*o;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*o;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*o;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o}}}function jh(e,o,s,a){return Math.round(e/s)+" "+a+(o>=1.5*s?"s":"")}function Gv(e){var o=e.areas,s=e.excludedArea;if(o.length===1&&o[0]===S.GLOBAL&&s===S.CHINA)return Ve([S.OVERSEA]);if(o.includes(S.GLOBAL)){if(e=Yf(kh).filter(function($){return $!==S.GLOBAL&&$!==S.OVERSEA}),s in Zf){o=Zf[s];var a=[].concat(Z(o??[]),[s]);return Ve(e.filter(function($){return!a.includes($)}))}if(Nn(s)){var _=Hv(s);return Ve(e.filter(function($){return $!==s&&$!==_}))}}if(Nn(s)||s in Zf)return Ve(o);throw new ca("Invalid excludedArea area config")}function jb(e,o,s){s===void 0&&(s=Object.getOwnPropertyDescriptor(e,o));var a=s.value;return s.value=function(){for(var _=this,$=arguments.length,_e=Array($),_n=0;_n<$;_n++)_e[_n]=arguments[_n];this.invokeTracker.apply(this,["%s: ".concat(0<_e.length?"%s with args: ".concat(_e.map(function(){return"%o"})):"%s"),this.name,o].concat(Z(_e.map(We))));try{var _r=a.apply(this,_e)}catch(na){throw this.logError.apply(this,["".concat(na.code!==void 0?"Error Code ".concat(na.code,": "):"","%s failed").concat(0<_e.length?" with args: ".concat(_e.map(function(){return"%o"})):""),o].concat(Z(_e.map(We)))),na.originalError&&this.logError(na.originalError),this.errorTracker(na),na}var _s=Date.now();return ma(N.mark(function na(){var ba,_p;return N.wrap(function(_f){for(;;)switch(_f.prev=_f.next){case 0:return _f.prev=0,_f.next=3,_r;case 3:ba=_f.sent,_f.next=12;break;case 6:return _f.prev=6,_f.t0=_f.catch(0),_.logError.apply(_,["".concat(_f.t0.code!==void 0?"Error Code ".concat(_f.t0.code,": "):"","%s failed").concat(0<_e.length?" with args: ".concat(_e.map(function(){return"%o"})):""),o].concat(Z(_e.map(We)))),_f.t0.originalError&&_.logError(_f.t0.originalError),_.errorTracker(_f.t0),_f.abrupt("return");case 12:ba!==_r?ba===void 0?_.resultTracker("%s promise resolves after %dms",o,Date.now()-_s):_.resultTracker("%s promise resolves after %dms, result is %o",o,Date.now()-_s,We(ba)):$c(ba)!=="Object"||De(ba)?_.resultTracker("%s result is %o",o,We(ba)):_.resultTracker("%s result is %s",o,ba.name||((_p=ba.constructor)===null||_p===void 0?void 0:_p.name));case 13:case"end":return _f.stop()}},na,null,[[0,6]])}))(),_r},s}function Mc(e,o,s){s===void 0&&(s=Object.getOwnPropertyDescriptor(e,o));var a=s.value;return s.value=function(){for(var _=this,$=arguments.length,_e=Array($),_n=0;_n<$;_n++)_e[_n]=arguments[_n];this.invokeTracker.apply(this,["%s: ".concat(0<_e.length?"%s with args: ".concat(_e.map(function(){return"%o"})):"%s"),this.name,o].concat(_e));try{var _r=a.apply(this,_e)}catch(na){throw this.logError.apply(this,["".concat(na.code!==void 0?"Error Code ".concat(na.code,": "):"","%s failed").concat(0<_e.length?" with args: ".concat(_e.map(function(){return"%o"})):""),o].concat(_e)),na.originalError&&this.logError(na.originalError),this.errorTracker(na),na}var _s=Date.now();return ma(N.mark(function na(){var ba,_p;return N.wrap(function(_f){for(;;)switch(_f.prev=_f.next){case 0:return _f.prev=0,_f.next=3,_r;case 3:ba=_f.sent,_f.next=12;break;case 6:return _f.prev=6,_f.t0=_f.catch(0),_.logError.apply(_,["".concat(_f.t0.code!==void 0?"Error Code ".concat(_f.t0.code,": "):"","%s failed").concat(0<_e.length?" with args: ".concat(_e.map(function(){return"%o"})):""),o].concat(_e)),_f.t0.originalError&&_.logError(_f.t0.originalError),_.errorTracker(_f.t0),_f.abrupt("return");case 12:ba!==_r?ba===void 0?_.resultTracker("%s promise resolves after %dms",o,Date.now()-_s):_.resultTracker("%s promise resolves after %dms, result is %o",o,Date.now()-_s,ba):$c(ba)!=="Object"||De(ba)?_.resultTracker("%s result is %o",o,ba):_.resultTracker("%s result is %s",o,ba.name||((_p=ba.constructor)===null||_p===void 0?void 0:_p.name));case 13:case"end":return _f.stop()}},na,null,[[0,6]])}))(),_r},s}function bb(e,o,s){return tj.apply(this,arguments)}function tj(){return(tj=ma(N.mark(function e(o,s,a){var _,$,_e,_n=arguments;return N.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:return _=3<_n.length&&_n[3]!==void 0&&_n[3],$=Iv[o].encode(s).finish(),_e=function(){var _s=ma(N.mark(function na(ba){var _p,_f,_E,_v=arguments;return N.wrap(function(n_){for(;;)switch(n_.prev=n_.next){case 0:if(!(3<(_f=1<_v.length&&_v[1]!==void 0?_v[1]:0))){n_.next=3;break}return n_.abrupt("return");case 3:if(_E=Xe(_E=a?"https://".concat((_p=fa==null?void 0:fa.PROXY_NGINX[0])!==null&&_p!==void 0?_p:"webrtc-cloud-proxy.sd-rtn.com","/rs/?h=").concat(ba,"&p=443&d=events/proto-raw"):"https://".concat(ba,"/events/proto-raw"),"sentTs",Math.ceil(Date.now()/1e3).toString()),_E=Xe(_E,"id",Jv[o].toString()),!_){n_.next=9;break}return n_.next=9,Kv(1e4);case 9:return n_.next=11,lh(_E,{body:$,timeout:2e4,headers:{"Content-Type":"application/octet-stream"}}).catch(function(e_){return _e(ba,_f+1)});case 11:case"end":return n_.stop()}},na)}));return function(na){return _s.apply(this,arguments)}}(),_r.prev=3,_r.next=6,_e((fa==null?void 0:fa.EVENT_REPORT_DOMAIN[0])||$f(null)&&null||"webcollector-rtm.agora.io");case 6:_r.next=12;break;case 8:return _r.prev=8,_r.t0=_r.catch(3),_r.next=12,_e(fa&&On(1<(fa==null?void 0:fa.EVENT_REPORT_DOMAIN.length)?fa==null?void 0:fa.EVENT_REPORT_DOMAIN.slice(1):fa==null?void 0:fa.EVENT_REPORT_DOMAIN)||"rtm.statscollector.sd-rtn.com");case 12:case"end":return _r.stop()}},e,null,[[3,8]])}))).apply(this,arguments)}function Xa(e){return e===void 0?P.fromNumber(0):P.fromNumber(Date.now()-e)}function Ta(e){return typeof e=="string"&&/^[\s\w!#$%&()+,.:;<=>?@[\]^{|}~-]{1,64}$/.test(e)&&e!=="null"}function Pn(e){try{var o=e.split(".").map(function(a){return Number(a)})}catch{return!1}if(o.length!==4||o[0]===0)return!1;for(e=0;e<o.length;e++){var s=o[e];if(!Number.isInteger(s)||0>s||255<s)return!1}return!0}function Qn(e,o){if(!Array.isArray(o)||o.length===0||32<o.length||o.some(function(s){return s.length===0||32<s.length}))throw new ca("arguments is not valid",gb);if(!Ta(e))throw new ca("ID is invalid",gb)}function ag(e){var o=e.attributes,s=e.attrSizeMap,a=e.maxAttrsCount,_=e.maxAttrValueSize;if(e=e.maxTotalSize,!De(o))throw new ca("attributes must be an object",gb);if(Object.keys(o).length>a)throw new ic("Exceed the limit of ".concat(a," attributes"),Ye);if(Object.keys(o).length===0)throw new ca("The attributes is an empty object",gb);var $=0,_e=0;for(o=Object.entries(o);_e<o.length;_e++){var _n=$a(o[_e],2),_r=_n[1];_n=new Blob([_n[0]]).size;var _s=new Blob([_r]).size;if(_n===0||32<_n)throw new ca("Invalid attribute key",gb);if(_s>_)throw new ic("Invalid attribute value, over the limit of ".concat(_," bytes"),Ye);if(typeof _r!="string"||_r.length===0)throw new ca("Invalid attribute value",gb);$+=_n,$+=_s}if($>e)throw new ic("The attributes size overflow",Ye);if(s!==void 0){if(Object.keys(s).length>a)throw new ic("Exceed the limit of ".concat(a," attributes"),Ye);for($=a=0,s=Object.entries(s);$<s.length;$++){if(_e=(o=$a(s[$],2))[1],(o=new Blob([o[0]]).size)===0)throw new ca("Invalid attribute key",gb);if(_e>_)throw new ic("Invalid attribute value, over the limit of ".concat(_," bytes"),Ye);a+=o,a+=_e}if(a>e)throw new ic("The attributes size overflow",Ye)}}function mh(e,o){return Math.floor(Math.random()*(Math.floor(o)-Math.ceil(e)+1))+e}function nh(){var e=mh(0,4294967295),o=mh(1,4294967295);return new P(e,o,!0)}function sb(e){return e.toString().padEnd(32,"0")}function Rn(e,o){return new TypeError("Unexpected ".concat(e,": ").concat(o))}function Sn(e,o){return e=e.split(".").map(function(s){return Number(s)}),o=o.split(".").map(function(s){return Number(s)}),Math.sqrt(1e3*Math.pow(e[0]-o[0],2)+100*Math.pow(e[1]-o[1],2)+10*Math.pow(e[2]-o[2],2)+1*Math.pow(e[3]-o[3],2))}function Tn(e){return e.lessThanOrEqual(Number.MAX_SAFE_INTEGER)?e.toNumber():e.toString()}function uj(e,o){o="".concat(e).concat(o||"");var s=Un.get(o)||1;return Un.set(o,s+1),"".concat(e).concat(s)}function Vn(e,o){var s=typeof o=="number"?o:o!==void 0&&typeof o!="string"?o.code:void 0;return o=typeof o!="number"&&typeof o!="string"&&o!==void 0&&o.serverCode!==void 0?o.serverCode:void 0,s="".concat(s!==void 0?" Error Code ".concat(s):"").concat(o!==void 0?", server Code ".concat(o):""),e=typeof e=="string"&&e?oh(e):Array.isArray(e)&&typeof e[0]=="string"&&e[0]?oh(Wn.apply(void 0,[e[0]].concat(Z(e.slice(1))))):"","".concat(s===""?"":"".concat(s," - ")).concat(e)}function Kv(e,o){return vj.apply(this,arguments)}function vj(){return(vj=ma(N.mark(function e(o,s){return N.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!s||!s.aborted){a.next=2;break}return a.abrupt("return");case 2:return a.abrupt("return",new Promise(function(_){setTimeout(_,o),s==null||s.addEventListener("abort",_)}));case 3:case"end":return a.stop()}},e)}))).apply(this,arguments)}function lh(e,o,s){return wj.apply(this,arguments)}function wj(){return(wj=ma(N.mark(function e(o,s,a){var _,$,_e,_n,_r,_s,na,ba,_p,_f,_E,_v,n_,e_,t_,o_,m_,b_,w_,y_,N_,_y,v_,A_,k_,P_;return N.wrap(function(T_){for(;;)switch(T_.prev=T_.next){case 0:if(_=s.body,$=s.headers,_e=$===void 0?{}:$,_n=s.timeout,_r=_n===void 0?1e4:_n,_s=s.signal,na=s.withCredentials,ba=na!==void 0&&na,_p=(a||{}).useBinaryResponse,_f=_p!==void 0&&_p,(_E=new XMLHttpRequest).open("POST",o,!0),_E.responseType=_f?"arraybuffer":"text",_E.withCredentials=ba,_E.timeout=_r,_v=_ instanceof FormData,n_=_ instanceof Uint8Array,!(1<(e_=Object.keys(_e).filter(function(R_){return R_.toLowerCase()==="content-type"})).length)){T_.next=14;break}throw new RangeError("multiple content-type");case 14:e_.length===0&&(n_?_e["Content-Type"]="application/octet-stream":_v||(_e["Content-Type"]="application/json"));case 15:if("setRequestHeader"in _E){T_.next=46;break}return _E.abort(),T_.next=19,fetch(o,{body:_v||n_?_:JSON.stringify(_),cache:"no-cache",credentials:ba?"include":"same-origin",headers:_e,method:"POST",mode:"cors",referrer:"no-referrer",signal:_s});case 19:if(t_=T_.sent,!(200<=(o_=t_.status)&&300>o_||o_===304)){T_.next=31;break}if(!_f){T_.next=27;break}return T_.next=25,t_.arrayBuffer();case 25:return m_=T_.sent,T_.abrupt("return",{status:o_,responseData:m_});case 27:return T_.next=29,t_.text();case 29:return b_=T_.sent,T_.abrupt("return",{status:o_,responseText:b_});case 31:return w_=new Ja(["Post XHR failure, status %d",o_]),T_.prev=32,T_.next=35,t_.text();case 35:throw y_=T_.sent,w_.statusCode=o_,w_.message=y_||"Request failed, status ".concat(o_),w_;case 41:throw T_.prev=41,T_.t0=T_.catch(32),w_.statusCode=o_,w_.message="Request failed, status ".concat(o_),w_;case 46:if(Object.keys(_e).length!==0)for(N_=0,_y=Object.entries(_e);N_<_y.length;N_++)v_=$a(_y[N_],2),A_=v_[0],k_=v_[1],_E.setRequestHeader(A_,k_);return _s!==void 0&&(P_=function R_(){_E.abort(),_s.removeEventListener("abort",R_)},_s.addEventListener("abort",P_)),_v||n_?_E.send(_):_E.send(JSON.stringify(_)),T_.abrupt("return",new Promise(function(R_,I_){_E.onload=function(){var U_=_E.status;if(200<=U_&&300>U_||U_===304)R_(_f?{status:U_,responseData:_E.response}:{status:U_,responseText:_E.responseText});else{var D_=new Ja(["Post XHR failure, status %d",U_]);D_.statusCode=U_,D_.message=_E.response||"Request failed, status ".concat(_E.status),I_(D_)}},_E.ontimeout=function(U_){I_(new Ub(["XHR request timed out after %d ms",_r],{originalError:U_}))},_E.onerror=function(){var U_=new Ja(["Post XHR failure, status %d",_E.status]);U_.statusCode=_E.status,U_.message=_E.response||"Request failed, status ".concat(_E.status),I_(U_)},_E.onabort=function(){try{I_(new DOMException("The request aborted.","AbortError"))}catch{var U_=Error("The request aborted.");U_.name="AbortError",I_(U_)}}}));case 50:case"end":return T_.stop()}},e,null,[[32,41]])}))).apply(this,arguments)}function Xn(e,o){if(!De(e))throw new ca("message object is not a plain object",o);if(e.messageType===void 0)if(e.rawMessage instanceof Uint8Array){if(e.messageType="RAW",e.text!==void 0)throw new ca("Raw messages cannot have text property. Use description instead",o)}else{if(typeof e.text!="string")throw new ca("messageType is undefined",o);if(e.messageType="TEXT",e.rawMessage!==void 0)throw new ca("Text messages cannot have rawMessage property",o)}}function ph(e){return xj.apply(this,arguments)}function xj(){return(xj=ma(N.mark(function e(o){var s,a,_,$,_e,_n,_r,_s,na,ba,_p,_f,_E,_v,n_,e_,t_,o_,m_,b_,w_;return N.wrap(function(y_){for(;;)switch(y_.prev=y_.next){case 0:if(s=o.message,a=o.peerId,_=o.toPeer,$=o.session,_e=o.errorCodes,_n=o.diff,_r=o.logger,$!==void 0){y_.next=3;break}throw new da("The client is not logged in. Cannot do the operation",_e.NOT_LOGGED_IN);case 3:if(_s=!1,na=_?s.messageType==="TEXT"?Ka.P2pSMsgNoOfflineFlag:Ka.P2pRMsgNoOfflineFlag:s.messageType==="TEXT"?Ka.ChannelSMsg:Ka.ChannelRMsg,s.messageType!=="TEXT"||!s.text.startsWith("AgoraRTMLegacyEndcallCompatibleMessagePrefix")||!_){y_.next=14;break}if(ba=s.text.split("_"),_p=$a(ba,3),_f=_p[0],_E=_p[1],_p[2]!==void 0&&Ta(_E)&&_f==="AgoraRTMLegacyEndcallCompatibleMessagePrefix"){y_.next=13;break}throw $.emit("messageCount",{messageCategory:na,type:"common",key:"sentcount"}),$.emit("messageCount",{messageCategory:na,type:"common",key:"invalidmessagecount"}),new ca("Message is not valid",bg);case 13:_s=!0;case 14:if(_v=Date.now(),n_=$.messageSentTimes.length-1,!((e_=$.messageSentTimes[n_])&&e_+3e3<_v)){y_.next=21;break}$.messageSentTimes=[_v],y_.next=34;break;case 21:t_=n_;case 22:if(!(0<=t_)){y_.next=33;break}if(!($.messageSentTimes[t_]+3e3<_v)){y_.next=26;break}return $.messageSentTimes=$.messageSentTimes.slice(t_+1,n_+1),y_.abrupt("break",33);case 26:if(!(180<=n_-t_+1)){y_.next=30;break}throw $.emit("messageCount",{messageCategory:na,type:"common",key:"sentcount"}),$.emit("messageCount",{messageCategory:na,type:"common",key:"toooftencount"}),new ic("Message sent failed, exceeded the 180 message in 3 seconds",_e.TOO_OFTEN);case 30:t_--,y_.next=22;break;case 33:$.messageSentTimes.push(_v);case 34:y_.t0=s.messageType,y_.next=y_.t0==="TEXT"?37:y_.t0==="RAW"?42:44;break;case 37:if(!_s){y_.next=41;break}return o_=s.text.split("_"),m_=$a(o_,3),b_=m_[1],w_=m_[2],_r.info("[rtm-API] EndCall message send api is called"),y_.abrupt("return",$.sendInvitationMessage({peerId:a,type:"CallCancel",extra:w_,channelId:b_,callId:"0"}));case 41:return y_.abrupt("return",$.sendTextMessage(s.text,a,_,1e4-_n));case 42:return s.description===void 0&&(s.description=""),y_.abrupt("return",$.sendRawMessage(s.rawMessage,s.description,a,_,1e4-_n));case 44:throw $.emit("messageCount",{messageCategory:na,type:"common",key:"sentcount"}),$.emit("messageCount",{messageCategory:na,type:"common",key:"invalidmessagecount"}),new ca("Invalid message type",bg);case 47:case"end":return y_.stop()}},e)}))).apply(this,arguments)}function Lv(e){var o=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1],s=e.replace(/(https?:\/\/)?(www.)?/i,"");return o||(s=s.split(".").slice(e.length-2).join(".")),s.indexOf("/")!==-1?s.split("/")[0]:s}function La(e){if(typeof e!="string")return"[Sensitive Info]";var o=Math.floor(.7*e.length),s=e.length;return Yn(e,o,s,"*".repeat(s-o))}function Zn(e,o,s){function a(_){if(e===void 0)return e;if(Mm(_))return _;if(Array.isArray(_))return _.map(a);var $={},_e=0;for(_=qh(_);_e<_.length;_e++){var _n=$a(_[_e],2),_r=_n[0];if(typeof(_n=_n[1])=="string"&&s.includes(_r)){$[_r]=typeof _n=="string"?La(_n):"[Sensitive Info]";break}o.includes(_r)?$[_r]="[Hidden Info]":$[_r]=_n==null?_n:s.includes(_r)?"[Sensitive Info]":a(_n)}return $}return Array.isArray(e)?e.map(a):a(e)}function $n(e){return Object.getOwnPropertyNames(e).forEach(function(o){qa(o=e[o])=="object"&&o!==null&&$n(o)}),Object.freeze(e)}function cg(e){return new TextDecoder("utf-8").decode(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength))}function rh(e){return new TextEncoder().encode(e).length}function ao(){for(var e=0,o=arguments.length,s=Array(o),a=0;a<o;a++)s[a]=arguments[a];for(o=0;o<s.length;o++)e+=s[o].length;for(e=new Uint8Array(e),a=o=0;a<s.length;a++){var _=s[a];e.set(_,o),o+=_.length}return e}function Xe(e,o,s){var a=e.match(/([^?#]+)(\?[^#]*)?(#.*)?/);if(e=a==null?void 0:a[1],a=a==null?void 0:a[2]){var _;for(a=a.substr(1).split("&"),_=0;_<a.length;_++)if(a[_].split("=")[0]==o){a[_]=o+"="+encodeURIComponent(s);break}return _==a.length&&a.push(o+"="+encodeURIComponent(s)),e+"?"+a.join("&")}return e+"?"+o+"="+encodeURIComponent(s)}function Yn(e,o,s,a){return typeof e!="string"?"[Sensitive Info]":e.substring(0,o)+a+e.substring(s)}function $f(e){return typeof e=="string"&&e.length!==0&&e!=="false"&&e!=="null"&&e!=="undefined"}function Mv(e,o){var s="".concat(e,"Uri");if(typeof(s=yj[s])!="number"||s===0)throw new TypeError("Got Unknown URI Name");return o=new(e=bo[e])(o),o=e.encode(o).finish(),new Nv({uri:s,data:o})}function co(e,o){var s=$f(null);return"".concat(e.split(".").join("-"),".edge.").concat(s?null:o?"sd-rtn.com":"agora.io")}function sh(e,o){return P.fromValue(e).eq(o)}function th(e,o){var s=o===void 0?e.val:o,a=e.isBoolean;o=e.isNumber;var _=e.oneof,$=e.len;if([a,o,_].filter(function(_e){return!_e}).length!==2)throw new TypeError("invalid field type");if(s!==void 0&&(e=!1,_!==void 0&&(_=zj(_),Ov(_,sh).length===_.length&&Pv(_,function(_e){return sh(s,_e)})!==void 0&&(e=!0)),a=a!==void 0&&(s===0||s===1)&&$===1,o=o!==void 0&&s.toString(2).length<=$,!(e||a||o)))throw Error("invalid field value")}function eo(e){return e.reduce(function(o,s){return o.concat(s instanceof uh.UnsubscriptionError?s.errors:s)},[])}function Qv(e,o){do dg==2147483647?dg=0:dg++;while(Ze.hasOwnProperty(dg));var s=dg;return Ze[s]={callback:e,parameters:Array.prototype.slice.call(arguments,2)},Aj.postMessage({name:"setInterval",fakeId:s,time:o}),s}function fo(e){return function(){var o=e();if(!o)throw new da("Client is not logged in. Cannot do the operation");return o}}var Ya=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:{},vh=function(e){return e&&e.Math==Math&&e},R=vh(typeof globalThis=="object"&&globalThis)||vh(typeof window=="object"&&window)||vh(typeof self=="object"&&self)||vh(typeof Ya=="object"&&Ya)||function(){return this}()||Function("return this")(),la=function(e){try{return!!e()}catch{return!0}},wa=!la(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),go={}.propertyIsEnumerable,ho=Object.getOwnPropertyDescriptor,eg=ho&&!go.call({1:2},1)?function(e){return!!(e=ho(this,e))&&e.enumerable}:go,Nc=function(e,o){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:o}},Rv={}.toString,xc=function(e){return Rv.call(e).slice(8,-1)},Sv="".split,fg=la(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return xc(e)=="String"?Sv.call(e,""):Object(e)}:Object,Eb=function(e){if(e==null)throw TypeError("Can't call method on "+e);return e},Mb=function(e){return fg(Eb(e))},xa=function(e){return typeof e=="object"?e!==null:typeof e=="function"},Oc=function(e,o){if(!xa(e))return e;var s,a;if(o&&typeof(s=e.toString)=="function"&&!xa(a=s.call(e))||typeof(s=e.valueOf)=="function"&&!xa(a=s.call(e))||!o&&typeof(s=e.toString)=="function"&&!xa(a=s.call(e)))return a;throw TypeError("Can't convert object to primitive value")},pb=function(e){return Object(Eb(e))},Tv={}.hasOwnProperty,ka=function(e,o){return Tv.call(pb(e),o)},$e=R.document,wh=xa($e)&&xa($e.createElement),io=!wa&&!la(function(){return Object.defineProperty(wh?$e.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),jo=Object.getOwnPropertyDescriptor,dc={f:wa?jo:function(e,o){if(e=Mb(e),o=Oc(o,!0),io)try{return jo(e,o)}catch{}if(ka(e,o))return Nc(!eg.call(e,o),e[o])}},Ia=function(e){if(!xa(e))throw TypeError(String(e)+" is not an object");return e},ko=Object.defineProperty,qb={f:wa?ko:function(e,o,s){if(Ia(e),o=Oc(o,!0),Ia(s),io)try{return ko(e,o,s)}catch{}if("get"in s||"set"in s)throw TypeError("Accessors not supported");return"value"in s&&(e[o]=s.value),e}},kb=wa?function(e,o,s){return qb.f(e,o,Nc(1,s))}:function(e,o,s){return e[o]=s,e},Bj=function(e,o){try{kb(R,e,o)}catch{R[e]=o}return o},zd=R["__core-js_shared__"]||Bj("__core-js_shared__",{}),Uv=Function.toString;typeof zd.inspectSource!="function"&&(zd.inspectSource=function(e){return Uv.call(e)});var Cj=zd.inspectSource,lo=R.WeakMap,Vv=typeof lo=="function"&&/native code/.test(Cj(lo)),Ad=xb(function(e){(e.exports=function(o,s){return zd[o]||(zd[o]=s!==void 0?s:{})})("versions",[]).push({version:"3.12.1",mode:"global",copyright:" 2021 Denis Pushkarev (zloirock.ru)"})}),Wv=0,Xv=Math.random(),af=function(e){return"Symbol("+String(e===void 0?"":e)+")_"+(++Wv+Xv).toString(36)},mo=Ad("keys"),xh=function(e){return mo[e]||(mo[e]=af(e))},bf={},Yv=R.WeakMap;if(Vv||zd.state)var ce=zd.state||(zd.state=new Yv),Zv=ce.get,no=ce.has,$v=ce.set,Dj=function(e,o){if(no.call(ce,e))throw new TypeError("Object already initialized");return o.facade=e,$v.call(ce,e,o),o},yh=function(e){return Zv.call(ce,e)||{}},Ej=function(e){return no.call(ce,e)};else{var cf=xh("state");bf[cf]=!0,Dj=function(e,o){if(ka(e,cf))throw new TypeError("Object already initialized");return o.facade=e,kb(e,cf,o),o},yh=function(e){return ka(e,cf)?e[cf]:{}},Ej=function(e){return ka(e,cf)}}var cb={set:Dj,get:yh,has:Ej,enforce:function(e){return Ej(e)?yh(e):Dj(e,{})},getterFor:function(e){return function(o){var s;if(!xa(o)||(s=yh(o)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return s}}},Za=xb(function(e){var o=cb.get,s=cb.enforce,a=String(String).split("String");(e.exports=function(_,$,_e,_n){var _r=!!_n&&!!_n.unsafe,_s=!!_n&&!!_n.enumerable;if(_n=!!_n&&!!_n.noTargetGet,typeof _e=="function"){typeof $!="string"||ka(_e,"name")||kb(_e,"name",$);var na=s(_e);na.source||(na.source=a.join(typeof $=="string"?$:""))}_===R?_s?_[$]=_e:Bj($,_e):(_r?!_n&&_[$]&&(_s=!0):delete _[$],_s?_[$]=_e:kb(_,$,_e))})(Function.prototype,"toString",function(){return typeof this=="function"&&o(this).source||Cj(this)})}),oo=function(e){return typeof e=="function"?e:void 0},Pc=function(e,o){return 2>arguments.length?oo(R[e])||oo(R[e]):R[e]&&R[e][o]||R[e]&&R[e][o]},aw=Math.ceil,bw=Math.floor,yc=function(e){return isNaN(e=+e)?0:(0<e?bw:aw)(e)},cw=Math.min,Ma=function(e){return 0<e?cw(yc(e),9007199254740991):0},dw=Math.max,ew=Math.min,Vb=function(e,o){return 0>(e=yc(e))?dw(e+o,0):ew(e,o)},po=function(e){return function(o,s,a){o=Mb(o);var _=Ma(o.length);if(a=Vb(a,_),e&&s!=s){for(;_>a;)if((s=o[a++])!=s)return!0}else for(;_>a;a++)if((e||a in o)&&o[a]===s)return e||a||0;return!e&&-1}},qo=po(!0),Fj=po(!1),ro=function(e,o){e=Mb(e);var s,a=0,_=[];for(s in e)!ka(bf,s)&&ka(e,s)&&_.push(s);for(;o.length>a;)ka(e,s=o[a++])&&(~Fj(_,s)||_.push(s));return _},zh="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),fw=zh.concat("length","prototype"),de={f:Object.getOwnPropertyNames||function(e){return ro(e,fw)}},gg={f:Object.getOwnPropertySymbols},so=Pc("Reflect","ownKeys")||function(e){var o=de.f(Ia(e)),s=gg.f;return s?o.concat(s(e)):o},to=function(e,o){for(var s=so(o),a=qb.f,_=dc.f,$=0;$<s.length;$++){var _e=s[$];ka(e,_e)||a(e,_e,_(o,_e))}},gw=/#|\.prototype\./,Qc=function(e,o){return(e=hw[iw(e)])==jw||e!=kw&&(typeof o=="function"?la(o):!!o)},iw=Qc.normalize=function(e){return String(e).replace(gw,".").toLowerCase()},hw=Qc.data={},kw=Qc.NATIVE="N",jw=Qc.POLYFILL="P",lw=dc.f,ea=function(e,o){var s,a,_,$=e.target,_e=e.global,_n=e.stat;if(a=_e?R:_n?R[$]||Bj($,{}):(R[$]||{}).prototype)for(_ in o){var _r=o[_],_s=e.noTargetGet?(s=lw(a,_))&&s.value:a[_];if(!(s=Qc(_e?_:$+(_n?".":"#")+_,e.forced))&&_s!==void 0){if(typeof _r==typeof _s)continue;to(_r,_s)}(e.sham||_s&&_s.sham)&&kb(_r,"sham",!0);try{Za(a,_,_r,e)}catch{}}},Gj=function(){var e=Ia(this),o="";return e.global&&(o+="g"),e.ignoreCase&&(o+="i"),e.multiline&&(o+="m"),e.dotAll&&(o+="s"),e.unicode&&(o+="u"),e.sticky&&(o+="y"),o},Rc=la(function(){var e=/a/y;return e.lastIndex=2,e.exec("abcd")!=null}),mw=la(function(){var e=/^r/gy;return e.lastIndex=2,e.exec("str")!=null}),Ah=RegExp.prototype.exec,nw=Ad("native-string-replace",String.prototype.replace),uo=Ah,Hj=(c=/a/,b=/b*/g,Ah.call(c,"a"),Ah.call(b,"a"),c.lastIndex!==0||b.lastIndex!==0),vo=Rc||mw,Ij=/()??/.exec("")[1]!==void 0,c,b;(Hj||Ij||vo)&&(uo=function(e){var o,s=vo&&this.sticky,a=Gj.call(this),_=this.source,$=0,_e=e;if(s){(a=a.replace("y","")).indexOf("g")===-1&&(a+="g"),_e=String(e).slice(this.lastIndex),0<this.lastIndex&&(!this.multiline||this.multiline&&e[this.lastIndex-1]!==`
`)&&(_="(?: "+_+")",_e=" "+_e,$++);var _n=new RegExp("^(?:"+_+")",a)}if(Ij&&(_n=new RegExp("^"+_+"$(?!\\s)",a)),Hj)var _r=this.lastIndex;var _s=Ah.call(s?_n:this,_e);return s?_s?(_s.input=_s.input.slice($),_s[0]=_s[0].slice($),_s.index=this.lastIndex,this.lastIndex+=_s[0].length):this.lastIndex=0:Hj&&_s&&(this.lastIndex=this.global?_s.index+_s[0].length:_r),Ij&&_s&&1<_s.length&&nw.call(_s[0],_n,function(){for(o=1;o<arguments.length-2;o++)arguments[o]===void 0&&(_s[o]=void 0)}),_s});var hg=uo;ea({target:"RegExp",proto:!0,forced:/./.exec!==hg},{exec:hg});var df=Pc("navigator","userAgent")||"",wo=R.process,xo=wo&&wo.versions,yo=xo&&xo.v8;if(yo)var Bd=yo.split("."),Jj=4>Bd[0]?1:Bd[0]+Bd[1];else df&&(Bd=df.match(/Edge\/(\d+)/),(!Bd||74<=Bd[1])&&(Bd=df.match(/Chrome\/(\d+)/))&&(Jj=Bd[1]));var Cd=Jj&&+Jj,Sc=!!Object.getOwnPropertySymbols&&!la(function(){return!String(Symbol())||!Symbol.sham&&Cd&&41>Cd}),zo=Sc&&!Symbol.sham&&typeof Symbol.iterator=="symbol",ig=Ad("wks"),jg=R.Symbol,ow=zo?jg:jg&&jg.withoutSetter||af,Fa=function(e){return ka(ig,e)&&(Sc||typeof ig[e]=="string")||(Sc&&ka(jg,e)?ig[e]=jg[e]:ig[e]=ow("Symbol."+e)),ig[e]},pw=Fa("species"),Kj=RegExp.prototype,qw=!la(function(){var e=/./;return e.exec=function(){var o=[];return o.groups={a:"7"},o},"".replace(e,"$<a>")!=="7"}),Ao="a".replace(/./,"$0")==="$0",Bo=Fa("replace"),Co=!!/./[Bo]&&/./[Bo]("a","$0")==="",rw=!la(function(){var e=/(?:)/,o=e.exec;return e.exec=function(){return o.apply(this,arguments)},(e="ab".split(e)).length!==2||e[0]!=="a"||e[1]!=="b"}),Bh=function(e,o,s,a){var _=Fa(e),$=!la(function(){var _s={};return _s[_]=function(){return 7},""[e](_s)!=7}),_e=$&&!la(function(){var _s=!1,na=/a/;return e==="split"&&((na={constructor:{}}).constructor[pw]=function(){return na},na.flags="",na[_]=/./[_]),na.exec=function(){return _s=!0,null},na[_](""),!_s});if(!$||!_e||e==="replace"&&(!qw||!Ao||Co)||e==="split"&&!rw){var _n=/./[_],_r=(s=s(_,""[e],function(_s,na,ba,_p,_f){var _E=na.exec;return _E===hg||_E===Kj.exec?$&&!_f?{done:!0,value:_n.call(na,ba,_p)}:{done:!0,value:_s.call(ba,na,_p)}:{done:!1}},{REPLACE_KEEPS_$0:Ao,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:Co}))[1];Za(String.prototype,e,s[0]),Za(Kj,_,o==2?function(_s,na){return _r.call(_s,this,na)}:function(_s){return _r.call(_s,this)})}a&&kb(Kj[_],"sham",!0)},sw=Fa("match"),Lj=function(e){var o;return xa(e)&&((o=e[sw])!==void 0?!!o:xc(e)=="RegExp")},Wb=function(e){if(typeof e!="function")throw TypeError(String(e)+" is not a function");return e},tw=Fa("species"),ee=function(e,o){var s;return(e=Ia(e).constructor)===void 0||(s=Ia(e)[tw])==null?o:Wb(s)},Do=function(e){return function(o,s){o=String(Eb(o)),s=yc(s);var a,_=o.length;if(0>s||s>=_)return e?"":void 0;var $=o.charCodeAt(s);return 55296>$||56319<$||s+1===_||56320>(a=o.charCodeAt(s+1))||57343<a?e?o.charAt(s):$:e?o.slice(s,s+2):a-56320+($-55296<<10)+65536}},uw=Do(!1),Eo=Do(!0),Mj=function(e,o,s){return o+(s?Eo(e,o).length:1)},ef=function(e,o){var s=e.exec;if(typeof s=="function"){if(typeof(e=s.call(e,o))!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return e}if(xc(e)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return hg.call(e,o)},vw=[].push,ww=Math.min;Bh("split",2,function(e,o,s){var a="abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||1<".".split(/()()/).length||"".split(/.?/).length?function(_,$){var _e=String(Eb(this));if(($=$===void 0?4294967295:$>>>0)===0)return[];if(_===void 0)return[_e];if(!Lj(_))return o.call(_e,_,$);var _n,_r,_s,na=[],ba=0;for(_=new RegExp(_.source,(_.ignoreCase?"i":"")+(_.multiline?"m":"")+(_.unicode?"u":"")+(_.sticky?"y":"")+"g");(_n=hg.call(_,_e))&&!((_r=_.lastIndex)>ba&&(na.push(_e.slice(ba,_n.index)),1<_n.length&&_n.index<_e.length&&vw.apply(na,_n.slice(1)),_s=_n[0].length,ba=_r,na.length>=$));)_.lastIndex===_n.index&&_.lastIndex++;return ba===_e.length?(_s||!_.test(""))&&na.push(""):na.push(_e.slice(ba)),na.length>$?na.slice(0,$):na}:"0".split(void 0,0).length?function(_,$){return _===void 0&&$===0?[]:o.call(this,_,$)}:o;return[function(_,$){var _e=Eb(this),_n=_==null?void 0:_[e];return _n!==void 0?_n.call(_,_e,$):a.call(String(_e),_,$)},function(_,$){var _e=s(a,_,this,$,a!==o);if(_e.done)return _e.value;var _n=Ia(_);_=String(this);var _r=ee(_n,RegExp);if(_e=_n.unicode,_n=new _r(Rc?"^(?:"+_n.source+")":_n,(_n.ignoreCase?"i":"")+(_n.multiline?"m":"")+(_n.unicode?"u":"")+(Rc?"g":"y")),($=$===void 0?4294967295:$>>>0)===0)return[];if(_.length===0)return ef(_n,_)===null?[_]:[];var _s=0,na=0;for(_r=[];na<_.length;){_n.lastIndex=Rc?0:na;var ba,_p=ef(_n,Rc?_.slice(na):_);if(_p===null||(ba=ww(Ma(_n.lastIndex+(Rc?na:0)),_.length))===_s)na=Mj(_,na,_e);else{if(_r.push(_.slice(_s,na)),_r.length===$)return _r;for(_s=1;_s<=_p.length-1;_s++)if(_r.push(_p[_s]),_r.length===$)return _r;na=_s=ba}}return _r.push(_.slice(_s)),_r}]},Rc);var xw=/^[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*/,yw=/[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$/,Nj=function(e){return function(o){return o=String(Eb(o)),1&e&&(o=o.replace(xw,"")),2&e&&(o=o.replace(yw,"")),o}},Oj=Nj(3),Ch=R.parseInt,zw=/^[+-]?0[Xx]/,Fo=Ch(`	
\v\f\r \u2028\u2029\uFEFF08`)!==8||Ch(`	
\v\f\r \u2028\u2029\uFEFF0x16`)!==22?function(e,o){return e=Oj(String(e)),Ch(e,o>>>0||(zw.test(e)?16:10))}:Ch;ea({global:!0,forced:parseInt!=Fo},{parseInt:Fo});var Dd=function(e,o,s){if(Wb(e),o===void 0)return e;switch(s){case 0:return function(){return e.call(o)};case 1:return function(a){return e.call(o,a)};case 2:return function(a,_){return e.call(o,a,_)};case 3:return function(a,_,$){return e.call(o,a,_,$)}}return function(){return e.apply(o,arguments)}},Ed=Array.isArray||function(e){return xc(e)=="Array"},Aw=Fa("species"),Dh=function(e,o){if(Ed(e)){var s=e.constructor;typeof s!="function"||s!==Array&&!Ed(s.prototype)?xa(s)&&(s=s[Aw])===null&&(s=void 0):s=void 0}return new(s===void 0?Array:s)(o===0?0:o)},Go=[].push,Fd=function(e){var o=e==1,s=e==2,a=e==3,_=e==4,$=e==6,_e=e==7,_n=e==5||$;return function(_r,_s,na,ba){var _p=pb(_r),_f=fg(_p);_s=Dd(_s,na,3),na=Ma(_f.length);var _E,_v=0;for(ba=ba||Dh,_r=o?ba(_r,na):s||_e?ba(_r,0):void 0;na>_v;_v++)if((_n||_v in _f)&&(_E=_s(ba=_f[_v],_v,_p),e))if(o)_r[_v]=_E;else if(_E)switch(e){case 3:return!0;case 5:return ba;case 6:return _v;case 2:Go.call(_r,ba)}else switch(e){case 4:return!1;case 7:Go.call(_r,ba)}return $?-1:a||_?_:_r}},fe=Fd(0),Ho=Fd(1),Io=Fd(2),Bw=Fd(3),Cw=Fd(4),Jo=Fd(5),Dw=Fd(6),Ew=Fa("species"),kg=function(e){return 51<=Cd||!la(function(){var o=[];return(o.constructor={})[Ew]=function(){return{foo:1}},o[e](Boolean).foo!==1})},Fw=kg("filter");ea({target:"Array",proto:!0,forced:!Fw},{filter:function(e){return Io(this,e,1<arguments.length?arguments[1]:void 0)}});var ed=Object.keys||function(e){return ro(e,zh)},Gw=la(function(){ed(1)});ea({target:"Object",stat:!0,forced:Gw},{keys:function(e){return ed(pb(e))}});var ff=function(e,o){var s=[][e];return!!s&&la(function(){s.call(null,o||function(){throw 1},1)})},Hw=[].join,Iw=fg!=Object,Jw=ff("join",",");ea({target:"Array",proto:!0,forced:Iw||!Jw},{join:function(e){return Hw.call(Mb(this),e===void 0?",":e)}});var Kw=kg("map");ea({target:"Array",proto:!0,forced:!Kw},{map:function(e){return Ho(this,e,1<arguments.length?arguments[1]:void 0)}});var Pj=function(e){var o=e.return;if(o!==void 0)return Ia(o.call(e)).value},gf={},Lw=Fa("iterator"),Mw=Array.prototype,Qj=function(e){return e!==void 0&&(gf.Array===e||Mw[Lw]===e)},hf=function(e,o,s){(o=Oc(o))in e?qb.f(e,o,Nc(0,s)):e[o]=s},Nw=Fa("toStringTag"),Ko={};Ko[Nw]="z";var Rj=String(Ko)==="[object z]",Ow=Fa("toStringTag"),Pw=xc(function(){return arguments}())=="Arguments",jf=Rj?xc:function(e){var o;if(e===void 0)var s="Undefined";else{if(e===null)var a="Null";else{e:{var _=e=Object(e);try{a=_[Ow];break e}catch{}a=void 0}a=typeof(s=a)=="string"?s:Pw?xc(e):(o=xc(e))=="Object"&&typeof e.callee=="function"?"Arguments":o}s=a}return s},Qw=Fa("iterator"),lg=function(e){if(e!=null)return e[Qw]||e["@@iterator"]||gf[jf(e)]},ge=function(e){var o,s=pb(e),a=typeof this=="function"?this:Array,_=arguments.length,$=1<_?arguments[1]:void 0,_e=$!==void 0,_n=lg(s),_r=0;if(_e&&($=Dd($,2<_?arguments[2]:void 0,2)),_n==null||a==Array&&Qj(_n)){var _s=Ma(s.length);for(a=new a(_s);_s>_r;_r++)_n=_e?$(s[_r],_r):s[_r],hf(a,_r,_n)}else for(_=(s=_n.call(s)).next,a=new a;!(o=_.call(s)).done;_r++){if(_e){_n=s;var na=$;o=[o.value,_r];try{_s=na(Ia(o)[0],o[1])}catch(ba){throw Pj(_n),ba}}else _s=o.value;hf(a,_r,_n=_s)}return a.length=_r,a},Lo=Fa("iterator"),Mo=!1;try{var Rw=0,No={next:function(){return{done:!!Rw++}},return:function(){Mo=!0}};No[Lo]=function(){return this},Array.from(No,function(){throw 2})}catch(e){}var Eh=function(e,o){if(!o&&!Mo)return!1;var s=!1;try{(o={})[Lo]=function(){return{next:function(){return{done:s=!0}}}},e(o)}catch{}return s},Sw=!Eh(function(e){Array.from(e)});ea({target:"Array",stat:!0,forced:Sw},{from:ge});var Oo=!la(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Po=xh("IE_PROTO"),Tw=Object.prototype,uc=Oo?Object.getPrototypeOf:function(e){return e=pb(e),ka(e,Po)?e[Po]:typeof e.constructor=="function"&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?Tw:null},Sj=Fa("iterator"),Qo=!1,Uw=function(){return this},he;if([].keys){var Ro=[].keys();if("next"in Ro){var So=uc(uc(Ro));So!==Object.prototype&&(he=So)}else Qo=!0}(he==null||la(function(){var e={};return he[Sj].call(e)!==e}))&&(he={}),ka(he,Sj)||kb(he,Sj,Uw);var Fh=he,Gh=Qo,To=wa?Object.defineProperties:function(e,o){Ia(e);for(var s,a=ed(o),_=a.length,$=0;_>$;)qb.f(e,s=a[$++],o[s]);return e},Tj=Pc("document","documentElement"),Uo=xh("IE_PROTO"),Uj=function(){},Vj,Hh=function(){try{Vj=document.domain&&new ActiveXObject("htmlfile")}catch{}if(Vj){var e=Vj;e.write("<script><\/script>"),e.close(),e=e.parentWindow.Object}else(e=wh?$e.createElement("iframe"):{}).style.display="none",Tj.appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),e=e.F;for(Hh=e,e=zh.length;e--;)delete Hh.prototype[zh[e]];return Hh()};bf[Uo]=!0;var jc=Object.create||function(e,o){if(e!==null){Uj.prototype=Ia(e);var s=new Uj;Uj.prototype=null,s[Uo]=e}else s=Hh();return o===void 0?s:To(s,o)},Vw=qb.f,Vo=Fa("toStringTag"),zc=function(e,o,s){e&&!ka(e=s?e:e.prototype,Vo)&&Vw(e,Vo,{configurable:!0,value:o})},Ww=function(){return this},Wo=function(e,o,s){return o+=" Iterator",e.prototype=jc(Fh,{next:Nc(1,s)}),zc(e,o,!1),gf[o]=Ww,e},tb=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,o={};try{var s=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set;s.call(o,[]),e=o instanceof Array}catch{}return function(a,_){if(Ia(a),!xa(_)&&_!==null)throw TypeError("Can't set "+String(_)+" as a prototype");return e?s.call(a,_):a.__proto__=_,a}}():void 0),mg=Fa("iterator"),Xw=function(){return this},Wj=function(e,o,s,a,_,$,_e){Wo(s,o,a),a=function(_v){if(_v===_&&_p)return _p;if(!Gh&&_v in na)return na[_v];switch(_v){case"keys":case"values":case"entries":return function(){return new s(this,_v)}}return function(){return new s(this)}};var _n,_r=o+" Iterator",_s=!1,na=e.prototype,ba=na[mg]||na["@@iterator"]||_&&na[_],_p=!Gh&&ba||a(_),_f=o=="Array"&&na.entries||ba;if(_f&&(e=uc(_f.call(new e)),Fh!==Object.prototype&&e.next&&(uc(e)!==Fh&&(tb?tb(e,Fh):typeof e[mg]!="function"&&kb(e,mg,Xw)),zc(e,_r,!0))),_=="values"&&ba&&ba.name!=="values"&&(_s=!0,_p=function(){return ba.call(this)}),na[mg]!==_p&&kb(na,mg,_p),gf[o]=_p,_){var _E={values:a("values"),keys:$?_p:a("keys"),entries:a("entries")};if(_e)for(_n in _E)!Gh&&!_s&&_n in na||Za(na,_n,_E[_n]);else ea({target:o,proto:!0,forced:Gh||_s},_E)}return _E},Yw=cb.set,Zw=cb.getterFor("String Iterator");Wj(String,"String",function(e){Yw(this,{type:"String Iterator",string:String(e),index:0})},function(){var e=Zw(this),o=e.string,s=e.index;return s>=o.length?{value:void 0,done:!0}:(o=Eo(o,s),e.index+=o.length,{value:o,done:!1})});var Xj=Fa("unscopables"),Yj=Array.prototype;Yj[Xj]==null&&qb.f(Yj,Xj,{configurable:!0,value:jc(null)});var ng=function(e){Yj[Xj][e]=!0},Xo=!0;"find"in[]&&Array(1).find(function(){Xo=!1}),ea({target:"Array",proto:!0,forced:Xo},{find:function(e){return Jo(this,e,1<arguments.length?arguments[1]:void 0)}}),ng("find");var Yo=function(e){var o=String(Eb(this)),s="";if(0>(e=yc(e))||e==1/0)throw RangeError("Wrong number of repetitions");for(;0<e;(e>>>=1)&&(o+=o))1&e&&(s+=o);return s};ea({target:"String",proto:!0},{repeat:Yo});var Zo=[].indexOf,$o=!!Zo&&0>1/[1].indexOf(1,-0),$w=ff("indexOf");ea({target:"Array",proto:!0,forced:$o||!$w},{indexOf:function(e){return $o?Zo.apply(this,arguments)||0:Fj(this,e,1<arguments.length?arguments[1]:void 0)}});var Zt=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,$t=/CrOS/,au=/android|ipad|playbook|silk/i;Ce.isMobile=Ce,Ce.default=Ce,ea({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991}),ea({target:"Number",stat:!0},{isNaN:function(e){return e!=e}}),R.Number.isNaN;var ax=Rj?{}.toString:function(){return"[object "+jf(this)+"]"};Rj||Za(Object.prototype,"toString",ax,{unsafe:!0});var Ih=R.Promise,kf=function(e,o,s){for(var a in o)Za(e,a,o[a],s);return e},ap=Fa("species"),og=function(e){e=Pc(e);var o=qb.f;wa&&e&&!e[ap]&&o(e,ap,{configurable:!0,get:function(){return this}})},Ac=function(e,o,s){if(!(e instanceof o))throw TypeError("Incorrect "+(s?s+" ":"")+"invocation");return e},pg=function(e,o){this.stopped=e,this.result=o},Jh=function(e,o,s){var a,_=!(!s||!s.AS_ENTRIES),$=!(!s||!s.IS_ITERATOR),_e=!(!s||!s.INTERRUPTED),_n=Dd(o,s&&s.that,1+_+_e),_r=function(na){return _s&&Pj(_s),new pg(!0,na)};if(o=function(na){return _?(Ia(na),_e?_n(na[0],na[1],_r):_n(na[0],na[1])):_e?_n(na,_r):_n(na)},$)var _s=e;else{if(typeof($=lg(e))!="function")throw TypeError("Target is not iterable");if(Qj($)){for($=0,s=Ma(e.length);s>$;$++)if((a=o(e[$]))&&a instanceof pg)return a;return new pg(!1)}_s=$.call(e)}for(e=_s.next;!($=e.call(_s)).done;){try{a=o($.value)}catch(na){throw Pj(_s),na}if(typeof a=="object"&&a&&a instanceof pg)return a}return new pg(!1)},bp=/(?:iphone|ipod|ipad).*applewebkit/i.test(df),fd=xc(R.process)=="process",Kh=R.location,Zj=R.setImmediate,cp=R.clearImmediate,bx=R.process,dp=R.MessageChannel,ak=R.Dispatch,bk=0,qg={},ck=function(e){if(qg.hasOwnProperty(e)){var o=qg[e];delete qg[e],o()}},dk=function(e){return function(){ck(e)}},ep=function(e){ck(e.data)},fp=function(e){R.postMessage(e+"",Kh.protocol+"//"+Kh.host)};if(!Zj||!cp)if(Zj=function(e){for(var o=[],s=1;arguments.length>s;)o.push(arguments[s++]);return qg[++bk]=function(){(typeof e=="function"?e:Function(e)).apply(void 0,o)},rg(bk),bk},cp=function(e){delete qg[e]},fd)var rg=function(e){bx.nextTick(dk(e))};else if(ak&&ak.now)rg=function(e){ak.now(dk(e))};else if(dp&&!bp){var gp=new dp,hp=gp.port2;gp.port1.onmessage=ep,rg=Dd(hp.postMessage,hp,1)}else R.addEventListener&&typeof postMessage=="function"&&!R.importScripts&&Kh&&Kh.protocol!=="file:"&&!la(fp)?(rg=fp,R.addEventListener("message",ep,!1)):rg="onreadystatechange"in(wh?$e.createElement("script"):{})?function(e){Tj.appendChild(wh?$e.createElement("script"):{}).onreadystatechange=function(){Tj.removeChild(this),ck(e)}}:function(e){setTimeout(dk(e),0)};var ek=Zj,cx=/web0s(?!.*chrome)/i.test(df),dx=dc.f,ip=R.MutationObserver||R.WebKitMutationObserver,jp=R.document,kp=R.process,Lh=R.Promise,lp=dx(R,"queueMicrotask"),mp=lp&&lp.value,ie,sg;if(!mp){var Nh=function(){var e;for(fd&&(e=kp.domain)&&e.exit();ie;){var o=ie.fn;ie=ie.next;try{o()}catch(s){throw ie?Mh():sg=void 0,s}}sg=void 0,e&&e.enter()};if(bp||fd||cx||!ip||!jp)if(Lh&&Lh.resolve){var fk=Lh.resolve(void 0);fk.constructor=Lh;var ex=fk.then,Mh=function(){ex.call(fk,Nh)}}else Mh=fd?function(){kp.nextTick(Nh)}:function(){ek.call(R,Nh)};else{var np=!0,op=jp.createTextNode("");new ip(Nh).observe(op,{characterData:!0}),Mh=function(){op.data=np=!np}}}var pp=mp||function(e){e={fn:e,next:void 0},sg&&(sg.next=e),ie||(ie=e,Mh()),sg=e},fx=function(e){var o,s;this.promise=new e(function(a,_){if(o!==void 0||s!==void 0)throw TypeError("Bad Promise constructor");o=a,s=_}),this.resolve=Wb(o),this.reject=Wb(s)},gk={f:function(e){return new fx(e)}},gx=function(e,o){var s=R.console;s&&s.error&&(arguments.length===1?s.error(e):s.error(e,o))},hk=function(e){try{return{error:!1,value:e()}}catch(o){return{error:!0,value:o}}},hx=typeof window=="object",ix=Fa("species"),qp=cb.get,jx=cb.set,kx=cb.getterFor("Promise"),je=Ih&&Ih.prototype,Xb=Ih,Oh=je,rp=R.TypeError,ik=R.document,jk=R.process,lf=gk.f,lx=lf,mx=!!(ik&&ik.createEvent&&R.dispatchEvent),sp=typeof PromiseRejectionEvent=="function",tp=!1,tg=Qc("Promise",function(){var e=Cj(Xb)!==String(Xb);if(!e&&Cd===66)return!0;if(51<=Cd&&/native code/.test(Xb))return!1;var o=new Xb(function(a){a(1)}),s=function(a){a(function(){},function(){})};return(o.constructor={})[ix]=s,!(tp=o.then(function(){})instanceof s)||!e&&hx&&!sp}),nx=tg||!Eh(function(e){Xb.all(e).catch(function(){})}),up=function(e){var o;return!(!xa(e)||typeof(o=e.then)!="function")&&o},kk=function(e,o){if(!e.notified){e.notified=!0;var s=e.reactions;pp(function(){for(var a=e.value,_=e.state==1,$=0;s.length>$;){var _e,_n=s[$++],_r=_?_n.ok:_n.fail,_s=_n.resolve,na=_n.reject,ba=_n.domain;try{if(_r){if(_||(e.rejection===2&&ox(e),e.rejection=1),_r===!0)var _p=a;else if(ba&&ba.enter(),_p=_r(a),ba){ba.exit();var _f=!0}_p===_n.promise?na(rp("Promise-chain cycle")):(_e=up(_p))?_e.call(_p,_s,na):_s(_p)}else na(a)}catch(_E){ba&&!_f&&ba.exit(),na(_E)}}e.reactions=[],e.notified=!1,o&&!e.rejection&&px(e)})}},vp=function(e,o,s){var a;if(mx){var _=ik.createEvent("Event");_.promise=o,_.reason=s,_.initEvent(e,!1,!0),R.dispatchEvent(_)}else _={promise:o,reason:s};!sp&&(a=R["on"+e])?a(_):e==="unhandledrejection"&&gx("Unhandled promise rejection",s)},px=function(e){ek.call(R,function(){var o=e.facade,s=e.value;if(e.rejection!==1&&!e.parent){var a=hk(function(){fd?jk.emit("unhandledRejection",s,o):vp("unhandledrejection",o,s)});if(e.rejection=fd||e.rejection!==1&&!e.parent?2:1,a.error)throw a.value}})},ox=function(e){ek.call(R,function(){var o=e.facade;fd?jk.emit("rejectionHandled",o):vp("rejectionhandled",o,e.value)})},mf=function(e,o,s){return function(a){e(o,a,s)}},nf=function(e,o,s){e.done||(e.done=!0,s&&(e=s),e.value=o,e.state=2,kk(e,!0))},lk=function(e,o,s){if(!e.done){e.done=!0,s&&(e=s);try{if(e.facade===o)throw rp("Promise can't be resolved itself");var a=up(o);a?pp(function(){var _={done:!1};try{a.call(o,mf(lk,_,e),mf(nf,_,e))}catch($){nf(_,$,e)}}):(e.value=o,e.state=1,kk(e,!1))}catch(_){nf({done:!1},_,e)}}};if(tg){Xb=function(e){Ac(this,Xb,"Promise"),Wb(e),mk.call(this);var o=qp(this);try{e(mf(lk,o),mf(nf,o))}catch(s){nf(o,s)}},Oh=Xb.prototype;var mk=function(e){jx(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})};mk.prototype=kf(Oh,{then:function(e,o){var s=kx(this),a=lf(ee(this,Xb));return a.ok=typeof e!="function"||e,a.fail=typeof o=="function"&&o,a.domain=fd?jk.domain:void 0,s.parent=!0,s.reactions.push(a),s.state!=0&&kk(s,!1),a.promise},catch:function(e){return this.then(void 0,e)}});var qx=function(){var e=new mk,o=qp(e);this.promise=e,this.resolve=mf(lk,o),this.reject=mf(nf,o)};if(gk.f=lf=function(e){return e===Xb||e===rx?new qx(e):lx(e)},typeof Ih=="function"&&je!==Object.prototype){var sx=je.then;tp||(Za(je,"then",function(e,o){var s=this;return new Xb(function(a,_){sx.call(s,a,_)}).then(e,o)},{unsafe:!0}),Za(je,"catch",Oh.catch,{unsafe:!0}));try{delete je.constructor}catch{}tb&&tb(je,Oh)}}ea({global:!0,wrap:!0,forced:tg},{Promise:Xb}),zc(Xb,"Promise",!1),og("Promise");var rx=Pc("Promise");ea({target:"Promise",stat:!0,forced:tg},{reject:function(e){var o=lf(this);return o.reject.call(void 0,e),o.promise}}),ea({target:"Promise",stat:!0,forced:tg},{resolve:function(e){if(Ia(this),!xa(e)||e.constructor!==this){var o=gk.f(this);(0,o.resolve)(e),e=o.promise}return e}}),ea({target:"Promise",stat:!0,forced:nx},{all:function(e){var o=this,s=lf(o),a=s.resolve,_=s.reject,$=hk(function(){var _e=Wb(o.resolve),_n=[],_r=0,_s=1;Jh(e,function(na){var ba=_r++,_p=!1;_n.push(void 0),_s++,_e.call(o,na).then(function(_f){_p||(_p=!0,_n[ba]=_f,--_s||a(_n))},_)}),--_s||a(_n)});return $.error&&_($.value),s.promise},race:function(e){var o=this,s=lf(o),a=s.reject,_=hk(function(){var $=Wb(o.resolve);Jh(e,function(_e){$.call(o,_e).then(s.resolve,a)})});return _.error&&a(_.value),s.promise}});var tx=Math.floor,ux="".replace,vx=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,wx=/\$([$&'`]|\d{1,2})/g,xx=function(e,o,s,a,_,$){var _e=s+e.length,_n=a.length,_r=wx;return _!==void 0&&(_=pb(_),_r=vx),ux.call($,_r,function(_s,na){switch(na.charAt(0)){case"$":return"$";case"&":return e;case"`":return o.slice(0,s);case"'":return o.slice(_e);case"<":_s=_[na.slice(1,-1)];break;default:var ba=+na;if(ba===0)return _s;if(ba>_n)return(ba=tx(ba/10))===0?_s:ba<=_n?a[ba-1]===void 0?na.charAt(1):a[ba-1]+na.charAt(1):_s;_s=a[ba-1]}return _s===void 0?"":_s})},yx=Math.max,zx=Math.min;Bh("replace",2,function(e,o,s,a){var _=a.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,$=a.REPLACE_KEEPS_$0,_e=_?"$":"$0";return[function(_n,_r){var _s=Eb(this),na=_n==null?void 0:_n[e];return na!==void 0?na.call(_n,_s,_r):o.call(String(_s),_n,_r)},function(_n,_r){if(!_&&$||typeof _r=="string"&&_r.indexOf(_e)===-1){var _s=s(o,_n,this,_r);if(_s.done)return _s.value}var na=Ia(_n);_n=String(this),(_s=typeof _r=="function")||(_r=String(_r));var ba=na.global;if(ba){var _p=na.unicode;na.lastIndex=0}for(var _f=[];;){var _E=ef(na,_n);if(_E===null||(_f.push(_E),!ba))break;String(_E[0])===""&&(na.lastIndex=Mj(_n,Ma(na.lastIndex),_p))}for(_p="",ba=na=0;ba<_f.length;ba++){_E=_f[ba];for(var _v=String(_E[0]),n_=yx(zx(yc(_E.index),_n.length),0),e_=[],t_=1;t_<_E.length;t_++){var o_=e_,m_=_E[t_];o_.push.call(o_,m_===void 0?m_:String(m_))}_E=_E.groups,_s?(e_=[_v].concat(e_,n_,_n),_E!==void 0&&e_.push(_E),_E=String(_r.apply(void 0,e_))):_E=xx(_v,_n,n_,e_,_E,_r),n_>=na&&(_p+=_n.slice(na,n_)+_E,na=n_+_v.length)}return _p+_n.slice(na)}]});var Ax=kg("slice"),Bx=Fa("species"),Cx=[].slice,Dx=Math.max;ea({target:"Array",proto:!0,forced:!Ax},{slice:function(e,o){var s=Mb(this),a=Ma(s.length);if(e=Vb(e,a),o=Vb(o===void 0?a:o,a),Ed(s)){var _=s.constructor;if(typeof _!="function"||_!==Array&&!Ed(_.prototype)?xa(_)&&(_=_[Bx])===null&&(_=void 0):_=void 0,_===Array||_===void 0)return Cx.call(s,e,o)}for(_=new(_===void 0?Array:_)(Dx(o-e,0)),a=0;e<o;e++,a++)e in s&&hf(_,a,s[e]);return _.length=a,_}});var Ex=cb.set,Fx=cb.getterFor("Array Iterator"),Gd=Wj(Array,"Array",function(e,o){Ex(this,{type:"Array Iterator",target:Mb(e),index:0,kind:o})},function(){var e=Fx(this),o=e.target,s=e.kind,a=e.index++;return!o||a>=o.length?(e.target=void 0,{value:void 0,done:!0}):s=="keys"?{value:a,done:!1}:s=="values"?{value:o[a],done:!1}:{value:[a,o[a]],done:!1}},"values");gf.Arguments=gf.Array,ng("keys"),ng("values"),ng("entries");var wp=typeof ArrayBuffer<"u"&&typeof DataView<"u",of=function(e){if(e===void 0)return 0;e=yc(e);var o=Ma(e);if(e!==o)throw RangeError("Wrong length or index");return o},Gx=Math.abs,gd=Math.pow,Hx=Math.floor,Ix=Math.log,Jx=Math.LN2,xp=function(e){var o=pb(this),s=Ma(o.length),a=arguments.length,_=Vb(1<a?arguments[1]:void 0,s);for(s=(a=2<a?arguments[2]:void 0)===void 0?s:Vb(a,s);s>_;)o[_++]=e;return o},Kx=de.f,Lx=qb.f,pf=cb.get,yp=cb.set,Bc=R.ArrayBuffer,Yb=Bc,Cc=R.DataView,Ph=Cc&&Cc.prototype,zp=Object.prototype,Qh=R.RangeError,Ap=function(e,o,s){var a,_=Array(s),$=(1<<(s=8*s-o-1))-1,_e=$>>1,_n=o===23?gd(2,-24)-gd(2,-77):0,_r=0>e||e===0&&0>1/e?1:0,_s=0;if((e=Gx(e))!=e||e===1/0){e=e!=e?1:0;var na=$}else na=Hx(Ix(e)/Jx),1>e*(a=gd(2,-na))&&(na--,a*=2),2<=(e=1<=na+_e?e+_n/a:e+_n*gd(2,1-_e))*a&&(na++,a/=2),na+_e>=$?(e=0,na=$):1<=na+_e?(e=(e*a-1)*gd(2,o),na+=_e):(e=e*gd(2,_e-1)*gd(2,o),na=0);for(;8<=o;_[_s++]=255&e,e/=256,o-=8);for(na=na<<o|e,s+=o;0<s;_[_s++]=255&na,na/=256,s-=8);return _[--_s]|=128*_r,_},Bp=function(e,o){var s=e.length,a=8*s-o-1,_=(1<<a)-1,$=_>>1;a-=7,--s;var _e=e[s--],_n=127&_e;for(_e>>=7;0<a;_n=256*_n+e[s],s--,a-=8);var _r=_n&(1<<-a)-1;for(_n>>=-a,a+=o;0<a;_r=256*_r+e[s],s--,a-=8);if(_n===0)_n=1-$;else{if(_n===_)return _r?NaN:_e?-1/0:1/0;_r+=gd(2,o),_n-=$}return(_e?-1:1)*_r*gd(2,_n-o)},Cp=function(e){return[255&e]},Dp=function(e){return[255&e,e>>8&255]},Ep=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},Fp=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},Mx=function(e){return Ap(e,23,4)},Nx=function(e){return Ap(e,52,8)},Rh=function(e,o){Lx(e.prototype,o,{get:function(){return pf(this)[o]}})},Hd=function(e,o,s,a){s=of(s);var _=pf(e);if(s+o>_.byteLength)throw Qh("Wrong index");return e=pf(_.buffer).bytes,s+=_.byteOffset,o=e.slice(s,s+o),a?o:o.reverse()},Id=function(e,o,s,a,_,$){s=of(s);var _e=pf(e);if(s+o>_e.byteLength)throw Qh("Wrong index");for(e=pf(_e.buffer).bytes,s+=_e.byteOffset,a=a(+_),_=0;_<o;_++)e[s+_]=a[$?_:o-_-1]};if(wp){if(!la(function(){Bc(1)})||!la(function(){new Bc(-1)})||la(function(){return new Bc,new Bc(1.5),new Bc(NaN),Bc.name!="ArrayBuffer"})){Yb=function(e){return Ac(this,Yb),new Bc(of(e))};for(var Ox=Yb.prototype=Bc.prototype,Gp=Kx(Bc),Hp=0,nk;Gp.length>Hp;)(nk=Gp[Hp++])in Yb||kb(Yb,nk,Bc[nk]);Ox.constructor=Yb}tb&&uc(Ph)!==zp&&tb(Ph,zp);var Sh=new Cc(new Yb(2)),Ip=Ph.setInt8;Sh.setInt8(0,2147483648),Sh.setInt8(1,2147483649),!Sh.getInt8(0)&&Sh.getInt8(1)||kf(Ph,{setInt8:function(e,o){Ip.call(this,e,o<<24>>24)},setUint8:function(e,o){Ip.call(this,e,o<<24>>24)}},{unsafe:!0})}else Yb=function(e){Ac(this,Yb,"ArrayBuffer"),e=of(e),yp(this,{bytes:xp.call(Array(e),0),byteLength:e}),wa||(this.byteLength=e)},Cc=function(e,o,s){Ac(this,Cc,"DataView"),Ac(e,Yb,"DataView");var a=pf(e).byteLength;if(0>(o=yc(o))||o>a)throw Qh("Wrong offset");if(o+(s=s===void 0?a-o:Ma(s))>a)throw Qh("Wrong length");yp(this,{buffer:e,byteLength:s,byteOffset:o}),wa||(this.buffer=e,this.byteLength=s,this.byteOffset=o)},wa&&(Rh(Yb,"byteLength"),Rh(Cc,"buffer"),Rh(Cc,"byteLength"),Rh(Cc,"byteOffset")),kf(Cc.prototype,{getInt8:function(e){return Hd(this,1,e)[0]<<24>>24},getUint8:function(e){return Hd(this,1,e)[0]},getInt16:function(e){var o=Hd(this,2,e,1<arguments.length?arguments[1]:void 0);return(o[1]<<8|o[0])<<16>>16},getUint16:function(e){var o=Hd(this,2,e,1<arguments.length?arguments[1]:void 0);return o[1]<<8|o[0]},getInt32:function(e){return Fp(Hd(this,4,e,1<arguments.length?arguments[1]:void 0))},getUint32:function(e){return Fp(Hd(this,4,e,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(e){return Bp(Hd(this,4,e,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(e){return Bp(Hd(this,8,e,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(e,o){Id(this,1,e,Cp,o)},setUint8:function(e,o){Id(this,1,e,Cp,o)},setInt16:function(e,o){Id(this,2,e,Dp,o,2<arguments.length?arguments[2]:void 0)},setUint16:function(e,o){Id(this,2,e,Dp,o,2<arguments.length?arguments[2]:void 0)},setInt32:function(e,o){Id(this,4,e,Ep,o,2<arguments.length?arguments[2]:void 0)},setUint32:function(e,o){Id(this,4,e,Ep,o,2<arguments.length?arguments[2]:void 0)},setFloat32:function(e,o){Id(this,4,e,Mx,o,2<arguments.length?arguments[2]:void 0)},setFloat64:function(e,o){Id(this,8,e,Nx,o,2<arguments.length?arguments[2]:void 0)}});zc(Yb,"ArrayBuffer"),zc(Cc,"DataView");var ug={ArrayBuffer:Yb,DataView:Cc},ok=ug.ArrayBuffer,Jp=ug.DataView,Kp=ok.prototype.slice,Px=la(function(){return!new ok(2).slice(1,void 0).byteLength});ea({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:Px},{slice:function(e,o){if(Kp!==void 0&&o===void 0)return Kp.call(Ia(this),e);var s=Ia(this).byteLength;e=Vb(e,s),o=Vb(o===void 0?s:o,s),s=new(ee(this,ok))(Ma(o-e));for(var a=new Jp(this),_=new Jp(s),$=0;e<o;)_.setUint8($++,a.getUint8(e++));return s}});var Qx=qb.f,Th=R.Int8Array,pk=Th&&Th.prototype,Lp=R.Uint8ClampedArray,Mp=Lp&&Lp.prototype,Tc=Th&&uc(Th),Dc=pk&&uc(pk),Np=Object.prototype,Op=Np.isPrototypeOf,Pp=Fa("toStringTag"),qk=af("TYPED_ARRAY_TAG"),hd=wp&&!!tb&&jf(R.opera)!=="Opera",Qp=!1,Zb,Uc={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Rx={BigInt64Array:8,BigUint64Array:8},Uh=function(e){return!!xa(e)&&(e=jf(e),ka(Uc,e)||ka(Rx,e))};for(Zb in Uc)R[Zb]||(hd=!1);if((!hd||typeof Tc!="function"||Tc===Function.prototype)&&(Tc=function(){throw TypeError("Incorrect invocation")},hd))for(Zb in Uc)R[Zb]&&tb(R[Zb],Tc);if((!hd||!Dc||Dc===Np)&&(Dc=Tc.prototype,hd))for(Zb in Uc)R[Zb]&&tb(R[Zb].prototype,Dc);if(hd&&uc(Mp)!==Dc&&tb(Mp,Dc),wa&&!ka(Dc,Pp))for(Zb in Qp=!0,Qx(Dc,Pp,{get:function(){return xa(this)?this[qk]:void 0}}),Uc)R[Zb]&&kb(R[Zb],qk,Zb);var vg=hd,Rp=Qp&&qk,Ua=function(e){if(Uh(e))return e;throw TypeError("Target is not a typed array")},qf=function(e){if(tb){if(Op.call(Tc,e))return e}else for(var o in Uc)if(ka(Uc,Zb)){var s=R[o];if(s&&(e===s||Op.call(s,e)))return e}throw TypeError("Target is not a typed array constructor")},Ra=function(e,o,s){if(wa){if(s)for(var a in Uc){var _=R[a];if(_&&ka(_.prototype,e))try{delete _.prototype[e]}catch{}}Dc[e]&&!s||Za(Dc,e,s?o:hd&&pk[e]||o)}},Sp=function(e,o,s){var a,_;if(wa){if(tb){if(s){for(a in Uc)if((_=R[a])&&ka(_,e))try{delete _[e]}catch{}}if(Tc[e]&&!s)return;try{return Za(Tc,e,s?o:hd&&Tc[e]||o)}catch{}}for(a in Uc)!(_=R[a])||_[e]&&!s||Za(_,e,o)}},Tp=Tc,wg=Dc,Sx=R.ArrayBuffer,ke=R.Int8Array,rk=!vg||!la(function(){ke(1)})||!la(function(){new ke(-1)})||!Eh(function(e){new ke,new ke(null),new ke(1.5),new ke(e)},!0)||la(function(){return new ke(new Sx(2),1,void 0).length!==1}),Vh=function(e,o){if(0>(e=yc(e)))throw RangeError("The argument can't be less than 0");if(e%o)throw RangeError("Wrong offset");return e},sk=function(e){var o=pb(e),s=arguments.length,a=1<s?arguments[1]:void 0,_=a!==void 0,$=lg(o);if($!=null&&!Qj($)){var _e=$.call(o),_n=_e.next;for(o=[];!($=_n.call(_e)).done;)o.push($.value)}for(_&&2<s&&(a=Dd(a,arguments[2],2)),$=Ma(o.length),_e=new(qf(this))($),s=0;$>s;s++)_e[s]=_?a(o[s],s):o[s];return _e},Wh=function(e,o,s){var a,_;return tb&&typeof(a=o.constructor)=="function"&&a!==s&&xa(_=a.prototype)&&_!==s.prototype&&tb(e,_),e},xg=xb(function(e){var o=de.f,s=cb.get,a=cb.set,_=qb.f,$=dc.f,_e=Math.round,_n=R.RangeError,_r=ug.ArrayBuffer,_s=ug.DataView,na=function(n_,e_){var t_=0,o_=e_.length;for(n_=new(qf(n_))(o_);o_>t_;)n_[t_]=e_[t_++];return n_},ba=function(n_,e_){_(n_,e_,{get:function(){return s(this)[e_]}})},_p=function(n_){var e_;return n_ instanceof _r||(e_=jf(n_))=="ArrayBuffer"||e_=="SharedArrayBuffer"},_f=function(n_,e_){return Uh(n_)&&typeof e_!="symbol"&&e_ in n_&&String(+e_)==String(e_)},_E=function(n_,e_){return _f(n_,e_=Oc(e_,!0))?Nc(2,n_[e_]):$(n_,e_)},_v=function(n_,e_,t_){return!(_f(n_,e_=Oc(e_,!0))&&xa(t_)&&ka(t_,"value"))||ka(t_,"get")||ka(t_,"set")||t_.configurable||ka(t_,"writable")&&!t_.writable||ka(t_,"enumerable")&&!t_.enumerable?_(n_,e_,t_):(n_[e_]=t_.value,n_)};wa?(vg||(dc.f=_E,qb.f=_v,ba(wg,"buffer"),ba(wg,"byteOffset"),ba(wg,"byteLength"),ba(wg,"length")),ea({target:"Object",stat:!0,forced:!vg},{getOwnPropertyDescriptor:_E,defineProperty:_v}),e.exports=function(n_,e_,t_){var o_=n_.match(/\d+$/)[0]/8,m_=n_+(t_?"Clamped":"")+"Array",b_="get"+n_,w_="set"+n_,y_=R[m_],N_=y_;n_=N_&&N_.prototype;var _y={},v_=function(A_,k_){_(A_,k_,{get:function(){var P_=s(this);return P_.view[b_](k_*o_+P_.byteOffset,!0)},set:function(P_){var T_=s(this);t_&&(P_=0>(P_=_e(P_))?0:255<P_?255:255&P_),T_.view[w_](k_*o_+T_.byteOffset,P_,!0)},enumerable:!0})};vg?rk&&(N_=e_(function(A_,k_,P_,T_){return Ac(A_,N_,m_),Wh(xa(k_)?_p(k_)?T_!==void 0?new y_(k_,Vh(P_,o_),T_):P_!==void 0?new y_(k_,Vh(P_,o_)):new y_(k_):Uh(k_)?na(N_,k_):sk.call(N_,k_):new y_(of(k_)),A_,N_)}),tb&&tb(N_,Tp),fe(o(y_),function(A_){A_ in N_||kb(N_,A_,y_[A_])}),N_.prototype=n_):(N_=e_(function(A_,k_,P_,T_){Ac(A_,N_,m_);var R_=0,I_=0;if(xa(k_)){if(!_p(k_))return Uh(k_)?na(N_,k_):sk.call(N_,k_);var U_=k_;if(I_=Vh(P_,o_),k_=k_.byteLength,T_===void 0){if(k_%o_||0>(T_=k_-I_))throw _n("Wrong length")}else if((T_=Ma(T_)*o_)+I_>k_)throw _n("Wrong length");k_=T_/o_}else k_=of(k_),U_=new _r(T_=k_*o_);for(a(A_,{buffer:U_,byteOffset:I_,byteLength:T_,length:k_,view:new _s(U_)});R_<k_;)v_(A_,R_++)}),tb&&tb(N_,Tp),n_=N_.prototype=jc(wg)),n_.constructor!==N_&&kb(n_,"constructor",N_),Rp&&kb(n_,Rp,m_),_y[m_]=N_,ea({global:!0,forced:N_!=y_,sham:!vg},_y),"BYTES_PER_ELEMENT"in N_||kb(N_,"BYTES_PER_ELEMENT",o_),"BYTES_PER_ELEMENT"in n_||kb(n_,"BYTES_PER_ELEMENT",o_),og(m_)}):e.exports=function(){}});xg("Uint8",function(e){return function(o,s,a){return e(this,o,s,a)}});var Tx=Math.min,Ux=[].copyWithin||function(e,o){var s=pb(this),a=Ma(s.length),_=Vb(e,a),$=Vb(o,a),_e=2<arguments.length?arguments[2]:void 0;for(a=Tx((_e===void 0?a:Vb(_e,a))-$,a-_),_e=1,$<_&&_<$+a&&(_e=-1,$+=a-1,_+=a-1);0<a--;)$ in s?s[_]=s[$]:delete s[_],_+=_e,$+=_e;return s};Ra("copyWithin",function(e,o){return Ux.call(Ua(this),e,o,2<arguments.length?arguments[2]:void 0)}),Ra("every",function(e){return Cw(Ua(this),e,1<arguments.length?arguments[1]:void 0)}),Ra("fill",function(e){return xp.apply(Ua(this),arguments)}),Ra("filter",function(e){var o=Io(Ua(this),e,1<arguments.length?arguments[1]:void 0),s=ee(this,this.constructor),a=0,_=o.length;for(s=new(qf(s))(_);_>a;)s[a]=o[a++];return s}),Ra("find",function(e){return Jo(Ua(this),e,1<arguments.length?arguments[1]:void 0)}),Ra("findIndex",function(e){return Dw(Ua(this),e,1<arguments.length?arguments[1]:void 0)}),Ra("forEach",function(e){fe(Ua(this),e,1<arguments.length?arguments[1]:void 0)}),Ra("includes",function(e){return qo(Ua(this),e,1<arguments.length?arguments[1]:void 0)}),Ra("indexOf",function(e){return Fj(Ua(this),e,1<arguments.length?arguments[1]:void 0)});var Up=Fa("iterator"),Vp=R.Uint8Array,Vx=Gd.values,Wx=Gd.keys,Xx=Gd.entries,tk=Vp&&Vp.prototype[Up],Wp=!!tk&&(tk.name=="values"||tk.name==null),Xp=function(){return Vx.call(Ua(this))};Ra("entries",function(){return Xx.call(Ua(this))}),Ra("keys",function(){return Wx.call(Ua(this))}),Ra("values",Xp,!Wp),Ra(Up,Xp,!Wp);var Yx=[].join;Ra("join",function(e){return Yx.apply(Ua(this),arguments)});var Zx=Math.min,uk=[].lastIndexOf,Yp=!!uk&&0>1/[1].lastIndexOf(1,-0),$x=ff("lastIndexOf"),ay=Yp||!$x?function(e){if(Yp)return uk.apply(this,arguments)||0;var o=Mb(this),s=Ma(o.length),a=s-1;for(1<arguments.length&&(a=Zx(a,yc(arguments[1]))),0>a&&(a=s+a);0<=a;a--)if(a in o&&o[a]===e)return a||0;return-1}:uk;Ra("lastIndexOf",function(e){return ay.apply(Ua(this),arguments)}),Ra("map",function(e){return Ho(Ua(this),e,1<arguments.length?arguments[1]:void 0,function(o,s){return new(qf(ee(o,o.constructor)))(s)})});var Zp=function(e){return function(o,s,a,_){Wb(s),o=pb(o);var $=fg(o),_e=Ma(o.length),_n=e?_e-1:0,_r=e?-1:1;if(2>a)for(;;){if(_n in $){_=$[_n],_n+=_r;break}if(_n+=_r,e?0>_n:_e<=_n)throw TypeError("Reduce of empty array with no initial value")}for(;e?0<=_n:_e>_n;_n+=_r)_n in $&&(_=s(_,$[_n],_n,o));return _}},$p=Zp(!1),by=Zp(!0);Ra("reduce",function(e){return $p(Ua(this),e,arguments.length,1<arguments.length?arguments[1]:void 0)}),Ra("reduceRight",function(e){return by(Ua(this),e,arguments.length,1<arguments.length?arguments[1]:void 0)});var cy=Math.floor;Ra("reverse",function(){for(var e,o=Ua(this).length,s=cy(o/2),a=0;a<s;)e=this[a],this[a++]=this[--o],this[o]=e;return this});var dy=la(function(){new Int8Array(1).set({})});Ra("set",function(e){Ua(this);var o=Vh(1<arguments.length?arguments[1]:void 0,1),s=this.length,a=pb(e),_=Ma(a.length),$=0;if(_+o>s)throw RangeError("Wrong length");for(;$<_;)this[o+$]=a[$++]},dy);var ey=[].slice,fy=la(function(){new Int8Array(1).slice()});Ra("slice",function(e,o){e=ey.call(Ua(this),e,o);var s=ee(this,this.constructor);o=0;var a=e.length;for(s=new(qf(s))(a);a>o;)s[o]=e[o++];return s},fy),Ra("some",function(e){return Bw(Ua(this),e,1<arguments.length?arguments[1]:void 0)});var gy=[].sort;Ra("sort",function(e){return gy.call(Ua(this),e)}),Ra("subarray",function(e,o){var s=Ua(this),a=s.length;return e=Vb(e,a),new(ee(s,s.constructor))(s.buffer,s.byteOffset+e*s.BYTES_PER_ELEMENT,Ma((o===void 0?a:Vb(o,a))-e))});var Xh=R.Int8Array,aq=[].toLocaleString,hy=[].slice,iy=!!Xh&&la(function(){aq.call(new Xh(1))}),jy=la(function(){return[1,2].toLocaleString()!=new Xh([1,2]).toLocaleString()})||!la(function(){Xh.prototype.toLocaleString.call([1,2])});Ra("toLocaleString",function(){return aq.apply(iy?hy.call(Ua(this)):Ua(this),arguments)},jy);var bq=R.Uint8Array,ky=bq&&bq.prototype||{},Yh=[].toString,ly=[].join;la(function(){Yh.call({})})&&(Yh=function(){return ly.call(this)}),Ra("toString",Yh,ky.toString!=Yh);var cq=ug.ArrayBuffer;ea({global:!0,forced:R.ArrayBuffer!==cq},{ArrayBuffer:cq}),og("ArrayBuffer");var my=qb.f,vk=Function.prototype,ny=vk.toString,oy=/^\s*function ([^ (]*)/;!wa||"name"in vk||my(vk,"name",{configurable:!0,get:function(){try{return ny.call(this).match(oy)[1]}catch{return""}}});var dq=RegExp.prototype,eq=dq.toString,py=la(function(){return eq.call({source:"a",flags:"b"})!="/a/b"}),qy=eq.name!="toString";(py||qy)&&Za(RegExp.prototype,"toString",function(){var e=Ia(this),o=String(e.source),s=e.flags;return"/"+o+"/"+(e=String(s===void 0&&e instanceof RegExp&&!("flags"in dq)?Gj.call(e):s))},{unsafe:!0});var ry=kg("splice"),sy=Math.max,ty=Math.min;ea({target:"Array",proto:!0,forced:!ry},{splice:function(e,o){var s,a,_=pb(this),$=Ma(_.length),_e=Vb(e,$),_n=arguments.length;if(_n===0?_n=s=0:_n===1?(_n=0,s=$-_e):(_n-=2,s=ty(sy(yc(o),0),$-_e)),9007199254740991<$+_n-s)throw TypeError("Maximum allowed length exceeded");var _r=Dh(_,s);for(a=0;a<s;a++){var _s=_e+a;_s in _&&hf(_r,a,_[_s])}if(_r.length=s,_n<s){for(a=_e;a<$-s;a++){var na=a+_n;(_s=a+s)in _?_[na]=_[_s]:delete _[na]}for(a=$;a>$-s+_n;a--)delete _[a-1]}else if(_n>s)for(a=$-s;a>_e;a--)na=a+_n-1,(_s=a+s-1)in _?_[na]=_[_s]:delete _[na];for(a=0;a<_n;a++)_[a+_e]=arguments[a+2];return _.length=$-s+_n,_r}});var wk={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},xk=Fa("iterator"),fq=Fa("toStringTag"),yk=Gd.values,Zh;for(Zh in wk){var gq=R[Zh],id=gq&&gq.prototype;if(id){if(id[xk]!==yk)try{kb(id,xk,yk)}catch{id[xk]=yk}if(id[fq]||kb(id,fq,Zh),wk[Zh]){for(var rf in Gd)if(id[rf]!==Gd[rf])try{kb(id,rf,Gd[rf])}catch{id[rf]=Gd[rf]}}}}var hq=Object.is||function(e,o){return e===o?e!==0||1/e==1/o:e!=e&&o!=o};Bh("search",1,function(e,o,s){return[function(a){var _=Eb(this),$=a==null?void 0:a[e];return $!==void 0?$.call(a,_):new RegExp(a)[e](String(_))},function(a){var _=s(o,a,this);if(_.done)return _.value;a=Ia(a);var $=String(this);return _=a.lastIndex,hq(_,0)||(a.lastIndex=0),$=ef(a,$),hq(a.lastIndex,_)||(a.lastIndex=_),$===null?-1:$.index}]}),xb(function(e){(function(o,s){e.exports?e.exports=s(o):s(o)})(typeof self<"u"?self:Ya,function(o){function s(v_){return btoa(v_).replace(/=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function a(v_){return v_=(v_+="===").slice(0,-v_.length%4),atob(v_.replace(/-/g,"+").replace(/_/g,"/"))}function _(v_){for(var A_=new Uint8Array(v_.length),k_=0;k_<v_.length;k_++)A_[k_]=v_.charCodeAt(k_);return A_}function $(v_){return v_ instanceof ArrayBuffer&&(v_=new Uint8Array(v_)),String.fromCharCode.apply(String,v_)}function _e(v_){var A_={name:(v_.name||v_||"").toUpperCase().replace("V","v")};switch(A_.name){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":break;case"AES-CBC":case"AES-GCM":case"AES-KW":v_.length&&(A_.length=v_.length);break;case"HMAC":v_.hash&&(A_.hash=_e(v_.hash)),v_.length&&(A_.length=v_.length);break;case"RSAES-PKCS1-v1_5":v_.publicExponent&&(A_.publicExponent=new Uint8Array(v_.publicExponent)),v_.modulusLength&&(A_.modulusLength=v_.modulusLength);break;case"RSASSA-PKCS1-v1_5":case"RSA-OAEP":v_.hash&&(A_.hash=_e(v_.hash)),v_.publicExponent&&(A_.publicExponent=new Uint8Array(v_.publicExponent)),v_.modulusLength&&(A_.modulusLength=v_.modulusLength);break;default:throw new SyntaxError("Bad algorithm name")}return A_}function _n(v_){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[v_.name][(v_.hash||{}).name||v_.length||""]}function _r(v_){(v_ instanceof ArrayBuffer||v_ instanceof Uint8Array)&&(v_=JSON.parse(decodeURIComponent(escape($(v_)))));var A_={kty:v_.kty,alg:v_.alg,ext:v_.ext||v_.extractable};switch(A_.kty){case"oct":A_.k=v_.k;case"RSA":"n e d p q dp dq qi oth".split(" ").forEach(function(k_){k_ in v_&&(A_[k_]=v_[k_])});break;default:throw new TypeError("Unsupported key type")}return A_}function _s(v_){return v_=_r(v_),b_&&(v_.extractable=v_.ext,delete v_.ext),_(unescape(encodeURIComponent(JSON.stringify(v_)))).buffer}function na(v_){var A_=ba(v_),k_=!1;switch(2<A_.length&&(k_=!0,A_.shift()),v_={ext:!0},A_[0][0]){case"1.2.840.113549.1.1.1":var P_="n e d p q dp dq qi".split(" ");for(A_=ba(A_[1]),k_&&A_.shift(),k_=0;k_<A_.length;k_++)A_[k_][0]||(A_[k_]=A_[k_].subarray(1)),v_[P_[k_]]=s($(A_[k_]));v_.kty="RSA";break;default:throw new TypeError("Unsupported key type")}return v_}function ba(v_,A_){if(v_ instanceof ArrayBuffer&&(v_=new Uint8Array(v_)),A_||(A_={pos:0,end:v_.length}),2>A_.end-A_.pos||A_.end>v_.length)throw new RangeError("Malformed DER");var k_=v_[A_.pos++],P_=v_[A_.pos++];if(128<=P_){if(P_&=127,A_.end-A_.pos<P_)throw new RangeError("Malformed DER");for(var T_=0;P_--;)T_<<=8,T_|=v_[A_.pos++];P_=T_}if(A_.end-A_.pos<P_)throw new RangeError("Malformed DER");switch(k_){case 2:k_=v_.subarray(A_.pos,A_.pos+=P_);break;case 3:if(v_[A_.pos++])throw Error("Unsupported bit string");P_--;case 4:k_=new Uint8Array(v_.subarray(A_.pos,A_.pos+=P_)).buffer;break;case 5:k_=null;break;case 6:if(!((v_=btoa($(v_.subarray(A_.pos,A_.pos+=P_))))in y_))throw Error("Unsupported OBJECT ID "+v_);k_=y_[v_];break;case 48:for(k_=[],P_=A_.pos+P_;A_.pos<P_;)k_.push(ba(v_,A_));break;default:throw Error("Unsupported DER tag 0x"+k_.toString(16))}return k_}function _p(v_,A_){A_||(A_=[]);var k_=A_.length+2;if(A_.push(0,0),v_ instanceof Uint8Array)for(var P_=2,T_=v_.length,R_=0;R_<T_;R_++)A_.push(v_[R_]);else if(v_ instanceof ArrayBuffer)for(P_=4,T_=v_.byteLength,v_=new Uint8Array(v_),R_=0;R_<T_;R_++)A_.push(v_[R_]);else if(v_===null)P_=5,T_=0;else if(typeof v_=="string"&&v_ in N_)for(P_=6,T_=(v_=_(atob(N_[v_]))).length,R_=0;R_<T_;R_++)A_.push(v_[R_]);else if(v_ instanceof Array){for(R_=0;R_<v_.length;R_++)_p(v_[R_],A_);P_=48,T_=A_.length-k_}else{if(!(qa(v_)==="object"&&v_.tag===3&&v_.value instanceof ArrayBuffer))throw Error("Unsupported DER value "+v_);for(P_=3,T_=(v_=new Uint8Array(v_.value)).byteLength,A_.push(0),R_=0;R_<T_;R_++)A_.push(v_[R_]);T_++}if(128<=T_){for(R_=T_,T_=4,A_.splice(k_,0,R_>>24&255,R_>>16&255,R_>>8&255,255&R_);1<T_&&!(R_>>24);)R_<<=8,T_--;4>T_&&A_.splice(k_,4-T_),T_|=128}return A_.splice(k_-2,2,P_,T_),A_}function _f(v_,A_,k_,P_){Object.defineProperties(this,{_key:{value:v_},type:{value:v_.type,enumerable:!0},extractable:{value:k_===void 0?v_.extractable:k_,enumerable:!0},algorithm:{value:A_===void 0?v_.algorithm:A_,enumerable:!0},usages:{value:P_===void 0?v_.usages:P_,enumerable:!0}})}function _E(v_){return v_==="verify"||v_==="encrypt"||v_==="wrapKey"}function _v(v_){return v_==="sign"||v_==="decrypt"||v_==="unwrapKey"}if(typeof Promise!="function")throw"Promise support required";var n_=o.crypto||o.msCrypto;if(n_){var e_=n_.subtle||n_.webkitSubtle;if(e_){var t_=o.Crypto||n_.constructor||Object,o_=o.SubtleCrypto||e_.constructor||Object;o.CryptoKey||o.Key;var m_=-1<o.navigator.userAgent.indexOf("Edge/"),b_=!!o.msCrypto&&!m_,w_=!n_.subtle&&!!n_.webkitSubtle;if(b_||w_){var y_={KoZIhvcNAQEB:"1.2.840.113549.1.1.1"},N_={"1.2.840.113549.1.1.1":"KoZIhvcNAQEB"};if(["generateKey","importKey","unwrapKey"].forEach(function(v_){var A_=e_[v_];e_[v_]=function(k_,P_,T_){var R_=[].slice.call(arguments);switch(v_){case"generateKey":var I_=_e(k_),U_=P_,D_=T_;break;case"importKey":I_=_e(T_),U_=R_[3],D_=R_[4],k_==="jwk"&&((P_=_r(P_)).alg||(P_.alg=_n(I_)),P_.key_ops||(P_.key_ops=P_.kty!=="oct"?"d"in P_?D_.filter(_v):D_.filter(_E):D_.slice()),R_[1]=_s(P_));break;case"unwrapKey":I_=R_[4],U_=R_[5],D_=R_[6],R_[2]=T_._key}if(v_==="generateKey"&&I_.name==="HMAC"&&I_.hash)return I_.length=I_.length||{"SHA-1":512,"SHA-256":512,"SHA-384":1024,"SHA-512":1024}[I_.hash.name],e_.importKey("raw",n_.getRandomValues(new Uint8Array(I_.length+7>>3)),I_,U_,D_);if(w_&&v_==="generateKey"&&I_.name==="RSASSA-PKCS1-v1_5"&&(!I_.modulusLength||2048<=I_.modulusLength))return(k_=_e(k_)).name="RSAES-PKCS1-v1_5",delete k_.hash,e_.generateKey(k_,!0,["encrypt","decrypt"]).then(function(a_){return Promise.all([e_.exportKey("jwk",a_.publicKey),e_.exportKey("jwk",a_.privateKey)])}).then(function(a_){return a_[0].alg=a_[1].alg=_n(I_),a_[0].key_ops=D_.filter(_E),a_[1].key_ops=D_.filter(_v),Promise.all([e_.importKey("jwk",a_[0],I_,!0,a_[0].key_ops),e_.importKey("jwk",a_[1],I_,U_,a_[1].key_ops)])}).then(function(a_){return{publicKey:a_[0],privateKey:a_[1]}});if((w_||b_&&(I_.hash||{}).name==="SHA-1")&&v_==="importKey"&&k_==="jwk"&&I_.name==="HMAC"&&P_.kty==="oct")return e_.importKey("raw",_(a(P_.k)),T_,R_[3],R_[4]);if(w_&&v_==="importKey"&&(k_==="spki"||k_==="pkcs8"))return e_.importKey("jwk",na(P_),T_,R_[3],R_[4]);if(b_&&v_==="unwrapKey")return e_.decrypt(R_[3],T_,P_).then(function(a_){return e_.importKey(k_,a_,R_[4],R_[5],R_[6])});try{var n0=A_.apply(e_,R_)}catch(a_){return Promise.reject(a_)}return b_&&(n0=new Promise(function(a_,s_){n0.onabort=n0.onerror=function(S_){s_(S_)},n0.oncomplete=function(S_){a_(S_.target.result)}})),n0=n0.then(function(a_){return I_.name!=="HMAC"||I_.length||(I_.length=8*a_.algorithm.length),I_.name.search("RSA")==0&&(I_.modulusLength||(I_.modulusLength=(a_.publicKey||a_).algorithm.modulusLength),I_.publicExponent||(I_.publicExponent=(a_.publicKey||a_).algorithm.publicExponent)),a_.publicKey&&a_.privateKey?{publicKey:new _f(a_.publicKey,I_,U_,D_.filter(_E)),privateKey:new _f(a_.privateKey,I_,U_,D_.filter(_v))}:new _f(a_,I_,U_,D_)})}}),["exportKey","wrapKey"].forEach(function(v_){var A_=e_[v_];e_[v_]=function(k_,P_,T_){var R_=[].slice.call(arguments);switch(v_){case"exportKey":R_[1]=P_._key;break;case"wrapKey":R_[1]=P_._key,R_[2]=T_._key}if((w_||b_&&(P_.algorithm.hash||{}).name==="SHA-1")&&v_==="exportKey"&&k_==="jwk"&&P_.algorithm.name==="HMAC"&&(R_[0]="raw"),!w_||v_!=="exportKey"||k_!=="spki"&&k_!=="pkcs8"||(R_[0]="jwk"),b_&&v_==="wrapKey")return e_.exportKey(k_,P_).then(function(U_){return k_==="jwk"&&(U_=_(unescape(encodeURIComponent(JSON.stringify(_r(U_)))))),e_.encrypt(R_[3],T_,U_)});try{var I_=A_.apply(e_,R_)}catch(U_){return Promise.reject(U_)}return b_&&(I_=new Promise(function(U_,D_){I_.onabort=I_.onerror=function(n0){D_(n0)},I_.oncomplete=function(n0){U_(n0.target.result)}})),v_==="exportKey"&&k_==="jwk"&&(I_=I_.then(function(U_){return(w_||b_&&(P_.algorithm.hash||{}).name==="SHA-1")&&P_.algorithm.name==="HMAC"?{kty:"oct",alg:_n(P_.algorithm),key_ops:P_.usages.slice(),ext:!0,k:s($(U_))}:((U_=_r(U_)).alg||(U_.alg=_n(P_.algorithm)),U_.key_ops||(U_.key_ops=P_.type==="public"?P_.usages.filter(_E):P_.type==="private"?P_.usages.filter(_v):P_.usages.slice()),U_)})),!w_||v_!=="exportKey"||k_!=="spki"&&k_!=="pkcs8"||(I_=I_.then(function(U_){var D_=[["",null]],n0=!1;switch((U_=_r(U_)).kty){case"RSA":for(var a_="n e d p q dp dq qi".split(" "),s_=[],S_=0;S_<a_.length&&a_[S_]in U_;S_++){var V_=s_[S_]=_(a(U_[a_[S_]]));128&V_[0]&&(s_[S_]=new Uint8Array(V_.length+1),s_[S_].set(V_,1))}2<s_.length&&(n0=!0,s_.unshift(new Uint8Array([0]))),D_[0][0]="1.2.840.113549.1.1.1";break;default:throw new TypeError("Unsupported key type")}return D_.push(new Uint8Array(_p(s_)).buffer),n0?D_.unshift(new Uint8Array([0])):D_[1]={tag:3,value:D_[1]},new Uint8Array(_p(D_)).buffer})),I_}}),["encrypt","decrypt","sign","verify"].forEach(function(v_){var A_=e_[v_];e_[v_]=function(k_,P_,T_,R_){if(b_&&(!T_.byteLength||R_&&!R_.byteLength))throw Error("Empty input is not allowed");var I_=[].slice.call(arguments),U_=_e(k_);if(!b_||v_!=="sign"&&v_!=="verify"||k_!=="RSASSA-PKCS1-v1_5"&&k_!=="HMAC"||(I_[0]={name:k_}),b_&&P_.algorithm.hash&&(I_[0].hash=I_[0].hash||P_.algorithm.hash),b_&&v_==="decrypt"&&U_.name==="AES-GCM"){var D_=k_.tagLength>>3;I_[2]=(T_.buffer||T_).slice(0,T_.byteLength-D_),k_.tag=(T_.buffer||T_).slice(T_.byteLength-D_)}b_&&U_.name==="AES-GCM"&&I_[0].tagLength===void 0&&(I_[0].tagLength=128),I_[1]=P_._key;try{var n0=A_.apply(e_,I_)}catch(a_){return Promise.reject(a_)}return b_&&(n0=new Promise(function(a_,s_){n0.onabort=n0.onerror=function(S_){s_(S_)},n0.oncomplete=function(S_){if(S_=S_.target.result,v_==="encrypt"&&S_ instanceof AesGcmEncryptResult){var V_=S_.ciphertext,W_=S_.tag;(S_=new Uint8Array(V_.byteLength+W_.byteLength)).set(new Uint8Array(V_),0),S_.set(new Uint8Array(W_),V_.byteLength),S_=S_.buffer}a_(S_)}})),n0}}),b_){var _y=e_.digest;e_.digest=function(v_,A_){if(!A_.byteLength)throw Error("Empty input is not allowed");try{var k_=_y.call(e_,v_,A_)}catch(P_){return Promise.reject(P_)}return k_=new Promise(function(P_,T_){k_.onabort=k_.onerror=function(R_){T_(R_)},k_.oncomplete=function(R_){P_(R_.target.result)}})},o.crypto=Object.create(n_,{getRandomValues:{value:function(v_){return n_.getRandomValues(v_)}},subtle:{value:e_}}),o.CryptoKey=_f}w_&&(n_.subtle=e_,o.Crypto=t_,o.SubtleCrypto=o_,o.CryptoKey=_f)}}}})}),function(e){e.console||(e.console={}),e=e.console;for(var o,s=function(){},a=["memory"],_="assert clear count debug dir dirxml error exception group groupCollapsed groupEnd info log markTimeline profile profiles profileEnd show table time timeEnd timeline timelineEnd timeStamp trace warn".split(" ");o=a.pop();)e[o]||(e[o]={});for(;o=_.pop();)e[o]||(e[o]=s)}(typeof window>"u"?Ya:window),ea({target:"Object",stat:!0},{setPrototypeOf:tb});var uy=la(function(){uc(1)});ea({target:"Object",stat:!0,forced:uy,sham:!Oo},{getPrototypeOf:function(e){return uc(pb(e))}});var iq=[].slice,zk={},vy=Function.bind||function(e){var o=Wb(this),s=iq.call(arguments,1),a=function(){var _=s.concat(iq.call(arguments));if(this instanceof a){var $=_.length;if(!($ in zk)){for(var _e=[],_n=0;_n<$;_n++)_e[_n]="a["+_n+"]";zk[$]=Function("C,a","return new C("+_e.join(",")+")")}_=zk[$](o,_)}else _=o.apply(e,_);return _};return xa(o.prototype)&&(a.prototype=o.prototype),a},Ak=Pc("Reflect","construct"),jq=la(function(){function e(){}return!(Ak(function(){},[],e)instanceof e)}),kq=!la(function(){Ak(function(){})}),lq=jq||kq;ea({target:"Reflect",stat:!0,forced:lq,sham:lq},{construct:function(e,o){Wb(e),Ia(o);var s=3>arguments.length?e:Wb(arguments[2]);if(kq&&!jq)return Ak(e,o,s);if(e==s){switch(o.length){case 0:return new e;case 1:return new e(o[0]);case 2:return new e(o[0],o[1]);case 3:return new e(o[0],o[1],o[2]);case 4:return new e(o[0],o[1],o[2],o[3])}return(s=[null]).push.apply(s,o),new(vy.apply(e,s))}s=s.prototype,s=jc(xa(s)?s:Object.prototype);var a=Function.apply.call(e,s,o);return xa(a)?a:s}}),ea({target:"Reflect",stat:!0},{get:Am});var mq=dc.f,wy=la(function(){mq(1)});ea({target:"Object",stat:!0,forced:!wa||wy,sham:!wa},{getOwnPropertyDescriptor:function(e,o){return mq(Mb(e),o)}});var nq=de.f,xy={}.toString,oq=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Bk=function(e){if(oq&&xy.call(e)=="[object Window]")try{var o=nq(e)}catch{o=oq.slice()}else o=nq(Mb(e));return o},pq={f:Fa},yy=qb.f,$h=function(e){var o=R.Symbol||(R.Symbol={});ka(o,e)||yy(o,e,{value:pq.f(e)})},Nb=xh("hidden"),qq=Fa("toPrimitive"),zy=cb.set,rq=cb.getterFor("Symbol"),kc=Object.prototype,Ob=R.Symbol,yg=Pc("JSON","stringify"),sq=dc.f,Jd=qb.f,tq=Bk,Ay=eg,jd=Ad("symbols"),zg=Ad("op-symbols"),Ck=Ad("string-to-symbol-registry"),Dk=Ad("symbol-to-string-registry"),By=Ad("wks"),Ek=R.QObject,Fk=!Ek||!Ek.prototype||!Ek.prototype.findChild,Gk=wa&&la(function(){return jc(Jd({},"a",{get:function(){return Jd(this,"a",{value:7}).a}})).a!=7})?function(e,o,s){var a=sq(kc,o);a&&delete kc[o],Jd(e,o,s),a&&e!==kc&&Jd(kc,o,a)}:Jd,Hk=function(e,o){var s=jd[e]=jc(Ob.prototype);return zy(s,{type:"Symbol",tag:e,description:o}),wa||(s.description=o),s},Ik=zo?function(e){return typeof e=="symbol"}:function(e){return Object(e)instanceof Ob},ai=function(e,o,s){return e===kc&&ai(zg,o,s),Ia(e),o=Oc(o,!0),Ia(s),ka(jd,o)?(s.enumerable?(ka(e,Nb)&&e[Nb][o]&&(e[Nb][o]=!1),s=jc(s,{enumerable:Nc(0,!1)})):(ka(e,Nb)||Jd(e,Nb,Nc(1,{})),e[Nb][o]=!0),Gk(e,o,s)):Jd(e,o,s)},uq=function(e,o){Ia(e);var s=Mb(o);return o=ed(s).concat(Jk(s)),fe(o,function(a){wa&&!Kk.call(s,a)||ai(e,a,s[a])}),e},Kk=function(e){e=Oc(e,!0);var o=Ay.call(this,e);return!(this===kc&&ka(jd,e)&&!ka(zg,e))&&(!(o||!ka(this,e)||!ka(jd,e)||ka(this,Nb)&&this[Nb][e])||o)},vq=function(e,o){if(e=Mb(e),o=Oc(o,!0),e!==kc||!ka(jd,o)||ka(zg,o)){var s=sq(e,o);return!s||!ka(jd,o)||ka(e,Nb)&&e[Nb][o]||(s.enumerable=!0),s}},wq=function(e){e=tq(Mb(e));var o=[];return fe(e,function(s){ka(jd,s)||ka(bf,s)||o.push(s)}),o},Jk=function(e){var o=e===kc;e=tq(o?zg:Mb(e));var s=[];return fe(e,function(a){!ka(jd,a)||o&&!ka(kc,a)||s.push(jd[a])}),s};if(Sc||(Ob=function(){if(this instanceof Ob)throw TypeError("Symbol is not a constructor");var e=arguments.length&&arguments[0]!==void 0?String(arguments[0]):void 0,o=af(e),s=function(a){this===kc&&s.call(zg,a),ka(this,Nb)&&ka(this[Nb],o)&&(this[Nb][o]=!1),Gk(this,o,Nc(1,a))};return wa&&Fk&&Gk(kc,o,{configurable:!0,set:s}),Hk(o,e)},Za(Ob.prototype,"toString",function(){return rq(this).tag}),Za(Ob,"withoutSetter",function(e){return Hk(af(e),e)}),eg=Kk,qb.f=ai,dc.f=vq,de.f=Bk=wq,gg.f=Jk,pq.f=function(e){return Hk(Fa(e),e)},wa&&(Jd(Ob.prototype,"description",{configurable:!0,get:function(){return rq(this).description}}),Za(kc,"propertyIsEnumerable",Kk,{unsafe:!0}))),ea({global:!0,wrap:!0,forced:!Sc,sham:!Sc},{Symbol:Ob}),fe(ed(By),function(e){$h(e)}),ea({target:"Symbol",stat:!0,forced:!Sc},{for:function(e){if(e=String(e),ka(Ck,e))return Ck[e];var o=Ob(e);return Ck[e]=o,Dk[o]=e,o},keyFor:function(e){if(!Ik(e))throw TypeError(e+" is not a symbol");if(ka(Dk,e))return Dk[e]},useSetter:function(){Fk=!0},useSimple:function(){Fk=!1}}),ea({target:"Object",stat:!0,forced:!Sc,sham:!wa},{create:function(e,o){return o===void 0?jc(e):uq(jc(e),o)},defineProperty:ai,defineProperties:uq,getOwnPropertyDescriptor:vq}),ea({target:"Object",stat:!0,forced:!Sc},{getOwnPropertyNames:wq,getOwnPropertySymbols:Jk}),ea({target:"Object",stat:!0,forced:la(function(){gg.f(1)})},{getOwnPropertySymbols:function(e){return gg.f(pb(e))}}),yg){var Cy=!Sc||la(function(){var e=Ob();return yg([e])!="[null]"||yg({a:e})!="{}"||yg(Object(e))!="{}"});ea({target:"JSON",stat:!0,forced:Cy},{stringify:function(e,o,s){for(var a,_=[e],$=1;arguments.length>$;)_.push(arguments[$++]);if(a=o,(xa(o)||e!==void 0)&&!Ik(e))return Ed(o)||(o=function(_e,_n){if(typeof a=="function"&&(_n=a.call(this,_e,_n)),!Ik(_n))return _n}),_[1]=o,yg.apply(null,_)}})}Ob.prototype[qq]||kb(Ob.prototype,qq,Ob.prototype.valueOf),zc(Ob,"Symbol"),bf[Nb]=!0;var Dy=qb.f,kd=R.Symbol;if(wa&&typeof kd=="function"&&(!("description"in kd.prototype)||kd().description!==void 0)){var xq={},Ag=function(){var e=1>arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),o=this instanceof Ag?new kd(e):e===void 0?kd():kd(e);return e===""&&(xq[o]=!0),o};to(Ag,kd);var Lk=Ag.prototype=kd.prototype;Lk.constructor=Ag;var Ey=Lk.toString,Fy=String(kd("test"))=="Symbol(test)",Gy=/^Symbol\((.*)\)[^)]+$/;Dy(Lk,"description",{configurable:!0,get:function(){var e=xa(this)?this.valueOf():this,o=Ey.call(e);return ka(xq,e)?"":(e=Fy?o.slice(7,-1):o.replace(Gy,"$1"))===""?void 0:e}}),ea({global:!0,forced:!0},{Symbol:Ag})}$h("toStringTag"),zc(R.JSON,"JSON",!0),zc(Math,"Math",!0),function(){function e(ba,_p){if(!(ba instanceof _p))throw new TypeError("Cannot call a class as a function")}function o(ba,_p){for(var _f=0;_f<_p.length;_f++){var _E=_p[_f];_E.enumerable=_E.enumerable||!1,_E.configurable=!0,"value"in _E&&(_E.writable=!0),Object.defineProperty(ba,_E.key,_E)}}function s(ba,_p,_f){return _p&&o(ba.prototype,_p),_f&&o(ba,_f),ba}function a(ba){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(_p){return _p.__proto__||Object.getPrototypeOf(_p)})(ba)}function _(ba,_p){return(_=Object.setPrototypeOf||function(_f,_E){return _f.__proto__=_E,_f})(ba,_p)}function $(ba){if(ba===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ba}function _e(ba){var _p=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var _f=a(ba);if(_p){var _E=a(this).constructor;_f=Reflect.construct(_f,arguments,_E)}else _f=_f.apply(this,arguments);return _f=!_f||qa(_f)!=="object"&&typeof _f!="function"?$(this):_f}}function _n(ba,_p,_f){return(_n=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(_E,_v,n_){for(;!Object.prototype.hasOwnProperty.call(_E,_v)&&(_E=a(_E))!==null;);if(_E)return(_v=Object.getOwnPropertyDescriptor(_E,_v)).get?_v.get.call(n_):_v.value})(ba,_p,_f||ba)}var _r=function(){function ba(){e(this,ba),Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}return s(ba,[{key:"addEventListener",value:function(_p,_f,_E){_p in this.listeners||(this.listeners[_p]=[]),this.listeners[_p].push({callback:_f,options:_E})}},{key:"removeEventListener",value:function(_p,_f){if(_p in this.listeners){for(var _E=0,_v=(_p=this.listeners[_p]).length;_E<_v;_E++)if(_p[_E].callback===_f){_p.splice(_E,1);break}}}},{key:"dispatchEvent",value:function(_p){if(_p.type in this.listeners){for(var _f=this.listeners[_p.type].slice(),_E=0,_v=_f.length;_E<_v;_E++){var n_=_f[_E];try{n_.callback.call(this,_p)}catch(e_){Promise.resolve().then(function(){throw e_})}n_.options&&n_.options.once&&this.removeEventListener(_p.type,n_.callback)}return!_p.defaultPrevented}}}]),ba}(),_s=function(ba){function _p(){e(this,_p);var _E=_f.call(this);return _E.listeners||_r.call($(_E)),Object.defineProperty($(_E),"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty($(_E),"onabort",{value:null,writable:!0,configurable:!0}),_E}(function(_E,_v){if(typeof _v!="function"&&_v!==null)throw new TypeError("Super expression must either be null or a function");_E.prototype=Object.create(_v&&_v.prototype,{constructor:{value:_E,writable:!0,configurable:!0}}),_v&&_(_E,_v)})(_p,ba);var _f=_e(_p);return s(_p,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(_E){_E.type==="abort"&&(this.aborted=!0,typeof this.onabort=="function"&&this.onabort.call(this,_E)),_n(a(_p.prototype),"dispatchEvent",this).call(this,_E)}}]),_p}(_r),na=function(){function ba(){e(this,ba),Object.defineProperty(this,"signal",{value:new _s,writable:!0,configurable:!0})}return s(ba,[{key:"abort",value:function(){try{var _p=new Event("abort")}catch{typeof document<"u"?document.createEvent?(_p=document.createEvent("Event")).initEvent("abort",!1,!1):(_p=document.createEventObject()).type="abort":_p={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(_p)}},{key:"toString",value:function(){return"[object AbortController]"}}]),ba}();typeof Symbol<"u"&&Symbol.toStringTag&&(na.prototype[Symbol.toStringTag]="AbortController",_s.prototype[Symbol.toStringTag]="AbortSignal"),function(ba){if(ba.__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL){console.log("__FORCE_INSTALL_ABORTCONTROLLER_POLYFILL=true is set, will force install polyfill");var _p=!0}else _p=typeof ba.Request=="function"&&!ba.Request.prototype.hasOwnProperty("signal")||!ba.AbortController;_p&&(ba.AbortController=na,ba.AbortSignal=_s)}(typeof self<"u"?self:Ya)}();var Hy=Math.floor,Iy=Math.log,Jy=Math.LOG2E;ea({target:"Math",stat:!0},{clz32:function(e){return(e>>>=0)?31-Hy(Iy(e+.5)*Jy):32}});var Ky=Math.log,Ly=Math.LN2,cu=Math.clz32||function(e){return 31-Ky(e>>>0)/Ly|0},Ud=String.fromCharCode,yq={}.toString,Mk=window.Uint8Array,Nk=Mk||Array,My=yq.call((window.ArrayBuffer||Nk).prototype),Ok;Bm.prototype.decode=function(e){if(e=e&&e.buffer||e,yq.call(e)!==My)throw Error("Failed to execute 'decode' on 'TextDecoder': The provided value is not of type '(ArrayBuffer or ArrayBufferView)'");for(var o="",s=0,a=0|(e=Mk?new Nk(e):e).length;s<a;s=s+32768|0)o+=Ud.apply(0,e[Mk?"slice":"subarray"](s,s+32768|0));return o.replace(/[\xc0-\xff][\x80-\xbf]*/g,bu)},window.TextDecoder||(window.TextDecoder=Bm),Cm.prototype.encode=function(e){for(var o=0|(e=e===void 0?"":(""+e).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,du)).length,s=new Nk(o),a=0;a<o;a=a+1|0)s[a]=e.charCodeAt(a);return s},window.TextEncoder||(window.TextEncoder=Cm),function(e){var o,s,a,_,$,_e,_n,_r,_s,na,ba,_p;(s=o||(o={})).LOGIN="LOGIN",s.LOGIN_SUCCESS="LOGIN_SUCCESS",s.LOGIN_FAILURE="LOGIN_FAILURE",s.LOGIN_TIMEOUT="LOGIN_TIMEOUT",s.INTERRUPTED="INTERRUPTED",s.LOGOUT="LOGOUT",s.BANNED_BY_SERVER="BANNED_BY_SERVER",s.REMOTE_LOGIN="REMOTE_LOGIN",s.TOKEN_EXPIRED="TOKEN_EXPIRED",e.ConnectionChangeReason=o,function(_f){_f.DISCONNECTED="DISCONNECTED",_f.CONNECTING="CONNECTING",_f.CONNECTED="CONNECTED",_f.RECONNECTING="RECONNECTING",_f.ABORTED="ABORTED"}(a||(a={})),e.ConnectionState=a,function(_f){_f.IDLE="IDLE",_f.SENT_TO_REMOTE="SENT_TO_REMOTE",_f.RECEIVED_BY_REMOTE="RECEIVED_BY_REMOTE",_f.ACCEPTED_BY_REMOTE="ACCEPTED_BY_REMOTE",_f.REFUSED_BY_REMOTE="REFUSED_BY_REMOTE",_f.CANCELED="CANCELED",_f.FAILURE="FAILURE"}(_||(_={})),e.LocalInvitationState=_,function(_f){_f.INVITATION_RECEIVED="INVITATION_RECEIVED",_f.ACCEPT_SENT_TO_LOCAL="ACCEPT_SENT_TO_LOCAL",_f.REFUSED="REFUSED",_f.ACCEPTED="ACCEPTED",_f.CANCELED="CANCELED",_f.FAILURE="FAILURE"}($||($={})),e.RemoteInvitationState=$,function(_f){_f.UNKNOWN="UNKNOWN",_f.PEER_NO_RESPONSE="PEER_NO_RESPONSE",_f.INVITATION_EXPIRE="INVITATION_EXPIRE",_f.PEER_OFFLINE="PEER_OFFLINE",_f.NOT_LOGGEDIN="NOT_LOGGEDIN"}(_e||(_e={})),e.LocalInvitationFailureReason=_e,function(_f){_f.UNKNOWN="UNKNOWN",_f.PEER_OFFLINE="PEER_OFFLINE",_f.ACCEPT_FAILURE="ACCEPT_FAILURE",_f.INVITATION_EXPIRE="INVITATION_EXPIRE"}(_n||(_n={})),e.RemoteInvitationFailureReason=_n,function(_f){_f.ONLINE="ONLINE",_f.UNREACHABLE="UNREACHABLE",_f.OFFLINE="OFFLINE"}(_r||(_r={})),e.PeerOnlineState=_r,(_s||(_s={})).ONLINE_STATUS="ONLINE_STATUS",e.PeerSubscriptionOption=_s,function(_f){_f.TEXT="TEXT",_f.RAW="RAW"}(na||(na={})),e.MessageType=na,function(_f){_f.CN="CN",_f.NA="NA",_f.EU="EU",_f.AS="AS",_f.JP="JP",_f.IN="IN",_f.GLOB="GLOB",_f.OC="OC",_f.SA="SA",_f.AF="AF",_f.OVS="OVS"}(ba||(ba={})),e.LegacyAreaCode=ba,function(_f){_f.GLOBAL="GLOBAL",_f.INDIA="INDIA",_f.JAPAN="JAPAN",_f.ASIA="ASIA",_f.EUROPE="EUROPE",_f.CHINA="CHINA",_f.NORTH_AMERICA="NORTH_AMERICA"}(_p||(_p={})),e.AreaCode=_p}(Ok||(Ok={}));var ta=Ok;ea({target:"Array",proto:!0},{includes:function(e){return qo(this,e,1<arguments.length?arguments[1]:void 0)}}),ng("includes");var Pk=function(e){if(Lj(e))throw TypeError("The method doesn't accept regular expressions");return e},Ny=Fa("match"),Qk=function(e){var o=/./;try{"/./"[e](o)}catch{try{return o[Ny]=!1,"/./"[e](o)}catch{}}return!1};ea({target:"String",proto:!0,forced:!Qk("includes")},{includes:function(e){return!!~String(Eb(this)).indexOf(Pk(e),1<arguments.length?arguments[1]:void 0)}});var Ec={RECONNECTING_AP_INTERVAL:2500,RECONNECTING_AP_NUM:2,DISABLE_MESSAGE_COMPRESSION:!1,LOG_UPLOAD_INTERVAL:3e3,LOG_HANDLER:void 0,ENABLE_EDGE_AUTO_FALLBACK:!0};$h("iterator"),$h("asyncIterator");var Rk=ff("forEach")?[].forEach:function(e){return fe(this,e,1<arguments.length?arguments[1]:void 0)},zq;for(zq in wk){var Aq=R[zq],bi=Aq&&Aq.prototype;if(bi&&bi.forEach!==Rk)try{kb(bi,"forEach",Rk)}catch{bi.forEach=Rk}}var Oy=[].reverse,Bq=[1,2];ea({target:"Array",proto:!0,forced:String(Bq)===String(Bq.reverse())},{reverse:function(){return Ed(this)&&(this.length=this.length),Oy.call(this)}});var N=xb(function(e){e=function(o){function s(T_,R_,I_){return Object.defineProperty(T_,R_,{value:I_,enumerable:!0,configurable:!0,writable:!0}),T_[R_]}function a(T_,R_,I_,U_){return R_=Object.create((R_&&R_.prototype instanceof $?R_:$).prototype),U_=new _f(U_||[]),R_._invoke=function(D_,n0,a_){var s_=y_;return function(S_,V_){if(s_===_y)throw Error("Generator is already running");if(s_===v_){if(S_==="throw")throw V_;return _v()}for(a_.method=S_,a_.arg=V_;;){if((S_=a_.delegate)&&(S_=na(S_,a_))){if(S_===A_)continue;return S_}if(a_.method==="next")a_.sent=a_._sent=a_.arg;else if(a_.method==="throw"){if(s_===y_)throw s_=v_,a_.arg;a_.dispatchException(a_.arg)}else a_.method==="return"&&a_.abrupt("return",a_.arg);if(s_=_y,(S_=_(D_,n0,a_)).type==="normal"){if(s_=a_.done?v_:N_,S_.arg===A_)continue;return{value:S_.arg,done:a_.done}}S_.type==="throw"&&(s_=v_,a_.method="throw",a_.arg=S_.arg)}}}(T_,I_,U_),R_}function _(T_,R_,I_){try{return{type:"normal",arg:T_.call(R_,I_)}}catch(U_){return{type:"throw",arg:U_}}}function $(){}function _e(){}function _n(){}function _r(T_){["next","throw","return"].forEach(function(R_){s(T_,R_,function(I_){return this._invoke(R_,I_)})})}function _s(T_,R_){function I_(D_,n0,a_,s_){if((D_=_(T_[D_],T_,n0)).type!=="throw"){var S_=D_.arg;return(D_=S_.value)&&qa(D_)==="object"&&t_.call(D_,"__await")?R_.resolve(D_.__await).then(function(V_){I_("next",V_,a_,s_)},function(V_){I_("throw",V_,a_,s_)}):R_.resolve(D_).then(function(V_){S_.value=V_,a_(S_)},function(V_){return I_("throw",V_,a_,s_)})}s_(D_.arg)}var U_;this._invoke=function(D_,n0){function a_(){return new R_(function(s_,S_){I_(D_,n0,s_,S_)})}return U_=U_?U_.then(a_,a_):a_()}}function na(T_,R_){var I_=T_.iterator[R_.method];if(I_===n_){if(R_.delegate=null,R_.method==="throw"){if(T_.iterator.return&&(R_.method="return",R_.arg=n_,na(T_,R_),R_.method==="throw"))return A_;R_.method="throw",R_.arg=new TypeError("The iterator does not provide a 'throw' method")}return A_}return(I_=_(I_,T_.iterator,R_.arg)).type==="throw"?(R_.method="throw",R_.arg=I_.arg,R_.delegate=null,A_):(I_=I_.arg)?I_.done?(R_[T_.resultName]=I_.value,R_.next=T_.nextLoc,R_.method!=="return"&&(R_.method="next",R_.arg=n_),R_.delegate=null,A_):I_:(R_.method="throw",R_.arg=new TypeError("iterator result is not an object"),R_.delegate=null,A_)}function ba(T_){var R_={tryLoc:T_[0]};1 in T_&&(R_.catchLoc=T_[1]),2 in T_&&(R_.finallyLoc=T_[2],R_.afterLoc=T_[3]),this.tryEntries.push(R_)}function _p(T_){var R_=T_.completion||{};R_.type="normal",delete R_.arg,T_.completion=R_}function _f(T_){this.tryEntries=[{tryLoc:"root"}],T_.forEach(ba,this),this.reset(!0)}function _E(T_){if(T_){var R_=T_[m_];if(R_)return R_.call(T_);if(typeof T_.next=="function")return T_;if(!isNaN(T_.length)){var I_=-1;return(R_=function U_(){for(;++I_<T_.length;)if(t_.call(T_,I_))return U_.value=T_[I_],U_.done=!1,U_;return U_.value=n_,U_.done=!0,U_}).next=R_}}return{next:_v}}function _v(){return{value:n_,done:!0}}var n_,e_=Object.prototype,t_=e_.hasOwnProperty,o_=typeof Symbol=="function"?Symbol:{},m_=o_.iterator||"@@iterator",b_=o_.asyncIterator||"@@asyncIterator",w_=o_.toStringTag||"@@toStringTag";try{s({},"")}catch{s=function(R_,I_,U_){return R_[I_]=U_}}o.wrap=a;var y_="suspendedStart",N_="suspendedYield",_y="executing",v_="completed",A_={};s(o_={},m_,function(){return this});var k_=Object.getPrototypeOf;(k_=k_&&k_(k_(_E([]))))&&k_!==e_&&t_.call(k_,m_)&&(o_=k_);var P_=_n.prototype=$.prototype=Object.create(o_);return _e.prototype=_n,s(P_,"constructor",_n),s(_n,"constructor",_e),_e.displayName=s(_n,w_,"GeneratorFunction"),o.isGeneratorFunction=function(T_){return!!(T_=typeof T_=="function"&&T_.constructor)&&(T_===_e||(T_.displayName||T_.name)==="GeneratorFunction")},o.mark=function(T_){return Object.setPrototypeOf?Object.setPrototypeOf(T_,_n):(T_.__proto__=_n,s(T_,w_,"GeneratorFunction")),T_.prototype=Object.create(P_),T_},o.awrap=function(T_){return{__await:T_}},_r(_s.prototype),s(_s.prototype,b_,function(){return this}),o.AsyncIterator=_s,o.async=function(T_,R_,I_,U_,D_){D_===void 0&&(D_=Promise);var n0=new _s(a(T_,R_,I_,U_),D_);return o.isGeneratorFunction(R_)?n0:n0.next().then(function(a_){return a_.done?a_.value:n0.next()})},_r(P_),s(P_,w_,"Generator"),s(P_,m_,function(){return this}),s(P_,"toString",function(){return"[object Generator]"}),o.keys=function(T_){var R_,I_=[];for(R_ in T_)I_.push(R_);return I_.reverse(),function U_(){for(;I_.length;){var D_=I_.pop();if(D_ in T_)return U_.value=D_,U_.done=!1,U_}return U_.done=!0,U_}},o.values=_E,_f.prototype={constructor:_f,reset:function(T_){if(this.next=this.prev=0,this.sent=this._sent=n_,this.done=!1,this.delegate=null,this.method="next",this.arg=n_,this.tryEntries.forEach(_p),!T_)for(var R_ in this)R_.charAt(0)==="t"&&t_.call(this,R_)&&!isNaN(+R_.slice(1))&&(this[R_]=n_)},stop:function(){this.done=!0;var T_=this.tryEntries[0].completion;if(T_.type==="throw")throw T_.arg;return this.rval},dispatchException:function(T_){function R_(S_,V_){return n0.type="throw",n0.arg=T_,I_.next=S_,V_&&(I_.method="next",I_.arg=n_),!!V_}if(this.done)throw T_;for(var I_=this,U_=this.tryEntries.length-1;0<=U_;--U_){var D_=this.tryEntries[U_],n0=D_.completion;if(D_.tryLoc==="root")return R_("end");if(D_.tryLoc<=this.prev){var a_=t_.call(D_,"catchLoc"),s_=t_.call(D_,"finallyLoc");if(a_&&s_){if(this.prev<D_.catchLoc)return R_(D_.catchLoc,!0);if(this.prev<D_.finallyLoc)return R_(D_.finallyLoc)}else if(a_){if(this.prev<D_.catchLoc)return R_(D_.catchLoc,!0)}else{if(!s_)throw Error("try statement without catch or finally");if(this.prev<D_.finallyLoc)return R_(D_.finallyLoc)}}}},abrupt:function(T_,R_){for(var I_=this.tryEntries.length-1;0<=I_;--I_){var U_=this.tryEntries[I_];if(U_.tryLoc<=this.prev&&t_.call(U_,"finallyLoc")&&this.prev<U_.finallyLoc){var D_=U_;break}}return D_&&(T_==="break"||T_==="continue")&&D_.tryLoc<=R_&&R_<=D_.finallyLoc&&(D_=null),(I_=D_?D_.completion:{}).type=T_,I_.arg=R_,D_?(this.method="next",this.next=D_.finallyLoc,A_):this.complete(I_)},complete:function(T_,R_){if(T_.type==="throw")throw T_.arg;return T_.type==="break"||T_.type==="continue"?this.next=T_.arg:T_.type==="return"?(this.rval=this.arg=T_.arg,this.method="return",this.next="end"):T_.type==="normal"&&R_&&(this.next=R_),A_},finish:function(T_){for(var R_=this.tryEntries.length-1;0<=R_;--R_){var I_=this.tryEntries[R_];if(I_.finallyLoc===T_)return this.complete(I_.completion,I_.afterLoc),_p(I_),A_}},catch:function(T_){for(var R_=this.tryEntries.length-1;0<=R_;--R_){var I_=this.tryEntries[R_];if(I_.tryLoc===T_){if((T_=I_.completion).type==="throw"){var U_=T_.arg;_p(I_)}return U_}}throw Error("illegal catch attempt")},delegateYield:function(T_,R_,I_){return this.delegate={iterator:_E(T_),resultName:R_,nextLoc:I_},this.method==="next"&&(this.arg=n_),A_}},o}(e.exports);try{regeneratorRuntime=e}catch{(typeof globalThis>"u"?"undefined":qa(globalThis))==="object"?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}}),Cq=!la(function(){return Object.isExtensible(Object.preventExtensions({}))}),Sk=xb(function(e){var o=qb.f,s=af("meta"),a=0,_=Object.isExtensible||function(){return!0},$=function(_n){o(_n,s,{value:{objectID:"O"+ ++a,weakData:{}}})},_e=e.exports={REQUIRED:!1,fastKey:function(_n,_r){if(!xa(_n))return typeof _n=="symbol"?_n:(typeof _n=="string"?"S":"P")+_n;if(!ka(_n,s)){if(!_(_n))return"F";if(!_r)return"E";$(_n)}return _n[s].objectID},getWeakData:function(_n,_r){if(!ka(_n,s)){if(!_(_n))return!0;if(!_r)return!1;$(_n)}return _n[s].weakData},onFreeze:function(_n){return Cq&&_e.REQUIRED&&_(_n)&&!ka(_n,s)&&$(_n),_n}};bf[s]=!0}),Dq=function(e,o,s){var a=e.indexOf("Map")!==-1,_=e.indexOf("Weak")!==-1,$=a?"set":"add",_e=R[e],_n=_e&&_e.prototype,_r=_e,_s={},na=function(n_){var e_=_n[n_];Za(_n,n_,n_=="add"?function(t_){return e_.call(this,t_===0?0:t_),this}:n_=="delete"?function(t_){return!(_&&!xa(t_))&&e_.call(this,t_===0?0:t_)}:n_=="get"?function(t_){return _&&!xa(t_)?void 0:e_.call(this,t_===0?0:t_)}:n_=="has"?function(t_){return!(_&&!xa(t_))&&e_.call(this,t_===0?0:t_)}:function(t_,o_){return e_.call(this,t_===0?0:t_,o_),this})};if(Qc(e,typeof _e!="function"||!(_||_n.forEach&&!la(function(){new _e().entries().next()}))))_r=s.getConstructor(o,e,a,$),Sk.REQUIRED=!0;else if(Qc(e,!0)){var ba=new _r,_p=ba[$](_?{}:-0,1)!=ba,_f=la(function(){ba.has(1)}),_E=Eh(function(n_){new _e(n_)}),_v=!_&&la(function(){for(var n_=new _e,e_=5;e_--;)n_[$](e_,e_);return!n_.has(-0)});_E||((_r=o(function(n_,e_){return Ac(n_,_r,e),n_=Wh(new _e,n_,_r),e_!=null&&Jh(e_,n_[$],{that:n_,AS_ENTRIES:a}),n_})).prototype=_n,_n.constructor=_r),(_f||_v)&&(na("delete"),na("has"),a&&na("get")),(_v||_p)&&na($),_&&_n.clear&&delete _n.clear}return _s[e]=_r,ea({global:!0,forced:_r!=_e},_s),zc(_r,e),_||s.setStrong(_r,e,a),_r},Py=qb.f,Eq=Sk.fastKey,Fq=cb.set,Tk=cb.getterFor,Gq={getConstructor:function(e,o,s,a){var _=e(function(_r,_s){Ac(_r,_,o),Fq(_r,{type:o,index:jc(null),first:void 0,last:void 0,size:0}),wa||(_r.size=0),_s!=null&&Jh(_s,_r[a],{that:_r,AS_ENTRIES:s})}),$=Tk(o),_e=function(_r,_s,na){var ba,_p=$(_r),_f=_n(_r,_s);return _f?_f.value=na:(_p.last=_f={index:ba=Eq(_s,!0),key:_s,value:na,previous:_s=_p.last,next:void 0,removed:!1},_p.first||(_p.first=_f),_s&&(_s.next=_f),wa?_p.size++:_r.size++,ba!=="F"&&(_p.index[ba]=_f)),_r},_n=function(_r,_s){_r=$(_r);var na=Eq(_s);if(na!=="F")return _r.index[na];for(_r=_r.first;_r;_r=_r.next)if(_r.key==_s)return _r};return kf(_.prototype,{clear:function(){for(var _r=$(this),_s=_r.index,na=_r.first;na;)na.removed=!0,na.previous&&(na.previous=na.previous.next=void 0),delete _s[na.index],na=na.next;_r.first=_r.last=void 0,wa?_r.size=0:this.size=0},delete:function(_r){var _s=$(this);if(_r=_n(this,_r)){var na=_r.next,ba=_r.previous;delete _s.index[_r.index],_r.removed=!0,ba&&(ba.next=na),na&&(na.previous=ba),_s.first==_r&&(_s.first=na),_s.last==_r&&(_s.last=ba),wa?_s.size--:this.size--}return!!_r},forEach:function(_r){for(var _s,na=$(this),ba=Dd(_r,1<arguments.length?arguments[1]:void 0,3);_s=_s?_s.next:na.first;)for(ba(_s.value,_s.key,this);_s&&_s.removed;)_s=_s.previous},has:function(_r){return!!_n(this,_r)}}),kf(_.prototype,s?{get:function(_r){return(_r=_n(this,_r))&&_r.value},set:function(_r,_s){return _e(this,_r===0?0:_r,_s)}}:{add:function(_r){return _e(this,_r=_r===0?0:_r,_r)}}),wa&&Py(_.prototype,"size",{get:function(){return $(this).size}}),_},setStrong:function(e,o,s){var a=o+" Iterator",_=Tk(o),$=Tk(a);Wj(e,o,function(_e,_n){Fq(this,{type:a,target:_e,state:_(_e),kind:_n,last:void 0})},function(){for(var _e=$(this),_n=_e.kind,_r=_e.last;_r&&_r.removed;)_r=_r.previous;return _e.target&&(_e.last=_r=_r?_r.next:_e.state.first)?_n=="keys"?{value:_r.key,done:!1}:_n=="values"?{value:_r.value,done:!1}:{value:[_r.key,_r.value],done:!1}:(_e.target=void 0,{value:void 0,done:!0})},s?"entries":"values",!s,!0),og(o)}};Dq("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Gq);var Uk=Pc("Reflect","apply"),Qy=Function.apply,Ry=!la(function(){Uk(function(){})});ea({target:"Reflect",stat:!0,forced:Ry},{apply:function(e,o,s){return Wb(e),Ia(s),Uk?Uk(e,o,s):Qy.call(e,o,s)}}),ea({target:"Reflect",stat:!0},{ownKeys:so});var Hq=Fa("isConcatSpreadable"),Sy=51<=Cd||!la(function(){var e=[];return e[Hq]=!1,e.concat()[0]!==e}),Ty=kg("concat");ea({target:"Array",proto:!0,forced:!Sy||!Ty},{concat:function(e){var o,s=pb(this),a=Dh(s,0),_=0,$=-1;for(o=arguments.length;$<o;$++){var _e=$===-1?s:arguments[$],_n=_e;if(xa(_n)){var _r=_n[Hq];_n=_r!==void 0?!!_r:Ed(_n)}else _n=!1;if(_n){if(9007199254740991<_+(_r=Ma(_e.length)))throw TypeError("Maximum allowed index exceeded");for(_n=0;_n<_r;_n++,_++)_n in _e&&hf(a,_,_e[_n])}else{if(9007199254740991<=_)throw TypeError("Maximum allowed index exceeded");hf(a,_++,_e)}}return a.length=_,a}});var Uy=Bk,Vy=la(function(){return!Object.getOwnPropertyNames(1)});ea({target:"Object",stat:!0,forced:Vy},{getOwnPropertyNames:Uy});var Wy=de.f,Xy=dc.f,Yy=qb.f,Kd=R.Number,ci=Kd.prototype,Zy=xc(jc(ci))=="Number",Iq=function(e){var o,s=Oc(e,!1);if(typeof s=="string"&&2<s.length){if((e=(s=Oj(s)).charCodeAt(0))===43||e===45){if((e=s.charCodeAt(2))===88||e===120)return NaN}else if(e===48){switch(s.charCodeAt(1)){case 66:case 98:e=2;var a=49;break;case 79:case 111:e=8,a=55;break;default:return+s}var _=(s=s.slice(2)).length;for(o=0;o<_;o++){var $=s.charCodeAt(o);if(48>$||$>a)return NaN}return parseInt(s,e)}}return+s};if(Qc("Number",!Kd(" 0o1")||!Kd("0b1")||Kd("+0x1"))){for(var le=function(e){var o=1>arguments.length?0:e,s=this;return s instanceof le&&(Zy?la(function(){ci.valueOf.call(s)}):xc(s)!="Number")?Wh(new Kd(Iq(o)),s,le):Iq(o)},Jq=wa?Wy(Kd):"MAX_VALUE MIN_VALUE NaN NEGATIVE_INFINITY POSITIVE_INFINITY EPSILON isFinite isInteger isNaN isSafeInteger MAX_SAFE_INTEGER MIN_SAFE_INTEGER parseFloat parseInt isInteger fromString range".split(" "),Vk=0,di;Jq.length>Vk;Vk++)ka(Kd,di=Jq[Vk])&&!ka(le,di)&&Yy(le,di,Xy(Kd,di));le.prototype=ci,ci.constructor=le,Za(R,"Number",le)}var sf=(typeof Reflect>"u"?"undefined":qa(Reflect))==="object"?Reflect:null,Kq=sf&&typeof sf.apply=="function"?sf.apply:function(e,o,s){return Function.prototype.apply.call(e,o,s)},$y=sf&&typeof sf.ownKeys=="function"?sf.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)},Lq=Number.isNaN||function(e){return e!=e};Ba.EventEmitter=Ba,Ba.prototype._events=void 0,Ba.prototype._eventsCount=0,Ba.prototype._maxListeners=void 0;var Mq=10;Object.defineProperty(Ba,"defaultMaxListeners",{enumerable:!0,get:function(){return Mq},set:function(e){if(typeof e!="number"||0>e||Lq(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Mq=e}}),Ba.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ba.prototype.setMaxListeners=function(e){if(typeof e!="number"||0>e||Lq(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},Ba.prototype.getMaxListeners=function(){return this._maxListeners===void 0?Ba.defaultMaxListeners:this._maxListeners},Ba.prototype.emit=function(e){for(var o=[],s=1;s<arguments.length;s++)o.push(arguments[s]);s=e==="error";var a=this._events;if(a!==void 0)s=s&&a.error===void 0;else if(!s)return!1;if(s){var _;throw 0<o.length&&(_=o[0]),_ instanceof Error?_:((o=Error("Unhandled error."+(_?" ("+_.message+")":""))).context=_,o)}if((s=a[e])===void 0)return!1;if(typeof s=="function")Kq(s,this,o);else for(a=Gm(s,_=s.length),s=0;s<_;++s)Kq(a[s],this,o);return!0},Ba.prototype.addListener=function(e,o){return Dm(this,e,o,!1)},Ba.prototype.on=Ba.prototype.addListener,Ba.prototype.prependListener=function(e,o){return Dm(this,e,o,!0)},Ba.prototype.once=function(e,o){return Wg(o),this.on(e,Em(this,e,o)),this},Ba.prototype.prependOnceListener=function(e,o){return Wg(o),this.prependListener(e,Em(this,e,o)),this},Ba.prototype.removeListener=function(e,o){var s;Wg(o);var a=this._events;if(a===void 0)return this;var _=a[e];if(_===void 0)return this;if(_===o||_.listener===o)--this._eventsCount==0?this._events=Object.create(null):(delete a[e],a.removeListener&&this.emit("removeListener",e,_.listener||o));else if(typeof _!="function"){var $=-1;for(s=_.length-1;0<=s;s--)if(_[s]===o||_[s].listener===o){var _e=_[s].listener;$=s;break}if(0>$)return this;if($===0)_.shift();else{for(;$+1<_.length;$++)_[$]=_[$+1];_.pop()}_.length===1&&(a[e]=_[0]),a.removeListener!==void 0&&this.emit("removeListener",e,_e||o)}return this},Ba.prototype.off=Ba.prototype.removeListener,Ba.prototype.removeAllListeners=function(e){var o=this._events;if(o===void 0)return this;if(o.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):o[e]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete o[e]),this;if(arguments.length===0){var s=Object.keys(o);for(o=0;o<s.length;++o){var a=s[o];a!=="removeListener"&&this.removeAllListeners(a)}return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(s=o[e])=="function")this.removeListener(e,s);else if(s!==void 0)for(o=s.length-1;0<=o;o--)this.removeListener(e,s[o]);return this},Ba.prototype.listeners=function(e){return Fm(this,e,!0)},Ba.prototype.rawListeners=function(e){return Fm(this,e,!1)},Ba.listenerCount=function(e,o){return typeof e.listenerCount=="function"?e.listenerCount(o):Hm.call(e,o)},Ba.prototype.listenerCount=Hm,Ba.prototype.eventNames=function(){return 0<this._eventsCount?$y(this._events):[]},Ba.once=function(e,o){return new Promise(function(s,a){function _(_e){e.removeListener(o,$),a(_e)}function $(){typeof e.removeListener=="function"&&e.removeListener("error",_),s([].slice.call(arguments))}Im(e,o,$,{once:!0}),o!=="error"&&fu(e,_,{once:!0})})};var tf=Object.assign,Nq=Object.defineProperty,Bg=!tf||la(function(){if(wa&&tf({b:1},tf(Nq({},"a",{enumerable:!0,get:function(){Nq(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},o={},s=Symbol();return e[s]=7,"abcdefghijklmnopqrst".split("").forEach(function(a){o[a]=a}),tf({},e)[s]!=7||ed(tf({},o)).join("")!="abcdefghijklmnopqrst"})?function(e,o){for(var s=pb(e),a=arguments.length,_=1,$=gg.f,_e=eg;a>_;)for(var _n,_r=fg(arguments[_++]),_s=$?ed(_r).concat($(_r)):ed(_r),na=_s.length,ba=0;na>ba;)_n=_s[ba++],(!wa||_e.call(_r,_n))&&(s[_n]=_r[_n]);return s}:tf;ea({target:"Object",stat:!0,forced:Object.assign!==Bg},{assign:Bg}),Dq("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Gq);var az=Math.log,bz=Math.LN2;ea({target:"Math",stat:!0},{log2:function(e){return az(e)/bz}});var cz=qb.f,dz=de.f,ez=cb.enforce,fz=Fa("match"),Vc=R.RegExp,Wk=Vc.prototype,Cg=/a/g,Xk=/a/g,Yk=new Vc(Cg)!==Cg;if(wa&&Qc("RegExp",!Yk||Rc||la(function(){return Xk[fz]=!1,Vc(Cg)!=Cg||Vc(Xk)==Xk||Vc(Cg,"i")!="/a/i"}))){for(var ld=function(e,o){var s,a=this instanceof ld,_=Lj(e),$=o===void 0;return!a&&_&&e.constructor===ld&&$||(Yk?_&&!$&&(e=e.source):e instanceof ld&&($&&(o=Gj.call(e)),e=e.source),Rc&&(s=!!o&&-1<o.indexOf("y"))&&(o=o.replace(/y/g,"")),e=Wh(Yk?new Vc(e,o):Vc(e,o),a?this:Wk,ld),Rc&&s&&(ez(e).sticky=!0)),e},gz=function(e){e in ld||cz(ld,e,{configurable:!0,get:function(){return Vc[e]},set:function(o){Vc[e]=o}})},Oq=dz(Vc),Pq=0;Oq.length>Pq;)gz(Oq[Pq++]);Wk.constructor=ld,ld.prototype=Wk,Za(R,"RegExp",ld)}og("RegExp"),xg("Float32",function(e){return function(o,s,a){return e(this,o,s,a)}}),xg("Float64",function(e){return function(o,s,a){return e(this,o,s,a)}}),xg("Uint32",function(e){return function(o,s,a){return e(this,o,s,a)}}),xg("Uint16",function(e){return function(o,s,a){return e(this,o,s,a)}});var Zk=function(e,o){return e===o?0:e==null?o==null?0:-1:o==null?e==null?0:1:typeof e.compare=="function"?e.compare(o):typeof o.compare=="function"?-o.compare(e):e<o?-1:e>o?1:0},$k=[],Qq=$k.sort,hz=la(function(){$k.sort(void 0)}),iz=la(function(){$k.sort(null)}),jz=ff("sort");ea({target:"Array",proto:!0,forced:hz||!iz||!jz},{sort:function(e){return e===void 0?Qq.call(pb(this)):Qq.call(pb(this),Wb(e))}});var Rq=Object.getPrototypeOf({}),Dg=function(e,o){var s;return e===o||(e==null?e==o:qa(e.equiv)==="function"?e.equiv(o):o==null?e==o:qa(o.equiv)==="function"?o.equiv(e):qa(e)!=="string"&&qa(o)!=="string"&&((s=Object.getPrototypeOf(e))!=null&&s!==Rq||(s=Object.getPrototypeOf(o))!=null&&s!==Rq?qa(e)!=="function"&&e.length!==void 0&&qa(o)!=="function"&&o.length!==void 0?lz(e,o):e instanceof Set&&o instanceof Set?mz(e,o):e instanceof Map&&o instanceof Map?nz(e,o):e instanceof Date&&o instanceof Date?e.getTime()===o.getTime():e instanceof RegExp&&o instanceof RegExp?e.toString()===o.toString():e!=e&&o!=o:kz(e,o)))},lz=function(e,o){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Dg,a=e.length;if(a===o.length)for(;0<=--a&&s(e[a],o[a]););return 0>a},mz=function(e,o){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Dg;return e.size===o.size&&s(Z(e.keys()).sort(),Z(o.keys()).sort())},nz=function(e,o){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Dg;return e.size===o.size&&s(Z(e).sort(),Z(o).sort())},kz=function(e,o){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:Dg;if(Object.keys(e).length!==Object.keys(o).length)return!1;for(var a in e)if(!o.hasOwnProperty(a)||!s(e[a],o[a]))return!1;return!0},Sq=function(e){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:function(s){return s!==void 0?": "+s:""};return function(s){function a($){return va(this,a),_.call(this,e($)+o($))}Ga(a,s);var _=Ha(a);return a}(Kf(Error))},oz=Sq(function(){return"illegal argument(s)"}),ei=function(e){throw new oz(e)},al=Sq(function(){return"index out of bounds"}),Tq=1/4294967295,pz=function(){function e(){va(this,e)}return eb(e,[{key:"float",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return this.int()*Tq*o}},{key:"norm",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(this.int()*Tq-.5)*o}},{key:"minmax",value:function(o,s){return this.float()*(s-o)+o}}]),e}(),bl=Math.random,qz=new(function(e){function o(){return va(this,o),s.apply(this,arguments)}Ga(o,e);var s=Ha(o);return eb(o,[{key:"int",value:function(){return 4294967296*bl()>>>0}},{key:"float",value:function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return bl()*a}},{key:"norm",value:function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1;return 2*(bl()-.5)*a}}]),o}(pz)),Ni=Symbol(),Lm=function(){},rz=Sk.onFreeze,cl=Object.freeze,sz=la(function(){cl(1)});ea({target:"Object",stat:!0,forced:sz,sham:!Cq},{freeze:function(e){return cl&&xa(e)?cl(rz(e)):e}});var tz=ff("reduce"),uz=!fd&&79<Cd&&83>Cd;ea({target:"Array",proto:!0,forced:!tz||uz},{reduce:function(e){return $p(this,e,arguments.length,1<arguments.length?arguments[1]:void 0)}});var Km=function(e){return e!=null&&typeof e.xform=="function"?e.xform():e},Xg=function(){function e(o){va(this,e),this.value=o}return eb(e,[{key:"deref",value:function(){return this.value}}]),e}(),Oi=function(e){return e instanceof Xg?e.deref():e},hu=function(e,o){return[e,function(s){return s},o]},vz=N.mark(function(e,o){var s,a,_,$,_e,_n;return N.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:s=Km(e)(gu()),a=s[1],_=s[2],$=0;case 4:if(!($<o.length)){_r.next=15;break}if(_e=o[$],!((_n=_([],_e))instanceof Xg)){_r.next=10;break}return _r.delegateYield(Oi(a(_n.deref())),"t0",9);case 9:return _r.abrupt("return");case 10:if(!_n.length){_r.next=12;break}return _r.delegateYield(_n,"t1",12);case 12:$++,_r.next=4;break;case 15:return _r.delegateYield(Oi(a([])),"t2",16);case 16:case"end":return _r.stop()}},vz)}),iu=N.mark(Jm),ju=function(e,o){return[e[0],e[1],o]},wz=function(){function e(o){va(this,e),this._length=0,o&&this.into(o)}return eb(e,[{key:"length",get:function(){return this._length}},{key:"copy",value:function(){return new e(this)}},{key:"empty",value:function(){return new e}},{key:"clear",value:function(){this.release()}},{key:"release",value:function(){for(var o,s=this.head;s;)o=s.next,delete s.value,delete s.prev,delete s.next,s=o;return delete this.head,delete this.tail,this._length=0,!0}},{key:"compare",value:function(o){var s=this._length;if(s<o._length)return-1;if(s>o._length)return 1;if(s===0)return 0;s=this.head,o=o.head;for(var a=0;s&&a==0;)a=Zk(s.value,o.value),s=s.next,o=o.next;return a}},{key:"equiv",value:function(o){if(!(o instanceof e||o!=null&&typeof o!="function"&&o.length!==void 0)||this._length!==o.length)return!1;if(!this._length||this===o)return!0;for(var s=this.head,a=0;a<o.length;a++){if(!Dg(s.value,o[a]))return!1;s=s.next}return!0}},{key:Symbol.iterator,value:N.mark(function o(){var s;return N.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:s=this.head;case 1:if(!s){a.next=7;break}return a.next=4,s.value;case 4:s=s.next,a.next=1;break;case 7:case"end":return a.stop()}},o,this)})},{key:"seq",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;if(!(o>=s||0>o)){o=this.nthCell(o);var a=this.nthCell(s-1);return s=function _($){return{first:function(){return $.value},next:function(){return $!==a&&$.next?_($.next):void 0}}},o?s(o):void 0}}},{key:"cycle",value:N.mark(function o(){return N.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.delegateYield(this,"t0",2);case 2:s.next=0;break;case 4:case"end":return s.stop()}},o,this)})},{key:"$reduce",value:function(o,s){for(var a=this.head;a&&!(s instanceof Xg);)s=o(s,a.value),a=a.next;return s}},{key:"drop",value:function(){var o=this.head;if(o)return(this.head=o.next)?delete this.head.prev:delete this.tail,this._length--,o.value}},{key:"cons",value:function(o){return o={value:o,next:this.head},this.head?this.head.prev=o:this.tail=o,this.head=o,this._length++,this}},{key:"insertBefore",value:function(o,s){return o||ei("cell is undefined"),s={value:s,next:o,prev:o.prev},o.prev?o.prev.next=s:this.head=s,o.prev=s,this._length++,this}},{key:"insertAfter",value:function(o,s){return o||ei("cell is undefined"),s={value:s,next:o.next,prev:o},o.next?o.next.prev=s:this.tail=s,o.next=s,this._length++,this}},{key:"insertBeforeNth",value:function(o,s){if(0>o&&(o+=this._length),0>=o)return this.cons(s);if(0>o||o>=this._length)throw new al(o);return this.insertBefore(this.nthCellUnsafe(o),s)}},{key:"insertAfterNth",value:function(o,s){if(0>o&&(o+=this._length),o>=this._length-1)return this.push(s);if(0>o||o>=this._length)throw new al(o);return this.insertAfter(this.nthCellUnsafe(o),s)}},{key:"insertSorted",value:function(o,s){s=s||Zk;for(var a=this.head;a;){if(0>=s(o,a.value))return this.insertBefore(a,o);a=a.next}return this.push(o)}},{key:"find",value:function(o){for(var s=this.head;s;){if(s.value===o)return s;s=s.next}}},{key:"findWith",value:function(o){for(var s=this.head;s;){if(o(s.value))return s;s=s.next}}},{key:"concat",value:function(){for(var o=this.copy(),s=arguments.length,a=Array(s),_=0;_<s;_++)a[_]=arguments[_];for(s=0;s<a.length;s++)o.into(a[s]);return o}},{key:"into",value:function(o){for(var s=0;s<o.length;s++)this.push(o[s])}},{key:"slice",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.length;o=0>o?o+this._length:o,s=0>s?s+this._length:s,(0>o||0>s)&&ei("invalid indices: ${from} / ${to}");for(var a=new e,_=this.nthCell(o);_&&++o<=s;)a.push(_.value),_=_.next;return a}},{key:"splice",value:function(o){var s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,a=2<arguments.length?arguments[2]:void 0;if(typeof o=="number"){if(0>o&&(o+=this._length),0>o||o>=this._length)throw new al(o);var _=this.nthCellUnsafe(o)}else _=o;var $=new e;if(0<s)for(;_&&0<s--;)this.remove(_),$.push(_.value),_=_.next;else _&&(_=_.next);if(a)if(_)for(s=0;s<a.length;s++)this.insertBefore(_,a[s]);else for(_=0;_<a.length;_++)this.push(a[_]);return $}},{key:"remove",value:function(o){return o.prev?o.prev.next=o.next:this.head=o.next,o.next?o.next.prev=o.prev:this.tail=o.prev,this._length--,this}},{key:"swap",value:function(o,s){if(o!==s){var a=o.value;o.value=s.value,s.value=a}return this}},{key:"push",value:function(o){return this.tail?(o={value:o,prev:this.tail},this.tail=this.tail.next=o,this._length++,this):this.cons(o)}},{key:"pop",value:function(){var o=this.tail;if(o)return(this.tail=o.prev)?delete this.tail.next:delete this.head,this._length--,o.value}},{key:"first",value:function(){return this.head&&this.head.value}},{key:"peek",value:function(){return this.tail&&this.tail.value}},{key:"setHead",value:function(o){return this.head?(this.head.value=o,this):this.cons(o)}},{key:"setTail",value:function(o){return this.tail?(this.tail.value=o,this):this.push(o)}},{key:"setNth",value:function(o,s){var a=this.nthCell(o);return!a&&ei("index out of bounds: ".concat(o)),a.value=s,this}},{key:"nth",value:function(o,s){return(o=this.nthCell(o))?o.value:s}},{key:"nthCell",value:function(o){if(0>o&&(o+=this._length),!(0>o||o>=this._length))return this.nthCellUnsafe(o)}},{key:"rotateLeft",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:return this.push(this.drop())}}},{key:"rotateRight",value:function(){switch(this._length){case 0:case 1:return this;case 2:return this.swap(this.head,this.tail);default:var o=this.peek();return this.pop(),this.cons(o)}}},{key:"map",value:function(o){for(var s=new e,a=this.head;a;)s.push(o(a.value)),a=a.next;return s}},{key:"filter",value:function(o){for(var s=new e,a=this.head;a;)o(a.value)&&s.push(a.value),a=a.next;return s}},{key:"reduce",value:function(o,s){for(var a=this.head;a;)s=o(s,a.value),a=a.next;return s}},{key:"shuffle",value:function(o){var s=1<arguments.length&&arguments[1]!==void 0?arguments[1]:qz;if(2>this._length)return this;for(o=o??Math.ceil(1.5*Math.log2(this._length));0<o;o--)for(var a=this.head;a;){var _=a.next;.5>s.float()?this.asHead(a):this.asTail(a),a=_}return this}},{key:"sort",value:function(){var o=0<arguments.length&&arguments[0]!==void 0?arguments[0]:Zk;if(!this._length)return this;for(var s=1;;){var a=this.head;this.tail=this.head=void 0;for(var _=0;a;){_++;for(var $=a,_e=0,_n=0;_n<s&&(_e++,$=$.next);_n++);for(_n=s;0<_e||0<_n&&$;){if(_e===0){var _r=$;$=$.next,_n--}else $&&_n!==0?0>=o(a.value,$.value)?(_r=a,a=a.next,_e--):(_r=$,$=$.next,_n--):(_r=a,a=a.next,_e--);this.tail?this.tail.next=_r:this.head=_r,_r.prev=this.tail,this.tail=_r}a=$}if(this.tail.next=void 0,1>=_)return this;s*=2}}},{key:"reverse",value:function(){for(var o=this.head,s=this.tail,a=(this._length>>>1)+(1&this._length);o&&s&&0<a;){var _=o.value;o.value=s.value,s.value=_,o=o.next,s=s.prev,a--}return this}},{key:"asHead",value:function(o){return o===this.head||(this.remove(o),this.head.prev=o,o.next=this.head,o.prev=void 0,this.head=o,this._length++),this}},{key:"asTail",value:function(o){return o===this.tail||(this.remove(o),this.tail.next=o,o.prev=this.tail,o.next=void 0,this.tail=o,this._length++),this}},{key:"toString",value:function(){for(var o=[],s=this.head;s;)o.push(String(s.value)),s=s.next;return o.join(", ")}},{key:"toJSON",value:function(){return Z(this)}},{key:"nthCellUnsafe",value:function(o){if(o<=this._length>>1)var s=this.head,a="next";else s=this.tail,a="prev",o=this._length-o-1;for(;0<o--&&s;)s=s[a];return s}}]),e}(),Wc=function(){function e(o,s){va(this,e),s=Object.assign({maxlen:1/0,maxsize:1/0,map:function(){return new Map},ksize:function(){return 0},vsize:function(){return 0}},s),this.map=s.map(),this.items=new wz,this._size=0,this.opts=s,o&&this.into(o)}return eb(e,[{key:"length",get:function(){return this.items.length}},{key:"size",get:function(){return this._size}},{key:Symbol.iterator,value:function(){return this.entries()}},{key:"entries",value:function(){return Yg(function(o){return[o.k,o]},this.items)}},{key:"keys",value:function(){return Yg(function(o){return o.k},this.items)}},{key:"values",value:function(){return Yg(function(o){return o.v},this.items)}},{key:"copy",value:function(){var o=this.empty();o.items=this.items.copy();for(var s=o.items.head;s;)o.map.set(s.value.k,s),s=s.next;return o}},{key:"empty",value:function(){return new e(null,this.opts)}},{key:"release",value:function(){this._size=0,this.map.clear();var o=this.opts.release;if(o){for(var s;s=this.items.drop();)o(s.k,s.v);return!0}return this.items.release()}},{key:"has",value:function(o){return this.map.has(o)}},{key:"get",value:function(o,s){return(o=this.map.get(o))?this.resetEntry(o):s}},{key:"set",value:function(o,s){var a=this.opts.ksize(o)+this.opts.vsize(s),_=this.map.get(o);return this._size+=Math.max(0,a-(_?_.value.s:0)),this.ensureSize()&&this.doSetEntry(_,o,s,a),s}},{key:"into",value:function(o){for(var s=0;s<o.length;s++){var a=o[s];this.set(a[0],a[1])}return this}},{key:"getSet",value:function(o,s){var a=this,_=this.map.get(o);return _?Promise.resolve(this.resetEntry(_)):s().then(function($){return a.set(o,$)})}},{key:"delete",value:function(o){return!!(o=this.map.get(o))&&(this.removeEntry(o),!0)}},{key:"resetEntry",value:function(o){return this.items.asTail(o),o.value.v}},{key:"ensureSize",value:function(){for(var o=this.opts.release,s=this.opts.maxsize,a=this.opts.maxlen;this._size>s||this.length>=a;){var _=this.items.drop();if(!_)return!1;this.map.delete(_.k),o&&o(_.k,_.v),this._size-=_.s}return!0}},{key:"removeEntry",value:function(o){var s=o.value;this.map.delete(s.k),this.items.remove(o),this.opts.release&&this.opts.release(s.k,s.v),this._size-=s.s}},{key:"doSetEntry",value:function(o,s,a,_){o?(o.value.v=a,o.value.s=_,this.items.asTail(o)):(this.items.push({k:s,v:a,s:_}),this.map.set(s,this.items.tail))}}]),e}(),xz=function(e){function o(a,_){return va(this,o),_=Object.assign({ttl:36e5},_),s.call(this,a,_)}Ga(o,e);var s=Ha(o);return eb(o,[{key:"empty",value:function(){return new o(null,this.opts)}},{key:"has",value:function(a){return this.get(a)!==void 0}},{key:"get",value:function(a,_){if(a=this.map.get(a)){if(a.value.t>=Date.now())return this.resetEntry(a);this.removeEntry(a)}return _}},{key:"set",value:function(a,_){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,_e=this.opts.ksize(a)+this.opts.vsize(_),_n=this.map.get(a);return this._size+=Math.max(0,_e-(_n?_n.value.s:0)),this.ensureSize()&&($=Date.now()+$,_n?(_n.value.v=_,_n.value.s=_e,_n.value.t=$,this.items.asTail(_n)):(this.items.push({k:a,v:_,s:_e,t:$}),this.map.set(a,this.items.tail))),_}},{key:"getSet",value:function(a,_){var $=this,_e=2<arguments.length&&arguments[2]!==void 0?arguments[2]:this.opts.ttl,_n=this.get(a);return _n?Promise.resolve(_n):_().then(function(_r){return $.set(a,_r,_e)})}},{key:"prune",value:function(){for(var a=Date.now(),_=this.items.head;_;)_.value.t<a&&this.removeEntry(_),_=_.next}},{key:"ensureSize",value:function(){for(var a=this.opts.maxsize,_=this.opts.maxlen,$=Date.now(),_e=this.items.head;_e&&(this._size>a||this.length>=_);)_e.value.t<$&&this.removeEntry(_e),_e=_e.next;return Li(Td(o.prototype),"ensureSize",this).call(this)}}]),o}(Wc),Uq=qa(Ya)=="object"&&Ya&&Ya.Object===Object&&Ya,yz=(typeof self>"u"?"undefined":qa(self))=="object"&&self&&self.Object===Object&&self,$b=Uq||yz||Function("return this")(),lc=$b.Symbol,Vq=Object.prototype,zz=Vq.hasOwnProperty,Az=Vq.toString,Eg=lc?lc.toStringTag:void 0,Bz=Object.prototype.toString,Wq=lc?lc.toStringTag:void 0,me=function(e){if(e==null)e=e===void 0?"[object Undefined]":"[object Null]";else if(Wq&&Wq in Object(e)){var o=zz.call(e,Eg),s=e[Eg];try{e[Eg]=void 0;var a=!0}catch{}var _=Az.call(e);a&&(o?e[Eg]=s:delete e[Eg]),e=_}else e=Bz.call(e);return e},Gb=function(e){var o=qa(e);return e!=null&&(o=="object"||o=="function")},jj=function(e){return!!Gb(e)&&((e=me(e))=="[object Function]"||e=="[object GeneratorFunction]"||e=="[object AsyncFunction]"||e=="[object Proxy]")},dl=$b["__core-js_shared__"],Xq=function(){var e=/[^.]+$/.exec(dl&&dl.keys&&dl.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Cz=Function.prototype.toString,ne=function(e){if(e!=null){try{return Cz.call(e)}catch{}return e+""}return""},Dz=/^\[object .+?Constructor\]$/,Ez=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),oe=function(e,o){return e=e==null?void 0:e[o],!Gb(e)||Xq&&Xq in e||!(jj(e)?Ez:Dz).test(ne(e))?void 0:e},Fg=oe(Object,"create"),Fz=Object.prototype.hasOwnProperty,Gz=Object.prototype.hasOwnProperty;Vd.prototype.clear=function(){this.__data__=Fg?Fg(null):{},this.size=0},Vd.prototype.delete=function(e){return e=this.has(e)&&delete this.__data__[e],this.size-=e?1:0,e},Vd.prototype.get=function(e){var o=this.__data__;return Fg?(e=o[e])==="__lodash_hash_undefined__"?void 0:e:Fz.call(o,e)?o[e]:void 0},Vd.prototype.has=function(e){var o=this.__data__;return Fg?o[e]!==void 0:Gz.call(o,e)},Vd.prototype.set=function(e,o){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=Fg&&o===void 0?"__lodash_hash_undefined__":o,this};var Gg=function(e,o){return e===o||e!=e&&o!=o},fi=function(e,o){for(var s=e.length;s--;)if(Gg(e[s][0],o))return s;return-1},Hz=Array.prototype.splice;Ee.prototype.clear=function(){this.__data__=[],this.size=0},Ee.prototype.delete=function(e){var o=this.__data__;return!(0>(e=fi(o,e)))&&(e==o.length-1?o.pop():Hz.call(o,e,1),--this.size,!0)},Ee.prototype.get=function(e){var o=this.__data__;return 0>(e=fi(o,e))?void 0:o[e][1]},Ee.prototype.has=function(e){return-1<fi(this.__data__,e)},Ee.prototype.set=function(e,o){var s=this.__data__,a=fi(s,e);return 0>a?(++this.size,s.push([e,o])):s[a][1]=o,this};var $g=Ee,Hg=oe($b,"Map"),gi=function(e,o){e=e.__data__;var s=qa(o);return(s=="string"||s=="number"||s=="symbol"||s=="boolean"?o!=="__proto__":o===null)?e[typeof o=="string"?"string":"hash"]:e.map};Fe.prototype.clear=function(){this.size=0,this.__data__={hash:new Vd,map:new(Hg||$g),string:new Vd}},Fe.prototype.delete=function(e){return e=gi(this,e).delete(e),this.size-=e?1:0,e},Fe.prototype.get=function(e){return gi(this,e).get(e)},Fe.prototype.has=function(e){return gi(this,e).has(e)},Fe.prototype.set=function(e,o){var s=gi(this,e),a=s.size;return s.set(e,o),this.size+=s.size==a?0:1,this};var Zg=Fe;Lf.prototype.add=Lf.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Lf.prototype.has=function(e){return this.__data__.has(e)};var Yq=function(e,o,s,a){var _=e.length;for(s+=a?1:-1;a?s--:++s<_;)if(o(e[s],s,e))return s;return-1},Iz=function(e){return e!=e},Jz=function(e,o){var s;if(s=!(e==null||!e.length)){if(o==o)e:{s=-1;for(var a=e.length;++s<a;)if(e[s]===o){e=s;break e}e=-1}else e=Yq(e,Iz,0);s=-1<e}return s},Kz=function(e,o,s){for(var a=-1,_=e==null?0:e.length;++a<_;)if(s(o,e[a]))return!0;return!1},Lz=function(e,o){return e.has(o)},uf=oe($b,"Set"),Mz=function(){},el=function(e){var o=-1,s=Array(e.size);return e.forEach(function(a){s[++o]=a}),s},Nz=1/0,Oz=uf&&1/el(new uf([,-0]))[1]==Nz?function(e){return new uf(e)}:Mz,fl=function(e,o,s){var a=-1,_=Jz,$=e.length,_e=!0,_n=[],_r=_n;if(s)_e=!1,_=Kz;else if(200<=$){if(_=o?null:Oz(e))return el(_);_e=!1,_=Lz,_r=new Lf}else _r=o?[]:_n;e:for(;++a<$;){var _s=e[a],na=o?o(_s):_s;if(_s=s||_s!==0?_s:0,_e&&na==na){for(var ba=_r.length;ba--;)if(_r[ba]===na)continue e;o&&_r.push(na),_n.push(_s)}else _(_r,na,s)||(_r!==_n&&_r.push(na),_n.push(_s))}return _n},Zq=function(e){for(var o=-1,s=e==null?0:e.length,a={};++o<s;){var _=e[o];a[_[0]]=_[1]}return a},Je=function(e,o){for(var s=-1,a=e==null?0:e.length,_=Array(a);++s<a;)_[s]=o(e[s],s,e);return _};Ge.prototype.clear=function(){this.__data__=new $g,this.size=0},Ge.prototype.delete=function(e){var o=this.__data__;return e=o.delete(e),this.size=o.size,e},Ge.prototype.get=function(e){return this.__data__.get(e)},Ge.prototype.has=function(e){return this.__data__.has(e)},Ge.prototype.set=function(e,o){var s=this.__data__;if(s instanceof $g){var a=s.__data__;if(!Hg||199>a.length)return a.push([e,o]),this.size=++s.size,this;s=this.__data__=new Zg(a)}return s.set(e,o),this.size=s.size,this};var Ie=Ge,su=function(e,o){for(var s=-1,a=e==null?0:e.length;++s<a&&o(e[s],s,e)!==!1;);return e},hi=function(){try{var e=oe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Ig=function(e,o,s){o=="__proto__"&&hi?hi(e,o,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[o]=s},Pz=Object.prototype.hasOwnProperty,Qm=function(e,o,s){var a=e[o];Pz.call(e,o)&&Gg(a,s)&&(s!==void 0||o in e)||Ig(e,o,s)},Ue=function(e,o,s,a){var _=!s;s||(s={});for(var $=-1,_e=o.length;++$<_e;){var _n=o[$],_r=a?a(s[_n],e[_n],_n,s,e):void 0;_r===void 0&&(_r=e[_n]),_?Ig(s,_n,_r):Qm(s,_n,_r)}return s},Hc=function(e){return e!=null&&qa(e)=="object"},$q=function(e){return Hc(e)&&me(e)=="[object Arguments]"},ar=Object.prototype,Qz=ar.hasOwnProperty,Rz=ar.propertyIsEnumerable,Vf=$q(function(){return arguments}())?$q:function(e){return Hc(e)&&Qz.call(e,"callee")&&!Rz.call(e,"callee")},ub=Array.isArray,Sz=function(){return!1},Nf=xb(function(e,o){var s=(o=o&&!o.nodeType&&o)&&e&&!e.nodeType&&e;o=s&&s.exports===o?$b.Buffer:void 0,e.exports=(o?o.isBuffer:void 0)||Sz}),Tz=/^(?:0|[1-9]\d*)$/,gl=function(e,o){var s=qa(e);return!!(o=o??9007199254740991)&&(s=="number"||s!="symbol"&&Tz.test(e))&&-1<e&&e%1==0&&e<o},hl=function(e){return typeof e=="number"&&-1<e&&e%1==0&&9007199254740991>=e},Va={};Va["[object Float32Array]"]=Va["[object Float64Array]"]=Va["[object Int8Array]"]=Va["[object Int16Array]"]=Va["[object Int32Array]"]=Va["[object Uint8Array]"]=Va["[object Uint8ClampedArray]"]=Va["[object Uint16Array]"]=Va["[object Uint32Array]"]=!0,Va["[object Arguments]"]=Va["[object Array]"]=Va["[object ArrayBuffer]"]=Va["[object Boolean]"]=Va["[object DataView]"]=Va["[object Date]"]=Va["[object Error]"]=Va["[object Function]"]=Va["[object Map]"]=Va["[object Number]"]=Va["[object Object]"]=Va["[object RegExp]"]=Va["[object Set]"]=Va["[object String]"]=Va["[object WeakMap]"]=!1;var Uz=function(e){return Hc(e)&&hl(e.length)&&!!Va[me(e)]},ii=function(e){return function(o){return e(o)}},vf=xb(function(e,o){var s=o&&!o.nodeType&&o;s=(o=s&&e&&!e.nodeType&&e)&&o.exports===s&&Uq.process;e:{try{var a=o&&o.require&&o.require("util").types;if(a){var _=a;break e}_=s&&s.binding&&s.binding("util");break e}catch{}_=void 0}e.exports=_}),br=vf&&vf.isTypedArray,Ui=br?ii(br):Uz,Vz=Object.prototype.hasOwnProperty,cr=function(e,o){var s=ub(e),a=!s&&Vf(e),_=!s&&!a&&Nf(e),$=!s&&!a&&!_&&Ui(e);if(s=s||a||_||$){a=e.length;for(var _e=String,_n=-1,_r=Array(a);++_n<a;)_r[_n]=_e(_n);a=_r}else a=[];for(var _s in _e=a.length,e)!o&&!Vz.call(e,_s)||s&&(_s=="length"||_&&(_s=="offset"||_s=="parent")||$&&(_s=="buffer"||_s=="byteLength"||_s=="byteOffset")||gl(_s,_e))||a.push(_s);return a},Wz=Object.prototype,il=function(e){var o=e&&e.constructor;return e===(typeof o=="function"&&o.prototype||Wz)},dr=function(e,o){return function(s){return e(o(s))}},Xz=dr(Object.keys,Object),Yz=Object.prototype.hasOwnProperty,ae=function(e){return e!=null&&hl(e.length)&&!jj(e)},Wd=function(e){if(ae(e))e=cr(e);else if(il(e)){var o,s=[];for(o in Object(e))Yz.call(e,o)&&o!="constructor"&&s.push(o);e=s}else e=Xz(e);return e},ou=function(e,o){return e&&Ue(o,Wd(o),e)},Zz=Object.prototype.hasOwnProperty,Of=function(e){if(ae(e))e=cr(e,!0);else if(Gb(e)){var o=il(e),s=[];for(a in e)(a!="constructor"||!o&&Zz.call(e,a))&&s.push(a);e=s}else{var a=[];if(e!=null)for(o in Object(e))a.push(o);e=a}return e},mu=function(e,o){return e&&Ue(o,Of(o),e)},Nm=xb(function(e,o){var s=(o=o&&!o.nodeType&&o)&&e&&!e.nodeType&&e,a=(o=s&&s.exports===o?$b.Buffer:void 0)?o.allocUnsafe:void 0;e.exports=function(_,$){return $?_.slice():($=_.length,$=a?a($):new _.constructor($),_.copy($),$)}}),Pi=function(e,o){var s=-1,a=e.length;for(o||(o=Array(a));++s<a;)o[s]=e[s];return o},$z=function(e,o){for(var s=-1,a=e==null?0:e.length,_=0,$=[];++s<a;){var _e=e[s];o(_e,s,e)&&($[_++]=_e)}return $},er=function(){return[]},aA=Object.prototype.propertyIsEnumerable,fr=Object.getOwnPropertySymbols,jl=fr?function(e){return e==null?[]:(e=Object(e),$z(fr(e),function(o){return aA.call(e,o)}))}:er,nu=function(e,o){return Ue(e,jl(e),o)},Ti=function(e,o){for(var s=-1,a=o.length,_=e.length;++s<a;)e[_+s]=o[s];return e},kl=dr(Object.getPrototypeOf,Object),gr=Object.getOwnPropertySymbols?function(e){for(var o=[];e;)Ti(o,jl(e)),e=kl(e);return o}:er,lu=function(e,o){return Ue(e,gr(e),o)},hr=function(e,o,s){return o=o(e),ub(e)?o:Ti(o,s(e))},Qi=function(e){return hr(e,Wd,jl)},Pm=function(e){return hr(e,Of,gr)},ll=oe($b,"DataView"),ml=oe($b,"Promise"),nl=oe($b,"WeakMap"),bA=ne(ll),cA=ne(Hg),dA=ne(ml),eA=ne(uf),fA=ne(nl),pe=me;(ll&&pe(new ll(new ArrayBuffer(1)))!="[object DataView]"||Hg&&pe(new Hg)!="[object Map]"||ml&&pe(ml.resolve())!="[object Promise]"||uf&&pe(new uf)!="[object Set]"||nl&&pe(new nl)!="[object WeakMap]")&&(pe=function(e){var o=me(e);if(e=(e=o=="[object Object]"?e.constructor:void 0)?ne(e):"")switch(e){case bA:return"[object DataView]";case cA:return"[object Map]";case dA:return"[object Promise]";case eA:return"[object Set]";case fA:return"[object WeakMap]"}return o});var Mf=pe,gA=Object.prototype.hasOwnProperty,ku=function(e){var o=e.length,s=new e.constructor(o);return o&&typeof e[0]=="string"&&gA.call(e,"index")&&(s.index=e.index,s.input=e.input),s},ji=$b.Uint8Array,ol=function(e){var o=new e.constructor(e.byteLength);return new ji(o).set(new ji(e)),o},hA=/\w*$/,ir=lc?lc.prototype:void 0,jr=ir?ir.valueOf:void 0,Bn=function(e,o){return o=o?ol(e.buffer):e.buffer,new e.constructor(o,e.byteOffset,e.length)},pu=function(e,o,s){var a=e.constructor;switch(o){case"[object ArrayBuffer]":return ol(e);case"[object Boolean]":case"[object Date]":return new a(+e);case"[object DataView]":return o=s?ol(e.buffer):e.buffer,new e.constructor(o,e.byteOffset,e.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Bn(e,s);case"[object Map]":return new a;case"[object Number]":case"[object String]":return new a(e);case"[object RegExp]":return(o=new e.constructor(e.source,hA.exec(e))).lastIndex=e.lastIndex,o;case"[object Set]":return new a;case"[object Symbol]":return jr?Object(jr.call(e)):{}}},kr=Object.create,iA=function(){function e(){}return function(o){return Gb(o)?kr?kr(o):(e.prototype=o,o=new e,e.prototype=void 0,o):{}}}(),Om=function(e){return typeof e.constructor!="function"||il(e)?{}:iA(kl(e))},jA=function(e){return Hc(e)&&Mf(e)=="[object Map]"},lr=vf&&vf.isMap,ru=lr?ii(lr):jA,kA=function(e){return Hc(e)&&Mf(e)=="[object Set]"},mr=vf&&vf.isSet,qu=mr?ii(mr):kA,Oa={};Oa["[object Arguments]"]=Oa["[object Array]"]=Oa["[object ArrayBuffer]"]=Oa["[object DataView]"]=Oa["[object Boolean]"]=Oa["[object Date]"]=Oa["[object Float32Array]"]=Oa["[object Float64Array]"]=Oa["[object Int8Array]"]=Oa["[object Int16Array]"]=Oa["[object Int32Array]"]=Oa["[object Map]"]=Oa["[object Number]"]=Oa["[object Object]"]=Oa["[object RegExp]"]=Oa["[object Set]"]=Oa["[object String]"]=Oa["[object Symbol]"]=Oa["[object Uint8Array]"]=Oa["[object Uint8ClampedArray]"]=Oa["[object Uint16Array]"]=Oa["[object Uint32Array]"]=!0,Oa["[object Error]"]=Oa["[object Function]"]=Oa["[object WeakMap]"]=!1;var Ke=function(e){return qa(e)=="symbol"||Hc(e)&&me(e)=="[object Symbol]"},lA=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mA=/^\w*$/,pl=function(e,o){if(ub(e))return!1;var s=qa(e);return!(s!="number"&&s!="symbol"&&s!="boolean"&&e!=null&&!Ke(e))||mA.test(e)||!lA.test(e)||o!=null&&e in Object(o)};Ri.Cache=Zg;var nA=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,oA=/\\(\\)?/g,pA=function(e){var o=(e=Ri(e,function(s){return o.size===500&&o.clear(),s})).cache;return e}(function(e){var o=[];return e.charCodeAt(0)===46&&o.push(""),e.replace(nA,function(s,a,_,$){o.push(_?$.replace(oA,"$1"):a||s)}),o}),tu=1/0,nr=lc?lc.prototype:void 0,Sm=nr?nr.toString:void 0,ki=function(e,o){return ub(e)?e:pl(e,o)?[e]:pA(e==null?"":Rm(e))},qA=1/0,Jg=function(e){if(typeof e=="string"||Ke(e))return e;var o=e+"";return o=="0"&&1/e==-qA?"-0":o},li=function(e,o){for(var s=0,a=(o=ki(o,e)).length;e!=null&&s<a;)e=e[Jg(o[s++])];return s&&s==a?e:void 0},rA=function(e,o){if(!(2>(o=ki(o,e)).length)){var s=o,a=0,_=-1,$=-1,_e=s.length;for(0>a&&(a=-a>_e?0:_e+a),0>(_=_>_e?_e:_)&&(_+=_e),_e=a>_?0:_-a>>>0,a>>>=0,_=Array(_e);++$<_e;)_[$]=s[$+a];e=li(e,_)}return(s=e==null)||(s=o==null?0:o.length,s=delete e[Jg(s?o[s-1]:void 0)]),s},or=Function.prototype.toString,sA=Object.prototype.hasOwnProperty,tA=or.call(Object),Cn=function(e){return!(!Hc(e)||me(e)!="[object Object]")&&((e=kl(e))===null||typeof(e=sA.call(e,"constructor")&&e.constructor)=="function"&&e instanceof e&&or.call(e)==tA)},uA=function(e){return Cn(e)?void 0:e},pr=lc?lc.isConcatSpreadable:void 0,uu=function(e){return ub(e)||Vf(e)||!!(pr&&e&&e[pr])},vA=function(e){return e!=null&&e.length?Si(e,1):[]},wA=function(e,o,s){switch(s.length){case 0:return e.call(o);case 1:return e.call(o,s[0]);case 2:return e.call(o,s[0],s[1]);case 3:return e.call(o,s[0],s[1],s[2])}return e.apply(o,s)},qr=Math.max,rr=function(e,o,s){return o=qr(o===void 0?e.length-1:o,0),function(){for(var a=arguments,_=-1,$=qr(a.length-o,0),_e=Array($);++_<$;)_e[_]=a[o+_];for(_=-1,$=Array(o+1);++_<o;)$[_]=a[_];return $[o]=s(_e),wA(e,this,$)}},xA=function(e){return function(){return e}},mi=function(e){return e},yA=Date.now,sr=function(e){var o=0,s=0;return function(){var a=yA(),_=16-(a-s);if(s=a,0<_){if(800<=++o)return arguments[0]}else o=0;return e.apply(void 0,arguments)}}(hi?function(e,o){return hi(e,"toString",{configurable:!0,enumerable:!1,value:xA(o),writable:!0})}:mi),ql=function(e){return sr(rr(e,void 0,vA),e+"")}(function(e,o){var s={};if(e==null)return s;var a=!1;o=Je(o,function($){return $=ki($,e),a||(a=1<$.length),$}),Ue(e,Pm(e),s),a&&(s=He(s,7,uA));for(var _=o.length;_--;)rA(s,o[_]);return s}),zA=function(e,o,s,a){for(var _=-1,$=e==null?0:e.length;++_<$;){var _e=e[_];o(a,_e,s(_e),e)}return a},An=function(e,o,s){for(var a=-1,_=Object(e),$=(s=s(e)).length;$--;){var _e=s[++a];if(o(_[_e],_e,_)===!1)break}return e},tr=function(e,o){return e&&An(e,o,Wd)},rl=function(e,o){return function(s,a){if(s==null)return s;if(!ae(s))return e(s,a);for(var _=s.length,$=-1,_e=Object(s);++$<_&&a(_e[$],$,_e)!==!1;);return s}}(tr),AA=function(e,o,s,a){return rl(e,function(_,$,_e){o(a,_,s(_),_e)}),a},ur=function(e,o){for(var s=-1,a=e==null?0:e.length;++s<a;)if(o(e[s],s,e))return!0;return!1},Tm=function(e,o,s,a,_,$){var _e=1&s,_n=e.length,_r=o.length;if(_n!=_r&&!(_e&&_r>_n))return!1;_r=$.get(e);var _s=$.get(o);if(_r&&_s)return _r==o&&_s==e;_r=-1,_s=!0;var na=2&s?new Lf:void 0;for($.set(e,o),$.set(o,e);++_r<_n;){var ba=e[_r],_p=o[_r];if(a)var _f=_e?a(_p,ba,_r,o,e,$):a(ba,_p,_r,e,o,$);if(_f!==void 0){if(_f)continue;_s=!1;break}if(na){if(!ur(o,function(_E,_v){if(!na.has(_v)&&(ba===_E||_(ba,_E,s,a,$)))return na.push(_v)})){_s=!1;break}}else if(ba!==_p&&!_(ba,_p,s,a,$)){_s=!1;break}}return $.delete(e),$.delete(o),_s},BA=function(e){var o=-1,s=Array(e.size);return e.forEach(function(a,_){s[++o]=[_,a]}),s},vr=lc?lc.prototype:void 0,sl=vr?vr.valueOf:void 0,vu=function(e,o,s,a,_,$,_e){switch(s){case"[object DataView]":if(e.byteLength!=o.byteLength||e.byteOffset!=o.byteOffset)break;e=e.buffer,o=o.buffer;case"[object ArrayBuffer]":if(e.byteLength!=o.byteLength||!$(new ji(e),new ji(o)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return Gg(+e,+o);case"[object Error]":return e.name==o.name&&e.message==o.message;case"[object RegExp]":case"[object String]":return e==o+"";case"[object Map]":var _n=BA;case"[object Set]":if(_n||(_n=el),e.size!=o.size&&!(1&a))break;return(s=_e.get(e))?s==o:(a|=2,_e.set(e,o),o=Tm(_n(e),_n(o),a,_,$,_e),_e.delete(e),o);case"[object Symbol]":if(sl)return sl.call(e)==sl.call(o)}return!1},wu=Object.prototype.hasOwnProperty,Um=Object.prototype.hasOwnProperty,CA=function(e,o,s,a){var _=s.length,$=_,_e=!a;if(e==null)return!$;for(e=Object(e);_--;){var _n=s[_];if(_e&&_n[2]?_n[1]!==e[_n[0]]:!(_n[0]in e))return!1}for(;++_<$;){var _r=(_n=s[_])[0],_s=e[_r],na=_n[1];if(_e&&_n[2]){if(_s===void 0&&!(_r in e))return!1}else{if(_n=new Ie,a)var ba=a(_s,na,_r,e,o,_n);if(ba===void 0?!Le(na,_s,3,a,_n):!ba)return!1}}return!0},DA=function(e){for(var o=Wd(e),s=o.length;s--;){var a=o[s],_=e[a];o[s]=[a,_,_==_&&!Gb(_)]}return o},wr=function(e,o){return function(s){return s!=null&&s[e]===o&&(o!==void 0||e in Object(s))}},EA=function(e){var o=DA(e);return o.length==1&&o[0][2]?wr(o[0][0],o[0][1]):function(s){return s===e||CA(s,e,o)}},FA=function(e,o){return pl(e)&&o==o&&!Gb(o)?wr(Jg(e),o):function(s){var a=s==null?void 0:li(s,e);if((a=a===void 0?void 0:a)===void 0&&a===o){if(a=s!=null){for(var _=-1,$=(a=ki(a=e,s)).length,_e=!1;++_<$;){var _n=Jg(a[_]);if(!(_e=s!=null&&s!=null&&_n in Object(s)))break;s=s[_n]}_e||++_!=$?a=_e:a=!!($=s==null?0:s.length)&&hl($)&&gl(_n,$)&&(ub(s)||Vf(s))}_n=a}else _n=Le(o,a,3);return _n}},GA=function(e){return function(o){return o==null?void 0:o[e]}},HA=function(e){return function(o){return li(o,e)}},wf=function(e){return typeof e=="function"?e:e==null?mi:qa(e)=="object"?ub(e)?FA(e[0],e[1]):EA(e):pl(e)?GA(Jg(e)):HA(e)},tl=function(e,o){return function(s,a){var _={};return(ub(s)?zA:AA)(s,e,wf(a),_)}}(function(e,o,s){Ig(e,s,o)}),md=function(e,o){var s={};return o=wf(o),tr(e,function(a,_,$){Ig(s,_,o(a,_,$))}),s};ea({target:"String",proto:!0,forced:la(function(){var e="".sub('"');return e!==e.toLowerCase()||3<e.split('"').length})},{sub:function(){return"<sub>"+String(Eb(this))+"</sub>"}});var P=Pa,mc=null;try{mc=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}Pa.prototype.__isLong__,Object.defineProperty(Pa.prototype,"__isLong__",{value:!0}),Pa.isLong=Hb;var Wm={},Vm={};Pa.fromInt=Xd,Pa.fromNumber=ec,Pa.fromBits=Qa;var ah=Math.pow;Pa.fromString=Vi,Pa.fromValue=vc;var Me=4294967296,Xm=Me*Me,Zm=Xm/2,xr=Xd(16777216),fc=Xd(0);Pa.ZERO=fc;var Yd=Xd(0,!0);Pa.UZERO=Yd;var xf=Xd(1);Pa.ONE=xf;var yr=Xd(1,!0);Pa.UONE=yr;var ul=Xd(-1);Pa.NEG_ONE=ul;var $m=Qa(-1,2147483647,!1);Pa.MAX_VALUE=$m;var Ym=Qa(-1,-1,!0);Pa.MAX_UNSIGNED_VALUE=Ym;var Ib=Qa(0,-2147483648,!1);Pa.MIN_VALUE=Ib;var V=Pa.prototype;V.toInt=function(){return this.unsigned?this.low>>>0:this.low},V.toNumber=function(){return this.unsigned?(this.high>>>0)*Me+(this.low>>>0):this.high*Me+(this.low>>>0)},V.toString=function(e){if(2>(e=e||10)||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Ib)){var o=ec(e),s=this.div(o);return o=s.mul(o).sub(this),s.toString(e)+o.toInt().toString(e)}return"-"+this.neg().toString(e)}s=ec(ah(e,6),this.unsigned),o=this;for(var a="";;){var _=o.div(s),$=(o.sub(_.mul(s)).toInt()>>>0).toString(e);if((o=_).isZero())return $+a;for(;6>$.length;)$="0"+$;a=""+$+a}},V.getHighBits=function(){return this.high},V.getHighBitsUnsigned=function(){return this.high>>>0},V.getLowBits=function(){return this.low},V.getLowBitsUnsigned=function(){return this.low>>>0},V.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ib)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,o=31;0<o&&!(e&1<<o);o--);return this.high!=0?o+33:o+1},V.isZero=function(){return this.high===0&&this.low===0},V.eqz=V.isZero,V.isNegative=function(){return!this.unsigned&&0>this.high},V.isPositive=function(){return this.unsigned||0<=this.high},V.isOdd=function(){return(1&this.low)==1},V.isEven=function(){return(1&this.low)==0},V.equals=function(e){return Hb(e)||(e=vc(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},V.eq=V.equals,V.notEquals=function(e){return!this.eq(e)},V.neq=V.notEquals,V.ne=V.notEquals,V.lessThan=function(e){return 0>this.comp(e)},V.lt=V.lessThan,V.lessThanOrEqual=function(e){return 0>=this.comp(e)},V.lte=V.lessThanOrEqual,V.le=V.lessThanOrEqual,V.greaterThan=function(e){return 0<this.comp(e)},V.gt=V.greaterThan,V.greaterThanOrEqual=function(e){return 0<=this.comp(e)},V.gte=V.greaterThanOrEqual,V.ge=V.greaterThanOrEqual,V.compare=function(e){if(Hb(e)||(e=vc(e)),this.eq(e))return 0;var o=this.isNegative(),s=e.isNegative();return o&&!s?-1:!o&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},V.comp=V.compare,V.negate=function(){return!this.unsigned&&this.eq(Ib)?Ib:this.not().add(xf)},V.neg=V.negate,V.add=function(e){Hb(e)||(e=vc(e));var o=this.high>>>16,s=65535&this.high,a=this.low>>>16,_=e.high>>>16,$=65535&e.high,_e=e.low>>>16;return a=(_e=((e=(65535&this.low)+(65535&e.low))>>>16)+(a+_e))>>>16,Qa((65535&_e)<<16|65535&e,(o=((a+=s+$)>>>16)+(o+_)&65535)<<16|65535&a,this.unsigned)},V.subtract=function(e){return Hb(e)||(e=vc(e)),this.add(e.neg())},V.sub=V.subtract,V.multiply=function(e){if(this.isZero())return fc;if(Hb(e)||(e=vc(e)),mc){var o=mc.mul(this.low,this.high,e.low,e.high);return Qa(o,mc.get_high(),this.unsigned)}if(e.isZero())return fc;if(this.eq(Ib))return e.isOdd()?Ib:fc;if(e.eq(Ib))return this.isOdd()?Ib:fc;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(xr)&&e.lt(xr))return ec(this.toNumber()*e.toNumber(),this.unsigned);o=this.high>>>16;var s=65535&this.high,a=this.low>>>16,_=65535&this.low,$=e.high>>>16,_e=65535&e.high,_n=e.low>>>16,_r=_*(e=65535&e.low),_s=(_r>>>16)+a*e,na=_s>>>16;na+=(_s=(65535&_s)+_*_n)>>>16;var ba=(na+=s*e)>>>16;return Qa((65535&_s)<<16|65535&_r,(ba=(ba+=(na=(65535&na)+a*_n)>>>16)+((na=(65535&na)+_*_e)>>>16)+(o*e+s*_n+a*_e+_*$)&65535)<<16|65535&na,this.unsigned)},V.mul=V.multiply,V.divide=function(e){if(Hb(e)||(e=vc(e)),e.isZero())throw Error("division by zero");if(mc)return this.unsigned||this.high!==-2147483648||e.low!==-1||e.high!==-1?Qa(e=(this.unsigned?mc.div_u:mc.div_s)(this.low,this.high,e.low,e.high),mc.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Yd:fc;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Yd;if(e.gt(this.shru(1)))return yr;var o=Yd}else{if(this.eq(Ib)){if(e.eq(xf)||e.eq(ul))return Ib;if(e.eq(Ib))return xf;var s=this.shr(1).div(e).shl(1);if(s.eq(fc))return e.isNegative()?xf:ul;var a=this.sub(e.mul(s));return s.add(a.div(e))}if(e.eq(Ib))return this.unsigned?Yd:fc;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=fc}for(a=this;a.gte(e);){s=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));var _=Math.ceil(Math.log(s)/Math.LN2);_=48>=_?1:ah(2,_-48);for(var $=ec(s),_e=$.mul(e);_e.isNegative()||_e.gt(a);)_e=($=ec(s-=_,this.unsigned)).mul(e);$.isZero()&&($=xf),o=o.add($),a=a.sub(_e)}return o},V.div=V.divide,V.modulo=function(e){return Hb(e)||(e=vc(e)),mc?Qa(e=(this.unsigned?mc.rem_u:mc.rem_s)(this.low,this.high,e.low,e.high),mc.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},V.mod=V.modulo,V.rem=V.modulo,V.not=function(){return Qa(~this.low,~this.high,this.unsigned)},V.and=function(e){return Hb(e)||(e=vc(e)),Qa(this.low&e.low,this.high&e.high,this.unsigned)},V.or=function(e){return Hb(e)||(e=vc(e)),Qa(this.low|e.low,this.high|e.high,this.unsigned)},V.xor=function(e){return Hb(e)||(e=vc(e)),Qa(this.low^e.low,this.high^e.high,this.unsigned)},V.shiftLeft=function(e){return Hb(e)&&(e=e.toInt()),(e&=63)==0?this:32>e?Qa(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Qa(0,this.low<<e-32,this.unsigned)},V.shl=V.shiftLeft,V.shiftRight=function(e){return Hb(e)&&(e=e.toInt()),(e&=63)==0?this:32>e?Qa(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Qa(this.high>>e-32,0<=this.high?0:-1,this.unsigned)},V.shr=V.shiftRight,V.shiftRightUnsigned=function(e){if(Hb(e)&&(e=e.toInt()),(e&=63)===0)return this;var o=this.high;return 32>e?Qa(this.low>>>e|o<<32-e,o>>>e,this.unsigned):Qa(e===32?o:o>>>e-32,0,this.unsigned)},V.shru=V.shiftRightUnsigned,V.shr_u=V.shiftRightUnsigned,V.toSigned=function(){return this.unsigned?Qa(this.low,this.high,!1):this},V.toUnsigned=function(){return this.unsigned?this:Qa(this.low,this.high,!0)},V.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},V.toBytesLE=function(){var e=this.high,o=this.low;return[255&o,o>>>8&255,o>>>16&255,o>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},V.toBytesBE=function(){var e=this.high,o=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,o>>>24,o>>>16&255,o>>>8&255,255&o]},Pa.fromBytes=function(e,o,s){return s?Pa.fromBytesLE(e,o):Pa.fromBytesBE(e,o)},Pa.fromBytesLE=function(e,o){return new Pa(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,o)},Pa.fromBytesBE=function(e,o){return new Pa(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],o)};var Wi=function(e,o){return(Wi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var _ in a)a.hasOwnProperty(_)&&(s[_]=a[_])})(e,o)},vl=!1,gc={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e?console.warn(`DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: 
`+Error().stack):vl&&console.log("RxJS: Back to a better error behavior. Thank you. <3"),vl=e},get useDeprecatedSynchronousErrorHandling(){return vl}},ni={closed:!0,next:function(e){},error:function(e){if(gc.useDeprecatedSynchronousErrorHandling)throw e;Oe(e)},complete:function(){}},hc=Array.isArray||function(e){return e&&typeof e.length=="number"},Pf=function(){function e(o){return Error.call(this),this.message=o?o.length+` errors occurred during unsubscription:
`+o.map(function(s,a){return a+1+") "+s.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=o,this}return e.prototype=Object.create(Error.prototype),e}(),nb=function(){function e(o){this.closed=!1,this._subscriptions=this._parentOrParents=null,o&&(this._ctorUnsubscribe=!0,this._unsubscribe=o)}return e.prototype.unsubscribe=function(){if(!this.closed){var o=this._parentOrParents,s=this._ctorUnsubscribe,a=this._unsubscribe,_=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,o instanceof e)o.remove(this);else if(o!==null)for(var $=0;$<o.length;++$)o[$].remove(this);if(Ne(a)){s&&(this._unsubscribe=void 0);try{a.call(this)}catch(_n){var _e=_n instanceof Pf?an(_n.errors):[_n]}}if(hc(_)){for($=-1,o=_.length;++$<o;)if(Xi(s=_[$]))try{s.unsubscribe()}catch(_n){_e=_e||[],_n instanceof Pf?_e=_e.concat(an(_n.errors)):_e.push(_n)}}if(_e)throw new Pf(_e)}},e.prototype.add=function(o){var s=o;if(!o)return e.EMPTY;switch(qa(o)){case"function":s=new e(o);case"object":if(s===this||s.closed||typeof s.unsubscribe!="function")return s;if(this.closed)return s.unsubscribe(),s;s instanceof e||(o=s,(s=new e)._subscriptions=[o]);break;default:throw Error("unrecognized teardown "+o+" added to Subscription.")}if((o=s._parentOrParents)===null)s._parentOrParents=this;else if(o instanceof e){if(o===this)return s;s._parentOrParents=[o,this]}else{if(o.indexOf(this)!==-1)return s;o.push(this)}return(o=this._subscriptions)===null?this._subscriptions=[s]:o.push(s),s},e.prototype.remove=function(o){var s=this._subscriptions;s&&(o=s.indexOf(o))!==-1&&s.splice(o,1)},e.EMPTY=function(o){return o.closed=!0,o}(new e),e}(),oi=typeof Symbol=="function"?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),za=function(e){function o(s,a,_){var $=e.call(this)||this;switch($.syncErrorValue=null,$.syncErrorThrown=!1,$.syncErrorThrowable=!1,$.isStopped=!1,arguments.length){case 0:$.destination=ni;break;case 1:if(!s){$.destination=ni;break}if(qa(s)==="object"){s instanceof o?($.syncErrorThrowable=s.syncErrorThrowable,$.destination=s,s.add($)):($.syncErrorThrowable=!0,$.destination=new zr($,s));break}default:$.syncErrorThrowable=!0,$.destination=new zr($,s,a,_)}return $}return ha(o,e),o.prototype[oi]=function(){return this},o.create=function(s,a,_){return(s=new o(s,a,_)).syncErrorThrowable=!1,s},o.prototype.next=function(s){this.isStopped||this._next(s)},o.prototype.error=function(s){this.isStopped||(this.isStopped=!0,this._error(s))},o.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},o.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},o.prototype._next=function(s){this.destination.next(s)},o.prototype._error=function(s){this.destination.error(s),this.unsubscribe()},o.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},o.prototype._unsubscribeAndRecycle=function(){var s=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.isStopped=this.closed=!1,this._parentOrParents=s,this},o}(nb),zr=function(e){function o(s,a,_,$){var _e=e.call(this)||this;if(_e._parentSubscriber=s,s=_e,Ne(a))var _n=a;else a&&(_n=a.next,_=a.error,$=a.complete,a!==ni&&(Ne((s=Object.create(a)).unsubscribe)&&_e.add(s.unsubscribe.bind(s)),s.unsubscribe=_e.unsubscribe.bind(_e)));return _e._context=s,_e._next=_n,_e._error=_,_e._complete=$,_e}return ha(o,e),o.prototype.next=function(s){if(!this.isStopped&&this._next){var a=this._parentSubscriber;gc.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable?this.__tryOrSetError(a,this._next,s)&&this.unsubscribe():this.__tryOrUnsub(this._next,s)}},o.prototype.error=function(s){if(!this.isStopped){var a=this._parentSubscriber,_=gc.useDeprecatedSynchronousErrorHandling;if(this._error)_&&a.syncErrorThrowable?this.__tryOrSetError(a,this._error,s):this.__tryOrUnsub(this._error,s),this.unsubscribe();else if(a.syncErrorThrowable)_?(a.syncErrorValue=s,a.syncErrorThrown=!0):Oe(s),this.unsubscribe();else{if(this.unsubscribe(),_)throw s;Oe(s)}}},o.prototype.complete=function(){var s=this;if(!this.isStopped){var a=this._parentSubscriber;if(this._complete){var _=function(){return s._complete.call(s._context)};gc.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable?this.__tryOrSetError(a,_):this.__tryOrUnsub(_)}this.unsubscribe()}},o.prototype.__tryOrUnsub=function(s,a){try{s.call(this._context,a)}catch(_){if(this.unsubscribe(),gc.useDeprecatedSynchronousErrorHandling)throw _;Oe(_)}},o.prototype.__tryOrSetError=function(s,a,_){if(!gc.useDeprecatedSynchronousErrorHandling)throw Error("bad call");try{a.call(this._context,_)}catch($){return gc.useDeprecatedSynchronousErrorHandling?(s.syncErrorValue=$,s.syncErrorThrown=!0):Oe($),!0}return!1},o.prototype._unsubscribe=function(){var s=this._parentSubscriber;this._parentSubscriber=this._context=null,s.unsubscribe()},o}(za),Pe=typeof Symbol=="function"&&Symbol.observable||"@@observable",ua=function(){function e(o){this._isScalar=!1,o&&(this._subscribe=o)}return e.prototype.lift=function(o){var s=new e;return s.source=this,s.operator=o,s},e.prototype.subscribe=function(o,s,a){var _=this.operator;e:{if(o){if(o instanceof za)break e;if(o[oi]){o=o[oi]();break e}}o=o||s||a?new za(o,s,a):new za(ni)}if(_?o.add(_.call(o,this.source)):o.add(this.source||gc.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),gc.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},e.prototype._trySubscribe=function(o){try{return this._subscribe(o)}catch(s){gc.useDeprecatedSynchronousErrorHandling&&(o.syncErrorThrown=!0,o.syncErrorValue=s),Yi(o)?o.error(s):console.warn(s)}},e.prototype.forEach=function(o,s){var a=this;return new(s=cn(s))(function(_,$){var _e=a.subscribe(function(_n){try{o(_n)}catch(_r){$(_r),_e&&_e.unsubscribe()}},$,_)})},e.prototype._subscribe=function(o){var s=this.source;return s&&s.subscribe(o)},e.prototype[Pe]=function(){return this},e.prototype.pipe=function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return o.length===0?this:bn(o)(this)},e.prototype.toPromise=function(o){var s=this;return new(o=cn(o))(function(a,_){var $;s.subscribe(function(_e){return $=_e},function(_e){return _(_e)},function(){return a($)})})},e.create=function(o){return new e(o)},e}(),Ld=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),Ar=function(e){function o(s,a){var _=e.call(this)||this;return _.subject=s,_.subscriber=a,_.closed=!1,_}return ha(o,e),o.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var s=this.subject,a=s.observers;this.subject=null,!a||a.length===0||s.isStopped||s.closed||(s=a.indexOf(this.subscriber))!==-1&&a.splice(s,1)}},o}(nb),Br=function(e){function o(s){var a=e.call(this,s)||this;return a.destination=s,a}return ha(o,e),o}(za),rb=function(e){function o(){var s=e.call(this)||this;return s.observers=[],s.closed=!1,s.isStopped=!1,s.hasError=!1,s.thrownError=null,s}return ha(o,e),o.prototype[oi]=function(){return new Br(this)},o.prototype.lift=function(s){var a=new Cr(this,this);return a.operator=s,a},o.prototype.next=function(s){if(this.closed)throw new Ld;if(!this.isStopped){var a=this.observers,_=a.length;a=a.slice();for(var $=0;$<_;$++)a[$].next(s)}},o.prototype.error=function(s){if(this.closed)throw new Ld;this.hasError=!0,this.thrownError=s,this.isStopped=!0;var a=this.observers,_=a.length;a=a.slice();for(var $=0;$<_;$++)a[$].error(s);this.observers.length=0},o.prototype.complete=function(){if(this.closed)throw new Ld;this.isStopped=!0;var s=this.observers,a=s.length;s=s.slice();for(var _=0;_<a;_++)s[_].complete();this.observers.length=0},o.prototype.unsubscribe=function(){this.closed=this.isStopped=!0,this.observers=null},o.prototype._trySubscribe=function(s){if(this.closed)throw new Ld;return e.prototype._trySubscribe.call(this,s)},o.prototype._subscribe=function(s){if(this.closed)throw new Ld;return this.hasError?(s.error(this.thrownError),nb.EMPTY):this.isStopped?(s.complete(),nb.EMPTY):(this.observers.push(s),new Ar(this,s))},o.prototype.asObservable=function(){var s=new ua;return s.source=this,s},o.create=function(s,a){return new Cr(s,a)},o}(ua),Cr=function(e){function o(s,a){var _=e.call(this)||this;return _.destination=s,_.source=a,_}return ha(o,e),o.prototype.next=function(s){var a=this.destination;a&&a.next&&a.next(s)},o.prototype.error=function(s){var a=this.destination;a&&a.error&&this.destination.error(s)},o.prototype.complete=function(){var s=this.destination;s&&s.complete&&this.destination.complete()},o.prototype._subscribe=function(s){return this.source?this.source.subscribe(s):nb.EMPTY},o}(rb),xu=function(){function e(o){this.connectable=o}return e.prototype.call=function(o,s){var a=this.connectable;return a._refCount++,o=new IA(o,a),s=s.subscribe(o),o.closed||(o.connection=a.connect()),s},e}(),IA=function(e){function o(s,a){return(s=e.call(this,s)||this).connectable=a,s}return ha(o,e),o.prototype._unsubscribe=function(){var s=this.connectable;if(s){this.connectable=null;var a=s._refCount;0>=a?this.connection=null:(s._refCount=a-1,1<a?this.connection=null:(a=this.connection,s=s._connection,this.connection=null,!s||a&&s!==a||s.unsubscribe()))}else this.connection=null},o}(za),Dr=function(e){function o(s,a){var _=e.call(this)||this;return _.source=s,_.subjectFactory=a,_._refCount=0,_._isComplete=!1,_}return ha(o,e),o.prototype._subscribe=function(s){return this.getSubject().subscribe(s)},o.prototype.getSubject=function(){var s=this._subject;return s&&!s.isStopped||(this._subject=this.subjectFactory()),this._subject},o.prototype.connect=function(){var s=this._connection;return s||(this._isComplete=!1,(s=this._connection=new nb).add(this.source.subscribe(new JA(this.getSubject(),this))),s.closed&&(this._connection=null,s=nb.EMPTY)),s},o.prototype.refCount=function(){return dn()(this)},o}(ua),lv=function(){var e=Dr.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}}(),JA=function(e){function o(s,a){return(s=e.call(this,s)||this).connectable=a,s}return ha(o,e),o.prototype._error=function(s){this._unsubscribe(),e.prototype._error.call(this,s)},o.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),e.prototype._complete.call(this)},o.prototype._unsubscribe=function(){var s=this.connectable;if(s){this.connectable=null;var a=s._connection;s._refCount=0,s._subject=null,s._connection=null,a&&a.unsubscribe()}},o}(Br);(function(e){function o(s,a){return(s=e.call(this,s)||this).connectable=a,s}ha(o,e),o.prototype._unsubscribe=function(){var s=this.connectable;if(s){this.connectable=null;var a=s._refCount;0>=a?this.connection=null:(s._refCount=a-1,1<a?this.connection=null:(a=this.connection,s=s._connection,this.connection=null,!s||a&&s!==a||s.unsubscribe()))}else this.connection=null}})(za),function(e){function o(s,a,_,$,_e){return(s=e.call(this,s)||this).keySelector=a,s.elementSelector=_,s.durationSelector=$,s.subjectSelector=_e,s.groups=null,s.attemptedToUnsubscribe=!1,s.count=0,s}ha(o,e),o.prototype._next=function(s){try{var a=this.keySelector(s)}catch(_){return void this.error(_)}this._group(s,a)},o.prototype._group=function(s,a){var _=this.groups;_||(_=this.groups=new Map);var $=_.get(a);if(this.elementSelector)try{var _e=this.elementSelector(s)}catch(_n){this.error(_n)}else _e=s;if(!$&&($=this.subjectSelector?this.subjectSelector():new rb,_.set(a,$),s=new wl(a,$,this),this.destination.next(s),this.durationSelector)){s=void 0;try{s=this.durationSelector(new wl(a,$))}catch(_n){return void this.error(_n)}this.add(s.subscribe(new KA(a,$,this)))}$.closed||$.next(_e)},o.prototype._error=function(s){var a=this.groups;a&&(a.forEach(function(_,$){_.error(s)}),a.clear()),this.destination.error(s)},o.prototype._complete=function(){var s=this.groups;s&&(s.forEach(function(a,_){a.complete()}),s.clear()),this.destination.complete()},o.prototype.removeGroup=function(s){this.groups.delete(s)},o.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,this.count===0&&e.prototype.unsubscribe.call(this))}}(za);var KA=function(e){function o(s,a,_){var $=e.call(this,a)||this;return $.key=s,$.group=a,$.parent=_,$}return ha(o,e),o.prototype._next=function(s){this.complete()},o.prototype._unsubscribe=function(){var s=this.parent,a=this.key;this.key=this.parent=null,s&&s.removeGroup(a)},o}(za),wl=function(e){function o(s,a,_){var $=e.call(this)||this;return $.key=s,$.groupSubject=a,$.refCountSubscription=_,$}return ha(o,e),o.prototype._subscribe=function(s){var a=new nb,_=this.refCountSubscription,$=this.groupSubject;return _&&!_.closed&&a.add(new LA(_)),a.add($.subscribe(s)),a},o}(ua),LA=function(e){function o(s){var a=e.call(this)||this;return a.parent=s,s.count++,a}return ha(o,e),o.prototype.unsubscribe=function(){var s=this.parent;s.closed||this.closed||(e.prototype.unsubscribe.call(this),--s.count,s.count===0&&s.attemptedToUnsubscribe&&s.unsubscribe())},o}(nb),MA=function(e){function o(s){var a=e.call(this)||this;return a._value=s,a}return ha(o,e),Object.defineProperty(o.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),o.prototype._subscribe=function(s){var a=e.prototype._subscribe.call(this,s);return a&&!a.closed&&s.next(this._value),a},o.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Ld;return this._value},o.prototype.next=function(s){e.prototype.next.call(this,this._value=s)},o}(rb),Kg=function(e){function o(s,a){var _=e.call(this,s,a)||this;return _.scheduler=s,_.work=a,_.pending=!1,_}return ha(o,e),o.prototype.schedule=function(s,a){if(a===void 0&&(a=0),this.closed)return this;this.state=s,s=this.id;var _=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(_,s,a)),this.pending=!0,this.delay=a,this.id=this.id||this.requestAsyncId(_,this.id,a),this},o.prototype.requestAsyncId=function(s,a,_){return _===void 0&&(_=0),setInterval(s.flush.bind(s,this),_)},o.prototype.recycleAsyncId=function(s,a,_){if(_===void 0&&(_=0),_!==null&&this.delay===_&&this.pending===!1)return a;clearInterval(a)},o.prototype.execute=function(s,a){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(s=this._execute(s,a))?s:void(this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},o.prototype._execute=function(s,a){a=!1;var _=void 0;try{this.work(s)}catch($){a=!0,_=!!$&&$||Error($)}if(a)return this.unsubscribe(),_},o.prototype._unsubscribe=function(){var s=this.id,a=this.scheduler,_=a.actions,$=_.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,$!==-1&&_.splice($,1),s!=null&&(this.id=this.recycleAsyncId(a,s,null)),this.delay=null},o}(function(e){function o(s,a){return e.call(this)||this}return ha(o,e),o.prototype.schedule=function(s,a){return this},o}(nb)),NA=function(e){function o(s,a){var _=e.call(this,s,a)||this;return _.scheduler=s,_.work=a,_}return ha(o,e),o.prototype.schedule=function(s,a){return a===void 0&&(a=0),0<a?e.prototype.schedule.call(this,s,a):(this.delay=a,this.state=s,this.scheduler.flush(this),this)},o.prototype.execute=function(s,a){return 0<a||this.closed?e.prototype.execute.call(this,s,a):this._execute(s,a)},o.prototype.requestAsyncId=function(s,a,_){return _===void 0&&(_=0),_!==null&&0<_||_===null&&0<this.delay?e.prototype.requestAsyncId.call(this,s,a,_):s.flush(this)},o}(Kg),xl=function(){function e(o,s){s===void 0&&(s=e.now),this.SchedulerAction=o,this.now=s}return e.prototype.schedule=function(o,s,a){return s===void 0&&(s=0),new this.SchedulerAction(this,o).schedule(a,s)},e.now=function(){return Date.now()},e}(),Lg=function(e){function o(s,a){a===void 0&&(a=xl.now);var _=e.call(this,s,function(){return o.delegate&&o.delegate!==_?o.delegate.now():a()})||this;return _.actions=[],_.active=!1,_.scheduled=void 0,_}return ha(o,e),o.prototype.schedule=function(s,a,_){return a===void 0&&(a=0),o.delegate&&o.delegate!==this?o.delegate.schedule(s,a,_):e.prototype.schedule.call(this,s,a,_)},o.prototype.flush=function(s){var a=this.actions;if(this.active)a.push(s);else{var _;this.active=!0;do if(_=s.execute(s.state,s.delay))break;while(s=a.shift());if(this.active=!1,_){for(;s=a.shift();)s.unsubscribe();throw _}}},o}(xl),Mg=new(function(e){function o(){return e!==null&&e.apply(this,arguments)||this}return ha(o,e),o}(Lg))(NA),Sb=new ua(function(e){return e.complete()}),en=function(e){return function(o){for(var s=0,a=e.length;s<a&&!o.closed;s++)o.next(e[s]);o.complete()}},yl;(function(e){e.NEXT="N",e.ERROR="E",e.COMPLETE="C"})(yl||(yl={}));var yf=function(){function e(o,s,a){this.kind=o,this.value=s,this.error=a,this.hasValue=o==="N"}return e.prototype.observe=function(o){switch(this.kind){case"N":return o.next&&o.next(this.value);case"E":return o.error&&o.error(this.error);case"C":return o.complete&&o.complete()}},e.prototype.do=function(o,s,a){switch(this.kind){case"N":return o&&o(this.value);case"E":return s&&s(this.error);case"C":return a&&a()}},e.prototype.accept=function(o,s,a){return o&&typeof o.next=="function"?this.observe(o):this.do(o,s,a)},e.prototype.toObservable=function(){switch(this.kind){case"N":return ob(this.value);case"E":return ra(this.error);case"C":return Qf()}throw Error("unexpected notification kind value")},e.createNext=function(o){return o!==void 0?new e("N",o):e.undefinedValueNotification},e.createError=function(o){return new e("E",void 0,o)},e.createComplete=function(){return e.completeNotification},e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e}(),Bu=function(){function e(o,s){s===void 0&&(s=0),this.scheduler=o,this.delay=s}return e.prototype.call=function(o,s){return s.subscribe(new Er(o,this.scheduler,this.delay))},e}(),Er=function(e){function o(s,a,_){return _===void 0&&(_=0),(s=e.call(this,s)||this).scheduler=a,s.delay=_,s}return ha(o,e),o.dispatch=function(s){s.notification.observe(s.destination),this.unsubscribe()},o.prototype.scheduleMessage=function(s){this.destination.add(this.scheduler.schedule(o.dispatch,this.delay,new OA(s,this.destination)))},o.prototype._next=function(s){this.scheduleMessage(yf.createNext(s))},o.prototype._error=function(s){this.scheduleMessage(yf.createError(s)),this.unsubscribe()},o.prototype._complete=function(){this.scheduleMessage(yf.createComplete()),this.unsubscribe()},o}(za),OA=function(e,o){this.notification=e,this.destination=o},Te=function(e){function o(s,a,_){s===void 0&&(s=Number.POSITIVE_INFINITY),a===void 0&&(a=Number.POSITIVE_INFINITY);var $=e.call(this)||this;return $.scheduler=_,$._events=[],$._infiniteTimeWindow=!1,$._bufferSize=1>s?1:s,$._windowTime=1>a?1:a,a===Number.POSITIVE_INFINITY?($._infiniteTimeWindow=!0,$.next=$.nextInfiniteTimeWindow):$.next=$.nextTimeWindow,$}return ha(o,e),o.prototype.nextInfiniteTimeWindow=function(s){if(!this.isStopped){var a=this._events;a.push(s),a.length>this._bufferSize&&a.shift()}e.prototype.next.call(this,s)},o.prototype.nextTimeWindow=function(s){this.isStopped||(this._events.push(new PA(this._getNow(),s)),this._trimBufferThenGetEvents()),e.prototype.next.call(this,s)},o.prototype._subscribe=function(s){var a=this._infiniteTimeWindow,_=a?this._events:this._trimBufferThenGetEvents(),$=this.scheduler,_e=_.length;if(this.closed)throw new Ld;if(this.isStopped||this.hasError)var _n=nb.EMPTY;else this.observers.push(s),_n=new Ar(this,s);if($&&s.add(s=new Er(s,$)),a)for(a=0;a<_e&&!s.closed;a++)s.next(_[a]);else for(a=0;a<_e&&!s.closed;a++)s.next(_[a].value);return this.hasError?s.error(this.thrownError):this.isStopped&&s.complete(),_n},o.prototype._getNow=function(){return(this.scheduler||Mg).now()},o.prototype._trimBufferThenGetEvents=function(){for(var s=this._getNow(),a=this._bufferSize,_=this._windowTime,$=this._events,_e=$.length,_n=0;_n<_e&&!(s-$[_n].time<_);)_n++;return _e>a&&(_n=Math.max(_n,_e-a)),0<_n&&$.splice(0,_n),$},o}(rb),PA=function(e,o){this.time=e,this.value=o},Sf=function(e){function o(){var s=e!==null&&e.apply(this,arguments)||this;return s.value=null,s.hasNext=!1,s.hasCompleted=!1,s}return ha(o,e),o.prototype._subscribe=function(s){return this.hasError?(s.error(this.thrownError),nb.EMPTY):this.hasCompleted&&this.hasNext?(s.next(this.value),s.complete(),nb.EMPTY):e.prototype._subscribe.call(this,s)},o.prototype.next=function(s){this.hasCompleted||(this.value=s,this.hasNext=!0)},o.prototype.error=function(s){this.hasCompleted||e.prototype.error.call(this,s)},o.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&e.prototype.next.call(this,this.value),e.prototype.complete.call(this)},o}(rb),QA=1,RA=Promise.resolve(),aj={},Fr={setImmediate:function(e){var o=QA++;return aj[o]=!0,RA.then(function(){return fn(o)&&e()}),o},clearImmediate:function(e){fn(e)}},SA=function(e){function o(s,a){var _=e.call(this,s,a)||this;return _.scheduler=s,_.work=a,_}return ha(o,e),o.prototype.requestAsyncId=function(s,a,_){return _===void 0&&(_=0),_!==null&&0<_?e.prototype.requestAsyncId.call(this,s,a,_):(s.actions.push(this),s.scheduled||(s.scheduled=Fr.setImmediate(s.flush.bind(s,null))))},o.prototype.recycleAsyncId=function(s,a,_){if(_===void 0&&(_=0),_!==null&&0<_||_===null&&0<this.delay)return e.prototype.recycleAsyncId.call(this,s,a,_);s.actions.length===0&&(Fr.clearImmediate(a),s.scheduled=void 0)},o}(Kg),kj=new(function(e){function o(){return e!==null&&e.apply(this,arguments)||this}return ha(o,e),o.prototype.flush=function(s){this.active=!0,this.scheduled=void 0;var a,_=this.actions,$=-1,_e=_.length;s=s||_.shift();do if(a=s.execute(s.state,s.delay))break;while(++$<_e&&(s=_.shift()));if(this.active=!1,a){for(;++$<_e&&(s=_.shift());)s.unsubscribe();throw a}},o}(Lg))(SA),TA=kj,zl=new Lg(Kg),cd=zl,UA=function(e){function o(s,a){var _=e.call(this,s,a)||this;return _.scheduler=s,_.work=a,_}return ha(o,e),o.prototype.requestAsyncId=function(s,a,_){return _===void 0&&(_=0),_!==null&&0<_?e.prototype.requestAsyncId.call(this,s,a,_):(s.actions.push(this),s.scheduled||(s.scheduled=requestAnimationFrame(function(){return s.flush(null)})))},o.prototype.recycleAsyncId=function(s,a,_){if(_===void 0&&(_=0),_!==null&&0<_||_===null&&0<this.delay)return e.prototype.recycleAsyncId.call(this,s,a,_);s.actions.length===0&&(cancelAnimationFrame(a),s.scheduled=void 0)},o}(Kg),Gr=new(function(e){function o(){return e!==null&&e.apply(this,arguments)||this}return ha(o,e),o.prototype.flush=function(s){this.active=!0,this.scheduled=void 0;var a,_=this.actions,$=-1,_e=_.length;s=s||_.shift();do if(a=s.execute(s.state,s.delay))break;while(++$<_e&&(s=_.shift()));if(this.active=!1,a){for(;++$<_e&&(s=_.shift());)s.unsubscribe();throw a}},o}(Lg))(UA),VA=function(e){function o(s,a){s===void 0&&(s=Hr),a===void 0&&(a=Number.POSITIVE_INFINITY);var _=e.call(this,s,function(){return _.frame})||this;return _.maxFrames=a,_.frame=0,_.index=-1,_}return ha(o,e),o.prototype.flush=function(){for(var s,a,_=this.actions,$=this.maxFrames;(a=_[0])&&a.delay<=$&&(_.shift(),this.frame=a.delay,!(s=a.execute(a.state,a.delay))););if(s){for(;a=_.shift();)a.unsubscribe();throw s}},o.frameTimeFactor=10,o}(Lg),Hr=function(e){function o(s,a,_){_===void 0&&(_=s.index+=1);var $=e.call(this,s,a)||this;return $.scheduler=s,$.work=a,$.index=_,$.active=!0,$.index=s.index=_,$}return ha(o,e),o.prototype.schedule=function(s,a){if(a===void 0&&(a=0),!this.id)return e.prototype.schedule.call(this,s,a);this.active=!1;var _=new o(this.scheduler,this.work);return this.add(_),_.schedule(s,a)},o.prototype.requestAsyncId=function(s,a,_){return _===void 0&&(_=0),this.delay=s.frame+_,(s=s.actions).push(this),s.sort(o.sortActions),!0},o.prototype.recycleAsyncId=function(s,a,_){},o.prototype._execute=function(s,a){if(this.active===!0)return e.prototype._execute.call(this,s,a)},o.sortActions=function(s,a){return s.delay===a.delay?s.index===a.index?0:s.index>a.index?1:-1:s.delay>a.delay?1:-1},o}(Kg),Al=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),eh=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}(),Tb=function(){function e(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return e.prototype=Object.create(Error.prototype),e}(),Cu=function(){function e(o,s){this.project=o,this.thisArg=s}return e.prototype.call=function(o,s){return s.subscribe(new WA(o,this.project,this.thisArg))},e}(),WA=function(e){function o(s,a,_){return(s=e.call(this,s)||this).project=a,s.count=0,s.thisArg=_||s,s}return ha(o,e),o.prototype._next=function(s){try{var a=this.project.call(this.thisArg,s,this.count++)}catch(_){return void this.destination.error(_)}this.destination.next(a)},o}(za),Bl=function(e){function o(){return e!==null&&e.apply(this,arguments)||this}return ha(o,e),o.prototype.notifyNext=function(s,a,_,$,_e){this.destination.next(a)},o.prototype.notifyError=function(s,a){this.destination.error(s)},o.prototype.notifyComplete=function(s){this.destination.complete()},o}(za),Hu=function(e){function o(s,a,_){var $=e.call(this)||this;return $.parent=s,$.outerValue=a,$.outerIndex=_,$.index=0,$}return ha(o,e),o.prototype._next=function(s){this.parent.notifyNext(this.outerValue,s,this.outerIndex,this.index++,this)},o.prototype._error=function(s){this.parent.notifyError(s,this),this.unsubscribe()},o.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},o}(za),XA=function(e){return function(o){return e.then(function(s){o.closed||(o.next(s),o.complete())},function(s){return o.error(s)}).then(null,Oe),o}},xd=typeof Symbol=="function"&&Symbol.iterator?Symbol.iterator:"@@iterator",YA=function(e){return function(o){for(var s=e[xd]();;){var a=void 0;try{a=s.next()}catch(_){return o.error(_),o}if(a.done){o.complete();break}if(o.next(a.value),o.closed)break}return typeof s.return=="function"&&o.add(function(){s.return&&s.return()}),o}},ZA=function(e){return function(o){var s=e[Pe]();if(typeof s.subscribe!="function")throw new TypeError("Provided object does not correctly implement Symbol.observable");return s.subscribe(o)}},mn=function(e){return e&&typeof e.length=="number"&&typeof e!="function"},Tf=function(e){if(e&&typeof e[Pe]=="function")return ZA(e);if(mn(e))return en(e);if(kn(e))return XA(e);if(e&&typeof e[xd]=="function")return YA(e);throw e=Xi(e)?"an invalid object":"'"+e+"'",new TypeError("You provided "+e+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},Ir={},aB=function(){function e(o){this.resultSelector=o}return e.prototype.call=function(o,s){return s.subscribe(new $A(o,this.resultSelector))},e}(),$A=function(e){function o(s,a){return(s=e.call(this,s)||this).resultSelector=a,s.active=0,s.values=[],s.observables=[],s}return ha(o,e),o.prototype._next=function(s){this.values.push(Ir),this.observables.push(s)},o.prototype._complete=function(){var s=this.observables,a=s.length;if(a===0)this.destination.complete();else{this.toRespond=this.active=a;for(var _=0;_<a;_++)this.add(bj(this,s[_],void 0,_))}},o.prototype.notifyComplete=function(s){--this.active==0&&this.destination.complete()},o.prototype.notifyNext=function(s,a,_){var $=(s=this.values)[_];$=this.toRespond?$===Ir?--this.toRespond:this.toRespond:0,s[_]=a,$===0&&(this.resultSelector?this._tryResultSelector(s):this.destination.next(s.slice()))},o.prototype._tryResultSelector=function(s){try{var a=this.resultSelector.apply(this,s)}catch(_){return void this.destination.error(_)}this.destination.next(a)},o}(Bl),nd=function(e){function o(s){var a=e.call(this)||this;return a.parent=s,a}return ha(o,e),o.prototype._next=function(s){this.parent.notifyNext(s)},o.prototype._error=function(s){this.parent.notifyError(s),this.unsubscribe()},o.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},o}(za);(function(e){function o(s,a,_){var $=e.call(this)||this;return $.parent=s,$.outerValue=a,$.outerIndex=_,$}ha(o,e),o.prototype._next=function(s){this.parent.notifyNext(this.outerValue,s,this.outerIndex,this)},o.prototype._error=function(s){this.parent.notifyError(s),this.unsubscribe()},o.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()}})(za);var od=function(e){function o(){return e!==null&&e.apply(this,arguments)||this}return ha(o,e),o.prototype.notifyNext=function(s){this.destination.next(s)},o.prototype.notifyError=function(s){this.destination.error(s)},o.prototype.notifyComplete=function(){this.destination.complete()},o}(za);(function(e){function o(){return e!==null&&e.apply(this,arguments)||this}ha(o,e),o.prototype.notifyNext=function(s,a,_,$){this.destination.next(a)},o.prototype.notifyError=function(s){this.destination.error(s)},o.prototype.notifyComplete=function(s){this.destination.complete()}})(za);var Lu=function(){function e(o,s){s===void 0&&(s=Number.POSITIVE_INFINITY),this.project=o,this.concurrent=s}return e.prototype.call=function(o,s){return s.subscribe(new bB(o,this.project,this.concurrent))},e}(),bB=function(e){function o(s,a,_){return _===void 0&&(_=Number.POSITIVE_INFINITY),(s=e.call(this,s)||this).project=a,s.concurrent=_,s.hasCompleted=!1,s.buffer=[],s.active=0,s.index=0,s}return ha(o,e),o.prototype._next=function(s){this.active<this.concurrent?this._tryNext(s):this.buffer.push(s)},o.prototype._tryNext=function(s){var a=this.index++;try{var _=this.project(s,a)}catch($){return void this.destination.error($)}this.active++,this._innerSub(_)},o.prototype._innerSub=function(s){var a=new nd(this),_=this.destination;_.add(a),(s=bd(s,a))!==a&&_.add(s)},o.prototype._complete=function(){this.hasCompleted=!0,this.active===0&&this.buffer.length===0&&this.destination.complete(),this.unsubscribe()},o.prototype.notifyNext=function(s){this.destination.next(s)},o.prototype.notifyComplete=function(){var s=this.buffer;this.active--,0<s.length?this._next(s.shift()):this.active===0&&this.hasCompleted&&this.destination.complete()},o}(od),Cl=R.parseFloat,Jr=1/Cl(`	
\v\f\r \u2028\u2029\uFEFF-0`)!=-1/0?function(e){e=Oj(String(e));var o=Cl(e);return o===0&&e.charAt(0)=="-"?-0:o}:Cl;ea({global:!0,forced:parseFloat!=Jr},{parseFloat:Jr});var Dl=new ua(Ic),Qu=function(){function e(o,s){this.predicate=o,this.thisArg=s}return e.prototype.call=function(o,s){return s.subscribe(new cB(o,this.predicate,this.thisArg))},e}(),cB=function(e){function o(s,a,_){return(s=e.call(this,s)||this).predicate=a,s.thisArg=_,s.count=0,s}return ha(o,e),o.prototype._next=function(s){try{var a=this.predicate.call(this.thisArg,s,this.count++)}catch(_){return void this.destination.error(_)}a&&this.destination.next(s)},o}(za),Ru=function(){function e(){}return e.prototype.call=function(o,s){return s.subscribe(new dB(o))},e}(),dB=function(e){function o(s){return(s=e.call(this,s)||this).hasFirst=!1,s.observables=[],s.subscriptions=[],s}return ha(o,e),o.prototype._next=function(s){this.observables.push(s)},o.prototype._complete=function(){var s=this.observables,a=s.length;if(a===0)this.destination.complete();else{for(var _=0;_<a&&!this.hasFirst;_++){var $=bj(this,s[_],void 0,_);this.subscriptions&&this.subscriptions.push($),this.add($)}this.observables=null}},o.prototype.notifyNext=function(s,a,_){if(!this.hasFirst){for(this.hasFirst=!0,s=0;s<this.subscriptions.length;s++)if(s!==_){var $=this.subscriptions[s];$.unsubscribe(),this.remove($)}this.subscriptions=null}this.destination.next(a)},o}(Bl),Uu=function(){function e(o){this.resultSelector=o}return e.prototype.call=function(o,s){return s.subscribe(new eB(o,this.resultSelector))},e}(),eB=function(e){function o(s,a,_){return(s=e.call(this,s)||this).resultSelector=a,s.iterators=[],s.active=0,s.resultSelector=typeof a=="function"?a:void 0,s}return ha(o,e),o.prototype._next=function(s){var a=this.iterators;hc(s)?a.push(new fB(s)):typeof s[xd]=="function"?a.push(new gB(s[xd]())):a.push(new hB(this.destination,this,s))},o.prototype._complete=function(){var s=this.iterators,a=s.length;if(this.unsubscribe(),a===0)this.destination.complete();else{this.active=a;for(var _=0;_<a;_++){var $=s[_];$.stillUnsubscribed?this.destination.add($.subscribe()):this.active--}}},o.prototype.notifyInactive=function(){this.active--,this.active===0&&this.destination.complete()},o.prototype.checkIterators=function(){for(var s=this.iterators,a=s.length,_=this.destination,$=0;$<a;$++){var _e=s[$];if(typeof _e.hasValue=="function"&&!_e.hasValue())return}var _n=!1,_r=[];for($=0;$<a;$++){var _s=(_e=s[$]).next();if(_e.hasCompleted()&&(_n=!0),_s.done)return void _.complete();_r.push(_s.value)}this.resultSelector?this._tryresultSelector(_r):_.next(_r),_n&&_.complete()},o.prototype._tryresultSelector=function(s){try{var a=this.resultSelector.apply(this,s)}catch(_){return void this.destination.error(_)}this.destination.next(a)},o}(za),gB=function(){function e(o){this.iterator=o,this.nextResult=o.next()}return e.prototype.hasValue=function(){return!0},e.prototype.next=function(){var o=this.nextResult;return this.nextResult=this.iterator.next(),o},e.prototype.hasCompleted=function(){var o=this.nextResult;return!(!o||!o.done)},e}(),fB=function(){function e(o){this.array=o,this.length=this.index=0,this.length=o.length}return e.prototype[xd]=function(){return this},e.prototype.next=function(o){o=this.index++;var s=this.array;return o<this.length?{value:s[o],done:!1}:{value:null,done:!0}},e.prototype.hasValue=function(){return this.array.length>this.index},e.prototype.hasCompleted=function(){return this.array.length===this.index},e}(),hB=function(e){function o(s,a,_){return(s=e.call(this,s)||this).parent=a,s.observable=_,s.stillUnsubscribed=!0,s.buffer=[],s.isComplete=!1,s}return ha(o,e),o.prototype[xd]=function(){return this},o.prototype.next=function(){var s=this.buffer;return s.length===0&&this.isComplete?{value:null,done:!0}:{value:s.shift(),done:!1}},o.prototype.hasValue=function(){return 0<this.buffer.length},o.prototype.hasCompleted=function(){return this.buffer.length===0&&this.isComplete},o.prototype.notifyComplete=function(){0<this.buffer.length?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},o.prototype.notifyNext=function(s){this.buffer.push(s),this.parent.checkIterators()},o.prototype.subscribe=function(){return bd(this.observable,new nd(this))},o}(od),iB=Object.freeze({__proto__:null,Observable:ua,ConnectableObservable:Dr,GroupedObservable:wl,observable:Pe,Subject:rb,BehaviorSubject:MA,ReplaySubject:Te,AsyncSubject:Sf,asap:TA,asapScheduler:kj,async:cd,asyncScheduler:zl,queue:Mg,queueScheduler:Mg,animationFrame:Gr,animationFrameScheduler:Gr,VirtualTimeScheduler:VA,VirtualAction:Hr,Scheduler:xl,Subscription:nb,Subscriber:za,Notification:yf,get NotificationKind(){return yl},pipe:Zi,noop:Ic,identity:wd,isObservable:function(e){return!!e&&(e instanceof ua||typeof e.lift=="function"&&typeof e.subscribe=="function")},ArgumentOutOfRangeError:Al,EmptyError:eh,ObjectUnsubscribedError:Ld,UnsubscriptionError:Pf,TimeoutError:Tb,bindCallback:gn,bindNodeCallback:hn,combineLatest:function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var s=o=void 0;return ad(e[e.length-1])&&(s=e.pop()),typeof e[e.length-1]=="function"&&(o=e.pop()),e.length===1&&hc(e[0])&&(e=e[0]),Rf(e,s).lift(new aB(o))},concat:nn,defer:yd,empty:Qf,forkJoin:function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];if(e.length===1){var s=e[0];if(hc(s))return ch(s,null);if(Xi(s)&&Object.getPrototypeOf(s)===Object.prototype)return ch((e=Object.keys(s)).map(function(_){return s[_]}),e)}if(typeof e[e.length-1]=="function"){var a=e.pop();return ch(e=e.length===1&&hc(e[0])?e[0]:e,null).pipe(Ea(function(_){return a.apply(void 0,_)}))}return ch(e,null)},from:Jc,fromEvent:Db,fromEventPattern:pn,generate:function(e,o,s,a,_){if(arguments.length==1){var $=e.initialState;o=e.condition,s=e.iterate;var _e=e.resultSelector||wd;_=e.scheduler}else a===void 0||ad(a)?($=e,_e=wd,_=a):($=e,_e=a);return new ua(function(_n){var _r=$;if(_)return _.schedule(Mu,0,{subscriber:_n,iterate:s,condition:o,resultSelector:_e,state:_r});for(;;){if(o){var _s=void 0;try{_s=o(_r)}catch(na){_n.error(na);break}if(!_s){_n.complete();break}}_s=void 0;try{_s=_e(_r)}catch(na){_n.error(na);break}if(_n.next(_s),_n.closed)break;try{_r=s(_r)}catch(na){_n.error(na);break}}})},iif:function(e,o,s){return o===void 0&&(o=Sb),s===void 0&&(s=Sb),yd(function(){return e()?o:s})},interval:Qe,merge:Jb,never:function(){return Dl},of:ob,onErrorResumeNext:dj,pairs:function(e,o){return new ua(o?function(s){var a=Object.keys(e),_=new nb;return _.add(o.schedule(Ou,0,{keys:a,index:0,subscriber:s,subscription:_,obj:e})),_}:function(s){for(var a=Object.keys(e),_=0;_<a.length&&!s.closed;_++){var $=a[_];e.hasOwnProperty($)&&s.next([$,e[$]])}s.complete()})},partition:function(e,o,s){return[yb(o,s)(new ua(Tf(e))),yb(Pu(o,s))(new ua(Tf(e)))]},race:fb,range:function(e,o,s){return e===void 0&&(e=0),new ua(function(a){o===void 0&&(o=e,e=0);var _=0,$=e;if(s)return s.schedule(Su,0,{index:_,count:o,start:e,subscriber:a});for(;;){if(_++>=o){a.complete();break}if(a.next($++),a.closed)break}})},throwError:ra,timer:dd,using:function(e,o){return new ua(function(s){try{var a=e()}catch(_e){return void s.error(_e)}try{var _=o(a)}catch(_e){return void s.error(_e)}var $=(_?Jc(_):Sb).subscribe(s);return function(){$.unsubscribe(),a&&a.unsubscribe()}})},zip:ej,scheduled:ln,EMPTY:Sb,NEVER:Dl,config:gc}),Vu=function(){function e(o,s,a,_){this.bufferTimeSpan=o,this.bufferCreationInterval=s,this.maxBufferSize=a,this.scheduler=_}return e.prototype.call=function(o,s){return s.subscribe(new jB(o,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},e}(),kB=function(){this.buffer=[]},jB=function(e){function o(s,a,_,$,_e){if((s=e.call(this,s)||this).bufferTimeSpan=a,s.bufferCreationInterval=_,s.maxBufferSize=$,s.scheduler=_e,s.contexts=[],$=s.openContext(),s.timespanOnly=_==null||0>_,s.timespanOnly)s.add($.closeAction=_e.schedule(qn,a,{subscriber:s,context:$,bufferTimeSpan:a}));else{var _n={bufferTimeSpan:a,bufferCreationInterval:_,subscriber:s,scheduler:_e};s.add($.closeAction=_e.schedule(rn,a,{subscriber:s,context:$})),s.add(_e.schedule(Wu,_,_n))}return s}return ha(o,e),o.prototype._next=function(s){for(var a,_=this.contexts,$=_.length,_e=0;_e<$;_e++){var _n=_[_e],_r=_n.buffer;_r.push(s),_r.length==this.maxBufferSize&&(a=_n)}a&&this.onBufferFull(a)},o.prototype._error=function(s){this.contexts.length=0,e.prototype._error.call(this,s)},o.prototype._complete=function(){for(var s=this.contexts,a=this.destination;0<s.length;){var _=s.shift();a.next(_.buffer)}e.prototype._complete.call(this)},o.prototype._unsubscribe=function(){this.contexts=null},o.prototype.onBufferFull=function(s){if(this.closeContext(s),(s=s.closeAction).unsubscribe(),this.remove(s),!this.closed&&this.timespanOnly){s=this.openContext();var a=this.bufferTimeSpan;this.add(s.closeAction=this.scheduler.schedule(qn,a,{subscriber:this,context:s,bufferTimeSpan:a}))}},o.prototype.openContext=function(){var s=new kB;return this.contexts.push(s),s},o.prototype.closeContext=function(s){this.destination.next(s.buffer);var a=this.contexts;0<=(a?a.indexOf(s):-1)&&a.splice(a.indexOf(s),1)},o}(za),Xu=function(){function e(o){this.selector=o}return e.prototype.call=function(o,s){return s.subscribe(new lB(o,this.selector,this.caught))},e}(),lB=function(e){function o(s,a,_){return(s=e.call(this,s)||this).selector=a,s.caught=_,s}return ha(o,e),o.prototype.error=function(s){if(!this.isStopped){var a=void 0;try{a=this.selector(s,this.caught)}catch(_){return void e.prototype.error.call(this,_)}this._unsubscribeAndRecycle(),s=new nd(this),this.add(s),(a=bd(a,s))!==s&&this.add(a)}},o}(od),Yu=function(){function e(o){this.defaultValue=o}return e.prototype.call=function(o,s){return s.subscribe(new mB(o,this.defaultValue))},e}(),mB=function(e){function o(s,a){return(s=e.call(this,s)||this).defaultValue=a,s.isEmpty=!0,s}return ha(o,e),o.prototype._next=function(s){this.isEmpty=!1,this.destination.next(s)},o.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},o}(za),Zu=function(){function e(o,s){this.delay=o,this.scheduler=s}return e.prototype.call=function(o,s){return s.subscribe(new nB(o,this.delay,this.scheduler))},e}(),nB=function(e){function o(s,a,_){return(s=e.call(this,s)||this).delay=a,s.scheduler=_,s.queue=[],s.active=!1,s.errored=!1,s}return ha(o,e),o.dispatch=function(s){for(var a=s.source,_=a.queue,$=s.scheduler,_e=s.destination;0<_.length&&0>=_[0].time-$.now();)_.shift().notification.observe(_e);0<_.length?(a=Math.max(0,_[0].time-$.now()),this.schedule(s,a)):(this.unsubscribe(),a.active=!1)},o.prototype._schedule=function(s){this.active=!0,this.destination.add(s.schedule(o.dispatch,this.delay,{source:this,destination:this.destination,scheduler:s}))},o.prototype.scheduleNotification=function(s){if(this.errored!==!0){var a=this.scheduler;s=new oB(a.now()+this.delay,s),this.queue.push(s),this.active===!1&&this._schedule(a)}},o.prototype._next=function(s){this.scheduleNotification(yf.createNext(s))},o.prototype._error=function(s){this.errored=!0,this.queue=[],this.destination.error(s),this.unsubscribe()},o.prototype._complete=function(){this.scheduleNotification(yf.createComplete()),this.unsubscribe()},o}(za),oB=function(e,o){this.time=e,this.notification=o},$u=function(){function e(o,s){this.keySelector=o,this.flushes=s}return e.prototype.call=function(o,s){return s.subscribe(new pB(o,this.keySelector,this.flushes))},e}(),pB=function(e){function o(s,a,_){return(s=e.call(this,s)||this).keySelector=a,s.values=new Set,_&&s.add(bd(_,new nd(s))),s}return ha(o,e),o.prototype.notifyNext=function(){this.values.clear()},o.prototype.notifyError=function(s){this._error(s)},o.prototype._next=function(s){this.keySelector?this._useKeySelector(s):this._finalizeNext(s,s)},o.prototype._useKeySelector=function(s){var a=this.destination;try{var _=this.keySelector(s)}catch($){return void a.error($)}this._finalizeNext(_,s)},o.prototype._finalizeNext=function(s,a){var _=this.values;_.has(s)||(_.add(s),this.destination.next(a))},o}(od),bv=function(){function e(o){this.errorFactory=o}return e.prototype.call=function(o,s){return s.subscribe(new qB(o,this.errorFactory))},e}(),qB=function(e){function o(s,a){return(s=e.call(this,s)||this).errorFactory=a,s.hasValue=!1,s}return ha(o,e),o.prototype._next=function(s){this.hasValue=!0,this.destination.next(s)},o.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var s=void 0;try{s=this.errorFactory()}catch(a){s=a}this.destination.error(s)},o}(za),cv=function(){function e(o){if(this.total=o,0>this.total)throw new Al}return e.prototype.call=function(o,s){return s.subscribe(new rB(o,this.total))},e}(),rB=function(e){function o(s,a){return(s=e.call(this,s)||this).total=a,s.count=0,s}return ha(o,e),o.prototype._next=function(s){var a=this.total,_=++this.count;_<=a&&(this.destination.next(s),_===a&&(this.destination.complete(),this.unsubscribe()))},o}(za),dv=function(){function e(o){this.callback=o}return e.prototype.call=function(o,s){return s.subscribe(new sB(o,this.callback))},e}(),sB=function(e){function o(s,a){return(s=e.call(this,s)||this).add(new nb(a)),s}return ha(o,e),o}(za),fv=function(){function e(){}return e.prototype.call=function(o,s){return s.subscribe(new tB(o))},e}(),tB=function(e){function o(){return e!==null&&e.apply(this,arguments)||this}return ha(o,e),o.prototype._next=function(s){},o}(za),gv=function(){function e(o){if(this.total=o,0>this.total)throw new Al}return e.prototype.call=function(o,s){return s.subscribe(new uB(o,this.total))},e}(),uB=function(e){function o(s,a){return(s=e.call(this,s)||this).total=a,s.ring=[],s.count=0,s}return ha(o,e),o.prototype._next=function(s){var a=this.ring,_=this.total,$=this.count++;a.length<_?a.push(s):a[$%_]=s},o.prototype._complete=function(){var s=this.destination,a=this.count;if(0<a)for(var _=this.count>=this.total?this.total:this.count,$=this.ring,_e=0;_e<_;_e++){var _n=a++%_;s.next($[_n])}s.complete()},o}(za),hv=function(){function e(o){this.value=o}return e.prototype.call=function(o,s){return s.subscribe(new vB(o,this.value))},e}(),vB=function(e){function o(s,a){return(s=e.call(this,s)||this).value=a,s}return ha(o,e),o.prototype._next=function(s){this.destination.next(this.value)},o}(za),iv=function(){function e(o,s,a){a===void 0&&(a=!1),this.accumulator=o,this.seed=s,this.hasSeed=a}return e.prototype.call=function(o,s){return s.subscribe(new wB(o,this.accumulator,this.seed,this.hasSeed))},e}(),wB=function(e){function o(s,a,_,$){return(s=e.call(this,s)||this).accumulator=a,s._seed=_,s.hasSeed=$,s.index=0,s}return ha(o,e),Object.defineProperty(o.prototype,"seed",{get:function(){return this._seed},set:function(s){this.hasSeed=!0,this._seed=s},enumerable:!0,configurable:!0}),o.prototype._next=function(s){if(this.hasSeed)return this._tryNext(s);this.seed=s,this.destination.next(s)},o.prototype._tryNext=function(s){var a=this.index++;try{var _=this.accumulator(this.seed,s,a)}catch($){this.destination.error($)}this.seed=_,this.destination.next(_)},o}(za),kv=function(){function e(o,s){this.subjectFactory=o,this.selector=s}return e.prototype.call=function(o,s){var a=this.selector,_=this.subjectFactory();return(o=a(_).subscribe(o)).add(s.subscribe(_)),o},e}(),mv=function(){function e(o,s){this.notifier=o,this.source=s}return e.prototype.call=function(o,s){return s.subscribe(new xB(o,this.notifier,this.source))},e}(),xB=function(e){function o(s,a,_){return(s=e.call(this,s)||this).notifier=a,s.source=_,s}return ha(o,e),o.prototype.error=function(s){if(!this.isStopped){var a=this.errors,_=this.retries,$=this.retriesSubscription;if(_)this.retriesSubscription=this.errors=void 0;else{a=new rb;try{_=(0,this.notifier)(a)}catch(_e){return e.prototype.error.call(this,_e)}$=bd(_,new nd(this))}this._unsubscribeAndRecycle(),this.errors=a,this.retries=_,this.retriesSubscription=$,a.next(s)}},o.prototype._unsubscribe=function(){var s=this.errors,a=this.retriesSubscription;s&&(s.unsubscribe(),this.errors=void 0),a&&(a.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},o.prototype.notifyNext=function(){var s=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=s,this.source.subscribe(this)},o}(od),pv=function(){function e(o){this.project=o}return e.prototype.call=function(o,s){return s.subscribe(new yB(o,this.project))},e}(),yB=function(e){function o(s,a){return(s=e.call(this,s)||this).project=a,s.index=0,s}return ha(o,e),o.prototype._next=function(s){var a=this.index++;try{var _=this.project(s,a)}catch($){return void this.destination.error($)}this._innerSub(_)},o.prototype._innerSub=function(s){var a=this.innerSubscription;a&&a.unsubscribe(),a=new nd(this);var _=this.destination;_.add(a),this.innerSubscription=bd(s,a),this.innerSubscription!==a&&_.add(this.innerSubscription)},o.prototype._complete=function(){var s=this.innerSubscription;s&&!s.closed||e.prototype._complete.call(this),this.unsubscribe()},o.prototype._unsubscribe=function(){this.innerSubscription=void 0},o.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},o.prototype.notifyNext=function(s){this.destination.next(s)},o}(od),qv=function(){function e(o){this.notifier=o}return e.prototype.call=function(o,s){o=new zB(o);var a=bd(this.notifier,new nd(o));return a&&!o.seenValue?(o.add(a),s.subscribe(o)):o},e}(),zB=function(e){function o(s){return(s=e.call(this,s)||this).seenValue=!1,s}return ha(o,e),o.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},o.prototype.notifyComplete=function(){},o}(od),rv=function(){function e(o,s,a){this.nextOrObserver=o,this.error=s,this.complete=a}return e.prototype.call=function(o,s){return s.subscribe(new AB(o,this.nextOrObserver,this.error,this.complete))},e}(),AB=function(e){function o(s,a,_,$){return(s=e.call(this,s)||this)._tapNext=Ic,s._tapError=Ic,s._tapComplete=Ic,s._tapError=_||Ic,s._tapComplete=$||Ic,Ne(a)?(s._context=s,s._tapNext=a):a&&(s._context=a,s._tapNext=a.next||Ic,s._tapError=a.error||Ic,s._tapComplete=a.complete||Ic),s}return ha(o,e),o.prototype._next=function(s){try{this._tapNext.call(this._context,s)}catch(a){return void this.destination.error(a)}this.destination.next(s)},o.prototype._error=function(s){try{this._tapError.call(this._context,s)}catch(a){return void this.destination.error(a)}this.destination.error(s)},o.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(s){return void this.destination.error(s)}return this.destination.complete()},o}(za),tv={leading:!0,trailing:!1};(function(e){function o(s,a,_,$){var _e=e.call(this,s)||this;return _e.destination=s,_e.durationSelector=a,_e._leading=_,_e._trailing=$,_e._hasValue=!1,_e}ha(o,e),o.prototype._next=function(s){this._hasValue=!0,this._sendValue=s,this._throttled||(this._leading?this.send():this.throttle(s))},o.prototype.send=function(){var s=this._sendValue;this._hasValue&&(this.destination.next(s),this.throttle(s)),this._hasValue=!1,this._sendValue=void 0},o.prototype.throttle=function(s){(s=this.tryDurationSelector(s))&&this.add(this._throttled=bd(s,new nd(this)))},o.prototype.tryDurationSelector=function(s){try{return this.durationSelector(s)}catch(a){return this.destination.error(a),null}},o.prototype.throttlingDone=function(){var s=this._throttled,a=this._trailing;s&&s.unsubscribe(),this._throttled=void 0,a&&this.send()},o.prototype.notifyNext=function(){this.throttlingDone()},o.prototype.notifyComplete=function(){this.throttlingDone()}})(od);for(var uv=function(){function e(o,s,a,_){this.duration=o,this.scheduler=s,this.leading=a,this.trailing=_}return e.prototype.call=function(o,s){return s.subscribe(new BB(o,this.duration,this.scheduler,this.leading,this.trailing))},e}(),BB=function(e){function o(s,a,_,$,_e){return(s=e.call(this,s)||this).duration=a,s.scheduler=_,s.leading=$,s.trailing=_e,s._hasTrailingValue=!1,s._trailingValue=null,s}return ha(o,e),o.prototype._next=function(s){this.throttled?this.trailing&&(this._trailingValue=s,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(vv,this.duration,{subscriber:this})),this.leading?this.destination.next(s):this.trailing&&(this._trailingValue=s,this._hasTrailingValue=!0))},o.prototype._complete=function(){this._hasTrailingValue&&this.destination.next(this._trailingValue),this.destination.complete()},o.prototype.clearThrottle=function(){var s=this.throttled;s&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),s.unsubscribe(),this.remove(s),this.throttled=null)},o}(za),xv=function(){function e(o,s,a,_){this.waitFor=o,this.absoluteTimeout=s,this.withObservable=a,this.scheduler=_}return e.prototype.call=function(o,s){return s.subscribe(new CB(o,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},e}(),CB=function(e){function o(s,a,_,$,_e){return(s=e.call(this,s)||this).absoluteTimeout=a,s.waitFor=_,s.withObservable=$,s.scheduler=_e,s.scheduleTimeout(),s}return ha(o,e),o.dispatchTimeout=function(s){var a=s.withObservable;s._unsubscribeAndRecycle(),s.add(bd(a,new nd(s)))},o.prototype.scheduleTimeout=function(){var s=this.action;s?this.action=s.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(o.dispatchTimeout,this.waitFor,this))},o.prototype._next=function(s){this.absoluteTimeout||this.scheduleTimeout(),e.prototype._next.call(this,s)},o.prototype._unsubscribe=function(){this.action=void 0,this.withObservable=this.scheduler=null},o}(od),zv=function(){function e(o,s){this.observables=o,this.project=s}return e.prototype.call=function(o,s){return s.subscribe(new DB(o,this.observables,this.project))},e}(),DB=function(e){function o(s,a,_){(s=e.call(this,s)||this).observables=a,s.project=_,s.toRespond=[],_=a.length,s.values=Array(_);for(var $=0;$<_;$++)s.toRespond.push($);for($=0;$<_;$++)s.add(bj(s,a[$],void 0,$));return s}return ha(o,e),o.prototype.notifyNext=function(s,a,_){this.values[_]=a,0<(s=this.toRespond).length&&(_=s.indexOf(_))!==-1&&s.splice(_,1)},o.prototype.notifyComplete=function(){},o.prototype._next=function(s){this.toRespond.length===0&&(s=[s].concat(this.values),this.project?this._tryProject(s):this.destination.next(s))},o.prototype._tryProject=function(s){try{var a=this.project.apply(this,s)}catch(_){return void this.destination.error(_)}this.destination.next(a)},o}(Bl),Kr=xb(function(e){var o=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(o){var s=new Uint8Array(16);e.exports=function(){return o(s),s}}else{var a=Array(16);e.exports=function(){for(var _,$=0;16>$;$++)!(3&$)&&(_=4294967296*Math.random()),a[$]=_>>>((3&$)<<3)&255;return a}}}),zb=[],pi=0;256>pi;++pi)zb[pi]=(pi+256).toString(16).substr(1);var Lr=function(e,o){return o=o||0,[zb[e[o++]],zb[e[o++]],zb[e[o++]],zb[e[o++]],"-",zb[e[o++]],zb[e[o++]],"-",zb[e[o++]],zb[e[o++]],"-",zb[e[o++]],zb[e[o++]],"-",zb[e[o++]],zb[e[o++]],zb[e[o++]],zb[e[o++]],zb[e[o++]],zb[e[o++]]].join("")},Ng=function(e,o,s){if(s=o&&s||0,typeof e=="string"&&(o=e==="binary"?Array(16):null,e=null),(e=(e=e||{}).random||(e.rng||Kr)())[6]=15&e[6]|64,e[8]=63&e[8]|128,o)for(var a=0;16>a;++a)o[s+a]=e[a];return o||Lr(e)},Og=Ng(),gj=!1,yn=new AbortController,pd,Md,El,Fl,Nd,qe,Fc,re,nc,Gl,qd,se,rd,sd,td,zf;(function(e){e[e.ATTRIBUTE_OPERATION_ERR_FAILURE=2]="ATTRIBUTE_OPERATION_ERR_FAILURE",e[e.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT=3]="ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT",e[e.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW=4]="ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW",e[e.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN=5]="ATTRIBUTE_OPERATION_ERR_TOO_OFTEN",e[e.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND=6]="ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND",e[e.ATTRIBUTE_OPERATION_ERR_TIMEOUT=7]="ATTRIBUTE_OPERATION_ERR_TIMEOUT",e[e.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN=102]="ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN"})(pd||(pd={})),function(e){e[e.CHANNEL_MESSAGE_ERR_FAILURE=1]="CHANNEL_MESSAGE_ERR_FAILURE",e[e.CHANNEL_MESSAGE_ERR_TIMEOUT=2]="CHANNEL_MESSAGE_ERR_TIMEOUT",e[e.CHANNEL_MESSAGE_ERR_TOO_OFTEN=3]="CHANNEL_MESSAGE_ERR_TOO_OFTEN",e[e.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE=4]="CHANNEL_MESSAGE_ERR_INVALID_MESSAGE",e[e.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL=5]="CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL",e[e.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(Md||(Md={})),function(e){e[e.CREATE_CHANNEL_ERR_INVALID_ARGUMENT=1]="CREATE_CHANNEL_ERR_INVALID_ARGUMENT"}(El||(El={})),function(e){e[e.CREATE_INSTANCE_ERR_INVALID_ARGUMENT=1]="CREATE_INSTANCE_ERR_INVALID_ARGUMENT"}(Fl||(Fl={})),function(e){e[e.GET_MEMBERS_ERR_FAILURE=1]="GET_MEMBERS_ERR_FAILURE",e[e.GET_MEMBERS_ERR_REJECTED=2]="GET_MEMBERS_ERR_REJECTED",e[e.GET_MEMBERS_ERR_TIMEOUT=3]="GET_MEMBERS_ERR_TIMEOUT",e[e.GET_MEMBERS_ERR_TOO_OFTEN=4]="GET_MEMBERS_ERR_TOO_OFTEN",e[e.GET_MEMBERS_ERR_NOT_IN_CHANNEL=5]="GET_MEMBERS_ERR_NOT_IN_CHANNEL",e[e.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN=102]="GET_MEMBERS_ERR_USER_NOT_LOGGED_IN"}(Nd||(Nd={})),function(e){e[e.INVITATION_API_CALL_ERR_INVALID_ARGUMENT=1]="INVITATION_API_CALL_ERR_INVALID_ARGUMENT",e[e.INVITATION_API_CALL_ERR_NOT_STARTED=2]="INVITATION_API_CALL_ERR_NOT_STARTED",e[e.INVITATION_API_CALL_ERR_ALREADY_END=3]="INVITATION_API_CALL_ERR_ALREADY_END",e[e.INVITATION_API_CALL_ERR_ALREADY_ACCEPT=4]="INVITATION_API_CALL_ERR_ALREADY_ACCEPT",e[e.INVITATION_API_CALL_ERR_ALREADY_SENT=5]="INVITATION_API_CALL_ERR_ALREADY_SENT"}(qe||(qe={})),function(e){e[e.JOIN_CHANNEL_ERR_FAILURE=1]="JOIN_CHANNEL_ERR_FAILURE",e[e.JOIN_CHANNEL_ERR_REJECTED=2]="JOIN_CHANNEL_ERR_REJECTED",e[e.JOIN_CHANNEL_ERR_INVALID_ARGUMENT=3]="JOIN_CHANNEL_ERR_INVALID_ARGUMENT",e[e.JOIN_CHANNEL_TIMEOUT=4]="JOIN_CHANNEL_TIMEOUT",e[e.JOIN_CHANNEL_ERR_EXCEED_LIMIT=5]="JOIN_CHANNEL_ERR_EXCEED_LIMIT",e[e.JOIN_CHANNEL_ERR_ALREADY_JOINED=6]="JOIN_CHANNEL_ERR_ALREADY_JOINED",e[e.JOIN_CHANNEL_ERR_TOO_OFTEN=7]="JOIN_CHANNEL_ERR_TOO_OFTEN",e[e.JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN=8]="JOIN_CHANNEL_ERR_JOIN_SAME_CHANNEL_TOO_OFTEN",e[e.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN",e[e.JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE=201]="JOIN_CHANNEL_ERR_ABORTED_BY_LEAVE",e[e.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID=202]="JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID"}(Fc||(Fc={})),function(e){e[e.LEAVE_CHANNEL_ERR_FAILURE=1]="LEAVE_CHANNEL_ERR_FAILURE",e[e.LEAVE_CHANNEL_ERR_REJECTED=2]="LEAVE_CHANNEL_ERR_REJECTED",e[e.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL=3]="LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL",e[e.LEAVE_CHANNEL_ERR_KICKED=4]="LEAVE_CHANNEL_ERR_KICKED",e[e.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN=102]="LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN"}(re||(re={})),function(e){e[e.LOGIN_ERR_UNKNOWN=1]="LOGIN_ERR_UNKNOWN",e[e.LOGIN_ERR_REJECTED=2]="LOGIN_ERR_REJECTED",e[e.LOGIN_ERR_INVALID_ARGUMENT=3]="LOGIN_ERR_INVALID_ARGUMENT",e[e.LOGIN_ERR_INVALID_APP_ID=4]="LOGIN_ERR_INVALID_APP_ID",e[e.LOGIN_ERR_INVALID_TOKEN=5]="LOGIN_ERR_INVALID_TOKEN",e[e.LOGIN_ERR_TOKEN_EXPIRED=6]="LOGIN_ERR_TOKEN_EXPIRED",e[e.LOGIN_ERR_NOT_AUTHORIZED=7]="LOGIN_ERR_NOT_AUTHORIZED",e[e.LOGIN_ERR_ALREADY_LOGIN=8]="LOGIN_ERR_ALREADY_LOGIN",e[e.LOGIN_ERR_TIMEOUT=9]="LOGIN_ERR_TIMEOUT",e[e.LOGIN_ERR_TOO_OFTEN=10]="LOGIN_ERR_TOO_OFTEN",e[e.LOGIN_ERR_ABORTED_BY_LOGOUT=201]="LOGIN_ERR_ABORTED_BY_LOGOUT"}(nc||(nc={})),function(e){e[e.LOGOUT_ERR_USER_NOT_LOGGED_IN=102]="LOGOUT_ERR_USER_NOT_LOGGED_IN"}(Gl||(Gl={})),function(e){e[e.PEER_MESSAGE_ERR_FAILURE=1]="PEER_MESSAGE_ERR_FAILURE",e[e.PEER_MESSAGE_ERR_TIMEOUT=2]="PEER_MESSAGE_ERR_TIMEOUT",e[e.PEER_MESSAGE_ERR_TOO_OFTEN=5]="PEER_MESSAGE_ERR_TOO_OFTEN",e[e.PEER_MESSAGE_ERR_INVALID_USERID=6]="PEER_MESSAGE_ERR_INVALID_USERID",e[e.PEER_MESSAGE_ERR_INVALID_MESSAGE=7]="PEER_MESSAGE_ERR_INVALID_MESSAGE",e[e.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE=8]="PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE",e[e.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN=102]="PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN"}(qd||(qd={})),function(e){e[e.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT=2]="QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED=3]="QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT=4]="QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN=5]="QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN",e[e.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN"}(se||(se={})),function(e){e[e.RENEW_TOKEN_ERR_FAILURE=1]="RENEW_TOKEN_ERR_FAILURE",e[e.RENEW_TOKEN_ERR_INVALID_ARGUMENT=2]="RENEW_TOKEN_ERR_INVALID_ARGUMENT",e[e.RENEW_TOKEN_ERR_REJECTED=3]="RENEW_TOKEN_ERR_REJECTED",e[e.RENEW_TOKEN_ERR_TOO_OFTEN=4]="RENEW_TOKEN_ERR_TOO_OFTEN",e[e.RENEW_TOKEN_ERR_TOKEN_EXPIRED=5]="RENEW_TOKEN_ERR_TOKEN_EXPIRED",e[e.RENEW_TOKEN_ERR_INVALID_TOKEN=6]="RENEW_TOKEN_ERR_INVALID_TOKEN",e[e.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN=102]="RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN",e[e.RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT=201]="RENEW_TOKEN_ERR_ABORTED_BY_LOGOUT"}(rd||(rd={})),function(e){e[e.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE=1]="GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT=2]="GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN=3]="GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT=4]="GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT=5]="GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED=101]="GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED",e[e.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN=102]="GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN"}(sd||(sd={})),function(e){e[e.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE=1]="PEER_SUBSCRIPTION_STATUS_ERR_FAILURE",e[e.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT=2]="PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT",e[e.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED=3]="PEER_SUBSCRIPTION_STATUS_ERR_REJECTED",e[e.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT=4]="PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT",e[e.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN=5]="PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN",e[e.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW=6]="PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW",e[e.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN=102]="PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN"}(td||(td={})),function(e){e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE=1]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT=2]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN=3]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN",e[e.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN=102]="QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN"}(zf||(zf={}));var oc=pd.ATTRIBUTE_OPERATION_ERR_FAILURE,gb=pd.ATTRIBUTE_OPERATION_ERR_INVALID_ARGUMENT,Ye=pd.ATTRIBUTE_OPERATION_ERR_SIZE_OVERFLOW;pd.ATTRIBUTE_OPERATION_ERR_TOO_OFTEN;var Mr=pd.ATTRIBUTE_OPERATION_ERR_USER_NOT_FOUND,pc=pd.ATTRIBUTE_OPERATION_ERR_TIMEOUT,qc=pd.ATTRIBUTE_OPERATION_ERR_USER_NOT_LOGGED_IN,qi=Md.CHANNEL_MESSAGE_ERR_FAILURE,Hl=Md.CHANNEL_MESSAGE_ERR_TIMEOUT,Nr=Md.CHANNEL_MESSAGE_ERR_TOO_OFTEN,Il=Md.CHANNEL_MESSAGE_ERR_INVALID_MESSAGE,EB=Md.CHANNEL_MESSAGE_ERR_NOT_IN_CHANNEL,Jl=Md.CHANNEL_MESSAGE_ERR_USER_NOT_LOGGED_IN,FB=El.CREATE_CHANNEL_ERR_INVALID_ARGUMENT,Or=Fl.CREATE_INSTANCE_ERR_INVALID_ARGUMENT;sd.GET_CHANNEL_MEMBER_COUNT_ERR_FAILURE;var Pr=sd.GET_CHANNEL_MEMBER_COUNT_ERR_INVALID_ARGUMENT;sd.GET_CHANNEL_MEMBER_COUNT_ERR_TOO_OFTEN;var Qr=sd.GET_CHANNEL_MEMBER_COUNT_ERR_TIMEOUT,GB=sd.GET_CHANNEL_MEMBER_COUNT_ERR_EXCEED_LIMIT;sd.GET_CHANNEL_MEMBER_COUNT_ERR_NOT_INITIALIZED;var HB=sd.GET_CHANNEL_MEMBER_COUNT_ERR_USER_NOT_LOGGED_IN,IB=Nd.GET_MEMBERS_ERR_FAILURE,JB=Nd.GET_MEMBERS_ERR_REJECTED;Nd.GET_MEMBERS_ERR_TIMEOUT,Nd.GET_MEMBERS_ERR_TOO_OFTEN;var KB=Nd.GET_MEMBERS_ERR_NOT_IN_CHANNEL,LB=Nd.GET_MEMBERS_ERR_USER_NOT_LOGGED_IN,Xc=qe.INVITATION_API_CALL_ERR_INVALID_ARGUMENT,MB=qe.INVITATION_API_CALL_ERR_NOT_STARTED,ri=qe.INVITATION_API_CALL_ERR_ALREADY_END,Rr=qe.INVITATION_API_CALL_ERR_ALREADY_ACCEPT,NB=qe.INVITATION_API_CALL_ERR_ALREADY_SENT,Sr=Fc.JOIN_CHANNEL_ERR_FAILURE;Fc.JOIN_CHANNEL_ERR_REJECTED;var OB=Fc.JOIN_CHANNEL_ERR_INVALID_ARGUMENT,Tr=Fc.JOIN_CHANNEL_TIMEOUT,Ur=Fc.JOIN_CHANNEL_ERR_EXCEED_LIMIT,Vr=Fc.JOIN_CHANNEL_ERR_ALREADY_JOINED;Fc.JOIN_CHANNEL_ERR_TOO_OFTEN;var Wr=Fc.JOIN_CHANNEL_ERR_USER_NOT_LOGGED_IN,Xr=Fc.JOIN_CHANNEL_ERR_ALREADY_JOINED_CHANNEL_OF_SAME_ID,Yr=re.LEAVE_CHANNEL_ERR_FAILURE,Zr=re.LEAVE_CHANNEL_ERR_REJECTED,PB=re.LEAVE_CHANNEL_ERR_NOT_IN_CHANNEL,QB=re.LEAVE_CHANNEL_ERR_USER_NOT_LOGGED_IN,RB=re.LEAVE_CHANNEL_ERR_KICKED,$r=nc.LOGIN_ERR_UNKNOWN,Pg=nc.LOGIN_ERR_REJECTED,si=nc.LOGIN_ERR_INVALID_ARGUMENT,as=nc.LOGIN_ERR_INVALID_APP_ID,bs=nc.LOGIN_ERR_INVALID_TOKEN,ti=nc.LOGIN_ERR_TOKEN_EXPIRED;nc.LOGIN_ERR_NOT_AUTHORIZED;var SB=nc.LOGIN_ERR_ALREADY_LOGIN,TB=nc.LOGIN_ERR_TIMEOUT,UB=nc.LOGIN_ERR_TOO_OFTEN,cs=Gl.LOGOUT_ERR_USER_NOT_LOGGED_IN,ds=qd.PEER_MESSAGE_ERR_FAILURE,Kl=qd.PEER_MESSAGE_ERR_TIMEOUT,es=qd.PEER_MESSAGE_ERR_TOO_OFTEN,fs=qd.PEER_MESSAGE_ERR_INVALID_USERID,bg=qd.PEER_MESSAGE_ERR_INVALID_MESSAGE,Ll=qd.PEER_MESSAGE_ERR_USER_NOT_LOGGED_IN;qd.PEER_MESSAGE_ERR_INCOMPATIBLE_MESSAGE;var gs=se.QUERY_PEERS_ONLINE_STATUS_ERR_INVALID_ARGUMENT;se.QUERY_PEERS_ONLINE_STATUS_ERR_REJECTED;var VB=se.QUERY_PEERS_ONLINE_STATUS_ERR_TIMEOUT;se.QUERY_PEERS_ONLINE_STATUS_ERR_TOO_OFTEN;var WB=se.QUERY_PEERS_ONLINE_STATUS_ERR_USER_NOT_LOGGED_IN,Ml=rd.RENEW_TOKEN_ERR_FAILURE,XB=rd.RENEW_TOKEN_ERR_INVALID_ARGUMENT;rd.RENEW_TOKEN_ERR_REJECTED,rd.RENEW_TOKEN_ERR_TOO_OFTEN;var YB=rd.RENEW_TOKEN_ERR_TOKEN_EXPIRED,ZB=rd.RENEW_TOKEN_ERR_INVALID_TOKEN,hs=rd.RENEW_TOKEN_ERR_USER_NOT_LOGGED_IN,is=td.PEER_SUBSCRIPTION_STATUS_ERR_FAILURE,Qg=td.PEER_SUBSCRIPTION_STATUS_ERR_INVALID_ARGUMENT;td.PEER_SUBSCRIPTION_STATUS_ERR_REJECTED;var $B=td.PEER_SUBSCRIPTION_STATUS_ERR_TIMEOUT;td.PEER_SUBSCRIPTION_STATUS_ERR_TOO_OFTEN;var js=td.PEER_SUBSCRIPTION_STATUS_ERR_OVERFLOW,Nl=td.PEER_SUBSCRIPTION_STATUS_ERR_USER_NOT_LOGGED_IN;zf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_FAILURE,zf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TIMEOUT,zf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_TOO_OFTEN,zf.QUERY_PEERS_BY_SUBSCRIPTION_OPTION_ERR_USER_NOT_LOGGED_IN;var aC=function(e,o){var s;return rl(e,function(a,_,$){return!(s=o(a,_,$))}),!!s},ui=function(e,o,s){if(!Gb(s))return!1;var a=qa(o);return!!(a=="number"?ae(s)&&gl(o,s.length):a=="string"&&o in s)&&Gg(s[o],e)},Ol=function(e,o,s){var a=ub(e)?ur:aC;return s&&ui(e,o,s)&&(o=void 0),a(e,wf(o))},bC=function(e,o){var s=-1,a=ae(e)?Array(e.length):[];return rl(e,function(_,$,_e){a[++s]=o(_,$,_e)}),a},cC=function(e,o){var s=e.length;for(e.sort(o);s--;)e[s]=e[s].value;return e},dC=function(e,o,s){o=o.length?Je(o,function(_){return ub(_)?function($){return li($,_.length===1?_[0]:_)}:_}):[mi];var a=-1;return o=Je(o,ii(wf)),e=bC(e,function(_,$,_e){return{criteria:Je(o,function(_n){return _n(_)}),index:++a,value:_}}),cC(e,function(_,$){e:{for(var _e=-1,_n=_.criteria,_r=$.criteria,_s=_n.length,na=s.length;++_e<_s;){t:{var ba=_n[_e],_p=_r[_e];if(ba!==_p){var _f=ba!==void 0,_E=ba===null,_v=ba==ba,n_=Ke(ba),e_=_p!==void 0,t_=_p===null,o_=_p==_p,m_=Ke(_p);if(!t_&&!m_&&!n_&&ba>_p||n_&&e_&&o_&&!t_&&!m_||_E&&e_&&o_||!_f&&o_||!_v){ba=1;break t}if(!_E&&!n_&&!m_&&ba<_p||m_&&_f&&_v&&!_E&&!n_||t_&&_f&&_v||!e_&&_v||!o_){ba=-1;break t}}ba=0}if(ba){_=_e>=na?ba:ba*(s[_e]=="desc"?-1:1);break e}}_=_.index-$.index}return _})},ks=function(e,o){return sr(rr(e,o,mi),e+"")},ls=ks(function(e,o){if(e==null)return[];var s=o.length;return 1<s&&ui(e,o[0],o[1])?o=[]:2<s&&ui(o[0],o[1],o[2])&&(o=[o[0]]),dC(e,Si(o,1),[])}),ms=function(e){if(e.__esModule)return e;var o=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(s){var a=Object.getOwnPropertyDescriptor(e,s);Object.defineProperty(o,s,a.get?a:{enumerable:!0,get:function(){return e[s]}})}),o}(iB),ns=xb(function(e,o){Object.defineProperty(o,"__esModule",{value:!0});var s=[],a=function(_,$){return new WebSocket(_,$)};o.normalClosureMessage="Normal closure",o.default=function(_,$){var _e=($=$===void 0?{protocols:s,makeWebSocket:a}:$).protocols,_n=_e===void 0?s:_e,_r=($=$.makeWebSocket)===void 0?a:$;return new ms.Observable(function(_s){var na,ba=new ms.Subject,_p=_r(_,_n),_f=!1,_E=!1,_v=function(n_){if(na)throw _f=!0,n_=Error("Web socket message factory function called more than once"),_s.error(n_),n_;return na=n_.subscribe(function(e_){_p.send(e_)}),ba};return _p.onopen=function(){_E?(_f=!0,_p.close()):_s.next(_v)},_p.onmessage=function(n_){ba.next(n_.data)},_p.onerror=function(n_){_f=!0,_s.error(Error(n_.message))},_p.onclose=function(n_){_f||(_f=!0,_E?(_s.complete(),ba.complete()):_s.error(Error(n_.code===1e3?o.normalClosureMessage:n_.reason)))},function(){_E=!0,na&&na.unsubscribe(),_f||(_f=!0,_p.close())}})}});(function(e){e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")&&e.default})(ns);var ij=function(e,o,s){(s===void 0||Gg(e[o],s))&&(s!==void 0||o in e)||Ig(e,o,s)},hj=function(e,o){if((o!=="constructor"||typeof e[o]!="function")&&o!="__proto__")return e[o]},eC=function(e){return ks(function(o,s){var a=-1,_=s.length,$=1<_?s[_-1]:void 0,_e=2<_?s[2]:void 0;for($=3<e.length&&typeof $=="function"?(_--,$):void 0,_e&&ui(s[0],s[1],_e)&&($=3>_?void 0:$,_=1),o=Object(o);++a<_;)(_e=s[a])&&e(o,_e,a,$);return o})}(function(e,o,s,a){zn(e,o,s,a)}),fC=Math.floor,gC=Math.random,os=function(e,o){return e+fC(gC()*(o-e+1))},ps=function(e){var o=e.length;return o?e[os(0,o-1)]:void 0},hC=function(e,o){return Je(o,function(s){return e[s]})},zj=function(e){return e==null?[]:hC(e,Wd(e))},iC=function(e){return ps(zj(e))},On=function(e){return(ub(e)?ps:iC)(e)},Dn=[],En=function(e,o){return new WebSocket(e,o)},jC=Math.floor;ea({target:"Number",stat:!0},{isInteger:function(e){return!xa(e)&&isFinite(e)&&jC(e)===e}}),Sp("from",sk,rk);var kC=function(e,o){for(var s=Array(arguments.length-1),a=0,_=2,$=!0;_<arguments.length;)s[a++]=arguments[_++];return new Promise(function(_e,_n){s[a]=function(_r){if($)if($=!1,_r)_n(_r);else{for(var _s=Array(arguments.length-1),na=0;na<_s.length;)_s[na++]=arguments[na];_e.apply(null,_s)}};try{e.apply(o||null,s)}catch(_r){$&&($=!1,_n(_r))}})},lC=xb(function(e,o){o.length=function(_){var $=_.length;if(!$)return 0;for(var _e=0;1<--$%4&&_.charAt($)==="=";)++_e;return Math.ceil(3*_.length)/4-_e};var s=Array(64),a=Array(123);for(e=0;64>e;)a[s[e]=26>e?e+65:52>e?e+71:62>e?e-4:e-59|43]=e++;o.encode=function(_,$,_e){for(var _n,_r=null,_s=[],na=0,ba=0;$<_e;){var _p=_[$++];switch(ba){case 0:_s[na++]=s[_p>>2],_n=(3&_p)<<4,ba=1;break;case 1:_s[na++]=s[_n|_p>>4],_n=(15&_p)<<2,ba=2;break;case 2:_s[na++]=s[_n|_p>>6],_s[na++]=s[63&_p],ba=0}8191<na&&((_r||(_r=[])).push(String.fromCharCode.apply(String,_s)),na=0)}return ba&&(_s[na++]=s[_n],_s[na++]=61,ba===1&&(_s[na++]=61)),_r?(na&&_r.push(String.fromCharCode.apply(String,_s.slice(0,na))),_r.join("")):String.fromCharCode.apply(String,_s.slice(0,na))},o.decode=function(_,$,_e){for(var _n,_r=_e,_s=0,na=0;na<_.length;){var ba=_.charCodeAt(na++);if(ba===61&&1<_s)break;if((ba=a[ba])===void 0)throw Error("invalid encoding");switch(_s){case 0:_n=ba,_s=1;break;case 1:$[_e++]=_n<<2|(48&ba)>>4,_n=ba,_s=2;break;case 2:$[_e++]=(15&_n)<<4|(60&ba)>>2,_n=ba,_s=3;break;case 3:$[_e++]=(3&_n)<<6|ba,_s=0}}if(_s===1)throw Error("invalid encoding");return _e-_r},o.test=function(_){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(_)}});hh.prototype.on=function(e,o,s){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:o,ctx:s||this}),this},hh.prototype.off=function(e,o){if(e===void 0)this._listeners={};else if(o===void 0)this._listeners[e]=[];else{e=this._listeners[e];for(var s=0;s<e.length;)e[s].fn===o?e.splice(s,1):++s}return this},hh.prototype.emit=function(e){var o=this._listeners[e];if(o){for(var s=[],a=1;a<arguments.length;)s.push(arguments[a++]);for(a=0;a<o.length;)o[a].fn.apply(o[a++].ctx,s)}return this};var mC=Fn(Fn),nC=function(c){try{var b=eval("quire".replace(/^/,"re"))(c);if(b&&(b.length||Object.keys(b).length))return b}catch(e){}return null},oC=xb(function(e,o){o.length=function(s){for(var a,_=0,$=0;$<s.length;++$)128>(a=s.charCodeAt($))?_+=1:2048>a?_+=2:(64512&a)==55296&&(64512&s.charCodeAt($+1))==56320?(++$,_+=4):_+=3;return _},o.read=function(s,a,_){if(1>_-a)return"";for(var $,_e=null,_n=[],_r=0;a<_;)128>($=s[a++])?_n[_r++]=$:191<$&&224>$?_n[_r++]=(31&$)<<6|63&s[a++]:239<$&&365>$?($=((7&$)<<18|(63&s[a++])<<12|(63&s[a++])<<6|63&s[a++])-65536,_n[_r++]=55296+($>>10),_n[_r++]=56320+(1023&$)):_n[_r++]=(15&$)<<12|(63&s[a++])<<6|63&s[a++],8191<_r&&((_e||(_e=[])).push(String.fromCharCode.apply(String,_n)),_r=0);return _e?(_r&&_e.push(String.fromCharCode.apply(String,_n.slice(0,_r))),_e.join("")):String.fromCharCode.apply(String,_n.slice(0,_r))},o.write=function(s,a,_){for(var $,_e,_n=_,_r=0;_r<s.length;++_r)128>($=s.charCodeAt(_r))?a[_++]=$:(2048>$?a[_++]=$>>6|192:((64512&$)==55296&&(64512&(_e=s.charCodeAt(_r+1)))==56320?($=65536+((1023&$)<<10)+(1023&_e),++_r,a[_++]=$>>18|240,a[_++]=$>>12&63|128):a[_++]=$>>12|224,a[_++]=$>>6&63|128),a[_++]=63&$|128);return _-_n}}),pC=function(e,o,s){var a=s||8192,_=a>>>1,$=null,_e=a;return function(_n){return 1>_n||_n>_?e(_n):(_e+_n>a&&($=e(a),_e=0),_n=o.call($,_e,_e+=_n),7&_e&&(_e=1+(7|_e)),_n)}},te=vb.zero=new vb(0,0);te.toNumber=function(){return 0},te.zzEncode=te.zzDecode=function(){return this},te.length=function(){return 1};var qC=vb.zeroHash="\0\0\0\0\0\0\0\0";vb.fromNumber=function(e){if(e===0)return te;var o=0>e;o&&(e=-e);var s=e>>>0;return e=(e-s)/4294967296>>>0,o&&(e=~e>>>0,s=~s>>>0,4294967295<++s&&(s=0,4294967295<++e&&(e=0))),new vb(s,e)},vb.from=function(e){if(typeof e=="number")return vb.fromNumber(e);if(pa.isString(e)){if(!pa.Long)return vb.fromNumber(parseInt(e,10));e=pa.Long.fromString(e)}return e.low||e.high?new vb(e.low>>>0,e.high>>>0):te},vb.prototype.toNumber=function(e){if(!e&&this.hi>>>31){e=1+~this.lo>>>0;var o=~this.hi>>>0;return e||(o=o+1>>>0),-(e+4294967296*o)}return this.lo+4294967296*this.hi},vb.prototype.toLong=function(e){return pa.Long?new pa.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var Od=String.prototype.charCodeAt;vb.fromHash=function(e){return e===qC?te:new vb((Od.call(e,0)|Od.call(e,1)<<8|Od.call(e,2)<<16|Od.call(e,3)<<24)>>>0,(Od.call(e,4)|Od.call(e,5)<<8|Od.call(e,6)<<16|Od.call(e,7)<<24)>>>0)},vb.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},vb.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},vb.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},vb.prototype.length=function(){var e=this.lo,o=(this.lo>>>28|this.hi<<4)>>>0,s=this.hi>>>24;return s===0?o===0?16384>e?128>e?1:2:2097152>e?3:4:16384>o?128>o?5:6:2097152>o?7:8:128>s?9:10};var pa=xb(function(e,o){function s(_,$,_e){for(var _n=Object.keys($),_r=0;_r<_n.length;++_r)_[_n[_r]]!==void 0&&_e||(_[_n[_r]]=$[_n[_r]]);return _}function a(_){function $(_e,_n){if(!(this instanceof $))return new $(_e,_n);Object.defineProperty(this,"message",{get:function(){return _e}}),Error.captureStackTrace?Error.captureStackTrace(this,$):Object.defineProperty(this,"stack",{value:Error().stack||""}),_n&&s(this,_n)}return($.prototype=Object.create(Error.prototype)).constructor=$,Object.defineProperty($.prototype,"name",{get:function(){return _}}),$.prototype.toString=function(){return this.name+": "+this.message},$}o.asPromise=kC,o.base64=lC,o.EventEmitter=hh,o.float=mC,o.inquire=nC,o.utf8=oC,o.pool=pC,o.LongBits=vb,o.isNode=!!(Ya!==void 0&&Ya&&Ya.process&&Ya.process.versions&&Ya.process.versions.node),o.global=o.isNode&&Ya||typeof window<"u"&&window||typeof self<"u"&&self||Ya,o.emptyArray=Object.freeze?Object.freeze([]):[],o.emptyObject=Object.freeze?Object.freeze({}):{},o.isInteger=Number.isInteger||function(_){return typeof _=="number"&&isFinite(_)&&Math.floor(_)===_},o.isString=function(_){return typeof _=="string"||_ instanceof String},o.isObject=function(_){return _&&qa(_)==="object"},o.isset=o.isSet=function(_,$){var _e=_[$];return!(_e==null||!_.hasOwnProperty($))&&(qa(_e)!=="object"||0<(Array.isArray(_e)?_e.length:Object.keys(_e).length))},o.Buffer=function(){try{var _=o.inquire("buffer").Buffer;return _.prototype.utf8Write?_:null}catch{return null}}(),o._Buffer_from=null,o._Buffer_allocUnsafe=null,o.newBuffer=function(_){return typeof _=="number"?o.Buffer?o._Buffer_allocUnsafe(_):new o.Array(_):o.Buffer?o._Buffer_from(_):typeof Uint8Array>"u"?_:new Uint8Array(_)},o.Array=typeof Uint8Array<"u"?Uint8Array:Array,o.Long=o.global.dcodeIO&&o.global.dcodeIO.Long||o.global.Long||o.inquire("long"),o.key2Re=/^true|false|0|1$/,o.key32Re=/^-?(?:0|[1-9][0-9]*)$/,o.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,o.longToHash=function(_){return _?o.LongBits.from(_).toHash():o.LongBits.zeroHash},o.longFromHash=function(_,$){return _=o.LongBits.fromHash(_),o.Long?o.Long.fromBits(_.lo,_.hi,$):_.toNumber(!!$)},o.merge=s,o.lcFirst=function(_){return _.charAt(0).toLowerCase()+_.substring(1)},o.newError=a,o.ProtocolError=a("ProtocolError"),o.oneOfGetter=function(_){for(var $={},_e=0;_e<_.length;++_e)$[_[_e]]=1;return function(){for(var _n=Object.keys(this),_r=_n.length-1;-1<_r;--_r)if($[_n[_r]]===1&&this[_n[_r]]!==void 0&&this[_n[_r]]!==null)return _n[_r]}},o.oneOfSetter=function(_){return function($){for(var _e=0;_e<_.length;++_e)_[_e]!==$&&delete this[_[_e]]}},o.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},o._configure=function(){var _=o.Buffer;_?(o._Buffer_from=_.from!==Uint8Array.from&&_.from||function($,_e){return new _($,_e)},o._Buffer_allocUnsafe=_.allocUnsafe||function($){return new _($)}):o._Buffer_from=o._Buffer_allocUnsafe=null}}),qj=Aa,Pl,vi=pa.LongBits,qs=pa.base64,rs=pa.utf8,ss=function(){return pa.Buffer?function(){return(Aa.create=function(){return new Pl})()}:function(){return new Aa}};Aa.create=ss(),Aa.alloc=function(e){return new pa.Array(e)},pa.Array!==Array&&(Aa.alloc=pa.pool(Aa.alloc,pa.Array.prototype.subarray)),Aa.prototype._push=function(e,o,s){return this.tail=this.tail.next=new Wf(e,o,s),this.len+=o,this},nj.prototype=Object.create(Wf.prototype),nj.prototype.fn=function(e,o,s){for(;127<e;)o[s++]=127&e|128,e>>>=7;o[s]=e},Aa.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new nj(128>(e>>>=0)?1:16384>e?2:2097152>e?3:268435456>e?4:5,e)).len,this},Aa.prototype.int32=function(e){return 0>e?this._push(oj,10,vi.fromNumber(e)):this.uint32(e)},Aa.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Aa.prototype.uint64=function(e){return e=vi.from(e),this._push(oj,e.length(),e)},Aa.prototype.int64=Aa.prototype.uint64,Aa.prototype.sint64=function(e){return e=vi.from(e).zzEncode(),this._push(oj,e.length(),e)},Aa.prototype.bool=function(e){return this._push(mj,1,e?1:0)},Aa.prototype.fixed32=function(e){return this._push(pj,4,e>>>0)},Aa.prototype.sfixed32=Aa.prototype.fixed32,Aa.prototype.fixed64=function(e){return e=vi.from(e),this._push(pj,4,e.lo)._push(pj,4,e.hi)},Aa.prototype.sfixed64=Aa.prototype.fixed64,Aa.prototype.float=function(e){return this._push(pa.float.writeFloatLE,4,e)},Aa.prototype.double=function(e){return this._push(pa.float.writeDoubleLE,8,e)};var rC=pa.Array.prototype.set?function(e,o,s){o.set(e,s)}:function(e,o,s){for(var a=0;a<e.length;++a)o[s+a]=e[a]};Aa.prototype.bytes=function(e){var o=e.length>>>0;if(!o)return this._push(mj,1,0);if(pa.isString(e)){var s=Aa.alloc(o=qs.length(e));qs.decode(e,s,0),e=s}return this.uint32(o)._push(rC,o,e)},Aa.prototype.string=function(e){var o=rs.length(e);return o?this.uint32(o)._push(rs.write,o,e):this._push(mj,1,0)},Aa.prototype.fork=function(){return this.states=new Cv(this),this.head=this.tail=new Wf(lj,0,0),this.len=0,this},Aa.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Wf(lj,0,0),this.len=0),this},Aa.prototype.ldelim=function(){var e=this.head,o=this.tail,s=this.len;return this.reset().uint32(s),s&&(this.tail.next=e.next,this.tail=o,this.len+=s),this},Aa.prototype.finish=function(){for(var e=this.head.next,o=this.constructor.alloc(this.len),s=0;e;)e.fn(e.val,o,s),s+=e.len,e=e.next;return o},Aa._configure=function(e){Pl=e,Aa.create=ss(),Pl._configure()},(Lc.prototype=Object.create(qj.prototype)).constructor=Lc,Lc._configure=function(){Lc.alloc=pa._Buffer_allocUnsafe,Lc.writeBytesBuffer=pa.Buffer&&pa.Buffer.prototype instanceof Uint8Array&&pa.Buffer.prototype.set.name==="set"?function(e,o,s){o.set(e,s)}:function(e,o,s){if(e.copy)e.copy(o,s,0,e.length);else for(var a=0;a<e.length;)o[s++]=e[a++]}},Lc.prototype.bytes=function(e){pa.isString(e)&&(e=pa._Buffer_from(e,"base64"));var o=e.length>>>0;return this.uint32(o),o&&this._push(Lc.writeBytesBuffer,o,e),this},Lc.prototype.string=function(e){var o=pa.Buffer.byteLength(e);return this.uint32(o),o&&this._push(Dv,o,e),this},Lc._configure();var sj=ib,Ql,Kn=pa.LongBits,sC=pa.utf8,ts=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ib(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ib(e);throw Error("illegal buffer")},us=function(){return pa.Buffer?function(e){return(ib.create=function(o){return pa.Buffer.isBuffer(o)?new Ql(o):ts(o)})(e)}:ts};ib.create=us(),ib.prototype._slice=pa.Array.prototype.subarray||pa.Array.prototype.slice,ib.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,128>this.buf[this.pos++]||(e=(e|(127&this.buf[this.pos])<<7)>>>0,128>this.buf[this.pos++])||(e=(e|(127&this.buf[this.pos])<<14)>>>0,128>this.buf[this.pos++])||(e=(e|(127&this.buf[this.pos])<<21)>>>0,128>this.buf[this.pos++])||(e=(e|(15&this.buf[this.pos])<<28)>>>0,128>this.buf[this.pos++]))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,wc(this,10);return e}}(),ib.prototype.int32=function(){return 0|this.uint32()},ib.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},ib.prototype.bool=function(){return this.uint32()!==0},ib.prototype.fixed32=function(){if(this.pos+4>this.len)throw wc(this,4);return ih(this.buf,this.pos+=4)},ib.prototype.sfixed32=function(){if(this.pos+4>this.len)throw wc(this,4);return 0|ih(this.buf,this.pos+=4)},ib.prototype.float=function(){if(this.pos+4>this.len)throw wc(this,4);var e=pa.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},ib.prototype.double=function(){if(this.pos+8>this.len)throw wc(this,4);var e=pa.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},ib.prototype.bytes=function(){var e=this.uint32(),o=this.pos,s=this.pos+e;if(s>this.len)throw wc(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(o,s):o===s?new this.buf.constructor(0):this._slice.call(this.buf,o,s)},ib.prototype.string=function(){var e=this.bytes();return sC.read(e,0,e.length)},ib.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw wc(this,e);this.pos+=e}else do if(this.pos>=this.len)throw wc(this);while(128&this.buf[this.pos++]);return this},ib.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=7&this.uint32())!=4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},ib._configure=function(e){Ql=e,ib.create=us(),Ql._configure();var o=pa.Long?"toLong":"toNumber";pa.merge(ib.prototype,{int64:function(){return rj.call(this)[o](!1)},uint64:function(){return rj.call(this)[o](!0)},sint64:function(){return rj.call(this).zzDecode()[o](!1)},fixed64:function(){return Ln.call(this)[o](!0)},sfixed64:function(){return Ln.call(this)[o](!1)}})},(be.prototype=Object.create(sj.prototype)).constructor=be,be._configure=function(){pa.Buffer&&(be.prototype._slice=pa.Buffer.prototype.slice)},be.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},be._configure(),(Xf.prototype=Object.create(pa.EventEmitter.prototype)).constructor=Xf,Xf.prototype.rpcCall=function e(o,s,a,_,$){if(!_)throw TypeError("request must be specified");var _e=this;if(!$)return pa.asPromise(e,_e,o,s,a,_);if(_e.rpcImpl)try{return _e.rpcImpl(o,s[_e.requestDelimited?"encodeDelimited":"encode"](_).finish(),function(_n,_r){if(_n)return _e.emit("error",_n,o),$(_n);if(_r!==null){if(!(_r instanceof a))try{_r=a[_e.responseDelimited?"decodeDelimited":"decode"](_r)}catch(_s){return _e.emit("error",_s,o),$(_s)}return _e.emit("data",_r,o),$(null,_r)}_e.end(!0)})}catch(_n){_e.emit("error",_n,o),setTimeout(function(){$(_n)},0)}else setTimeout(function(){$(Error("already ended"))},0)},Xf.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var tC=xb(function(e,o){o.Service=Xf}),uC={},Gc=xb(function(e,o){function s(){a.util._configure(),a.Writer._configure(a.BufferWriter),a.Reader._configure(a.BufferReader)}var a=o;a.build="minimal",a.Writer=qj,a.BufferWriter=Lc,a.Reader=sj,a.BufferReader=be,a.util=pa,a.rpc=tC,a.roots=uC,a.configure=s,s()});Gc.util.Long=P,Gc.configure();var M=Gc.Reader,ia=Gc.Writer,D=Gc.util,I=Gc.roots.default||(Gc.roots.default={}),vC=I.URI=function(){var e={},o=Object.create(e);return o[e[0]="Unknown"]=0,o[e[1]="PingUri"]=1,o[e[2]="PongUri"]=2,o[e[11]="UserJoinUri"]=11,o[e[12]="UserRespUri"]=12,o[e[15]="UserTicketNearlyExpireUri"]=15,o[e[16]="UserRenewTokenReqUri"]=16,o[e[17]="UserRenewTokenRespUri"]=17,o[e[21]="UserQuitUri"]=21,o[e[22]="UserDropUri"]=22,o[e[31]="GroupEnterUri"]=31,o[e[32]="GroupLeaveUri"]=32,o[e[33]="GroupReplyUri"]=33,o[e[35]="GroupDropUri"]=35,o[e[36]="GroupEnterNoticeUri"]=36,o[e[37]="GroupLeaveNoticeUri"]=37,o[e[38]="GroupEventNoticeUri"]=38,o[e[39]="GroupCountNoticeUri"]=39,o[e[41]="UserStatusListUri"]=41,o[e[42]="UserStatusResultUri"]=42,o[e[51]="GroupStatusListUri"]=51,o[e[52]="GroupStatusResultUri"]=52,o[e[55]="GroupAllUsersListUri"]=55,o[e[56]="GroupAllUsersResultUri"]=56,o[e[100]="MessageUri"]=100,o[e[101]="AckUri"]=101,o[e[201]="UserJoinNoticeUri"]=201,o[e[202]="UserQuitNoticeUri"]=202,o[e[203]="UserWaitNoticeUri"]=203,o[e[301]="UserAttributeGetUri"]=301,o[e[302]="UserAttributeRetUri"]=302,o[e[303]="UserAttributeSetUri"]=303,o[e[304]="UserAttributeModUri"]=304,o[e[305]="UserAttributeDelUri"]=305,o[e[307]="UserAttributeRspUri"]=307,o[e[308]="UserAttributeErrUri"]=308,o[e[311]="UserAttributeKeysGetUri"]=311,o[e[312]="UserAttributeKeysRetUri"]=312,o[e[351]="GroupAttributeGetUri"]=351,o[e[352]="GroupAttributeRetUri"]=352,o[e[353]="GroupAttributeSetUri"]=353,o[e[354]="GroupAttributeModUri"]=354,o[e[355]="GroupAttributeDelUri"]=355,o[e[356]="GroupAttributeAltUri"]=356,o[e[357]="GroupAttributeRspUri"]=357,o[e[358]="GroupAttributeErrUri"]=358,o[e[361]="GroupAttributeKeysGetUri"]=361,o[e[362]="GroupAttributeKeysRetUri"]=362,o[e[401]="SubscribeUserStatusUri"]=401,o[e[402]="UnsubscribeUserStatusUri"]=402,o[e[499]="SubscribeResponseUri"]=499,o}(),wi=I.Wrapper=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.uri=0,e.prototype.data=D.newBuffer([]),e.encode=function(o,s){return s||(s=ia.create()),o.uri!=null&&Object.hasOwnProperty.call(o,"uri")&&s.uint32(8).int32(o.uri),o.data!=null&&Object.hasOwnProperty.call(o,"data")&&s.uint32(18).bytes(o.data),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.Wrapper;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.uri=o.int32();break;case 2:a.data=o.bytes();break;default:o.skipType(7&_)}}return a},e}(),wC=I.Ping=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.ms=D.Long?D.Long.fromBits(0,0,!0):0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.ms!=null&&Object.hasOwnProperty.call(o,"ms")&&s.uint32(16).uint64(o.ms),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.Ping;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.ms=o.uint64();break;default:o.skipType(7&_)}}return a},e}(),xC=I.Pong=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.ms=D.Long?D.Long.fromBits(0,0,!0):0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.ms!=null&&Object.hasOwnProperty.call(o,"ms")&&s.uint32(16).uint64(o.ms),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.Pong;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.ms=o.uint64();break;default:o.skipType(7&_)}}return a},e}(),yC=I.UserJoin=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.opt=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.instance=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.ticket="",e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.opt!=null&&Object.hasOwnProperty.call(o,"opt")&&s.uint32(16).uint64(o.opt),o.instance!=null&&Object.hasOwnProperty.call(o,"instance")&&s.uint32(24).uint64(o.instance),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(34).string(o.account),o.ticket!=null&&Object.hasOwnProperty.call(o,"ticket")&&s.uint32(42).string(o.ticket),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserJoin;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.opt=o.uint64();break;case 3:a.instance=o.uint64();break;case 4:a.account=o.string();break;case 5:a.ticket=o.string();break;default:o.skipType(7&_)}}return a},e}(),zC=I.UserResp=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.code=0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(18).string(o.account),o.code!=null&&Object.hasOwnProperty.call(o,"code")&&s.uint32(24).uint32(o.code),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserResp;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.account=o.string();break;case 3:a.code=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),AC=I.UserQuit=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.encode=function(o,s){return s||(s=ia.create()),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserQuit;o.pos<s;){var _=o.uint32();o.skipType(7&_)}return a},e}(),BC=I.UserDrop=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.code=0,e.encode=function(o,s){return s||(s=ia.create()),o.code!=null&&Object.hasOwnProperty.call(o,"code")&&s.uint32(8).uint32(o.code),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserDrop;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.code=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),CC=I.UserTicketNearlyExpire=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.expireTs=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.ticket="",e.encode=function(o,s){return s||(s=ia.create()),o.expireTs!=null&&Object.hasOwnProperty.call(o,"expireTs")&&s.uint32(8).uint64(o.expireTs),o.ticket!=null&&Object.hasOwnProperty.call(o,"ticket")&&s.uint32(18).string(o.ticket),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserTicketNearlyExpire;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.expireTs=o.uint64();break;case 2:a.ticket=o.string();break;default:o.skipType(7&_)}}return a},e}(),DC=I.UserRenewTokenReq=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.instance=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.ticket="",e.encode=function(o,s){return s||(s=ia.create()),o.instance!=null&&Object.hasOwnProperty.call(o,"instance")&&s.uint32(8).uint64(o.instance),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(16).uint64(o.seq),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(26).string(o.account),o.ticket!=null&&Object.hasOwnProperty.call(o,"ticket")&&s.uint32(34).string(o.ticket),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserRenewTokenReq;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.instance=o.uint64();break;case 2:a.seq=o.uint64();break;case 3:a.account=o.string();break;case 4:a.ticket=o.string();break;default:o.skipType(7&_)}}return a},e}(),EC=I.UserRenewTokenResp=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.code!=null&&Object.hasOwnProperty.call(o,"code")&&s.uint32(16).uint32(o.code),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserRenewTokenResp;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.code=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),FC=I.GroupEnter=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.account="",e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(18).string(o.account),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupEnter;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.account=o.string();break;default:o.skipType(7&_)}}return a},e}(),GC=I.GroupLeave=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.account="",e.encode=function(o,s){return s||(s=ia.create()),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(10).string(o.account),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupLeave;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.account=o.string();break;default:o.skipType(7&_)}}return a},e}(),HC=I.GroupReply=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.code=0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(18).string(o.account),o.code!=null&&Object.hasOwnProperty.call(o,"code")&&s.uint32(24).uint32(o.code),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupReply;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.account=o.string();break;case 3:a.code=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),vs=I.GroupLeaveNotice=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.user="",e.prototype.group="",e.prototype.instance=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.size=0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.user!=null&&Object.hasOwnProperty.call(o,"user")&&s.uint32(18).string(o.user),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&s.uint32(26).string(o.group),o.instance!=null&&Object.hasOwnProperty.call(o,"instance")&&s.uint32(32).uint64(o.instance),o.size!=null&&Object.hasOwnProperty.call(o,"size")&&s.uint32(40).uint32(o.size),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupLeaveNotice;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.user=o.string();break;case 3:a.group=o.string();break;case 4:a.instance=o.uint64();break;case 5:a.size=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),ws=I.GroupEnterNotice=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.user="",e.prototype.group="",e.prototype.instance=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.size=0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.user!=null&&Object.hasOwnProperty.call(o,"user")&&s.uint32(18).string(o.user),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&s.uint32(26).string(o.group),o.instance!=null&&Object.hasOwnProperty.call(o,"instance")&&s.uint32(32).uint64(o.instance),o.size!=null&&Object.hasOwnProperty.call(o,"size")&&s.uint32(40).uint32(o.size),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupEnterNotice;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.user=o.string();break;case 3:a.group=o.string();break;case 4:a.instance=o.uint64();break;case 5:a.size=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),xs=I.Message=function(){function e(o){if(this.MiscMap={},o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.instance=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.dialogue=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.sequence=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.options=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.src="",e.prototype.dst="",e.prototype.payload=D.newBuffer([]),e.prototype.MiscMap=D.emptyObject,e.prototype.ms=D.Long?D.Long.fromBits(0,0,!0):0,e.encode=function(o,s){if(s||(s=ia.create()),o.instance!=null&&Object.hasOwnProperty.call(o,"instance")&&s.uint32(8).uint64(o.instance),o.dialogue!=null&&Object.hasOwnProperty.call(o,"dialogue")&&s.uint32(16).uint64(o.dialogue),o.sequence!=null&&Object.hasOwnProperty.call(o,"sequence")&&s.uint32(24).uint64(o.sequence),o.options!=null&&Object.hasOwnProperty.call(o,"options")&&s.uint32(32).uint64(o.options),o.src!=null&&Object.hasOwnProperty.call(o,"src")&&s.uint32(42).string(o.src),o.dst!=null&&Object.hasOwnProperty.call(o,"dst")&&s.uint32(50).string(o.dst),o.payload!=null&&Object.hasOwnProperty.call(o,"payload")&&s.uint32(58).bytes(o.payload),o.MiscMap!=null&&Object.hasOwnProperty.call(o,"MiscMap"))for(var a=Object.keys(o.MiscMap),_=0;_<a.length;++_)s.uint32(66).fork().uint32(10).string(a[_]).uint32(18).bytes(o.MiscMap[a[_]]).ldelim();return o.ms!=null&&Object.hasOwnProperty.call(o,"ms")&&s.uint32(72).uint64(o.ms),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a,_,$=new I.Message;o.pos<s;)switch(a=o.uint32(),a>>>3){case 1:$.instance=o.uint64();break;case 2:$.dialogue=o.uint64();break;case 3:$.sequence=o.uint64();break;case 4:$.options=o.uint64();break;case 5:$.src=o.string();break;case 6:$.dst=o.string();break;case 7:$.payload=o.bytes();break;case 8:$.MiscMap===D.emptyObject&&($.MiscMap={});var _e=o.uint32()+o.pos;for(a="",_=[];o.pos<_e;){var _n=o.uint32();switch(_n>>>3){case 1:a=o.string();break;case 2:_=o.bytes();break;default:o.skipType(7&_n)}}$.MiscMap[a]=_;break;case 9:$.ms=o.uint64();break;default:o.skipType(7&a)}return $},e}(),ys=I.Ack=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.instance=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.dialogue=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.sequence=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(o,s){return s||(s=ia.create()),o.instance!=null&&Object.hasOwnProperty.call(o,"instance")&&s.uint32(8).uint64(o.instance),o.dialogue!=null&&Object.hasOwnProperty.call(o,"dialogue")&&s.uint32(16).uint64(o.dialogue),o.sequence!=null&&Object.hasOwnProperty.call(o,"sequence")&&s.uint32(24).uint64(o.sequence),o.code!=null&&Object.hasOwnProperty.call(o,"code")&&s.uint32(32).uint32(o.code),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.Ack;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.instance=o.uint64();break;case 2:a.dialogue=o.uint64();break;case 3:a.sequence=o.uint64();break;case 4:a.code=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),IC=I.GroupDrop=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.account="",e.prototype.code=0,e.encode=function(o,s){return s||(s=ia.create()),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(10).string(o.account),o.code!=null&&Object.hasOwnProperty.call(o,"code")&&s.uint32(16).uint32(o.code),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupDrop;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.account=o.string();break;case 2:a.code=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),JC=I.GroupAllUsersList=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.pageSize=0,e.prototype.pageNumber=0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&s.uint32(18).string(o.group),o.pageSize!=null&&Object.hasOwnProperty.call(o,"pageSize")&&s.uint32(24).uint32(o.pageSize),o.pageNumber!=null&&Object.hasOwnProperty.call(o,"pageNumber")&&s.uint32(32).uint32(o.pageNumber),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAllUsersList;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.group=o.string();break;case 3:a.pageSize=o.uint32();break;case 4:a.pageNumber=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),KC=I.GroupAllUsersResult=function(){function e(o){if(this.memberInfos=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.totalSize=0,e.prototype.pageSize=0,e.prototype.pageNumber=0,e.prototype.memberInfos=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&s.uint32(18).string(o.group),o.totalSize!=null&&Object.hasOwnProperty.call(o,"totalSize")&&s.uint32(24).uint32(o.totalSize),o.pageSize!=null&&Object.hasOwnProperty.call(o,"pageSize")&&s.uint32(32).uint32(o.pageSize),o.pageNumber!=null&&Object.hasOwnProperty.call(o,"pageNumber")&&s.uint32(40).uint32(o.pageNumber),o.memberInfos!=null&&o.memberInfos.length)for(var a=0;a<o.memberInfos.length;++a)I.GroupAllUsersResult.MemberInfo.encode(o.memberInfos[a],s.uint32(50).fork()).ldelim();return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAllUsersResult;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.group=o.string();break;case 3:a.totalSize=o.uint32();break;case 4:a.pageSize=o.uint32();break;case 5:a.pageNumber=o.uint32();break;case 6:a.memberInfos&&a.memberInfos.length||(a.memberInfos=[]),a.memberInfos.push(I.GroupAllUsersResult.MemberInfo.decode(o,o.uint32()));break;default:o.skipType(7&_)}}return a},e.MemberInfo=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.account="",o.prototype.ts=0,o.encode=function(s,a){return a||(a=ia.create()),s.account!=null&&Object.hasOwnProperty.call(s,"account")&&a.uint32(10).string(s.account),s.ts!=null&&Object.hasOwnProperty.call(s,"ts")&&a.uint32(16).uint32(s.ts),a},o.decode=function(s,a){s instanceof M||(s=M.create(s)),a=a===void 0?s.len:s.pos+a;for(var _=new I.GroupAllUsersResult.MemberInfo;s.pos<a;){var $=s.uint32();switch($>>>3){case 1:_.account=s.string();break;case 2:_.ts=s.uint32();break;default:s.skipType(7&$)}}return _},o}(),e}(),LC=I.UserStatusList=function(){function e(o){if(this.users=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.users=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.users!=null&&o.users.length)for(var a=0;a<o.users.length;++a)s.uint32(18).string(o.users[a]);return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserStatusList;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.users&&a.users.length||(a.users=[]),a.users.push(o.string());break;default:o.skipType(7&_)}}return a},e}(),MC=I.UserStatusResult=function(){function e(o){if(this.userInfos=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.userInfos=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.userInfos!=null&&o.userInfos.length)for(var a=0;a<o.userInfos.length;++a)I.UserStatusResult.UserStatusInfo.encode(o.userInfos[a],s.uint32(18).fork()).ldelim();return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserStatusResult;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.userInfos&&a.userInfos.length||(a.userInfos=[]),a.userInfos.push(I.UserStatusResult.UserStatusInfo.decode(o,o.uint32()));break;default:o.skipType(7&_)}}return a},e.UserStatusInfo=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.account="",o.prototype.ts=0,o.encode=function(s,a){return a||(a=ia.create()),s.account!=null&&Object.hasOwnProperty.call(s,"account")&&a.uint32(10).string(s.account),s.ts!=null&&Object.hasOwnProperty.call(s,"ts")&&a.uint32(16).uint32(s.ts),a},o.decode=function(s,a){s instanceof M||(s=M.create(s)),a=a===void 0?s.len:s.pos+a;for(var _=new I.UserStatusResult.UserStatusInfo;s.pos<a;){var $=s.uint32();switch($>>>3){case 1:_.account=s.string();break;case 2:_.ts=s.uint32();break;default:s.skipType(7&$)}}return _},o}(),e}(),NC=I.UserAttributeGet=function(){function e(o){if(this.attributes=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributes=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(18).string(o.account),o.attributes!=null&&o.attributes.length)for(var a=0;a<o.attributes.length;++a)s.uint32(26).string(o.attributes[a]);return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserAttributeGet;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.account=o.string();break;case 3:a.attributes&&a.attributes.length||(a.attributes=[]),a.attributes.push(o.string());break;default:o.skipType(7&_)}}return a},e}(),OC=I.UserAttributeRet=function(){function e(o){if(this.attributeInfos=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.attributeInfos=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.attributeInfos!=null&&o.attributeInfos.length)for(var a=0;a<o.attributeInfos.length;++a)I.UserAttributeRet.AttributeInfo.encode(o.attributeInfos[a],s.uint32(18).fork()).ldelim();return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserAttributeRet;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.attributeInfos&&a.attributeInfos.length||(a.attributeInfos=[]),a.attributeInfos.push(I.UserAttributeRet.AttributeInfo.decode(o,o.uint32()));break;default:o.skipType(7&_)}}return a},e.AttributeInfo=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.key="",o.prototype.value="",o.encode=function(s,a){return a||(a=ia.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&a.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&a.uint32(18).string(s.value),a},o.decode=function(s,a){s instanceof M||(s=M.create(s)),a=a===void 0?s.len:s.pos+a;for(var _=new I.UserAttributeRet.AttributeInfo;s.pos<a;){var $=s.uint32();switch($>>>3){case 1:_.key=s.string();break;case 2:_.value=s.string();break;default:s.skipType(7&$)}}return _},o}(),e}(),PC=I.UserAttributeSet=function(){function e(o){if(this.attributeInfos=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributeInfos=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(18).string(o.account),o.attributeInfos!=null&&o.attributeInfos.length)for(var a=0;a<o.attributeInfos.length;++a)I.UserAttributeSet.AttributeInfo.encode(o.attributeInfos[a],s.uint32(26).fork()).ldelim();return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserAttributeSet;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.account=o.string();break;case 3:a.attributeInfos&&a.attributeInfos.length||(a.attributeInfos=[]),a.attributeInfos.push(I.UserAttributeSet.AttributeInfo.decode(o,o.uint32()));break;default:o.skipType(7&_)}}return a},e.AttributeInfo=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.key="",o.prototype.value="",o.encode=function(s,a){return a||(a=ia.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&a.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&a.uint32(18).string(s.value),a},o.decode=function(s,a){s instanceof M||(s=M.create(s)),a=a===void 0?s.len:s.pos+a;for(var _=new I.UserAttributeSet.AttributeInfo;s.pos<a;){var $=s.uint32();switch($>>>3){case 1:_.key=s.string();break;case 2:_.value=s.string();break;default:s.skipType(7&$)}}return _},o}(),e}(),QC=I.UserAttributeMod=function(){function e(o){if(this.attributeInfos=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributeInfos=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(18).string(o.account),o.attributeInfos!=null&&o.attributeInfos.length)for(var a=0;a<o.attributeInfos.length;++a)I.UserAttributeMod.AttributeInfo.encode(o.attributeInfos[a],s.uint32(26).fork()).ldelim();return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserAttributeMod;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.account=o.string();break;case 3:a.attributeInfos&&a.attributeInfos.length||(a.attributeInfos=[]),a.attributeInfos.push(I.UserAttributeMod.AttributeInfo.decode(o,o.uint32()));break;default:o.skipType(7&_)}}return a},e.AttributeInfo=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.key="",o.prototype.value="",o.encode=function(s,a){return a||(a=ia.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&a.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&a.uint32(18).string(s.value),a},o.decode=function(s,a){s instanceof M||(s=M.create(s)),a=a===void 0?s.len:s.pos+a;for(var _=new I.UserAttributeMod.AttributeInfo;s.pos<a;){var $=s.uint32();switch($>>>3){case 1:_.key=s.string();break;case 2:_.value=s.string();break;default:s.skipType(7&$)}}return _},o}(),e}(),RC=I.UserAttributeDel=function(){function e(o){if(this.attributes=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.account="",e.prototype.attributes=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(18).string(o.account),o.attributes!=null&&o.attributes.length)for(var a=0;a<o.attributes.length;++a)s.uint32(26).string(o.attributes[a]);return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserAttributeDel;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.account=o.string();break;case 3:a.attributes&&a.attributes.length||(a.attributes=[]),a.attributes.push(o.string());break;default:o.skipType(7&_)}}return a},e}(),SC=I.UserAttributeErr=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.code!=null&&Object.hasOwnProperty.call(o,"code")&&s.uint32(16).uint32(o.code),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserAttributeErr;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.code=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),TC=I.UserAttributeKeysGet=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.account="",e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.account!=null&&Object.hasOwnProperty.call(o,"account")&&s.uint32(18).string(o.account),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserAttributeKeysGet;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.account=o.string();break;default:o.skipType(7&_)}}return a},e}(),UC=I.UserAttributeKeysRet=function(){function e(o){if(this.keys=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.keys=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.keys!=null&&o.keys.length)for(var a=0;a<o.keys.length;++a)s.uint32(18).string(o.keys[a]);return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserAttributeKeysRet;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.keys&&a.keys.length||(a.keys=[]),a.keys.push(o.string());break;default:o.skipType(7&_)}}return a},e}(),VC=I.UserAttributeRsp=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserAttributeRsp;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;default:o.skipType(7&_)}}return a},e}(),WC=I.GroupStatusList=function(){function e(o){if(this.groups=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.groups=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.groups!=null&&o.groups.length)for(var a=0;a<o.groups.length;++a)s.uint32(18).string(o.groups[a]);return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupStatusList;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.groups&&a.groups.length||(a.groups=[]),a.groups.push(o.string());break;default:o.skipType(7&_)}}return a},e}(),XC=I.GroupStatusResult=function(){function e(o){if(this.groupInfos=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.groupInfos=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.groupInfos!=null&&o.groupInfos.length)for(var a=0;a<o.groupInfos.length;++a)I.GroupStatusResult.GroupInfo.encode(o.groupInfos[a],s.uint32(18).fork()).ldelim();return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupStatusResult;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.groupInfos&&a.groupInfos.length||(a.groupInfos=[]),a.groupInfos.push(I.GroupStatusResult.GroupInfo.decode(o,o.uint32()));break;default:o.skipType(7&_)}}return a},e.GroupInfo=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.group="",o.prototype.memberCount=0,o.encode=function(s,a){return a||(a=ia.create()),s.group!=null&&Object.hasOwnProperty.call(s,"group")&&a.uint32(10).string(s.group),s.memberCount!=null&&Object.hasOwnProperty.call(s,"memberCount")&&a.uint32(16).uint32(s.memberCount),a},o.decode=function(s,a){s instanceof M||(s=M.create(s)),a=a===void 0?s.len:s.pos+a;for(var _=new I.GroupStatusResult.GroupInfo;s.pos<a;){var $=s.uint32();switch($>>>3){case 1:_.group=s.string();break;case 2:_.memberCount=s.uint32();break;default:s.skipType(7&$)}}return _},o}(),e}(),YC=I.GroupCountNotice=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.instance=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.size=0,e.encode=function(o,s){return s||(s=ia.create()),o.instance!=null&&Object.hasOwnProperty.call(o,"instance")&&s.uint32(8).uint64(o.instance),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(16).uint64(o.seq),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&s.uint32(26).string(o.group),o.size!=null&&Object.hasOwnProperty.call(o,"size")&&s.uint32(32).uint32(o.size),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupCountNotice;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.instance=o.uint64();break;case 2:a.seq=o.uint64();break;case 3:a.group=o.string();break;case 4:a.size=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),ZC=I.GroupAttributeGet=function(){function e(o){if(this.attributes=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.attributes=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&s.uint32(18).string(o.group),o.attributes!=null&&o.attributes.length)for(var a=0;a<o.attributes.length;++a)s.uint32(26).string(o.attributes[a]);return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAttributeGet;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.group=o.string();break;case 3:a.attributes&&a.attributes.length||(a.attributes=[]),a.attributes.push(o.string());break;default:o.skipType(7&_)}}return a},e}(),$C=I.GroupAttributeRet=function(){function e(o){if(this.attributeMaps=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.attributeMaps=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.attributeMaps!=null&&o.attributeMaps.length)for(var a=0;a<o.attributeMaps.length;++a)I.GroupAttributeRet.AttributeMap.encode(o.attributeMaps[a],s.uint32(18).fork()).ldelim();return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAttributeRet;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.attributeMaps&&a.attributeMaps.length||(a.attributeMaps=[]),a.attributeMaps.push(I.GroupAttributeRet.AttributeMap.decode(o,o.uint32()));break;default:o.skipType(7&_)}}return a},e.AttributeMap=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.key="",o.prototype.value="",o.prototype.origin="",o.prototype.ms=D.Long?D.Long.fromBits(0,0,!0):0,o.encode=function(s,a){return a||(a=ia.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&a.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&a.uint32(18).string(s.value),s.origin!=null&&Object.hasOwnProperty.call(s,"origin")&&a.uint32(26).string(s.origin),s.ms!=null&&Object.hasOwnProperty.call(s,"ms")&&a.uint32(32).uint64(s.ms),a},o.decode=function(s,a){s instanceof M||(s=M.create(s)),a=a===void 0?s.len:s.pos+a;for(var _=new I.GroupAttributeRet.AttributeMap;s.pos<a;){var $=s.uint32();switch($>>>3){case 1:_.key=s.string();break;case 2:_.value=s.string();break;case 3:_.origin=s.string();break;case 4:_.ms=s.uint64();break;default:s.skipType(7&$)}}return _},o}(),e}(),aD=I.GroupAttributeSet=function(){function e(o){if(this.attributeInfos=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributeInfos=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&s.uint32(18).string(o.group),o.broadcast!=null&&Object.hasOwnProperty.call(o,"broadcast")&&s.uint32(24).bool(o.broadcast),o.attributeInfos!=null&&o.attributeInfos.length)for(var a=0;a<o.attributeInfos.length;++a)I.GroupAttributeSet.AttributeInfo.encode(o.attributeInfos[a],s.uint32(34).fork()).ldelim();return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAttributeSet;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.group=o.string();break;case 3:a.broadcast=o.bool();break;case 4:a.attributeInfos&&a.attributeInfos.length||(a.attributeInfos=[]),a.attributeInfos.push(I.GroupAttributeSet.AttributeInfo.decode(o,o.uint32()));break;default:o.skipType(7&_)}}return a},e.AttributeInfo=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.key="",o.prototype.value="",o.encode=function(s,a){return a||(a=ia.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&a.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&a.uint32(18).string(s.value),a},o.decode=function(s,a){s instanceof M||(s=M.create(s)),a=a===void 0?s.len:s.pos+a;for(var _=new I.GroupAttributeSet.AttributeInfo;s.pos<a;){var $=s.uint32();switch($>>>3){case 1:_.key=s.string();break;case 2:_.value=s.string();break;default:s.skipType(7&$)}}return _},o}(),e}(),bD=I.GroupAttributeMod=function(){function e(o){if(this.attributeInfos=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributeInfos=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&s.uint32(18).string(o.group),o.broadcast!=null&&Object.hasOwnProperty.call(o,"broadcast")&&s.uint32(24).bool(o.broadcast),o.attributeInfos!=null&&o.attributeInfos.length)for(var a=0;a<o.attributeInfos.length;++a)I.GroupAttributeMod.AttributeInfo.encode(o.attributeInfos[a],s.uint32(34).fork()).ldelim();return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAttributeMod;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.group=o.string();break;case 3:a.broadcast=o.bool();break;case 4:a.attributeInfos&&a.attributeInfos.length||(a.attributeInfos=[]),a.attributeInfos.push(I.GroupAttributeMod.AttributeInfo.decode(o,o.uint32()));break;default:o.skipType(7&_)}}return a},e.AttributeInfo=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.key="",o.prototype.value="",o.encode=function(s,a){return a||(a=ia.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&a.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&a.uint32(18).string(s.value),a},o.decode=function(s,a){s instanceof M||(s=M.create(s)),a=a===void 0?s.len:s.pos+a;for(var _=new I.GroupAttributeMod.AttributeInfo;s.pos<a;){var $=s.uint32();switch($>>>3){case 1:_.key=s.string();break;case 2:_.value=s.string();break;default:s.skipType(7&$)}}return _},o}(),e}(),cD=I.GroupAttributeDel=function(){function e(o){if(this.attributes=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.broadcast=!1,e.prototype.attributes=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&s.uint32(18).string(o.group),o.broadcast!=null&&Object.hasOwnProperty.call(o,"broadcast")&&s.uint32(24).bool(o.broadcast),o.attributes!=null&&o.attributes.length)for(var a=0;a<o.attributes.length;++a)s.uint32(34).string(o.attributes[a]);return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAttributeDel;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.group=o.string();break;case 3:a.broadcast=o.bool();break;case 4:a.attributes&&a.attributes.length||(a.attributes=[]),a.attributes.push(o.string());break;default:o.skipType(7&_)}}return a},e}(),dD=I.GroupAttributeAlt=function(){function e(o){if(this.attributeMaps=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.group="",e.prototype.instance=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.attributeMaps=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&s.uint32(18).string(o.group),o.instance!=null&&Object.hasOwnProperty.call(o,"instance")&&s.uint32(24).uint64(o.instance),o.attributeMaps!=null&&o.attributeMaps.length)for(var a=0;a<o.attributeMaps.length;++a)I.GroupAttributeAlt.AttributeMap.encode(o.attributeMaps[a],s.uint32(34).fork()).ldelim();return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAttributeAlt;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.group=o.string();break;case 3:a.instance=o.uint64();break;case 4:a.attributeMaps&&a.attributeMaps.length||(a.attributeMaps=[]),a.attributeMaps.push(I.GroupAttributeAlt.AttributeMap.decode(o,o.uint32()));break;default:o.skipType(7&_)}}return a},e.AttributeMap=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.key="",o.prototype.value="",o.prototype.origin="",o.prototype.ms=D.Long?D.Long.fromBits(0,0,!0):0,o.encode=function(s,a){return a||(a=ia.create()),s.key!=null&&Object.hasOwnProperty.call(s,"key")&&a.uint32(10).string(s.key),s.value!=null&&Object.hasOwnProperty.call(s,"value")&&a.uint32(18).string(s.value),s.origin!=null&&Object.hasOwnProperty.call(s,"origin")&&a.uint32(26).string(s.origin),s.ms!=null&&Object.hasOwnProperty.call(s,"ms")&&a.uint32(32).uint64(s.ms),a},o.decode=function(s,a){s instanceof M||(s=M.create(s)),a=a===void 0?s.len:s.pos+a;for(var _=new I.GroupAttributeAlt.AttributeMap;s.pos<a;){var $=s.uint32();switch($>>>3){case 1:_.key=s.string();break;case 2:_.value=s.string();break;case 3:_.origin=s.string();break;case 4:_.ms=s.uint64();break;default:s.skipType(7&$)}}return _},o}(),e}(),eD=I.GroupAttributeRsp=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAttributeRsp;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;default:o.skipType(7&_)}}return a},e}(),fD=I.GroupAttributeErr=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.code=0,e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.code!=null&&Object.hasOwnProperty.call(o,"code")&&s.uint32(16).uint32(o.code),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAttributeErr;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.code=o.uint32();break;default:o.skipType(7&_)}}return a},e}(),gD=I.GroupAttributeKeysGet=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.group="",e.encode=function(o,s){return s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.group!=null&&Object.hasOwnProperty.call(o,"group")&&s.uint32(18).string(o.group),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAttributeKeysGet;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.group=o.string();break;default:o.skipType(7&_)}}return a},e}(),hD=I.GroupAttributeKeysRet=function(){function e(o){if(this.keys=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.keys=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.keys!=null&&o.keys.length)for(var a=0;a<o.keys.length;++a)s.uint32(18).string(o.keys[a]);return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.GroupAttributeKeysRet;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.keys&&a.keys.length||(a.keys=[]),a.keys.push(o.string());break;default:o.skipType(7&_)}}return a},e}(),iD=I.SubscribeUserStatus=function(){function e(o){if(this.users=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.users=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.users!=null&&o.users.length)for(var a=0;a<o.users.length;++a)s.uint32(18).string(o.users[a]);return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.SubscribeUserStatus;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.users&&a.users.length||(a.users=[]),a.users.push(o.string());break;default:o.skipType(7&_)}}return a},e}(),jD=I.UnsubscribeUserStatus=function(){function e(o){if(this.users=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.users=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.users!=null&&o.users.length)for(var a=0;a<o.users.length;++a)s.uint32(18).string(o.users[a]);return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UnsubscribeUserStatus;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.users&&a.users.length||(a.users=[]),a.users.push(o.string());break;default:o.skipType(7&_)}}return a},e}(),kD=I.UserJoinNotice=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.instance=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.user="",e.encode=function(o,s){return s||(s=ia.create()),o.instance!=null&&Object.hasOwnProperty.call(o,"instance")&&s.uint32(8).uint64(o.instance),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(16).uint64(o.seq),o.user!=null&&Object.hasOwnProperty.call(o,"user")&&s.uint32(26).string(o.user),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserJoinNotice;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.instance=o.uint64();break;case 2:a.seq=o.uint64();break;case 3:a.user=o.string();break;default:o.skipType(7&_)}}return a},e}(),lD=I.UserQuitNotice=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.instance=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.user="",e.encode=function(o,s){return s||(s=ia.create()),o.instance!=null&&Object.hasOwnProperty.call(o,"instance")&&s.uint32(8).uint64(o.instance),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(16).uint64(o.seq),o.user!=null&&Object.hasOwnProperty.call(o,"user")&&s.uint32(26).string(o.user),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserQuitNotice;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.instance=o.uint64();break;case 2:a.seq=o.uint64();break;case 3:a.user=o.string();break;default:o.skipType(7&_)}}return a},e}(),mD=I.UserWaitNotice=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.instance=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.user="",e.encode=function(o,s){return s||(s=ia.create()),o.instance!=null&&Object.hasOwnProperty.call(o,"instance")&&s.uint32(8).uint64(o.instance),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(16).uint64(o.seq),o.user!=null&&Object.hasOwnProperty.call(o,"user")&&s.uint32(26).string(o.user),s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.UserWaitNotice;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.instance=o.uint64();break;case 2:a.seq=o.uint64();break;case 3:a.user=o.string();break;default:o.skipType(7&_)}}return a},e}(),nD=I.SubscribeResponse=function(){function e(o){if(this.errors=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.seq=D.Long?D.Long.fromBits(0,0,!0):0,e.prototype.errors=D.emptyArray,e.encode=function(o,s){if(s||(s=ia.create()),o.seq!=null&&Object.hasOwnProperty.call(o,"seq")&&s.uint32(8).uint64(o.seq),o.errors!=null&&o.errors.length)for(var a=0;a<o.errors.length;++a)I.SubscribeResponse.SubscribeErrorsType.encode(o.errors[a],s.uint32(18).fork()).ldelim();return s},e.decode=function(o,s){o instanceof M||(o=M.create(o)),s=s===void 0?o.len:o.pos+s;for(var a=new I.SubscribeResponse;o.pos<s;){var _=o.uint32();switch(_>>>3){case 1:a.seq=o.uint64();break;case 2:a.errors&&a.errors.length||(a.errors=[]),a.errors.push(I.SubscribeResponse.SubscribeErrorsType.decode(o,o.uint32()));break;default:o.skipType(7&_)}}return a},e.SubscribeErrorsType=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.account="",o.prototype.code=0,o.encode=function(s,a){return a||(a=ia.create()),s.account!=null&&Object.hasOwnProperty.call(s,"account")&&a.uint32(10).string(s.account),s.code!=null&&Object.hasOwnProperty.call(s,"code")&&a.uint32(16).uint32(s.code),a},o.decode=function(s,a){s instanceof M||(s=M.create(s)),a=a===void 0?s.len:s.pos+a;for(var _=new I.SubscribeResponse.SubscribeErrorsType;s.pos<a;){var $=s.uint32();switch($>>>3){case 1:_.account=s.string();break;case 2:_.code=s.uint32();break;default:s.skipType(7&$)}}return _},o}(),e}(),oD=Object.freeze({__proto__:null,URI:vC,Wrapper:wi,Ping:wC,Pong:xC,UserJoin:yC,UserResp:zC,UserQuit:AC,UserDrop:BC,UserTicketNearlyExpire:CC,UserRenewTokenReq:DC,UserRenewTokenResp:EC,GroupEnter:FC,GroupLeave:GC,GroupReply:HC,GroupLeaveNotice:vs,GroupEnterNotice:ws,Message:xs,Ack:ys,GroupDrop:IC,GroupAllUsersList:JC,GroupAllUsersResult:KC,UserStatusList:LC,UserStatusResult:MC,UserAttributeGet:NC,UserAttributeRet:OC,UserAttributeSet:PC,UserAttributeMod:QC,UserAttributeDel:RC,UserAttributeErr:SC,UserAttributeKeysGet:TC,UserAttributeKeysRet:UC,UserAttributeRsp:VC,GroupStatusList:WC,GroupStatusResult:XC,GroupCountNotice:YC,GroupAttributeGet:ZC,GroupAttributeRet:$C,GroupAttributeSet:aD,GroupAttributeMod:bD,GroupAttributeDel:cD,GroupAttributeAlt:dD,GroupAttributeRsp:eD,GroupAttributeErr:fD,GroupAttributeKeysGet:gD,GroupAttributeKeysRet:hD,SubscribeUserStatus:iD,UnsubscribeUserStatus:jD,UserJoinNotice:kD,UserQuitNotice:lD,UserWaitNotice:mD,SubscribeResponse:nD,default:I}),pD=Math.ceil,zs=function(e){return function(o,s,a){var _=(o=String(Eb(o))).length;return a=a===void 0?" ":String(a),(s=Ma(s))<=_||a==""?o:(s-=_,(_=Yo.call(a,pD(s/a.length))).length>s&&(_=_.slice(0,s)),e?o+_:_+o)}},qD=zs(!1),rD=zs(!0),As=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(df);ea({target:"String",proto:!0,forced:As},{padEnd:function(e){return rD(this,e,1<arguments.length?arguments[1]:void 0)}});var sD=eg,Bs=function(e){return function(o){o=Mb(o);for(var s,a=ed(o),_=a.length,$=0,_e=[];_>$;)s=a[$++],wa&&!sD.call(o,s)||_e.push(e?[s,o[s]]:o[s]);return _e}},tD=Bs(!0),uD=Bs(!1);ea({target:"Object",stat:!0},{entries:function(e){return tD(e)}});var vD=dc.f,Cs="".endsWith,wD=Math.min,Ds=Qk("endsWith"),xD=!Ds&&!!function(){var e=vD(String.prototype,"endsWith");return e&&!e.writable}();ea({target:"String",proto:!0,forced:!xD&&!Ds},{endsWith:function(e){var o=String(Eb(this));Pk(e);var s=1<arguments.length?arguments[1]:void 0,a=Ma(o.length);return s=s===void 0?a:wD(Ma(s),a),a=String(e),Cs?Cs.call(o,a,s):o.slice(s-a.length,s)===a}}),Bh("match",1,function(e,o,s){return[function(a){var _=Eb(this),$=a==null?void 0:a[e];return $!==void 0?$.call(a,_):new RegExp(a)[e](String(_))},function(a){var _=s(o,a,this);if(_.done)return _.value;if(a=Ia(a),_=String(this),!a.global)return ef(a,_);var $=a.unicode;a.lastIndex=0;for(var _e,_n=[],_r=0;(_e=ef(a,_))!==null;)_e=String(_e[0]),_n[_r]=_e,_e===""&&(a.lastIndex=Mj(_,Ma(a.lastIndex),$)),_r++;return _r===0?null:_n}]});var yD=dc.f,Es="".startsWith,zD=Math.min,Fs=Qk("startsWith"),AD=!Fs&&!!function(){var e=yD(String.prototype,"startsWith");return e&&!e.writable}();ea({target:"String",proto:!0,forced:!AD&&!Fs},{startsWith:function(e){var o=String(Eb(this));Pk(e);var s=Ma(zD(1<arguments.length?arguments[1]:void 0,o.length)),a=String(e);return Es?Es.call(o,a,s):o.slice(s,s+a.length)===a}});var Wn=function(e){var o=/(%?)(%([jds]))/g,s=Array.prototype.slice.call(arguments,1);return s.length&&(e=e.replace(o,function(a,_,$,_e){switch($=s.shift(),_e){case"s":$=""+$;break;case"d":$=Number($);break;case"j":$=JSON.stringify($)}return _?(s.unshift($),a):$})),s.length&&(e+=" "+s.join(" ")),""+(e=e.replace(/%{2,2}/g,"%"))},BD=/\s/,CD=/^\s+/,Gs=NaN,DD=/^[-+]0x[0-9a-f]+$/i,ED=/^0b[01]+$/i,FD=/^0o[0-7]+$/i,GD=parseInt,xi=function(e){if(typeof e=="number")return e;if(Ke(e))return Gs;if(Gb(e)&&(e=typeof e.valueOf=="function"?e.valueOf():e,e=Gb(e)?e+"":e),typeof e!="string")return e===0?e:+e;if(e){for(var o=e.slice,s=e.length;s--&&BD.test(e.charAt(s)););e=o.call(e,0,s+1).replace(CD,"")}return(o=ED.test(e))||FD.test(e)?GD(e.slice(2),o?2:8):DD.test(e)?Gs:+e},HD=Math.max,ID=Math.min,JD=function(e,o,s){function a(t_){var o_=_r,m_=_s;return _r=_s=void 0,_f=t_,na=e.apply(m_,o_)}function _(t_){var o_=t_-_p;return t_-=_f,_p===void 0||o_>=o||0>o_||_v&&t_>=e_}function $(){var t_=$b.Date.now();if(_(t_))return _e(t_);var o_=setTimeout,m_=t_-_f;t_=o-(t_-_p),m_=_v?ID(t_,e_-m_):t_,ba=o_($,m_)}function _e(t_){return ba=void 0,n_&&_r?a(t_):(_r=_s=void 0,na)}function _n(){var t_=$b.Date.now(),o_=_(t_);if(_r=arguments,_s=this,_p=t_,o_){if(ba===void 0)return _f=t_=_p,ba=setTimeout($,o),_E?a(t_):na;if(_v)return clearTimeout(ba),ba=setTimeout($,o),a(_p)}return ba===void 0&&(ba=setTimeout($,o)),na}var _r,_s,na,ba,_p,_f=0,_E=!1,_v=!1,n_=!0;if(typeof e!="function")throw new TypeError("Expected a function");if(o=xi(o)||0,Gb(s)){_E=!!s.leading;var e_=(_v="maxWait"in s)?HD(xi(s.maxWait)||0,o):e_;n_="trailing"in s?!!s.trailing:n_}return _n.cancel=function(){ba!==void 0&&clearTimeout(ba),_f=0,_r=_p=_s=ba=void 0},_n.flush=function(){return ba===void 0?na:_e($b.Date.now())},_n},KD=Math.max,LD=Math.min,Hs=1/0,Rl=function(e){return e?(e=xi(e))===Hs||e===-Hs?17976931348623157e292*(0>e?-1:1):e==e?e:0:e===0?e:0},Is=function(e,o,s){return o=Rl(o),s===void 0?(s=o,o=0):s=Rl(s),(e=xi(e))>=LD(o,s)&&e<KD(o,s)},ac=Gc.Writer,H=Gc.util,Pb=Gc.roots.default||(Gc.roots.default={}),MD=Pb.Session=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.elapse=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.appId="",e.prototype.ver="",e.prototype.buildno=0,e.prototype.installId="",e.prototype.os=0,e.prototype.did="",e.prototype.index=null,e.prototype.token="",e.prototype.version=0,e.prototype.subVersion=0,e.encode=function(o,s){return s||(s=ac.create()),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(10).string(o.sid),o.userId!=null&&Object.hasOwnProperty.call(o,"userId")&&s.uint32(18).string(o.userId),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(24).int64(o.lts),o.elapse!=null&&Object.hasOwnProperty.call(o,"elapse")&&s.uint32(32).int64(o.elapse),o.appId!=null&&Object.hasOwnProperty.call(o,"appId")&&s.uint32(42).string(o.appId),o.ver!=null&&Object.hasOwnProperty.call(o,"ver")&&s.uint32(50).string(o.ver),o.buildno!=null&&Object.hasOwnProperty.call(o,"buildno")&&s.uint32(56).int32(o.buildno),o.installId!=null&&Object.hasOwnProperty.call(o,"installId")&&s.uint32(66).string(o.installId),o.os!=null&&Object.hasOwnProperty.call(o,"os")&&s.uint32(128).int32(o.os),o.did!=null&&Object.hasOwnProperty.call(o,"did")&&s.uint32(138).string(o.did),o.index!=null&&Object.hasOwnProperty.call(o,"index")&&Pb.Session.CommonIndex.encode(o.index,s.uint32(162).fork()).ldelim(),o.token!=null&&Object.hasOwnProperty.call(o,"token")&&s.uint32(170).string(o.token),o.version!=null&&Object.hasOwnProperty.call(o,"version")&&s.uint32(176).int32(o.version),o.subVersion!=null&&Object.hasOwnProperty.call(o,"subVersion")&&s.uint32(184).int32(o.subVersion),s},e.CommonIndex=function(){function o(s){if(s)for(var a=Object.keys(s),_=0;_<a.length;++_)s[a[_]]!=null&&(this[a[_]]=s[a[_]])}return o.prototype.index1="",o.prototype.index2="",o.prototype.index3="",o.encode=function(s,a){return a||(a=ac.create()),s.index1!=null&&Object.hasOwnProperty.call(s,"index1")&&a.uint32(10).string(s.index1),s.index2!=null&&Object.hasOwnProperty.call(s,"index2")&&a.uint32(18).string(s.index2),s.index3!=null&&Object.hasOwnProperty.call(s,"index3")&&a.uint32(26).string(s.index3),a},o}(),e}(),ND=Pb.ApEvent=function(){function e(o){if(this.linkServerList=[],o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.elapse=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.apAddr="",e.prototype.linkServerList=H.emptyArray,e.prototype.errCode=0,e.prototype.serverErrCode=0,e.prototype.isp="",e.prototype.opId=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.envId=0,e.prototype.flag=0,e.prototype.area="",e.encode=function(o,s){if(s||(s=ac.create()),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(10).string(o.sid),o.userId!=null&&Object.hasOwnProperty.call(o,"userId")&&s.uint32(18).string(o.userId),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(24).int64(o.lts),o.elapse!=null&&Object.hasOwnProperty.call(o,"elapse")&&s.uint32(32).int64(o.elapse),o.apAddr!=null&&Object.hasOwnProperty.call(o,"apAddr")&&s.uint32(50).string(o.apAddr),o.linkServerList!=null&&o.linkServerList.length)for(var a=0;a<o.linkServerList.length;++a)s.uint32(58).string(o.linkServerList[a]);return o.errCode!=null&&Object.hasOwnProperty.call(o,"errCode")&&s.uint32(72).int32(o.errCode),o.serverErrCode!=null&&Object.hasOwnProperty.call(o,"serverErrCode")&&s.uint32(80).int32(o.serverErrCode),o.isp!=null&&Object.hasOwnProperty.call(o,"isp")&&s.uint32(90).string(o.isp),o.opId!=null&&Object.hasOwnProperty.call(o,"opId")&&s.uint32(96).int64(o.opId),o.envId!=null&&Object.hasOwnProperty.call(o,"envId")&&s.uint32(104).int32(o.envId),o.flag!=null&&Object.hasOwnProperty.call(o,"flag")&&s.uint32(112).int32(o.flag),o.area!=null&&Object.hasOwnProperty.call(o,"area")&&s.uint32(122).string(o.area),s},e}(),OD=Pb.ApRequest=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.elapse=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.apAddr="",e.prototype.opId=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.envId=0,e.prototype.flag=0,e.encode=function(o,s){return s||(s=ac.create()),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(10).string(o.sid),o.userId!=null&&Object.hasOwnProperty.call(o,"userId")&&s.uint32(18).string(o.userId),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(24).int64(o.lts),o.elapse!=null&&Object.hasOwnProperty.call(o,"elapse")&&s.uint32(32).int64(o.elapse),o.apAddr!=null&&Object.hasOwnProperty.call(o,"apAddr")&&s.uint32(42).string(o.apAddr),o.opId!=null&&Object.hasOwnProperty.call(o,"opId")&&s.uint32(48).int64(o.opId),o.envId!=null&&Object.hasOwnProperty.call(o,"envId")&&s.uint32(56).int32(o.envId),o.flag!=null&&Object.hasOwnProperty.call(o,"flag")&&s.uint32(64).int32(o.flag),s},e}(),PD=Pb.LinkLoginRequest=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.elapse=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.destServerIp="",e.prototype.linkId=0,e.encode=function(o,s){return s||(s=ac.create()),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(10).string(o.sid),o.userId!=null&&Object.hasOwnProperty.call(o,"userId")&&s.uint32(18).string(o.userId),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(24).int64(o.lts),o.elapse!=null&&Object.hasOwnProperty.call(o,"elapse")&&s.uint32(32).int64(o.elapse),o.destServerIp!=null&&Object.hasOwnProperty.call(o,"destServerIp")&&s.uint32(42).string(o.destServerIp),o.linkId!=null&&Object.hasOwnProperty.call(o,"linkId")&&s.uint32(48).int32(o.linkId),s},e}(),QD=Pb.Link=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.elapse=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.ec=0,e.prototype.sc=0,e.prototype.destServerIp="",e.prototype.ackedServerIp="",e.prototype.responseTime=0,e.encode=function(o,s){return s||(s=ac.create()),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(10).string(o.sid),o.userId!=null&&Object.hasOwnProperty.call(o,"userId")&&s.uint32(18).string(o.userId),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(24).int64(o.lts),o.elapse!=null&&Object.hasOwnProperty.call(o,"elapse")&&s.uint32(32).int64(o.elapse),o.ec!=null&&Object.hasOwnProperty.call(o,"ec")&&s.uint32(40).int32(o.ec),o.sc!=null&&Object.hasOwnProperty.call(o,"sc")&&s.uint32(48).int32(o.sc),o.destServerIp!=null&&Object.hasOwnProperty.call(o,"destServerIp")&&s.uint32(58).string(o.destServerIp),o.ackedServerIp!=null&&Object.hasOwnProperty.call(o,"ackedServerIp")&&s.uint32(66).string(o.ackedServerIp),o.responseTime!=null&&Object.hasOwnProperty.call(o,"responseTime")&&s.uint32(72).int32(o.responseTime),s},e}(),RD=Pb.Logout=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.elapse=H.Long?H.Long.fromBits(0,0,!1):0,e.encode=function(o,s){return s||(s=ac.create()),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(10).string(o.sid),o.userId!=null&&Object.hasOwnProperty.call(o,"userId")&&s.uint32(18).string(o.userId),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(24).int64(o.lts),o.elapse!=null&&Object.hasOwnProperty.call(o,"elapse")&&s.uint32(32).int64(o.elapse),s},e}(),SD=Pb.KickedOff=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.elapse=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.linkId=0,e.prototype.code=0,e.prototype.server="",e.prototype.serverCode=0,e.encode=function(o,s){return s||(s=ac.create()),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(10).string(o.sid),o.userId!=null&&Object.hasOwnProperty.call(o,"userId")&&s.uint32(18).string(o.userId),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(24).int64(o.lts),o.elapse!=null&&Object.hasOwnProperty.call(o,"elapse")&&s.uint32(32).int64(o.elapse),o.linkId!=null&&Object.hasOwnProperty.call(o,"linkId")&&s.uint32(48).int32(o.linkId),o.code!=null&&Object.hasOwnProperty.call(o,"code")&&s.uint32(56).int32(o.code),o.server!=null&&Object.hasOwnProperty.call(o,"server")&&s.uint32(66).string(o.server),o.serverCode!=null&&Object.hasOwnProperty.call(o,"serverCode")&&s.uint32(72).int32(o.serverCode),s},e}(),TD=Pb.ChnJoin=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.elapse=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.encode=function(o,s){return s||(s=ac.create()),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(10).string(o.sid),o.userId!=null&&Object.hasOwnProperty.call(o,"userId")&&s.uint32(18).string(o.userId),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(24).int64(o.lts),o.elapse!=null&&Object.hasOwnProperty.call(o,"elapse")&&s.uint32(32).int64(o.elapse),o.cname!=null&&Object.hasOwnProperty.call(o,"cname")&&s.uint32(50).string(o.cname),o.errCode!=null&&Object.hasOwnProperty.call(o,"errCode")&&s.uint32(56).int32(o.errCode),s},e}(),UD=Pb.ChnJoinRes=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.elapse=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.prototype.serverErrCode=0,e.encode=function(o,s){return s||(s=ac.create()),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(10).string(o.sid),o.userId!=null&&Object.hasOwnProperty.call(o,"userId")&&s.uint32(18).string(o.userId),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(24).int64(o.lts),o.elapse!=null&&Object.hasOwnProperty.call(o,"elapse")&&s.uint32(32).int64(o.elapse),o.cname!=null&&Object.hasOwnProperty.call(o,"cname")&&s.uint32(50).string(o.cname),o.errCode!=null&&Object.hasOwnProperty.call(o,"errCode")&&s.uint32(56).int32(o.errCode),o.serverErrCode!=null&&Object.hasOwnProperty.call(o,"serverErrCode")&&s.uint32(64).int32(o.serverErrCode),s},e}(),VD=Pb.ChnLeave=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.elapse=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.cname="",e.prototype.errCode=0,e.encode=function(o,s){return s||(s=ac.create()),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(10).string(o.sid),o.userId!=null&&Object.hasOwnProperty.call(o,"userId")&&s.uint32(18).string(o.userId),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(24).int64(o.lts),o.elapse!=null&&Object.hasOwnProperty.call(o,"elapse")&&s.uint32(32).int64(o.elapse),o.cname!=null&&Object.hasOwnProperty.call(o,"cname")&&s.uint32(50).string(o.cname),o.errCode!=null&&Object.hasOwnProperty.call(o,"errCode")&&s.uint32(56).int32(o.errCode),s},e}(),WD=Pb.ConnectionStateChange=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.sid="",e.prototype.userId="",e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.elapse=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.oldState=0,e.prototype.newState=0,e.prototype.reason=0,e.prototype.reconnId=0,e.encode=function(o,s){return s||(s=ac.create()),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(10).string(o.sid),o.userId!=null&&Object.hasOwnProperty.call(o,"userId")&&s.uint32(18).string(o.userId),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(24).int64(o.lts),o.elapse!=null&&Object.hasOwnProperty.call(o,"elapse")&&s.uint32(32).int64(o.elapse),o.oldState!=null&&Object.hasOwnProperty.call(o,"oldState")&&s.uint32(40).int32(o.oldState),o.newState!=null&&Object.hasOwnProperty.call(o,"newState")&&s.uint32(48).int32(o.newState),o.reason!=null&&Object.hasOwnProperty.call(o,"reason")&&s.uint32(56).int32(o.reason),o.reconnId!=null&&Object.hasOwnProperty.call(o,"reconnId")&&s.uint32(64).int32(o.reconnId),s},e}(),Js=Pb.RtmSdkMessageCount=function(){function e(o){if(o)for(var s=Object.keys(o),a=0;a<s.length;++a)o[s[a]]!=null&&(this[s[a]]=o[s[a]])}return e.prototype.lts=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.vid=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.sid="",e.prototype.messagecategory=0,e.prototype.reportsequence=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.sentcount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.receivedcount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack10mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack25mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack50mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack75mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack100mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack150mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack200mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack250mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack300mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack400mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack500mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack600mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack800mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack1000mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack2000mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack3000mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack5000mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerack7000mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.peerackslowcount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack10mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack25mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack50mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack75mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack100mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack150mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack200mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack250mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack300mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack400mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack500mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack600mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack800mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack1000mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack2000mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack3000mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack5000mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientack7000mscount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.norecipientackslowcount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.acktimeoutcount=H.Long?H.Long.fromBits(0,0,!1):0,e.prototype.apimajorversion=0,e.prototype.apiminorversion=0,e.prototype.os=0,e.prototype.toooftencount=0,e.prototype.receiverofflinecount=0,e.prototype.invalidmessagecount=0,e.prototype.unknowerrorcount=0,e.prototype.servercachedcount=0,e.prototype.timeoutcount=0,e.prototype.successcount=0,e.prototype.userid="",e.encode=function(o,s){return s||(s=ac.create()),o.lts!=null&&Object.hasOwnProperty.call(o,"lts")&&s.uint32(8).int64(o.lts),o.vid!=null&&Object.hasOwnProperty.call(o,"vid")&&s.uint32(16).int64(o.vid),o.sid!=null&&Object.hasOwnProperty.call(o,"sid")&&s.uint32(26).string(o.sid),o.messagecategory!=null&&Object.hasOwnProperty.call(o,"messagecategory")&&s.uint32(32).int32(o.messagecategory),o.reportsequence!=null&&Object.hasOwnProperty.call(o,"reportsequence")&&s.uint32(40).int64(o.reportsequence),o.sentcount!=null&&Object.hasOwnProperty.call(o,"sentcount")&&s.uint32(48).int64(o.sentcount),o.receivedcount!=null&&Object.hasOwnProperty.call(o,"receivedcount")&&s.uint32(56).int64(o.receivedcount),o.peerack10mscount!=null&&Object.hasOwnProperty.call(o,"peerack10mscount")&&s.uint32(64).int64(o.peerack10mscount),o.peerack25mscount!=null&&Object.hasOwnProperty.call(o,"peerack25mscount")&&s.uint32(72).int64(o.peerack25mscount),o.peerack50mscount!=null&&Object.hasOwnProperty.call(o,"peerack50mscount")&&s.uint32(80).int64(o.peerack50mscount),o.peerack75mscount!=null&&Object.hasOwnProperty.call(o,"peerack75mscount")&&s.uint32(88).int64(o.peerack75mscount),o.peerack100mscount!=null&&Object.hasOwnProperty.call(o,"peerack100mscount")&&s.uint32(96).int64(o.peerack100mscount),o.peerack150mscount!=null&&Object.hasOwnProperty.call(o,"peerack150mscount")&&s.uint32(104).int64(o.peerack150mscount),o.peerack200mscount!=null&&Object.hasOwnProperty.call(o,"peerack200mscount")&&s.uint32(112).int64(o.peerack200mscount),o.peerack250mscount!=null&&Object.hasOwnProperty.call(o,"peerack250mscount")&&s.uint32(120).int64(o.peerack250mscount),o.peerack300mscount!=null&&Object.hasOwnProperty.call(o,"peerack300mscount")&&s.uint32(128).int64(o.peerack300mscount),o.peerack400mscount!=null&&Object.hasOwnProperty.call(o,"peerack400mscount")&&s.uint32(136).int64(o.peerack400mscount),o.peerack500mscount!=null&&Object.hasOwnProperty.call(o,"peerack500mscount")&&s.uint32(144).int64(o.peerack500mscount),o.peerack600mscount!=null&&Object.hasOwnProperty.call(o,"peerack600mscount")&&s.uint32(152).int64(o.peerack600mscount),o.peerack800mscount!=null&&Object.hasOwnProperty.call(o,"peerack800mscount")&&s.uint32(160).int64(o.peerack800mscount),o.peerack1000mscount!=null&&Object.hasOwnProperty.call(o,"peerack1000mscount")&&s.uint32(168).int64(o.peerack1000mscount),o.peerack2000mscount!=null&&Object.hasOwnProperty.call(o,"peerack2000mscount")&&s.uint32(176).int64(o.peerack2000mscount),o.peerack3000mscount!=null&&Object.hasOwnProperty.call(o,"peerack3000mscount")&&s.uint32(184).int64(o.peerack3000mscount),o.peerack5000mscount!=null&&Object.hasOwnProperty.call(o,"peerack5000mscount")&&s.uint32(192).int64(o.peerack5000mscount),o.peerack7000mscount!=null&&Object.hasOwnProperty.call(o,"peerack7000mscount")&&s.uint32(200).int64(o.peerack7000mscount),o.peerackslowcount!=null&&Object.hasOwnProperty.call(o,"peerackslowcount")&&s.uint32(208).int64(o.peerackslowcount),o.norecipientack10mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack10mscount")&&s.uint32(216).int64(o.norecipientack10mscount),o.norecipientack25mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack25mscount")&&s.uint32(224).int64(o.norecipientack25mscount),o.norecipientack50mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack50mscount")&&s.uint32(232).int64(o.norecipientack50mscount),o.norecipientack75mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack75mscount")&&s.uint32(240).int64(o.norecipientack75mscount),o.norecipientack100mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack100mscount")&&s.uint32(248).int64(o.norecipientack100mscount),o.norecipientack150mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack150mscount")&&s.uint32(256).int64(o.norecipientack150mscount),o.norecipientack200mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack200mscount")&&s.uint32(264).int64(o.norecipientack200mscount),o.norecipientack250mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack250mscount")&&s.uint32(272).int64(o.norecipientack250mscount),o.norecipientack300mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack300mscount")&&s.uint32(280).int64(o.norecipientack300mscount),o.norecipientack400mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack400mscount")&&s.uint32(288).int64(o.norecipientack400mscount),o.norecipientack500mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack500mscount")&&s.uint32(296).int64(o.norecipientack500mscount),o.norecipientack600mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack600mscount")&&s.uint32(304).int64(o.norecipientack600mscount),o.norecipientack800mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack800mscount")&&s.uint32(312).int64(o.norecipientack800mscount),o.norecipientack1000mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack1000mscount")&&s.uint32(320).int64(o.norecipientack1000mscount),o.norecipientack2000mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack2000mscount")&&s.uint32(328).int64(o.norecipientack2000mscount),o.norecipientack3000mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack3000mscount")&&s.uint32(336).int64(o.norecipientack3000mscount),o.norecipientack5000mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack5000mscount")&&s.uint32(344).int64(o.norecipientack5000mscount),o.norecipientack7000mscount!=null&&Object.hasOwnProperty.call(o,"norecipientack7000mscount")&&s.uint32(352).int64(o.norecipientack7000mscount),o.norecipientackslowcount!=null&&Object.hasOwnProperty.call(o,"norecipientackslowcount")&&s.uint32(360).int64(o.norecipientackslowcount),o.acktimeoutcount!=null&&Object.hasOwnProperty.call(o,"acktimeoutcount")&&s.uint32(368).int64(o.acktimeoutcount),o.apimajorversion!=null&&Object.hasOwnProperty.call(o,"apimajorversion")&&s.uint32(376).int32(o.apimajorversion),o.apiminorversion!=null&&Object.hasOwnProperty.call(o,"apiminorversion")&&s.uint32(384).int32(o.apiminorversion),o.os!=null&&Object.hasOwnProperty.call(o,"os")&&s.uint32(392).int32(o.os),o.toooftencount!=null&&Object.hasOwnProperty.call(o,"toooftencount")&&s.uint32(400).int32(o.toooftencount),o.receiverofflinecount!=null&&Object.hasOwnProperty.call(o,"receiverofflinecount")&&s.uint32(408).int32(o.receiverofflinecount),o.invalidmessagecount!=null&&Object.hasOwnProperty.call(o,"invalidmessagecount")&&s.uint32(416).int32(o.invalidmessagecount),o.unknowerrorcount!=null&&Object.hasOwnProperty.call(o,"unknowerrorcount")&&s.uint32(424).int32(o.unknowerrorcount),o.servercachedcount!=null&&Object.hasOwnProperty.call(o,"servercachedcount")&&s.uint32(432).int32(o.servercachedcount),o.timeoutcount!=null&&Object.hasOwnProperty.call(o,"timeoutcount")&&s.uint32(440).int32(o.timeoutcount),o.successcount!=null&&Object.hasOwnProperty.call(o,"successcount")&&s.uint32(448).int32(o.successcount),o.userid!=null&&Object.hasOwnProperty.call(o,"userid")&&s.uint32(458).string(o.userid),s},e}(),Iv=Object.freeze({__proto__:null,Session:MD,ApEvent:ND,ApRequest:OD,LinkLoginRequest:PD,Link:QD,Logout:RD,KickedOff:SD,ChnJoin:TD,ChnJoinRes:UD,ChnLeave:VD,ConnectionStateChange:WD,RtmSdkMessageCount:Js,default:Pb}),XD=la(function(){return new Date(NaN).toJSON()!==null||Date.prototype.toJSON.call({toISOString:function(){return 1}})!==1});ea({target:"Date",proto:!0,forced:XD},{toJSON:function(e){e=pb(this);var o=Oc(e);return typeof o!="number"||isFinite(o)?e.toISOString():null}}),ea({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var Ev=Object.prototype.hasOwnProperty,Ks=function(e,o,s){return JSON.stringify(Mn(e),o,s)};Ks.ensureProperties=Mn;var YD=function(e,o){o=o||{};var s=qa(e);if(s==="string"&&0<e.length)return Fv(e);if(s==="number"&&isFinite(e))return o.long?e=864e5<=(o=Math.abs(e))?jh(e,o,864e5,"day"):36e5<=o?jh(e,o,36e5,"hour"):6e4<=o?jh(e,o,6e4,"minute"):1e3<=o?jh(e,o,1e3,"second"):e+" ms":e=864e5<=(o=Math.abs(e))?Math.round(e/864e5)+"d":36e5<=o?Math.round(e/36e5)+"h":6e4<=o?Math.round(e/6e4)+"m":1e3<=o?Math.round(e/1e3)+"s":e+"ms",e;throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))},ZD=function(e){function o(_){function $(){for(var _r=arguments.length,_s=Array(_r),na=0;na<_r;na++)_s[na]=arguments[na];if($.enabled){_r=Number(new Date),$.diff=_r-(_e||_r),$.prev=_e,_e=$.curr=_r,_s[0]=o.coerce(_s[0]),typeof _s[0]!="string"&&_s.unshift("%O");var ba=0;_s[0]=_s[0].replace(/%([a-zA-Z%])/g,function(_p,_f){return _p==="%%"?"%":(ba++,typeof(_f=o.formatters[_f])=="function"&&(_p=_f.call($,_s[ba]),_s.splice(ba,1),ba--),_p)}),o.formatArgs.call($,_s),($.log||o.log).apply($,_s)}}var _e,_n=null;return $.namespace=_,$.useColors=o.useColors(),$.color=o.selectColor(_),$.extend=s,$.destroy=o.destroy,Object.defineProperty($,"enabled",{enumerable:!0,configurable:!1,get:function(){return _n===null?o.enabled(_):_n},set:function(_r){_n=_r}}),typeof o.init=="function"&&o.init($),$}function s(_,$){return(_=o(this.namespace+($===void 0?":":$)+_)).log=this.log,_}function a(_){return _.toString().substring(2,_.toString().length-2).replace(/\.\*\?$/,"*")}return o.debug=o,o.default=o,o.coerce=function(_){return _ instanceof Error?_.stack||_.message:_},o.disable=function(){var _=[].concat(Z(o.names.map(a)),Z(o.skips.map(a).map(function($){return"-"+$}))).join(",");return o.enable(""),_},o.enable=function(_){o.save(_),o.names=[],o.skips=[];var $,_e=(typeof _=="string"?_:"").split(/[\s,]+/),_n=_e.length;for($=0;$<_n;$++)_e[$]&&((_=_e[$].replace(/\*/g,".*?"))[0]==="-"?o.skips.push(new RegExp("^"+_.substr(1)+"$")):o.names.push(new RegExp("^"+_+"$")))},o.enabled=function(_){if(_[_.length-1]==="*")return!0;var $,_e=0;for($=o.skips.length;_e<$;_e++)if(o.skips[_e].test(_))return!1;for(_e=0,$=o.names.length;_e<$;_e++)if(o.names[_e].test(_))return!0;return!1},o.humanize=YD,o.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(function(_){o[_]=e[_]}),o.names=[],o.skips=[],o.formatters={},o.selectColor=function(_){for(var $=0,_e=0;_e<_.length;_e++)$=($<<5)-$+_.charCodeAt(_e),$|=0;return o.colors[Math.abs($)%o.colors.length]},o.enable(o.load()),o},Ls=xb(function(e,o){o.formatArgs=function(_){if(_[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+_[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var $="color: "+this.color;_.splice(1,0,$,"color: inherit");var _e=0,_n=0;_[0].replace(/%[a-zA-Z%]/g,function(_r){_r!=="%%"&&(_e++,_r==="%c"&&(_n=_e))}),_.splice(_n,0,$)}},o.save=function(_){try{_?o.storage.setItem("debug",_):o.storage.removeItem("debug")}catch{}},o.load=function(){try{var _=o.storage.getItem("debug")}catch{}return!_&&typeof process<"u"&&"env"in process&&(_=define_process_env_default.DEBUG),_},o.useColors=function(){return!(typeof window>"u"||!window.process||window.process.type!=="renderer"&&!window.process.__nwjs)||(typeof navigator>"u"||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))};e:{try{var s=localStorage;break e}catch{}s=void 0}var a;o.storage=s,o.destroy=(a=!1,function(){a||(a=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),o.colors="#0000CC #0000FF #0033CC #0033FF #0066CC #0066FF #0099CC #0099FF #00CC00 #00CC33 #00CC66 #00CC99 #00CCCC #00CCFF #3300CC #3300FF #3333CC #3333FF #3366CC #3366FF #3399CC #3399FF #33CC00 #33CC33 #33CC66 #33CC99 #33CCCC #33CCFF #6600CC #6600FF #6633CC #6633FF #66CC00 #66CC33 #9900CC #9900FF #9933CC #9933FF #99CC00 #99CC33 #CC0000 #CC0033 #CC0066 #CC0099 #CC00CC #CC00FF #CC3300 #CC3333 #CC3366 #CC3399 #CC33CC #CC33FF #CC6600 #CC6633 #CC9900 #CC9933 #CCCC00 #CCCC33 #FF0000 #FF0033 #FF0066 #FF0099 #FF00CC #FF00FF #FF3300 #FF3333 #FF3366 #FF3399 #FF33CC #FF33FF #FF6600 #FF6633 #FF9900 #FF9933 #FFCC00 #FFCC33".split(" "),o.log=console.debug||console.log||function(){},e.exports=ZD(o),e.exports.formatters.j=function(_){try{return JSON.stringify(_)}catch($){return"[UnexpectedJSONParseError]: "+$.message}}}),Ms=Ls("RTM:DEBUG"),Af;Ms.enabled=!1,function(e){e[e.Uploading=0]="Uploading",e[e.Free=1]="Free"}(Af||(Af={}));var $D=function(){function e(o){va(this,e),x(this,"uploadRequest",void 0),x(this,"uploadState",void 0),x(this,"uploadResendCount",void 0),x(this,"LogCache",void 0),x(this,"LogsToPost",void 0),x(this,"processId",void 0),x(this,"sdkVersion",void 0),x(this,"logId",void 0),x(this,"rtmConfig",void 0),this.processId=o.processId,this.sdkVersion=o.sdkVersion,this.rtmConfig=o.rtmConfig,this.uploadRequest=o.uploadRequest,this.uploadState=Af.Free,this.uploadResendCount=0,this.LogCache=[],this.LogsToPost=[],this.logId=0}return eb(e,[{key:"upload",value:function(o){this.LogCache.push(o),this.uploadState===Af.Free&&(this.LogsToPost=40>this.LogCache.length?this.LogCache.splice(0,this.LogCache.length):this.LogCache.splice(0,40),this.postLog(this.LogsToPost))}},{key:"postLog",value:function(o){var s=this;this.uploadState=Af.Uploading,setTimeout(ma(N.mark(function a(){var _,$,_e;return N.wrap(function(_n){for(;;)switch(_n.prev=_n.next){case 0:return _={sdk_version:s.sdkVersion,process_id:s.processId,payload:JSON.stringify(o)},_n.prev=1,_n.next=4,s.uploadRequest(_,($=s.rtmConfig.enableCloudProxy)!==null&&$!==void 0&&$);case 4:if(!gj){_n.next=6;break}throw Error("RTM is busy");case 6:_n.next=13;break;case 8:return _n.prev=8,_n.t0=_n.catch(1),_e=2>s.uploadResendCount++?2e3:1e4,setTimeout(function(){return s.postLog(s.LogsToPost)},_e),_n.abrupt("return");case 13:if(Ms('The logs uploaded for "process-'.concat(Og,'"')),s.LogCache.length!==0){_n.next=17;break}return s.uploadState=Af.Free,_n.abrupt("return");case 17:s.uploadResendCount=0,s.LogsToPost=40>s.LogCache.length?s.LogCache.splice(0,s.LogCache.length):s.LogCache.splice(0,40),s.postLog(s.LogsToPost);case 20:case"end":return _n.stop()}},a,null,[[1,8]])})),ue.getParameter("LOG_UPLOAD_INTERVAL"))}}]),e}(),Ns=function(e,o,s,a,_,$,_e,_n){var _r=0;for(_e=!!_e&&Dd(_e,_n,3);_r<a;){if(_r in s){if(_n=_e?_e(s[_r],_r,o):s[_r],0<$&&Ed(_n))_=Ns(e,o,_n,Ma(_n.length),_,$-1)-1;else{if(9007199254740991<=_)throw TypeError("Exceed the acceptable array length");e[_]=_n}_++}_r++}return _},aE=Ns;ea({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,o=pb(this),s=Ma(o.length),a=Dh(o,0);return a.length=aE(a,o,o,s,0,e===void 0?1:yc(e)),a}}),ea({target:"Object",stat:!0},{values:function(e){return uD(e)}});var ud=function(e){function o(a,_){return va(this,o),x(z(a=s.call(this,Vn(a,_))),"originalError",void 0),x(z(a),"code",void 0),x(z(a),"serverCode",void 0),typeof _=="number"?a.code=_:typeof _=="string"?a.name=_:_!==void 0&&(_.originalError&&(a.originalError=_.originalError),_.code!==void 0&&(a.code=_.code),_.serverCode!==void 0&&(a.serverCode=_.serverCode)),a}Ga(o,e);var s=Ha(o);return o}(Kf(Error)),rc=function(e){function o(a,_){return va(this,o),x(z(a=s.call(this,Vn(a,_))),"name","RtmInternalError"),x(z(a),"code",void 0),a.code=_,a}Ga(o,e);var s=Ha(o);return o}(Kf(Error)),yi=function(){return function(e){function o(a){va(this,o);var _=Object.keys(a);return s.call(this,a[_[0]],_[0])}Ga(o,e);var s=Ha(o);return o}(rc)},mb=yi(),Ub=function(e){function o(){va(this,o);for(var a=arguments.length,_=Array(a),$=0;$<a;$++)_[$]=arguments[$];return x(z(a=s.call.apply(s,[this].concat(_))),"name","RtmTimeoutError"),a}Ga(o,e);var s=Ha(o);return o}(ud),ca=function(e){function o(){va(this,o);for(var a=arguments.length,_=Array(a),$=0;$<a;$++)_[$]=arguments[$];return x(z(a=s.call.apply(s,[this].concat(_))),"name","RtmInvalidArgumentError"),a}Ga(o,e);var s=Ha(o);return o}(ud),da=function(e){function o(){va(this,o);for(var a=arguments.length,_=Array(a),$=0;$<a;$++)_[$]=arguments[$];return x(z(a=s.call.apply(s,[this].concat(_))),"name","RtmInvalidStatusError"),a}Ga(o,e);var s=Ha(o);return o}(ud),ic=function(e){function o(){va(this,o);for(var a=arguments.length,_=Array(a),$=0;$<a;$++)_[$]=arguments[$];return x(z(a=s.call.apply(s,[this].concat(_))),"name","RtmLimitExceededError"),a}Ga(o,e);var s=Ha(o);return o}(ud),bE=function(e){function o(){va(this,o);for(var a=arguments.length,_=Array(a),$=0;$<a;$++)_[$]=arguments[$];return x(z(a=s.call.apply(s,[this].concat(_))),"name","RtmInvokeTooOftenError"),a}Ga(o,e);var s=Ha(o);return o}(ud),Ja=function(e){function o(){va(this,o);for(var a=arguments.length,_=Array(a),$=0;$<a;$++)_[$]=arguments[$];return x(z(a=s.call.apply(s,[this].concat(_))),"name","RtmUnavailableError"),x(z(a),"serverCode",void 0),x(z(a),"statusCode",void 0),a}Ga(o,e);var s=Ha(o);return o}(ud),Bf=function(e){function o(){va(this,o);for(var a=arguments.length,_=Array(a),$=0;$<a;$++)_[$]=arguments[$];return x(z(a=s.call.apply(s,[this].concat(_))),"name","RtmUnauthenticatedError"),x(z(a),"serverCode",void 0),a}Ga(o,e);var s=Ha(o);return o}(ud),ve=function(e){function o(){va(this,o);for(var a=arguments.length,_=Array(a),$=0;$<a;$++)_[$]=arguments[$];return x(z(a=s.call.apply(s,[this].concat(_))),"name","RtmUnknownError"),a}Ga(o,e);var s=Ha(o);return o}(ud),Ab=function(e){return e instanceof Ub||e instanceof Tb},Na=function(e){return e instanceof ud},we=function(e,o,s){return['Executing "%s.%s" timed out after %ds',e,o,s/1e3]},cE=["CODE"],bc,Pd,S;(function(e){e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"})(S||(S={}));var dE={CN:S.CHINA,NA:S.NORTH_AMERICA,EU:S.EUROPE,AS:S.ASIA,JP:S.JAPAN,IN:S.INDIA,GLOB:S.GLOBAL,AF:S.AFRICA,OC:S.OVERSEA,OVS:S.OVERSEA,SA:S.SOUTH_AMERICA},kh=$n((bc={},x(bc,S.ASIA,{CODE:S.ASIA,AP_DOMAINS:["ap-web-1-asia.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-asia.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_AP:["proxy-ap-web-asia.agora.io"],PROXY_NGINX:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]}),x(bc,S.NORTH_AMERICA,{CODE:S.NORTH_AMERICA,AP_DOMAINS:["ap-web-1-north-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-north-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_AP:["proxy-ap-web-america.agora.io"],PROXY_NGINX:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]}),x(bc,S.EUROPE,{CODE:S.EUROPE,AP_DOMAINS:["ap-web-1-europe.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-europe.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_AP:["proxy-ap-web-europe.agora.io"],PROXY_NGINX:["europe.webrtc-cloud-proxy.sd-rtn.com"]}),x(bc,S.JAPAN,{CODE:S.JAPAN,AP_DOMAINS:["ap-web-1-japan.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-japan.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_AP:["proxy-ap-web-japan.agora.io"],PROXY_NGINX:["japan.webrtc-cloud-proxy.sd-rtn.com"]}),x(bc,S.INDIA,{CODE:S.INDIA,AP_DOMAINS:["ap-web-1-india.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-india.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_AP:["proxy-ap-web-india.agora.io"],PROXY_NGINX:["india.webrtc-cloud-proxy.sd-rtn.com"]}),x(bc,S.OVERSEA,{CODE:S.OVERSEA,AP_DOMAINS:["ap-web-1-oversea.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_AP:["proxy-ap-web-oversea.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.agora.io"]}),x(bc,S.GLOBAL,{CODE:S.GLOBAL,AP_DOMAINS:["ap-web-1.agora.io","ap-web-2.agora.io"],AP_BACKUP_DOMAINS:["ap-web-3.agora.io","ap-web-4.agora.io"],EVENT_REPORT_DOMAIN:["webcollector-rtm.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["webcollector-1.agora.io"],LOG_UPLOAD_SERVER:["logservice-rtm.agora.io"],PROXY_AP:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],PROXY_NGINX:["webrtc-cloud-proxy.sd-rtn.com"]}),x(bc,S.OCEANIA,{CODE:S.OCEANIA,AP_DOMAINS:["ap-web-1-oceania.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-oceania.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_AP:["proxy-ap-web-oceania.agora.io"],PROXY_NGINX:["oceania.webrtc-cloud-proxy.sd-rtn.com"]}),x(bc,S.SOUTH_AMERICA,{CODE:S.SOUTH_AMERICA,AP_DOMAINS:["ap-web-1-south-america.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-south-america.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_AP:["proxy-ap-web-south-america.agora.io"],PROXY_NGINX:["south-america.webrtc-cloud-proxy.sd-rtn.com"]}),x(bc,S.AFRICA,{CODE:S.AFRICA,AP_DOMAINS:["ap-web-1-africa.agora.io"],AP_BACKUP_DOMAINS:["ap-web-2-africa.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_AP:["proxy-ap-web-africa.agora.io"],PROXY_NGINX:["africa.webrtc-cloud-proxy.sd-rtn.com"]}),x(bc,S.CHINA,{CODE:S.CHINA,AP_DOMAINS:["webrtc2-2.ap.sd-rtn.com"],AP_BACKUP_DOMAINS:["webrtc2-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_AP:["proxy-ap-web.agoraio.cn"],PROXY_NGINX:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),bc)),Zf=(Pd={},x(Pd,S.ASIA,[S.CHINA,S.JAPAN,S.INDIA]),x(Pd,S.EUROPE,[]),x(Pd,S.NORTH_AMERICA,[]),x(Pd,S.SOUTH_AMERICA,[]),x(Pd,S.OCEANIA,[]),x(Pd,S.AFRICA,[]),Pd),Os=[S.OVERSEA,S.GLOBAL,S.CHINA,S.NORTH_AMERICA,S.EUROPE,S.ASIA,S.JAPAN,S.INDIA,S.OCEANIA,S.SOUTH_AMERICA,S.AFRICA],Nn=function(e){return Object.values(Zf).flat().includes(e)},Hv=function(e){var o;return(o=qh(Zf).find(function(s){return(s=$a(s,2))[0],s[1].includes(e)}))===null||o===void 0?void 0:o[0]},eE=function(e){return e.sort(function(o,s){return Os.indexOf(o)-Os.indexOf(s)})},Ve=function(e){var o=new Set;if((e=eE(e).slice(0,3).map(function(s){var a=kh[s];if(a===void 0)throw new rc("invalid area key");return s=a.CODE,a=Ki(a,cE),o.add(s),a})).length===0)throw new rc("areas cannot be empty");return Wa({CODES:o},e.reduce(function(s,a){for(var _=0,$=qh(s);_<$.length;_++){var _e=$a($[_],2),_n=_e[0];_e=_e[1],s[_n]=Array.from(new Set([].concat(Z(a[_n]),Z(_e))))}return s}))},fa,Ps=function(){var e=ma(N.mark(function o(s,a){var _,$,_e,_n,_r,_s=arguments;return N.wrap(function(na){for(;;)switch(na.prev=na.next){case 0:if(!(2<($=2<_s.length&&_s[2]!==void 0?_s[2]:0))){na.next=3;break}return na.abrupt("return");case 3:return _e={withCredentials:!0,body:s,timeout:2e4},_n=0<$?(fa==null?void 0:fa.LOG_UPLOAD_SERVER[0])||"rtm.logservice.sd-rtn.com":(fa==null?void 0:fa.LOG_UPLOAD_SERVER[0])||"logservice-rtm.agora.io",_r=a?"https://".concat((_=fa==null?void 0:fa.PROXY_NGINX[0])!==null&&_!==void 0?_:"webrtc-cloud-proxy.sd-rtn.com","/ls/?h=").concat(_n,"&p=443&d=upload/v1"):"https://".concat(_n,"/upload/v1"),na.next=8,lh(_r,_e).catch(function(ba){return Ps(s,a,$+1)});case 8:case"end":return na.stop()}},o)}));return function(o,s){return e.apply(this,arguments)}}(),Qs=new $D({processId:"process-".concat(Og),sdkVersion:"Agora_RTM_SDK_for_Web_".concat("v1.5.1-0-g5bbbcd72"),uploadRequest:Ps,rtmConfig:{}}),Sl="text payload rawMessage thumbnail attributeInfos keys value extra".split(" "),Rs="account ticket uid detail token account fileName cname user group key origin users src dst lastUpdateUserId channel cert wan_ip".split(" "),Ss=["serverReceivedTs","hasPeerReceived","messageType","enableNotificationToChannelMembers","lastUpdateTs"],fE="ChannelMessage MemberLeft MessageFromPeer LocalInvitationRefused LocalInvitationAccepted RemoteInvitationCanceled PeersOnlineStatusChanged AttributesUpdated MemberJoined".split(" "),We=function(e){if(typeof e=="string")return La(e);if(Array.isArray(e)&&e.every(function($){return typeof $=="string"}))return e.map(function($){return La($)});if(!Mm(e)){for(var o={},s=0;s<Ss.length;s++){var a=Ss[s];a in e&&(o[a]=e[a])}if(0<Object.keys(o).length)return o;if(5>Object.keys(e).length){for(s=0,e=Object.entries(e);s<e.length;s++){var _=$a(e[s],2);a=_[0],_=_[1],Sl.includes(a)?o[a]="[Hidden Info]":o[La(a)]=typeof _=="string"?La(_):"[Sensitive Info]"}return o}return"[Sensitive Info]"}return e},Ts=function(e){return qa(e)==="object"?De(e)?Zn(He(e,5),Sl,Rs):e.constructor&&e.constructor.name:e},Us=function(e,o){return e instanceof Error?e.message:typeof e!="string"?JSON.stringify(Zn(He(e,5),Sl,Rs)):(o=o.map(function(s){return s instanceof Error?s.message:qa(s)==="object"?Ks(Array.isArray(s)?s.map(Ts):Ts(s)):s}),Wn.apply(void 0,[e.replace(/%[%Oo]/g,function(s){return s==="%%"?"%":s==="%o"||s==="%O"?"%s":s})].concat(Z(o))))},gE=1,Vs=function(e,o,s){var a=Ls(e);return a.enabled=!0,a.log=s,a.useColors=!1,function(_){for(var $=arguments.length,_e=Array(1<$?$-1:0),_n=1;_n<$;_n++)_e[_n-1]=arguments[_n];if(o.enableLogUpload){$=oh(_);var _r=Us($,_e);Qs.upload({log_item_id:"".concat(gE++),log_level:e,payload_str:"[".concat(hE(),"] ").concat(e," - ").concat(256<_r.length?_r.slice(0,256):_r)})}switch($=function(_s){var na=_r||Us(oh(_),_e),ba=Ec.LOG_HANDLER;typeof ba=="function"&&ba({level:_s,message:na}),a(na)},e){case"RTM:INFO":o.logFilter.info&&$("log");break;case"RTM:WARN":o.logFilter.warn&&$("warning");break;case"RTM:ERROR":o.logFilter.error&&$("error");break;case"RTM:TRACK":o.logFilter.track&&$("log");break;case"RTM:MSG:RECV":case"RTM:MSG:SEND":o.logFilter.debug&&$("debug");break;case"RTM:DEBUG":o.logFilter.debug&&$("debug")}}},Tl,Ws=function(e){return function(o){var s=Tl===1||e===void 0?"":"Ins#".concat(e," ");return"".concat(s).concat(o)}},Ul=function(e,o,s){var a=Ws(Tl);return Vs("RTM:".concat(o),s,function(_){return e(a(_))})},sc=function(){return function(e){function o(a,_){var $=2<arguments.length&&arguments[2]!==void 0&&arguments[2];va(this,o);var _e=s.call(this);if(x(z(_e),"logError",void 0),x(z(_e),"invokeTracker",void 0),x(z(_e),"resultTracker",void 0),x(z(_e),"errorTracker",void 0),x(z(_e),"eventTracker",void 0),x(z(_e),"info",void 0),x(z(_e),"warn",void 0),x(z(_e),"log",void 0),x(z(_e),"genLogger",void 0),x(z(_e),"loggerId",void 0),x(z(_e),"logger",void 0),x(z(_e),"name",void 0),_e.logger=a,_e.name=_,_e.loggerId=a.loggerId,_e.info=a.info,_e.warn=a.warn,_e.logError=a.logError,_e.genLogger=a.genLogger,_e.log=a.genLogger("RTM:DEBUG","<".concat(_,"> ")),_e.invokeTracker=a.genTracker("Invoke"),_e.eventTracker=a.genTracker("Event"),_e.resultTracker=a.genTracker("Result"),_e.errorTracker=a.genTracker("Error"),$){var _n=_e.emit.bind(z(_e));_e.emit=function(){for(var _r=arguments.length,_s=Array(_r),na=0;na<_r;na++)_s[na]=arguments[na];_r=_s[0],na=_s.slice(1);var ba=fE.includes(_r);_e.eventTracker.apply(_e,["%s: ".concat(0<na.length?"%s emitted with args: ".concat(na.map(function(){return"%o"})):"%s emitted"),_,_r].concat(Z(ba?na.map(We):na)));try{_n.apply(void 0,_s)}catch(_p){_e.logError("Caught in the callback function of the event %s",_r,_p)}}}return _e}Ga(o,e);var s=Ha(o);return o}(Ba)},iE=function(e){return Ul(console.log.bind(console),"INFO",e)},jE=function(e){return Ul(console.warn.bind(console),"WARN",e)},kE=function(e){return Ul(console.error.bind(console),"ERROR",e)},Xs=function(e,o){return function(s){var a=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"",_=Ws(e),$=console.debug.bind(console),_e=Vs(s,o,function(_n){return $(_(_n))});return function(_n){for(var _r=arguments.length,_s=Array(1<_r?_r-1:0),na=1;na<_r;na++)_s[na-1]=arguments[na];return _e.apply(void 0,[a+_n].concat(_s))}}},lE=function(e,o){return function(s){return Xs(e,o)("RTM:TRACK","[".concat(s,"] "))}},Jv=Object.freeze({__proto__:null,Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191,RtmSdkMessageCount:510,default:{Counter:1,ApiExec:154,Session:164,ApEvent:165,Link:166,Logout:167,TxMessage:168,RxMessage:169,KickedOff:170,TxMessageRes:171,ChnJoin:172,ChnJoinRes:173,ChnLeave:174,ChnGetMembers:175,ChnGetMembersRes:176,ChnMemberJoined:177,ChnMemberLeft:178,QueryPeersOnlineStatus:179,QueryPeersOnlineStatusRes:180,RenewToken:181,OperateAttribute:186,OperateAttributeRes:187,ApRequest:188,LinkTcpEvent:189,LinkLoginRequest:190,ConnectionStateChange:191,RtmSdkMessageCount:510}}),Ka;(function(e){e[e.ChannelSMsg=1]="ChannelSMsg",e[e.ChannelRMsg=2]="ChannelRMsg",e[e.P2pSMsgOfflineFlag=3]="P2pSMsgOfflineFlag",e[e.P2pRMsgOfflineFlag=4]="P2pRMsgOfflineFlag",e[e.P2pSMsgNoOfflineFlag=5]="P2pSMsgNoOfflineFlag",e[e.P2pRMsgNoOfflineFlag=6]="P2pRMsgNoOfflineFlag",e[e.P2pCallInvitation=7]="P2pCallInvitation",e[e.P2pCallCancellation=8]="P2pCallCancellation",e[e.P2pCallAcceptance=9]="P2pCallAcceptance",e[e.P2pCallRefusal=10]="P2pCallRefusal"})(Ka||(Ka={}));var zi=function(e){function o(a,_,$){return va(this,o),x(z(_=s.call(this,_,"MessageReport")),"messagecount",_.getInitMessageCount()),x(z(_),"context",void 0),x(z(_),"rtmMessageCategory",void 0),x(z(_),"seq",P.fromNumber(1,!0)),_.context=a,_.rtmMessageCategory=$,_}Ga(o,e);var s=Ha(o);return eb(o,[{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1)}},{key:"getInitMessageCount",value:function(){return{peerack10mscount:P.fromNumber(0),peerack25mscount:P.fromNumber(0),peerack50mscount:P.fromNumber(0),peerack75mscount:P.fromNumber(0),peerack100mscount:P.fromNumber(0),peerack150mscount:P.fromNumber(0),peerack200mscount:P.fromNumber(0),peerack250mscount:P.fromNumber(0),peerack300mscount:P.fromNumber(0),peerack400mscount:P.fromNumber(0),peerack500mscount:P.fromNumber(0),peerack600mscount:P.fromNumber(0),peerack800mscount:P.fromNumber(0),peerack1000mscount:P.fromNumber(0),peerack2000mscount:P.fromNumber(0),peerack3000mscount:P.fromNumber(0),peerack5000mscount:P.fromNumber(0),peerack7000mscount:P.fromNumber(0),peerackslowcount:P.fromNumber(0),norecipientack10mscount:P.fromNumber(0),norecipientack25mscount:P.fromNumber(0),norecipientack50mscount:P.fromNumber(0),norecipientack75mscount:P.fromNumber(0),norecipientack100mscount:P.fromNumber(0),norecipientack150mscount:P.fromNumber(0),norecipientack200mscount:P.fromNumber(0),norecipientack250mscount:P.fromNumber(0),norecipientack300mscount:P.fromNumber(0),norecipientack400mscount:P.fromNumber(0),norecipientack500mscount:P.fromNumber(0),norecipientack600mscount:P.fromNumber(0),norecipientack800mscount:P.fromNumber(0),norecipientack1000mscount:P.fromNumber(0),norecipientack2000mscount:P.fromNumber(0),norecipientack3000mscount:P.fromNumber(0),norecipientack5000mscount:P.fromNumber(0),norecipientack7000mscount:P.fromNumber(0),norecipientackslowcount:P.fromNumber(0),sentcount:P.fromNumber(0),receivedcount:P.fromNumber(0),acktimeoutcount:P.fromNumber(0),toooftencount:0,receiverofflinecount:0,invalidmessagecount:0,unknowerrorcount:0,servercachedcount:0,timeoutcount:0,successcount:0}}},{key:"updatePeerAckCount",value:function(a){a/=2;for(var _=[[0,10],[10,25],[25,50],[50,75],[75,100],[100,150],[150,200],[200,250],[250,300],[300,400],[400,500],[500,600],[600,800],[800,1e3],[1e3,2e3],[2e3,3e3],[3e3,5e3],[5e3,7e3]],$=0;$<_.length;$++){var _e,_n=_[$];if(Is(a,_n[0],_n[1]))_n="peerack".concat(_n[1],"mscount"),this.messagecount[_n]=(_e=this.messagecount[_n])===null||_e===void 0?void 0:_e.add(1);else if(7e3<a){var _r;this.messagecount.peerackslowcount=(_r=this.messagecount.peerackslowcount)===null||_r===void 0?void 0:_r.add(1)}}}},{key:"updateNorecipientackCount",value:function(a){a/=2;for(var _=[[0,10],[10,25],[25,50],[50,75],[75,100],[100,150],[150,200],[200,250],[250,300],[300,400],[400,500],[500,600],[600,800],[800,1e3],[1e3,2e3],[2e3,3e3],[3e3,5e3],[5e3,7e3]],$=0;$<_.length;$++){var _e,_n=_[$];if(Is(a,_n[0],_n[1]))_n="norecipientack".concat(_n[1],"mscount"),this.messagecount[_n]=(_e=this.messagecount[_n])===null||_e===void 0?void 0:_e.add(1);else if(7e3<a){var _r;this.messagecount.norecipientackslowcount=(_r=this.messagecount.norecipientackslowcount)===null||_r===void 0?void 0:_r.add(1)}}}},{key:"updateCommonCount",value:function(a){var _=this.messagecount[a];P.isLong(_)?this.messagecount[a]=_.add(1):this.messagecount[a]=_+1}},{key:"report",value:function(){var a,_;bb("RtmSdkMessageCount",new Js(Wa(Wa({},this.messagecount),{},{vid:P.fromString((a=this.context.vid)!==null&&a!==void 0?a:"0"),os:7,lts:P.fromNumber(Date.now()),sid:this.context.sid,reportsequence:this.incGetSeq(),apimajorversion:4,apiminorversion:18,userid:this.context.uid,messagecategory:this.rtmMessageCategory})),(_=this.context.config.enableCloudProxy)!==null&&_!==void 0&&_),this.messagecount=Wa(Wa({},this.messagecount),{},{toooftencount:0,receiverofflinecount:0,invalidmessagecount:0,unknowerrorcount:0,servercachedcount:0,timeoutcount:0,successcount:0})}}]),o}(sc()),Un=new Map,hE=function(){var e=new Date;return"".concat(e.toISOString().split("T")[1].replace(/\..+/,""),".").concat(e.getMilliseconds())},Yf=Object.keys,qh=Object.entries.bind(Object),oh=function(e){return typeof e=="string"?e.endsWith(".")?e:"".concat(e,"."):e},yj=I.URI,Nv=wi,mE=Ki(oD,["Wrapper"]),bo=ql(mE,"URI"),Ys=function(e,o){var s=-1,a=e.length,_=a-1;for(o=o===void 0?a:o;++s<o;){var $=e[a=os(s,_)];e[a]=e[s],e[s]=$}return e.length=o,e},nE=function(e){return Ys(Pi(e))},oE=function(e){return Ys(zj(e))},Cf=function(e){return(ub(e)?nE:oE)(e)},Df={0:9591,1:9593},xe=function(e){var o=$f(null);return"https://".concat(o?null:e,"/api/v1")},pE=ob.apply(void 0,Z(Cf(["web-1.ap.sd-rtn.com","web-2.ap.sd-rtn.com"].map(xe)))),qE=ob.apply(void 0,Z(Cf(["ap-web-1.agora.io","ap-web-2.agora.io"].map(xe)))),rE=ob.apply(void 0,Z(Cf(["web-3.ap.sd-rtn.com","web-4.ap.sd-rtn.com"].map(xe)))),sE=ob.apply(void 0,Z(Cf(["ap-web-3.agora.io","ap-web-4.agora.io"].map(xe)))),Zs=yi(),Vl=function(e){function o(a,_,$,_e,_n,_r){var _s,na;va(this,o);var ba=s.call(this,_n,uj("Socket-",_n.loggerId));if(x(z(ba),"isActiveClose",!1),x(z(ba),"loggedIn",!1),x(z(ba),"useNewDomain",void 0),x(z(ba),"receivedPacket",new rb),x(z(ba),"open$",void 0),x(z(ba),"input$",new rb),x(z(ba),"userJoin$",new rb),x(z(ba),"attemptsSinceLastError",0),x(z(ba),"message$",new rb),x(z(ba),"socket$",void 0),x(z(ba),"toClose",new rb),x(z(ba),"toReconnect",new rb),x(z(ba),"sendLogger",void 0),x(z(ba),"receiveLogger",void 0),x(z(ba),"ip",void 0),x(z(ba),"env",void 0),x(z(ba),"ticket",void 0),x(z(ba),"context",void 0),x(z(ba),"getDomain",function(){return co(ba.ip,ba.useNewDomain)}),x(z(ba),"socketReconnector",function(_E){var _v=function(n_){return ba.attemptsSinceLastError+=1,ba.warn("The %s of Env %d reconnecting %s",ba.name,ba.env,n_.message),dd(3e3)};return _E.pipe(ab(function(n_){return ba.log("socket connection closed"),ba.loggedIn=!1,2<=ba.attemptsSinceLastError?(ba.warn("socket connection failure"),ba.emit("connectionFailure"),ba.close(),ra(n_)):ba.isActiveClose?Sb:(ba.emit("reconnect"),ba.useNewDomain=!ba.useNewDomain,ra(n_))}),Re(function(n_){return n_.pipe(Kb(_v))}))}),ba.ip=a,ba.env=_,ba.ticket=$,ba.context=_e,ba.useNewDomain=_r??.5<=Math.random(),ba.sendLogger=ba.genLogger("RTM:MSG:SEND"),ba.receiveLogger=ba.genLogger("RTM:MSG:RECV"),_!==0&&_!==1)throw new Zs({ILLEGAL_RTM_ENV:"The env number is out of rtm env count"});var _p=Df[_];ba.log("Opening websocket address %s for the Env %d",ba.ip,ba.env),bb("LinkLoginRequest",{sid:ba.context.sid,userId:ba.context.uid,lts:P.fromNumber(Date.now()),elapse:Xa(ba.context.startTime),destServerIp:ba.ip,linkId:ba.env},(_s=ba.context.config.enableCloudProxy||ba.context.socketUseProxy)!==null&&_s!==void 0&&_s),bb("LinkLoginRequest",{sid:ba.context.sid,userId:ba.context.uid,lts:P.fromNumber(Date.now()),elapse:Xa(ba.context.startTime),destServerIp:ba.ip,linkId:ba.env},(na=ba.context.config.enableCloudProxy||ba.context.socketUseProxy)!==null&&na!==void 0&&na);var _f=Jb(ba.input$,ba.userJoin$.pipe(Av(2)),ba.message$).pipe(Ea(function(_E){return wi.encode(_E).finish()}));return a=Jb(Bv("",{protocols:[],makeWebSocket:function(){if(ba.context.config.enableCloudProxy||ba.context.socketUseProxy){if(ba.context.cloudProxyServers.length===0)throw ba.logError("No cloud proxy server to connect"),new Ja;var _E=$f(null)?JSON.parse(null.replace(/-/g,".")):ba.context.cloudProxyServers;_E=Xe(_E="wss://".concat(co(On(_E),!1),"/"),"sid",ba.context.sid),_E=Xe(_E,"remote_port",_p.toString()),_E=Xe(_E,"remote_ip",ba.ip),_E=Xe(_E,"token",ba.context.key),_E=new WebSocket(_E)}else _E=new WebSocket("wss://".concat(ba.getDomain(),":").concat(_p));return _E.binaryType="arraybuffer",_E}}),ba.toReconnect),ba.socket$=fb(a,Dl.pipe(Lb(7e3),ab(function(_E){return Ab(_E)&&ba.warn("socket open timed out"),ra(_E)}))).pipe(Ea(function(_E){if(_E instanceof Error)throw ba.warn("Env_%d: Force reconnect the socket",ba.env),_E;return _E(_f).pipe(Ea(function(_v){return wi.decode(new Uint8Array(_v))}))}),ba.socketReconnector),ba.open$=ba.socket$.pipe(sa(function(_E){ba.log("Websocket opened",ba.name),_E.subscribe(function(_v){var n_=_v.data;_v=yj[_v.uri].slice(0,-3),n_=bo[_v].decode(n_);var e_=eC({},ql(n_,"toJSON"),function(b_,w_){return w_ instanceof P?Tn(w_):w_}),t_=!1;if((n_ instanceof ws||n_ instanceof vs)&&n_.instance.lessThanOrEqual(4294967295)&&(t_=!0),n_ instanceof xs||n_ instanceof ys){var o_=n_.instance,m_=n_.sequence;(n_.dialogue.lessThanOrEqual(4294967295)||o_.lessThanOrEqual(4294967295)||m_.lessThan(1))&&(t_=!0)}t_?ba.warn("Env_%d: Illegal %s, abandoned %o",ba.env,_v,e_):(_v!=="Pong"&&ba.receiveLogger("Env_%d: %s %o",ba.env,_v,e_),ba.receivedPacket.next([_v,n_]))},function(){})}),Uf(void 0),Kc(ba.toClose),Se()),ba}Ga(o,e);var s=Ha(o);return eb(o,[{key:"address",get:function(){return"".concat(this.ip,":").concat(Df[this.env])}},{key:"sendPacket",value:function(a,_){if(a!=="Ping"){var $=md(_,function(_e){return _e instanceof P?Tn(_e):_e});this.sendLogger("Env_%d: %s %o",this.env,a,$)}_=Mv(a,_),a==="UserJoin"?this.userJoin$.next(_):a==="Message"?this.message$.next(_):this.input$.next(_)}},{key:"close",value:function(){this.isActiveClose=!0,this.loggedIn=!1,this.toClose.next()}},{key:"fromReceived",value:function(a){return this.receivedPacket.pipe(yb(function(_){return $a(_,1)[0]===a}),Ea(function(_){return $a(_,2)[1]}))}},{key:"forceReconnect",value:function(){this.toReconnect.next(new Zs({FORCE_RECONNECTING:"Connection seems broken, try force reconnecting"}))}}]),o}(sc());ea({target:"String",proto:!0,forced:As},{padStart:function(e){return qD(this,e,1<arguments.length?arguments[1]:void 0)}});var tE=function(e){var o=Yf(kh);e=Lv(e);for(var s=0;s<o.length;s++){var a=kh[o[s]];if(a!=null&&a.AP_DOMAINS.includes(e)||a!=null&&a.AP_BACKUP_DOMAINS.includes(e)||a!=null&&a.PROXY_AP.includes(e))return[a.CODE]}return[S.CHINA,S.GLOBAL]},uE={INVALID_APP_ID:"Illegal App ID",NO_AUTHORIZED:"Signature verification failed",TOKEN_TIMEOUT:"Dynamic key expired",INVALID_TOKEN_UID:"UID in the security key(token) is not valid",APP_ID_NO_ACTIVATED:"The vendor is not activated",DYNAMIC_KEY_NOT_ENABLED:"The vendor did not enable the dynamic key, but uses the dynamic key",DYNAMIC_ENABLED_BUT_STATIC_KEY:"The vendor enabled the dynamic key, but uses the static key",TOKEN_EXPIRED:"The token has expired",INVALID_USER_ID:"The user ID to login does not match the token",FORBIDDEN_REGION:"Forbidden to access the request in this area",CANNOT_MEET_AREA_DEMAND:"Cannot allocate to meet the requirements of the given area limit"},$s={5:"INVALID_APP_ID",7:"INVALID_USER_ID",9:"NO_AUTHORIZED",10:"TOKEN_TIMEOUT",11:"APP_ID_NO_ACTIVATED",12:"INVALID_TOKEN_UID",13:"TOKEN_EXPIRED",14:"DYNAMIC_KEY_NOT_ENABLED",15:"DYNAMIC_ENABLED_BUT_STATIC_KEY",18:"FORBIDDEN_REGION",19:"CANNOT_MEET_AREA_DEMAND"},vE=[100,101,102],Ai=/web-(\d)/,at=function(e){function o(a,_){var $=2<arguments.length&&arguments[2]!==void 0&&arguments[2];va(this,o);var _e=s.call(this,_,"AccessPoint");return x(z(_e),"handleUniLbsError",function(_n,_r){var _s=_n;if(4<_n.toString().length){var na=_n.toString().padStart(8,"0"),ba=parseInt(na.slice(0,4),10);if(na=parseInt(na.slice(4,8),10),ba===201)_s=na;else if(ba===101&&!vE.includes(na))return ra(Error("service is currently unavailable"))}if(ba=_s.toString(),!Object.keys($s).includes(ba))return(_n=new Ja(["Login is rejected by the server. The response code is %d",_n],Pg)).serverCode=_s,ra(_n);switch(ba=$s[ba],_s=uE[ba],ba){case"INVALID_APP_ID":case"APP_ID_NO_ACTIVATED":return(_r=new Bf(_s,as)).serverCode=_n,ra(_r);case"INVALID_USER_ID":return(_r=new Bf(_s,si)).serverCode=_n,ra(_r);case"TOKEN_EXPIRED":case"TOKEN_TIMEOUT":return(_r=new Bf(_s,ti)).serverCode=_n,ra(_r);case"NO_AUTHORIZED":case"INVALID_TOKEN_UID":case"DYNAMIC_KEY_NOT_ENABLED":case"DYNAMIC_ENABLED_BUT_STATIC_KEY":return(_r=new Bf(_s,bs)).serverCode=_n,ra(_r);case"CANNOT_MEET_AREA_DEMAND":return(_r=tE(_r)).forEach(function(_p){return _e.failedAreas.add(_p)}),_e.failedAreas.size===(fa===void 0?2:fa.CODES.size)?((_r=new ca(_s,Pg)).serverCode=_n,ra(_r)):ra(Error("ap ".concat(_r.join(", ")," cannot meet requirement")));case"FORBIDDEN_REGION":return(_r=new Ja(_s,Pg)).serverCode=_n,ra(_r);default:return ra(Rn("ApResErrType",ba))}}),x(z(_e),"getApEdgeInfo$",void 0),x(z(_e),"getApEdgeInfoEndFirst$",void 0),x(z(_e),"apFinish$",new rb),x(z(_e),"retryCount",0),x(z(_e),"failedAreas",new Set),x(z(_e),"usedUrl",[]),x(z(_e),"newDomainUsed",!1),x(z(_e),"backupNewDomainUsed",!1),x(z(_e),"genUrl",function(){return fa===void 0?ej.apply(void 0,Z(Cf([pE,qE]))).pipe(fj(function(_n){return ob.apply(void 0,Z(_n))})):ob.apply(void 0,Z(fa.AP_DOMAINS.slice(0,3).map(xe)))}),x(z(_e),"genBackupUrl",function(){return fa===void 0?ej.apply(void 0,Z(Cf([rE,sE]))).pipe(fj(function(_n){return ob.apply(void 0,Z(_n))})):ob.apply(void 0,Z(fa.AP_BACKUP_DOMAINS.slice(0,3).map(xe)))}),x(z(_e),"getApUrl$",function(_n){var _r,_s;return _e.genUrl().pipe(yb(function(na){return(!_e.newDomainUsed||!na.includes("sd-rtn.com"))&&(na.includes("sd-rtn.com")&&(_e.newDomainUsed=!0),!Ol(_e.usedUrl,function(ba){var _p;return ba===((_p=na.match(Ai))===null||_p===void 0?void 0:_p[1])}))}),sa(function(na){var ba;fa===void 0&&typeof(na=(ba=na.match(Ai))===null||ba===void 0?void 0:ba[1])=="string"&&_e.usedUrl.push(na)}),hb(_n?Math.max(Ec.RECONNECTING_AP_NUM,(_r=fa==null?void 0:fa.CODES.size)!==null&&_r!==void 0?_r:0):(_s=fa==null?void 0:fa.CODES.size)!==null&&_s!==void 0?_s:2),$d(function(){return o.runOutOfUrlSymbol}),ab(function(na,ba){return _e.newDomainUsed=!1,na===o.runOutOfUrlSymbol?(_e.usedUrl=[],ba):ra(na)}))}),x(z(_e),"getBackupApUrl$",function(_n){var _r,_s;return _e.genBackupUrl().pipe(yb(function(na){return(!_e.backupNewDomainUsed||!na.includes("sd-rtn.com"))&&(na.includes("sd-rtn.com")&&(_e.backupNewDomainUsed=!0),!Ol(_e.usedUrl,function(ba){var _p;return ba===((_p=na.match(Ai))===null||_p===void 0?void 0:_p[1])}))}),sa(function(na){var ba;fa===void 0&&typeof(na=(ba=na.match(Ai))===null||ba===void 0?void 0:ba[1])=="string"&&_e.usedUrl.push(na)}),hb(_n?Math.max(Ec.RECONNECTING_AP_NUM,(_r=fa==null?void 0:fa.CODES.size)!==null&&_r!==void 0?_r:0):(_s=fa==null?void 0:fa.CODES.size)!==null&&_s!==void 0?_s:2),$d(function(){return o.runOutOfUrlSymbol}),ab(function(na,ba){return _e.backupNewDomainUsed=!1,na===o.runOutOfUrlSymbol?(_e.usedUrl=[],ba):ra(na)}))}),x(z(_e),"getProxyApUrl$",function(_n){var _r,_s;return ob.apply(void 0,Z(((fa==null?void 0:fa.PROXY_AP.slice(0,3))||["ap-proxy-1.agora.io","ap-proxy-2.agora.io"]).map(xe))).pipe(hb(_n?Math.max(Ec.RECONNECTING_AP_NUM,(_r=fa==null?void 0:fa.CODES.size)!==null&&_r!==void 0?_r:0):(_s=fa==null?void 0:fa.CODES.size)!==null&&_s!==void 0?_s:2))}),x(z(_e),"context",void 0),x(z(_e),"fetchCloudProxy",function(_n,_r){var _s=uj("AP-",_e.loggerId);_e.log("The AccessPoint requests %s(%s)",_n,_s);var na,ba=new AbortController;return _e.apFinish$.pipe(hb(1)).subscribe(function(){return ba.abort()}),yd(ma(N.mark(function _p(){var _f,_E;return N.wrap(function(_v){for(;;)switch(_v.prev=_v.next){case 0:return _E=mh(0,Number.MAX_SAFE_INTEGER),_e.log("%s request opid: %d",_s,_E),bb("ApRequest",{sid:_e.context.sid,userId:_e.context.uid,lts:P.fromNumber(Date.now()),elapse:Xa(_e.context.startTime),apAddr:_n,opId:P.fromNumber(_E),envId:0,flag:128},(_f=_e.context.config.enableCloudProxy)!==null&&_f!==void 0&&_f),_v.abrupt("return",lh(_n,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"90","Content-Type":"application/json"},body:{sid:_e.context.sid,opid:_E,appid:_e.context.appId,client_ts:Math.ceil(Date.now()/1e3),request_bodies:[{uri:22,buffer:{service_ids:[7,16],key:_r??_e.context.key,cname:_e.context.uid,uid:0,detail:Wa({},fa===void 0?{11:[S.CHINA,S.GLOBAL].join(),12:"1"}:{11:Array.from(fa.CODES).map(function(n_){return n_===S.OVERSEA?"".concat(S.ASIA,",").concat(S.EUROPE,",").concat(S.AFRICA,",").concat(S.NORTH_AMERICA,",").concat(S.SOUTH_AMERICA,",").concat(S.OCEANIA):n_}).join(","),12:"1"})}}]},signal:ba.signal}));case 4:case"end":return _v.stop()}},_p)}))).pipe(ab(function(_p){return _p.name!=="AbortError"&&(_e.logError(_p),_e.warn("The AP server %s request failure",_n,_p)),Sb}),Cb((na=ma(N.mark(function _p(_f){var _E,_v,n_,e_,t_,o_,m_,b_,w_,y_,N_,_y,v_,A_,k_,P_,T_,R_,I_;return N.wrap(function(U_){for(;;)switch(U_.prev=U_.next){case 0:if(_E=_f.responseText,_v=JSON.parse(_E),_e.log("The %s response is %o",_s,_v),((n_=_v.response_body)===void 0||n_.length===0||n_.some(function(D_){var n0;return((n0=D_.buffer)===null||n0===void 0?void 0:n0.code)===void 0||D_.uri!==23}))&&ra(new Ja("cloud proxy response_body not valid",Pg)),(e_=n_.filter(function(D_){return D_.buffer.code!==0})).length===0){U_.next=14;break}if((t_=e_.find(function(D_){return D_.buffer.flag===128}))===void 0){U_.next=12;break}return U_.abrupt("return",_e.handleUniLbsError(t_.buffer.code,_n));case 12:return _e.logError("cloud proxy error response"),U_.abrupt("return",_e.handleUniLbsError(e_[0].buffer.code,_n));case 14:for(o_=[],m_=0;m_<n_.length;m_++)if(((y_=n_[m_])==null||(b_=y_.buffer)===null||b_===void 0?void 0:b_.flag)===262144)(N_=y_.buffer)===null||N_===void 0||(_y=N_.edges_services)===null||_y===void 0||(v_=_y.forEach)===null||v_===void 0||v_.call(_y,function(D_){Pn(D_=D_.ip)&&_e.context.cloudProxyServers.indexOf(D_)===-1&&(_e.log("got cloud proxy server: %s",D_),_e.context.cloudProxyServers.push(D_))});else if((y_==null||(w_=y_.buffer)===null||w_===void 0?void 0:w_.flag)===128){for(T_=function(D_,n0){var a_=n0[D_];o_.some(function(s_){return s_.ip===a_.ip})||o_.push({ip:a_.ip,ticket:y_.buffer.cert})},R_=0,I_=y_.buffer.edges_services;R_<I_.length;R_++)T_(R_,I_);_e.context.rtmArea=(A_=(k_=y_.buffer)===null||k_===void 0||(P_=k_.detail)===null||P_===void 0?void 0:P_[9])!==null&&A_!==void 0?A_:""}return U_.abrupt("return",ob.apply(void 0,Z(o_).concat([Mg])));case 19:case"end":return U_.stop()}},_p)})),function(_p){return na.apply(this,arguments)})),ab(function(_p){return Na(_p)?ra(_p):Sb}),bh(),yb(function(_p){return _p!==void 0&&typeof _p.ip=="string"&&typeof _p.ticket=="string"&&Pn(_p.ip)}))}),x(z(_e),"fetchAp",function(_n,_r){var _s=uj("AP-",_e.loggerId);_e.log("The AccessPoint requests %s(%s)",_n,_s);var na=new AbortController;_e.apFinish$.pipe(hb(1)).subscribe(function(){return na.abort()});var ba,_p=mh(0,Number.MAX_SAFE_INTEGER);return yd(ma(N.mark(function _f(){var _E;return N.wrap(function(_v){for(;;)switch(_v.prev=_v.next){case 0:return _e.log("%s request opid: %d",_s,_p),bb("ApRequest",{sid:_e.context.sid,userId:_e.context.uid,lts:P.fromNumber(Date.now()),elapse:Xa(_e.context.startTime),apAddr:_n,opId:P.fromNumber(_p),envId:0,flag:128},(_E=_e.context.config.enableCloudProxy)!==null&&_E!==void 0&&_E),_v.abrupt("return",lh(_n,{headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"69","Content-Type":"application/json"},body:{flag:128,opid:_p,key:_r||_e.context.key,cname:_e.context.uid,detail:Wa({},fa===void 0?{11:[S.CHINA,S.GLOBAL].join(),12:"1"}:{11:Array.from(fa.CODES).map(function(n_){return n_===S.OVERSEA?"".concat(S.ASIA,",").concat(S.EUROPE,",").concat(S.AFRICA,",").concat(S.NORTH_AMERICA,",").concat(S.SOUTH_AMERICA,",").concat(S.OCEANIA):n_}).join(","),12:"1"}),uid:0,sid:_e.context.sid},signal:na.signal}));case 3:case"end":return _v.stop()}},_f)}))).pipe(ab(function(_f){return _f.name!=="AbortError"&&(_e.logError(_f),_e.warn("The AP server %s request failure",_n,_f)),Sb}),Cb((ba=ma(N.mark(function _f(_E){var _v,n_,e_,t_,o_,m_,b_,w_,y_;return N.wrap(function(N_){for(;;)switch(N_.prev=N_.next){case 0:if(n_=_E.responseText,e_=JSON.parse(n_),_e.log("The %s response is %o",_s,e_),o_=(t_=e_).code,m_=t_.addresses,b_=t_.detail,_e.context.vid=b_[8],bb("ApEvent",{sid:_e.context.sid,userId:_e.context.uid,lts:P.fromNumber(Date.now()),elapse:Xa(_e.context.startTime),apAddr:_n,linkServerList:m_.map(function(_y){return _y.ip}),serverErrCode:o_,flag:128,envId:0,opId:P.fromNumber(_p),errCode:0,area:b_[9],isp:b_[2]},(_v=_e.context.config.enableCloudProxy)!==null&&_v!==void 0&&_v),_e.info(e_),o_===0){N_.next=9;break}return N_.abrupt("return",_e.handleUniLbsError(o_,_n));case 9:if(w_=m_,$f(null)&&(y_=JSON.parse(null.replace(/-/g,".")),w_=y_.map(function(_y){return{ip:_y,ticket:w_[0].ticket}})),w_.length!==0){N_.next=14;break}return N_.abrupt("return",ra(Error("No available edge address to connect")));case 14:return _e.context.rtmArea=b_==null?void 0:b_[9],N_.abrupt("return",ob.apply(void 0,Z(w_).concat([Mg])));case 16:case"end":return N_.stop()}},_f)})),function(_f){return ba.apply(this,arguments)})),bh(),ab(function(_f){return Na(_f)?ra(_f):Sb}),yb(function(_f){return _f!==void 0&&typeof _f.ip=="string"&&typeof _f.ticket=="string"}))}),_e.context=a,_e.getApEdgeInfoEndFirst$=function(){var _n=0<arguments.length&&arguments[0]!==void 0&&arguments[0];return dd(0,_n||$?Ec.RECONNECTING_AP_INTERVAL:2e3).pipe(hb(1),sa(function(){_e.retryCount+=1}),Cb(function(){return _e.context.config.enableCloudProxy||_e.context.socketUseProxy?_e.getProxyApUrl$(_n||$):(4<=_e.retryCount&&(_e.retryCount=0),3>=_e.retryCount?_e.getApUrl$(_n||$):_e.getBackupApUrl$(_n||$))}),Cb(function(_r){return _e.context.config.enableCloudProxy||_e.context.socketUseProxy?_e.fetchCloudProxy(_r):_e.fetchAp(_r)}),ab(function(_r){return _r instanceof Tb&&_e.warn("AP request timeout"),ra(_r)}),tn(function(_r){return _r.ip}),Kc(_e.apFinish$))},_e.getApEdgeInfo$=function(_n){return dd(0,_n||$?Ec.RECONNECTING_AP_INTERVAL:2e3).pipe(hb(8),sa(function(){_e.retryCount+=1}),Cb(function(){return _e.context.config.enableCloudProxy||_e.context.socketUseProxy?_e.getProxyApUrl$(_n||$):3>=_e.retryCount?_e.getApUrl$(_n||$):_e.getBackupApUrl$(_n||$)}),Cb(function(_r){return(_e.context.config.enableCloudProxy||_e.context.socketUseProxy?_e.fetchCloudProxy(_r):_e.fetchAp(_r)).pipe()}),ab(function(_r){return _r instanceof Tb&&_e.warn("AP request timeout"),ra(_r)}),tn(function(_r){return _r.ip}),Kc(_e.apFinish$))},_e}Ga(o,e);var s=Ha(o);return eb(o,[{key:"clearUp",value:function(){this.failedAreas.clear(),this.retryCount=0}}]),o}(sc());x(at,"runOutOfUrlSymbol",Symbol("AP urls are used up"));var bt=yi(),ct=function(e){function o(a,_,$){va(this,o);var _e=s.call(this,_,"Connection");x(z(_e),"apClient",void 0),x(z(_e),"lastOpenSockets",[new Te(1),new Te(1)]),x(z(_e),"curOpenSockets",[void 0,void 0]),x(z(_e),"ipIterator",0),x(z(_e),"loginSocketOpenFailureCount",0),x(z(_e),"firstEnv",.5<=Math.random()?1:0),x(z(_e),"firstSocketOpener",void 0),x(z(_e),"secondSocketOpener",void 0),x(z(_e),"firstOpenKeeperSubject",new rb),x(z(_e),"secondOpenKeeperSubject",new rb),x(z(_e),"blacklistedIP",{}),x(z(_e),"edgeInfoReplayed",void 0),x(z(_e),"firstEnvOpenSocket",void 0),x(z(_e),"firstOpenKeeperSub",void 0),x(z(_e),"secondOpenKeeperSub",void 0),x(z(_e),"context",void 0),x(z(_e),"logger",void 0),_e.context=a,_e.logger=_,_e.apClient=new at(_e.context,_),_e.apClient.apFinish$.subscribe(function(){_e.log("Ap client fetch finished")});var _n,_r=[];return _e.edgeInfoReplayed=_e.apClient.getApEdgeInfo$($).pipe(Re(function(_s){return _s.pipe(sa(function(na){if(Na(na))throw na}),Zd($?ue.getParameter("RECONNECTING_AP_INTERVAL"):900),Kc(dd(2e4)))}),yb(function(_s){var na;return!Ol(_r,_s)&&1>=((na=_e.blacklistedIP[_s.ip])!==null&&na!==void 0?na:0)}),$d(function(){return new bt({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),sa(function(_s){_r.push(_s),_e.log("An edge info got %o",_s)}),sa({error:function(_s){_e.emit("connectionInitFailure",_s)}}),fh(function(){_e.apClient.clearUp()}),wn()),_e.firstEnvOpenSocket=_e.edgeInfoReplayed.pipe(Cb(function(_s){if(_s===void 0)return ra(Error("Invalid edge info"));var na=new Vl(_s.ip,_e.firstEnv,_s.ticket,_e.context,_,_n);if(_e.firstEnv=_e.firstEnv===1?0:1,na.once("connectionFailure",function(){return _e.onSocketConnectionFailure(na)}),!$&&Ec.ENABLE_EDGE_AUTO_FALLBACK&&!_e.context.config.enableCloudProxy){var ba,_p=Date.now();na.on("reconnect",function(){var _f;_e.loginSocketOpenFailureCount+=1,(_f=ba)!==null&&_f!==void 0||(ba=Date.now()-_p),500>ba&&1<_e.loginSocketOpenFailureCount&&(_e.context.socketUseProxy=!0)})}return _n=!na.useNewDomain,na.open$.pipe(Uf(na))}),sa(function(_s){_e.log("The websocket of ENV_%d opened to %s:%d",_s.env,_s.ip,Df[_s.env]),_e.curOpenSockets[_s.env]=_s,_e.lastOpenSockets[_s.env].next(_s),_e.firstEnv=_s.env,_e.openSecondSocket(_s.env,_s.ip,_s.useNewDomain)}),hb(1),Se()),_e.firstSocketOpener=_e.firstEnvOpenSocket.pipe(Cb(function(_s){return _s.open$.pipe(sa(function(){_e.log("The websocket of first ENV_%d re-opened to %s:%d",_s.env,_s.ip,Df[_s.env]),_e.curOpenSockets[_s.env]=_s,_e.lastOpenSockets[_s.env].next(_s)}))})),a=_e.firstOpenKeeperSubject.pipe(Kb(wd)),_e.firstOpenKeeperSub=a.subscribe({error:_e.logError}),_e}Ga(o,e);var s=Ha(o);return eb(o,[{key:"initConnection",value:function(){this.firstOpenKeeperSubject.next(this.firstSocketOpener)}},{key:"closeSocket",value:function(a,_){if(![0,1].includes(a))throw new mb({INVALID_ENV:"The env argument is not 0 or 1"});var $=a===this.firstEnv?this.firstOpenKeeperSub:this.secondOpenKeeperSub;this.firstOpenKeeperSub=void 0;var _e=this.curOpenSockets[a];this.curOpenSockets[a]=void 0,_e&&(_e.isActiveClose=!0,setTimeout(function(){_e.close()},_)),$!==void 0&&setTimeout(function(){$==null||$.unsubscribe()},_)}},{key:"waitClosing",value:function(a){var _=this;return a.isActiveClose=!0,a.open$.pipe(ev(),ab(function($){return $.message===ns.normalClosureMessage?Sb:ra($)}),Lb(5e3),ab(function($){return $ instanceof Tb?(_.warn("Force closing the ENV_%d connection",a.env),Sb):ra($)}))}},{key:"onSocketConnectionFailure",value:function(a){var _=[0,1].filter(function($){return $!==a.env})[0];(_=this.curOpenSockets[_])&&_.loggedIn?this.reopenSocketWithApRequest(a.env):this.emit("socketsFailure")}},{key:"openSecondSocket",value:function(a,_,$){var _e=this,_n=a===1?0:1;this.secondSocketOpener=this.edgeInfoReplayed.pipe(vn(function(_r,_s){return[].concat(Z(_r),[_s])},[]),Ea(function(_r){return ls(_r,function(_s){return Sn(_,_s.ip)}).slice(-1)[0]}),hb(1),Cb(function(_r){if(_r===void 0)return ra(Error("Invalid edge info"));var _s=new Vl(_r.ip,_n,_r.ticket,_e.context,_e.logger,$);return _s.on("connectionFailure",function(){return _e.onSocketConnectionFailure(_s)}),_s.open$.pipe(sa(function(){_e.lastOpenSockets[_n].next(_s),_e.curOpenSockets[_n]=_s}))}),Se()),this.secondOpenKeeperSub=this.secondOpenKeeperSubject.pipe(Kb(wd)).subscribe({error:this.logError}),this.secondOpenKeeperSubject.next(this.secondSocketOpener)}},{key:"reopenSocketWithApRequest",value:function(a){var _=this,$=[0,1].filter(function(_r){return _r!==a})[0];if(($=this.curOpenSockets[$])!==void 0){var _e,_n=$.ip;$=this.apClient.getApEdgeInfoEndFirst$(!0).pipe($d(function(){return new bt({AP_NO_AVAILABLE_EDGE:"No available edge address to connect"})}),Re(function(_r){return _r.pipe(sa(function(_s){if(_s.code===ti)_.emit("tokenExpired"),_.apClient.apFinish$.next(void 0);else if(Na(_s))throw _s}),Zd(ue.getParameter("RECONNECTING_AP_INTERVAL")),Kc(dd(15e3)))}),sa(function(_r){_.log("An edge info got %o",_r)}),fh(function(){_.apClient.clearUp()})).pipe(vn(function(_r,_s){return[].concat(Z(_r),[_s])},[]),Ea(function(_r){return(_r=ls(_r,function(_s){return Sn(_n,_s.ip)})).length-1>=_.ipIterator?_r.slice(-_.ipIterator++-1)[0]:(_.ipIterator=0,_r.slice(-1)[0])}),$d(),Cb(function(_r){if(_r===void 0)return ra(Error("Invalid edge info"));var _s=new Vl(_r.ip,a,_r.ticket,_.context,_.logger,_e);return _s.on("connectionFailure",function(){return _.onSocketConnectionFailure(_s)}),_e=!_s.useNewDomain,_s.open$.pipe(Uf(_s))}),sa(function(_r){_.log("The websocket of ENV_%d re-opened to %s:%d using ap",_r.env,_r.ip,Df[_r.env]),_.curOpenSockets[a]=_r,_.lastOpenSockets[a].next(_r)}),Cb(function(_r){return _r.open$.pipe(sa(function(){_.log("The websocket of ENV_%d re-opened to %s:%d",_r.env,_r.ip,Df[_r.env]),_.curOpenSockets[a]=_r,_.lastOpenSockets[a].next(_r)}))}),Se()),a===this.firstEnv?this.firstOpenKeeperSubject.next($):this.secondOpenKeeperSubject.next($)}}}]),o}(sc()),xE=function(e){function o(a,_,$){return va(this,o),x(z($=s.call(this,$,"Context")),"_token",void 0),x(z($),"config",void 0),x(z($),"_uid",void 0),x(z($),"_sid",void 0),x(z($),"_vid",void 0),x(z($),"_startTime",void 0),x(z($),"_area","CN"),x(z($),"_socketUseProxy",!1),x(z($),"appId",void 0),x(z($),"enableCloudProxy",!1),x(z($),"cloudProxyServers",[]),$.appId=a,$.config=_,$}Ga(o,e);var s=Ha(o);return eb(o,[{key:"socketUseProxy",get:function(){return this._socketUseProxy&&Ec.ENABLE_EDGE_AUTO_FALLBACK},set:function(a){this.log("socketUseProxy is set to %s",a),this._socketUseProxy=a}},{key:"token",set:function(a){this._token=typeof a=="string"&&a?a:void 0}},{key:"uid",get:function(){if(typeof this._uid=="string"&&this._uid)return this._uid;throw new rc("Cannot get illegal uid")},set:function(a){if(this.log("The user ID is set to %s",La(a)),!Ta(a))throw new rc;this._uid=a}},{key:"vid",get:function(){if(typeof this._vid=="string"&&this._vid)return this._vid;throw new rc("Cannot get illegal vid")},set:function(a){this._vid=a}},{key:"key",get:function(){if(typeof this._token=="string"&&this._token)return this._token;if(typeof this.appId=="string"&&this.appId)return this.appId;throw new rc("Cannot get illegal key")}},{key:"sid",get:function(){if(typeof this._sid=="string"&&this._sid)return this._sid;throw new rc("Cannot get illegal sid")},set:function(a){if(this.log("sid is set to %s",a),typeof a!="string"||!a)throw new rc;this._sid=a}},{key:"startTime",get:function(){if(typeof this._startTime=="number"&&this._startTime)return this._startTime;throw new rc("Cannot get illegal startTime")},set:function(a){if(this.log("startTime is set to %s",a),typeof a!="number"||!a)throw new rc;this._startTime=a}},{key:"rtmArea",get:function(){if(typeof this._area=="string"&&this._area)return this._area;throw new rc("Cannot get illegal area")},set:function(a){this.log("area is set to %s",a),typeof a=="string"&&a?this._area=a:this.warn("set area failed")}}]),o}(sc());Sp("of",function(){for(var e=0,o=arguments.length,s=new(qf(this))(o);o>e;)s[e]=arguments[e++];return s},rk);var yE=Math.max,Pv=function(e,o,s){var a=Object(e);if(!ae(e)){var _=wf(o);e=Wd(e),o=function($){return _(a[$],$,a)}}return-1<(o=function($,_e,_n){var _r=$==null?0:$.length;if(!_r)return-1;if(_n==null)_n=0;else{var _s=(_n=Rl(_n))%1;_n=_n==_n?_s?_n-_s:_n:0}return 0>_n&&(_n=yE(_r+_n,0)),Yq($,wf(_e),_n)}(e,o,s))?a[_?e[o]:o]:void 0},Ov=function(e,o){return e&&e.length?fl(e,void 0,typeof o=="function"?o:void 0):[]},dt=function(){function e(){va(this,e),x(this,"size",0),x(this,"fields",new Map)}return eb(e,[{key:"define",value:function(o,s,a){if(this.size+=a,64<this.size)throw new RangeError("the struct over 64 bits is not supported");th(s={val:0,isNumber:s==="number",isBoolean:s==="boolean",oneof:s==="number"||s==="boolean"?void 0:s,len:a}),this.fields.set(o,s)}},{key:"set",value:function(o,s){if(!(o=this.fields.get(o)))throw Error("field not found");var a=o.oneof;if(!P.isLong(s)&&typeof s!="number")if(typeof s=="boolean")s=s?1:0;else{if(a===void 0)throw Error("invalid field type");if((s=a[s])===void 0)throw Error("field type not found")}th(o,s),o.val=s}},{key:"toNumber",value:function(){for(var o=0,s=0,a=0,_=Array.from(this.fields);a<_.length;a++){var $=$a(_[a],2)[1],_e=$.len;($=$.val)!==void 0&&(o+=P.fromValue($).shiftLeft(s).toNumber(),s+=_e)}return o}},{key:"toLong",value:function(){for(var o=P.fromNumber(0,!0),s=0,a=0,_=Array.from(this.fields);a<_.length;a++){var $=$a(_[a],2)[1],_e=$.len;($=$.val)!==void 0&&(o=P.fromValue($).shiftLeft(s).add(o),s+=_e)}return o}},{key:"assert",value:function(o,s){function a(_e){if(!P.isLong(_e)&&typeof _e!="number")if(typeof _e=="boolean")_e=_e?1:0;else{if($===void 0)throw Error("invalid field type");if((_e=$[_e])===void 0)throw Error("field type not found")}return th(_,_e),sh(_e,_.val)}var _=this.fields.get(o);if(!_)throw Error("field not found");var $=_.oneof;if(!Array.isArray(s))return a(s);if(s.length===1)return a(s[0]);if(s.every(function(_e){return typeof _e=="string"})&&$!==void 0)return s.some(function(_e){return a(_e)});throw Error("invalid valueTypes")}},{key:"from",value:function(o){o=P.fromValue(o);for(var s=0,a=0,_=Array.from(this.fields);a<_.length;a++){var $=$a(_[a],2)[1],_e=$.len,_n=P.fromNumber(Math.pow(2,_e)-1,!0).shiftLeft(s);th($,_n=o.and(_n).shiftRightUnsigned(s)),$.val=_n,s+=_e}}},{key:"typeOf",value:function(o){if((o=this.fields.get(o))!==void 0){var s=o.oneof;if(o=o.val,s!==void 0){var a=0;for(s=Object.entries(s);a<s.length;a++){var _=$a(s[a],2),$=_[0];if(sh(o,_[1]))return $}}}throw new TypeError("can only get type of oneof type")}}]),e}(),et=function(e){function o(a){va(this,o);var _=s.call(this);return _.define("Rejoin","boolean",1),_.define("Unused","number",31),_.define("Platform","number",8),_.define("Version","number",12),_.define("Subversion","number",12),_.set("Platform",7),_.set("Version",4),_.set("Subversion",18),_.set("Rejoin",a),_}Ga(o,e);var s=Ha(o);return o}(dt),zE=Wa(Wa({},{PeerTextMessage:0,ChannelTextMessage:1,VendorTextMessage:2}),{PeerRawMessage:3,ChannelRawMessage:4,VendorRawMessage:5}),ft={CallInvite:101,CallAccept:102,CallReject:103,CallCancel:104},AE=Wa(Wa({},zE),ft),BE={Uncompressed:0,Zlib:1},Ef=function(e){function o(a){va(this,o);var _=s.call(this);if(_.define("MessageType",AE,8),_.define("BroadcastJumps","number",2),_.define("ToCache","boolean",1),_.define("FromCache","boolean",1),_.define("CompressionMethod",BE,2),_.define("IterationNumber","number",4),_.define("BufferedMessage","boolean",1),_.define("ToArchive","boolean",1),_.define("FromArchive","boolean",1),typeof a=="number"||P.isLong(a))_.from(a);else if(a!==void 0){var $=0;for(a=qh(a);$<a.length;$++){var _e=$a(a[$],2);_.set(_e[0],_e[1])}}return _}Ga(o,e);var s=Ha(o);return eb(o,[{key:"isTextMessage",value:function(){return this.assert("MessageType",["PeerTextMessage","ChannelTextMessage","VendorTextMessage"])}},{key:"isRawMessage",value:function(){return this.assert("MessageType",["ChannelRawMessage","PeerRawMessage","VendorRawMessage"])}},{key:"isRawPeerMessage",value:function(){return this.assert("MessageType","PeerRawMessage")}},{key:"isRawChannelMessage",value:function(){return this.assert("MessageType","ChannelRawMessage")}},{key:"isPeerTextMessage",value:function(){return this.assert("MessageType","PeerTextMessage")}},{key:"isChannelTextMessage",value:function(){return this.assert("MessageType","ChannelTextMessage")}},{key:"isInvitation",value:function(a){var _=this;return a!==void 0?this.assert("MessageType",a):Yf(ft).some(function($){return _.assert("MessageType",$)})}},{key:"isPeerMessage",value:function(){return this.assert("MessageType",["PeerTextMessage","PeerRawMessage"])}},{key:"isZlibCompressed",value:function(){return this.assert("CompressionMethod","Zlib")}},{key:"isFromCache",value:function(){return this.assert("FromCache",!0)}},{key:"isBufferedMessage",value:function(){return this.assert("BufferedMessage",!0)}},{key:"getInvitationType",value:function(){if(!this.isInvitation())throw new TypeError("cannot get InvitationType of a normal message type");return this.typeOf("MessageType")}}]),o}(dt),CE=function(e){function o(a){return va(this,o),x(z(a=s.call(this,a,"ChatManager")),"dialogueLru",new xz(void 0,{maxlen:1e4,ttl:1e4})),a}Ga(o,e);var s=Ha(o);return eb(o,[{key:"getChatInfo",value:function(a){var _=this.dialogueLru.get(a);if(this.dialogueLru.prune(),_){var $=_.dialogue,_e={dialogue:$,sequence:_=_.sequence.add(1)};return this.dialogueLru.set(a,{dialogue:$,sequence:_}),_e}return $={dialogue:nh(),sequence:P.fromNumber(1,!0)},this.dialogueLru.set(a,$),$}}]),o}(sc()),G={};qa(module)=="object"&&(module.exports=G),G.parse=function(e,o){var s,a=G.bin.readUshort,_=G.bin.readUint,$={};for(s=(e=new Uint8Array(e)).length-4;_(e,s)!=101010256;)s--;var _e=a(e,s=s+4+4);a(e,s+=2),_(e,s+=2),s=_(e,s+=4);for(var _n=0;_n<_e;_n++){_(e,s),s+=4,s+=4,s+=4,_(e,s+=4);var _r=_(e,s+=4),_s=_(e,s+=4),na=a(e,s+=4),ba=a(e,s+2),_p=a(e,s+4);s+=6;var _f=_(e,s+=8);s+=4,s+=na+ba+_p,G._readLocal(e,_f,$,_r,_s,o)}return $},G._readLocal=function(e,o,s,a,_,$){var _e=G.bin.readUshort,_n=G.bin.readUint;_n(e,o),_e(e,o+=4),_e(e,o+=2);var _r=_e(e,o+=2);_n(e,o+=2),_n(e,o+=4),_n=_e(e,o=o+4+8);var _s=_e(e,o+=2);if(o+=2,_e=G.bin.readUTF8(e,o,_n),o=o+_n+_s,$)s[_e]={size:_,csize:a};else if(e=new Uint8Array(e.buffer,o),_r==0)s[_e]=new Uint8Array(e.buffer.slice(o,o+a));else{if(_r!=8)throw"unknown compression method: "+_r;o=new Uint8Array(_),G.inflateRaw(e,o),s[_e]=o}},G.inflateRaw=function(e,o){return G.F.inflate(e,o)},G.inflate=function(e,o){return e[0],e[1],G.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-2),o)},G.deflate=function(e,o){o==null&&(o={level:6});var s=0,a=new Uint8Array(50+Math.floor(1.1*e.length));return a[s]=120,a[s+1]=156,s=G.F.deflateRaw(e,a,s+2,o.level),e=G.adler(e,0,e.length),a[s+0]=e>>>24&255,a[s+1]=e>>>16&255,a[s+2]=e>>>8&255,a[s+3]=e>>>0&255,new Uint8Array(a.buffer,0,s+4)},G.deflateRaw=function(e,o){o==null&&(o={level:6});var s=new Uint8Array(50+Math.floor(1.1*e.length)),a=G.F.deflateRaw(e,s,a,o.level);return new Uint8Array(s.buffer,0,a)},G.encode=function(e,o){o==null&&(o=!1);var s,a=0,_=G.bin.writeUint,$=G.bin.writeUshort,_e={};for(s in e){var _n=!G._noNeed(s)&&!o,_r=e[s],_s=G.crc.crc(_r,0,_r.length);_e[s]={cpr:_n,usize:_r.length,crc:_s,file:_n?G.deflateRaw(_r):_r}}for(s in _e)a+=_e[s].file.length+30+46+2*G.bin.sizeUTF8(s);for(s in e=new Uint8Array(a+22),o=0,_r=[],_e)_s=_e[s],_r.push(o),o=G._writeHeader(e,o,s,_s,0);for(s in a=0,_n=o,_e)_s=_e[s],_r.push(o),o=G._writeHeader(e,o,s,_s,1,_r[a++]);return _e=o-_n,_(e,o,101010256),$(e,o=o+4+4,a),$(e,o+=2,a),_(e,o+=2,_e),_(e,o+4,_n),e.buffer},G._noNeed=function(e){return e=e.split(".").pop().toLowerCase(),"png,jpg,jpeg,zip".indexOf(e)!=-1},G._writeHeader=function(e,o,s,a,_,$){var _e=G.bin.writeUint,_n=G.bin.writeUshort,_r=a.file;return _e(e,o,_==0?67324752:33639248),o+=4,_==1&&(o+=2),_n(e,o,20),_n(e,o+=2,0),_n(e,o+=2,a.cpr?8:0),_e(e,o+=2,0),_e(e,o+=4,a.crc),_e(e,o+=4,_r.length),_e(e,o+=4,a.usize),_n(e,o+=4,G.bin.sizeUTF8(s)),_n(e,o+=2,0),o+=2,_==1&&(_e(e,o=o+2+2+6,$),o+=4),o+=s=G.bin.writeUTF8(e,o,s),_==0&&(e.set(_r,o),o+=_r.length),o},G.crc={table:function(){for(var e=new Uint32Array(256),o=0;256>o;o++){for(var s=o,a=0;8>a;a++)s=1&s?3988292384^s>>>1:s>>>1;e[o]=s}return e}(),update:function(e,o,s,a){for(var _=0;_<a;_++)e=G.crc.table[255&(e^o[s+_])]^e>>>8;return e},crc:function(e,o,s){return 4294967295^G.crc.update(4294967295,e,o,s)}},G.adler=function(e,o,s){var a=1,_=0,$=o;for(o+=s;$<o;){for(s=Math.min($+5552,o);$<s;)_+=a+=e[$++];a%=65521,_%=65521}return _<<16|a},G.bin={readUshort:function(e,o){return e[o]|e[o+1]<<8},writeUshort:function(e,o,s){e[o]=255&s,e[o+1]=s>>8&255},readUint:function(e,o){return 16777216*e[o+3]+(e[o+2]<<16|e[o+1]<<8|e[o])},writeUint:function(e,o,s){e[o]=255&s,e[o+1]=s>>8&255,e[o+2]=s>>16&255,e[o+3]=s>>24&255},readASCII:function(e,o,s){for(var a="",_=0;_<s;_++)a+=String.fromCharCode(e[o+_]);return a},writeASCII:function(e,o,s){for(var a=0;a<s.length;a++)e[o+a]=s.charCodeAt(a)},pad:function(e){return 2>e.length?"0"+e:e},readUTF8:function(e,o,s){for(var a,_="",$=0;$<s;$++)_+="%"+G.bin.pad(e[o+$].toString(16));try{a=decodeURIComponent(_)}catch{return G.bin.readASCII(e,o,s)}return a},writeUTF8:function(e,o,s){for(var a=s.length,_=0,$=0;$<a;$++){var _e=s.charCodeAt($);if(!(4294967168&_e))e[o+_]=_e,_++;else if(!(4294965248&_e))e[o+_]=192|_e>>6,e[o+_+1]=128|_e>>0&63,_+=2;else if(!(4294901760&_e))e[o+_]=224|_e>>12,e[o+_+1]=128|_e>>6&63,e[o+_+2]=128|_e>>0&63,_+=3;else{if(4292870144&_e)throw"e";e[o+_]=240|_e>>18,e[o+_+1]=128|_e>>12&63,e[o+_+2]=128|_e>>6&63,e[o+_+3]=128|_e>>0&63,_+=4}}return _},sizeUTF8:function(e){for(var o=e.length,s=0,a=0;a<o;a++){var _=e.charCodeAt(a);if(!(4294967168&_))s++;else if(!(4294965248&_))s+=2;else if(!(4294901760&_))s+=3;else{if(4292870144&_)throw"e";s+=4}}return s}},G.F={},G.F.deflateRaw=function(e,o,s,a){var _=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][a],$=G.F.U,_e=G.F._goodIndex;G.F._hash;var _n=G.F._putsE,_r=0;s<<=3;var _s=0,na=e.length;if(a==0){for(;_r<na;){var ba=Math.min(65535,na-_r);_n(o,s,_r+ba==na?1:0),s=G.F._copyExact(e,_r,ba,o,s+8),_r+=ba}return s>>>3}_n=$.lits,a=$.strt;var _p=$.prev,_f=0,_E=0,_v=0,n_=0,e_=0;for(2<na&&(a[e_=G.F._hash(e,0)]=0),_r=0;_r<na;_r++){if(ba=e_,_r+1<na-2){e_=G.F._hash(e,_r+1);var t_=_r+1&32767;_p[t_]=a[e_],a[e_]=t_}if(_s<=_r){if((14e3<_f||26697<_E)&&100<na-_r&&(_s<_r&&(_n[_f]=_r-_s,_f+=2,_s=_r),s=G.F._writeBlock(_r==na-1||_s==na?1:0,_n,_f,n_,e,_v,_r-_v,o,s),_f=_E=n_=0,_v=_r),t_=0,_r<na-2&&(t_=G.F._bestMatch(e,_r,_p,ba,Math.min(_[2],na-_r),_[3])),t_!=0){ba=t_>>>16,t_&=65535;var o_=_e(ba,$.of0);$.lhst[257+o_]++;var m_=_e(t_,$.df0);$.dhst[m_]++,n_+=$.exb[o_]+$.dxb[m_],_n[_f]=ba<<23|_r-_s,_n[_f+1]=t_<<16|o_<<8|m_,_f+=2,_s=_r+ba}else $.lhst[e[_r]]++;_E++}}for(_v==_r&&e.length!=0||(_s<_r&&(_n[_f]=_r-_s,_f+=2),s=G.F._writeBlock(1,_n,_f,n_,e,_v,_r-_v,o,s));7&s;)s++;return s>>>3},G.F._bestMatch=function(e,o,s,a,_,$){var _e=32767&o,_n=s[_e],_r=_e-_n+32768&32767;if(_n==_e||a!=G.F._hash(e,o-_r))return 0;for(var _s=a=0,na=Math.min(32767,o);_r<=na&&--$!=0&&_n!=_e;){if((a==0||e[o+a]==e[o+a-_r])&&(_e=G.F._howLong(e,o,_r))>a){if(_s=_r,(a=_e)>=_)break;_r+2<_e&&(_e=_r+2);for(var ba=0,_p=0;_p<_e-2;_p++){var _f=o-_r+_p+32768&32767,_E=_f-s[_f]+32768&32767;_E>ba&&(ba=_E,_n=_f)}}_r+=(_e=_n)-(_n=s[_e])+32768&32767}return a<<16|_s},G.F._howLong=function(e,o,s){if(e[o]!=e[o-s]||e[o+1]!=e[o+1-s]||e[o+2]!=e[o+2-s])return 0;var a=o,_=Math.min(e.length,o+258);for(o+=3;o<_&&e[o]==e[o-s];)o++;return o-a},G.F._hash=function(e,o){return(e[o]<<8|e[o+1])+(e[o+2]<<4)&65535},G.saved=0,G.F._writeBlock=function(e,o,s,a,_,$,_e,_n,_r){var _s=G.F.U,na=G.F._putsF,ba=G.F._putsE;_s.lhst[256]++;var _p=G.F.getTrees(),_f=_p[0],_E=_p[1],_v=_p[2],n_=_p[3],e_=_p[4],t_=_p[5],o_=_p[6];_p=_p[7];var m_=32+(_r+3&7?8-(_r+3&7):0)+(_e<<3),b_=a+G.F.contSize(_s.fltree,_s.lhst)+G.F.contSize(_s.fdtree,_s.dhst);a=a+G.F.contSize(_s.ltree,_s.lhst)+G.F.contSize(_s.dtree,_s.dhst),a+=14+3*t_+G.F.contSize(_s.itree,_s.ihst)+(2*_s.ihst[16]+3*_s.ihst[17]+7*_s.ihst[18]);for(var w_=0;286>w_;w_++)_s.lhst[w_]=0;for(w_=0;30>w_;w_++)_s.dhst[w_]=0;for(w_=0;19>w_;w_++)_s.ihst[w_]=0;if(m_=m_<b_&&m_<a?0:b_<a?1:2,na(_n,_r,e),na(_n,_r+1,m_),_r+=3,m_==0){for(;7&_r;)_r++;_r=G.F._copyExact(_,$,_e,_n,_r)}else{if(m_==1)var y_=_s.fltree,N_=_s.fdtree;if(m_==2){for(G.F.makeCodes(_s.ltree,_f),G.F.revCodes(_s.ltree,_f),G.F.makeCodes(_s.dtree,_E),G.F.revCodes(_s.dtree,_E),G.F.makeCodes(_s.itree,_v),G.F.revCodes(_s.itree,_v),y_=_s.ltree,N_=_s.dtree,ba(_n,_r,n_-257),ba(_n,_r+=5,e_-1),ba(_n,_r+=5,t_-4),_r+=4,e=0;e<t_;e++)ba(_n,_r+3*e,_s.itree[1+(_s.ordr[e]<<1)]);_r=G.F._codeTiny(o_,_s.itree,_n,_r+3*t_),_r=G.F._codeTiny(_p,_s.itree,_n,_r)}for(t_=0;t_<s;t_+=2){for(o_=(e=o[t_])>>>23,e=$+(8388607&e);$<e;)_r=G.F._writeLit(_[$++],y_,_n,_r);o_!=0&&(e=(_f=o[t_+1])>>16,_e=_f>>8&255,_f&=255,ba(_n,_r=G.F._writeLit(257+_e,y_,_n,_r),o_-_s.of0[_e]),_r+=_s.exb[_e],na(_n,_r=G.F._writeLit(_f,N_,_n,_r),e-_s.df0[_f]),_r+=_s.dxb[_f],$+=o_)}_r=G.F._writeLit(256,y_,_n,_r)}return _r},G.F._copyExact=function(e,o,s,a,_){var $=_>>>3;return a[$]=s,a[$+1]=s>>>8,a[$+2]=255-a[$],a[$+3]=255-a[$+1],$+=4,a.set(new Uint8Array(e.buffer,o,s),$),_+(s+4<<3)},G.F.getTrees=function(){for(var e=G.F.U,o=G.F._hufTree(e.lhst,e.ltree,15),s=G.F._hufTree(e.dhst,e.dtree,15),a=[],_=G.F._lenCodes(e.ltree,a),$=[],_e=G.F._lenCodes(e.dtree,$),_n=0;_n<a.length;_n+=2)e.ihst[a[_n]]++;for(_n=0;_n<$.length;_n+=2)e.ihst[$[_n]]++;_n=G.F._hufTree(e.ihst,e.itree,7);for(var _r=19;4<_r&&e.itree[1+(e.ordr[_r-1]<<1)]==0;)_r--;return[o,s,_n,_,_e,_r,a,$]},G.F.getSecond=function(e){for(var o=[],s=0;s<e.length;s+=2)o.push(e[s+1]);return o},G.F.nonZero=function(e){for(var o="",s=0;s<e.length;s+=2)e[s+1]!=0&&(o+=(s>>1)+",");return o},G.F.contSize=function(e,o){for(var s=0,a=0;a<o.length;a++)s+=o[a]*e[1+(a<<1)];return s},G.F._codeTiny=function(e,o,s,a){for(var _=0;_<e.length;_+=2){var $=e[_],_e=e[_+1];a=G.F._writeLit($,o,s,a);var _n=$==16?2:$==17?3:7;15<$&&(G.F._putsE(s,a,_e,_n),a+=_n)}return a},G.F._lenCodes=function(e,o){for(var s=e.length;s!=2&&e[s-1]==0;)s-=2;for(var a=0;a<s;a+=2){var _=e[a+1],$=a+3<s?e[a+3]:-1,_e=a+5<s?e[a+5]:-1,_n=a==0?-1:e[a-1];if(_==0&&$==_&&_e==_){for($=a+5;$+2<s&&e[$+2]==_;)$+=2;11>(_=Math.min($+1-a>>>1,138))?o.push(17,_-3):o.push(18,_-11),a+=2*_-2}else if(_==_n&&$==_&&_e==_){for($=a+5;$+2<s&&e[$+2]==_;)$+=2;_=Math.min($+1-a>>>1,6),o.push(16,_-3),a+=2*_-2}else o.push(_,0)}return s>>>1},G.F._hufTree=function(e,o,s){var a=[],_=e.length,$=o.length,_e=0;for(_e=0;_e<$;_e+=2)o[_e]=0,o[_e+1]=0;for(_e=0;_e<_;_e++)e[_e]!=0&&a.push({lit:_e,f:e[_e]});if(e=a.length,_=a.slice(0),e==0)return 0;if(e==1)return o[1+((s=a[0].lit)<<1)]=1,o[1+((s==0?1:0)<<1)]=1;a.sort(function(na,ba){return na.f-ba.f}),_e=a[0],$=a[1];var _n=0,_r=1,_s=2;for(a[0]={lit:-1,f:_e.f+$.f,l:_e,r:$,d:0};_r!=e-1;)_e=_n!=_r&&(_s==e||a[_n].f<a[_s].f)?a[_n++]:a[_s++],$=_n!=_r&&(_s==e||a[_n].f<a[_s].f)?a[_n++]:a[_s++],a[_r++]={lit:-1,f:_e.f+$.f,l:_e,r:$};for((a=G.F.setDepth(a[_r-1],0))>s&&(G.F.restrictDepth(_,s,a),a=s),_e=0;_e<e;_e++)o[1+(_[_e].lit<<1)]=_[_e].d;return a},G.F.setDepth=function(e,o){return e.lit!=-1?e.d=o:Math.max(G.F.setDepth(e.l,o+1),G.F.setDepth(e.r,o+1))},G.F.restrictDepth=function(e,o,s){var a=0,_=1<<s-o,$=0;for(e.sort(function(_n,_r){return _r.d==_n.d?_n.f-_r.f:_r.d-_n.d}),a=0;a<e.length&&e[a].d>o;a++){var _e=e[a].d;e[a].d=o,$+=_-(1<<s-_e)}for($>>>=s-o;0<$;)(_e=e[a].d)<o?(e[a].d++,$-=1<<o-_e-1):a++;for(;0<=a;a--)e[a].d==o&&0>$&&(e[a].d--,$++);$!=0&&console.log("debt left")},G.F._goodIndex=function(e,o){var s=0;return o[16|s]<=e&&(s|=16),o[8|s]<=e&&(s|=8),o[4|s]<=e&&(s|=4),o[2|s]<=e&&(s|=2),o[1|s]<=e&&(s|=1),s},G.F._writeLit=function(e,o,s,a){return G.F._putsF(s,a,o[e<<1]),a+o[1+(e<<1)]},G.F.inflate=function(e,o){var s=Uint8Array;if(e[0]==3&&e[1]==0)return o||new s(0);var a=G.F,_=a._bitsF,$=a._bitsE,_e=a._decodeTiny,_n=a.makeCodes,_r=a.codes2map,_s=a._get17,na=a.U,ba=o==null;ba&&(o=new s(e.length>>>2<<3));for(var _p,_f,_E,_v,n_=0,e_=0,t_=_f=0,o_=0;n_==0;)if(n_=_(e,o_,1),_p=_(e,o_+1,2),o_+=3,_p==0)7&o_&&(o_+=8-(7&o_)),_p=e[(o_=4+(o_>>>3))-4]|e[o_-3]<<8,ba&&(o=G.F._check(o,t_+_p)),o.set(new s(e.buffer,e.byteOffset+o_,_p),t_),o_=o_+_p<<3,t_+=_p;else{if(ba&&(o=G.F._check(o,t_+131072)),_p==1&&(_E=na.flmap,_v=na.fdmap,e_=511,_f=31),_p==2){for(_f=$(e,o_,5)+257,_p=$(e,o_+5,5)+1,_E=$(e,o_+10,4)+4,o_+=14,_v=0;38>_v;_v+=2)na.itree[_v]=0,na.itree[_v+1]=0;for(e_=1,_v=0;_v<_E;_v++){var m_=$(e,o_+3*_v,3);na.itree[1+(na.ordr[_v]<<1)]=m_,m_>e_&&(e_=m_)}o_+=3*_E,_n(na.itree,e_),_r(na.itree,e_,na.imap),_E=na.lmap,_v=na.dmap,o_=_e(na.imap,(1<<e_)-1,_f+_p,e,o_,na.ttree),e_=(1<<(m_=a._copyOut(na.ttree,0,_f,na.ltree)))-1,_f=(1<<(_p=a._copyOut(na.ttree,_f,_p,na.dtree)))-1,_n(na.ltree,m_),_r(na.ltree,m_,_E),_n(na.dtree,_p),_r(na.dtree,_p,_v)}for(;;)if(o_+=15&(_p=_E[_s(e,o_)&e_]),(m_=_p>>>4)>>>8==0)o[t_++]=m_;else{if(m_==256)break;_p=t_+m_-254,264<m_&&(_p=t_+((m_=na.ldef[m_-257])>>>3)+$(e,o_,7&m_),o_+=7&m_),o_+=15&(m_=_v[_s(e,o_)&_f]);var b_=((m_=na.ddef[m_>>>4])>>>4)+_(e,o_,15&m_);for(o_+=15&m_,ba&&(o=G.F._check(o,t_+131072));t_<_p;)o[t_]=o[t_++-b_],o[t_]=o[t_++-b_],o[t_]=o[t_++-b_],o[t_]=o[t_++-b_];t_=_p}}return o.length==t_?o:o.slice(0,t_)},G.F._check=function(e,o){var s=e.length;return o<=s?e:((o=new Uint8Array(Math.max(s<<1,o))).set(e,0),o)},G.F._decodeTiny=function(e,o,s,a,_,$){for(var _e=G.F._bitsE,_n=G.F._get17,_r=0;_r<s;){var _s=e[_n(a,_)&o];_+=15&_s;var na=_s>>>4;if(15>=na)$[_r]=na,_r++;else{var ba=_s=0;for(na==16?(ba=3+_e(a,_,2),_+=2,_s=$[_r-1]):na==17?(ba=3+_e(a,_,3),_+=3):na==18&&(ba=11+_e(a,_,7),_+=7),na=_r+ba;_r<na;)$[_r]=_s,_r++}}return _},G.F._copyOut=function(e,o,s,a){for(var _=0,$=0,_e=a.length>>>1;$<s;){var _n=e[$+o];a[$<<1]=0,a[1+($<<1)]=_n,_n>_&&(_=_n),$++}for(;$<_e;)a[$<<1]=0,a[1+($<<1)]=0,$++;return _},G.F.makeCodes=function(e,o){var s,a,_=G.F.U,$=e.length,_e=_.bl_count;for(s=0;s<=o;s++)_e[s]=0;for(s=1;s<$;s+=2)_e[e[s]]++;for(_=_.next_code,s=0,_e[0]=0,a=1;a<=o;a++)s=s+_e[a-1]<<1,_[a]=s;for(o=0;o<$;o+=2)(_e=e[o+1])!=0&&(e[o]=_[_e],_[_e]++)},G.F.codes2map=function(e,o,s){for(var a=e.length,_=G.F.U.rev15,$=0;$<a;$+=2)if(e[$+1]!=0){var _e=e[$+1],_n=$>>1<<4|_e,_r=o-_e;for(_r=(_e=e[$]<<_r)+(1<<_r);_e!=_r;)s[_[_e]>>>15-o]=_n,_e++}},G.F.revCodes=function(e,o){for(var s=G.F.U.rev15,a=15-o,_=0;_<e.length;_+=2)e[_]=s[e[_]<<o-e[_+1]]>>>a},G.F._putsE=function(e,o,s){s<<=7&o,e[o>>>=3]|=s,e[o+1]|=s>>>8},G.F._putsF=function(e,o,s){s<<=7&o,e[o>>>=3]|=s,e[o+1]|=s>>>8,e[o+2]|=s>>>16},G.F._bitsE=function(e,o,s){return(e[o>>>3]|e[1+(o>>>3)]<<8)>>>(7&o)&(1<<s)-1},G.F._bitsF=function(e,o,s){return(e[o>>>3]|e[1+(o>>>3)]<<8|e[2+(o>>>3)]<<16)>>>(7&o)&(1<<s)-1},G.F._get17=function(e,o){return(e[o>>>3]|e[1+(o>>>3)]<<8|e[2+(o>>>3)]<<16)>>>(7&o)},G.F._get25=function(e,o){return(e[o>>>3]|e[1+(o>>>3)]<<8|e[2+(o>>>3)]<<16|e[3+(o>>>3)]<<24)>>>(7&o)},G.F.U=function(){var e=Uint16Array,o=Uint32Array;return{next_code:new e(16),bl_count:new e(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new e(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new o(32),flmap:new e(512),fltree:[],fdmap:new e(32),fdtree:[],lmap:new e(32768),ltree:[],ttree:[],dmap:new e(32768),dtree:[],imap:new e(512),itree:[],rev15:new e(32768),lhst:new o(286),dhst:new o(30),ihst:new o(19),lits:new o(15e3),strt:new e(65536),prev:new e(32768)}}(),function(){function e(_,$,_e){for(;$--!=0;)_.push(0,_e)}for(var o=G.F.U,s=0;32768>s;s++){var a=s;a=(4278255360&(a=(4042322160&(a=(3435973836&(a=(2863311530&a)>>>1|(1431655765&a)<<1))>>>2|(858993459&a)<<2))>>>4|(252645135&a)<<4))>>>8|(16711935&a)<<8,o.rev15[s]=(a>>>16|a<<16)>>>17}for(s=0;32>s;s++)o.ldef[s]=o.of0[s]<<3|o.exb[s],o.ddef[s]=o.df0[s]<<4|o.dxb[s];e(o.fltree,144,8),e(o.fltree,112,9),e(o.fltree,24,7),e(o.fltree,8,8),G.F.makeCodes(o.fltree,9),G.F.codes2map(o.fltree,9,o.flmap),G.F.revCodes(o.fltree,9),e(o.fdtree,32,5),G.F.makeCodes(o.fdtree,5),G.F.codes2map(o.fdtree,5,o.fdmap),G.F.revCodes(o.fdtree,5),e(o.itree,19,0),e(o.ltree,286,0),e(o.dtree,30,0),e(o.ttree,320,0)}();var DE=Array.isArray||function(e){return e&&typeof e.length=="number"},EE=Object.defineProperty({isArray:DE},"__esModule",{value:!0}),FE=Object.defineProperty({isObject:function(e){return e!==null&&qa(e)==="object"}},"__esModule",{value:!0}),GE=Object.defineProperty({isFunction:function(e){return typeof e=="function"}},"__esModule",{value:!0}),HE=function(){function e(o){return Error.call(this),this.message=o?o.length+` errors occurred during unsubscription:
`+o.map(function(s,a){return a+1+") "+s.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=o,this}return e.prototype=Object.create(Error.prototype),e}(),uh=Object.defineProperty({UnsubscriptionError:HE},"__esModule",{value:!0}),IE=function(){function e(s){this.closed=!1,this._subscriptions=this._parentOrParents=null,s&&(this._ctorUnsubscribe=!0,this._unsubscribe=s)}var o;return e.prototype.unsubscribe=function(){if(!this.closed){var s=this._parentOrParents,a=this._ctorUnsubscribe,_=this._unsubscribe,$=this._subscriptions;if(this.closed=!0,this._subscriptions=this._parentOrParents=null,s instanceof e)s.remove(this);else if(s!==null)for(var _e=0;_e<s.length;++_e)s[_e].remove(this);if(GE.isFunction(_)){a&&(this._unsubscribe=void 0);try{_.call(this)}catch(_r){var _n=_r instanceof uh.UnsubscriptionError?eo(_r.errors):[_r]}}if(EE.isArray($)){for(_e=-1,s=$.length;++_e<s;)if(a=$[_e],FE.isObject(a))try{a.unsubscribe()}catch(_r){_n=_n||[],_r instanceof uh.UnsubscriptionError?_n=_n.concat(eo(_r.errors)):_n.push(_r)}}if(_n)throw new uh.UnsubscriptionError(_n)}},e.prototype.add=function(s){var a=s;if(!s)return e.EMPTY;switch(qa(s)){case"function":a=new e(s);case"object":if(a===this||a.closed||typeof a.unsubscribe!="function")return a;if(this.closed)return a.unsubscribe(),a;a instanceof e||(s=a,(a=new e)._subscriptions=[s]);break;default:throw Error("unrecognized teardown "+s+" added to Subscription.")}if((s=a._parentOrParents)===null)a._parentOrParents=this;else if(s instanceof e){if(s===this)return a;a._parentOrParents=[s,this]}else{if(s.indexOf(this)!==-1)return a;s.push(this)}return(s=this._subscriptions)===null?this._subscriptions=[a]:s.push(a),a},e.prototype.remove=function(s){var a=this._subscriptions;a&&(s=a.indexOf(s))!==-1&&a.splice(s,1)},e.EMPTY=((o=new e).closed=!0,o),e}(),JE=Object.defineProperty({Subscription:IE},"__esModule",{value:!0}),KE=Ya&&Ya.__extends||function(){var e=function(o,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,_){a.__proto__=_}||function(a,_){for(var $ in _)_.hasOwnProperty($)&&(a[$]=_[$])})(o,s)};return function(o,s){function a(){this.constructor=o}e(o,s),o.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}}(),LE=function(e){function o(s,a){return e.call(this)||this}return KE(o,e),o.prototype.schedule=function(s,a){return this},o}(JE.Subscription),ME=Object.defineProperty({Action:LE},"__esModule",{value:!0}),NE=Ya&&Ya.__extends||function(){var e=function(o,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,_){a.__proto__=_}||function(a,_){for(var $ in _)_.hasOwnProperty($)&&(a[$]=_[$])})(o,s)};return function(o,s){function a(){this.constructor=o}e(o,s),o.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}}(),gt=function(e){function o(s,a){var _=e.call(this,s,a)||this;return _.scheduler=s,_.work=a,_.pending=!1,_}return NE(o,e),o.prototype.schedule=function(s,a){if(a===void 0&&(a=0),this.closed)return this;this.state=s,s=this.id;var _=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(_,s,a)),this.pending=!0,this.delay=a,this.id=this.id||this.requestAsyncId(_,this.id,a),this},o.prototype.requestAsyncId=function(s,a,_){return _===void 0&&(_=0),setInterval(s.flush.bind(s,this),_)},o.prototype.recycleAsyncId=function(s,a,_){if(_===void 0&&(_=0),_!==null&&this.delay===_&&this.pending===!1)return a;clearInterval(a)},o.prototype.execute=function(s,a){return this.closed?Error("executing a cancelled action"):(this.pending=!1,(s=this._execute(s,a))?s:void(this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))))},o.prototype._execute=function(s,a){a=!1;var _=void 0;try{this.work(s)}catch($){a=!0,_=!!$&&$||Error($)}if(a)return this.unsubscribe(),_},o.prototype._unsubscribe=function(){var s=this.id,a=this.scheduler,_=a.actions,$=_.indexOf(this);this.state=this.work=null,this.pending=!1,this.scheduler=null,$!==-1&&_.splice($,1),s!=null&&(this.id=this.recycleAsyncId(a,s,null)),this.delay=null},o}(ME.Action),OE=function(){function e(o,s){s===void 0&&(s=e.now),this.SchedulerAction=o,this.now=s}return e.prototype.schedule=function(o,s,a){return s===void 0&&(s=0),new this.SchedulerAction(this,o).schedule(a,s)},e.now=function(){return Date.now()},e}(),ht=Object.defineProperty({Scheduler:OE},"__esModule",{value:!0}),PE=Ya&&Ya.__extends||function(){var e=function(o,s){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,_){a.__proto__=_}||function(a,_){for(var $ in _)_.hasOwnProperty($)&&(a[$]=_[$])})(o,s)};return function(o,s){function a(){this.constructor=o}e(o,s),o.prototype=s===null?Object.create(s):(a.prototype=s.prototype,new a)}}(),it=function(e){function o(s,a){a===void 0&&(a=ht.Scheduler.now);var _=e.call(this,s,function(){return o.delegate&&o.delegate!==_?o.delegate.now():a()})||this;return _.actions=[],_.active=!1,_.scheduled=void 0,_}return PE(o,e),o.prototype.schedule=function(s,a,_){return a===void 0&&(a=0),o.delegate&&o.delegate!==this?o.delegate.schedule(s,a,_):e.prototype.schedule.call(this,s,a,_)},o.prototype.flush=function(s){var a=this.actions;if(this.active)a.push(s);else{var _;this.active=!0;do if(_=s.execute(s.state,s.delay))break;while(s=a.shift());if(this.active=!1,_){for(;s=a.shift();)s.unsubscribe();throw _}}},o}(ht.Scheduler),QE=Fa("iterator"),Wl=!la(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),o=e.searchParams,s="";return e.pathname="c%20d",o.forEach(function(a,_){o.delete("b"),s+=_+a}),!o.sort||e.href!=="http://a/c%20d?a=1&c=3"||o.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!o[QE]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://").host!=="xn--e1aybc"||new URL("http://a#").hash!=="#%D0%B1"||s!=="a1c3"||new URL("http://x",void 0).host!=="x"}),RE=/[^\0-\u007E]/,SE=/[.\u3002\uFF0E\uFF61]/g,Ff=Math.floor,Xl=String.fromCharCode,jt=function(e){var o=lg(e);if(typeof o!="function")throw TypeError(String(e)+" is not iterable");return Ia(o.call(e))},kt=Pc("fetch"),Yl=Pc("Headers"),TE=Fa("iterator"),lt=cb.set,cc=cb.getterFor("URLSearchParams"),UE=cb.getterFor("URLSearchParamsIterator"),VE=/\+/g,mt=Array(4),WE=function(e){try{return decodeURIComponent(e)}catch{return e}},nt=function(e){var o=e.replace(VE," ");e=4;try{return decodeURIComponent(o)}catch{for(;e;){var s=o.replace,a=e--;a=mt[a-1]||(mt[a-1]=RegExp("((?:%[\\da-f]{2}){"+a+"})","gi")),o=s.call(o,a,WE)}return o}},ot=/[!'()~]|%20/g,XE={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},pt=function(e){return XE[e]},qt=function(e,o){if(o){o=o.split("&");for(var s,a=0;a<o.length;)(s=o[a++]).length&&(s=s.split("="),e.push({key:nt(s.shift()),value:nt(s.join("="))}))}},YE=function(e){this.entries.length=0,qt(this.entries,e)},Gf=function(e,o){if(e<o)throw TypeError("Not enough arguments")},Zl=Wo(function(e,o){lt(this,{type:"URLSearchParamsIterator",iterator:jt(cc(e).entries),kind:o})},"Iterator",function(){var e=UE(this),o=e.kind,s=(e=e.iterator.next()).value;return e.done||(e.value=o==="keys"?s.key:o==="values"?s.value:[s.key,s.value]),e}),Rg=function(){Ac(this,Rg,"URLSearchParams");var e,o,s,a=0<arguments.length?arguments[0]:void 0,_=[];if(lt(this,{type:"URLSearchParams",entries:_,updateURL:function(){},updateSearchParams:YE}),a!==void 0)if(xa(a)){var $=lg(a);if(typeof $=="function")for(a=$.call(a),$=a.next;!(e=$.call(a)).done;){var _e=(e=jt(Ia(e.value))).next;if((o=_e.call(e)).done||(s=_e.call(e)).done||!_e.call(e).done)throw TypeError("Expected sequence with length 2");_.push({key:o.value+"",value:s.value+""})}else for(e in a)ka(a,e)&&_.push({key:e,value:a[e]+""})}else qt(_,typeof a=="string"?a.charAt(0)==="?"?a.slice(1):a:a+"")},Bi=Rg.prototype;kf(Bi,{append:function(e,o){Gf(arguments.length,2);var s=cc(this);s.entries.push({key:e+"",value:o+""}),s.updateURL()},delete:function(e){Gf(arguments.length,1);for(var o=cc(this),s=o.entries,a=e+"",_=0;_<s.length;)s[_].key===a?s.splice(_,1):_++;o.updateURL()},get:function(e){Gf(arguments.length,1);for(var o=cc(this).entries,s=e+"",a=0;a<o.length;a++)if(o[a].key===s)return o[a].value;return null},getAll:function(e){Gf(arguments.length,1);for(var o=cc(this).entries,s=e+"",a=[],_=0;_<o.length;_++)o[_].key===s&&a.push(o[_].value);return a},has:function(e){Gf(arguments.length,1);for(var o=cc(this).entries,s=e+"",a=0;a<o.length;)if(o[a++].key===s)return!0;return!1},set:function(e,o){Gf(arguments.length,1);for(var s,a=cc(this),_=a.entries,$=!1,_e=e+"",_n=o+"",_r=0;_r<_.length;_r++)(s=_[_r]).key===_e&&($?_.splice(_r--,1):($=!0,s.value=_n));$||_.push({key:_e,value:_n}),a.updateURL()},sort:function(){var e,o,s=cc(this),a=s.entries,_=a.slice();for(o=a.length=0;o<_.length;o++){var $=_[o];for(e=0;e<o;e++)if(a[e].key>$.key){a.splice(e,0,$);break}e===o&&a.push($)}s.updateURL()},forEach:function(e){for(var o,s=cc(this).entries,a=Dd(e,1<arguments.length?arguments[1]:void 0,3),_=0;_<s.length;)a((o=s[_++]).value,o.key,this)},keys:function(){return new Zl(this,"keys")},values:function(){return new Zl(this,"values")},entries:function(){return new Zl(this,"entries")}},{enumerable:!0}),Za(Bi,TE,Bi.entries),Za(Bi,"toString",function(){for(var e,o=cc(this).entries,s=[],a=0;a<o.length;)e=o[a++],s.push(encodeURIComponent(e.key).replace(ot,pt)+"="+encodeURIComponent(e.value).replace(ot,pt));return s.join("&")},{enumerable:!0}),zc(Rg,"URLSearchParams"),ea({global:!0,forced:!Wl},{URLSearchParams:Rg}),Wl||typeof kt!="function"||typeof Yl!="function"||ea({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var o=[e];if(1<arguments.length){var s=arguments[1];if(xa(s)){var a=s.body;if(jf(a)==="URLSearchParams"){var _=s.headers?new Yl(s.headers):new Yl;_.has("content-type")||_.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),s=jc(s,{body:Nc(0,String(a)),headers:Nc(0,_)})}}o.push(s)}return kt.apply(this,o)}});var Sg=R.URL,ZE=Rg,$E=cb.set,db=cb.getterFor("URL"),aF=Math.floor,rt=Math.pow,st=/[A-Za-z]/,bF=/[\d+-.A-Za-z]/,$l=/\d/,cF=/^(0x|0X)/,dF=/^[0-7]+$/,eF=/^\d+$/,tt=/^[\dA-Fa-f]+$/,fF=/[\0\t\n\r #%/:?@[\\]]/,gF=/[\0\t\n\r #/:?@[\\]]/,hF=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,iF=/[\t\n\r]/g,am=function(e,o){var s;if(o.charAt(0)=="["){if(o.charAt(o.length-1)!="]")return"Invalid host";var a=jF(o.slice(1,-1));if(!a)return"Invalid host"}else if(wb(e)){for(a=[],o=o.toLowerCase().replace(SE,".").split("."),s=0;s<o.length;s++){var _=o[s],$=a,_e=$.push;if(RE.test(_)){var _n=_;_=[];var _r=_n;_n=[];for(var _s=0,na=_r.length;_s<na;){var ba=_r.charCodeAt(_s++);if(55296<=ba&&56319>=ba&&_s<na){var _p=_r.charCodeAt(_s++);(64512&_p)==56320?_n.push(((1023&ba)<<10)+(1023&_p)+65536):(_n.push(ba),_s--)}else _n.push(ba)}_s=_n.length,na=128;var _f=0,_E=72;for(_r=0;_r<_n.length;_r++){var _v=_n[_r];128>_v&&_.push(Xl(_v))}for((_p=ba=_.length)&&_.push("-");_p<_s;){var n_=2147483647;for(_r=0;_r<_n.length;_r++)(_v=_n[_r])>=na&&_v<n_&&(n_=_v);var e_=_p+1;if(n_-na>Ff((2147483647-_f)/e_))throw RangeError("Overflow: input needs wider integers to process");for(_f+=(n_-na)*e_,na=n_,_r=0;_r<_n.length;_r++){if((_v=_n[_r])<na&&2147483647<++_f)throw RangeError("Overflow: input needs wider integers to process");if(_v==na){var t_=_f;for(_v=36;!(t_<(n_=_v<=_E?1:_v>=_E+26?26:_v-_E));_v+=36){var o_=36-n_,m_=_;n_+=(t_-=n_)%o_,m_.push.call(m_,Xl(n_+22+75*(26>n_))),t_=Ff(t_/o_)}for(_.push(Xl(t_+22+75*(26>t_))),_E=e_,_v=0,_f=_p==ba?Ff(_f/700):_f>>1,_f+=Ff(_f/_E);455<_f;_v+=36)_f=Ff(_f/35);_E=Ff(_v+36*_f/(_f+38)),_f=0,++_p}}++_f,++na}_="xn--"+_.join("")}_e.call($,_)}if(o=a.join("."),fF.test(o)||(a=kF(o))===null)return"Invalid host"}else{if(gF.test(o))return"Invalid host";for(a="",o=ge(o),s=0;s<o.length;s++)a+=Qd(o[s],Ci)}e.host=a},kF=function(e){var o,s=e.split(".");s.length&&s[s.length-1]==""&&s.pop();var a=s.length;if(4<a)return e;var _=[];for(o=0;o<a;o++){var $=s[o];if($=="")return e;var _e=10;if(1<$.length&&$.charAt(0)=="0"&&(_e=cF.test($)?16:8,$=$.slice(_e==8?1:2)),$==="")$=0;else{if(!(_e==10?eF:_e==8?dF:tt).test($))return e;$=parseInt($,_e)}_.push($)}for(o=0;o<a;o++)if($=_[o],o==a-1){if($>=rt(256,5-a))return null}else if(255<$)return null;for(e=_.pop(),o=0;o<_.length;o++)e+=_[o]*rt(256,3-o);return e},jF=function(e){var o,s,a=[0,0,0,0,0,0,0,0],_=0,$=null,_e=0,_n=function(){return e.charAt(_e)};if(_n()==":"){if(e.charAt(1)!=":")return;_e+=2,$=++_}for(;_n();){if(_==8)return;if(_n()==":"){if($!==null)return;_e++,$=++_}else{for(o=s=0;4>s&&tt.test(_n());)o=16*o+parseInt(_n(),16),_e++,s++;if(_n()=="."){if(s==0||(_e-=s,6<_))return;for(o=0;_n();){if(s=null,0<o){if(!(_n()=="."&&4>o))return;_e++}if(!$l.test(_n()))return;for(;$l.test(_n());){var _r=parseInt(_n(),10);if(s===null)s=_r;else{if(s==0)return;s=10*s+_r}if(255<s)return;_e++}a[_]=256*a[_]+s,++o!=2&&o!=4||_++}if(o!=4)return;break}if(_n()==":"){if(_e++,!_n())return}else if(_n())return;a[_++]=o}}if($!==null)for(_n=_-$,_=7;_!=0&&0<_n;)o=a[_],a[_--]=a[$+_n-1],a[$+--_n]=o;else if(_!=8)return;return a},Tg=function(e){var o,s;if(typeof e=="number"){var a=[];for(o=0;4>o;o++)a.unshift(e%256),e=aF(e/256);return a.join(".")}if(typeof e=="object"){a="",o=null;for(var _=1,$=null,_e=0,_n=0;8>_n;_n++)e[_n]!==0?(_e>_&&(o=$,_=_e),$=null,_e=0):($===null&&($=_n),++_e);for(_e>_&&(o=$),_=o,o=0;8>o;o++)s&&e[o]===0||(s&&(s=!1),_===o?(a+=o?":":"::",s=!0):(a+=e[o].toString(16),7>o&&(a+=":")));return"["+a+"]"}return e},Ci={},ut=Bg({},Ci,{" ":1,'"':1,"<":1,">":1,"`":1}),vt=Bg({},ut,{"#":1,"?":1,"{":1,"}":1}),bm=Bg({},vt,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Qd=function(e,o){var s=uw(e,0);return 32<s&&127>s&&!ka(o,e)?e:encodeURIComponent(e)},Di={ftp:21,file:null,http:80,https:443,ws:80,wss:443},wb=function(e){return ka(Di,e.scheme)},cm=function(e){return!e.host||e.cannotBeABaseURL||e.scheme=="file"},Ug=function(e,o){var s;return e.length==2&&st.test(e.charAt(0))&&((s=e.charAt(1))==":"||!o&&s=="|")},wt=function(e){var o;return 1<e.length&&Ug(e.slice(0,2))&&(e.length==2||(o=e.charAt(2))==="/"||o==="\\"||o==="?"||o==="#")},xt=function(e){var o=e.path,s=o.length;!s||e.scheme=="file"&&s==1&&Ug(o[0],!0)||o.pop()},dm={},yt={},em={},zt={},At={},fm={},Bt={},Ct={},Ei={},Fi={},gm={},hm={},im={},jm={},Dt={},km={},Vg={},Yc={},Et={},ye={},vd={},Zc=function(e,o,s,a){var _=s||dm,$=0,_e="",_n=!1,_r=!1,_s=!1;for(s||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,o=o.replace(hF,"")),o=o.replace(iF,""),o=ge(o);$<=o.length;){var na=o[$];switch(_){case dm:if(!na||!st.test(na)){if(s)return"Invalid scheme";_=em;continue}_e+=na.toLowerCase(),_=yt;break;case yt:if(na&&(bF.test(na)||na=="+"||na=="-"||na=="."))_e+=na.toLowerCase();else{if(na!=":"){if(s)return"Invalid scheme";_e="",_=em,$=0;continue}if(s&&(wb(e)!=ka(Di,_e)||_e=="file"&&(e.username!=""||e.password!=""||e.port!==null)||e.scheme=="file"&&!e.host))return;if(e.scheme=_e,s)return void(wb(e)&&Di[e.scheme]==e.port&&(e.port=null));_e="",e.scheme=="file"?_=jm:wb(e)&&a&&a.scheme==e.scheme?_=zt:wb(e)?_=Ct:o[$+1]=="/"?(_=At,$++):(e.cannotBeABaseURL=!0,e.path.push(""),_=Et)}break;case em:if(!a||a.cannotBeABaseURL&&na!="#")return"Invalid scheme";if(a.cannotBeABaseURL&&na=="#"){e.scheme=a.scheme,e.path=a.path.slice(),e.query=a.query,e.fragment="",e.cannotBeABaseURL=!0,_=vd;break}_=a.scheme=="file"?jm:fm;continue;case zt:if(na!="/"||o[$+1]!="/"){_=fm;continue}_=Ei,$++;break;case At:if(na=="/"){_=Fi;break}_=Yc;continue;case fm:if(e.scheme=a.scheme,na==null)e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.query=a.query;else if(na=="/"||na=="\\"&&wb(e))_=Bt;else if(na=="?")e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.query="",_=ye;else{if(na!="#"){e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.path.pop(),_=Yc;continue}e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.query=a.query,e.fragment="",_=vd}break;case Bt:if(!wb(e)||na!="/"&&na!="\\"){if(na!="/"){e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,_=Yc;continue}_=Fi}else _=Ei;break;case Ct:if(_=Ei,na!="/"||_e.charAt($+1)!="/")continue;$++;break;case Ei:if(na!="/"&&na!="\\"){_=Fi;continue}break;case Fi:if(na=="@"){for(_n&&(_e="%40"+_e),_n=!0,_e=ge(_e),na=0;na<_e.length;na++){var ba=_e[na];ba!=":"||_s?(ba=Qd(ba,bm),_s?e.password+=ba:e.username+=ba):_s=!0}_e=""}else if(na==null||na=="/"||na=="?"||na=="#"||na=="\\"&&wb(e)){if(_n&&_e=="")return"Invalid authority";$-=ge(_e).length+1,_e="",_=gm}else _e+=na;break;case gm:case hm:if(s&&e.scheme=="file"){_=km;continue}if(na!=":"||_r){if(na==null||na=="/"||na=="?"||na=="#"||na=="\\"&&wb(e)){if(wb(e)&&_e=="")return"Invalid host";if(s&&_e==""&&(e.username!=""||e.password!=""||e.port!==null))return;if(_=am(e,_e))return _;if(_e="",_=Vg,s)return;continue}na=="["?_r=!0:na=="]"&&(_r=!1),_e+=na}else{if(_e=="")return"Invalid host";if(_=am(e,_e))return _;if(_e="",_=im,s==hm)return}break;case im:if(!$l.test(na)){if(na==null||na=="/"||na=="?"||na=="#"||na=="\\"&&wb(e)||s){if(_e!=""){if(65535<(_=parseInt(_e,10)))return"Invalid port";e.port=wb(e)&&_===Di[e.scheme]?null:_,_e=""}if(s)return;_=Vg;continue}return"Invalid port"}_e+=na;break;case jm:if(e.scheme="file",na=="/"||na=="\\")_=Dt;else{if(!a||a.scheme!="file"){_=Yc;continue}if(na==null)e.host=a.host,e.path=a.path.slice(),e.query=a.query;else if(na=="?")e.host=a.host,e.path=a.path.slice(),e.query="",_=ye;else{if(na!="#"){wt(o.slice($).join(""))||(e.host=a.host,e.path=a.path.slice(),xt(e)),_=Yc;continue}e.host=a.host,e.path=a.path.slice(),e.query=a.query,e.fragment="",_=vd}}break;case Dt:if(na=="/"||na=="\\"){_=km;break}a&&a.scheme=="file"&&!wt(o.slice($).join(""))&&(Ug(a.path[0],!0)?e.path.push(a.path[0]):e.host=a.host),_=Yc;continue;case km:if(na==null||na=="/"||na=="\\"||na=="?"||na=="#"){if(!s&&Ug(_e))_=Yc;else{if(_e==""){if(e.host="",s)return}else{if(_=am(e,_e))return _;if(e.host=="localhost"&&(e.host=""),s)return;_e=""}_=Vg}continue}_e+=na;break;case Vg:if(wb(e)){if(_=Yc,na!="/"&&na!="\\")continue}else if(s||na!="?")if(s||na!="#"){if(na!=null&&(_=Yc,na!="/"))continue}else e.fragment="",_=vd;else e.query="",_=ye;break;case Yc:if(na==null||na=="/"||na=="\\"&&wb(e)||!s&&(na=="?"||na=="#")){if((ba=(ba=_e).toLowerCase())===".."||ba==="%2e."||ba===".%2e"||ba==="%2e%2e"?(xt(e),na=="/"||na=="\\"&&wb(e)||e.path.push("")):_e==="."||_e.toLowerCase()==="%2e"?na=="/"||na=="\\"&&wb(e)||e.path.push(""):(e.scheme=="file"&&!e.path.length&&Ug(_e)&&(e.host&&(e.host=""),_e=_e.charAt(0)+":"),e.path.push(_e)),_e="",e.scheme=="file"&&(na==null||na=="?"||na=="#"))for(;1<e.path.length&&e.path[0]==="";)e.path.shift();na=="?"?(e.query="",_=ye):na=="#"&&(e.fragment="",_=vd)}else _e+=Qd(na,vt);break;case Et:na=="?"?(e.query="",_=ye):na=="#"?(e.fragment="",_=vd):na!=null&&(e.path[0]+=Qd(na,Ci));break;case ye:s||na!="#"?na!=null&&(na=="'"&&wb(e)?e.query+="%27":e.query=na=="#"?e.query+"%23":e.query+Qd(na,Ci)):(e.fragment="",_=vd);break;case vd:na!=null&&(e.fragment+=Qd(na,ut))}$++}},Rd=function(e){var o=Ac(this,Rd,"URL"),s=1<arguments.length?arguments[1]:void 0,a=String(e),_=$E(o,{type:"URL"});if(s!==void 0){if(s instanceof Rd)var $=db(s);else if(s=Zc($={},String(s)))throw TypeError(s)}if(s=Zc(_,a,null,$))throw TypeError(s);var _e=_.searchParams=new ZE;(a=cc(_e)).updateSearchParams(_.query),a.updateURL=function(){_.query=String(_e)||null},wa||(o.href=Gi.call(o),o.origin=Ft.call(o),o.protocol=Gt.call(o),o.username=Ht.call(o),o.password=It.call(o),o.host=Jt.call(o),o.hostname=Kt.call(o),o.port=Lt.call(o),o.pathname=Mt.call(o),o.search=Nt.call(o),o.searchParams=Ot.call(o),o.hash=Pt.call(o))},lm=Rd.prototype,Gi=function(){var e=db(this),o=e.scheme,s=e.username,a=e.password,_=e.host,$=e.port,_e=e.path,_n=e.query,_r=e.fragment,_s=o+":";return _!==null?(_s+="//",e.username==""&&e.password==""||(_s+=s+(a?":"+a:"")+"@"),_s+=Tg(_),$!==null&&(_s+=":"+$)):o=="file"&&(_s+="//"),_s+=e.cannotBeABaseURL?_e[0]:_e.length?"/"+_e.join("/"):"",_n!==null&&(_s+="?"+_n),_r!==null&&(_s+="#"+_r),_s},Ft=function(){var e=db(this),o=e.scheme,s=e.port;if(o=="blob")try{return new Rd(o.path[0]).origin}catch{return"null"}return o!="file"&&wb(e)?o+"://"+Tg(e.host)+(s!==null?":"+s:""):"null"},Gt=function(){return db(this).scheme+":"},Ht=function(){return db(this).username},It=function(){return db(this).password},Jt=function(){var e=db(this),o=e.host;return e=e.port,o===null?"":e===null?Tg(o):Tg(o)+":"+e},Kt=function(){var e=db(this).host;return e===null?"":Tg(e)},Lt=function(){var e=db(this).port;return e===null?"":String(e)},Mt=function(){var e=db(this),o=e.path;return e.cannotBeABaseURL?o[0]:o.length?"/"+o.join("/"):""},Nt=function(){var e=db(this).query;return e?"?"+e:""},Ot=function(){return db(this).searchParams},Pt=function(){var e=db(this).fragment;return e?"#"+e:""},tc=function(e,o){return{get:e,set:o,configurable:!0,enumerable:!0}};if(wa&&To(lm,{href:tc(Gi,function(e){var o=db(this);if(e=Zc(o,String(e)))throw TypeError(e);cc(o.searchParams).updateSearchParams(o.query)}),origin:tc(Ft),protocol:tc(Gt,function(e){var o=db(this);Zc(o,String(e)+":",dm)}),username:tc(Ht,function(e){var o=db(this);if(e=ge(String(e)),!cm(o)){o.username="";for(var s=0;s<e.length;s++)o.username+=Qd(e[s],bm)}}),password:tc(It,function(e){var o=db(this);if(e=ge(String(e)),!cm(o)){o.password="";for(var s=0;s<e.length;s++)o.password+=Qd(e[s],bm)}}),host:tc(Jt,function(e){var o=db(this);o.cannotBeABaseURL||Zc(o,String(e),gm)}),hostname:tc(Kt,function(e){var o=db(this);o.cannotBeABaseURL||Zc(o,String(e),hm)}),port:tc(Lt,function(e){var o=db(this);cm(o)||((e=String(e))==""?o.port=null:Zc(o,e,im))}),pathname:tc(Mt,function(e){var o=db(this);o.cannotBeABaseURL||(o.path=[],Zc(o,e+"",Vg))}),search:tc(Nt,function(e){var o=db(this);(e=String(e))==""?o.query=null:(e.charAt(0)=="?"&&(e=e.slice(1)),o.query="",Zc(o,e,ye)),cc(o.searchParams).updateSearchParams(o.query)}),searchParams:tc(Ot),hash:tc(Pt,function(e){var o=db(this);(e=String(e))==""?o.fragment=null:(e.charAt(0)=="#"&&(e=e.slice(1)),o.fragment="",Zc(o,e,vd))})}),Za(lm,"toJSON",function(){return Gi.call(this)},{enumerable:!0}),Za(lm,"toString",function(){return Gi.call(this)},{enumerable:!0}),Sg){var Qt=Sg.createObjectURL,Rt=Sg.revokeObjectURL;Qt&&Za(Rd,"createObjectURL",function(e){return Qt.apply(Sg,arguments)}),Rt&&Za(Rd,"revokeObjectURL",function(e){return Rt.apply(Sg,arguments)})}zc(Rd,"URL"),ea({global:!0,forced:!Wl,sham:!wa},{URL:Rd});var lF=new Blob(["var fakeIdToId = {};onmessage = function (event) {	var data = event.data,		name = data.name,		fakeId = data.fakeId,		time;	if(data.hasOwnProperty('time')) {		time = data.time;	}	switch (name) {		case 'setInterval':			fakeIdToId[fakeId] = setInterval(function () {				postMessage({fakeId: fakeId});			}, time);			break;		case 'clearInterval':			if (fakeIdToId.hasOwnProperty (fakeId)) {				clearInterval(fakeIdToId[fakeId]);				delete fakeIdToId[fakeId];			}			break;	}}"]),mF=window.URL.createObjectURL(lF),Ze={},dg=0,Aj=new Worker(mF);Aj.onmessage=function(e){if(e=e.data.fakeId,Ze.hasOwnProperty(e)){var o=Ze[e];e=o.callback,o=o.parameters,e.apply(window,o)}};var nF=function(e){function o(){return va(this,o),s.apply(this,arguments)}Ga(o,e);var s=Ha(o);return eb(o,[{key:"requestAsyncId",value:function(a,_){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;return Qv(a.flush.bind(a,this),$)}},{key:"recycleAsyncId",value:function(a,_){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0;if($!==null&&this.delay===$&&this.pending===!1)return _;Ze.hasOwnProperty(_)&&(delete Ze[_],Aj.postMessage({name:"clearInterval",fakeId:_}))}}]),o}(gt),oF=new it(nF),pF=["group"],mm=G.inflate,St=G.deflate,Tt=function(e){function o(_,$,_e,_n){va(this,o);var _r=a.call(this,_n,"Session");return x(z(_r),"lastNoticeTicket",""),x(z(_r),"chatManager",void 0),x(z(_r),"usedChannelIds",[]),x(z(_r),"msgDedupLru",new Wc(void 0,{maxlen:200})),x(z(_r),"startTime",Date.now()),x(z(_r),"seq",P.fromNumber(1,!0)),x(z(_r),"userJoinOptions",new et(!1)),x(z(_r),"seqSentStatuses",[!1,!1]),x(z(_r),"dialogueSequenceLru",new Wc(void 0,{maxlen:1e4})),x(z(_r),"loggedOut",!1),x(z(_r),"messageSentTimes",[]),x(z(_r),"curLoginSockets",[void 0,void 0]),x(z(_r),"loginSocketSubs",[{channels:new Map,receivers:[]},{channels:new Map,receivers:[]}]),x(z(_r),"lastLoginSockets",[new Te(1),new Te(1)]),x(z(_r),"dialPendingMsgSubjectMap",new Map),x(z(_r),"context",void 0),x(z(_r),"connection",void 0),x(z(_r),"instanceId",void 0),x(z(_r),"lastPingTime",void 0),x(z(_r),"chanelStringMessageReport",void 0),x(z(_r),"chanelRawMessageReport",void 0),x(z(_r),"p2pSMsgNoOfflineReport",void 0),x(z(_r),"p2pRMsgNoOfflineReport",void 0),x(z(_r),"registerSocketsFailureListener",function(){_r.connection.once("socketsFailure",function(){_r.log("socketsFailure, creating a new connection"),yd(function(){return _r.connection.removeAllListeners(),_r.connection=new ct(_r.context,_r.logger,!0),_r.loginHandler(15e3,!0)}).pipe(Re(function(_s){return _s.pipe(Zd(ue.getParameter("RECONNECTING_AP_INTERVAL")))}),Kc(_r.connection.apClient.apFinish$)).subscribe(function(){_r.log("new connection connected")})}),_r.connection.listenerCount("tokenExpired")===0&&_r.connection.on("tokenExpired",function(){_r.emit("tokenExpired")})}),_r.context=_,_r.context.startTime=_r.startTime,_r.connection=$,_r.instanceId=_e,_r.chatManager=new CE(_n),_r.lastPingTime=[0,0],_r.setMaxListeners(512),_r.log("The instanceId is %s",_r.instanceId.toString()),_r.chanelStringMessageReport=new zi(_,_n,Ka.ChannelSMsg),_r.chanelRawMessageReport=new zi(_,_n,Ka.ChannelRMsg),_r.p2pSMsgNoOfflineReport=new zi(_,_n,Ka.P2pSMsgNoOfflineFlag),_r.p2pRMsgNoOfflineReport=new zi(_,_n,Ka.P2pRMsgNoOfflineFlag),_r}Ga(o,e);var s,a=Ha(o);return eb(o,[{key:"loginHandler",value:function(){var _=this,$=0<arguments.length&&arguments[0]!==void 0?arguments[0]:12e3,_e=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(this.loggedOut&&_e)throw new da("Already logged out, request ignored");_e&&this.registerSocketsFailureListener(),this.connection.initConnection();var _n=this.getSocketLoginObservables(this.connection.lastOpenSockets,this.seq),_r=Date.now();return _n.forEach(function(_s,na){var ba=_.loginSocketSubs[na].login;ba!==void 0&&ba.unsubscribe(),_.loginSocketSubs[na].login=_s.pipe(sa(function(_p){var _f;_.curLoginSockets[na]=_p;var _E=Date.now();bb("Link",{ackedServerIp:_p.address,destServerIp:_p.ip,ec:0,sc:0,elapse:Xa(_.startTime),lts:P.fromNumber(_E),responseTime:_E-_r,sid:sb(_.instanceId),userId:_.context.uid},(_f=_.context.config.enableCloudProxy)!==null&&_f!==void 0&&_f),_.emit("userJoined",_p.env),_e&&_.connection.apClient.apFinish$.next(void 0)})).subscribe(_.lastLoginSockets[na])}),this.initKeepAliveSender(),this.initKeepAliveReconnector(),this.initLoginReceiver(),Jb.apply(void 0,Z(_n).concat([Db(this.connection,"connectionInitFailure").pipe(sa(function(_s){throw Na(_s)||Ab(_s)?_s:new Ja("Login failure",{code:$r,originalError:_s})}))])).pipe(hb(1),Lb($),ab(function(_s){return _s instanceof Tb&&_.warn("Client login timeout"),_s&&_s.code===ti&&(_.connection.emit("tokenExpired"),_.connection.apClient.apFinish$.next(void 0)),_.clearSockets(0,_e),ra(_s)}),sa(function(){_e||_.registerSocketsFailureListener()}),fh(function(){_e||_.connection.apClient.apFinish$.next(void 0)}))}},{key:"logoutHandler",value:(s=ma(N.mark(function _(){var $,_e,_n,_r=this;return N.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:return this.loggedOut=!0,this.connection.apClient.apFinish$.next(void 0),$=this.getLoginSockets(),_e=$.map(function(na){return na.sendPacket("UserQuit",{}),_r.connection.waitClosing(na)}),this.clearSockets(5e3),_n=$.map(function(na){return na.env}),[0,1].filter(function(na){return!_n.includes(na)}).forEach(function(na){_r.connection.closeSocket(na,0)}),_s.abrupt("return",Jb.apply(void 0,Z(_e)).toPromise());case 9:case"end":return _s.stop()}},_,this)})),function(){return s.apply(this,arguments)})},{key:"requestChannelJoin",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s,na=this;return N.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:if(this.getLoginSockets().length!==0){ba.next=2;break}throw new da("Client is not logged in. Cannot join the channel",Wr);case 2:return _n=Db(this,"channelLeft").pipe(yb(function(_p){return _e===_p}),hb(1)),_r=this.incGetSeq(),(_s=this.lastLoginSockets.map(function(_p){return _p.pipe(Kb(function(_f,_E){_E!==0&&na.incSeqIfNeeded(_f.env);var _v=_E===0?_r:na.seq;return _f.sendPacket("GroupEnter",{account:_e,seq:_v}),_f.fromReceived("GroupReply").pipe(Ca(function(n_){return _v.eq(n_.seq)}),sa(function(n_){if((n_=n_.code)!==0)throw new Ja(["Channel join failure. The response code is %d",n_],Sr)}))}),Kc(_n),Se())})).forEach(function(_p,_f){var _E=function(){return na.loginSocketSubs[_f].channels.delete(_e)};na.loginSocketSubs[_f].channels.set(_e,_p.subscribe({error:_E,complete:_E}))}),ba.next=8,Jb.apply(void 0,Z(_s)).pipe(hb(1),Lb(1e4),ab(function(_p){return _p instanceof Tb&&na.warn("Channel join timeout"),ra(_p)})).toPromise();case 8:case"end":return ba.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"requestChannelLeave",value:function(_){this.getLoginSockets().forEach(function($){$.sendPacket("GroupLeave",{account:_})})}},{key:"requestUpdateEdgeTicket",value:function(_){var $=this,_e=this.getLoginSockets();if(_e.length===0)throw new da("Client is not logged in. Cannot renew token",hs);var _n=this.incGetSeq();return _e.forEach(function(_r){_r.sendPacket("UserRenewTokenReq",{instance:$.instanceId,seq:_n,account:$.context.uid,ticket:_})}),fb.apply(void 0,[o.genTimeoutError(Ml)].concat(Z(_e.map(function(_r){return _r.fromReceived("UserRenewTokenResp").pipe(Ca(function(_s){var na=_s.code;return _n.eq(_s.seq)&&na===0}))}))))}},{key:"requestChannelMemberList",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new da("Client is not logged in. Cannot get the channel members",JB);var _e=this.incGetSeq();return $.forEach(function(_n){_n.sendPacket("GroupAllUsersList",{group:_,pageNumber:0,pageSize:200,seq:_e})}),fb.apply(void 0,[o.genTimeoutError(Qr)].concat(Z($.map(function(_n){return _n.fromReceived("GroupAllUsersResult").pipe(Ca(function(_r){var _s=_r.seq;return _r.group===_&&_e.eq(_s)}))}))))}},{key:"requestPeersOnlineStatus",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new da("Client is not logged in");var _e=this.incGetSeq();return $.forEach(function(_n){_n.sendPacket("UserStatusList",{users:_,seq:_e})}),fb.apply(void 0,[o.genTimeoutError(VB)].concat(Z($.map(function(_n){return _n.fromReceived("UserStatusResult").pipe(Ca(function(_r){return _e.eq(_r.seq)}))}))))}},{key:"requestSetLocalUserAttributes",value:function(_,$){var _e=this,_n=this.getLoginSockets();if(_n.length===0)throw new da("Client is not logged in");var _r=this.incGetSeq();return _n.forEach(function(_s,na){$!==void 0&&na!==$||_s.sendPacket("UserAttributeSet",{account:_e.context.uid,attributeInfos:Object.entries(_).map(function(ba){return{key:(ba=$a(ba,2))[0],value:ba[1]}}),seq:_r})}),fb.apply(void 0,Z(_n.map(function(_s){return _s.fromReceived("UserAttributeErr").pipe(Ca(function(na){return _r.eq(na.seq)}),Ea(function(na){throw new Ja(["The user attributes set failure, code %d",na.code],oc)}))})).concat([o.genTimeoutError(pc)],Z(_n.map(function(_s){return _s.fromReceived("UserAttributeRsp").pipe(Ca(function(na){return _r.eq(na.seq)}))}))))}},{key:"requestSetChannelAttributes",value:function(_,$,_e){var _n=this.getLoginSockets();if(_n.length===0)throw new da("Client is not logged in");var _r=this.incGetSeq();return _n.forEach(function(_s){_s.sendPacket("GroupAttributeSet",{broadcast:_e,group:_,attributeInfos:Object.entries($).map(function(na){return{key:(na=$a(na,2))[0],value:na[1]}}),seq:_r})}),fb.apply(void 0,Z(_n.map(function(_s){return _s.fromReceived("GroupAttributeErr").pipe(Ca(function(na){return _r.eq(na.seq)}),Ea(function(na){throw new Ja(["The group attributes set failure, code %d",na.code],oc)}))})).concat([o.genTimeoutError(pc)],Z(_n.map(function(_s){return _s.fromReceived("GroupAttributeRsp").pipe(Ca(function(na){return _r.eq(na.seq)}))}))))}},{key:"requestAddOrUpdateLocalUserAttributes",value:function(_){var $=this,_e=this.getLoginSockets();if(_e.length===0)throw new da("Client is not logged in");var _n=this.incGetSeq();return _e.forEach(function(_r){_r.sendPacket("UserAttributeMod",{account:$.context.uid,attributeInfos:Object.entries(_).map(function(_s){return{key:(_s=$a(_s,2))[0],value:_s[1]}}),seq:_n})}),fb.apply(void 0,Z(_e.map(function(_r){return _r.fromReceived("UserAttributeErr").pipe(Ca(function(_s){return _n.eq(_s.seq)}),Ea(function(_s){throw new Ja(["The user attributes add or update failure, code %d",_s.code],oc)}))})).concat([o.genTimeoutError(pc)],Z(_e.map(function(_r){return _r.fromReceived("UserAttributeRsp").pipe(Ca(function(_s){return _n.eq(_s.seq)}))}))))}},{key:"requestAddOrUpdateChannelAttributes",value:function(_,$,_e){var _n=this.getLoginSockets();if(_n.length===0)throw new da("Client is not logged in");var _r=this.incGetSeq();return _n.forEach(function(_s){_s.sendPacket("GroupAttributeMod",{broadcast:_e,group:_,attributeInfos:Object.entries($).map(function(na){return{key:(na=$a(na,2))[0],value:na[1]}}),seq:_r})}),fb.apply(void 0,Z(_n.map(function(_s){return _s.fromReceived("GroupAttributeErr").pipe(Ca(function(na){return _r.eq(na.seq)}),Ea(function(na){throw new Ja(["The group attributes add or update failure, code %d",na.code],oc)}))})).concat([o.genTimeoutError(pc)],Z(_n.map(function(_s){return _s.fromReceived("GroupAttributeRsp").pipe(Ca(function(na){return _r.eq(na.seq)}))}))))}},{key:"requestDeleteLocalUserAttributesByKeys",value:function(_){var $=this,_e=this.getLoginSockets();if(_e.length===0)throw new da("Client is not logged in");var _n=this.incGetSeq();return _e.forEach(function(_r){_r.sendPacket("UserAttributeDel",{account:$.context.uid,attributes:_,seq:_n})}),fb.apply(void 0,Z(_e.map(function(_r){return _r.fromReceived("UserAttributeErr").pipe(Ca(function(_s){return _n.eq(_s.seq)}),Ea(function(_s){throw new Ja(["The user attributes delete failure, code %d",_s.code],oc)}))})).concat([o.genTimeoutError(pc)],Z(_e.map(function(_r){return _r.fromReceived("UserAttributeRsp").pipe(Ca(function(_s){return _n.eq(_s.seq)}))}))))}},{key:"requestDeleteChannelAttributesByKeys",value:function(_,$,_e){var _n=this.getLoginSockets();if(_n.length===0)throw new da("Client is not logged in");var _r=this.incGetSeq();return _n.forEach(function(_s){_s.sendPacket("GroupAttributeDel",{group:_,broadcast:_e,attributes:$,seq:_r})}),fb.apply(void 0,Z(_n.map(function(_s){return _s.fromReceived("GroupAttributeErr").pipe(Ca(function(na){return _r.eq(na.seq)}),Ea(function(na){throw new Ja(["The channel attributes delete failure, code %d",na.code],oc)}))})).concat([o.genTimeoutError(pc)],Z(_n.map(function(_s){return _s.fromReceived("GroupAttributeRsp").pipe(Ca(function(na){return _r.eq(na.seq)}))}))))}},{key:"requestClearLocalUserAttributes",value:function(){var _=this,$=this.getLoginSockets();if($.length===0)throw new da("Client is not logged in");var _e=this.incGetSeq();return $.forEach(function(_n){_n.sendPacket("UserAttributeSet",{account:_.context.uid,seq:_e,attributeInfos:[]})}),fb.apply(void 0,Z($.map(function(_n){return _n.fromReceived("UserAttributeErr").pipe(Ca(function(_r){return _e.eq(_r.seq)}),Ea(function(_r){throw new Ja(["The user attributes clear failure, code %d",_r.code],oc)}))})).concat([o.genTimeoutError(pc)],Z($.map(function(_n){return _n.fromReceived("UserAttributeRsp").pipe(Ca(function(_r){return _e.eq(_r.seq)}))}))))}},{key:"requestClearChannelAttributes",value:function(_,$){var _e=this.getLoginSockets();if(_e.length===0)throw new da("Client is not logged in");var _n=this.incGetSeq();return _e.forEach(function(_r){_r.sendPacket("GroupAttributeSet",{group:_,seq:_n,attributeInfos:[],broadcast:$})}),fb.apply(void 0,Z(_e.map(function(_r){return _r.fromReceived("GroupAttributeErr").pipe(Ca(function(_s){return _n.eq(_s.seq)}),Ea(function(_s){throw new Ja(["The channel attributes clear failure, code %d",_s.code],oc)}))})).concat([o.genTimeoutError(pc)],Z(_e.map(function(_r){return _r.fromReceived("GroupAttributeRsp").pipe(Ca(function(_s){return _n.eq(_s.seq)}))}))))}},{key:"requestGetUserAttributesByKeys",value:function(_,$){var _e=this.getLoginSockets();if(_e.length===0)throw new da("Client is not logged in");var _n=this.incGetSeq();return _e.forEach(function(_r){_r.sendPacket("UserAttributeGet",{account:_,seq:_n,attributes:$})}),fb.apply(void 0,[o.genTimeoutError(pc)].concat(Z(_e.map(function(_r){return _r.fromReceived("UserAttributeErr").pipe(Ca(function(_s){return _n.eq(_s.seq)}),Ea(function(_s){throw(_s=_s.code)===10008?new Ja("The user requested is not online",Mr):new ve(["User attribute operation unknown error code: %d",_s],oc)}))})),Z(_e.map(function(_r){return _r.fromReceived("UserAttributeRet").pipe(Ca(function(_s){return _n.eq(_s.seq)}))}))))}},{key:"requestGetChannelAttributesByKeys",value:function(_,$){var _e=this.getLoginSockets();if(_e.length===0)throw new da("Client is not logged in");var _n=this.incGetSeq();return _e.forEach(function(_r){_r.sendPacket("GroupAttributeGet",{group:_,seq:_n,attributes:$})}),fb.apply(void 0,[o.genTimeoutError(pc)].concat(Z(_e.map(function(_r){return _r.fromReceived("GroupAttributeErr").pipe(Ca(function(_s){return _n.eq(_s.seq)}),Ea(function(_s){throw new Ja(["The channel attributes get failure, code %d",_s.code],oc)}))})),Z(_e.map(function(_r){return _r.fromReceived("GroupAttributeRet").pipe(Ca(function(_s){return _n.eq(_s.seq)}))}))))}},{key:"requestGetUserAttributeKeys",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new da("Client is not logged in");var _e=this.incGetSeq();return $.forEach(function(_n){_n.sendPacket("UserAttributeKeysGet",{account:_,seq:_e})}),fb.apply(void 0,[o.genTimeoutError(pc)].concat(Z($.map(function(_n){return _n.fromReceived("UserAttributeErr").pipe(Ca(function(_r){return _e.eq(_r.seq)}),Ea(function(_r){throw(_r=_r.code)===10008?new Ja("The user requested is not online",Mr):new ve(["User attribute operation unknown error code: %d",_r],oc)}))})),Z($.map(function(_n){return _n.fromReceived("UserAttributeKeysRet").pipe(Ca(function(_r){return _e.eq(_r.seq)}))}))))}},{key:"requestGetChannelAttributesKeys",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new da("Client is not logged in");var _e=this.incGetSeq();return $.forEach(function(_n){_n.sendPacket("GroupAttributeKeysGet",{group:_,seq:_e})}),fb.apply(void 0,[o.genTimeoutError(pc)].concat(Z($.map(function(_n){return _n.fromReceived("GroupAttributeErr").pipe(Ca(function(_r){return _e.eq(_r.seq)}),Ea(function(_r){throw new ve(["Channel attribute operation unknown error code: %d",_r.code],oc)}))})),Z($.map(function(_n){return _n.fromReceived("GroupAttributeKeysRet").pipe(Ca(function(_r){return _e.eq(_r.seq)}))}))))}},{key:"requestGetChannelMemberCount",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new da("Client is not logged in");var _e=this.incGetSeq();return $.forEach(function(_n){_n.sendPacket("GroupStatusList",{groups:_,seq:_e})}),fb.apply(void 0,[o.genTimeoutError(Qr)].concat(Z($.map(function(_n){return _n.fromReceived("GroupStatusResult").pipe(Ca(function(_r){return _e.eq(_r.seq)}))}))))}},{key:"requestSubscribePeersOnlineStatus",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new da("Client is not logged in");var _e=this.incGetSeq();return $.forEach(function(_n){_n.sendPacket("SubscribeUserStatus",{seq:_e,users:_})}),fb.apply(void 0,[o.genTimeoutError($B)].concat(Z($.map(function(_n){return _n.fromReceived("SubscribeResponse").pipe(Ca(function(_r){return _e.eq(_r.seq)}))}))))}},{key:"requestUnsubscribePeersOnlineStatus",value:function(_){var $=this.getLoginSockets();if($.length===0)throw new da("Client is not logged in");var _e=this.incGetSeq();$.forEach(function(_n){_n.sendPacket("UnsubscribeUserStatus",{seq:_e,users:_})})}},{key:"sendInvitationMessage",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s,na,ba,_p,_f,_E,_v,n_,e_,t_,o_=this;return N.wrap(function(m_){for(;;)switch(m_.prev=m_.next){case 0:if(_n=_e.peerId,_r=_e.callId,_s=_e.extra,na=_e.isAcceptAck,ba=_e.channelId,_p=_e.type,_f={callId:_r},na===void 0){m_.next=6;break}if(_p==="CallAccept"){m_.next=5;break}throw Error("invalid invitation type");case 5:_f.type=na?"ack":"request";case 6:return _f.channel=ba,(_p==="CallInvite"||_p==="CallCancel"||_p==="CallReject"||_p==="CallAccept"&&na===!1)&&_s!==void 0&&(_f.extra=_s),_E=nh(),this.log("The sent invitation body is %o",_f),_v=function(b_){return{MiscMap:{},sequence:P.fromNumber(1),dialogue:_E,instance:o_.instanceId,dst:_n,ms:P.fromNumber(Date.now(),!0),options:new Ef({IterationNumber:b_,MessageType:_p}).toLong(),payload:new TextEncoder().encode(JSON.stringify(_f)),src:o_.context.uid}},m_.next=14,Jc(this.sendMessageToRetry(_v,!0)).pipe(Lb(1e4),ab(function(b_){return b_ instanceof Tb&&o_.warn("Send invitation timeout"),ra(b_)})).toPromise();case 14:return n_=m_.sent,e_=n_.code,t_=n_.retryTimes,m_.abrupt("return",{hasPeerReceived:e_===0,hasReSent:t_!==0});case 18:case"end":return m_.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"sendRawMessage",value:function(){var _=ma(N.mark(function $(_e,_n,_r,_s,na){var ba,_p,_f,_E,_v,n_,e_,t_,o_,m_,b_,w_=this;return N.wrap(function(y_){for(;;)switch(y_.prev=y_.next){case 0:if(ba=Date.now(),_p=_s?Ka.P2pRMsgNoOfflineFlag:Ka.ChannelRMsg,Ta(_r)&&_e instanceof Uint8Array&&typeof _n=="string"){y_.next=4;break}throw new ca("The send message arguments are not valid",_s?fs:qi);case 4:if(!(32768<_e.byteLength+new Blob([_n]).size)){y_.next=8;break}throw this.emit("messageCount",{messageCategory:_p,type:"common",key:"sentcount"}),this.emit("messageCount",{messageCategory:_p,type:"common",key:"invalidmessagecount"}),new ic("The message size is over the 32KB limit",_s?bg:Il);case 8:return _f=!ue.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=_e.byteLength,_E=this.chatManager.getChatInfo(_r),_v=_E.dialogue,n_=_E.sequence,e_=this.instanceId,this.log('A%s %s raw message is sending to %s: "'.concat(e_,"-").concat(_v,"#").concat(n_,'"'),_f?" compressed":"",_s?"peer":"channel",La(_r)),t_=function(N_){return{MiscMap:{description:new TextEncoder().encode(_n)},sequence:n_,dialogue:_v,instance:e_,dst:_r,ms:P.fromNumber(Date.now(),!0),options:new Ef({IterationNumber:N_,CompressionMethod:_f?"Zlib":"Uncompressed",MessageType:_s?"PeerRawMessage":"ChannelRawMessage",ToCache:!1,ToArchive:!1}).toLong(),payload:_f?St(_e):_e,src:w_.context.uid}},y_.next=15,Jc(this.sendMessageToRetry(t_,!0)).pipe(Lb(na===void 0?1e4:na),ab(function(N_){return N_ instanceof Tb&&w_.warn("Send message timeout"),ra(N_)})).toPromise();case 15:return o_=y_.sent,m_=o_.code,b_=m_===0,this.emit("messageCount",{messageCategory:_p,type:"common",key:"sentcount"}),b_&&(this.emit("messageCount",{messageCategory:_p,type:"common",key:"successcount"}),this.emit("messageCount",{messageCategory:_p,type:_s?"peer":"recipient",delay:Xa(ba).toNumber()})),y_.abrupt("return",{hasPeerReceived:b_});case 21:case"end":return y_.stop()}},$,this)}));return function($,_e,_n,_r,_s){return _.apply(this,arguments)}}()},{key:"sendTextMessage",value:function(){var _=ma(N.mark(function $(_e,_n,_r,_s){var na,ba,_p,_f,_E,_v,n_,e_,t_,o_,m_,b_,w_=this;return N.wrap(function(y_){for(;;)switch(y_.prev=y_.next){case 0:if(na=Date.now(),ba=_r?Ka.P2pSMsgNoOfflineFlag:Ka.ChannelSMsg,Ta(_n)){y_.next=4;break}throw new ca("The send message arguments are not valid",_r?fs:qi);case 4:if(!(32768<new Blob([_e]).size)){y_.next=8;break}throw this.emit("messageCount",{messageCategory:ba,type:"common",key:"sentcount"}),this.emit("messageCount",{messageCategory:ba,type:"common",key:"invalidmessagecount"}),new ic("The message size is over the 32KB limit",_r?bg:Il);case 8:return _p=!ue.getParameter("DISABLE_MESSAGE_COMPRESSION")&&128<=new Blob([_e]).size,_f=this.chatManager.getChatInfo(_n),_E=_f.dialogue,_v=_f.sequence,n_=this.instanceId,this.log('A%s %s message is sending to %s: "'.concat(n_,"-").concat(_E,"#").concat(_v,'"'),_p?" compressed":"",_r?"peer":"channel",La(_n)),e_=new TextEncoder().encode(_e),t_=function(N_){return{MiscMap:{},sequence:_v,dialogue:_E,instance:n_,dst:_n,ms:P.fromNumber(Date.now(),!0),options:new Ef({IterationNumber:N_,CompressionMethod:_p?"Zlib":"Uncompressed",MessageType:_r?"PeerTextMessage":"ChannelTextMessage",ToCache:!1,ToArchive:!1}).toLong(),payload:_p?St(e_):e_,src:w_.context.uid}},y_.next=16,Jc(this.sendMessageToRetry(t_,!0)).pipe(Lb(_s===void 0?1e4:_s),ab(function(N_){return N_ instanceof Tb&&(w_.emit("messageCount",{messageCategory:ba,type:"common",key:"sentcount"}),w_.emit("messageCount",{messageCategory:ba,type:"common",key:"timeoutcount"}),w_.warn("Send message timeout")),ra(N_)})).toPromise();case 16:return o_=y_.sent,m_=o_.code,b_=m_===0,this.emit("messageCount",{messageCategory:ba,type:"common",key:"sentcount"}),b_&&(this.emit("messageCount",{messageCategory:ba,type:"common",key:"successcount"}),this.emit("messageCount",{messageCategory:ba,type:_r?"peer":"recipient",delay:Xa(na).toNumber()})),y_.abrupt("return",{hasPeerReceived:b_});case 22:case"end":return y_.stop()}},$,this)}));return function($,_e,_n,_r){return _.apply(this,arguments)}}()},{key:"cleanLoginSubs",value:function(_,$){Object.entries(this.loginSocketSubs[_]).forEach(function(_e){var _n=(_e=$a(_e,2))[1];_e[0]==="channels"&&$||(Array.isArray(_n)||_n instanceof Map?_n.forEach(function(_r){return _r.unsubscribe()}):_n&&_n.unsubscribe())}),this.loginSocketSubs[_]={channels:$?this.loginSocketSubs[_].channels:new Map,receivers:[]}}},{key:"sendMessageToRetry",value:function(){var _=ma(N.mark(function $(_e,_n){var _r,_s,na,ba,_p,_f,_E,_v,n_,e_=this,t_=arguments;return N.wrap(function(o_){for(;;)switch(o_.prev=o_.next){case 0:if(_r=2<t_.length&&t_[2]!==void 0?t_[2]:0,this.log("Attempt to send the message ".concat(_n?" with retrying, %o":"without retrying"),{retryTimes:_r}),(_s=this.getLoginSockets()).length!==0){o_.next=5;break}throw Error("no logged-in sockets");case 5:return na=_e(_r),_s.forEach(function(m_){m_.sendPacket("Message",na)}),ba=na.dialogue,_p=na.sequence,_f=na.instance,_E=_s.map(function(m_){return m_.fromReceived("Ack").pipe(yb(function(b_){return ba.eq(b_.dialogue)&&_p.eq(b_.sequence)&&_f.eq(b_.instance)}))}),o_.prev=9,o_.next=12,Jb.apply(void 0,Z(_E)).pipe(Lb(6e3),ab(function(m_){return Ab(m_)&&e_.warn("Message send timeout, retry times %d",_r),ra(m_)}),hb(1)).toPromise();case 12:return _v=o_.sent,n_=_v.code,this.log("The message has been acked, %o",{code:n_}),o_.abrupt("return",{code:n_,retryTimes:_r});case 18:if(o_.prev=18,o_.t0=o_.catch(9),!(o_.t0 instanceof Tb&&_n)){o_.next=22;break}return o_.abrupt("return",this.sendMessageToRetry(_e,!1,_r+1));case 22:throw o_.t0;case 23:case"end":return o_.stop()}},$,this,[[9,18]])}));return function($,_e){return _.apply(this,arguments)}}()},{key:"initKeepAliveSender",value:function(){var _=this;this.lastLoginSockets.map(function($){return $.pipe(Kb(function(_e){return dd(0,2500,Ce()?void 0:oF).pipe(sa(function(){_.sendPing(_e)}))}))}).forEach(function($,_e){var _n=_.loginSocketSubs[_e].keepAlive;_n!==void 0&&_n.unsubscribe(),_.loginSocketSubs[_e].keepAlive=$.subscribe({error:function(){}})})}},{key:"initKeepAliveReconnector",value:function(){var _=this;this.lastLoginSockets.map(function($){return $.pipe(Kb(function(_e){var _n,_r=!1,_s=_e.userJoin$.pipe(sa(function(){_r=!0})),na=_e.input$.pipe(sa(function(ba){yj[ba.uri].slice(0,-3)!=="Ping"&&(_r=!1)}));return Jb(dd(6e3,1e4).pipe(yv(_e.receivedPacket),sa(function(ba){ba=$a(ba,2),ba=$a(ba[1],2)[1],_n!==ba||_r||_e.forceReconnect(),_n=ba})),_s,na)}))}).forEach(function($,_e){var _n=_.loginSocketSubs[_e].keepAliveReconnector;_n!==void 0&&_n.unsubscribe(),_.loginSocketSubs[_e].keepAliveReconnector=$.subscribe({error:function(){}})})}},{key:"initLoginReceiver",value:function(){var _=this;fb.apply(void 0,Z(this.lastLoginSockets.map(function(_n){return _n.pipe(Kb(function(_r){return _r.fromReceived("UserTicketNearlyExpire").pipe(sv(5e3),sa(_.onUserTicketNearlyExpire(_r)))}))}))).subscribe();var $=Db(this,"messageCount"),_e=$.pipe(yb(function(_n){return _n.messageCategory===Ka.ChannelSMsg}));_e.subscribe(function(_n){return _.updateMessageCount(_n)}),_e.pipe(dh(6e3)).subscribe(function(_n){_n.length&&_.chanelStringMessageReport.report()}),Jb(ob(void 0),_e).pipe(Kb(function(){return Qe(36e5)})).subscribe(function(){_.chanelStringMessageReport.report()}),(_e=$.pipe(yb(function(_n){return _n.messageCategory===Ka.ChannelRMsg}))).subscribe(function(_n){return _.updateMessageCount(_n)}),_e.pipe(dh(6e3)).subscribe(function(_n){_n.length&&_.chanelRawMessageReport.report()}),Jb(ob(void 0),_e).pipe(Kb(function(){return Qe(36e5)})).subscribe(function(){_.chanelRawMessageReport.report()}),(_e=$.pipe(yb(function(_n){return _n.messageCategory===Ka.P2pSMsgNoOfflineFlag}))).subscribe(function(_n){return _.updateMessageCount(_n)}),_e.pipe(dh(6e3)).subscribe(function(_n){_n.length&&_.p2pSMsgNoOfflineReport.report()}),Jb(ob(void 0),_e).pipe(Kb(function(){return Qe(36e5)})).subscribe(function(){_.p2pSMsgNoOfflineReport.report()}),($=$.pipe(yb(function(_n){return _n.messageCategory===Ka.P2pRMsgNoOfflineFlag}))).subscribe(function(_n){return _.updateMessageCount(_n)}),$.pipe(dh(6e3)).subscribe(function(_n){_n.length&&_.p2pRMsgNoOfflineReport.report()}),Jb(ob(void 0),$).pipe(Kb(function(){return Qe(36e5)})).subscribe(function(){_.p2pSMsgNoOfflineReport.report()}),this.lastLoginSockets.map(function(_n){return _n.pipe(Kb(function(_r){return Jb(Db(_r,"reconnect").pipe(sa(_.onSocketReconnect(_r))),_r.fromReceived("Message").pipe(sa(_.onMessage(_r))),_r.fromReceived("GroupEnterNotice").pipe(sa(_.onGroupEnterNotice())),_r.fromReceived("GroupLeaveNotice").pipe(sa(_.onGroupLeaveNotice())),_r.fromReceived("GroupCountNotice").pipe(sa(_.onGroupCountNotice())),_r.fromReceived("GroupAttributeAlt").pipe(sa(_.onGroupAttributeAlt())),_r.fromReceived("UserJoinNotice").pipe(sa(_.onUserNotice(ta.PeerOnlineState.ONLINE))),_r.fromReceived("UserQuitNotice").pipe(sa(_.onUserNotice(ta.PeerOnlineState.OFFLINE))),_r.fromReceived("UserWaitNotice").pipe(sa(_.onUserNotice(ta.PeerOnlineState.UNREACHABLE))),_r.fromReceived("Pong").pipe(sa(_.onPong())),_r.fromReceived("UserDrop").pipe(sa(_.onUserDrop(_r))),_r.fromReceived("GroupDrop").pipe(sa(_.onGroupDrop()))).pipe(Uf(void 0))}))}).forEach(function(_n,_r){_.loginSocketSubs[_r].receivers.push(_n.subscribe({error:function(){}}))})}},{key:"requestSocketLogin",value:function(_,$,_e){var _n=this;return nn(yd(function(){_n.userJoinOptions=new et($),_.sendPacket("UserJoin",{account:_n.context.uid,instance:_n.instanceId,opt:_n.userJoinOptions.toLong(),seq:_e,ticket:_.ticket})}),_.fromReceived("UserResp").pipe(Ca(function(_r){return _e.eq(_r.seq)}),sa(function(_r){if((_r=_r.code)!==0)throw _n.clearSockets(),_n.logError("Connected to gateway success but the Rtm server rejected login"),new Ja(["Login failure. The response code from the RTM service is %d",_r],Pg);_.attemptsSinceLastError=0,_.loggedIn=!0,_n.log("ENV_%d logged in",_.env)}),Uf(_),Lb(6e3))).pipe(yb(function(_r){return _r!==void 0}),ab(function(_r){return _r instanceof Tb&&_n.warn("Login response timeout, rejoin: %s",$),_n.clearSockets(),_r.name="loginRespTimeout",_n.emit("banEdgeIP",_.ip),ra(_r)}))}},{key:"getSocketLoginObservables",value:function(_,$){var _e=this;return _.map(function(_n){return _n.pipe(Kb(function(_r,_s){return _e.incSeqIfNeeded(_r.env),_e.requestSocketLogin(_r,_s!==0,_s===0?$:_e.seq)}),Se())})}},{key:"incSeqIfNeeded",value:function(_){if(![0,1].includes(_))throw new mb({INVALID_ENV:"The env argument is not 0 or 1"});this.seqSentStatuses[_]&&(this.seq=this.seq.add(1),this.seqSentStatuses=[!1,!1]),this.seqSentStatuses[_]=!0}},{key:"incGetSeq",value:function(){return this.seq=this.seq.add(1),this.seqSentStatuses=[!0,!0],this.seq}},{key:"getLoginSockets",value:function(){for(var _=this.curLoginSockets,$=-1,_e=_==null?0:_.length,_n=0,_r=[];++$<_e;){var _s=_[$];_s&&(_r[_n++]=_s)}return _r}},{key:"emitMessage",value:function(_,$){var _e,_n=_.options,_r=_.payload,_s=_.src,na=_.dst,ba=_.instance,_p=_.dialogue,_f=_.sequence,_E=_.ms,_v=_.MiscMap;this.dialogueSequenceLru.set(_p.toString(),_f),ba="".concat(ba,"-").concat(_p,"#").concat(_f),this.msgDedupLru.has(ba)?this.warn("Env_%d: Messages out-of-order or not start with 1: %s",$,ba):(this.msgDedupLru.set(ba,void 0),_n=new Ef(_n),this.lastLoginSockets.forEach((_e=ma(N.mark(function n_(e_){var t_;return N.wrap(function(o_){for(;;)switch(o_.prev=o_.next){case 0:return o_.next=2,e_.pipe(hb(1)).toPromise();case 2:t_=o_.sent,o.sendMessageAck(_,t_);case 4:case"end":return o_.stop()}},n_)})),function(n_){return _e.apply(this,arguments)})),$=_n.isZlibCompressed(),_n.isInvitation()?(na=cg($?mm(ao(_r,Uint8Array.of(0,0,0,0))):_r),na=JSON.parse(na),this.log("The received invitation body is %o",na),this.emit("invitationMessage",{body:na,type:_n.getInvitationType(),peerId:_s,serverReceivedTs:_E.toNumber()})):_n.isTextMessage()?(_v=_n.isPeerTextMessage(),_r=cg($?mm(ao(_r,Uint8Array.of(0,0,0,0))):_r),this.info("Received a %s %s text message from %s to %s, %s",$?" compressed":"",_v?"peer":"channel",La(_s),La(na),ba),_v?(_s={text:_r,peerId:_s,properties:{serverReceivedTs:_E.toNumber()}},this.emit("peerTextMessage",_s),this.emit("messageCount",{messageCategory:Ka.P2pSMsgNoOfflineFlag,type:"common",key:"receivedcount"})):(this.emit("channelTextMessage",{channelId:na,memberId:_s,text:_r,properties:{serverReceivedTs:_E.toNumber()}}),this.emit("messageCount",{messageCategory:Ka.ChannelSMsg,type:"common",key:"receivedcount"}))):_n.isRawMessage()&&(_n=_n.isRawPeerMessage(),_v=(_v=_v.description)===void 0?"":cg(_v),_r=$?mm(_r):_r,this.info("Received a %s %s raw message from %s to %s, %s",$?" compressed":"",_n?"peer":"channel",La(_s),La(na),ba),_n?(_s={desc:_v,raw:_r,peerId:_s,properties:{serverReceivedTs:_E.toNumber()}},this.emit("peerRawMessage",_s),this.emit("messageCount",{messageCategory:Ka.P2pRMsgNoOfflineFlag,type:"common",key:"receivedcount"})):(this.emit("channelRawMessage",{desc:_v,raw:_r,channelId:na,memberId:_s,properties:{serverReceivedTs:_E.toNumber()}}),this.emit("messageCount",{messageCategory:Ka.ChannelRMsg,type:"common",key:"receivedcount"}))))}},{key:"onSocketReconnect",value:function(_){var $=this;return function(){var _e=[0,1].filter(function(_n){return _n!==_.env})[0];(_e=$.connection.curOpenSockets[_e])&&!_e.loggedIn&&$.emit("connectionLost")}}},{key:"onUserTicketNearlyExpire",value:function(_){var $=this;return function(_e){(_e=_e.ticket)!==$.lastNoticeTicket&&_e===_.ticket?($.lastNoticeTicket=_e,$.emit("tokenPrivilegeWillExpire")):$.requestUpdateEdgeTicket(_.ticket).toPromise()}}},{key:"onGroupDrop",value:function(){var _=this;return function($){var _e,_n=$.account;bb("ChnLeave",{cname:_n,lts:P.fromNumber(Date.now()),elapse:Xa(_.startTime),errCode:RB,sid:sb(_.instanceId),userId:_.context.uid},(_e=_.context.config.enableCloudProxy)!==null&&_e!==void 0&&_e),[0,1].forEach(function(_r){return _.loginSocketSubs[_r].channels.delete(_n)}),_.logError("the user is kicked out of the current channel")}}},{key:"onUserDrop",value:function(_){var $=this;return function(_e){var _n;_e=_e.code,bb("KickedOff",{code:0,elapse:Xa($.startTime),linkId:parseInt(_.name.split("-")[1],10),lts:P.fromNumber(Date.now()),server:_.address,serverCode:_e,sid:sb($.instanceId),userId:$.context.uid},(_n=$.context.config.enableCloudProxy)!==null&&_n!==void 0&&_n),_e===10006||_e===10001?$.warn("Login too often and kicked off, reconnect and login"):_e===10009?($.warn("The instance ID conflicts, reconnecting"),$.instanceId=nh(),$.context.sid=sb($.instanceId),$.emit("instanceChanged",$.instanceId)):[2,11,14,15,16].includes(_e)&&($.emit("userDrop",_e),$.clearSockets())}}},{key:"clearSockets",value:function(){var _=this,$=0<arguments.length&&arguments[0]!==void 0?arguments[0]:0,_e=1<arguments.length&&arguments[1]!==void 0&&arguments[1];[0,1].forEach(function(_n){_.cleanLoginSubs(_n,_e),_.connection.closeSocket(_n,$)})}},{key:"onMessage",value:function(_){var $=this;return function(_e){var _n=_e.dialogue,_r=_e.instance,_s=_e.sequence,na=_e.options;if(_e.src===$.context.uid)$.log("The message is from the local account, ignored");else{var ba=_n.toString(),_p=$.dialPendingMsgSubjectMap.get(ba);if(_n="".concat(_r,"-").concat(_n,"#").concat(_s),_p)_p.next(_e),$.log("Env_%d: The dialogue has pending messages, next: %s",_.env,_n);else{var _f=$.dialogueSequenceLru.get(ba);if(_p=!_f&&_s.eq(1),_r=_f!==void 0&&_s.sub(_f).eq(1),_p||_r)$.emitMessage(_e,_.env);else{if(_f){if(_s.lte(_f))return;$.log("Env_%d: The message pended, the sequence is not continuous with the last: %s",_.env,_n)}else $.log("Env_%d: The message pended, the first sequence is not equal to 1: %s",_.env,_n);_s=new rb,$.dialPendingMsgSubjectMap.set(ba,_s);var _E=_s.pipe(Au(zl),gh(function(_v,n_){return[].concat(Z(_v),[n_])},[]),Ea(function(_v){return Z(_v).sort(function(n_,e_){return n_=n_.sequence,e_=e_.sequence,n_.eq(e_)?0:n_.gt(e_)?1:-1})}),wn(1));na=!(na=new Ef(na)).isFromCache()&&!na.isBufferedMessage(),_E.pipe(Kc(dd(na?750:1500)),Ca(function(_v){if(2>_v.length)return!1;for(var n_=_f===void 0?P.fromNumber(1,!0):_f.add(1),e_=0;e_<_v.length;n_=n_.add(1),e_++)if(!_v[e_].sequence.eq(n_))return!1;return!0}),fh(function(){$.dialPendingMsgSubjectMap.delete(ba)})).subscribe(function(_v){_v.forEach(function(n_){$.emitMessage(n_,_.env),$.log("Env_%d: The message queue has fully ordered, emitting: %s",_.env,"".concat(n_.instance,"-").concat(n_.dialogue,"#").concat(n_.sequence))})},function(_v){_v instanceof eh&&_E.pipe(hb(1)).subscribe(function(n_){return n_.forEach(function(e_){$.log("Env_%d: The message pending queue expired, emitting: %s",_.env,"".concat(e_.instance,"-").concat(e_.dialogue,"#").concat(e_.sequence)),$.emitMessage(e_,_.env)})})}),_s.next(_e)}}}}}},{key:"onPong",value:function(){var _=this;return function(){document.hidden&&_.getLoginSockets().forEach(function($){_.sendPing($)})}}},{key:"onGroupEnterNotice",value:function(){var _=this;return function($){_.emit("memberNotice",{channelId:$.group,seq:$.seq,instance:$.instance,memberId:$.user,type:"MemberJoined",size:$.size})}}},{key:"onGroupLeaveNotice",value:function(){var _=this;return function($){_.emit("memberNotice",{channelId:$.group,seq:$.seq,instance:$.instance,memberId:$.user,type:"MemberLeft",size:$.size})}}},{key:"onGroupCountNotice",value:function(){var _=this;return function($){_.emit("memberNotice",{channelId:$.group,seq:$.seq,instance:$.instance,type:"MemberCountUpdated",size:$.size})}}},{key:"onGroupAttributeAlt",value:function(){var _=this;return function($){var _e=$.group;$=Ki($,pF),_.emit("channelAttributesUpdated",Wa({channelId:_e},$))}}},{key:"onUserNotice",value:function(_){var $=this;return function(_e){$.emit("peerOnlineStatusChanged",{peerId:_e.user,instance:_e.instance,seq:_e.seq,state:_})}}},{key:"sendPing",value:function(_){2500>=Date.now()-this.lastPingTime[_.env]||(this.incSeqIfNeeded(_.env),_.sendPacket("Ping",{ms:P.fromNumber(Date.now(),!0),seq:this.seq}),this.lastPingTime[_.env]=Date.now())}},{key:"updateMessageCount",value:function(_){var $,_e=($={},x($,Ka.ChannelRMsg,this.chanelRawMessageReport),x($,Ka.ChannelSMsg,this.chanelStringMessageReport),x($,Ka.P2pRMsgNoOfflineFlag,this.p2pRMsgNoOfflineReport),x($,Ka.P2pSMsgNoOfflineFlag,this.p2pSMsgNoOfflineReport),x($,3,void 0),x($,4,void 0),x($,7,void 0),x($,8,void 0),x($,9,void 0),x($,10,void 0),$)[_.messageCategory];_.type==="common"?_e==null||_e.updateCommonCount(_.key):_.type==="peer"?_e==null||_e.updatePeerAckCount(_.delay):_e==null||_e.updateNorecipientackCount(_.delay)}}],[{key:"sendMessageAck",value:function(_,$){var _e=new Ef(_.options);(_e.isInvitation()||_e.isPeerMessage())&&$.sendPacket("Ack",{code:0,dialogue:_.dialogue,instance:_.instance,sequence:_.sequence})}}]),o}(sc());x(Tt,"genTimeoutError",function(e,o){return ob(void 0).pipe(Zd(o===void 0?1e4:o),Ea(function(){throw new Ub(["Request timed out after %ds",(o===void 0?1e4:o)/1e3],e)}))});var Ut,nm,om=0,pm=0;Ng.v1=function(e,o,s){s=o&&s||0;var a=o||[],_=(e=e||{}).node||Ut,$=e.clockseq!==void 0?e.clockseq:nm;if(_==null||$==null){var _e=Kr();_==null&&(_=Ut=[1|_e[0],_e[1],_e[2],_e[3],_e[4],_e[5]]),$==null&&($=nm=16383&(_e[6]<<8|_e[7]))}_e=e.msecs!==void 0?e.msecs:new Date().getTime();var _n=e.nsecs!==void 0?e.nsecs:pm+1,_r=_e-om+(_n-pm)/1e4;if(0>_r&&e.clockseq===void 0&&($=$+1&16383),(0>_r||_e>om)&&e.nsecs===void 0&&(_n=0),1e4<=_n)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");for(om=_e,pm=_n,nm=$,e=(1e4*(268435455&(_e+=122192928e5))+_n)%4294967296,a[s++]=e>>>24&255,a[s++]=e>>>16&255,a[s++]=e>>>8&255,a[s++]=255&e,e=_e/4294967296*1e4&268435455,a[s++]=e>>>8&255,a[s++]=255&e,a[s++]=e>>>24&15|16,a[s++]=e>>>16&255,a[s++]=$>>>8|128,a[s++]=255&$,$=0;6>$;++$)a[s+$]=_[$];return o||Lr(a)},Ng.v4=Ng;var qm=yi(),Sd,Hf=ta.LocalInvitationFailureReason,Sa=ta.LocalInvitationState,qF=(Sd=function(e){function o(a,_,$){va(this,o);var _e=s.call(this,$,"RtmLocalInvitation",!0);return x(z(_e),"state",Sa.IDLE),x(z(_e),"localInvitationEnd$",fb(Db(z(_e),"LocalInvitationAccepted"),Db(z(_e),"LocalInvitationRefused"),Db(z(_e),"LocalInvitationFailure"),Db(z(_e),"LocalInvitationCanceled")).pipe(hb(1))),x(z(_e),"callId",Ng.v4()),x(z(_e),"_content",""),x(z(_e),"_channelId",""),x(z(_e),"_response",""),x(z(_e),"calleeId",void 0),x(z(_e),"logger",void 0),x(z(_e),"getSession",void 0),_e.calleeId=a,_e.getSession=_,_e.logger=$,_e}Ga(o,e);var s=Ha(o);return eb(o,[{key:"channelId",get:function(){return this._channelId},set:function(a){this.state!==Sa.IDLE?this.info("set channelId only allow before invitation sent to remote"):(this.log("set channelId for %s",this.callId),this._channelId=a)}},{key:"content",get:function(){return this._content},set:function(a){this.log("set content for %s",this.callId),this._content=a}},{key:"response",get:function(){return this._response},set:function(a){throw new ca('Cannot set the "response" of the LocalInvitation instance.',Xc)}},{key:"send",value:function(){var a,_=this;if(this.state===Sa.SENT_TO_REMOTE||this.state===Sa.RECEIVED_BY_REMOTE)throw new da("The local invitation send failure. The call invitation has already been sent.",NB);if(this.isLocalInvitationEnd())throw new da("The local invitation send failure. The call invitation has ended.",ri);if(0<this._channelId.length&&!Ta(this._channelId))throw new ca("Illegal invitation channel ID",Xc);if(!Ta(this.calleeId))throw new ca("Illegal invitation callee user ID",Xc);if(8192<rh(this._content))throw new ca('The length of the "content" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',Xc);this.state=Sa.SENT_TO_REMOTE,yd(ma(N.mark(function $(){var _e,_n,_r;return N.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:return _s.next=2,_.getSession().sendInvitationMessage({peerId:_.calleeId,callId:_.callId,extra:_._content,type:"CallInvite",channelId:_._channelId});case 2:if(_e=_s.sent,_n=_e.hasPeerReceived,_r=_e.hasReSent,!_.isLocalInvitationEnd()){_s.next=7;break}throw new Ub("send invitation timeout");case 7:if(_.log("The local invitation has sent to the callee"),_n||_r){_s.next=11;break}throw a=new qm({PEER_NOT_ONLINE:"The peer of the invitation is not online"});case 11:if(_n){_s.next=14;break}throw a=new qm({RESENT_AND_OFFLINE:"Resent and the peer of the invitation is not online"});case 14:case"end":return _s.stop()}},$)}))).pipe(Re(function($){return $.pipe(sa(function(_e){if(!(_e instanceof qm))throw _e}),Zd(2e3))}),Lb(3e4),ab(function($){return Ab($)&&_.warn("local invitation ack timed out"),ra($)}),Kc(this.localInvitationEnd$)).subscribe({next:function(){_.state===Sa.RECEIVED_BY_REMOTE?_.log('The local invitation state is already "RECEIVED_BY_REMOTE", skipped emitting "LocalInvitationReceivedByPeer"'):_.state!==Sa.SENT_TO_REMOTE?_.log("The invitation has ended, skipped emitting the %s event","LocalInvitationReceivedByPeer"):(_.info("The peer received the local invitation %s.",_.callId),_.state=Sa.RECEIVED_BY_REMOTE,_.emit("LocalInvitationReceivedByPeer"),_.localInvitationEnd$.pipe(Lb(6e4),ab(function($){return Ab($)&&_.warn("local invitation expired"),ra($)})).subscribe({error:function(){_.state=Sa.FAILURE,_.emit("LocalInvitationFailure",Hf.INVITATION_EXPIRE)}}))},error:function($){_.isLocalInvitationEnd()?_.log("The invitation has ended, skipped emitting the %s event","LocalInvitationFailure"):(_.state=Sa.FAILURE,Ab($)&&a?a.code==="PEER_NOT_ONLINE"?_.emit("LocalInvitationFailure",Hf.PEER_OFFLINE):a.code==="RESENT_AND_OFFLINE"&&_.emit("LocalInvitationFailure",Hf.PEER_NO_RESPONSE):Ab($)?_.emit("LocalInvitationFailure",Hf.PEER_NO_RESPONSE):$.name==="RtmInvalidStatusError"?_.emit("LocalInvitationFailure",Hf.NOT_LOGGEDIN):_.emit("LocalInvitationFailure",Hf.UNKNOWN))}})}},{key:"cancel",value:function(){if(this.isLocalInvitationEnd())throw new da("The local invitation cancel failure",ri);if(this.state===Sa.IDLE)throw new da("The local invitation has not been sent",MB);if(8192<rh(this._content))throw new ca('The length of the "content" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',Xc);this.getSession().sendInvitationMessage({callId:this.callId,peerId:this.calleeId,type:"CallCancel",channelId:this._channelId,extra:this._content}),this.state=Sa.CANCELED,this.emit("LocalInvitationCanceled")}},{key:"onAcceptReceived",value:function(a){if(this.isLocalInvitationEnd()&&this.state!==Sa.ACCEPTED_BY_REMOTE)this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationAccepted");else{if(this.state===Sa.IDLE)throw new da("the local have not sent the invitation, how can remote accept it?");this.getSession().sendInvitationMessage({callId:this.callId,isAcceptAck:!0,type:"CallAccept",peerId:this.calleeId,channelId:this.channelId}),this.state===Sa.ACCEPTED_BY_REMOTE?this.log("already in ACCEPTED_BY_REMOTE state, ignore emit ACCEPTED_BY_REMOTE"):(this.state===Sa.SENT_TO_REMOTE&&(this.log("receive LocalInvitationAccepted before remote response to the invitation"),this.state=Sa.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this.state=Sa.ACCEPTED_BY_REMOTE,this._response=a,this.emit("LocalInvitationAccepted",a))}}},{key:"onRefuseReceived",value:function(a){if(this.isLocalInvitationEnd())this.log("The invitation has ended, skipped emitting the %s event","LocalInvitationRefused");else{if(this.state===Sa.IDLE)throw new da("the local have not sent the invitation, how can remote refuse it?");this.state===Sa.SENT_TO_REMOTE&&(this.log("receive LocalInvitationRefused before remote response to the invitation"),this.state=Sa.RECEIVED_BY_REMOTE,this.emit("LocalInvitationReceivedByPeer")),this._response=a,this.state=Sa.REFUSED_BY_REMOTE,this.emit("LocalInvitationRefused",a)}}},{key:"isLocalInvitationEnd",value:function(){return[Sa.CANCELED,Sa.FAILURE,Sa.ACCEPTED_BY_REMOTE,Sa.REFUSED_BY_REMOTE].includes(this.state)}}]),o}(sc()),Da(Sd.prototype,"send",[Mc],Object.getOwnPropertyDescriptor(Sd.prototype,"send"),Sd.prototype),Da(Sd.prototype,"cancel",[Mc],Object.getOwnPropertyDescriptor(Sd.prototype,"cancel"),Sd.prototype),Sd),Hi=ta.RemoteInvitationFailureReason,Fb=ta.RemoteInvitationState,rF=function(e){function o(a){var _=a.invitationChannel,$=a.extraContent,_e=a.callId,_n=a.callerId,_r=a.logger;a=a.getSession,va(this,o);var _s=s.call(this,_r,"RtmRemoteInvitation",!0);return x(z(_s),"state",Fb.INVITATION_RECEIVED),x(z(_s),"remoteInvitationEnd$",fb(Db(z(_s),"RemoteInvitationCanceled"),Db(z(_s),"RemoteInvitationRefused"),Db(z(_s),"RemoteInvitationAccepted"),Db(z(_s),"RemoteInvitationFailure")).pipe(hb(1))),x(z(_s),"callerId",void 0),x(z(_s),"callId",void 0),x(z(_s),"_getSession",void 0),x(z(_s),"logger",void 0),x(z(_s),"_content",void 0),x(z(_s),"_channelId",void 0),x(z(_s),"_response",""),_s._channelId=_,_s._content=$,_s.callId=_e,_s.callerId=_n,_s._getSession=a,_s.logger=_r,_s.remoteInvitationEnd$.pipe(Lb(6e4),ab(function(na){return Ab(na)&&_s.warn("Remote invitation expired"),ra(na)})).subscribe({error:function(){_s.state=Fb.FAILURE,_s.emit("RemoteInvitationFailure",Hi.INVITATION_EXPIRE)}}),_s}Ga(o,e);var s=Ha(o);return eb(o,[{key:"channelId",get:function(){return this._channelId},set:function(a){throw new ca('Cannot set the "response" of the RemoteInvitation instance.',Xc)}},{key:"content",get:function(){return this._content},set:function(a){throw new ca('Cannot set the "content" of the RemoteInvitation instance.',Xc)}},{key:"response",get:function(){return this._response},set:function(a){this._response=a}},{key:"accept",value:function(){var a,_=this;if(this.isRemoteInvitationEnd())throw new da("The local invitation has ended. Cannot accept.",ri);if(this.state===Fb.ACCEPT_SENT_TO_LOCAL)throw new da("The remote invitation is accepting. Cannot do the operation.",Rr);if(8192<rh(this._response))throw new ca('The length of the "response" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',Xc);this.state=Fb.ACCEPT_SENT_TO_LOCAL,Jb(Qe(1e3).pipe(Cb(function(){return yd(ma(N.mark(function $(){return N.wrap(function(_e){for(;;)switch(_e.prev=_e.next){case 0:return _e.abrupt("return",_._getSession().sendInvitationMessage({peerId:_.callerId,callId:_.callId,extra:_.response,type:"CallAccept",isAcceptAck:!1,channelId:_.channelId}));case 1:case"end":return _e.stop()}},$)})))}),yb(function($){return a=$.hasPeerReceived}),hb(1)),Db(this,"RemoteInvitationAccepted")).pipe(Lb(5e3),Kc(this.remoteInvitationEnd$)).subscribe({error:function($){if(_.logError($),_.state=Fb.FAILURE,Ab($))switch(a){case void 0:case!0:return void _.emit("RemoteInvitationFailure",Hi.ACCEPT_FAILURE);case!1:return void _.emit("RemoteInvitationFailure",Hi.PEER_OFFLINE)}_.emit("RemoteInvitationFailure",Hi.UNKNOWN)}})}},{key:"refuse",value:function(){if(this.state===Fb.ACCEPT_SENT_TO_LOCAL)throw new da("The remote invitation is accepting. Cannot do the operation.",Rr);if(this.isRemoteInvitationEnd())throw new da("The invitation is end. Cannot refuse",ri);if(8192<rh(this._response))throw new ca('The length of the "response" overflows. The number of bytes representing content must not exceed 8  1024 if encoded in UTF-8.',Xc);this._getSession().sendInvitationMessage({peerId:this.callerId,callId:this.callId,extra:this.response,type:"CallReject",channelId:this.channelId}),this.state=Fb.REFUSED,this.emit("RemoteInvitationRefused")}},{key:"onCancelReceived",value:function(a){this.isRemoteInvitationEnd()?this.log("The invitation has ended, skipped emitting the %s event","RemoteInvitationCanceled"):(this.state===Fb.ACCEPT_SENT_TO_LOCAL&&this.log("caller canceled before receive accept"),this._content=a,this.state=Fb.CANCELED,this.emit("RemoteInvitationCanceled",a))}},{key:"onAcceptAckReceived",value:function(){this.state!==Fb.ACCEPT_SENT_TO_LOCAL?this.log("The invitation has ended, skipped emitting the %s event","ori:".concat(this.state,", to: RemoteInvitationAccepted")):(this.state=Fb.ACCEPTED,this.emit("RemoteInvitationAccepted"))}},{key:"isRemoteInvitationEnd",value:function(){return[Fb.ACCEPTED,Fb.REFUSED,Fb.CANCELED,Fb.FAILURE].includes(this.state)}}]),o}(sc()),sF=function(e){function o(a,_){va(this,o);var $=s.call(this,_,"InvitationManager");return x(z($),"getSession",void 0),x(z($),"invitationDispatcher",new Ba.EventEmitter),x(z($),"outgoingLocalInvitations",new Map),x(z($),"receivedRemoteInvitations",new Wc(void 0,{maxlen:1e4})),x(z($),"logger",void 0),$.getSession=fo(a),$.logger=_,$.invitationDispatcher.on("remoteInvitationToManager",function(_e){var _n=_e.callId,_r=_e.extra,_s=_e.callerId;_e=_e.channelId,$.receivedRemoteInvitations.has(_n)||((_r=new rF({callerId:_s,callId:_n,getSession:$.getSession,logger:_,extraContent:_r,invitationChannel:_e})).remoteInvitationEnd$.subscribe(function(){$.receivedRemoteInvitations.delete(_n)}),$.receivedRemoteInvitations.set(_n,_r),$.emit("remoteInvitationInstance",_r))}),$.invitationDispatcher.on("acceptAckToRemoteInvitation",function(_e){(_e=$.receivedRemoteInvitations.get(_e.callId))&&_e.onAcceptAckReceived()}),$.invitationDispatcher.on("cancelToRemoteInvitation",function(_e){var _n=_e.extra;(_e=$.receivedRemoteInvitations.get(_e.callId))&&_e.onCancelReceived(_n)}),$.invitationDispatcher.on("acceptToLocalInvitation",function(_e){var _n=_e.extra;(_e=$.outgoingLocalInvitations.get(_e.callId))&&_e.onAcceptReceived(_n)}),$.invitationDispatcher.on("refuseToLocalInvitation",function(_e){var _n=_e.extra;(_e=$.outgoingLocalInvitations.get(_e.callId))&&_e.onRefuseReceived(_n)}),$}Ga(o,e);var s=Ha(o);return eb(o,[{key:"invitationMessageHandler",value:function(a){var _=a.body,$=_.callId,_e=_.extra;_e=_e===void 0?"":_e;var _n=_.type,_r=(_=_.channel)===void 0?"":_,_s=a.type;switch(_=a.peerId,a=a.serverReceivedTs,_s){case"CallAccept":_n==="ack"?this.invitationDispatcher.emit("acceptAckToRemoteInvitation",{callId:$}):_n==="request"&&this.invitationDispatcher.emit("acceptToLocalInvitation",{callId:$,extra:_e});break;case"CallInvite":this.invitationDispatcher.emit("remoteInvitationToManager",{callId:$,callerId:_,extra:_e,channelId:_r});break;case"CallCancel":if($==="0"){$="".concat("AgoraRTMLegacyEndcallCompatibleMessagePrefix","_").concat(_r,"_").concat(_e),this.getSession().emit("peerTextMessage",{peerId:_,properties:{serverReceivedTs:a},text:$});break}this.invitationDispatcher.emit("cancelToRemoteInvitation",{callId:$,extra:_e});break;case"CallReject":this.invitationDispatcher.emit("refuseToLocalInvitation",{callId:$,extra:_e});break;default:throw Rn("invitationType",_s)}}},{key:"genLocalInvitation",value:function(a){var _=this,$=new qF(a,this.getSession,this.logger);return $.localInvitationEnd$.subscribe(function(){_.outgoingLocalInvitations.delete($.callId)}),this.outgoingLocalInvitations.set($.callId,$),$}}]),o}(sc()),tF=function(e,o,s){var a=!0,_=!0;if(typeof e!="function")throw new TypeError("Expected a function");return Gb(s)&&(a="leading"in s?!!s.leading:a,_="trailing"in s?!!s.trailing:_),JD(e,o,{leading:a,maxWait:o,trailing:_})},Qb,If;(function(e){e[e.JOINED=0]="JOINED",e[e.LEFT=1]="LEFT"})(If||(If={}));var Ii=ta.ConnectionState,uF=(Qb=function(e){function o(_,$,_e,_n){va(this,o);var _r=a.call(this,_n,"RtmChannel",!0);return x(z(_r),"onMemberCountUpdated",tF(function(_s){_s!==_r.memberCount&&(_r.memberCount=_s,_r.emit("MemberCountUpdated",_s))},1e3)),x(z(_r),"getSession",void 0),x(z(_r),"memberCount",0),x(z(_r),"joinState","LEFT"),x(z(_r),"joinPromise",void 0),x(z(_r),"memberJoinedLru",new Wc(void 0,{maxlen:1e4})),x(z(_r),"memberLeftLru",new Wc(void 0,{maxlen:1e4})),x(z(_r),"memberJoinStateLru",new Wc(void 0,{maxlen:1e4})),x(z(_r),"attributesSeqLru",new Wc(void 0,{maxlen:1e4})),x(z(_r),"channelId",void 0),x(z(_r),"client",void 0),x(z(_r),"onChannelMemberCountUpdated",function(_s,na){_r.channelId===_s&&_r.onMemberCountUpdated(na)}),x(z(_r),"onLogout",function(){try{_r.clearChannel(_r.getSession())}catch{}}),x(z(_r),"onAttributesUpdated",function(_s){var na=_s.channelId,ba=_s.attributeMaps,_p=_s.seq;_s=_s.instance.toString();var _f=_r.attributesSeqLru.get(_s);if((!_f||_p.greaterThan(_f))&&(_r.attributesSeqLru.set(_s,_p),na===_r.channelId)){for(na={},_p=0;_p<ba.length;_p++){var _E=ba[_p];_s=_E.key,_f=_E.ms;var _v=_E.value;if(_E=_E.origin,typeof _s!="string"||!P.isLong(_f)||typeof _v!="string"||!Ta(_E))break;na[_s]={value:_v,lastUpdateUserId:_E,lastUpdateTs:_f.toNumber()}}_r.emit("AttributesUpdated",na)}}),x(z(_r),"onChannelTextMessage",function(_s){var na=_s.memberId,ba=_s.text,_p=_s.properties;_s.channelId===_r.channelId&&_r.emit("ChannelMessage",{text:ba,messageType:ta.MessageType.TEXT},na,_p)}),x(z(_r),"onChannelRawMessage",function(_s){var na=_s.desc,ba=_s.raw,_p=_s.memberId,_f=_s.properties;_s.channelId===_r.channelId&&_r.emit("ChannelMessage",{messageType:ta.MessageType.RAW,rawMessage:ba,description:na},_p,_f)}),x(z(_r),"onMemberNotice",function(_s){var na=_s.memberId,ba=_s.type,_p=_s.size;if(_s.channelId===_r.channelId){var _f=_s.instance.toString();_s=_s.seq.toString();var _E={MemberLeft:_r.memberLeftLru,MemberJoined:_r.memberJoinedLru,MemberCountUpdated:void 0}[ba];if(_E){if(_E.has(_f+_s))return void _r.log("received duplicated %s notice (seq: %s), channel '%s', member '%s'",ba,_s,La(_r.channelId),La(na||""));if(_E.set(_f+_s,void 0),typeof na!="string")return;if(na!==_r.getSession().context.uid&&((_f=_r.memberJoinStateLru.get(na))===If.JOINED&&ba==="MemberJoined"||_f===If.LEFT&&ba==="MemberLeft"))return void _r.log("received duplicated %s state (seq: %s), channel '%s', member '%s'",ba,_s,La(_r.channelId),La(na||""));_r.memberJoinStateLru.set(na,ba==="MemberJoined"?If.JOINED:If.LEFT)}_r.info("Channel %s - %s, memberId: %s",ba,La(_r.channelId),ba==="MemberCountUpdated"?"[unknown]":La(na||"")),_f=na===_r.getSession().context.uid,ba==="MemberLeft"&&Ta(na)||ba==="MemberJoined"&&Ta(na)?(_f||_r.emit(ba,na),_r.onMemberCountUpdated(_p)):ba==="MemberCountUpdated"&&typeof _p=="number"&&_r.onMemberCountUpdated(_p)}}),_r.getSession=fo($),_r.channelId=_,_r.client=_e,_r.info("A channel created, id %s",La(_)),_r}Ga(o,e);var s,a=Ha(o);return eb(o,[{key:"join",value:(s=ma(N.mark(function _(){var $,_e,_n,_r,_s,na,ba,_p=this;return N.wrap(function(_f){for(;;)switch(_f.prev=_f.next){case 0:_f.prev=0,$=this.getSession(),_f.next=7;break;case 4:throw _f.prev=4,_f.t0=_f.catch(0),new da("The client is not logged in. Cannot do the operation",Wr);case 7:if(_f.prev=7,Ta(this.channelId)){_f.next=10;break}throw new ca(["The %s in the arguments is invalid","channelId"],OB);case 10:if(this.joinState==="LEFT"){_f.next=13;break}throw bb("ChnJoin",{cname:this.channelId,lts:P.fromNumber(Date.now()),userId:$.context.uid,elapse:Xa($.startTime),errCode:Vr,sid:sb($.instanceId)},(_r=this.client.context.config.enableCloudProxy)!==null&&_r!==void 0&&_r),new da("The channel has joined. Cannot rejoin",Vr);case 13:if(!$.usedChannelIds.includes(this.channelId)){_f.next=16;break}throw bb("ChnJoin",{cname:this.channelId,lts:P.fromNumber(Date.now()),userId:$.context.uid,elapse:Xa($.startTime),errCode:Xr,sid:sb($.instanceId)},(_s=this.client.context.config.enableCloudProxy)!==null&&_s!==void 0&&_s),new da("A channel of the same channel ID has already joined. Cannot rejoin",Xr);case 16:if(!(20<=$.usedChannelIds.length)){_f.next=19;break}throw bb("ChnJoin",{cname:this.channelId,lts:P.fromNumber(Date.now()),userId:$.context.uid,elapse:Xa($.startTime),errCode:Ur,sid:sb($.instanceId)},(na=this.client.context.config.enableCloudProxy)!==null&&na!==void 0&&na),new ic("The joined channels has exceeded the limit of 20",Ur);case 19:return bb("ChnJoin",{cname:this.channelId,lts:P.fromNumber(Date.now()),userId:$.context.uid,elapse:Xa($.startTime),errCode:0,sid:sb($.instanceId)},(_e=this.client.context.config.enableCloudProxy)!==null&&_e!==void 0&&_e),this.log("Joining the channel %s",La(this.channelId)),this.joinState="JOINING",$.usedChannelIds.push(this.channelId),this.joinPromise=$.requestChannelJoin(this.channelId).then(function(){_p.joinState="JOINED"}),_f.next=26,this.joinPromise;case 26:bb("ChnJoinRes",{cname:this.channelId,lts:P.fromNumber(Date.now()),elapse:Xa($.startTime),errCode:0,sid:sb($.instanceId),serverErrCode:0,userId:$.context.uid},(_n=this.client.context.config.enableCloudProxy)!==null&&_n!==void 0&&_n),this.info("The channel %s joined successfully",La(this.channelId)),$.on("channelTextMessage",this.onChannelTextMessage),$.on("channelRawMessage",this.onChannelRawMessage),$.on("memberNotice",this.onMemberNotice),$.on("channelAttributesUpdated",this.onAttributesUpdated),this.client.internalEmitter.on("channelMemberCountUpdated",this.onChannelMemberCountUpdated),this.client.internalEmitter.once("LOGOUT",this.onLogout),_f.next=46;break;case 36:if(_f.prev=36,_f.t1=_f.catch(7),this.joinState==="JOINING"&&(this.joinState="LEFT"),this.logError(_f.t1),!Na(_f.t1)){_f.next=42;break}throw _f.t1;case 42:if(!Ab(_f.t1)){_f.next=45;break}throw bb("ChnJoinRes",{cname:this.channelId,lts:P.fromNumber(Date.now()),elapse:Xa($.startTime),errCode:Tr,sid:sb($.instanceId),serverErrCode:0,userId:$.context.uid},(ba=this.client.context.config.enableCloudProxy)!==null&&ba!==void 0&&ba),new Ub(["Join channel %s timed out",La(this.channelId)],Tr);case 45:throw new ve(["The channel %s join failure",La(this.channelId)],{code:Sr,originalError:_f.t1});case 46:case"end":return _f.stop()}},_,this,[[0,4],[7,36]])})),function(){return s.apply(this,arguments)})},{key:"leave",value:function(){var _=ma(N.mark(function $(){var _e,_n,_r,_s;return N.wrap(function(na){for(;;)switch(na.prev=na.next){case 0:na.prev=0,_n=this.getSession(),na.next=7;break;case 4:throw na.prev=4,na.t0=na.catch(0),new da("The client is not logged in. Cannot do the operation",QB);case 7:if(this.joinState!=="LEFT"){na.next=9;break}throw new da("The channel does not join. Cannot do the operation",PB);case 9:return na.prev=9,_n.requestChannelLeave(this.channelId),na.next=13,this.clearChannel(_n);case 13:na.next=24;break;case 15:if(na.prev=15,na.t1=na.catch(9),this.logError(na.t1),!Na(na.t1)){na.next=22;break}throw na.t1.code===void 0&&(na.t1.code=Zr),bb("ChnLeave",{cname:this.channelId,lts:P.fromNumber(Date.now()),elapse:Xa(_n.startTime),errCode:Zr,sid:sb(_n.instanceId),userId:_n.context.uid},(_s=this.client.context.config.enableCloudProxy)!==null&&_s!==void 0&&_s),na.t1;case 22:throw bb("ChnLeave",{cname:this.channelId,lts:P.fromNumber(Date.now()),elapse:Xa(_n.startTime),errCode:Yr,sid:sb(_n.instanceId),userId:_n.context.uid},(_r=this.client.context.config.enableCloudProxy)!==null&&_r!==void 0&&_r),new ve("The channel leave failure",{code:Yr,originalError:na.t1});case 24:bb("ChnLeave",{cname:this.channelId,lts:P.fromNumber(Date.now()),elapse:Xa(_n.startTime),errCode:0,sid:sb(_n.instanceId),userId:_n.context.uid},(_e=this.client.context.config.enableCloudProxy)!==null&&_e!==void 0&&_e);case 25:case"end":return na.stop()}},$,this,[[0,4],[9,15]])}));return function(){return _.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var _=ma(N.mark(function $(_e){var _n,_r=this;return N.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(Xn(_e,Il),this.client.connectionState!==Ii.CONNECTED||this.joinState==="JOINED"){_s.next=3;break}throw new da("The channel does not join. Cannot do the operation",EB);case 3:if(this.client.connectionState!==Ii.RECONNECTING){_s.next=8;break}return _n=Date.now(),_s.next=7,new Promise(function(na,ba){var _p,_f=(_p=ma(N.mark(function _v(){var n_;return N.wrap(function(e_){for(;;)switch(e_.prev=e_.next){case 0:return n_=Date.now()-_n,e_.prev=1,e_.next=4,ph({message:_e,peerId:_r.channelId,toPeer:!1,session:_r.getSession(),errorCodes:{NOT_LOGGED_IN:Jl,TOO_OFTEN:Nr},diff:n_,logger:_r.logger});case 4:na(),e_.next=12;break;case 7:e_.prev=7,e_.t0=e_.catch(1),Ab(e_.t0)&&ba(new Ub(we(_r.name,"sendMessageToPeer",1e4),Hl)),Na(e_.t0)&&ba(e_.t0),ba(new Ja("Channel message send failure",{code:qi,originalError:e_.t0}));case 12:return e_.prev=12,clearTimeout(_E),e_.finish(12);case 15:case"end":return e_.stop()}},_v,null,[[1,7,12,15]])})),function(){return _p.apply(this,arguments)});_r.client.internalEmitter.once("RECONNECTED",_f);var _E=setTimeout(function(){_r.client.internalEmitter.off("RECONNECTED",_f),ba(new Ub(we(_r.name,"sendMessageToPeer",1e4),Hl))},9e3)});case 7:return _s.abrupt("return");case 8:if(this.client.connectionState===Ii.CONNECTED){_s.next=10;break}throw new da("The client is not logged in. Cannot do the operation",Jl);case 10:return _s.prev=10,_s.next=13,ph({message:_e,peerId:this.channelId,toPeer:!1,session:this.getSession(),errorCodes:{NOT_LOGGED_IN:Jl,TOO_OFTEN:Nr},diff:0,logger:this.logger});case 13:_s.next=23;break;case 15:if(_s.prev=15,_s.t0=_s.catch(10),!Ab(_s.t0)){_s.next=19;break}throw new Ub(we(this.name,"sendMessage",1e4),Hl);case 19:if(!Na(_s.t0)){_s.next=22;break}throw this.logError(_s.t0),_s.t0;case 22:throw new ve("The channel message send failure",qi);case 23:case"end":return _s.stop()}},$,this,[[10,15]])}));return function($){return _.apply(this,arguments)}}()},{key:"getMembers",value:function(){var _=ma(N.mark(function $(){var _e,_n;return N.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:if(_r.prev=0,this.client.connectionState===Ii.CONNECTED){_r.next=3;break}throw new da("The client is not logged in. Cannot do the operation",LB);case 3:if(this.joinState==="JOINED"){_r.next=5;break}throw new da("The channel does not join. Cannot do the operation",KB);case 5:return _e=this.getSession().requestChannelMemberList(this.channelId),_r.next=8,_e.pipe(Ea(function(_s){return _s.memberInfos.map(function(na){return na.account})})).toPromise();case 8:return _n=_r.sent,this.info("Channel %s - get members success, %o",La(this.channelId),_n.map(La)),_r.abrupt("return",_n);case 13:if(_r.prev=13,_r.t0=_r.catch(0),!Na(_r.t0)){_r.next=18;break}throw this.logError(_r.t0),_r.t0;case 18:throw new ve("The channel members get failure",IB);case 19:case"end":return _r.stop()}},$,this,[[0,13]])}));return function(){return _.apply(this,arguments)}}()},{key:"clearChannel",value:function(){var _=ma(N.mark(function $(_e){var _n=this;return N.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:if(_e.emit("channelLeft",this.channelId),this.joinState!=="JOINING"){_r.next=4;break}return _r.next=4,this.joinPromise;case 4:this.joinState="LEFT",this.memberLeftLru.empty(),this.memberJoinedLru.empty(),this.attributesSeqLru.empty(),this.memberJoinStateLru.empty(),this.memberCount=0,_e.removeListener("channelTextMessage",this.onChannelTextMessage),_e.removeListener("channelRawMessage",this.onChannelRawMessage),_e.removeListener("memberNotice",this.onMemberNotice),_e.removeListener("channelAttributesUpdated",this.onAttributesUpdated),this.client.internalEmitter.removeListener("channelMemberCountUpdated",this.onChannelMemberCountUpdated),this.client.internalEmitter.removeListener("LOGOUT",this.onLogout),_e.usedChannelIds=_e.usedChannelIds.filter(function(_s){return _s!==_n.channelId});case 17:case"end":return _r.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()}]),o}(sc()),Da(Qb.prototype,"join",[Mc],Object.getOwnPropertyDescriptor(Qb.prototype,"join"),Qb.prototype),Da(Qb.prototype,"leave",[Mc],Object.getOwnPropertyDescriptor(Qb.prototype,"leave"),Qb.prototype),Da(Qb.prototype,"sendMessage",[Mc],Object.getOwnPropertyDescriptor(Qb.prototype,"sendMessage"),Qb.prototype),Da(Qb.prototype,"getMembers",[jb],Object.getOwnPropertyDescriptor(Qb.prototype,"getMembers"),Qb.prototype),Qb),W,Rb=ta.ConnectionChangeReason,oa=ta.ConnectionState,Vt={DISCONNECTED:1,CONNECTING:2,CONNECTED:3,RECONNECTING:4,ABORTED:5},vF={LOGIN:1,LOGIN_SUCCESS:2,LOGIN_FAILURE:3,LOGIN_TIMEOUT:4,INTERRUPTED:5,LOGOUT:6,BANNED_BY_SERVER:7,REMOTE_LOGIN:8,TOKEN_EXPIRED:9},wF=(W=function(e){function o(_,$,_e,_n){va(this,o);var _r=a.call(this,$,"RtmClient",!0);return x(z(_r),"connectionState",oa.DISCONNECTED),x(z(_r),"internalEmitter",new Ba),x(z(_r),"context",void 0),x(z(_r),"attributes",{}),x(z(_r),"loginPromise",void 0),x(z(_r),"attributeDrafts",new Set),x(z(_r),"session",void 0),x(z(_r),"lastLoginTime",void 0),x(z(_r),"reconnId",0),x(z(_r),"channelAttributesCacheLru",new Wc(void 0,{maxlen:1e4})),x(z(_r),"invitationManager",void 0),x(z(_r),"subscribedPeerStatusCache",{}),x(z(_r),"pendingPeerStatusSubCount",0),x(z(_r),"peerStatusSeqLru",new Wc(void 0,{maxlen:1e4})),x(z(_r),"peerUnreachableTimers",{}),x(z(_r),"setParameters",void 0),x(z(_r),"updateConfig",void 0),x(z(_r),"blacklistedIP",{}),x(z(_r),"TokenPrivilegeWillExpireHandler",function(){_r.emit("TokenPrivilegeWillExpire")}),x(z(_r),"userDropHandler",function(_s){if(_r.connectionState!==oa.ABORTED)switch(_s){case 2:_r.logError("Server banned because of token is expired"),_r.onConnectionStateChanged(oa.ABORTED,Rb.TOKEN_EXPIRED),_r.emit("TokenExpired");break;case 11:_r.logError("Kicked off by remote session"),_r.onConnectionStateChanged(oa.ABORTED,Rb.REMOTE_LOGIN);break;case 14:case 15:case 16:_r.logError("Server banned because of illegal ".concat({14:"User ID",15:"IP",16:"Channel Name"}[_s])),_r.onConnectionStateChanged(oa.ABORTED,Rb.BANNED_BY_SERVER);break;default:_r.logError("User kicked off for unknown code: ".concat(_s)),_r.onConnectionStateChanged(oa.ABORTED,Rb.INTERRUPTED)}}),_r.context=new xE(_,_e,$),_r.context.config=_e,_r.setParameters=_n.bind(z(_r)),_r.updateConfig=_n.bind(z(_r)),_r.invitationManager=new sF(function(){return _r.session},$),_r.invitationManager.on("remoteInvitationInstance",function(_s){_r.emit("RemoteInvitationReceived",_s)}),_r.setMaxListeners(512),_r.internalEmitter.setMaxListeners(512),_r}Ga(o,e);var s,a=Ha(o);return eb(o,[{key:"renewToken",value:(s=ma(N.mark(function _($){var _e,_n,_r,_s,na=this;return N.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:if(typeof $=="string"&&$.length!==0){ba.next=2;break}throw new ca("Invalid argument",XB);case 2:if(this.connectionState!==oa.ABORTED){ba.next=5;break}return ba.next=5,new Promise(function(){});case 5:if(this.connectionState===oa.CONNECTED||this.connectionState===oa.RECONNECTING){ba.next=7;break}throw new da("The client is not logged in",hs);case 7:if(this.session!==void 0){ba.next=9;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return ba.prev=9,_e=this.context.token,this.context.token=$,ba.next=14,this.session.connection.apClient.getApEdgeInfo$(!1).pipe($d(function(){return Error("No available edge address to connect")}),Re(function(_p){return _p.pipe(sa(function(_f){if(Na(_f))throw _f}),Zd(2500),hb(4))}),hb(1),Lb(2e4),ab(function(_p){return Ab(_p)&&na.warn("renewToken timed out"),ra(_p)})).toPromise();case 14:_n=ba.sent,_r=_n.ticket,ba.next=27;break;case 18:if(ba.prev=18,ba.t0=ba.catch(9),this.context.token=_e,ba.t0.code!==as&&ba.t0.code!==bs){ba.next=23;break}throw new Bf("Invalid token",ZB);case 23:if(ba.t0.code!==ti){ba.next=25;break}throw new Bf("The token expired",YB);case 25:if(!Ab(ba.t0)){ba.next=27;break}throw new Ub("Renew token timed out",Ml);case 27:_s=this.session,this.session.requestUpdateEdgeTicket(_r).toPromise().then(function(_p){if(_p.code!==0)throw new Ja(["RenewToken failure. The response code is %d",_p.code],Ml);_s.curLoginSockets.filter(function(_f){return _f!==void 0}).forEach(function(_f){return _f.ticket=_r})});case 29:case"end":return ba.stop()}},_,this,[[9,18]])})),function(_){return s.apply(this,arguments)})},{key:"queryPeersOnlineStatus",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s=this;return N.wrap(function(na){for(;;)switch(na.prev=na.next){case 0:if(this.connectionState===oa.CONNECTED){na.next=2;break}throw new da("The client is not logged in",WB);case 2:if(this.session!==void 0){na.next=4;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(!(!Array.isArray(_e)||_e.length===0||_e.some(function(ba){return!Ta(ba)})||256<_e.length)){na.next=6;break}throw new ca("invalid arguments",gs);case 6:return na.next=8,this.session.requestPeersOnlineStatus(_e).toPromise();case 8:return _n=na.sent,_r=md(tl(_n.userInfos,"account"),function(ba){return!!ba.ts}),Object.keys(_r).forEach(function(ba){if(ba in _s.subscribedPeerStatusCache&&_s.subscribedPeerStatusCache[ba]!==ta.PeerOnlineState.UNREACHABLE){var _p=_r[ba]?ta.PeerOnlineState.ONLINE:ta.PeerOnlineState.OFFLINE;_s.emit("PeersOnlineStatusChanged",x({},ba,_p)),_s.subscribedPeerStatusCache[ba]=_p}}),na.abrupt("return",_r);case 12:case"end":return na.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"getChannelMemberCount",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s,na,ba,_p,_f,_E,_v;return N.wrap(function(n_){for(;;)switch(n_.prev=n_.next){case 0:if(this.connectionState===oa.CONNECTED){n_.next=2;break}throw new da("The client is not logged in",HB);case 2:if(this.session!==void 0){n_.next=4;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_e)&&_e.every(function(e_){return typeof e_=="string"})&&_e.length!==0){n_.next=6;break}throw new ca("Invalid arguments: channelIds",Pr);case 6:if(!(32<_e.length)){n_.next=8;break}throw new ca("getChannelMemberCount exceed limit of 32 channelIds",GB);case 8:_n=0;case 9:if(!(_n<_e.length)){n_.next=16;break}if(Ta(_r=_e[_n])){n_.next=13;break}throw new ca(["getChannelMemberCount channel id %s is invalid",_r],Pr);case 13:_n++,n_.next=9;break;case 16:return n_.next=18,this.session.requestGetChannelMemberCount(_e).toPromise();case 18:for(_s=n_.sent,na=_s.groupInfos,ba={},_p=0;_p<na.length;_p++)_f=na[_p],_E=_f.group,_v=_f.memberCount,Ta(_E)&&typeof _v=="number"&&(this.internalEmitter.emit("channelMemberCountUpdated",_E,_v),ba[_E]=_v);return n_.abrupt("return",ba);case 23:case"end":return n_.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"setLocalUserAttributes",value:function(){var _=ma(N.mark(function $(_e){var _n,_r;return N.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(ag({attributes:_e,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===oa.CONNECTED){_s.next=3;break}throw new da("The client is not logged in",qc);case 3:if(this.session!==void 0){_s.next=5;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return _n=this.session.requestSetLocalUserAttributes(_e).toPromise(),_r={attribute:_e,promise:_n},this.attributeDrafts.add(_r),_s.prev=8,_s.next=11,_n;case 11:this.attributes=_e,_s.next=19;break;case 14:if(_s.prev=14,_s.t0=_s.catch(8),!Na(_s.t0)){_s.next=18;break}throw _s.t0;case 18:throw new ca("arguments is not valid",gb);case 19:return _s.prev=19,this.attributeDrafts.delete(_r),_s.finish(19);case 22:case"end":return _s.stop()}},$,this,[[8,14,19,22]])}));return function($){return _.apply(this,arguments)}}()},{key:"setChannelAttributes",value:function(){var _=ma(N.mark(function $(_e,_n){var _r,_s,na,ba,_p,_f=arguments;return N.wrap(function(_E){for(;;)switch(_E.prev=_E.next){case 0:if(_r=2<_f.length&&_f[2]!==void 0?_f[2]:{},_s=_r.enableNotificationToChannelMembers,na=_s!==void 0&&_s,ag({attributes:_n,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===oa.CONNECTED){_E.next=4;break}throw new da("The client is not logged in",qc);case 4:if(this.session!==void 0){_E.next=6;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return ba=this.session.requestSetChannelAttributes(_e,_n,na).toPromise(),_E.prev=7,_E.next=10,ba;case 10:_p=md(_n,function(_v){return new Blob([_v]).size}),this.channelAttributesCacheLru.set(_e,_p),_E.next=19;break;case 14:if(_E.prev=14,_E.t0=_E.catch(7),!Na(_E.t0)){_E.next=18;break}throw _E.t0;case 18:throw new ca("arguments is not valid",gb);case 19:case"end":return _E.stop()}},$,this,[[7,14]])}));return function($,_e){return _.apply(this,arguments)}}()},{key:"addOrUpdateLocalUserAttributes",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s;return N.wrap(function(na){for(;;)switch(na.prev=na.next){case 0:if(_n=Wa(Wa({},this.attributes),_e),ag({attributes:_e,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),ag({attributes:_n,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:16384}),this.connectionState===oa.CONNECTED){na.next=5;break}throw new da("The client is not logged in",qc);case 5:if(this.session!==void 0){na.next=7;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return _r=this.session.requestAddOrUpdateLocalUserAttributes(_e).toPromise(),_s={attribute:_n,promise:_r},this.attributeDrafts.add(_s),na.prev=10,na.next=13,_r;case 13:this.attributes=_n,na.next=21;break;case 16:if(na.prev=16,na.t0=na.catch(10),!Na(na.t0)){na.next=20;break}throw na.t0;case 20:throw new ca("arguments is not valid",gs);case 21:return na.prev=21,this.attributeDrafts.delete(_s),na.finish(21);case 24:case"end":return na.stop()}},$,this,[[10,16,21,24]])}));return function($){return _.apply(this,arguments)}}()},{key:"addOrUpdateChannelAttributes",value:function(){var _=ma(N.mark(function $(_e,_n){var _r,_s,na,ba,_p,_f,_E,_v=arguments;return N.wrap(function(n_){for(;;)switch(n_.prev=n_.next){case 0:if(_r=2<_v.length&&_v[2]!==void 0?_v[2]:{},_s=_r.enableNotificationToChannelMembers,na=_s!==void 0&&_s,ba=this.channelAttributesCacheLru.get(_e,{}),_p=md(_n,function(e_){return new Blob([e_]).size}),_f=Wa(Wa({},ba),_p),ag({attributes:_n,attrSizeMap:_f,maxAttrValueSize:8192,maxAttrsCount:32,maxTotalSize:32768}),this.connectionState===oa.CONNECTED){n_.next=7;break}throw new da("The client is not logged in",qc);case 7:if(this.session!==void 0){n_.next=9;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return _E=this.session.requestAddOrUpdateChannelAttributes(_e,_n,na).toPromise(),n_.prev=10,n_.next=13,_E;case 13:this.channelAttributesCacheLru.set(_e,_f),n_.next=21;break;case 16:if(n_.prev=16,n_.t0=n_.catch(10),!Na(n_.t0)){n_.next=20;break}throw n_.t0;case 20:throw new ca("arguments is not valid",gb);case 21:case"end":return n_.stop()}},$,this,[[10,16]])}));return function($,_e){return _.apply(this,arguments)}}()},{key:"deleteLocalUserAttributesByKeys",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s,na;return N.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:if(Array.isArray(_e)&&_e.length!==0&&!_e.some(function(_p){return _p.length===0})){ba.next=2;break}throw new da("arguments is not valid",gb);case 2:if(this.connectionState===oa.CONNECTED){ba.next=4;break}throw new da("The client is not logged in",qc);case 4:if(this.session!==void 0){ba.next=6;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return _n=this.session.requestDeleteLocalUserAttributesByKeys(_e).toPromise(),_r={attribute:ql(this.attributes,_e),promise:_n},this.attributeDrafts.add(_r),ba.prev=9,ba.next=12,_n;case 12:for(_s=0;_s<_e.length;_s++)na=_e[_s],delete this.attributes[na];ba.next=20;break;case 15:if(ba.prev=15,ba.t0=ba.catch(9),!Na(ba.t0)){ba.next=19;break}throw ba.t0;case 19:throw new ca("arguments is not valid",gb);case 20:return ba.prev=20,this.attributeDrafts.delete(_r),ba.finish(20);case 23:case"end":return ba.stop()}},$,this,[[9,15,20,23]])}));return function($){return _.apply(this,arguments)}}()},{key:"deleteChannelAttributesByKeys",value:function(){var _=ma(N.mark(function $(_e,_n){var _r,_s,na,ba,_p,_f,_E,_v=arguments;return N.wrap(function(n_){for(;;)switch(n_.prev=n_.next){case 0:if(_r=2<_v.length&&_v[2]!==void 0?_v[2]:{},_s=_r.enableNotificationToChannelMembers,na=_s!==void 0&&_s,Array.isArray(_n)&&_n.length!==0&&Ta(_e)&&!_n.some(function(e_){return e_.length===0||512<e_.length})){n_.next=3;break}throw new da("arguments is not valid",gb);case 3:if(this.connectionState===oa.CONNECTED){n_.next=5;break}throw new da("The client is not logged in",qc);case 5:if(this.session!==void 0){n_.next=7;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 7:return ba=this.session.requestDeleteChannelAttributesByKeys(_e,_n,na).toPromise(),n_.prev=8,n_.next=11,ba;case 11:if(_p=this.channelAttributesCacheLru.get(_e))for(_f=0;_f<_n.length;_f++)_E=_n[_f],delete _p[_E];n_.next=20;break;case 15:if(n_.prev=15,n_.t0=n_.catch(8),!Na(n_.t0)){n_.next=19;break}throw n_.t0;case 19:throw new ca("arguments is not valid",gb);case 20:case"end":return n_.stop()}},$,this,[[8,15]])}));return function($,_e){return _.apply(this,arguments)}}()},{key:"clearLocalUserAttributes",value:function(){var _=ma(N.mark(function $(){var _e,_n;return N.wrap(function(_r){for(;;)switch(_r.prev=_r.next){case 0:if(this.connectionState===oa.CONNECTED){_r.next=2;break}throw new da("The client is not logged in",qc);case 2:if(this.session!==void 0){_r.next=4;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return _e=this.session.requestClearLocalUserAttributes().toPromise(),_n={attribute:{},promise:_e},this.attributeDrafts.add(_n),_r.prev=7,_r.next=10,_e;case 10:this.attributes={},_r.next=18;break;case 13:if(_r.prev=13,_r.t0=_r.catch(7),!Na(_r.t0)){_r.next=17;break}throw _r.t0;case 17:throw new ca("arguments is not valid",gb);case 18:return _r.prev=18,this.attributeDrafts.delete(_n),_r.finish(18);case 21:case"end":return _r.stop()}},$,this,[[7,13,18,21]])}));return function(){return _.apply(this,arguments)}}()},{key:"clearChannelAttributes",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s,na,ba=arguments;return N.wrap(function(_p){for(;;)switch(_p.prev=_p.next){case 0:if(_n=1<ba.length&&ba[1]!==void 0?ba[1]:{},_r=_n.enableNotificationToChannelMembers,_s=_r!==void 0&&_r,this.connectionState===oa.CONNECTED){_p.next=3;break}throw new da("The client is not logged in",qc);case 3:if(this.session!==void 0){_p.next=5;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 5:return na=this.session.requestClearChannelAttributes(_e,_s).toPromise(),_p.prev=6,_p.next=9,na;case 9:this.channelAttributesCacheLru.delete(_e),_p.next=17;break;case 12:if(_p.prev=12,_p.t0=_p.catch(6),!Na(_p.t0)){_p.next=16;break}throw _p.t0;case 16:throw new ca("arguments is not valid",gb);case 17:case"end":return _p.stop()}},$,this,[[6,12]])}));return function($){return _.apply(this,arguments)}}()},{key:"getUserAttributes",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s;return N.wrap(function(na){for(;;)switch(na.prev=na.next){case 0:if(Ta(_e)){na.next=2;break}throw new ca("Not a valid user ID",gb);case 2:if(this.connectionState===oa.CONNECTED){na.next=4;break}throw new da("The client is not logged in",qc);case 4:if(this.session!==void 0){na.next=6;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return na.prev=6,na.next=9,this.session.requestGetUserAttributeKeys(_e).toPromise();case 9:return _n=na.sent,_r=_n.keys,na.next=13,this.session.requestGetUserAttributesByKeys(_e,_r.slice(0,512)).toPromise();case 13:_s=na.sent,na.next=21;break;case 16:if(na.prev=16,na.t0=na.catch(6),!Na(na.t0)){na.next=20;break}throw na.t0;case 20:throw new ca("arguments is not valid",gb);case 21:return na.abrupt("return",Zq(_s.attributeInfos.map(function(ba){return[ba.key,ba.value]})));case 22:case"end":return na.stop()}},$,this,[[6,16]])}));return function($){return _.apply(this,arguments)}}()},{key:"getChannelAttributes",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s,na,ba,_p,_f,_E,_v,n_,e_;return N.wrap(function(t_){for(;;)switch(t_.prev=t_.next){case 0:if(Ta(_e)){t_.next=2;break}throw new ca("Not a valid channel ID",gb);case 2:if(this.connectionState===oa.CONNECTED){t_.next=4;break}throw new da("The client is not logged in",qc);case 4:if(this.session!==void 0){t_.next=6;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 6:return t_.prev=6,t_.next=9,this.session.requestGetChannelAttributesKeys(_e).toPromise();case 9:return _n=t_.sent,_r=_n.keys,t_.next=13,this.session.requestGetChannelAttributesByKeys(_e,_r).toPromise();case 13:_s=t_.sent,na=_s.attributeMaps,t_.next=22;break;case 17:if(t_.prev=17,t_.t0=t_.catch(6),!Na(t_.t0)){t_.next=21;break}throw t_.t0;case 21:throw new ca("arguments is not valid",gb);case 22:ba={},_p=0;case 24:if(!(_p<na.length)){t_.next=32;break}if(_f=na[_p],_E=_f.key,_v=_f.ms,n_=_f.value,e_=_f.origin,typeof _E=="string"&&P.isLong(_v)&&typeof n_=="string"&&Ta(e_)){t_.next=28;break}return t_.abrupt("break",32);case 28:ba[_E]={value:n_,lastUpdateUserId:e_,lastUpdateTs:_v.toNumber()};case 29:_p++,t_.next=24;break;case 32:return this.channelAttributesCacheLru.set(_e,md(ba,function(o_){return new Blob([o_.value]).size})),t_.abrupt("return",ba);case 34:case"end":return t_.stop()}},$,this,[[6,17]])}));return function($){return _.apply(this,arguments)}}()},{key:"getChannelAttributesByKeys",value:function(){var _=ma(N.mark(function $(_e,_n){var _r,_s,na,ba,_p,_f,_E,_v,n_,e_;return N.wrap(function(t_){for(;;)switch(t_.prev=t_.next){case 0:if(this.connectionState===oa.CONNECTED){t_.next=2;break}throw new da("The client is not logged in",qc);case 2:if(this.session!==void 0){t_.next=4;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Qn(_e,_n),t_.prev=5,t_.next=8,this.session.requestGetChannelAttributesByKeys(_e,_n).toPromise();case 8:_r=t_.sent,_s=_r.attributeMaps,t_.next=17;break;case 12:if(t_.prev=12,t_.t0=t_.catch(5),!Na(t_.t0)){t_.next=16;break}throw t_.t0;case 16:throw new ca("arguments is not valid",gb);case 17:na={},ba=this.channelAttributesCacheLru.get(_e,{}),_p=0;case 20:if(!(_p<_s.length)){t_.next=29;break}if(_f=_s[_p],_E=_f.key,_v=_f.ms,n_=_f.value,e_=_f.origin,typeof _E=="string"&&P.isLong(_v)&&typeof n_=="string"&&Ta(e_)){t_.next=24;break}return t_.abrupt("break",29);case 24:ba[_E]=new Blob([n_]).size,na[_E]={value:n_,lastUpdateUserId:e_,lastUpdateTs:_v.toNumber()};case 26:_p++,t_.next=20;break;case 29:return this.channelAttributesCacheLru.set(_e,ba),t_.abrupt("return",na);case 31:case"end":return t_.stop()}},$,this,[[5,12]])}));return function($,_e){return _.apply(this,arguments)}}()},{key:"getUserAttributesByKeys",value:function(){var _=ma(N.mark(function $(_e,_n){var _r;return N.wrap(function(_s){for(;;)switch(_s.prev=_s.next){case 0:if(this.connectionState===oa.CONNECTED){_s.next=2;break}throw new da("The client is not logged in",qc);case 2:if(this.session!==void 0){_s.next=4;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:return Qn(_e,_n),_s.prev=5,_s.next=8,this.session.requestGetUserAttributesByKeys(_e,_n).toPromise();case 8:_r=_s.sent,_s.next=16;break;case 11:if(_s.prev=11,_s.t0=_s.catch(5),!Na(_s.t0)){_s.next=15;break}throw _s.t0;case 15:throw new ca("arguments is not valid",gb);case 16:return _s.abrupt("return",Zq(_r.attributeInfos.map(function(na){return[na.key,na.value]})));case 17:case"end":return _s.stop()}},$,this,[[5,11]])}));return function($,_e){return _.apply(this,arguments)}}()},{key:"login",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s,na,ba;return N.wrap(function(_p){for(;;)switch(_p.prev=_p.next){case 0:if(xn(!0),_r=nh(),_s=_e.token,_e.token===this.context.appId&&(_s=void 0),bb("Session",{appId:this.context.appId,did:navigator.userAgent,elapse:Xa(this.session&&this.session.startTime),index:{index1:_e.uid,index2:this.context.appId,index3:"enableLogUpload=".concat(this.context.config.enableLogUpload)},installId:Og,lts:P.fromNumber(Date.now()),os:7,sid:sb(_r),token:_s||"",userId:_e.uid,ver:"1.5.1",buildno:418,subVersion:18,version:4},(_n=this.context.config.enableCloudProxy)!==null&&_n!==void 0&&_n,!0),De(_e)&&Ta(_e.uid)){_p.next=7;break}throw new ca("not a valid user id",si);case 7:if(typeof _s!="string"||!_s){_p.next=11;break}this.context.token=_s,_p.next=13;break;case 11:if(typeof _s=="string"||_s==null){_p.next=13;break}throw new ca('The "token" is not a valid string.',si);case 13:return na=Date.now(),this.context.sid=sb(_r),this.loginPromise=this.loginImpl({uid:_e.uid,instanceId:_r}),this.info("RTM Client logging in as ".concat(La(_e.uid))),_p.prev=17,_p.next=20,this.loginPromise;case 20:_p.next=28;break;case 22:throw _p.prev=22,_p.t0=_p.catch(17),Na(_p.t0)&&bb("Link",{ackedServerIp:"",destServerIp:"",ec:_p.t0.code||1,sc:_p.t0.serverCode,elapse:Xa(this.session&&this.session.startTime),lts:P.fromNumber(Date.now()),responseTime:Date.now()-na,sid:sb(_r),userId:_e.uid},(ba=this.context.config.enableCloudProxy)!==null&&ba!==void 0&&ba),this.context.token=void 0,this.context.socketUseProxy=!1,_p.t0;case 28:return _p.prev=28,this.loginPromise=void 0,_p.finish(28);case 31:this.context.socketUseProxy&&this.emit("FallbackProxyConnected"),xn(!1);case 33:case"end":return _p.stop()}},$,this,[[17,22,28,31]])}));return function($){return _.apply(this,arguments)}}()},{key:"logout",value:function(){var _=ma(N.mark(function $(){var _e;return N.wrap(function(_n){for(;;)switch(_n.prev=_n.next){case 0:if(!this.loginPromise){_n.next=3;break}return _n.next=3,this.loginPromise;case 3:if(this.connectionState!==oa.DISCONNECTED){_n.next=6;break}throw this.logError("Already in logout state"),new da("Logout failure. The client has already been logged out",cs);case 6:if(this.internalEmitter.emit("LOGOUT"),this.connectionState!==oa.ABORTED){_n.next=11;break}return this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'),this.onConnectionStateChanged(oa.DISCONNECTED,Rb.LOGOUT),_n.abrupt("return");case 11:if(this.session!==void 0){_n.next=14;break}return this.onConnectionStateChanged(oa.DISCONNECTED,Rb.LOGOUT),_n.abrupt("return");case 14:return bb("Logout",{elapse:Xa(this.session.startTime),lts:P.fromNumber(Date.now()),sid:sb(this.session.instanceId),userId:this.context.uid},(_e=this.context.config.enableCloudProxy)!==null&&_e!==void 0&&_e),_n.next=17,this.session.logoutHandler();case 17:this.onConnectionStateChanged(oa.DISCONNECTED,Rb.LOGOUT),this.log("Log out success");case 19:case"end":return _n.stop()}},$,this)}));return function(){return _.apply(this,arguments)}}()},{key:"logoutSync",value:function(){var _,$=this;if(this.connectionState===oa.DISCONNECTED)throw this.logError("Already in logout state"),new da("Logout failure. The client has already been logged out",cs);this.connectionState===oa.ABORTED?this.info('Reset connection state from "ABORTED" to "DISCONNECTED"'):this.session!==void 0&&(bb("Logout",{elapse:Xa(this.session.startTime),lts:P.fromNumber(Date.now()),sid:sb(this.session.instanceId),userId:this.context.uid},(_=this.context.config.enableCloudProxy)!==null&&_!==void 0&&_),this.session.logoutHandler().then(function(){$.log("Log out success")})),this.onConnectionStateChanged(oa.DISCONNECTED,Rb.LOGOUT)}},{key:"sendMessageToPeer",value:function(){var _=ma(N.mark(function $(_e,_n){var _r,_s,na=this;return N.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:if(Xn(_e,bg),_r=_e.messageType==="TEXT"?Ka.P2pSMsgNoOfflineFlag:Ka.P2pRMsgNoOfflineFlag,this.connectionState!==oa.RECONNECTING){ba.next=5;break}return _s=Date.now(),ba.abrupt("return",new Promise(function(_p,_f){var _E,_v=(_E=ma(N.mark(function e_(){var t_;return N.wrap(function(o_){for(;;)switch(o_.prev=o_.next){case 0:if(na.session!==void 0){o_.next=2;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 2:return t_=Date.now()-_s,o_.prev=3,o_.t0=_p,o_.next=7,ph({message:_e,peerId:_n,toPeer:!0,session:na.session,errorCodes:{NOT_LOGGED_IN:Ll,TOO_OFTEN:es},diff:t_,logger:na.logger});case 7:o_.t1=o_.sent,(0,o_.t0)(o_.t1),o_.next=18;break;case 11:o_.prev=11,o_.t2=o_.catch(3),Ab(o_.t2)&&(na.session.emit("messageCount",{messageCategory:_r,type:"common",key:"sentcount"}),na.session.emit("messageCount",{messageCategory:_r,type:"common",key:"timeoutcount"}),_f(new Ub(we(na.name,"sendMessageToPeer",1e4),Kl))),Na(o_.t2)&&_f(o_.t2),na.session.emit("messageCount",{messageCategory:_r,type:"common",key:"sentcount"}),na.session.emit("messageCount",{messageCategory:_r,type:"common",key:"unknowerrorcount"}),_f(new Ja("Peer-to-peer message send failure",{code:ds,originalError:o_.t2}));case 18:return o_.prev=18,clearTimeout(n_),o_.finish(18);case 21:case"end":return o_.stop()}},e_,null,[[3,11,18,21]])})),function(){return _E.apply(this,arguments)});na.internalEmitter.once("RECONNECTED",_v);var n_=setTimeout(function(){na.internalEmitter.off("RECONNECTED",_v),_f(new Ub(we(na.name,"sendMessageToPeer",1e4),Kl))},9e3)}));case 5:if(this.connectionState===oa.CONNECTED){ba.next=7;break}throw new da("Failed to send the peer-to-peer message. The client is not logged in",Ll);case 7:if(this.session!==void 0){ba.next=9;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 9:return ba.prev=9,ba.next=12,ph({message:_e,peerId:_n,toPeer:!0,session:this.session,errorCodes:{NOT_LOGGED_IN:Ll,TOO_OFTEN:es},diff:0,logger:this.logger});case 12:return ba.abrupt("return",ba.sent);case 15:if(ba.prev=15,ba.t0=ba.catch(9),!Ab(ba.t0)){ba.next=21;break}throw this.session.emit("messageCount",{messageCategory:_r,type:"common",key:"sentcount"}),this.session.emit("messageCount",{messageCategory:_r,type:"common",key:"timeoutcount"}),new Ub(we(this.name,"sendMessageToPeer",1e4),Kl);case 21:if(!Na(ba.t0)){ba.next=23;break}throw ba.t0;case 23:throw this.session.emit("messageCount",{messageCategory:_r,type:"common",key:"sentcount"}),this.session.emit("messageCount",{messageCategory:_r,type:"common",key:"unknowerrorcount"}),new Ja("Peer-to-peer message send failure",{code:ds,originalError:ba.t0});case 26:case"end":return ba.stop()}},$,this,[[9,15]])}));return function($,_e){return _.apply(this,arguments)}}()},{key:"createChannel",value:function(_){var $=this;if(!Ta(_))throw new ca(["The %s in the arguments is invalid",Object.keys({channelId:_})[0]],FB);return new uF(_,function(){return $.session},this,this.logger)}},{key:"createLocalInvitation",value:function(_){if(!Ta(_))throw new ca(["The %s in the arguments is invalid",Object.keys({calleeId:_})[0]],Xc);return this.invitationManager.genLocalInvitation(_)}},{key:"subscribePeersOnlineStatus",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s,na,ba,_p,_f,_E,_v,n_,e_,t_,o_,m_=this;return N.wrap(function(b_){for(;;)switch(b_.prev=b_.next){case 0:if(this.connectionState===oa.CONNECTED){b_.next=2;break}throw new da("The client is not logged in",Nl);case 2:if(this.session!==void 0){b_.next=4;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_e)&&_e.length!==0){b_.next=6;break}throw new ca("Invalid arguments: peerIds",Qg);case 6:_n=0;case 7:if(!(_n<_e.length)){b_.next=14;break}if(Ta(_r=_e[_n])){b_.next=11;break}throw new ca(["subscribePeersOnlineStatus peer id %s is invalid",_r],Qg);case 11:_n++,b_.next=7;break;case 14:if(!(512<(_s=_e&&_e.length?fl(_e):[]).length+Object.keys(this.subscribedPeerStatusCache).length+this.pendingPeerStatusSubCount)){b_.next=17;break}throw new ic("Subscribed peers overflows",js);case 17:return this.pendingPeerStatusSubCount+=_s.length,b_.next=20,this.session.requestSubscribePeersOnlineStatus(_s).toPromise();case 20:na=b_.sent,ba=na.errors,this.pendingPeerStatusSubCount-=_s.length,_p=[],_f=[],_E=0;case 26:if(!(_E<ba.length)){b_.next=34;break}if(_v=ba[_E],n_=_v.code,typeof(e_=_v.account)=="string"){b_.next=30;break}throw new Ja("Returned account is invalid",is);case 30:n_!==0&&_p.push(e_);case 31:_E++,b_.next=26;break;case 34:for(t_=0;t_<_s.length;t_++)o_=_s[t_],_p.includes(o_)||(_f.push(o_),this.subscribedPeerStatusCache[o_]=void 0);if(this.session.requestPeersOnlineStatus(_f).pipe(Ea(function(w_){return md(tl(w_.userInfos,"account"),function(y_){return!!y_.ts})})).subscribe(function(w_){w_=md(w_,function(y_,N_){return y_=y_?ta.PeerOnlineState.ONLINE:ta.PeerOnlineState.OFFLINE,m_.subscribedPeerStatusCache[N_]=y_}),m_.emit("PeersOnlineStatusChanged",w_)}),_p.length===0){b_.next=38;break}throw new Ja("Subscription failed",is);case 38:case"end":return b_.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"unsubscribePeersOnlineStatus",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s,na,ba;return N.wrap(function(_p){for(;;)switch(_p.prev=_p.next){case 0:if(this.connectionState===oa.CONNECTED){_p.next=2;break}throw new da("The client is not logged in",Nl);case 2:if(this.session!==void 0){_p.next=4;break}throw new mb({SESSION_NOT_FOUND:"Failed to get session of the client"});case 4:if(Array.isArray(_e)&&_e.length!==0){_p.next=6;break}throw new ca("Invalid arguments: peerIds",Qg);case 6:_n=0;case 7:if(!(_n<_e.length)){_p.next=14;break}if(Ta(_r=_e[_n])){_p.next=11;break}throw new ca(["subscribePeersOnlineStatus peer id %s is invalid",_r],Qg);case 11:_n++,_p.next=7;break;case 14:if(!(512<_e.length)){_p.next=16;break}throw new ic("Unsubscribed peers overflows",js);case 16:for(_s=_e&&_e.length?fl(_e):[],this.session.requestUnsubscribePeersOnlineStatus(_s),na=0;na<_s.length;na++)ba=_s[na],delete this.subscribedPeerStatusCache[ba];case 19:case"end":return _p.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"queryPeersBySubscriptionOption",value:function(){var _=ma(N.mark(function $(_e){return N.wrap(function(_n){for(;;)switch(_n.prev=_n.next){case 0:if(this.connectionState===oa.CONNECTED){_n.next=2;break}throw new da("The client is not logged in",Nl);case 2:if(_e!==ta.PeerSubscriptionOption.ONLINE_STATUS){_n.next=4;break}return _n.abrupt("return",Object.keys(this.subscribedPeerStatusCache));case 4:throw new ca("Subscription option not supported",Qg);case 5:case"end":return _n.stop()}},$,this)}));return function($){return _.apply(this,arguments)}}()},{key:"createMessage",value:function(_){return _}},{key:"loginImpl",value:function(){var _=ma(N.mark(function $(_e){var _n,_r,_s,na,ba,_p,_f,_E,_v=this;return N.wrap(function(n_){for(;;)switch(n_.prev=n_.next){case 0:if(_n=_e.uid,_r=_e.instanceId,_s=_e.forceLoginTime,na=_s===void 0?0:_s,ba=_r,!(this.lastLoginTime!==void 0&&500>Date.now()-this.lastLoginTime)){n_.next=4;break}throw new bE(["The frequency of login exceeded the limit of %d queries per second",2],UB);case 4:if(this.connectionState===oa.DISCONNECTED||na!==0){n_.next=6;break}throw new da("The SDK is either logging in or has logged in the Agora RTM system",SB);case 6:n_.prev=6,this.context.uid=_n,n_.next=13;break;case 10:throw n_.prev=10,n_.t0=n_.catch(6),new ca(["The %s in the arguments is invalid",Object.keys({uid:_n})[0]],si);case 13:return na===0&&this.onConnectionStateChanged(oa.CONNECTING,Rb.LOGIN),(_p=new ct(this.context,this.logger,!1)).blacklistedIP=this.blacklistedIP,this.session=_f=new Tt(this.context,_p,ba,this.logger),_E=function(){_v.connectionState===oa.CONNECTED&&(_v.onConnectionStateChanged(oa.RECONNECTING,Rb.INTERRUPTED),_v.session)&&_v.session.once("userJoined",function(){_v.onConnectionStateChanged(oa.CONNECTED,Rb.LOGIN_SUCCESS)})},_f.on("connectionLost",_E),_f.on("tokenExpired",function(){_v.emit("TokenExpired")}),_f.on("tokenPrivilegeWillExpire",this.TokenPrivilegeWillExpireHandler),_f.once("userDrop",this.userDropHandler),this.session.on("peerTextMessage",function(e_){_v.emit("MessageFromPeer",{text:e_.text,messageType:ta.MessageType.TEXT},e_.peerId,e_.properties)}),this.session.on("peerRawMessage",function(e_){_v.emit("MessageFromPeer",{rawMessage:e_.raw,description:e_.desc,messageType:ta.MessageType.RAW},e_.peerId,e_.properties)}),_f.on("instanceChanged",function(e_){return ba=e_}),_f.on("peerOnlineStatusChanged",function(e_){var t_=e_.instance.toString()+e_.state,o_=_v.peerStatusSeqLru.get(t_);!o_||e_.seq.greaterThan(o_)?(_v.peerStatusSeqLru.set(t_,e_.seq),e_.state!==_v.subscribedPeerStatusCache[e_.peerId]&&_v.emit("PeersOnlineStatusChanged",x({},e_.peerId,e_.state)),_v.subscribedPeerStatusCache[e_.peerId]=e_.state,clearTimeout(_v.peerUnreachableTimers[t_]),e_.state===ta.PeerOnlineState.UNREACHABLE&&(_v.peerUnreachableTimers[t_]=setTimeout(function(){_v.subscribedPeerStatusCache[e_.peerId]===ta.PeerOnlineState.UNREACHABLE&&(_v.subscribedPeerStatusCache[e_.peerId]=ta.PeerOnlineState.ONLINE,_v.emit("PeersOnlineStatusChanged",x({},e_.peerId,ta.PeerOnlineState.ONLINE)))},3e4))):_v.log("peerOnlineStatusChanged dedup for %s, %d",t_,e_.seq.toNumber())}),_f.on("invitationMessage",this.invitationManager.invitationMessageHandler.bind(this.invitationManager)),_f.on("channelAttributesUpdated",function(e_){var t_=e_.channelId;e_=e_.attributeMaps;for(var o_={},m_=0;m_<e_.length;m_++){var b_=e_[m_],w_=b_.key,y_=b_.ms,N_=b_.value;if(b_=b_.origin,typeof w_!="string"||!P.isLong(y_)||typeof N_!="string"||!Ta(b_))break;o_[w_]=new Blob([N_]).size}_v.channelAttributesCacheLru.set(t_,o_)}),_f.on("userJoined",function(e_){if(Object.keys(_v.attributes).length!==0){if(_v.session===void 0)return;_v.session.requestSetLocalUserAttributes(_v.attributes,e_).toPromise()}if(_v.attributeDrafts.size!==0)for(var t_=function(b_,w_){var y_=(b_=w_[b_]).attribute;b_.promise.then(function(){_v.session!==void 0&&_v.session.requestSetLocalUserAttributes(y_,e_).toPromise()})},o_=0,m_=Array.from(_v.attributeDrafts);o_<m_.length;o_++)t_(o_,m_);Object.keys(_v.subscribedPeerStatusCache).length!==0&&_f.requestSubscribePeersOnlineStatus(Object.keys(_v.subscribedPeerStatusCache))}),_f.on("banEdgeIP",function(e_){_v.banIP(e_)}),this.lastLoginTime=Date.now(),n_.prev=32,n_.next=35,_f.loginHandler().toPromise();case 35:n_.next=53;break;case 37:if(n_.prev=37,n_.t1=n_.catch(32),!(n_.t1.name==="loginRespTimeout"&&2>na)){n_.next=46;break}return _f.removeAllListeners(),n_.next=43,this.loginImpl({uid:_n,instanceId:_r,forceLoginTime:na+1});case 43:return n_.abrupt("return");case 46:if(!Ab(n_.t1)){n_.next=49;break}throw this.onConnectionStateChanged(oa.DISCONNECTED,Rb.LOGIN_TIMEOUT),new Ub(we(this.name,"login",12e3),TB);case 49:if(this.onConnectionStateChanged(oa.DISCONNECTED,Rb.LOGIN_FAILURE),!Na(n_.t1)){n_.next=52;break}throw n_.t1;case 52:throw new Ja("Login failure",{code:$r,originalError:n_.t1});case 53:this.onConnectionStateChanged(oa.CONNECTED,Rb.LOGIN_SUCCESS);case 54:case"end":return n_.stop()}},$,this,[[6,10],[32,37]])}));return function($){return _.apply(this,arguments)}}()},{key:"onConnectionStateChanged",value:function(_,$){var _e,_n=this;_===oa.RECONNECTING&&(this.reconnId+=1),bb("ConnectionStateChange",{elapse:Xa(this.session&&this.session.startTime),lts:P.fromNumber(Date.now()),newState:Vt[_],oldState:Vt[this.connectionState],reason:vF[$],sid:sb(this.session&&this.session.instanceId||P.fromNumber(0)),userId:this.context.uid,reconnId:this.reconnId},(_e=this.context.config.enableCloudProxy)!==null&&_e!==void 0&&_e),this.connectionState===oa.RECONNECTING&&_===oa.CONNECTED&&(Object.keys(this.subscribedPeerStatusCache).length!==0&&this.session!==void 0&&this.session.requestPeersOnlineStatus(Object.keys(this.subscribedPeerStatusCache)).pipe(Ea(function(_r){return md(tl(_r.userInfos,"account"),function(_s){return!!_s.ts})})).subscribe(function(_r){_r=md(_r,function(_s,na){return _s=_s?ta.PeerOnlineState.ONLINE:ta.PeerOnlineState.OFFLINE,_n.subscribedPeerStatusCache[na]=_s}),_n.emit("PeersOnlineStatusChanged",_r)}),this.internalEmitter.emit("RECONNECTED")),this.connectionState=_,_!==oa.ABORTED&&_!==oa.DISCONNECTED||(this.pendingPeerStatusSubCount=this.reconnId=0,this.attributes={},this.session&&(this.session.removeAllListeners(),this.session.msgDedupLru.empty(),this.session.dialogueSequenceLru.empty(),this.session.dialPendingMsgSubjectMap.clear()),this.channelAttributesCacheLru.empty(),this.peerStatusSeqLru.empty(),this.peerUnreachableTimers={},this.subscribedPeerStatusCache={},this.attributeDrafts.clear(),this.context.token=void 0),this.emit("ConnectionStateChanged",_,$)}},{key:"banIP",value:function(_){var $;this.log("ip banned",_);var _e=($=this.blacklistedIP[_])!==null&&$!==void 0?$:0;this.blacklistedIP[_]=_e+1}}]),o}(sc()),Da(W.prototype,"renewToken",[jb],Object.getOwnPropertyDescriptor(W.prototype,"renewToken"),W.prototype),Da(W.prototype,"queryPeersOnlineStatus",[jb],Object.getOwnPropertyDescriptor(W.prototype,"queryPeersOnlineStatus"),W.prototype),Da(W.prototype,"getChannelMemberCount",[jb],Object.getOwnPropertyDescriptor(W.prototype,"getChannelMemberCount"),W.prototype),Da(W.prototype,"setLocalUserAttributes",[jb],Object.getOwnPropertyDescriptor(W.prototype,"setLocalUserAttributes"),W.prototype),Da(W.prototype,"setChannelAttributes",[jb],Object.getOwnPropertyDescriptor(W.prototype,"setChannelAttributes"),W.prototype),Da(W.prototype,"addOrUpdateLocalUserAttributes",[jb],Object.getOwnPropertyDescriptor(W.prototype,"addOrUpdateLocalUserAttributes"),W.prototype),Da(W.prototype,"addOrUpdateChannelAttributes",[jb],Object.getOwnPropertyDescriptor(W.prototype,"addOrUpdateChannelAttributes"),W.prototype),Da(W.prototype,"deleteLocalUserAttributesByKeys",[jb],Object.getOwnPropertyDescriptor(W.prototype,"deleteLocalUserAttributesByKeys"),W.prototype),Da(W.prototype,"deleteChannelAttributesByKeys",[jb],Object.getOwnPropertyDescriptor(W.prototype,"deleteChannelAttributesByKeys"),W.prototype),Da(W.prototype,"clearLocalUserAttributes",[Mc],Object.getOwnPropertyDescriptor(W.prototype,"clearLocalUserAttributes"),W.prototype),Da(W.prototype,"clearChannelAttributes",[jb],Object.getOwnPropertyDescriptor(W.prototype,"clearChannelAttributes"),W.prototype),Da(W.prototype,"getUserAttributes",[jb],Object.getOwnPropertyDescriptor(W.prototype,"getUserAttributes"),W.prototype),Da(W.prototype,"getChannelAttributes",[jb],Object.getOwnPropertyDescriptor(W.prototype,"getChannelAttributes"),W.prototype),Da(W.prototype,"getChannelAttributesByKeys",[jb],Object.getOwnPropertyDescriptor(W.prototype,"getChannelAttributesByKeys"),W.prototype),Da(W.prototype,"getUserAttributesByKeys",[jb],Object.getOwnPropertyDescriptor(W.prototype,"getUserAttributesByKeys"),W.prototype),Da(W.prototype,"login",[Mc],Object.getOwnPropertyDescriptor(W.prototype,"login"),W.prototype),Da(W.prototype,"logout",[Mc],Object.getOwnPropertyDescriptor(W.prototype,"logout"),W.prototype),Da(W.prototype,"logoutSync",[Mc],Object.getOwnPropertyDescriptor(W.prototype,"logoutSync"),W.prototype),Da(W.prototype,"sendMessageToPeer",[jb],Object.getOwnPropertyDescriptor(W.prototype,"sendMessageToPeer"),W.prototype),Da(W.prototype,"createChannel",[jb],Object.getOwnPropertyDescriptor(W.prototype,"createChannel"),W.prototype),Da(W.prototype,"createLocalInvitation",[jb],Object.getOwnPropertyDescriptor(W.prototype,"createLocalInvitation"),W.prototype),Da(W.prototype,"subscribePeersOnlineStatus",[jb],Object.getOwnPropertyDescriptor(W.prototype,"subscribePeersOnlineStatus"),W.prototype),Da(W.prototype,"unsubscribePeersOnlineStatus",[jb],Object.getOwnPropertyDescriptor(W.prototype,"unsubscribePeersOnlineStatus"),W.prototype),Da(W.prototype,"queryPeersBySubscriptionOption",[jb],Object.getOwnPropertyDescriptor(W.prototype,"queryPeersBySubscriptionOption"),W.prototype),Da(W.prototype,"createMessage",[Mc],Object.getOwnPropertyDescriptor(W.prototype,"createMessage"),W.prototype),W),rm,sm,tm,um,Wt=(rm=/Chrome\/([0-9.]+)/.exec((tm=window)===null||tm===void 0||(um=tm.navigator)===null||um===void 0?void 0:um.userAgent))===null||rm===void 0||(sm=rm[1])===null||sm===void 0?void 0:sm.split(".")[0];if(Wt&&88<=parseInt(Wt,10)&&!Ce()){var vm,ze=document.createElement("video"),Ae=document.createElement("canvas");ze.setAttribute("style","display:none"),ze.setAttribute("muted",""),ze.muted=!0,ze.setAttribute("autoplay",""),ze.autoplay=!0,ze.setAttribute("playsinline",""),Ae.setAttribute("style","display:none"),Ae.setAttribute("width","1"),Ae.setAttribute("height","1"),(vm=Ae.getContext("2d"))===null||vm===void 0||vm.fillRect(0,0,1,1),ze.srcObject=Ae==null?void 0:Ae.captureStream()}var Xt={LOG_FILTER_OFF:{error:!1,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_ERROR:{error:!0,warn:!1,info:!1,track:!1,debug:!1},LOG_FILTER_WARNING:{error:!0,warn:!0,info:!1,track:!1,debug:!1},LOG_FILTER_INFO:{error:!0,warn:!0,info:!0,track:!1,debug:!1},LOG_FILTER_DEBUG:{error:!0,warn:!0,info:!0,track:!0,debug:!0}},Yt={enableLogUpload:!1,logFilter:Xt.LOG_FILTER_INFO,enableCloudProxy:!1},ue=Wa(Wa({createInstance:function(e){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},s=2<arguments.length?arguments[2]:void 0;if(!/^[\dA-Za-z]{32}$/.test(e))throw new ca(["The %s in the arguments is invalid",Object.keys({appId:e})[0]],Or);var a=Object.keys(o).filter(function(na){return!(na in Yt)});if(a.length!==0)throw new ca("Invalid RTM config: ".concat(a.join(", ")),Or);var _=Wa(Wa({},Yt),o);if(s!==void 0&&(!Array.isArray(s)||s.length===0))throw new ca("Invalid area config");if(s!=null){if(!s.every(function(na){return na in ta.LegacyAreaCode}))throw new ca("Invalid area codes: ".concat(s.filter(function(na){return!(na in ta)}).join(", ")));fa=Ve(s.map(function(na){return dE[na]}))}s=Tl=Ya.__global_unique_id__=(Ya.__global_unique_id__||0)+1;var $=iE(_);a=jE(_);var _e=kE(_),_n=lE(s,_),_r=Xs(s,_),_s=_r("RTM:DEBUG","<Entry> ");return Qs.rtmConfig=_,$("The Agora RTM Web SDK version is %s","1.5.1"),o.enableCloudProxy&&$("RTM cloud proxy enabled"),o.enableLogUpload&&$("Log upload enabled"),fa&&_s("Area is set to %s",Array.from(fa.CODES).map(function(na){return Yf(S).find(function(ba){return S[ba]===na})}).join(", ")),_s("Creating an RtmClient instance"),_s('The Git commit ID is "'.concat("v1.5.1-0-g5bbbcd72",'"')),_s("The App ID is %s",Yn(e,4,10,"*".repeat(6))),$("The process ID is %s",Og),_s("The build is %s","v1.5.1-0-g5bbbcd72"),_s("NODE_ENV is %s","production"),new wF(e,{genLogger:_r,genTracker:_n,info:$,warn:a,logError:_e,loggerId:s},_,function(na){for(var ba=0,_p=Yf(na);ba<_p.length;ba++){var _f=_p[ba];try{var _E=na[_f];_E!=null&&(na.enableCloudProxy&&$("RTM cloud proxy enabled"),na.enableLogUpload&&$("Log upload enabled"),_[_f]=_E)}catch{throw new ca(["The %s in the arguments is invalid",_f],void 0)}}})},BUILD:"v1.5.1-0-g5bbbcd72",VERSION:"1.5.1",END_CALL_PREFIX:"AgoraRTMLegacyEndcallCompatibleMessagePrefix",processId:Og,ConnectionChangeReason:ta.ConnectionChangeReason,ConnectionState:ta.ConnectionState,LocalInvitationFailureReason:ta.LocalInvitationFailureReason,LocalInvitationState:ta.LocalInvitationState,RemoteInvitationFailureReason:ta.RemoteInvitationFailureReason,RemoteInvitationState:ta.RemoteInvitationState,MessageType:ta.MessageType,PeerOnlineState:ta.PeerOnlineState,PeerSubscriptionOption:ta.PeerSubscriptionOption},Xt),{},{setParameter:function(e,o){Object.keys(Ec).includes(e)&&(Ec[e]=o)},getParameter:function(e){return Ec[e]},setArea:function(e){var o=e.areaCodes;if(e=e.excludedArea,!Array.isArray(o)||o.length===0||!o.every(function(s){return s in ta.AreaCode}))throw new ca("Invalid area config");if(e!==void 0&&e===ta.AreaCode.GLOBAL)throw new ca("Excluded area cannot be global");if(e===void 0)fa=Ve(o.map(function(s){return S[s]}));else{if(o.includes(e))throw new ca("Excluded area cannot be in areaCodes");if(!(e in S))throw new ca("Invalid excludedArea:",e);fa=Gv({areas:o.map(function(s){return S[s]}),excludedArea:S[e]})}}});return ue})})(agoraRtmSdk,agoraRtmSdk.exports);var agoraRtmSdkExports=agoraRtmSdk.exports;const AgoraRTM=getDefaultExportFromCjs(agoraRtmSdkExports),appId="490d904cf7824b0da3ffc37dac70b557",token=null,config={mode:"rtc",codec:"vp8",appId,token},useClient=createClient(config),useMicrophoneAndCameraTracks=createMicrophoneAndCameraTracks();AgoraRTM.createInstance(appId);const SocketContext=reactExports.createContext(),WS="https://vision-link-api.onrender.com",socket=lookup(WS),SocketContextProvider=({children:e})=>{const o=useNavigate(),s=localStorage.getItem("userId"),[a,_]=reactExports.useState(!1),[$,_e]=reactExports.useState([]),[_n,_r]=reactExports.useState(!1),_s=useClient(),{ready:na,tracks:ba}=useMicrophoneAndCameraTracks(),[_p,_f]=reactExports.useState(null),[_E,_v]=reactExports.useState({}),[n_,e_]=reactExports.useState([]),[t_,o_]=reactExports.useState(!1),[m_,b_]=reactExports.useState(!1),[w_,y_]=reactExports.useState("");return reactExports.useEffect(()=>{socket.on("room-created",({roomId:N_,meetType:_y})=>{_y==="instant"?o(`/meet/${N_}`):_y==="scheduled"&&o("/profile")})},[socket]),jsxRuntimeExports.jsx(SocketContext.Provider,{value:{myMeets:n_,setMyMeets:e_,newMeetType:w_,setNewMeetType:y_,participants:_E,setParticipants:_v,userId:s,socket,inCall:a,setInCall:_,ready:na,tracks:ba,screenTrack:_p,setScreenTrack:_f,client:_s,users:$,setUsers:_e,start:_n,setStart:_r,participantsListOpen:t_,setParticipantsListOpen:o_,chatsContainerOpen:m_,setChatsContainerOpen:b_},children:e})},Home=()=>{const[e,o]=reactExports.useState(""),[s,a]=reactExports.useState("none"),[_,$]=reactExports.useState("none"),[_e,_n]=reactExports.useState(""),[_r,_s]=reactExports.useState(""),{logout:na}=reactExports.useContext(AuthContext),ba=useNavigate(),{socket:_p,setMyMeets:_f,newMeetType:_E,setNewMeetType:_v}=reactExports.useContext(SocketContext),n_=localStorage.getItem("userId"),e_=localStorage.getItem("userName"),t_=()=>{ba("/login")},o_=w_=>{w_.preventDefault(),na()},m_=()=>{console.log("Creating room..."),_p.emit("create-room",{userId:n_,roomName:e,newMeetType:_E,newMeetDate:s,newMeetTime:_})},b_=async()=>{await _p.emit("user-code-join",{roomId:_e}),o("")};return reactExports.useEffect(()=>{const w_=({roomId:N_})=>{console.log("Room exists. Redirecting to:",`/meet/${N_}`),ba(`/meet/${N_}`)},y_=()=>{console.log("Room does not exist."),_n(""),_s("Room doesn't exist! please try again..")};return _p.on("room-exists",w_),_p.on("room-not-exist",y_),()=>{_p.off("room-exists",w_),_p.off("room-not-exist",y_)}},[_p,ba]),jsxRuntimeExports.jsxs("div",{className:"homePage",children:[jsxRuntimeExports.jsxs("div",{className:"homePage-hero",children:[jsxRuntimeExports.jsxs("div",{className:"home-header",children:[jsxRuntimeExports.jsx("div",{className:"home-logo",children:jsxRuntimeExports.jsx("h2",{children:"Vision Link"})}),!e_||e_==="null"?jsxRuntimeExports.jsx("div",{className:"header-before-login",children:jsxRuntimeExports.jsx("button",{onClick:t_,children:"Login"})}):jsxRuntimeExports.jsx("div",{className:"header-after-login",children:jsxRuntimeExports.jsxs(Dropdown$1,{children:[jsxRuntimeExports.jsx(Dropdown$1.Toggle,{id:"dropdown-basic",children:e_}),jsxRuntimeExports.jsxs(Dropdown$1.Menu,{children:[jsxRuntimeExports.jsx(Dropdown$1.Item,{children:jsxRuntimeExports.jsx("div",{className:"dropdown-options",onClick:()=>ba("/profile"),children:"Profile"})}),jsxRuntimeExports.jsx(Dropdown$1.Item,{className:"dropdown-options",onClick:o_,children:"Logout"})]})]})})]}),jsxRuntimeExports.jsx("div",{className:"home-container container",children:!e_||e_==="null"?jsxRuntimeExports.jsxs("div",{className:"home-app-intro",children:[jsxRuntimeExports.jsxs("h2",{children:[jsxRuntimeExports.jsx("b",{children:"Unleash Limitless Connections:"})," Redefine Your Gatherings with Cutting-Edge ",jsxRuntimeExports.jsx("b",{children:"Virtual Conferencing!"})]}),jsxRuntimeExports.jsxs("p",{children:["Transform your meetings using our state-of-the-art and future-forward video conferencing platform. Immerse yourself in seamless collaboration, pristine audio, and high-definition video, all at ",jsxRuntimeExports.jsx("b",{children:"absolutely no cost! "}),"Redefine your virtual communication and break free from limitations starting today!"]}),jsxRuntimeExports.jsx("button",{onClick:t_,children:"Join Now.."})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"home-app-intro",children:[jsxRuntimeExports.jsxs("span",{className:"welcome",children:["Welcome!! ",e_,","]}),jsxRuntimeExports.jsx("h2",{children:"Unleash Limitless Connections: Redefine Your Gatherings with Cutting-Edge Virtual Conferencing!"})]}),jsxRuntimeExports.jsxs("div",{className:"home-meet-container",children:[jsxRuntimeExports.jsxs("div",{className:"create-meet",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Name your meet...",onChange:w_=>o(w_.target.value)}),jsxRuntimeExports.jsxs("button",{"data-bs-toggle":"modal","data-bs-target":"#staticBackdrop",onClick:m_,children:[jsxRuntimeExports.jsx(RiVideoAddFill,{})," New meet"]})]}),jsxRuntimeExports.jsx("p",{children:"or"}),jsxRuntimeExports.jsxs("div",{className:"join-meet",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Enter code...",onChange:w_=>_n(w_.target.value)}),jsxRuntimeExports.jsxs("button",{onClick:b_,children:[" ",jsxRuntimeExports.jsx(CgEnter,{})," Join Meet"]})]}),jsxRuntimeExports.jsx("span",{children:_r})]}),jsxRuntimeExports.jsx("div",{className:"modal fade",id:"staticBackdrop","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true",children:jsxRuntimeExports.jsx("div",{className:"modal-dialog modal-dialog-centered",style:{width:"30vw"},children:jsxRuntimeExports.jsxs("div",{className:"modal-content",children:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h5",{className:"modal-title",id:"staticBackdropLabel",children:"Create New Meet"}),jsxRuntimeExports.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),jsxRuntimeExports.jsxs("div",{className:"modal-body",children:[jsxRuntimeExports.jsxs("div",{className:"form-floating mb-3",children:[jsxRuntimeExports.jsx("input",{type:"text",className:"form-control",id:"floatingInput",placeholder:"Name your meet",value:e,onChange:w_=>o(w_.target.value)}),jsxRuntimeExports.jsx("label",{htmlFor:"floatingInput",children:"Meet name"})]}),jsxRuntimeExports.jsxs("select",{className:"form-select","aria-label":"Default select example",value:_E,onChange:w_=>_v(w_.target.value),children:[jsxRuntimeExports.jsx("option",{disabled:!0,value:"",children:"Choose meet type"}),jsxRuntimeExports.jsx("option",{value:"instant",children:"Instant meet"}),jsxRuntimeExports.jsx("option",{value:"scheduled",children:"Schedule for later"})]}),_E==="scheduled"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{style:{margin:" 10px 0px 0px 0px",color:"rgb(2, 34, 58)"},children:"Meet Date: "}),jsxRuntimeExports.jsx("input",{type:"date",className:"form-control",onChange:w_=>a(w_.target.value)}),jsxRuntimeExports.jsx("p",{style:{margin:" 10px 0px 0px 0px",color:"rgb(2, 34, 58)"},children:"Meet Time: "}),jsxRuntimeExports.jsx("input",{type:"time",className:"form-control",onChange:w_=>$(w_.target.value)})]}):""]}),jsxRuntimeExports.jsxs("div",{className:"modal-footer",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"btn btn-primary",onClick:m_,"data-bs-dismiss":"modal",children:"Create meet"})]})]})})})]})})]}),jsxRuntimeExports.jsxs("div",{className:"about-app-container",children:[jsxRuntimeExports.jsx("div",{className:"box",children:jsxRuntimeExports.jsxs("div",{className:"box-inner",children:[jsxRuntimeExports.jsxs("div",{className:"box-front",children:[jsxRuntimeExports.jsx("h2",{children:"Connect Anytime, Anywhere!"}),jsxRuntimeExports.jsx("p",{children:"Embrace seamless connectivity and affordability with our video conference app. Whether it's work or socializing, our platform ensures effortless virtual meetings, fostering collaboration and global connections. Bid farewell to distance and welcome the ease of staying connected!"})]}),jsxRuntimeExports.jsxs("div",{className:"box-back",children:[jsxRuntimeExports.jsx("h2",{children:"Your Gateway to Effortless Communication!"}),jsxRuntimeExports.jsx("p",{children:"Experience the realm of effortless connectivity through our video conference app. Stay in touch with colleagues, friends, and family, regardless of their location. Say goodbye to costly travels and embrace affordable, hassle-free meetings that bring people together effortlessly."})]})]})}),jsxRuntimeExports.jsxs("div",{className:"about-cards",children:[jsxRuntimeExports.jsx(Card$1,{className:"about-card-body",children:jsxRuntimeExports.jsxs(Card$1.Body,{children:[jsxRuntimeExports.jsx(Card$1.Title,{className:"about-card-title",children:jsxRuntimeExports.jsxs("span",{children:[" ",jsxRuntimeExports.jsx(default_1$l,{})," "]})}),jsxRuntimeExports.jsx(Card$1.Text,{className:"about-card-text",children:"Easy Group Conference!! Bringing chaos to order, one virtual group hug at a time!"})]})}),jsxRuntimeExports.jsx(Card$1,{className:"about-card-body",children:jsxRuntimeExports.jsxs(Card$1.Body,{children:[jsxRuntimeExports.jsx(Card$1.Title,{className:"about-card-title",children:jsxRuntimeExports.jsxs("span",{children:[" ",jsxRuntimeExports.jsx(default_1$k,{})," "]})}),jsxRuntimeExports.jsx(Card$1.Text,{className:"about-card-text",children:"Schedule Meets Any Time!! Time is no longer the boss, you are!!"})]})}),jsxRuntimeExports.jsx(Card$1,{className:"about-card-body",children:jsxRuntimeExports.jsxs(Card$1.Body,{children:[jsxRuntimeExports.jsxs(Card$1.Title,{className:"about-card-title",children:[" ",jsxRuntimeExports.jsx("span",{style:{fontSize:"35px"},children:""})]}),jsxRuntimeExports.jsx(Card$1.Text,{className:"about-card-text",children:"Free of Cost!! Saving you moolah and keeping your pockets jolly. High fives for freebies!"})]})}),jsxRuntimeExports.jsx(Card$1,{className:"about-card-body",children:jsxRuntimeExports.jsxs(Card$1.Body,{children:[jsxRuntimeExports.jsx(Card$1.Title,{className:"about-card-title",children:jsxRuntimeExports.jsxs("span",{children:[" ",jsxRuntimeExports.jsx(default_1$j,{})," "]})}),jsxRuntimeExports.jsx(Card$1.Text,{className:"about-card-text",children:"Preserving valuable discussions and insights, enabling you to revisit and learn from every meeting."})]})}),jsxRuntimeExports.jsx(Card$1,{className:"about-card-body",children:jsxRuntimeExports.jsxs(Card$1.Body,{children:[jsxRuntimeExports.jsx(Card$1.Title,{className:"about-card-title",children:jsxRuntimeExports.jsxs("span",{children:[" ",jsxRuntimeExports.jsx(default_1$i,{})," "]})}),jsxRuntimeExports.jsx(Card$1.Text,{className:"about-card-text",children:"In-Meet Chat Feature!! Facilitating seamless communication within meetings, fostering real-time collaboration and engagement!!"})]})}),jsxRuntimeExports.jsx(Card$1,{className:"about-card-body",children:jsxRuntimeExports.jsxs(Card$1.Body,{children:[jsxRuntimeExports.jsx(Card$1.Title,{className:"about-card-title",children:jsxRuntimeExports.jsxs("span",{children:[" ",jsxRuntimeExports.jsx(default_1$h,{})," "]})}),jsxRuntimeExports.jsx(Card$1.Text,{className:"about-card-text",children:"Zooming through virtual space like a rocket-powered cheetah. Efficiently connecting dots, one meet at a time!"})]})})]})]}),jsxRuntimeExports.jsxs("div",{className:"footer",children:[jsxRuntimeExports.jsx("h2",{children:"Contact us @: "}),jsxRuntimeExports.jsxs("div",{className:"footer-social-media",children:[jsxRuntimeExports.jsx("a",{href:"https://your-google-link",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(default_1$g,{})}),jsxRuntimeExports.jsx("a",{href:"https://www.facebook.com/aziz.a.touma",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(default_1$f,{})}),jsxRuntimeExports.jsx("a",{href:"https://www.instagram.com/aziztouma/",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(default_1$e,{})}),jsxRuntimeExports.jsx("a",{href:"https://github.com/azizt24",target:"_blank",rel:"noopener noreferrer",children:jsxRuntimeExports.jsx(default_1$d,{})})]})]})]})},Login=()=>{const[e,o]=reactExports.useState(""),[s,a]=reactExports.useState(""),{login:_}=reactExports.useContext(AuthContext),$=async _e=>{_e.preventDefault(),await _({email:e,password:s})};return jsxRuntimeExports.jsxs("div",{className:"formContainer",children:[jsxRuntimeExports.jsx("div",{className:"smart-header",children:jsxRuntimeExports.jsx("div",{className:"smart-logo",children:jsxRuntimeExports.jsx("h2",{children:jsxRuntimeExports.jsx(Link,{id:"smart-logo-h2",to:"/",children:"Vision Link"})})})}),jsxRuntimeExports.jsxs("div",{className:"formWrapper",children:[jsxRuntimeExports.jsx("span",{className:"title",children:"Login"}),jsxRuntimeExports.jsxs("form",{children:[jsxRuntimeExports.jsxs("div",{className:"mb-3",children:[jsxRuntimeExports.jsx("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Email address"}),jsxRuntimeExports.jsx("input",{type:"email",className:"form-control",id:"exampleInputEmail1","aria-describedby":"emailHelp",onChange:_e=>o(_e.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"mb-3",children:[jsxRuntimeExports.jsx("label",{htmlFor:"exampleInputPassword1",className:"form-label",children:"Password"}),jsxRuntimeExports.jsx("input",{type:"password",className:"form-control",id:"exampleInputPassword1",onChange:_e=>a(_e.target.value)})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"btn btn-primary",onClick:$,children:"Login"})]}),jsxRuntimeExports.jsxs("p",{children:["Not registered? ",jsxRuntimeExports.jsx(Link,{to:"/register",children:"Register now!"})]})]})]})},Register=()=>{const[e,o]=reactExports.useState(""),[s,a]=reactExports.useState(""),[_,$]=reactExports.useState(""),{register:_e}=reactExports.useContext(AuthContext),_n=async _r=>{_r.preventDefault(),await _e({username:e,email:s,password:_})};return jsxRuntimeExports.jsxs("div",{className:"formContainer",children:[jsxRuntimeExports.jsx("div",{className:"smart-header",children:jsxRuntimeExports.jsx("div",{className:"smart-logo",children:jsxRuntimeExports.jsx("h2",{children:jsxRuntimeExports.jsx(Link,{id:"smart-logo-h2",to:"/",children:"Vision Link"})})})}),jsxRuntimeExports.jsxs("div",{className:"formWrapper",children:[jsxRuntimeExports.jsx("span",{className:"title",children:"Register"}),jsxRuntimeExports.jsxs("form",{children:[jsxRuntimeExports.jsxs("div",{className:"mb-3",children:[jsxRuntimeExports.jsx("label",{htmlFor:"exampleInputName",className:"form-label",children:"Username"}),jsxRuntimeExports.jsx("input",{type:"text",className:"form-control",id:"exampleInputName",onChange:_r=>o(_r.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"mb-3",children:[jsxRuntimeExports.jsx("label",{htmlFor:"exampleInputEmail1",className:"form-label",children:"Email address"}),jsxRuntimeExports.jsx("input",{type:"email",className:"form-control",id:"exampleInputEmail1","aria-describedby":"emailHelp",onChange:_r=>a(_r.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"mb-3",children:[jsxRuntimeExports.jsx("label",{htmlFor:"exampleInputPassword1",className:"form-label",children:"Password"}),jsxRuntimeExports.jsx("input",{type:"password",className:"form-control",id:"exampleInputPassword1",onChange:_r=>$(_r.target.value)})]}),jsxRuntimeExports.jsx("button",{type:"submit",className:"btn btn-primary",onClick:_n,children:"Register"})]}),jsxRuntimeExports.jsxs("p",{children:["Already registered? ",jsxRuntimeExports.jsx(Link,{to:"/login",children:"Login"})]})]})]})};function Video(e){const{users:o,tracks:s,participants:a}=reactExports.useContext(SocketContext);return jsxRuntimeExports.jsxs("div",{className:"videoPlayer-page",children:[jsxRuntimeExports.jsxs("div",{className:"videoplayer-video",style:o.length<1?{height:"72vh",width:"60vw"}:o.length===1?{height:"65vh",width:"45vw"}:{},children:[jsxRuntimeExports.jsx(AgoraVideoPlayer,{id:"video",style:o.length<1?{height:"71vh",width:"60vw"}:o.length===1?{height:"64vh",width:"45vw"}:{},videoTrack:s[1]}),jsxRuntimeExports.jsx("p",{children:"You"})]}),o.length>0&&o.map(_=>_.videoTrack?jsxRuntimeExports.jsxs("div",{className:"videoplayer-video",style:o.length===1?{height:"65vh",width:"45vw"}:{},children:[jsxRuntimeExports.jsx(AgoraVideoPlayer,{id:"video",videoTrack:_.videoTrack,style:o.length===1?{height:"64vh",width:"45vw"}:{}},_.uid),jsxRuntimeExports.jsx("p",{children:a[_.uid]})]},_.uid):null)]})}function isHostComponent(e){return typeof e=="string"}function appendOwnerState(e,o,s){return e===void 0||isHostComponent(e)?o:_extends$3({},o,{ownerState:_extends$3({},o.ownerState,s)})}const defaultContextValue={disableDefaultClasses:!1},ClassNameConfiguratorContext=reactExports.createContext(defaultContextValue);function useClassNamesOverride(e){const{disableDefaultClasses:o}=reactExports.useContext(ClassNameConfiguratorContext);return s=>o?"":e(s)}function extractEventHandlers(e,o=[]){if(e===void 0)return{};const s={};return Object.keys(e).filter(a=>a.match(/^on[A-Z]/)&&typeof e[a]=="function"&&!o.includes(a)).forEach(a=>{s[a]=e[a]}),s}function resolveComponentProps(e,o,s){return typeof e=="function"?e(o,s):e}function omitEventHandlers(e){if(e===void 0)return{};const o={};return Object.keys(e).filter(s=>!(s.match(/^on[A-Z]/)&&typeof e[s]=="function")).forEach(s=>{o[s]=e[s]}),o}function mergeSlotProps(e){const{getSlotProps:o,additionalProps:s,externalSlotProps:a,externalForwardedProps:_,className:$}=e;if(!o){const _f=clsx(s==null?void 0:s.className,$,_==null?void 0:_.className,a==null?void 0:a.className),_E=_extends$3({},s==null?void 0:s.style,_==null?void 0:_.style,a==null?void 0:a.style),_v=_extends$3({},s,_,a);return _f.length>0&&(_v.className=_f),Object.keys(_E).length>0&&(_v.style=_E),{props:_v,internalRef:void 0}}const _e=extractEventHandlers(_extends$3({},_,a)),_n=omitEventHandlers(a),_r=omitEventHandlers(_),_s=o(_e),na=clsx(_s==null?void 0:_s.className,s==null?void 0:s.className,$,_==null?void 0:_.className,a==null?void 0:a.className),ba=_extends$3({},_s==null?void 0:_s.style,s==null?void 0:s.style,_==null?void 0:_.style,a==null?void 0:a.style),_p=_extends$3({},_s,s,_r,_n);return na.length>0&&(_p.className=na),Object.keys(ba).length>0&&(_p.style=ba),{props:_p,internalRef:_s.ref}}const _excluded$5=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function useSlotProps(e){var o;const{elementType:s,externalSlotProps:a,ownerState:_,skipResolvingSlotProps:$=!1}=e,_e=_objectWithoutPropertiesLoose$7(e,_excluded$5),_n=$?{}:resolveComponentProps(a,_),{props:_r,internalRef:_s}=mergeSlotProps(_extends$3({},_e,{externalSlotProps:_n})),na=useForkRef(_s,_n==null?void 0:_n.ref,(o=e.additionalProps)==null?void 0:o.ref);return appendOwnerState(s,_extends$3({},_r,{ref:na}),_)}function getButtonUtilityClass(e){return generateUtilityClass("MuiButton",e)}generateUtilityClasses("MuiButton",["root","active","disabled","focusVisible"]);function useButton(e={}){const{disabled:o=!1,focusableWhenDisabled:s,href:a,rootRef:_,tabIndex:$,to:_e,type:_n}=e,_r=reactExports.useRef(),[_s,na]=reactExports.useState(!1),{isFocusVisibleRef:ba,onFocus:_p,onBlur:_f,ref:_E}=useIsFocusVisible(),[_v,n_]=reactExports.useState(!1);o&&!s&&_v&&n_(!1),reactExports.useEffect(()=>{ba.current=_v},[_v,ba]);const[e_,t_]=reactExports.useState(""),o_=R_=>I_=>{var U_;_v&&I_.preventDefault(),(U_=R_.onMouseLeave)==null||U_.call(R_,I_)},m_=R_=>I_=>{var U_;_f(I_),ba.current===!1&&n_(!1),(U_=R_.onBlur)==null||U_.call(R_,I_)},b_=R_=>I_=>{var U_;if(_r.current||(_r.current=I_.currentTarget),_p(I_),ba.current===!0){var D_;n_(!0),(D_=R_.onFocusVisible)==null||D_.call(R_,I_)}(U_=R_.onFocus)==null||U_.call(R_,I_)},w_=()=>{const R_=_r.current;return e_==="BUTTON"||e_==="INPUT"&&["button","submit","reset"].includes(R_==null?void 0:R_.type)||e_==="A"&&(R_==null?void 0:R_.href)},y_=R_=>I_=>{if(!o){var U_;(U_=R_.onClick)==null||U_.call(R_,I_)}},N_=R_=>I_=>{var U_;o||(na(!0),document.addEventListener("mouseup",()=>{na(!1)},{once:!0})),(U_=R_.onMouseDown)==null||U_.call(R_,I_)},_y=R_=>I_=>{var U_;if((U_=R_.onKeyDown)==null||U_.call(R_,I_),!I_.defaultMuiPrevented&&(I_.target===I_.currentTarget&&!w_()&&I_.key===" "&&I_.preventDefault(),I_.target===I_.currentTarget&&I_.key===" "&&!o&&na(!0),I_.target===I_.currentTarget&&!w_()&&I_.key==="Enter"&&!o)){var D_;(D_=R_.onClick)==null||D_.call(R_,I_),I_.preventDefault()}},v_=R_=>I_=>{var U_;if(I_.target===I_.currentTarget&&na(!1),(U_=R_.onKeyUp)==null||U_.call(R_,I_),I_.target===I_.currentTarget&&!w_()&&!o&&I_.key===" "&&!I_.defaultMuiPrevented){var D_;(D_=R_.onClick)==null||D_.call(R_,I_)}},A_=reactExports.useCallback(R_=>{var I_;t_((I_=R_==null?void 0:R_.tagName)!=null?I_:"")},[]),k_=useForkRef(A_,_,_E,_r),P_={};return $!==void 0&&(P_.tabIndex=$),e_==="BUTTON"?(P_.type=_n??"button",s?P_["aria-disabled"]=o:P_.disabled=o):e_!==""&&(!a&&!_e&&(P_.role="button",P_.tabIndex=$??0),o&&(P_["aria-disabled"]=o,P_.tabIndex=s?$??0:-1)),{getRootProps:(R_={})=>{const I_=_extends$3({},extractEventHandlers(e),extractEventHandlers(R_)),U_=_extends$3({type:_n},I_,P_,R_,{onBlur:m_(I_),onClick:y_(I_),onFocus:b_(I_),onKeyDown:_y(I_),onKeyUp:v_(I_),onMouseDown:N_(I_),onMouseLeave:o_(I_),ref:k_});return delete U_.onFocusVisible,U_},focusVisible:_v,setFocusVisible:n_,active:_s,rootRef:k_}}const _excluded$4=["action","children","disabled","focusableWhenDisabled","onFocusVisible","slotProps","slots"],useUtilityClasses$2=e=>{const{active:o,disabled:s,focusVisible:a}=e;return composeClasses({root:["root",s&&"disabled",a&&"focusVisible",o&&"active"]},useClassNamesOverride(getButtonUtilityClass))},Button=reactExports.forwardRef(function e(o,s){var a;const{action:_,children:$,focusableWhenDisabled:_e=!1,slotProps:_n={},slots:_r={}}=o,_s=_objectWithoutPropertiesLoose$7(o,_excluded$4),na=reactExports.useRef(),{active:ba,focusVisible:_p,setFocusVisible:_f,getRootProps:_E}=useButton(_extends$3({},o,{focusableWhenDisabled:_e}));reactExports.useImperativeHandle(_,()=>({focusVisible:()=>{_f(!0),na.current.focus()}}),[_f]);const _v=_extends$3({},o,{active:ba,focusableWhenDisabled:_e,focusVisible:_p}),n_=useUtilityClasses$2(_v),e_=_s.href||_s.to?"a":"button",t_=(a=_r.root)!=null?a:e_,o_=useSlotProps({elementType:t_,getSlotProps:_E,externalForwardedProps:_s,externalSlotProps:_n.root,additionalProps:{ref:s},ownerState:_v,className:n_.root});return jsxRuntimeExports.jsx(t_,_extends$3({},o_,{children:$}))});function applyStyles(e){var o=e.state;Object.keys(o.elements).forEach(function(s){var a=o.styles[s]||{},_=o.attributes[s]||{},$=o.elements[s];!isHTMLElement$1($)||!getNodeName($)||(Object.assign($.style,a),Object.keys(_).forEach(function(_e){var _n=_[_e];_n===!1?$.removeAttribute(_e):$.setAttribute(_e,_n===!0?"":_n)}))})}function effect(e){var o=e.state,s={popper:{position:o.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(o.elements.popper.style,s.popper),o.styles=s,o.elements.arrow&&Object.assign(o.elements.arrow.style,s.arrow),function(){Object.keys(o.elements).forEach(function(a){var _=o.elements[a],$=o.attributes[a]||{},_e=Object.keys(o.styles.hasOwnProperty(a)?o.styles[a]:s[a]),_n=_e.reduce(function(_r,_s){return _r[_s]="",_r},{});!isHTMLElement$1(_)||!getNodeName(_)||(Object.assign(_.style,_n),Object.keys($).forEach(function(_r){_.removeAttribute(_r)}))})}}const applyStyles$1={name:"applyStyles",enabled:!0,phase:"write",fn:applyStyles,effect,requires:["computeStyles"]};var defaultModifiers=[eventListeners,popperOffsets$1,computeStyles$1,applyStyles$1,offset$1,flip$1,preventOverflow$1,arrow$1,hide$1],createPopper=popperGenerator({defaultModifiers});function getContainer(e){return typeof e=="function"?e():e}const Portal=reactExports.forwardRef(function e(o,s){const{children:a,container:_,disablePortal:$=!1}=o,[_e,_n]=reactExports.useState(null),_r=useForkRef(reactExports.isValidElement(a)?a.ref:null,s);if(useEnhancedEffect$1(()=>{$||_n(getContainer(_)||document.body)},[_,$]),useEnhancedEffect$1(()=>{if(_e&&!$)return setRef(s,_e),()=>{setRef(s,null)}},[s,_e,$]),$){if(reactExports.isValidElement(a)){const _s={ref:_r};return reactExports.cloneElement(a,_s)}return jsxRuntimeExports.jsx(reactExports.Fragment,{children:a})}return jsxRuntimeExports.jsx(reactExports.Fragment,{children:_e&&reactDomExports.createPortal(a,_e)})});function getPopperUtilityClass(e){return generateUtilityClass("MuiPopper",e)}generateUtilityClasses("MuiPopper",["root"]);const _excluded$3=["anchorEl","children","direction","disablePortal","modifiers","open","placement","popperOptions","popperRef","slotProps","slots","TransitionProps","ownerState"],_excluded2=["anchorEl","children","container","direction","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition","slotProps","slots"];function flipPlacement(e,o){if(o==="ltr")return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function resolveAnchorEl(e){return typeof e=="function"?e():e}function isHTMLElement(e){return e.nodeType!==void 0}const useUtilityClasses$1=()=>composeClasses({root:["root"]},useClassNamesOverride(getPopperUtilityClass)),defaultPopperOptions={},PopperTooltip=reactExports.forwardRef(function e(o,s){var a;const{anchorEl:_,children:$,direction:_e,disablePortal:_n,modifiers:_r,open:_s,placement:na,popperOptions:ba,popperRef:_p,slotProps:_f={},slots:_E={},TransitionProps:_v}=o,n_=_objectWithoutPropertiesLoose$7(o,_excluded$3),e_=reactExports.useRef(null),t_=useForkRef(e_,s),o_=reactExports.useRef(null),m_=useForkRef(o_,_p),b_=reactExports.useRef(m_);useEnhancedEffect$1(()=>{b_.current=m_},[m_]),reactExports.useImperativeHandle(_p,()=>o_.current,[]);const w_=flipPlacement(na,_e),[y_,N_]=reactExports.useState(w_),[_y,v_]=reactExports.useState(resolveAnchorEl(_));reactExports.useEffect(()=>{o_.current&&o_.current.forceUpdate()}),reactExports.useEffect(()=>{_&&v_(resolveAnchorEl(_))},[_]),useEnhancedEffect$1(()=>{if(!_y||!_s)return;const R_=D_=>{N_(D_.placement)};let I_=[{name:"preventOverflow",options:{altBoundary:_n}},{name:"flip",options:{altBoundary:_n}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:D_})=>{R_(D_)}}];_r!=null&&(I_=I_.concat(_r)),ba&&ba.modifiers!=null&&(I_=I_.concat(ba.modifiers));const U_=createPopper(_y,e_.current,_extends$3({placement:w_},ba,{modifiers:I_}));return b_.current(U_),()=>{U_.destroy(),b_.current(null)}},[_y,_n,_r,_s,ba,w_]);const A_={placement:y_};_v!==null&&(A_.TransitionProps=_v);const k_=useUtilityClasses$1(),P_=(a=_E.root)!=null?a:"div",T_=useSlotProps({elementType:P_,externalSlotProps:_f.root,externalForwardedProps:n_,additionalProps:{role:"tooltip",ref:t_},ownerState:o,className:k_.root});return jsxRuntimeExports.jsx(P_,_extends$3({},T_,{children:typeof $=="function"?$(A_):$}))}),Popper$2=reactExports.forwardRef(function e(o,s){const{anchorEl:a,children:_,container:$,direction:_e="ltr",disablePortal:_n=!1,keepMounted:_r=!1,modifiers:_s,open:na,placement:ba="bottom",popperOptions:_p=defaultPopperOptions,popperRef:_f,style:_E,transition:_v=!1,slotProps:n_={},slots:e_={}}=o,t_=_objectWithoutPropertiesLoose$7(o,_excluded2),[o_,m_]=reactExports.useState(!0),b_=()=>{m_(!1)},w_=()=>{m_(!0)};if(!_r&&!na&&(!_v||o_))return null;let y_;if($)y_=$;else if(a){const v_=resolveAnchorEl(a);y_=v_&&isHTMLElement(v_)?ownerDocument(v_).body:ownerDocument(null).body}const N_=!na&&_r&&(!_v||o_)?"none":void 0,_y=_v?{in:na,onEnter:b_,onExited:w_}:void 0;return jsxRuntimeExports.jsx(Portal,{disablePortal:_n,container:y_,children:jsxRuntimeExports.jsx(PopperTooltip,_extends$3({anchorEl:a,direction:_e,disablePortal:_n,modifiers:_s,ref:s,open:_v?!o_:na,placement:ba,popperOptions:_p,popperRef:_f,slotProps:n_,slots:e_},t_,{style:_extends$3({position:"fixed",top:0,left:0,display:N_},_E),TransitionProps:_y,children:_}))})});var Mic={},_interopRequireDefault$c=interopRequireDefaultExports;Object.defineProperty(Mic,"__esModule",{value:!0});var default_1$c=Mic.default=void 0,_createSvgIcon$c=_interopRequireDefault$c(requireCreateSvgIcon()),_jsxRuntime$c=jsxRuntimeExports,_default$c=(0,_createSvgIcon$c.default)((0,_jsxRuntime$c.jsx)("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"}),"Mic");default_1$c=Mic.default=_default$c;var MicOff={},_interopRequireDefault$b=interopRequireDefaultExports;Object.defineProperty(MicOff,"__esModule",{value:!0});var default_1$b=MicOff.default=void 0,_createSvgIcon$b=_interopRequireDefault$b(requireCreateSvgIcon()),_jsxRuntime$b=jsxRuntimeExports,_default$b=(0,_createSvgIcon$b.default)((0,_jsxRuntime$b.jsx)("path",{d:"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3 3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z"}),"MicOff");default_1$b=MicOff.default=_default$b;var Videocam={},_interopRequireDefault$a=interopRequireDefaultExports;Object.defineProperty(Videocam,"__esModule",{value:!0});var default_1$a=Videocam.default=void 0,_createSvgIcon$a=_interopRequireDefault$a(requireCreateSvgIcon()),_jsxRuntime$a=jsxRuntimeExports,_default$a=(0,_createSvgIcon$a.default)((0,_jsxRuntime$a.jsx)("path",{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"}),"Videocam");default_1$a=Videocam.default=_default$a;var VideocamOff={},_interopRequireDefault$9=interopRequireDefaultExports;Object.defineProperty(VideocamOff,"__esModule",{value:!0});var default_1$9=VideocamOff.default=void 0,_createSvgIcon$9=_interopRequireDefault$9(requireCreateSvgIcon()),_jsxRuntime$9=jsxRuntimeExports,_default$9=(0,_createSvgIcon$9.default)((0,_jsxRuntime$9.jsx)("path",{d:"m21 6.5-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2 2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z"}),"VideocamOff");default_1$9=VideocamOff.default=_default$9;var Logout={},_interopRequireDefault$8=interopRequireDefaultExports;Object.defineProperty(Logout,"__esModule",{value:!0});var default_1$8=Logout.default=void 0,_createSvgIcon$8=_interopRequireDefault$8(requireCreateSvgIcon()),_jsxRuntime$8=jsxRuntimeExports,_default$8=(0,_createSvgIcon$8.default)((0,_jsxRuntime$8.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"}),"Logout");default_1$8=Logout.default=_default$8;var PresentToAll={},_interopRequireDefault$7=interopRequireDefaultExports;Object.defineProperty(PresentToAll,"__esModule",{value:!0});var default_1$7=PresentToAll.default=void 0,_createSvgIcon$7=_interopRequireDefault$7(requireCreateSvgIcon()),_jsxRuntime$7=jsxRuntimeExports,_default$7=(0,_createSvgIcon$7.default)((0,_jsxRuntime$7.jsx)("path",{d:"M21 3H3c-1.11 0-2 .89-2 2v14c0 1.11.89 2 2 2h18c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2zm0 16.02H3V4.98h18v14.04zM10 12H8l4-4 4 4h-2v4h-4v-4z"}),"PresentToAll");default_1$7=PresentToAll.default=_default$7;var StopScreenShare={},_interopRequireDefault$6=interopRequireDefaultExports;Object.defineProperty(StopScreenShare,"__esModule",{value:!0});var default_1$6=StopScreenShare.default=void 0,_createSvgIcon$6=_interopRequireDefault$6(requireCreateSvgIcon()),_jsxRuntime$6=jsxRuntimeExports,_default$6=(0,_createSvgIcon$6.default)((0,_jsxRuntime$6.jsx)("path",{d:"m21.22 18.02 2 2H24v-2h-2.78zm.77-2 .01-10c0-1.11-.9-2-2-2H7.22l5.23 5.23c.18-.04.36-.07.55-.1V7.02l4 3.73-1.58 1.47 5.54 5.54c.61-.33 1.03-.99 1.03-1.74zM2.39 1.73 1.11 3l1.54 1.54c-.4.36-.65.89-.65 1.48v10c0 1.1.89 2 2 2H0v2h18.13l2.71 2.71 1.27-1.27L2.39 1.73zM7 15.02c.31-1.48.92-2.95 2.07-4.06l1.59 1.59c-1.54.38-2.7 1.18-3.66 2.47z"}),"StopScreenShare");default_1$6=StopScreenShare.default=_default$6;var Forum={},_interopRequireDefault$5=interopRequireDefaultExports;Object.defineProperty(Forum,"__esModule",{value:!0});var default_1$5=Forum.default=void 0,_createSvgIcon$5=_interopRequireDefault$5(requireCreateSvgIcon()),_jsxRuntime$5=jsxRuntimeExports,_default$5=(0,_createSvgIcon$5.default)((0,_jsxRuntime$5.jsx)("path",{d:"M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1zm-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1z"}),"Forum");default_1$5=Forum.default=_default$5;var Person={},_interopRequireDefault$4=interopRequireDefaultExports;Object.defineProperty(Person,"__esModule",{value:!0});var default_1$4=Person.default=void 0,_createSvgIcon$4=_interopRequireDefault$4(requireCreateSvgIcon()),_jsxRuntime$4=jsxRuntimeExports,_default$4=(0,_createSvgIcon$4.default)((0,_jsxRuntime$4.jsx)("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");default_1$4=Person.default=_default$4;var CloudDownload={},_interopRequireDefault$3=interopRequireDefaultExports;Object.defineProperty(CloudDownload,"__esModule",{value:!0});var default_1$3=CloudDownload.default=void 0,_createSvgIcon$3=_interopRequireDefault$3(requireCreateSvgIcon()),_jsxRuntime$3=jsxRuntimeExports,_default$3=(0,_createSvgIcon$3.default)((0,_jsxRuntime$3.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"}),"CloudDownload");default_1$3=CloudDownload.default=_default$3;var RadioButtonChecked={},_interopRequireDefault$2=interopRequireDefaultExports;Object.defineProperty(RadioButtonChecked,"__esModule",{value:!0});var default_1$2=RadioButtonChecked.default=void 0,_createSvgIcon$2=_interopRequireDefault$2(requireCreateSvgIcon()),_jsxRuntime$2=jsxRuntimeExports,_default$2=(0,_createSvgIcon$2.default)((0,_jsxRuntime$2.jsx)("path",{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"RadioButtonChecked");default_1$2=RadioButtonChecked.default=_default$2;var RecordRTC$1={exports:{}};(function(e){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function o(a_,s_){if(!a_)throw"First parameter is required.";s_=s_||{type:"video"},s_=new s(a_,s_);var S_=this;function V_(J_){return s_.disableLogs||console.log("RecordRTC version: ",S_.version),J_&&(s_=new s(a_,J_)),s_.disableLogs||console.log("started recording "+s_.type+" stream."),s0?(s0.clearRecordedData(),s0.record(),m0("recording"),S_.recordingDuration&&d0(),S_):(W_(function(){S_.recordingDuration&&d0()}),S_)}function W_(J_){J_&&(s_.initCallback=function(){J_(),J_=s_.initCallback=null});var g0=new a(a_,s_);s0=new g0(a_,s_),s0.record(),m0("recording"),s_.disableLogs||console.log("Initialized recorderType:",s0.constructor.name,"for output-type:",s_.type)}function Y_(J_){if(J_=J_||function(){},!s0){u0();return}if(S_.state==="paused"){S_.resumeRecording(),setTimeout(function(){Y_(J_)},1);return}S_.state!=="recording"&&!s_.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',S_.state),s_.disableLogs||console.log("Stopped recording "+s_.type+" stream."),s_.type!=="gif"?s0.stop(g0):(s0.stop(),g0()),m0("stopped");function g0(A0){if(!s0){typeof J_.call=="function"?J_.call(S_,""):J_("");return}Object.keys(s0).forEach(function(w0){typeof s0[w0]!="function"&&(S_[w0]=s0[w0])});var j_=s0.blob;if(!j_)if(A0)s0.blob=j_=A0;else throw"Recording failed.";if(j_&&!s_.disableLogs&&console.log(j_.type,"->",e_(j_.size)),J_){var o0;try{o0=na.createObjectURL(j_)}catch{}typeof J_.call=="function"?J_.call(S_,o0):J_(o0)}s_.autoWriteToDisk&&E0(function(w0){var k0={};k0[s_.type+"Blob"]=w0,T_.Store(k0)})}}function e0(){if(!s0){u0();return}if(S_.state!=="recording"){s_.disableLogs||console.warn("Unable to pause the recording. Recording state: ",S_.state);return}m0("paused"),s0.pause(),s_.disableLogs||console.log("Paused recording.")}function F_(){if(!s0){u0();return}if(S_.state!=="paused"){s_.disableLogs||console.warn("Unable to resume the recording. Recording state: ",S_.state);return}m0("recording"),s0.resume(),s_.disableLogs||console.log("Resumed recording.")}function H_(J_){postMessage(new FileReaderSync().readAsDataURL(J_))}function E0(J_,g0){if(!J_)throw"Pass a callback function over getDataURL.";var A0=g0?g0.blob:(s0||{}).blob;if(!A0){s_.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){E0(J_,g0)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var j_=w0(H_);j_.onmessage=function(k0){J_(k0.data)},j_.postMessage(A0)}else{var o0=new FileReader;o0.readAsDataURL(A0),o0.onload=function(k0){J_(k0.target.result)}}function w0(k0){try{var H0=na.createObjectURL(new Blob([k0.toString(),"this.onmessage =  function (eee) {"+k0.name+"(eee.data);}"],{type:"application/javascript"})),U0=new Worker(H0);return na.revokeObjectURL(H0),U0}catch{}}}function d0(J_){if(J_=J_||0,S_.state==="paused"){setTimeout(function(){d0(J_)},1e3);return}if(S_.state!=="stopped"){if(J_>=S_.recordingDuration){Y_(S_.onRecordingStopped);return}J_+=1e3,setTimeout(function(){d0(J_)},1e3)}}function m0(J_){S_&&(S_.state=J_,typeof S_.onStateChanged.call=="function"?S_.onStateChanged.call(S_,J_):S_.onStateChanged(J_))}var v0='It seems that recorder is destroyed or "startRecording" is not invoked for '+s_.type+" recorder.";function u0(){s_.disableLogs!==!0&&console.warn(v0)}var s0,T0={startRecording:V_,stopRecording:Y_,pauseRecording:e0,resumeRecording:F_,initRecorder:W_,setRecordingDuration:function(J_,g0){if(typeof J_>"u")throw"recordingDuration is required.";if(typeof J_!="number")throw"recordingDuration must be a number.";return S_.recordingDuration=J_,S_.onRecordingStopped=g0||function(){},{onRecordingStopped:function(A0){S_.onRecordingStopped=A0}}},clearRecordedData:function(){if(!s0){u0();return}s0.clearRecordedData(),s_.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!s0){u0();return}return s0.blob},getDataURL:E0,toURL:function(){if(!s0){u0();return}return na.createObjectURL(s0.blob)},getInternalRecorder:function(){return s0},save:function(J_){if(!s0){u0();return}t_(s0.blob,J_)},getFromDisk:function(J_){if(!s0){u0();return}o.getFromDisk(s_.type,J_)},setAdvertisementArray:function(J_){s_.advertisement=[];for(var g0=J_.length,A0=0;A0<g0;A0++)s_.advertisement.push({duration:A0,image:J_[A0]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){S_.state==="recording"&&!s_.disableLogs&&console.warn("Stop an active recorder."),s0&&typeof s0.clearRecordedData=="function"&&s0.clearRecordedData(),s0=null,m0("inactive"),S_.blob=null},onStateChanged:function(J_){s_.disableLogs||console.log("Recorder state changed:",J_)},state:"inactive",getState:function(){return S_.state},destroy:function(){var J_=s_.disableLogs;s_={disableLogs:!0},S_.reset(),m0("destroyed"),T0=S_=null,y_.AudioContextConstructor&&(y_.AudioContextConstructor.close(),y_.AudioContextConstructor=null),s_.disableLogs=J_,s_.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return S_=T0,T0;for(var j0 in T0)this[j0]=T0[j0];return S_=this,T0}o.version="5.6.2",e.exports=o,o.getFromDisk=function(a_,s_){if(!s_)throw"callback is mandatory.";console.log("Getting recorded "+(a_==="all"?"blobs":a_+" blob ")+" from disk!"),T_.Fetch(function(S_,V_){a_!=="all"&&V_===a_+"Blob"&&s_&&s_(S_),a_==="all"&&s_&&s_(S_,V_.replace("Blob",""))})},o.writeToDisk=function(a_){console.log("Writing recorded blob(s) to disk!"),a_=a_||{},a_.audio&&a_.video&&a_.gif?a_.audio.getDataURL(function(s_){a_.video.getDataURL(function(S_){a_.gif.getDataURL(function(V_){T_.Store({audioBlob:s_,videoBlob:S_,gifBlob:V_})})})}):a_.audio&&a_.video?a_.audio.getDataURL(function(s_){a_.video.getDataURL(function(S_){T_.Store({audioBlob:s_,videoBlob:S_})})}):a_.audio&&a_.gif?a_.audio.getDataURL(function(s_){a_.gif.getDataURL(function(S_){T_.Store({audioBlob:s_,gifBlob:S_})})}):a_.video&&a_.gif?a_.video.getDataURL(function(s_){a_.gif.getDataURL(function(S_){T_.Store({videoBlob:s_,gifBlob:S_})})}):a_.audio?a_.audio.getDataURL(function(s_){T_.Store({audioBlob:s_})}):a_.video?a_.video.getDataURL(function(s_){T_.Store({videoBlob:s_})}):a_.gif&&a_.gif.getDataURL(function(s_){T_.Store({gifBlob:s_})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function s(a_,s_){return!s_.recorderType&&!s_.type&&(s_.audio&&s_.video?s_.type="video":s_.audio&&!s_.video&&(s_.type="audio")),s_.recorderType&&!s_.type&&(s_.recorderType===k_||s_.recorderType===A_||typeof n0<"u"&&s_.recorderType===n0?s_.type="video":s_.recorderType===R_?s_.type="gif":s_.recorderType===v_?s_.type="audio":s_.recorderType===_y&&(m_(a_,"audio").length&&m_(a_,"video").length||!m_(a_,"audio").length&&m_(a_,"video").length?s_.type="video":m_(a_,"audio").length&&!m_(a_,"video").length&&(s_.type="audio"))),typeof _y<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(s_.mimeType||(s_.mimeType="video/webm"),s_.type||(s_.type=s_.mimeType.split("/")[0]),s_.bitsPerSecond),s_.type||(s_.mimeType&&(s_.type=s_.mimeType.split("/")[0]),s_.type||(s_.type="audio")),s_}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function a(a_,s_){var S_;return(_E||ba||_p)&&(S_=v_),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!_E&&(S_=_y),s_.type==="video"&&(_E||_p)&&(S_=k_,typeof n0<"u"&&typeof ReadableStream<"u"&&(S_=n0)),s_.type==="gif"&&(S_=R_),s_.type==="canvas"&&(S_=A_),N_()&&S_!==A_&&S_!==R_&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(m_(a_,"video").length||m_(a_,"audio").length)&&(s_.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(S_=_y):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(S_=_y)),a_ instanceof Array&&a_.length&&(S_=U_),s_.recorderType&&(S_=s_.recorderType),!s_.disableLogs&&S_&&S_.name&&console.log("Using recorderType:",S_.name||S_.constructor.name),!S_&&_v&&(S_=_y),S_}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function _(a_){this.addStream=function(s_){s_&&(a_=s_)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var s_=this.mediaType,S_,V_=this.mimeType||{audio:null,video:null,gif:null};if(typeof s_.audio!="function"&&N_()&&!m_(a_,"audio").length&&(s_.audio=!1),typeof s_.video!="function"&&N_()&&!m_(a_,"video").length&&(s_.video=!1),typeof s_.gif!="function"&&N_()&&!m_(a_,"video").length&&(s_.gif=!1),!s_.audio&&!s_.video&&!s_.gif)throw"MediaStream must have either audio or video tracks.";if(s_.audio&&(S_=null,typeof s_.audio=="function"&&(S_=s_.audio),this.audioRecorder=new o(a_,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:S_,mimeType:V_.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),s_.video||this.audioRecorder.startRecording()),s_.video){S_=null,typeof s_.video=="function"&&(S_=s_.video);var W_=a_;if(N_()&&s_.audio&&typeof s_.audio=="function"){var Y_=m_(a_,"video")[0];_f?(W_=new n_,W_.addTrack(Y_),S_&&S_===k_&&(S_=_y)):(W_=new n_,W_.addTrack(Y_))}this.videoRecorder=new o(W_,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:S_,mimeType:V_.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),s_.audio||this.videoRecorder.startRecording()}if(s_.audio&&s_.video){var e0=this,F_=N_()===!0;(s_.audio instanceof v_&&s_.video||s_.audio!==!0&&s_.video!==!0&&s_.audio!==s_.video)&&(F_=!1),F_===!0?(e0.audioRecorder=null,e0.videoRecorder.startRecording()):e0.videoRecorder.initRecorder(function(){e0.audioRecorder.initRecorder(function(){e0.videoRecorder.startRecording(),e0.audioRecorder.startRecording()})})}s_.gif&&(S_=null,typeof s_.gif=="function"&&(S_=s_.gif),this.gifRecorder=new o(a_,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:S_,mimeType:V_.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(s_){s_=s_||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(S_){s_(S_,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(S_){s_(S_,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(S_){s_(S_,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(s_){var S_={};return this.audioRecorder&&(S_.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(S_.video=this.videoRecorder.getBlob()),this.gifRecorder&&(S_.gif=this.gifRecorder.getBlob()),s_&&s_(S_),S_},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(s_){this.getBlob(function(W_){W_.audio&&W_.video?S_(W_.audio,function(Y_){S_(W_.video,function(e0){s_({audio:Y_,video:e0})})}):W_.audio?S_(W_.audio,function(Y_){s_({audio:Y_})}):W_.video&&S_(W_.video,function(Y_){s_({video:Y_})})});function S_(W_,Y_){if(typeof Worker<"u"){var e0=V_(function(E0){postMessage(new FileReaderSync().readAsDataURL(E0))});e0.onmessage=function(H_){Y_(H_.data)},e0.postMessage(W_)}else{var F_=new FileReader;F_.readAsDataURL(W_),F_.onload=function(H_){Y_(H_.target.result)}}}function V_(W_){var Y_=na.createObjectURL(new Blob([W_.toString(),"this.onmessage =  function (eee) {"+W_.name+"(eee.data);}"],{type:"application/javascript"})),e0=new Worker(Y_),F_;if(typeof na<"u")F_=na;else if(typeof webkitURL<"u")F_=webkitURL;else throw"Neither URL nor webkitURL detected.";return F_.revokeObjectURL(Y_),e0}},this.writeToDisk=function(){o.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(s_){s_=s_||{audio:!0,video:!0,gif:!0},s_.audio&&this.audioRecorder&&this.audioRecorder.save(typeof s_.audio=="string"?s_.audio:""),s_.video&&this.videoRecorder&&this.videoRecorder.save(typeof s_.video=="string"?s_.video:""),s_.gif&&this.gifRecorder&&this.gifRecorder.save(typeof s_.gif=="string"?s_.gif:"")}}_.getFromDisk=o.getFromDisk,_.writeToDisk=o.writeToDisk,typeof o<"u"&&(o.MRecordRTC=_);var $="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(a_){a_&&(typeof window<"u"||typeof commonjsGlobal>"u"||(commonjsGlobal.navigator={userAgent:$,getUserMedia:function(){}},commonjsGlobal.console||(commonjsGlobal.console={}),(typeof commonjsGlobal.console.log>"u"||typeof commonjsGlobal.console.error>"u")&&(commonjsGlobal.console.error=commonjsGlobal.console.log=commonjsGlobal.console.log||function(){console.log(arguments)}),typeof document>"u"&&(a_.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var s_={getContext:function(){return s_},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return s_},a_.HTMLVideoElement=function(){}),typeof location>"u"&&(a_.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(a_.screen={width:0,height:0}),typeof na>"u"&&(a_.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),a_.window=commonjsGlobal))})(typeof commonjsGlobal<"u"?commonjsGlobal:null);var _e=window.requestAnimationFrame;if(typeof _e>"u"){if(typeof webkitRequestAnimationFrame<"u")_e=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")_e=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")_e=msRequestAnimationFrame;else if(typeof _e>"u"){var _n=0;_e=function(a_,s_){var S_=new Date().getTime(),V_=Math.max(0,16-(S_-_n)),W_=setTimeout(function(){a_(S_+V_)},V_);return _n=S_+V_,W_}}}var _r=window.cancelAnimationFrame;typeof _r>"u"&&(typeof webkitCancelAnimationFrame<"u"?_r=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?_r=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?_r=msCancelAnimationFrame:typeof _r>"u"&&(_r=function(a_){clearTimeout(a_)}));var _s=window.AudioContext;typeof _s>"u"&&(typeof webkitAudioContext<"u"&&(_s=webkitAudioContext),typeof mozAudioContext<"u"&&(_s=mozAudioContext));var na=window.URL;typeof na>"u"&&typeof webkitURL<"u"&&(na=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var ba=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),_p=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,_f=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),_E=!_p&&!ba&&!!navigator.webkitGetUserMedia||o_()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,_v=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);_v&&!_E&&navigator.userAgent.indexOf("CriOS")!==-1&&(_v=!1,_E=!0);var n_=window.MediaStream;typeof n_>"u"&&typeof webkitMediaStream<"u"&&(n_=webkitMediaStream),typeof n_<"u"&&typeof n_.prototype.stop>"u"&&(n_.prototype.stop=function(){this.getTracks().forEach(function(a_){a_.stop()})});function e_(a_){var s_=1e3,S_=["Bytes","KB","MB","GB","TB"];if(a_===0)return"0 Bytes";var V_=parseInt(Math.floor(Math.log(a_)/Math.log(s_)),10);return(a_/Math.pow(s_,V_)).toPrecision(3)+" "+S_[V_]}function t_(a_,s_){if(!a_)throw"Blob object is required.";if(!a_.type)try{a_.type="video/webm"}catch{}var S_=(a_.type||"video/webm").split("/")[1];if(S_.indexOf(";")!==-1&&(S_=S_.split(";")[0]),s_&&s_.indexOf(".")!==-1){var V_=s_.split(".");s_=V_[0],S_=V_[1]}var W_=(s_||Math.round(Math.random()*9999999999)+888888888)+"."+S_;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(a_,W_);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(a_,W_);var Y_=document.createElement("a");Y_.href=na.createObjectURL(a_),Y_.download=W_,Y_.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(Y_),typeof Y_.click=="function"?Y_.click():(Y_.target="_blank",Y_.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),na.revokeObjectURL(Y_.href)}function o_(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}function m_(a_,s_){return!a_||!a_.getTracks?[]:a_.getTracks().filter(function(S_){return S_.kind===(s_||"audio")})}function b_(a_,s_){"srcObject"in s_?s_.srcObject=a_:"mozSrcObject"in s_?s_.mozSrcObject=a_:s_.srcObject=a_}function w_(a_,s_){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var S_=new EBML.Reader,V_=new EBML.Decoder,W_=EBML.tools,Y_=new FileReader;Y_.onload=function(e0){var F_=V_.decode(this.result);F_.forEach(function(m0){S_.read(m0)}),S_.stop();var H_=W_.makeMetadataSeekable(S_.metadatas,S_.duration,S_.cues),E0=this.result.slice(S_.metadataSize),d0=new Blob([H_,E0],{type:"video/webm"});s_(d0)},Y_.readAsArrayBuffer(a_)}typeof o<"u"&&(o.invokeSaveAsDialog=t_,o.getTracks=m_,o.getSeekableBlob=w_,o.bytesToSize=e_,o.isElectron=o_);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var y_={};typeof _s<"u"?y_.AudioContext=_s:typeof webkitAudioContext<"u"&&(y_.AudioContext=webkitAudioContext),typeof o<"u"&&(o.Storage=y_);function N_(){if(_f||_v||ba)return!0;var a_=navigator.userAgent,s_=""+parseFloat(navigator.appVersion),S_=parseInt(navigator.appVersion,10),V_,W_;return(_E||_p)&&(V_=a_.indexOf("Chrome"),s_=a_.substring(V_+7)),(W_=s_.indexOf(";"))!==-1&&(s_=s_.substring(0,W_)),(W_=s_.indexOf(" "))!==-1&&(s_=s_.substring(0,W_)),S_=parseInt(""+s_,10),isNaN(S_)&&(s_=""+parseFloat(navigator.appVersion),S_=parseInt(navigator.appVersion,10)),S_>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function _y(a_,s_){var d0=this;if(typeof a_>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(s_=s_||{mimeType:"video/webm"},s_.type==="audio"){if(m_(a_,"video").length&&m_(a_,"audio").length){var S_;navigator.mozGetUserMedia?(S_=new n_,S_.addTrack(m_(a_,"audio")[0])):S_=new n_(m_(a_,"audio")),a_=S_}(!s_.mimeType||s_.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(s_.mimeType=_E?"audio/webm":"audio/ogg"),s_.mimeType&&s_.mimeType.toString().toLowerCase()!=="audio/ogg"&&navigator.mozGetUserMedia&&(s_.mimeType="audio/ogg")}var V_=[];this.getArrayOfBlobs=function(){return V_},this.record=function(){d0.blob=null,d0.clearRecordedData(),d0.timestamps=[],E0=[],V_=[];var m0=s_;s_.disableLogs||console.log("Passing following config over MediaRecorder API.",m0),F_&&(F_=null),_E&&!N_()&&(m0="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&m0.mimeType&&(MediaRecorder.isTypeSupported(m0.mimeType)||(s_.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",m0.mimeType),m0.mimeType=s_.type==="audio"?"audio/webm":"video/webm"));try{F_=new MediaRecorder(a_,m0),s_.mimeType=m0.mimeType}catch{F_=new MediaRecorder(a_)}m0.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in F_&&F_.canRecordMimeType(m0.mimeType)===!1&&(s_.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",m0.mimeType)),F_.ondataavailable=function(v0){if(v0.data&&E0.push("ondataavailable: "+e_(v0.data.size)),typeof s_.timeSlice=="number"){if(v0.data&&v0.data.size&&(V_.push(v0.data),W_(),typeof s_.ondataavailable=="function")){var u0=s_.getNativeBlob?v0.data:new Blob([v0.data],{type:Y_(m0)});s_.ondataavailable(u0)}return}if(!v0.data||!v0.data.size||v0.data.size<100||d0.blob){d0.recordingCallback&&(d0.recordingCallback(new Blob([],{type:Y_(m0)})),d0.recordingCallback=null);return}d0.blob=s_.getNativeBlob?v0.data:new Blob([v0.data],{type:Y_(m0)}),d0.recordingCallback&&(d0.recordingCallback(d0.blob),d0.recordingCallback=null)},F_.onstart=function(){E0.push("started")},F_.onpause=function(){E0.push("paused")},F_.onresume=function(){E0.push("resumed")},F_.onstop=function(){E0.push("stopped")},F_.onerror=function(v0){v0&&(v0.name||(v0.name="UnknownError"),E0.push("error: "+v0),s_.disableLogs||(v0.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",v0):v0.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",m0.mimeType,") is not supported.",v0):v0.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",v0):v0.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",v0):v0.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",v0):v0.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",v0):v0.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",v0):console.error("MediaRecorder Error",v0)),function(u0){if(!d0.manuallyStopped&&F_&&F_.state==="inactive"){delete s_.timeslice,F_.start(10*60*1e3);return}setTimeout(u0,1e3)}(),F_.state!=="inactive"&&F_.state!=="stopped"&&F_.stop())},typeof s_.timeSlice=="number"?(W_(),F_.start(s_.timeSlice)):F_.start(36e5),s_.initCallback&&s_.initCallback()},this.timestamps=[];function W_(){d0.timestamps.push(new Date().getTime()),typeof s_.onTimeStamp=="function"&&s_.onTimeStamp(d0.timestamps[d0.timestamps.length-1],d0.timestamps)}function Y_(m0){return F_&&F_.mimeType?F_.mimeType:m0.mimeType||"video/webm"}this.stop=function(m0){m0=m0||function(){},d0.manuallyStopped=!0,F_&&(this.recordingCallback=m0,F_.state==="recording"&&F_.stop(),typeof s_.timeSlice=="number"&&setTimeout(function(){d0.blob=new Blob(V_,{type:Y_(s_)}),d0.recordingCallback(d0.blob)},100))},this.pause=function(){F_&&F_.state==="recording"&&F_.pause()},this.resume=function(){F_&&F_.state==="paused"&&F_.resume()},this.clearRecordedData=function(){F_&&F_.state==="recording"&&d0.stop(e0),e0()};function e0(){V_=[],F_=null,d0.timestamps=[]}var F_;this.getInternalRecorder=function(){return F_};function H_(){if("active"in a_){if(!a_.active)return!1}else if("ended"in a_&&a_.ended)return!1;return!0}this.blob=null,this.getState=function(){return F_&&F_.state||"inactive"};var E0=[];this.getAllStates=function(){return E0},typeof s_.checkForInactiveTracks>"u"&&(s_.checkForInactiveTracks=!1);var d0=this;(function m0(){if(!(!F_||s_.checkForInactiveTracks===!1)){if(H_()===!1){s_.disableLogs||console.log("MediaStream seems stopped."),d0.stop();return}setTimeout(m0,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof o<"u"&&(o.MediaStreamRecorder=_y);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function v_(a_,s_){if(!m_(a_,"audio").length)throw"Your stream has no audio tracks.";s_=s_||{};var S_=this,V_=[],W_=[],Y_=!1,e0=0,F_,H_=2,E0=s_.desiredSampRate;s_.leftChannel===!0&&(H_=1),s_.numberOfAudioChannels===1&&(H_=1),(!H_||H_<1)&&(H_=2),s_.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+H_),typeof s_.checkForInactiveTracks>"u"&&(s_.checkForInactiveTracks=!0);function d0(){if(s_.checkForInactiveTracks===!1)return!0;if("active"in a_){if(!a_.active)return!1}else if("ended"in a_&&a_.ended)return!1;return!0}this.record=function(){if(d0()===!1)throw"Please make sure MediaStream is active.";A0(),o0=g0=!1,Y_=!0,typeof s_.timeSlice<"u"&&H0()};function m0(U0,NS){function yS(BS,mR){var XR=BS.numberOfAudioChannels,dR=BS.leftBuffers.slice(0),dT=BS.rightBuffers.slice(0),pT=BS.sampleRate,iT=BS.internalInterleavedLength,kR=BS.desiredSampRate;XR===2&&(dR=nI(dR,iT),dT=nI(dT,iT),kR&&(dR=bT(dR,kR,pT),dT=bT(dT,kR,pT))),XR===1&&(dR=nI(dR,iT),kR&&(dR=bT(dR,kR,pT))),kR&&(pT=kR);function bT(tR,ST,AR){var RR=Math.round(tR.length*(ST/AR)),vS=[],TR=Number((tR.length-1)/(RR-1));vS[0]=tR[0];for(var rI=1;rI<RR-1;rI++){var PT=rI*TR,hT=Number(Math.floor(PT)).toFixed(),qO=Number(Math.ceil(PT)).toFixed(),iI=PT-hT;vS[rI]=rO(tR[hT],tR[qO],iI)}return vS[RR-1]=tR[tR.length-1],vS}function rO(tR,ST,AR){return tR+(ST-tR)*AR}function nI(tR,ST){for(var AR=new Float64Array(ST),RR=0,vS=tR.length,TR=0;TR<vS;TR++){var rI=tR[TR];AR.set(rI,RR),RR+=rI.length}return AR}function iO(tR,ST){for(var AR=tR.length+ST.length,RR=new Float64Array(AR),vS=0,TR=0;TR<AR;)RR[TR++]=tR[vS],RR[TR++]=ST[vS],vS++;return RR}function UI(tR,ST,AR){for(var RR=AR.length,vS=0;vS<RR;vS++)tR.setUint8(ST+vS,AR.charCodeAt(vS))}var bI;XR===2&&(bI=iO(dR,dT)),XR===1&&(bI=dR);var QR=bI.length,HO=44+QR*2,SI=new ArrayBuffer(HO),gR=new DataView(SI);UI(gR,0,"RIFF"),gR.setUint32(4,36+QR*2,!0),UI(gR,8,"WAVE"),UI(gR,12,"fmt "),gR.setUint32(16,16,!0),gR.setUint16(20,1,!0),gR.setUint16(22,XR,!0),gR.setUint32(24,pT,!0),gR.setUint32(28,pT*XR*2,!0),gR.setUint16(32,XR*2,!0),gR.setUint16(34,16,!0),UI(gR,36,"data"),gR.setUint32(40,QR*2,!0);for(var kT=QR,VT=44,wN=1,RI=0;RI<kT;RI++)gR.setInt16(VT,bI[RI]*(32767*wN),!0),VT+=2;if(mR)return mR({buffer:SI,view:gR});postMessage({buffer:SI,view:gR})}if(U0.noWorker){yS(U0,function(BS){NS(BS.buffer,BS.view)});return}var SR=v0(yS);SR.onmessage=function(BS){NS(BS.data.buffer,BS.data.view),na.revokeObjectURL(SR.workerURL),SR.terminate()},SR.postMessage(U0)}function v0(U0){var NS=na.createObjectURL(new Blob([U0.toString(),";this.onmessage =  function (eee) {"+U0.name+"(eee.data);}"],{type:"application/javascript"})),yS=new Worker(NS);return yS.workerURL=NS,yS}this.stop=function(U0){U0=U0||function(){},Y_=!1,m0({desiredSampRate:E0,sampleRate:J_,numberOfAudioChannels:H_,internalInterleavedLength:e0,leftBuffers:V_,rightBuffers:H_===1?[]:W_,noWorker:s_.noWorker},function(NS,yS){S_.blob=new Blob([yS],{type:"audio/wav"}),S_.buffer=new ArrayBuffer(yS.buffer.byteLength),S_.view=yS,S_.sampleRate=E0||J_,S_.bufferSize=j0,S_.length=e0,o0=!1,U0&&U0(S_.blob)})},typeof o.Storage>"u"&&(o.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!o.Storage.AudioContextConstructor||o.Storage.AudioContextConstructor.state==="closed")&&(o.Storage.AudioContextConstructor=new o.Storage.AudioContext);var u0=o.Storage.AudioContextConstructor,s0=u0.createMediaStreamSource(a_),T0=[0,256,512,1024,2048,4096,8192,16384],j0=typeof s_.bufferSize>"u"?4096:s_.bufferSize;if(T0.indexOf(j0)===-1&&(s_.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(T0,null,"	"))),u0.createJavaScriptNode)F_=u0.createJavaScriptNode(j0,H_,H_);else if(u0.createScriptProcessor)F_=u0.createScriptProcessor(j0,H_,H_);else throw"WebAudio API has no support on this browser.";s0.connect(F_),s_.bufferSize||(j0=F_.bufferSize);var J_=typeof s_.sampleRate<"u"?s_.sampleRate:u0.sampleRate||44100;(J_<22050||J_>96e3)&&(s_.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),s_.disableLogs||s_.desiredSampRate&&console.log("Desired sample-rate: "+s_.desiredSampRate);var g0=!1;this.pause=function(){g0=!0},this.resume=function(){if(d0()===!1)throw"Please make sure MediaStream is active.";if(!Y_){s_.disableLogs||console.log("Seems recording has been restarted."),this.record();return}g0=!1},this.clearRecordedData=function(){s_.checkForInactiveTracks=!1,Y_&&this.stop(j_),j_()};function A0(){V_=[],W_=[],e0=0,o0=!1,Y_=!1,g0=!1,u0=null,S_.leftchannel=V_,S_.rightchannel=W_,S_.numberOfAudioChannels=H_,S_.desiredSampRate=E0,S_.sampleRate=J_,S_.recordingLength=e0,k0={left:[],right:[],recordingLength:0}}function j_(){F_&&(F_.onaudioprocess=null,F_.disconnect(),F_=null),s0&&(s0.disconnect(),s0=null),A0()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var o0=!1;function w0(U0){if(!g0){if(d0()===!1&&(s_.disableLogs||console.log("MediaStream seems stopped."),F_.disconnect(),Y_=!1),!Y_){s0&&(s0.disconnect(),s0=null);return}o0||(o0=!0,s_.onAudioProcessStarted&&s_.onAudioProcessStarted(),s_.initCallback&&s_.initCallback());var NS=U0.inputBuffer.getChannelData(0),yS=new Float32Array(NS);if(V_.push(yS),H_===2){var SR=U0.inputBuffer.getChannelData(1),BS=new Float32Array(SR);W_.push(BS)}e0+=j0,S_.recordingLength=e0,typeof s_.timeSlice<"u"&&(k0.recordingLength+=j0,k0.left.push(yS),H_===2&&k0.right.push(BS))}}F_.onaudioprocess=w0,u0.createMediaStreamDestination?F_.connect(u0.createMediaStreamDestination()):F_.connect(u0.destination),this.leftchannel=V_,this.rightchannel=W_,this.numberOfAudioChannels=H_,this.desiredSampRate=E0,this.sampleRate=J_,S_.recordingLength=e0;var k0={left:[],right:[],recordingLength:0};function H0(){!Y_||typeof s_.ondataavailable!="function"||typeof s_.timeSlice>"u"||(k0.left.length?(m0({desiredSampRate:E0,sampleRate:J_,numberOfAudioChannels:H_,internalInterleavedLength:k0.recordingLength,leftBuffers:k0.left,rightBuffers:H_===1?[]:k0.right},function(U0,NS){var yS=new Blob([NS],{type:"audio/wav"});s_.ondataavailable(yS),setTimeout(H0,s_.timeSlice)}),k0={left:[],right:[],recordingLength:0}):setTimeout(H0,s_.timeSlice))}}typeof o<"u"&&(o.StereoAudioRecorder=v_);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function A_(a_,s_){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";s_=s_||{},s_.frameInterval||(s_.frameInterval=10);var S_=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(T0){T0 in document.createElement("canvas")&&(S_=!0)});var V_=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,W_=50,Y_=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);V_&&Y_&&Y_[2]&&(W_=parseInt(Y_[2],10)),V_&&W_<52&&(S_=!1),s_.useWhammyRecorder&&(S_=!1);var e0,F_;if(S_)if(s_.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),a_ instanceof HTMLCanvasElement)e0=a_;else if(a_ instanceof CanvasRenderingContext2D)e0=a_.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(s_.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var H_;this.record=function(){if(H_=!0,S_&&!s_.useWhammyRecorder){var T0;"captureStream"in e0?T0=e0.captureStream(25):"mozCaptureStream"in e0?T0=e0.mozCaptureStream(25):"webkitCaptureStream"in e0&&(T0=e0.webkitCaptureStream(25));try{var j0=new n_;j0.addTrack(m_(T0,"video")[0]),T0=j0}catch{}if(!T0)throw"captureStream API are NOT available.";F_=new _y(T0,{mimeType:s_.mimeType||"video/webm"}),F_.record()}else s0.frames=[],u0=new Date().getTime(),v0();s_.initCallback&&s_.initCallback()},this.getWebPImages=function(T0){if(a_.nodeName.toLowerCase()!=="canvas"){T0();return}var j0=s0.frames.length;s0.frames.forEach(function(J_,g0){var A0=j0-g0;s_.disableLogs||console.log(A0+"/"+j0+" frames remaining"),s_.onEncodingCallback&&s_.onEncodingCallback(A0,j0);var j_=J_.image.toDataURL("image/webp",1);s0.frames[g0].image=j_}),s_.disableLogs||console.log("Generating WebM"),T0()},this.stop=function(T0){H_=!1;var j0=this;if(S_&&F_){F_.stop(T0);return}this.getWebPImages(function(){s0.compile(function(J_){s_.disableLogs||console.log("Recording finished!"),j0.blob=J_,j0.blob.forEach&&(j0.blob=new Blob([],{type:"video/webm"})),T0&&T0(j0.blob),s0.frames=[]})})};var E0=!1;this.pause=function(){if(E0=!0,F_ instanceof _y){F_.pause();return}},this.resume=function(){if(E0=!1,F_ instanceof _y){F_.resume();return}H_||this.record()},this.clearRecordedData=function(){H_&&this.stop(d0),d0()};function d0(){s0.frames=[],H_=!1,E0=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function m0(){var T0=document.createElement("canvas"),j0=T0.getContext("2d");return T0.width=a_.width,T0.height=a_.height,j0.drawImage(a_,0,0),T0}function v0(){if(E0)return u0=new Date().getTime(),setTimeout(v0,500);if(a_.nodeName.toLowerCase()==="canvas"){var T0=new Date().getTime()-u0;u0=new Date().getTime(),s0.frames.push({image:m0(),duration:T0}),H_&&setTimeout(v0,s_.frameInterval);return}html2canvas(a_,{grabMouse:typeof s_.showMousePointer>"u"||s_.showMousePointer,onrendered:function(j0){var J_=new Date().getTime()-u0;if(!J_)return setTimeout(v0,s_.frameInterval);u0=new Date().getTime(),s0.frames.push({image:j0.toDataURL("image/webp",1),duration:J_}),H_&&setTimeout(v0,s_.frameInterval)}})}var u0=new Date().getTime(),s0=new P_.Video(100)}typeof o<"u"&&(o.CanvasRecorder=A_);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function k_(a_,s_){s_=s_||{},s_.frameInterval||(s_.frameInterval=10),s_.disableLogs||console.log("Using frames-interval:",s_.frameInterval),this.record=function(){s_.width||(s_.width=320),s_.height||(s_.height=240),s_.video||(s_.video={width:s_.width,height:s_.height}),s_.canvas||(s_.canvas={width:s_.width,height:s_.height}),H_.width=s_.canvas.width||320,H_.height=s_.canvas.height||240,E0=H_.getContext("2d"),s_.video&&s_.video instanceof HTMLVideoElement?(d0=s_.video.cloneNode(),s_.initCallback&&s_.initCallback()):(d0=document.createElement("video"),b_(a_,d0),d0.onloadedmetadata=function(){s_.initCallback&&s_.initCallback()},d0.width=s_.video.width,d0.height=s_.video.height),d0.muted=!0,d0.play(),m0=new Date().getTime(),v0=new P_.Video,s_.disableLogs||(console.log("canvas resolutions",H_.width,"*",H_.height),console.log("video width/height",d0.width||H_.width,"*",d0.height||H_.height)),S_(s_.frameInterval)};function S_(u0){u0=typeof u0<"u"?u0:10;var s0=new Date().getTime()-m0;if(!s0)return setTimeout(S_,u0,u0);if(e0)return m0=new Date().getTime(),setTimeout(S_,100);m0=new Date().getTime(),d0.paused&&d0.play(),E0.drawImage(d0,0,0,H_.width,H_.height),v0.frames.push({duration:s0,image:H_.toDataURL("image/webp")}),Y_||setTimeout(S_,u0,u0)}function V_(u0){var s0=-1,T0=u0.length;(function j0(){if(s0++,s0===T0){u0.callback();return}setTimeout(function(){u0.functionToLoop(j0,s0)},1)})()}function W_(u0,s0,T0,j0,J_){var g0=document.createElement("canvas");g0.width=H_.width,g0.height=H_.height;var A0=g0.getContext("2d"),j_=[],o0=s0===-1,w0=s0&&s0>0&&s0<=u0.length?s0:u0.length,k0={r:0,g:0,b:0},H0=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),U0=T0&&T0>=0&&T0<=1?T0:0,NS=j0&&j0>=0&&j0<=1?j0:0,yS=!1;V_({length:w0,functionToLoop:function(SR,BS){var mR,XR,dR,dT=function(){!yS&&dR-mR<=dR*NS||(o0&&(yS=!0),j_.push(u0[BS])),SR()};if(yS)dT();else{var pT=new Image;pT.onload=function(){A0.drawImage(pT,0,0,H_.width,H_.height);var iT=A0.getImageData(0,0,H_.width,H_.height);mR=0,XR=iT.data.length,dR=iT.data.length/4;for(var kR=0;kR<XR;kR+=4){var bT={r:iT.data[kR],g:iT.data[kR+1],b:iT.data[kR+2]},rO=Math.sqrt(Math.pow(bT.r-k0.r,2)+Math.pow(bT.g-k0.g,2)+Math.pow(bT.b-k0.b,2));rO<=H0*U0&&mR++}dT()},pT.src=u0[BS].image}},callback:function(){j_=j_.concat(u0.slice(w0)),j_.length<=0&&j_.push(u0[u0.length-1]),J_(j_)}})}var Y_=!1;this.stop=function(u0){u0=u0||function(){},Y_=!0;var s0=this;setTimeout(function(){W_(v0.frames,-1,null,null,function(T0){v0.frames=T0,s_.advertisement&&s_.advertisement.length&&(v0.frames=s_.advertisement.concat(v0.frames)),v0.compile(function(j0){s0.blob=j0,s0.blob.forEach&&(s0.blob=new Blob([],{type:"video/webm"})),u0&&u0(s0.blob)})})},10)};var e0=!1;this.pause=function(){e0=!0},this.resume=function(){e0=!1,Y_&&this.record()},this.clearRecordedData=function(){Y_||this.stop(F_),F_()};function F_(){v0.frames=[],Y_=!0,e0=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var H_=document.createElement("canvas"),E0=H_.getContext("2d"),d0,m0,v0}typeof o<"u"&&(o.WhammyRecorder=k_);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var P_=function(){function a_(V_){this.frames=[],this.duration=V_||1,this.quality=.8}a_.prototype.add=function(V_,W_){if("canvas"in V_&&(V_=V_.canvas),"toDataURL"in V_&&(V_=V_.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(V_))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:V_,duration:W_||this.duration})};function s_(V_){var W_=na.createObjectURL(new Blob([V_.toString(),"this.onmessage =  function (eee) {"+V_.name+"(eee.data);}"],{type:"application/javascript"})),Y_=new Worker(W_);return na.revokeObjectURL(W_),Y_}function S_(V_){function W_(J_){var g0=e0(J_);if(!g0)return[];for(var A0=3e4,j_=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:T0(g0.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:g0.width,id:176},{data:g0.height,id:186}]}]}]}]}],o0=0,w0=0;o0<J_.length;){var k0=[],H0=0;do k0.push(J_[o0]),H0+=J_[o0].duration,o0++;while(o0<J_.length&&H0<A0);var U0=0,NS={id:524531317,data:Y_(w0,U0,k0)};j_[1].data.push(NS),w0+=H0}return d0(j_)}function Y_(J_,g0,A0){return[{data:J_,id:231}].concat(A0.map(function(j_){var o0=m0({discardable:0,frame:j_.data.slice(4),invisible:0,keyframe:1,lacing:0,trackNum:1,timecode:Math.round(g0)});return g0+=j_.duration,{data:o0,id:163}}))}function e0(J_){if(!J_[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var g0=J_[0].width,A0=J_[0].height,j_=J_[0].duration,o0=1;o0<J_.length;o0++)j_+=J_[o0].duration;return{duration:j_,width:g0,height:A0}}function F_(J_){for(var g0=[];J_>0;)g0.push(J_&255),J_=J_>>8;return new Uint8Array(g0.reverse())}function H_(J_){return new Uint8Array(J_.split("").map(function(g0){return g0.charCodeAt(0)}))}function E0(J_){var g0=[],A0=J_.length%8?new Array(9-J_.length%8).join("0"):"";J_=A0+J_;for(var j_=0;j_<J_.length;j_+=8)g0.push(parseInt(J_.substr(j_,8),2));return new Uint8Array(g0)}function d0(J_){for(var g0=[],A0=0;A0<J_.length;A0++){var j_=J_[A0].data;typeof j_=="object"&&(j_=d0(j_)),typeof j_=="number"&&(j_=E0(j_.toString(2))),typeof j_=="string"&&(j_=H_(j_));var o0=j_.size||j_.byteLength||j_.length,w0=Math.ceil(Math.ceil(Math.log(o0)/Math.log(2))/8),k0=o0.toString(2),H0=new Array(w0*7+7+1-k0.length).join("0")+k0,U0=new Array(w0).join("0")+"1"+H0;g0.push(F_(J_[A0].id)),g0.push(E0(U0)),g0.push(j_)}return new Blob(g0,{type:"video/webm"})}function m0(J_){var g0=0;if(J_.keyframe&&(g0|=128),J_.invisible&&(g0|=8),J_.lacing&&(g0|=J_.lacing<<1),J_.discardable&&(g0|=1),J_.trackNum>127)throw"TrackNumber > 127 not supported";var A0=[J_.trackNum|128,J_.timecode>>8,J_.timecode&255,g0].map(function(j_){return String.fromCharCode(j_)}).join("")+J_.frame;return A0}function v0(J_){for(var g0=J_.RIFF[0].WEBP[0],A0=g0.indexOf("*"),j_=0,o0=[];j_<4;j_++)o0[j_]=g0.charCodeAt(A0+3+j_);var w0,k0,H0;return H0=o0[1]<<8|o0[0],w0=H0&16383,H0=o0[3]<<8|o0[2],k0=H0&16383,{width:w0,height:k0,data:g0,riff:J_}}function u0(J_,g0){return parseInt(J_.substr(g0+4,4).split("").map(function(A0){var j_=A0.charCodeAt(0).toString(2);return new Array(8-j_.length+1).join("0")+j_}).join(""),2)}function s0(J_){for(var g0=0,A0={};g0<J_.length;){var j_=J_.substr(g0,4),o0=u0(J_,g0),w0=J_.substr(g0+4+4,o0);g0+=8+o0,A0[j_]=A0[j_]||[],j_==="RIFF"||j_==="LIST"?A0[j_].push(s0(w0)):A0[j_].push(w0)}return A0}function T0(J_){return[].slice.call(new Uint8Array(new Float64Array([J_]).buffer),0).map(function(g0){return String.fromCharCode(g0)}).reverse().join("")}var j0=new W_(V_.map(function(J_){var g0=v0(s0(atob(J_.image.slice(23))));return g0.duration=J_.duration,g0}));postMessage(j0)}return a_.prototype.compile=function(V_){var W_=s_(S_);W_.onmessage=function(Y_){if(Y_.data.error){console.error(Y_.data.error);return}V_(Y_.data)},W_.postMessage(this.frames)},{Video:a_}}();typeof o<"u"&&(o.Whammy=P_);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var T_={init:function(){var a_=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var s_=1,S_=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),V_,W_=indexedDB.open(S_,s_);function Y_(F_){F_.createObjectStore(a_.dataStoreName)}function e0(){var F_=V_.transaction([a_.dataStoreName],"readwrite");a_.videoBlob&&F_.objectStore(a_.dataStoreName).put(a_.videoBlob,"videoBlob"),a_.gifBlob&&F_.objectStore(a_.dataStoreName).put(a_.gifBlob,"gifBlob"),a_.audioBlob&&F_.objectStore(a_.dataStoreName).put(a_.audioBlob,"audioBlob");function H_(E0){F_.objectStore(a_.dataStoreName).get(E0).onsuccess=function(d0){a_.callback&&a_.callback(d0.target.result,E0)}}H_("audioBlob"),H_("videoBlob"),H_("gifBlob")}W_.onerror=a_.onError,W_.onsuccess=function(){if(V_=W_.result,V_.onerror=a_.onError,V_.setVersion)if(V_.version!==s_){var F_=V_.setVersion(s_);F_.onsuccess=function(){Y_(V_),e0()}}else e0();else e0()},W_.onupgradeneeded=function(F_){Y_(F_.target.result)}},Fetch:function(a_){return this.callback=a_,this.init(),this},Store:function(a_){return this.audioBlob=a_.audioBlob,this.videoBlob=a_.videoBlob,this.gifBlob=a_.gifBlob,this.init(),this},onError:function(a_){console.error(JSON.stringify(a_,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof o<"u"&&(o.DiskStorage=T_);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function R_(a_,s_){if(typeof GIFEncoder>"u"){var S_=document.createElement("script");S_.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(S_)}s_=s_||{};var V_=a_ instanceof CanvasRenderingContext2D||a_ instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(u0.record,1e3);return}if(!H_){setTimeout(u0.record,1e3);return}V_||(s_.width||(s_.width=E0.offsetWidth||320),s_.height||(s_.height=E0.offsetHeight||240),s_.video||(s_.video={width:s_.width,height:s_.height}),s_.canvas||(s_.canvas={width:s_.width,height:s_.height}),e0.width=s_.canvas.width||320,e0.height=s_.canvas.height||240,E0.width=s_.video.width||320,E0.height=s_.video.height||240),v0=new GIFEncoder,v0.setRepeat(0),v0.setDelay(s_.frameRate||200),v0.setQuality(s_.quality||10),v0.start(),typeof s_.onGifRecordingStarted=="function"&&s_.onGifRecordingStarted();function s0(T0){if(u0.clearedRecordedData!==!0){if(W_)return setTimeout(function(){s0(T0)},100);d0=_e(s0),typeof m0===void 0&&(m0=T0),!(T0-m0<90)&&(!V_&&E0.paused&&E0.play(),V_||F_.drawImage(E0,0,0,e0.width,e0.height),s_.onGifPreview&&s_.onGifPreview(e0.toDataURL("image/png")),v0.addFrame(F_),m0=T0)}}d0=_e(s0),s_.initCallback&&s_.initCallback()},this.stop=function(s0){s0=s0||function(){},d0&&_r(d0),this.blob=new Blob([new Uint8Array(v0.stream().bin)],{type:"image/gif"}),s0(this.blob),v0.stream().bin=[]};var W_=!1;this.pause=function(){W_=!0},this.resume=function(){W_=!1},this.clearRecordedData=function(){u0.clearedRecordedData=!0,Y_()};function Y_(){v0&&(v0.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var e0=document.createElement("canvas"),F_=e0.getContext("2d");V_&&(a_ instanceof CanvasRenderingContext2D?(F_=a_,e0=F_.canvas):a_ instanceof HTMLCanvasElement&&(F_=a_.getContext("2d"),e0=a_));var H_=!0;if(!V_){var E0=document.createElement("video");E0.muted=!0,E0.autoplay=!0,E0.playsInline=!0,H_=!1,E0.onloadedmetadata=function(){H_=!0},b_(a_,E0),E0.play()}var d0=null,m0,v0,u0=this}typeof o<"u"&&(o.GifRecorder=R_);function I_(a_,s_){var S_="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(j_){typeof o<"u"||j_&&(typeof window<"u"||typeof commonjsGlobal>"u"||(commonjsGlobal.navigator={userAgent:S_,getUserMedia:function(){}},commonjsGlobal.console||(commonjsGlobal.console={}),(typeof commonjsGlobal.console.log>"u"||typeof commonjsGlobal.console.error>"u")&&(commonjsGlobal.console.error=commonjsGlobal.console.log=commonjsGlobal.console.log||function(){console.log(arguments)}),typeof document>"u"&&(j_.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var o0={getContext:function(){return o0},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return o0},j_.HTMLVideoElement=function(){}),typeof location>"u"&&(j_.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(j_.screen={width:0,height:0}),typeof E0>"u"&&(j_.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),j_.window=commonjsGlobal))})(typeof commonjsGlobal<"u"?commonjsGlobal:null),s_=s_||"multi-streams-mixer";var V_=[],W_=!1,Y_=document.createElement("canvas"),e0=Y_.getContext("2d");Y_.style.opacity=0,Y_.style.position="absolute",Y_.style.zIndex=-1,Y_.style.top="-1000em",Y_.style.left="-1000em",Y_.className=s_,(document.body||document.documentElement).appendChild(Y_),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var F_=this,H_=window.AudioContext;typeof H_>"u"&&(typeof webkitAudioContext<"u"&&(H_=webkitAudioContext),typeof mozAudioContext<"u"&&(H_=mozAudioContext));var E0=window.URL;typeof E0>"u"&&typeof webkitURL<"u"&&(E0=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var d0=window.MediaStream;typeof d0>"u"&&typeof webkitMediaStream<"u"&&(d0=webkitMediaStream),typeof d0<"u"&&typeof d0.prototype.stop>"u"&&(d0.prototype.stop=function(){this.getTracks().forEach(function(j_){j_.stop()})});var m0={};typeof H_<"u"?m0.AudioContext=H_:typeof webkitAudioContext<"u"&&(m0.AudioContext=webkitAudioContext);function v0(j_,o0){"srcObject"in o0?o0.srcObject=j_:"mozSrcObject"in o0?o0.mozSrcObject=j_:o0.srcObject=j_}this.startDrawingFrames=function(){u0()};function u0(){if(!W_){var j_=V_.length,o0=!1,w0=[];if(V_.forEach(function(H0){H0.stream||(H0.stream={}),H0.stream.fullcanvas?o0=H0:w0.push(H0)}),o0)Y_.width=o0.stream.width,Y_.height=o0.stream.height;else if(w0.length){Y_.width=j_>1?w0[0].width*2:w0[0].width;var k0=1;(j_===3||j_===4)&&(k0=2),(j_===5||j_===6)&&(k0=3),(j_===7||j_===8)&&(k0=4),(j_===9||j_===10)&&(k0=5),Y_.height=w0[0].height*k0}else Y_.width=F_.width||360,Y_.height=F_.height||240;o0&&o0 instanceof HTMLVideoElement&&s0(o0),w0.forEach(function(H0,U0){s0(H0,U0)}),setTimeout(u0,F_.frameInterval)}}function s0(j_,o0){if(!W_){var w0=0,k0=0,H0=j_.width,U0=j_.height;o0===1&&(w0=j_.width),o0===2&&(k0=j_.height),o0===3&&(w0=j_.width,k0=j_.height),o0===4&&(k0=j_.height*2),o0===5&&(w0=j_.width,k0=j_.height*2),o0===6&&(k0=j_.height*3),o0===7&&(w0=j_.width,k0=j_.height*3),typeof j_.stream.left<"u"&&(w0=j_.stream.left),typeof j_.stream.top<"u"&&(k0=j_.stream.top),typeof j_.stream.width<"u"&&(H0=j_.stream.width),typeof j_.stream.height<"u"&&(U0=j_.stream.height),e0.drawImage(j_,w0,k0,H0,U0),typeof j_.stream.onRender=="function"&&j_.stream.onRender(e0,w0,k0,H0,U0,o0)}}function T0(){W_=!1;var j_=j0(),o0=J_();return o0&&o0.getTracks().filter(function(w0){return w0.kind==="audio"}).forEach(function(w0){j_.addTrack(w0)}),a_.forEach(function(w0){w0.fullcanvas}),j_}function j0(){A0();var j_;"captureStream"in Y_?j_=Y_.captureStream():"mozCaptureStream"in Y_?j_=Y_.mozCaptureStream():F_.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var o0=new d0;return j_.getTracks().filter(function(w0){return w0.kind==="video"}).forEach(function(w0){o0.addTrack(w0)}),Y_.stream=o0,o0}function J_(){m0.AudioContextConstructor||(m0.AudioContextConstructor=new m0.AudioContext),F_.audioContext=m0.AudioContextConstructor,F_.audioSources=[],F_.useGainNode===!0&&(F_.gainNode=F_.audioContext.createGain(),F_.gainNode.connect(F_.audioContext.destination),F_.gainNode.gain.value=0);var j_=0;if(a_.forEach(function(o0){if(o0.getTracks().filter(function(k0){return k0.kind==="audio"}).length){j_++;var w0=F_.audioContext.createMediaStreamSource(o0);F_.useGainNode===!0&&w0.connect(F_.gainNode),F_.audioSources.push(w0)}}),!!j_)return F_.audioDestination=F_.audioContext.createMediaStreamDestination(),F_.audioSources.forEach(function(o0){o0.connect(F_.audioDestination)}),F_.audioDestination.stream}function g0(j_){var o0=document.createElement("video");return v0(j_,o0),o0.className=s_,o0.muted=!0,o0.volume=0,o0.width=j_.width||F_.width||360,o0.height=j_.height||F_.height||240,o0.play(),o0}this.appendStreams=function(j_){if(!j_)throw"First parameter is required.";j_ instanceof Array||(j_=[j_]),j_.forEach(function(o0){var w0=new d0;if(o0.getTracks().filter(function(U0){return U0.kind==="video"}).length){var k0=g0(o0);k0.stream=o0,V_.push(k0),w0.addTrack(o0.getTracks().filter(function(U0){return U0.kind==="video"})[0])}if(o0.getTracks().filter(function(U0){return U0.kind==="audio"}).length){var H0=F_.audioContext.createMediaStreamSource(o0);F_.audioDestination=F_.audioContext.createMediaStreamDestination(),H0.connect(F_.audioDestination),w0.addTrack(F_.audioDestination.stream.getTracks().filter(function(U0){return U0.kind==="audio"})[0])}a_.push(w0)})},this.releaseStreams=function(){V_=[],W_=!0,F_.gainNode&&(F_.gainNode.disconnect(),F_.gainNode=null),F_.audioSources.length&&(F_.audioSources.forEach(function(j_){j_.disconnect()}),F_.audioSources=[]),F_.audioDestination&&(F_.audioDestination.disconnect(),F_.audioDestination=null),F_.audioContext&&F_.audioContext.close(),F_.audioContext=null,e0.clearRect(0,0,Y_.width,Y_.height),Y_.stream&&(Y_.stream.stop(),Y_.stream=null)},this.resetVideoStreams=function(j_){j_&&!(j_ instanceof Array)&&(j_=[j_]),A0(j_)};function A0(j_){V_=[],j_=j_||a_,j_.forEach(function(o0){if(o0.getTracks().filter(function(k0){return k0.kind==="video"}).length){var w0=g0(o0);w0.stream=o0,V_.push(w0)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=T0}typeof o>"u"&&(e.exports=I_);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function U_(a_,s_){a_=a_||[];var S_=this,V_,W_;s_=s_||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},s_.frameInterval||(s_.frameInterval=10),s_.video||(s_.video={}),s_.video.width||(s_.video.width=360),s_.video.height||(s_.video.height=240),this.record=function(){V_=new I_(a_,s_.elementClass||"multi-streams-mixer"),Y_().length&&(V_.frameInterval=s_.frameInterval||10,V_.width=s_.video.width||360,V_.height=s_.video.height||240,V_.startDrawingFrames()),s_.previewStream&&typeof s_.previewStream=="function"&&s_.previewStream(V_.getMixedStream()),W_=new _y(V_.getMixedStream(),s_),W_.record()};function Y_(){var e0=[];return a_.forEach(function(F_){m_(F_,"video").forEach(function(H_){e0.push(H_)})}),e0}this.stop=function(e0){W_&&W_.stop(function(F_){S_.blob=F_,e0(F_),S_.clearRecordedData()})},this.pause=function(){W_&&W_.pause()},this.resume=function(){W_&&W_.resume()},this.clearRecordedData=function(){W_&&(W_.clearRecordedData(),W_=null),V_&&(V_.releaseStreams(),V_=null)},this.addStreams=function(e0){if(!e0)throw"First parameter is required.";e0 instanceof Array||(e0=[e0]),a_.concat(e0),!(!W_||!V_)&&(V_.appendStreams(e0),s_.previewStream&&typeof s_.previewStream=="function"&&s_.previewStream(V_.getMixedStream()))},this.resetVideoStreams=function(e0){V_&&(e0&&!(e0 instanceof Array)&&(e0=[e0]),V_.resetVideoStreams(e0))},this.getMixer=function(){return V_},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof o<"u"&&(o.MultiStreamRecorder=U_);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function D_(a_,s_){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof a_>"u")throw'First argument "MediaStream" is required.';var S_=this;S_.recordRTC=new o(a_,s_),this.startRecording=function(){return new Promise(function(V_,W_){try{S_.recordRTC.startRecording(),V_()}catch(Y_){W_(Y_)}})},this.stopRecording=function(){return new Promise(function(V_,W_){try{S_.recordRTC.stopRecording(function(Y_){if(S_.blob=S_.recordRTC.getBlob(),!S_.blob||!S_.blob.size){W_("Empty blob.",S_.blob);return}V_(Y_)})}catch(Y_){W_(Y_)}})},this.pauseRecording=function(){return new Promise(function(V_,W_){try{S_.recordRTC.pauseRecording(),V_()}catch(Y_){W_(Y_)}})},this.resumeRecording=function(){return new Promise(function(V_,W_){try{S_.recordRTC.resumeRecording(),V_()}catch(Y_){W_(Y_)}})},this.getDataURL=function(V_){return new Promise(function(W_,Y_){try{S_.recordRTC.getDataURL(function(e0){W_(e0)})}catch(e0){Y_(e0)}})},this.getBlob=function(){return new Promise(function(V_,W_){try{V_(S_.recordRTC.getBlob())}catch(Y_){W_(Y_)}})},this.getInternalRecorder=function(){return new Promise(function(V_,W_){try{V_(S_.recordRTC.getInternalRecorder())}catch(Y_){W_(Y_)}})},this.reset=function(){return new Promise(function(V_,W_){try{V_(S_.recordRTC.reset())}catch(Y_){W_(Y_)}})},this.destroy=function(){return new Promise(function(V_,W_){try{V_(S_.recordRTC.destroy())}catch(Y_){W_(Y_)}})},this.getState=function(){return new Promise(function(V_,W_){try{V_(S_.recordRTC.getState())}catch(Y_){W_(Y_)}})},this.blob=null,this.version="5.6.2"}typeof o<"u"&&(o.RecordRTCPromisesHandler=D_);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function n0(a_,s_){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),s_=s_||{},s_.width=s_.width||640,s_.height=s_.height||480,s_.frameRate=s_.frameRate||30,s_.bitrate=s_.bitrate||1200,s_.realtime=s_.realtime||!0;var S_;function V_(){return new ReadableStream({start:function(E0){var d0=document.createElement("canvas"),m0=document.createElement("video"),v0=!0;m0.srcObject=a_,m0.muted=!0,m0.height=s_.height,m0.width=s_.width,m0.volume=0,m0.onplaying=function(){d0.width=s_.width,d0.height=s_.height;var u0=d0.getContext("2d"),s0=1e3/s_.frameRate,T0=setInterval(function(){if(S_&&(clearInterval(T0),E0.close()),v0&&(v0=!1,s_.onVideoProcessStarted&&s_.onVideoProcessStarted()),u0.drawImage(m0,0,0),E0._controlledReadableStream.state!=="closed")try{E0.enqueue(u0.getImageData(0,0,s_.width,s_.height))}catch{}},s0)},m0.play()}})}var W_;function Y_(E0,d0){if(!s_.workerPath&&!d0){S_=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(v0){v0.arrayBuffer().then(function(u0){Y_(E0,u0)})});return}if(!s_.workerPath&&d0 instanceof ArrayBuffer){var m0=new Blob([d0],{type:"text/javascript"});s_.workerPath=na.createObjectURL(m0)}s_.workerPath||console.error("workerPath parameter is missing."),W_=new Worker(s_.workerPath),W_.postMessage(s_.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),W_.addEventListener("message",function(v0){v0.data==="READY"?(W_.postMessage({width:s_.width,height:s_.height,bitrate:s_.bitrate||1200,timebaseDen:s_.frameRate||30,realtime:s_.realtime}),V_().pipeTo(new WritableStream({write:function(u0){if(S_){console.error("Got image, but recorder is finished!");return}W_.postMessage(u0.data.buffer,[u0.data.buffer])}}))):v0.data&&(e0||H_.push(v0.data))})}this.record=function(){H_=[],e0=!1,this.blob=null,Y_(a_),typeof s_.initCallback=="function"&&s_.initCallback()};var e0;this.pause=function(){e0=!0},this.resume=function(){e0=!1};function F_(E0){if(!W_){E0&&E0();return}W_.addEventListener("message",function(d0){d0.data===null&&(W_.terminate(),W_=null,E0&&E0())}),W_.postMessage(null)}var H_=[];this.stop=function(E0){S_=!0;var d0=this;F_(function(){d0.blob=new Blob(H_,{type:"video/webm"}),E0(d0.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){H_=[],e0=!1,this.blob=null},this.blob=null}typeof o<"u"&&(o.WebAssemblyRecorder=n0)})(RecordRTC$1);var RecordRTCExports=RecordRTC$1.exports;const RecordRTC=getDefaultExportFromCjs(RecordRTCExports);var download$1={exports:{}};(function(e,o){(function(s,a){e.exports=a()})(commonjsGlobal,function(){return function s(a,_,$){var _e=window,_n="application/octet-stream",_r=$||_n,_s=a,na=!_&&!$&&_s,ba=document.createElement("a"),_p=function(y_){return String(y_)},_f=_e.Blob||_e.MozBlob||_e.WebKitBlob||_p,_E=_||"download",_v,n_;if(_f=_f.call?_f.bind(_e):Blob,String(this)==="true"&&(_s=[_s,_r],_r=_s[0],_s=_s[1]),na&&na.length<2048&&(_E=na.split("/").pop().split("?")[0],ba.href=na,ba.href.indexOf(na)!==-1)){var e_=new XMLHttpRequest;return e_.open("GET",na,!0),e_.responseType="blob",e_.onload=function(y_){s(y_.target.response,_E,_n)},setTimeout(function(){e_.send()},0),e_}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(_s))if(_s.length>1024*1024*1.999&&_f!==_p)_s=b_(_s),_r=_s.type||_n;else return navigator.msSaveBlob?navigator.msSaveBlob(b_(_s),_E):w_(_s);else if(/([\x80-\xff])/.test(_s)){var t_=0,o_=new Uint8Array(_s.length),m_=o_.length;for(t_;t_<m_;++t_)o_[t_]=_s.charCodeAt(t_);_s=new _f([o_],{type:_r})}_v=_s instanceof _f?_s:new _f([_s],{type:_r});function b_(y_){var N_=y_.split(/[:;,]/),_y=N_[1],v_=N_[2]=="base64"?atob:decodeURIComponent,A_=v_(N_.pop()),k_=A_.length,P_=0,T_=new Uint8Array(k_);for(P_;P_<k_;++P_)T_[P_]=A_.charCodeAt(P_);return new _f([T_],{type:_y})}function w_(y_,N_){if("download"in ba)return ba.href=y_,ba.setAttribute("download",_E),ba.className="download-js-link",ba.innerHTML="downloading...",ba.style.display="none",document.body.appendChild(ba),setTimeout(function(){ba.click(),document.body.removeChild(ba),N_===!0&&setTimeout(function(){_e.URL.revokeObjectURL(ba.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(y_)&&(y_="data:"+y_.replace(/^data:([\w\/\-\+]+)/,_n)),window.open(y_)||confirm(`Displaying New Document

Use Save As... to download, then click back to return to this page.`)&&(location.href=y_),!0;var _y=document.createElement("iframe");document.body.appendChild(_y),!N_&&/^data:/.test(y_)&&(y_="data:"+y_.replace(/^data:([\w\/\-\+]+)/,_n)),_y.src=y_,setTimeout(function(){document.body.removeChild(_y)},333)}if(navigator.msSaveBlob)return navigator.msSaveBlob(_v,_E);if(_e.URL)w_(_e.URL.createObjectURL(_v),!0);else{if(typeof _v=="string"||_v.constructor===_p)try{return w_("data:"+_r+";base64,"+_e.btoa(_v))}catch{return w_("data:"+_r+","+encodeURIComponent(_v))}n_=new FileReader,n_.onload=function(y_){w_(this.result)},n_.readAsDataURL(_v)}return!0}})})(download$1);var downloadExports=download$1.exports;const download=getDefaultExportFromCjs(downloadExports);function useTheme(){const e=useTheme$1(defaultTheme$1);return e[THEME_ID]||e}const reflow=e=>e.scrollTop;function getTransitionProps(e,o){var s,a;const{timeout:_,easing:$,style:_e={}}=e;return{duration:(s=_e.transitionDuration)!=null?s:typeof _=="number"?_:_[o.mode]||0,easing:(a=_e.transitionTimingFunction)!=null?a:typeof $=="object"?$[o.mode]:$,delay:_e.transitionDelay}}const _excluded$2=["anchorEl","component","components","componentsProps","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","transition","slots","slotProps"],PopperRoot=styled$1(Popper$2,{name:"MuiPopper",slot:"Root",overridesResolver:(e,o)=>o.root})({}),Popper=reactExports.forwardRef(function e(o,s){var a;const _=useTheme$2(),$=useThemeProps({props:o,name:"MuiPopper"}),{anchorEl:_e,component:_n,components:_r,componentsProps:_s,container:na,disablePortal:ba,keepMounted:_p,modifiers:_f,open:_E,placement:_v,popperOptions:n_,popperRef:e_,transition:t_,slots:o_,slotProps:m_}=$,b_=_objectWithoutPropertiesLoose$7($,_excluded$2),w_=(a=o_==null?void 0:o_.root)!=null?a:_r==null?void 0:_r.Root,y_=_extends$3({anchorEl:_e,container:na,disablePortal:ba,keepMounted:_p,modifiers:_f,open:_E,placement:_v,popperOptions:n_,popperRef:e_,transition:t_},b_);return jsxRuntimeExports.jsx(PopperRoot,_extends$3({as:_n,direction:_==null?void 0:_.direction,slots:{root:w_},slotProps:m_??_s},y_,{ref:s}))}),Popper$1=Popper,_excluded$1=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function getScale(e){return`scale(${e}, ${e**2})`}const styles={entering:{opacity:1,transform:getScale(1)},entered:{opacity:1,transform:"none"}},isWebKit154=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Grow=reactExports.forwardRef(function e(o,s){const{addEndListener:a,appear:_=!0,children:$,easing:_e,in:_n,onEnter:_r,onEntered:_s,onEntering:na,onExit:ba,onExited:_p,onExiting:_f,style:_E,timeout:_v="auto",TransitionComponent:n_=Transition$1}=o,e_=_objectWithoutPropertiesLoose$7(o,_excluded$1),t_=reactExports.useRef(),o_=reactExports.useRef(),m_=useTheme(),b_=reactExports.useRef(null),w_=useForkRef(b_,$.ref,s),y_=R_=>I_=>{if(R_){const U_=b_.current;I_===void 0?R_(U_):R_(U_,I_)}},N_=y_(na),_y=y_((R_,I_)=>{reflow(R_);const{duration:U_,delay:D_,easing:n0}=getTransitionProps({style:_E,timeout:_v,easing:_e},{mode:"enter"});let a_;_v==="auto"?(a_=m_.transitions.getAutoHeightDuration(R_.clientHeight),o_.current=a_):a_=U_,R_.style.transition=[m_.transitions.create("opacity",{duration:a_,delay:D_}),m_.transitions.create("transform",{duration:isWebKit154?a_:a_*.666,delay:D_,easing:n0})].join(","),_r&&_r(R_,I_)}),v_=y_(_s),A_=y_(_f),k_=y_(R_=>{const{duration:I_,delay:U_,easing:D_}=getTransitionProps({style:_E,timeout:_v,easing:_e},{mode:"exit"});let n0;_v==="auto"?(n0=m_.transitions.getAutoHeightDuration(R_.clientHeight),o_.current=n0):n0=I_,R_.style.transition=[m_.transitions.create("opacity",{duration:n0,delay:U_}),m_.transitions.create("transform",{duration:isWebKit154?n0:n0*.666,delay:isWebKit154?U_:U_||n0*.333,easing:D_})].join(","),R_.style.opacity=0,R_.style.transform=getScale(.75),ba&&ba(R_)}),P_=y_(_p),T_=R_=>{_v==="auto"&&(t_.current=setTimeout(R_,o_.current||0)),a&&a(b_.current,R_)};return reactExports.useEffect(()=>()=>{clearTimeout(t_.current)},[]),jsxRuntimeExports.jsx(n_,_extends$3({appear:_,in:_n,nodeRef:b_,onEnter:_y,onEntered:v_,onEntering:N_,onExit:k_,onExited:P_,onExiting:A_,addEndListener:T_,timeout:_v==="auto"?null:_v},e_,{children:(R_,I_)=>reactExports.cloneElement($,_extends$3({style:_extends$3({opacity:0,transform:getScale(.75),visibility:R_==="exited"&&!_n?"hidden":void 0},styles[R_],_E,$.props.style),ref:w_},I_))}))});Grow.muiSupportAuto=!0;const Grow$1=Grow;function getTooltipUtilityClass(e){return generateUtilityClass("MuiTooltip",e)}const tooltipClasses=generateUtilityClasses("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]),tooltipClasses$1=tooltipClasses,_excluded=["arrow","children","classes","components","componentsProps","describeChild","disableFocusListener","disableHoverListener","disableInteractive","disableTouchListener","enterDelay","enterNextDelay","enterTouchDelay","followCursor","id","leaveDelay","leaveTouchDelay","onClose","onOpen","open","placement","PopperComponent","PopperProps","slotProps","slots","title","TransitionComponent","TransitionProps"];function round(e){return Math.round(e*1e5)/1e5}const useUtilityClasses=e=>{const{classes:o,disableInteractive:s,arrow:a,touch:_,placement:$}=e,_e={popper:["popper",!s&&"popperInteractive",a&&"popperArrow"],tooltip:["tooltip",a&&"tooltipArrow",_&&"touch",`tooltipPlacement${capitalize($.split("-")[0])}`],arrow:["arrow"]};return composeClasses(_e,getTooltipUtilityClass,o)},TooltipPopper=styled$1(Popper$1,{name:"MuiTooltip",slot:"Popper",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.popper,!s.disableInteractive&&o.popperInteractive,s.arrow&&o.popperArrow,!s.open&&o.popperClose]}})(({theme:e,ownerState:o,open:s})=>_extends$3({zIndex:(e.vars||e).zIndex.tooltip,pointerEvents:"none"},!o.disableInteractive&&{pointerEvents:"auto"},!s&&{pointerEvents:"none"},o.arrow&&{[`&[data-popper-placement*="bottom"] .${tooltipClasses$1.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${tooltipClasses$1.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${tooltipClasses$1.arrow}`]:_extends$3({},o.isRtl?{right:0,marginRight:"-0.71em"}:{left:0,marginLeft:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}}),[`&[data-popper-placement*="left"] .${tooltipClasses$1.arrow}`]:_extends$3({},o.isRtl?{left:0,marginLeft:"-0.71em"}:{right:0,marginRight:"-0.71em"},{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}})})),TooltipTooltip=styled$1("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(e,o)=>{const{ownerState:s}=e;return[o.tooltip,s.touch&&o.touch,s.arrow&&o.tooltipArrow,o[`tooltipPlacement${capitalize(s.placement.split("-")[0])}`]]}})(({theme:e,ownerState:o})=>_extends$3({backgroundColor:e.vars?e.vars.palette.Tooltip.bg:alpha(e.palette.grey[700],.92),borderRadius:(e.vars||e).shape.borderRadius,color:(e.vars||e).palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:e.typography.fontWeightMedium},o.arrow&&{position:"relative",margin:0},o.touch&&{padding:"8px 16px",fontSize:e.typography.pxToRem(14),lineHeight:`${round(16/14)}em`,fontWeight:e.typography.fontWeightRegular},{[`.${tooltipClasses$1.popper}[data-popper-placement*="left"] &`]:_extends$3({transformOrigin:"right center"},o.isRtl?_extends$3({marginLeft:"14px"},o.touch&&{marginLeft:"24px"}):_extends$3({marginRight:"14px"},o.touch&&{marginRight:"24px"})),[`.${tooltipClasses$1.popper}[data-popper-placement*="right"] &`]:_extends$3({transformOrigin:"left center"},o.isRtl?_extends$3({marginRight:"14px"},o.touch&&{marginRight:"24px"}):_extends$3({marginLeft:"14px"},o.touch&&{marginLeft:"24px"})),[`.${tooltipClasses$1.popper}[data-popper-placement*="top"] &`]:_extends$3({transformOrigin:"center bottom",marginBottom:"14px"},o.touch&&{marginBottom:"24px"}),[`.${tooltipClasses$1.popper}[data-popper-placement*="bottom"] &`]:_extends$3({transformOrigin:"center top",marginTop:"14px"},o.touch&&{marginTop:"24px"})})),TooltipArrow=styled$1("span",{name:"MuiTooltip",slot:"Arrow",overridesResolver:(e,o)=>o.arrow})(({theme:e})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:e.vars?e.vars.palette.Tooltip.bg:alpha(e.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}}));let hystersisOpen=!1,hystersisTimer=null,cursorPosition={x:0,y:0};function composeEventHandler(e,o){return s=>{o&&o(s),e(s)}}const Tooltip=reactExports.forwardRef(function e(o,s){var a,_,$,_e,_n,_r,_s,na,ba,_p,_f,_E,_v,n_,e_,t_,o_,m_,b_;const w_=useThemeProps({props:o,name:"MuiTooltip"}),{arrow:y_=!1,children:N_,components:_y={},componentsProps:v_={},describeChild:A_=!1,disableFocusListener:k_=!1,disableHoverListener:P_=!1,disableInteractive:T_=!1,disableTouchListener:R_=!1,enterDelay:I_=100,enterNextDelay:U_=0,enterTouchDelay:D_=700,followCursor:n0=!1,id:a_,leaveDelay:s_=0,leaveTouchDelay:S_=1500,onClose:V_,onOpen:W_,open:Y_,placement:e0="bottom",PopperComponent:F_,PopperProps:H_={},slotProps:E0={},slots:d0={},title:m0,TransitionComponent:v0=Grow$1,TransitionProps:u0}=w_,s0=_objectWithoutPropertiesLoose$7(w_,_excluded),T0=reactExports.isValidElement(N_)?N_:jsxRuntimeExports.jsx("span",{children:N_}),j0=useTheme(),J_=j0.direction==="rtl",[g0,A0]=reactExports.useState(),[j_,o0]=reactExports.useState(null),w0=reactExports.useRef(!1),k0=T_||n0,H0=reactExports.useRef(),U0=reactExports.useRef(),NS=reactExports.useRef(),yS=reactExports.useRef(),[SR,BS]=useControlled({controlled:Y_,default:!1,name:"Tooltip",state:"open"});let mR=SR;const XR=useId(a_),dR=reactExports.useRef(),dT=reactExports.useCallback(()=>{dR.current!==void 0&&(document.body.style.WebkitUserSelect=dR.current,dR.current=void 0),clearTimeout(yS.current)},[]);reactExports.useEffect(()=>()=>{clearTimeout(H0.current),clearTimeout(U0.current),clearTimeout(NS.current),dT()},[dT]);const pT=tS=>{clearTimeout(hystersisTimer),hystersisOpen=!0,BS(!0),W_&&!mR&&W_(tS)},iT=useEventCallback(tS=>{clearTimeout(hystersisTimer),hystersisTimer=setTimeout(()=>{hystersisOpen=!1},800+s_),BS(!1),V_&&mR&&V_(tS),clearTimeout(H0.current),H0.current=setTimeout(()=>{w0.current=!1},j0.transitions.duration.shortest)}),kR=tS=>{w0.current&&tS.type!=="touchstart"||(g0&&g0.removeAttribute("title"),clearTimeout(U0.current),clearTimeout(NS.current),I_||hystersisOpen&&U_?U0.current=setTimeout(()=>{pT(tS)},hystersisOpen?U_:I_):pT(tS))},bT=tS=>{clearTimeout(U0.current),clearTimeout(NS.current),NS.current=setTimeout(()=>{iT(tS)},s_)},{isFocusVisibleRef:rO,onBlur:nI,onFocus:iO,ref:UI}=useIsFocusVisible(),[,bI]=reactExports.useState(!1),QR=tS=>{nI(tS),rO.current===!1&&(bI(!1),bT(tS))},HO=tS=>{g0||A0(tS.currentTarget),iO(tS),rO.current===!0&&(bI(!0),kR(tS))},SI=tS=>{w0.current=!0;const NR=T0.props;NR.onTouchStart&&NR.onTouchStart(tS)},gR=kR,kT=bT,VT=tS=>{SI(tS),clearTimeout(NS.current),clearTimeout(H0.current),dT(),dR.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",yS.current=setTimeout(()=>{document.body.style.WebkitUserSelect=dR.current,kR(tS)},D_)},wN=tS=>{T0.props.onTouchEnd&&T0.props.onTouchEnd(tS),dT(),clearTimeout(NS.current),NS.current=setTimeout(()=>{iT(tS)},S_)};reactExports.useEffect(()=>{if(!mR)return;function tS(NR){(NR.key==="Escape"||NR.key==="Esc")&&iT(NR)}return document.addEventListener("keydown",tS),()=>{document.removeEventListener("keydown",tS)}},[iT,mR]);const RI=useForkRef(T0.ref,UI,A0,s);!m0&&m0!==0&&(mR=!1);const tR=reactExports.useRef(),ST=tS=>{const NR=T0.props;NR.onMouseMove&&NR.onMouseMove(tS),cursorPosition={x:tS.clientX,y:tS.clientY},tR.current&&tR.current.update()},AR={},RR=typeof m0=="string";A_?(AR.title=!mR&&RR&&!P_?m0:null,AR["aria-describedby"]=mR?XR:null):(AR["aria-label"]=RR?m0:null,AR["aria-labelledby"]=mR&&!RR?XR:null);const vS=_extends$3({},AR,s0,T0.props,{className:clsx(s0.className,T0.props.className),onTouchStart:SI,ref:RI},n0?{onMouseMove:ST}:{}),TR={};R_||(vS.onTouchStart=VT,vS.onTouchEnd=wN),P_||(vS.onMouseOver=composeEventHandler(gR,vS.onMouseOver),vS.onMouseLeave=composeEventHandler(kT,vS.onMouseLeave),k0||(TR.onMouseOver=gR,TR.onMouseLeave=kT)),k_||(vS.onFocus=composeEventHandler(HO,vS.onFocus),vS.onBlur=composeEventHandler(QR,vS.onBlur),k0||(TR.onFocus=HO,TR.onBlur=QR));const rI=reactExports.useMemo(()=>{var tS;let NR=[{name:"arrow",enabled:!!j_,options:{element:j_,padding:4}}];return(tS=H_.popperOptions)!=null&&tS.modifiers&&(NR=NR.concat(H_.popperOptions.modifiers)),_extends$3({},H_.popperOptions,{modifiers:NR})},[j_,H_]),PT=_extends$3({},w_,{isRtl:J_,arrow:y_,disableInteractive:k0,placement:e0,PopperComponentProp:F_,touch:w0.current}),hT=useUtilityClasses(PT),qO=(a=(_=d0.popper)!=null?_:_y.Popper)!=null?a:TooltipPopper,iI=($=(_e=(_n=d0.transition)!=null?_n:_y.Transition)!=null?_e:v0)!=null?$:Grow$1,IS=(_r=(_s=d0.tooltip)!=null?_s:_y.Tooltip)!=null?_r:TooltipTooltip,oT=(na=(ba=d0.arrow)!=null?ba:_y.Arrow)!=null?na:TooltipArrow,fT=appendOwnerState(qO,_extends$3({},H_,(_p=E0.popper)!=null?_p:v_.popper,{className:clsx(hT.popper,H_==null?void 0:H_.className,(_f=(_E=E0.popper)!=null?_E:v_.popper)==null?void 0:_f.className)}),PT),ZR=appendOwnerState(iI,_extends$3({},u0,(_v=E0.transition)!=null?_v:v_.transition),PT),zO=appendOwnerState(IS,_extends$3({},(n_=E0.tooltip)!=null?n_:v_.tooltip,{className:clsx(hT.tooltip,(e_=(t_=E0.tooltip)!=null?t_:v_.tooltip)==null?void 0:e_.className)}),PT),TI=appendOwnerState(oT,_extends$3({},(o_=E0.arrow)!=null?o_:v_.arrow,{className:clsx(hT.arrow,(m_=(b_=E0.arrow)!=null?b_:v_.arrow)==null?void 0:m_.className)}),PT);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[reactExports.cloneElement(T0,vS),jsxRuntimeExports.jsx(qO,_extends$3({as:F_??Popper$1,placement:e0,anchorEl:n0?{getBoundingClientRect:()=>({top:cursorPosition.y,left:cursorPosition.x,right:cursorPosition.x,bottom:cursorPosition.y,width:0,height:0})}:g0,popperRef:tR,open:g0?mR:!1,id:XR,transition:!0},TR,fT,{popperOptions:rI,children:({TransitionProps:tS})=>jsxRuntimeExports.jsx(iI,_extends$3({timeout:j0.transitions.duration.shorter},tS,ZR,{children:jsxRuntimeExports.jsxs(IS,_extends$3({},zO,{children:[m0,y_?jsxRuntimeExports.jsx(oT,_extends$3({},TI,{ref:o0})):null]}))}))}))]})}),Tooltip$1=Tooltip;function Controls(){const{tracks:e,client:o,setStart:s,setInCall:a,screenTrack:_,setScreenTrack:$,participantsListOpen:_e,setParticipantsListOpen:_n,chatsContainerOpen:_r,setChatsContainerOpen:_s}=reactExports.useContext(SocketContext),[na,ba]=reactExports.useState({video:!0,audio:!0}),[_p,_f]=reactExports.useState(!1),[_E,_v]=reactExports.useState(!1),[n_,e_]=reactExports.useState(!1),[t_,o_]=reactExports.useState(null),m_=reactExports.useRef(null),b_=async()=>{try{const P_=await navigator.mediaDevices.getUserMedia({audio:!0}),T_=await navigator.mediaDevices.getDisplayMedia({video:!0}),R_=new MediaStream([...P_.getTracks(),...T_.getTracks()]),I_=RecordRTC(R_,{type:"video"});m_.current=I_,I_.startRecording(),e_(!0)}catch(P_){console.error("Failed to start recording:",P_)}},w_=()=>{m_.current.stopRecording(async()=>{const P_=m_.current.getBlob();o_(P_),e_(!1)})},y_=async()=>{t_&&(await download(t_,"recorded-video.webm"),o_(null))},N_=async()=>{try{const P_=await AgoraRTC.createScreenVideoTrack({encoderConfig:"1080p_1"});$(P_),_f(!0),_v(!1)}catch(P_){console.error("Failed to create screen sharing track:",P_)}},_y=async()=>{if(_)try{await o.unpublish(_),await o.publish(e[1]),await _.stop(),$(null),_f(!1),_v(!0)}catch(P_){console.error("Failed to stop screen sharing:",P_)}};reactExports.useEffect(()=>{_p&&_&&e&&(async()=>{try{await o.unpublish(e[1]),await o.publish(_)}catch(T_){console.error("Failed to handle screen sharing transition:",T_)}})()},[_,o,_p,_E,e]);const v_=async P_=>{if(P_==="audio")try{await e[0].setEnabled(!na.audio),ba(T_=>({...T_,audio:!T_.audio}))}catch(T_){console.error("Failed to mute/unmute audio:",T_)}else if(P_==="video")try{await e[1].setEnabled(!na.video),ba(T_=>({...T_,video:!T_.video}))}catch(T_){console.error("Failed to mute/unmute video:",T_)}},A_=useNavigate(),k_=async()=>{try{await o.leave(),o.removeAllListeners(),e[0].close(),e[1].close(),s(!1),a(!1),A_("/")}catch(P_){console.error("Failed to leave channel:",P_)}};return jsxRuntimeExports.jsxs("div",{className:"controls-page",children:[jsxRuntimeExports.jsxs("div",{className:"controllers-video-part",children:[jsxRuntimeExports.jsx(Button,{variant:"contained",color:na.audio?"primary":"secondary",onClick:()=>v_("audio"),children:na.audio?jsxRuntimeExports.jsx(Tooltip$1,{title:"Microphone is on",placement:"top",children:jsxRuntimeExports.jsx(default_1$c,{})}):jsxRuntimeExports.jsx(Tooltip$1,{title:"Microphone is off",placement:"top",children:jsxRuntimeExports.jsx(default_1$b,{})})}),jsxRuntimeExports.jsx(Button,{variant:"contained",color:na.video?"primary":"secondary",onClick:()=>v_("video"),children:na.video?jsxRuntimeExports.jsx(Tooltip$1,{title:"Camera is on",placement:"top",children:jsxRuntimeExports.jsx(default_1$a,{})}):jsxRuntimeExports.jsx(Tooltip$1,{title:"Camera is off",placement:"top",children:jsxRuntimeExports.jsx(default_1$9,{})})}),_?jsxRuntimeExports.jsx(Button,{variant:"contained",color:na.video?"primary":"secondary",onClick:_y,children:jsxRuntimeExports.jsx(Tooltip$1,{title:"Stop screen sharing",placement:"top",children:jsxRuntimeExports.jsx(default_1$6,{})})}):jsxRuntimeExports.jsx(Button,{variant:"contained",color:na.video?"primary":"secondary",onClick:N_,children:jsxRuntimeExports.jsx(Tooltip$1,{title:"Screen share",placement:"top",children:jsxRuntimeExports.jsx(default_1$7,{})})}),n_?jsxRuntimeExports.jsx(Button,{variant:"contained",color:na.video?"primary":"secondary",onClick:w_,children:jsxRuntimeExports.jsx(Tooltip$1,{title:"Stop recording",placement:"top",children:jsxRuntimeExports.jsx(default_1$j,{})})}):jsxRuntimeExports.jsx(Button,{variant:"contained",onClick:b_,children:jsxRuntimeExports.jsx(Tooltip$1,{title:"Start recording",placement:"top",children:jsxRuntimeExports.jsx(default_1$2,{})})}),t_?jsxRuntimeExports.jsx(Button,{variant:"contained",color:"danger",onClick:y_,children:jsxRuntimeExports.jsx(Tooltip$1,{title:"Download",placement:"top",children:jsxRuntimeExports.jsx(default_1$3,{})})}):"",jsxRuntimeExports.jsx(Button,{variant:"contained",color:"default",onClick:()=>k_(),children:jsxRuntimeExports.jsx(Tooltip$1,{title:"Leave meet",placement:"top",children:jsxRuntimeExports.jsx(default_1$8,{})})})]}),jsxRuntimeExports.jsxs("div",{className:"controllers-chat-participants",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{_n(!1),_s(!_r)},children:jsxRuntimeExports.jsx(Tooltip$1,{title:"Chats",placement:"top",children:jsxRuntimeExports.jsx(default_1$5,{})})}),jsxRuntimeExports.jsx("button",{onClick:()=>{_n(!_e),_s(!1)},children:jsxRuntimeExports.jsx(Tooltip$1,{title:"Participants",placement:"top",children:jsxRuntimeExports.jsx(default_1$4,{})})})]})]})}const Participants=()=>{const{participants:e,participantsListOpen:o}=reactExports.useContext(SocketContext);return jsxRuntimeExports.jsxs("div",{className:"participants-page",style:o?{right:"1vw"}:{right:"-25vw"},children:[jsxRuntimeExports.jsx("h3",{children:"Members Online.."}),jsxRuntimeExports.jsx("hr",{id:"h3-hr"}),jsxRuntimeExports.jsx("div",{className:"participants-container",children:Object.values(e).length>0?Object.values(e).map(s=>jsxRuntimeExports.jsxs("div",{className:"participant",children:[jsxRuntimeExports.jsx("div",{className:"participant-logo",children:jsxRuntimeExports.jsx("p",{children:s.charAt(0).toUpperCase()})}),jsxRuntimeExports.jsx("h4",{children:s})]})):jsxRuntimeExports.jsx("p",{children:"No members"})})]})};var Send={},_interopRequireDefault$1=interopRequireDefaultExports;Object.defineProperty(Send,"__esModule",{value:!0});var default_1$1=Send.default=void 0,_createSvgIcon$1=_interopRequireDefault$1(requireCreateSvgIcon()),_jsxRuntime$1=jsxRuntimeExports,_default$1=(0,_createSvgIcon$1.default)((0,_jsxRuntime$1.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");default_1$1=Send.default=_default$1;const Chat=({roomId:e,userId:o})=>{const{participants:s,chatsContainerOpen:a,socket:_}=reactExports.useContext(SocketContext),[$,_e]=reactExports.useState([]),[_n,_r]=reactExports.useState(""),_s=async()=>{await _.emit("new-chat",{msg:[o,_n],roomId:e}),_e(na=>[...na,[o,_n]]),console.log("sentt"),_r("")};return reactExports.useEffect(()=>{_.on("new-chat-arrived",async({msg:na,room:ba})=>{console.log("newwww"),ba===e&&_e(_p=>[..._p,na]),console.log("textss",$)})},[_]),jsxRuntimeExports.jsxs("div",{className:"chats-page",style:a?{right:"1vw"}:{right:"-25vw"},children:[jsxRuntimeExports.jsx("h3",{children:"Chat Room.."}),jsxRuntimeExports.jsx("hr",{id:"h3-hr"}),jsxRuntimeExports.jsxs("div",{className:"chat-container",children:[jsxRuntimeExports.jsx("div",{className:"chat-messages-box",children:$.length>0?$.map((na,ba)=>jsxRuntimeExports.jsxs("div",{className:"message-body",children:[jsxRuntimeExports.jsx("span",{className:"sender-name",children:s[na[0]]}),jsxRuntimeExports.jsx("p",{className:"message",children:na[1]})]},ba)):jsxRuntimeExports.jsx("p",{children:"no chats"})}),jsxRuntimeExports.jsxs("div",{className:"send-messages-box",children:[jsxRuntimeExports.jsx("input",{type:"text",value:_n,onChange:na=>_r(na.target.value),placeholder:"type something.."}),jsxRuntimeExports.jsx("button",{onClick:_s,children:jsxRuntimeExports.jsx(default_1$1,{})})]})]})]})},MeetRoom=()=>{const{id:e}=useParams(),[o,s]=reactExports.useState(""),{socket:a,setInCall:_,client:$,users:_e,setUsers:_n,ready:_r,tracks:_s,setStart:na,setParticipants:ba,start:_p}=reactExports.useContext(SocketContext),_f=localStorage.getItem("userId"),_E=()=>{navigator.clipboard.writeText(e),alert("Meet ID copied to clipboard!")};return reactExports.useEffect(()=>{a.emit("request-to-join-room",{userId:_f,roomId:e}),a.emit("join-room",{userId:_f,roomId:e}),a.on("user-joined",async()=>{_(!0)}),a.emit("get-participants",{roomId:e}),a.on("participants-list",async({usernames:_v,roomName:n_})=>{ba(_v),s(n_)}),a.on("user-requested-to-join",async({participantId:_v,hostId:n_})=>{n_===_f&&window.confirm("Do you really want to leave?")&&alert("holaa")})},[a]),reactExports.useEffect(()=>{let _v=async n_=>{$.on("user-published",async(e_,t_)=>{await $.subscribe(e_,t_),t_==="video"&&_n(o_=>[...o_,e_]),t_==="audio"&&e_.audioTrack.play()}),$.on("user-unpublished",(e_,t_)=>{t_==="audio"&&e_.audioTrack&&e_.audioTrack.stop(),t_==="video"&&_n(o_=>o_.filter(m_=>m_.uid!==e_.uid))}),$.on("user-left",e_=>{a.emit("user-left-room",{userId:e_.uid,roomId:e}),_n(t_=>t_.filter(o_=>o_.uid!==e_.uid))});try{const e_=parseInt(_f,10);await $.join(config.appId,n_,config.token,e_)}catch(e_){console.log("error",e_)}_s&&await $.publish([_s[0],_s[1]]),na(!0)};if(_r&&_s)try{_v(e)}catch(n_){console.log(n_)}},[e,$,_r,_s]),jsxRuntimeExports.jsxs("div",{className:"meetPage",children:[jsxRuntimeExports.jsxs("div",{className:"meetPage-header",children:[jsxRuntimeExports.jsxs("h3",{children:["Meet: ",jsxRuntimeExports.jsx("span",{children:o})]}),jsxRuntimeExports.jsxs("p",{children:["Meet ID: ",jsxRuntimeExports.jsx("button",{id:"meet-id-copy",onClick:_E,children:"Copy Meet ID"})]})]}),jsxRuntimeExports.jsx(Participants,{}),jsxRuntimeExports.jsx(Chat,{roomId:e,userId:_f}),jsxRuntimeExports.jsx("div",{className:"meetPage-videoPlayer-container",children:_p&&_s?jsxRuntimeExports.jsx(Video,{tracks:_s,users:_e}):""}),jsxRuntimeExports.jsx("div",{className:"meetPage-controls-part",children:_r&&_s&&jsxRuntimeExports.jsx(Controls,{tracks:_s})})]})};var Edit={},_interopRequireDefault=interopRequireDefaultExports;Object.defineProperty(Edit,"__esModule",{value:!0});var default_1=Edit.default=void 0,_createSvgIcon=_interopRequireDefault(requireCreateSvgIcon()),_jsxRuntime=jsxRuntimeExports,_default=(0,_createSvgIcon.default)((0,_jsxRuntime.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"Edit");default_1=Edit.default=_default;const defaultProfileImage="/assets/myImage-snpYQ0pP.png",ProfileCard=()=>{const{socket:e}=reactExports.useContext(SocketContext),o=localStorage.getItem("userName"),s=localStorage.getItem("userEmail"),a=localStorage.getItem("userId"),[_,$]=reactExports.useState(!1),[_e,_n]=reactExports.useState(o),_r=async()=>{try{await e.emit("update-user-details",{userId:a,updatedUsername:_e}),localStorage.setItem("userName",_e),$(!1),console.log("User details updated:",_e)}catch(_s){console.error("Error updating user details:",_s.message)}};return jsxRuntimeExports.jsxs("div",{className:"profile-card-body",children:[jsxRuntimeExports.jsx("button",{id:"update-details-btn",onClick:()=>$(!0),children:jsxRuntimeExports.jsx(default_1,{})}),jsxRuntimeExports.jsxs("div",{className:"profile-data",children:[jsxRuntimeExports.jsx("div",{className:"profile-img",children:jsxRuntimeExports.jsx("img",{src:defaultProfileImage,alt:"Profile"})}),_?jsxRuntimeExports.jsxs("div",{className:"update-data",children:[jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Update your name",value:_e,onChange:_s=>_n(_s.target.value)}),jsxRuntimeExports.jsx("button",{id:"update-btn",onClick:_r,children:"Update"})]}):jsxRuntimeExports.jsxs("div",{className:"profile-info",children:[jsxRuntimeExports.jsxs("p",{children:["Username: ",jsxRuntimeExports.jsx("span",{children:o})]}),jsxRuntimeExports.jsxs("p",{children:["Email Id: ",jsxRuntimeExports.jsx("span",{children:s})]})]})]})]})},MeetData=()=>{const[e,o]=reactExports.useState(!1),{socket:s,myMeets:a,setMyMeets:_}=reactExports.useContext(SocketContext),[$,_e]=reactExports.useState(""),[_n,_r]=reactExports.useState("none"),[_s,na]=reactExports.useState("none");reactExports.useEffect(()=>{const _p=_f=>{_(_f)};return s.on("room-deleted",({roomId:_f})=>{_p(_E=>_E.filter(_v=>_v._id!==_f))}),s.on("meet-details-updated",({roomId:_f})=>{_p(_E=>_E.map(_v=>_v._id===_f?{..._v,roomName:$,meetDate:_n,meetTime:_s}:_v))}),()=>{s.off("room-deleted"),s.off("meet-details-updated")}},[s,$,_n,_s,_]);const ba=_p=>{navigator.clipboard.writeText(_p)};return jsxRuntimeExports.jsxs("div",{className:"myMeets-body",children:[jsxRuntimeExports.jsx("div",{className:"myMeets-body-nav",children:jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{style:e?{borderBottom:"none"}:{borderBottom:"2px solid rgb(245, 252, 254, 0.7)"},onClick:()=>o(!1),children:"Upcoming meetings"}),jsxRuntimeExports.jsx("li",{style:e?{borderBottom:"2px solid rgb(245, 252, 254, 0.7)"}:{borderBottom:"none"},onClick:()=>o(!0),children:"Past meetings"})]})}),jsxRuntimeExports.jsx("div",{className:"myMeets-body-content",children:e?jsxRuntimeExports.jsx("div",{className:"past-meet-content",children:a.length>0?a.map(_p=>{if(_p.meetDate==="none"||_p.meetTime==="none"||_p.meetType==="instant"){const _f=new Date(_p.createdAt),_E=_f.getFullYear(),_v=String(_f.getMonth()+1).padStart(2,"0"),n_=String(_f.getDate()).padStart(2,"0"),e_=String(_f.getHours()).padStart(2,"0"),t_=String(_f.getMinutes()).padStart(2,"0");return jsxRuntimeExports.jsx("div",{className:"past-meet-card",children:jsxRuntimeExports.jsxs("div",{className:"details-controls",children:[jsxRuntimeExports.jsxs("div",{className:"meet-card-details",children:[jsxRuntimeExports.jsxs("p",{children:["Meet: ",jsxRuntimeExports.jsx("span",{children:_p.roomName})]}),jsxRuntimeExports.jsxs("p",{children:["Meet Id: ",jsxRuntimeExports.jsx("span",{children:_p._id}),jsxRuntimeExports.jsx("button",{className:"copyBtn",onClick:()=>ba(_p._id),children:"Copy Meet ID"})]})]}),jsxRuntimeExports.jsxs("div",{className:"meet-card-timings",children:[jsxRuntimeExports.jsx("h4",{children:"Timings:"}),jsxRuntimeExports.jsxs("div",{className:"meet-card-timings-details",children:[jsxRuntimeExports.jsxs("p",{children:["Date: ",jsxRuntimeExports.jsxs("span",{children:[n_,"/",_v,"/",_E]})]}),jsxRuntimeExports.jsxs("p",{children:["Created Time:"," ",jsxRuntimeExports.jsxs("span",{children:[e_,":",t_]})]})]})]})]})},_p._id)}else if(new Date>new Date(_p.meetDate+"T"+_p.meetTime)){const _f=new Date(_p.meetDate+"T"+_p.meetTime),_E=_f.getFullYear(),_v=String(_f.getMonth()+1).padStart(2,"0"),n_=String(_f.getDate()).padStart(2,"0"),e_=String(_f.getHours()).padStart(2,"0"),t_=String(_f.getMinutes()).padStart(2,"0");return jsxRuntimeExports.jsx("div",{className:"past-meet-card",children:jsxRuntimeExports.jsxs("div",{className:"details-controls",children:[jsxRuntimeExports.jsxs("div",{className:"meet-card-details",children:[jsxRuntimeExports.jsxs("p",{children:["Meet: ",jsxRuntimeExports.jsx("span",{children:_p.roomName})]}),jsxRuntimeExports.jsxs("p",{children:["Meet Id: ",jsxRuntimeExports.jsx("span",{children:_p._id}),jsxRuntimeExports.jsx("button",{className:"copyBtn",onClick:()=>ba(_p._id),children:"Copy Meet ID"})]})]}),jsxRuntimeExports.jsxs("div",{className:"meet-card-timings",children:[jsxRuntimeExports.jsx("h4",{children:"Timings:"}),jsxRuntimeExports.jsxs("div",{className:"meet-card-timings-details",children:[jsxRuntimeExports.jsxs("p",{children:["Date: ",jsxRuntimeExports.jsxs("span",{children:[n_,"/",_v,"/",_E]})]}),jsxRuntimeExports.jsxs("p",{children:["Created Time:"," ",jsxRuntimeExports.jsxs("span",{children:[e_,":",t_]})]})]})]})]})},_p._id)}return null}):jsxRuntimeExports.jsx("p",{children:"No past meets"})}):jsxRuntimeExports.jsx("div",{className:"upcoming-meet-content",children:a.length>0?a.map(_p=>{if(_p.meetDate!=="none"&&_p.meetTime!=="none"&&_p.meetType==="scheduled"){const _f=new Date,_E=new Date(_p.meetDate+"T"+_p.meetTime),_v=_E.getFullYear(),n_=String(_E.getMonth()+1).padStart(2,"0"),e_=String(_E.getDate()).padStart(2,"0"),t_=String(_E.getHours()).padStart(2,"0"),o_=String(_E.getMinutes()).padStart(2,"0");if(_f<_E)return jsxRuntimeExports.jsxs("div",{className:"upcoming-meet-card",children:[jsxRuntimeExports.jsxs("div",{className:"details-controls",children:[jsxRuntimeExports.jsxs("div",{className:"meet-card-details",children:[jsxRuntimeExports.jsxs("p",{children:["Meet: ",jsxRuntimeExports.jsx("span",{children:_p.roomName})]}),jsxRuntimeExports.jsxs("p",{children:["Meet Id: ",jsxRuntimeExports.jsx("span",{children:_p._id}),jsxRuntimeExports.jsx("button",{className:"copyBtn",onClick:()=>ba(_p._id),children:"Copy Meet ID"})]})]}),jsxRuntimeExports.jsxs("div",{className:"meet-card-controls",children:[jsxRuntimeExports.jsx(Link,{to:`/meet/${_p._id}`,children:jsxRuntimeExports.jsx("button",{className:"joinBtn",children:"Join"})}),jsxRuntimeExports.jsx("button",{className:"editBtn","data-bs-toggle":"modal","data-bs-target":`#editModal-${_p._id}`,onClick:()=>{_e(_p.roomName),_r(_p.meetDate),na(_p.meetTime)},children:"Edit"}),jsxRuntimeExports.jsx("button",{className:"deleteBtn",onClick:()=>{s.emit("delete-meet",{roomId:_p._id})},children:"Delete"})]})]}),jsxRuntimeExports.jsxs("div",{className:"meet-card-timings",children:[jsxRuntimeExports.jsx("h4",{children:"Timings:"}),jsxRuntimeExports.jsxs("div",{className:"meet-card-timings-details",children:[jsxRuntimeExports.jsxs("p",{children:["Date: ",jsxRuntimeExports.jsxs("span",{children:[e_,"/",n_,"/",_v]})]}),jsxRuntimeExports.jsxs("p",{children:["Created Time:"," ",jsxRuntimeExports.jsxs("span",{children:[t_,":",o_]})]})]})]}),jsxRuntimeExports.jsx("div",{className:"modal fade",id:`editModal-${_p._id}`,tabIndex:"-1","aria-labelledby":`editModalLabel-${_p._id}`,"aria-hidden":"true",children:jsxRuntimeExports.jsx("div",{className:"modal-dialog modal-dialog-centered",style:{width:"30vw"},children:jsxRuntimeExports.jsxs("div",{className:"modal-content",children:[jsxRuntimeExports.jsxs("div",{className:"modal-header",children:[jsxRuntimeExports.jsx("h5",{className:"modal-title",id:`editModalLabel-${_p._id}`,children:"Edit Meet"}),jsxRuntimeExports.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),jsxRuntimeExports.jsxs("div",{className:"modal-body",children:[jsxRuntimeExports.jsxs("div",{className:"form-floating mb-3",children:[jsxRuntimeExports.jsx("input",{type:"text",className:"form-control",id:`editFloatingInput-${_p._id}`,placeholder:"Name your meet",value:$,onChange:m_=>_e(m_.target.value)}),jsxRuntimeExports.jsx("label",{htmlFor:`editFloatingInput-${_p._id}`,children:"Meet name"})]}),jsxRuntimeExports.jsxs("p",{style:{margin:" 10px 0px 0px 0px",color:"rgb(2, 34, 58)"},children:["Meet Date:"," "]}),jsxRuntimeExports.jsx("input",{type:"date",className:"form-control",value:_n,onChange:m_=>_r(m_.target.value)}),jsxRuntimeExports.jsxs("p",{style:{margin:" 10px 0px 0px 0px",color:"rgb(2, 34, 58)"},children:["Meet Time:"," "]}),jsxRuntimeExports.jsx("input",{type:"time",className:"form-control",value:_s,onChange:m_=>na(m_.target.value)})]}),jsxRuntimeExports.jsxs("div",{className:"modal-footer",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",children:"Cancel"}),jsxRuntimeExports.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>s.emit("update-meet-details",{roomId:_p._id,roomName:$,newMeetDate:_n,newMeetTime:_s}),"data-bs-dismiss":"modal",children:"Update"})]})]})})})]},_p._id)}return null}):jsxRuntimeExports.jsx("p",{children:"No upcoming meets"})})})]})},Profile=()=>{const e=localStorage.getItem("userName"),o=localStorage.getItem("userId"),{socket:s,myMeets:a,setMyMeets:_}=reactExports.useContext(SocketContext),{logout:$}=reactExports.useContext(AuthContext),_e=useNavigate();reactExports.useEffect(()=>{s.emit("fetch-my-meets",{userId:o}),s.on("meets-fetched",async({myMeets:_r})=>{console.log("myMeets",_r),_(_r)})},[s]);const _n=_r=>{_r.preventDefault(),$()};return jsxRuntimeExports.jsxs("div",{className:"profilePage",children:[jsxRuntimeExports.jsxs("div",{className:"profile-header",children:[jsxRuntimeExports.jsx("div",{className:"profile-logo",children:jsxRuntimeExports.jsx("h2",{onClick:()=>_e("/"),children:"Vision Link"})}),jsxRuntimeExports.jsxs(Dropdown$1,{children:[jsxRuntimeExports.jsx(Dropdown$1.Toggle,{id:"dropdown-basic",children:e}),jsxRuntimeExports.jsxs(Dropdown$1.Menu,{children:[jsxRuntimeExports.jsx(Dropdown$1.Item,{as:"div",children:jsxRuntimeExports.jsx(Link,{className:"dropdown-options",to:"/",children:"Join meet"})}),jsxRuntimeExports.jsx(Dropdown$1.Item,{className:"dropdown-options",onClick:_n,children:"Logout"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"profile-body",children:[jsxRuntimeExports.jsx("div",{className:"profile-card-container",children:jsxRuntimeExports.jsx(ProfileCard,{})}),jsxRuntimeExports.jsx("div",{className:"meet-data-container",children:jsxRuntimeExports.jsx(MeetData,{})})]})]})};var bootstrap_bundle_min={exports:{}};/*!
  * Bootstrap v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(e,o){(function(s,a){e.exports=a()})(commonjsGlobal,function(){const s=new Map,a={set(u_,_d,i_){s.has(u_)||s.set(u_,new Map);const g_=s.get(u_);g_.has(_d)||g_.size===0?g_.set(_d,i_):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(g_.keys())[0]}.`)},get:(u_,_d)=>s.has(u_)&&s.get(u_).get(_d)||null,remove(u_,_d){if(!s.has(u_))return;const i_=s.get(u_);i_.delete(_d),i_.size===0&&s.delete(u_)}},_="transitionend",$=u_=>(u_&&window.CSS&&window.CSS.escape&&(u_=u_.replace(/#([^\s"#']+)/g,(_d,i_)=>`#${CSS.escape(i_)}`)),u_),_e=u_=>{u_.dispatchEvent(new Event(_))},_n=u_=>!(!u_||typeof u_!="object")&&(u_.jquery!==void 0&&(u_=u_[0]),u_.nodeType!==void 0),_r=u_=>_n(u_)?u_.jquery?u_[0]:u_:typeof u_=="string"&&u_.length>0?document.querySelector($(u_)):null,_s=u_=>{if(!_n(u_)||u_.getClientRects().length===0)return!1;const _d=getComputedStyle(u_).getPropertyValue("visibility")==="visible",i_=u_.closest("details:not([open])");if(!i_)return _d;if(i_!==u_){const g_=u_.closest("summary");if(g_&&g_.parentNode!==i_||g_===null)return!1}return _d},na=u_=>!u_||u_.nodeType!==Node.ELEMENT_NODE||!!u_.classList.contains("disabled")||(u_.disabled!==void 0?u_.disabled:u_.hasAttribute("disabled")&&u_.getAttribute("disabled")!=="false"),ba=u_=>{if(!document.documentElement.attachShadow)return null;if(typeof u_.getRootNode=="function"){const _d=u_.getRootNode();return _d instanceof ShadowRoot?_d:null}return u_ instanceof ShadowRoot?u_:u_.parentNode?ba(u_.parentNode):null},_p=()=>{},_f=u_=>{u_.offsetHeight},_E=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,_v=[],n_=()=>document.documentElement.dir==="rtl",e_=u_=>{var _d;_d=()=>{const i_=_E();if(i_){const g_=u_.NAME,x_=i_.fn[g_];i_.fn[g_]=u_.jQueryInterface,i_.fn[g_].Constructor=u_,i_.fn[g_].noConflict=()=>(i_.fn[g_]=x_,u_.jQueryInterface)}},document.readyState==="loading"?(_v.length||document.addEventListener("DOMContentLoaded",()=>{for(const i_ of _v)i_()}),_v.push(_d)):_d()},t_=(u_,_d=[],i_=u_)=>typeof u_=="function"?u_(..._d):i_,o_=(u_,_d,i_=!0)=>{if(!i_)return void t_(u_);const g_=(X_=>{if(!X_)return 0;let{transitionDuration:i0,transitionDelay:_0}=window.getComputedStyle(X_);const N0=Number.parseFloat(i0),P0=Number.parseFloat(_0);return N0||P0?(i0=i0.split(",")[0],_0=_0.split(",")[0],1e3*(Number.parseFloat(i0)+Number.parseFloat(_0))):0})(_d)+5;let x_=!1;const M_=({target:X_})=>{X_===_d&&(x_=!0,_d.removeEventListener(_,M_),t_(u_))};_d.addEventListener(_,M_),setTimeout(()=>{x_||_e(_d)},g_)},m_=(u_,_d,i_,g_)=>{const x_=u_.length;let M_=u_.indexOf(_d);return M_===-1?!i_&&g_?u_[x_-1]:u_[0]:(M_+=i_?1:-1,g_&&(M_=(M_+x_)%x_),u_[Math.max(0,Math.min(M_,x_-1))])},b_=/[^.]*(?=\..*)\.|.*/,w_=/\..*/,y_=/::\d+$/,N_={};let _y=1;const v_={mouseenter:"mouseover",mouseleave:"mouseout"},A_=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function k_(u_,_d){return _d&&`${_d}::${_y++}`||u_.uidEvent||_y++}function P_(u_){const _d=k_(u_);return u_.uidEvent=_d,N_[_d]=N_[_d]||{},N_[_d]}function T_(u_,_d,i_=null){return Object.values(u_).find(g_=>g_.callable===_d&&g_.delegationSelector===i_)}function R_(u_,_d,i_){const g_=typeof _d=="string",x_=g_?i_:_d||i_;let M_=n0(u_);return A_.has(M_)||(M_=u_),[g_,x_,M_]}function I_(u_,_d,i_,g_,x_){if(typeof _d!="string"||!u_)return;let[M_,X_,i0]=R_(_d,i_,g_);_d in v_&&(X_=(Q0=>function(J0){if(!J0.relatedTarget||J0.relatedTarget!==J0.delegateTarget&&!J0.delegateTarget.contains(J0.relatedTarget))return Q0.call(this,J0)})(X_));const _0=P_(u_),N0=_0[i0]||(_0[i0]={}),P0=T_(N0,X_,M_?i_:null);if(P0)return void(P0.oneOff=P0.oneOff&&x_);const R0=k_(X_,_d.replace(b_,"")),oS=M_?function(W0,Q0,J0){return function K0(xS){const DS=W0.querySelectorAll(Q0);for(let{target:fS}=xS;fS&&fS!==this;fS=fS.parentNode)for(const OS of DS)if(OS===fS)return s_(xS,{delegateTarget:fS}),K0.oneOff&&a_.off(W0,xS.type,Q0,J0),J0.apply(fS,[xS])}}(u_,i_,X_):function(W0,Q0){return function J0(K0){return s_(K0,{delegateTarget:W0}),J0.oneOff&&a_.off(W0,K0.type,Q0),Q0.apply(W0,[K0])}}(u_,X_);oS.delegationSelector=M_?i_:null,oS.callable=X_,oS.oneOff=x_,oS.uidEvent=R0,N0[R0]=oS,u_.addEventListener(i0,oS,M_)}function U_(u_,_d,i_,g_,x_){const M_=T_(_d[i_],g_,x_);M_&&(u_.removeEventListener(i_,M_,!!x_),delete _d[i_][M_.uidEvent])}function D_(u_,_d,i_,g_){const x_=_d[i_]||{};for(const[M_,X_]of Object.entries(x_))M_.includes(g_)&&U_(u_,_d,i_,X_.callable,X_.delegationSelector)}function n0(u_){return u_=u_.replace(w_,""),v_[u_]||u_}const a_={on(u_,_d,i_,g_){I_(u_,_d,i_,g_,!1)},one(u_,_d,i_,g_){I_(u_,_d,i_,g_,!0)},off(u_,_d,i_,g_){if(typeof _d!="string"||!u_)return;const[x_,M_,X_]=R_(_d,i_,g_),i0=X_!==_d,_0=P_(u_),N0=_0[X_]||{},P0=_d.startsWith(".");if(M_===void 0){if(P0)for(const R0 of Object.keys(_0))D_(u_,_0,R0,_d.slice(1));for(const[R0,oS]of Object.entries(N0)){const W0=R0.replace(y_,"");i0&&!_d.includes(W0)||U_(u_,_0,X_,oS.callable,oS.delegationSelector)}}else{if(!Object.keys(N0).length)return;U_(u_,_0,X_,M_,x_?i_:null)}},trigger(u_,_d,i_){if(typeof _d!="string"||!u_)return null;const g_=_E();let x_=null,M_=!0,X_=!0,i0=!1;_d!==n0(_d)&&g_&&(x_=g_.Event(_d,i_),g_(u_).trigger(x_),M_=!x_.isPropagationStopped(),X_=!x_.isImmediatePropagationStopped(),i0=x_.isDefaultPrevented());const _0=s_(new Event(_d,{bubbles:M_,cancelable:!0}),i_);return i0&&_0.preventDefault(),X_&&u_.dispatchEvent(_0),_0.defaultPrevented&&x_&&x_.preventDefault(),_0}};function s_(u_,_d={}){for(const[i_,g_]of Object.entries(_d))try{u_[i_]=g_}catch{Object.defineProperty(u_,i_,{configurable:!0,get:()=>g_})}return u_}function S_(u_){if(u_==="true")return!0;if(u_==="false")return!1;if(u_===Number(u_).toString())return Number(u_);if(u_===""||u_==="null")return null;if(typeof u_!="string")return u_;try{return JSON.parse(decodeURIComponent(u_))}catch{return u_}}function V_(u_){return u_.replace(/[A-Z]/g,_d=>`-${_d.toLowerCase()}`)}const W_={setDataAttribute(u_,_d,i_){u_.setAttribute(`data-bs-${V_(_d)}`,i_)},removeDataAttribute(u_,_d){u_.removeAttribute(`data-bs-${V_(_d)}`)},getDataAttributes(u_){if(!u_)return{};const _d={},i_=Object.keys(u_.dataset).filter(g_=>g_.startsWith("bs")&&!g_.startsWith("bsConfig"));for(const g_ of i_){let x_=g_.replace(/^bs/,"");x_=x_.charAt(0).toLowerCase()+x_.slice(1,x_.length),_d[x_]=S_(u_.dataset[g_])}return _d},getDataAttribute:(u_,_d)=>S_(u_.getAttribute(`data-bs-${V_(_d)}`))};class Y_{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(_d){return _d=this._mergeConfigObj(_d),_d=this._configAfterMerge(_d),this._typeCheckConfig(_d),_d}_configAfterMerge(_d){return _d}_mergeConfigObj(_d,i_){const g_=_n(i_)?W_.getDataAttribute(i_,"config"):{};return{...this.constructor.Default,...typeof g_=="object"?g_:{},..._n(i_)?W_.getDataAttributes(i_):{},...typeof _d=="object"?_d:{}}}_typeCheckConfig(_d,i_=this.constructor.DefaultType){for(const[x_,M_]of Object.entries(i_)){const X_=_d[x_],i0=_n(X_)?"element":(g_=X_)==null?`${g_}`:Object.prototype.toString.call(g_).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(M_).test(i0))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${x_}" provided type "${i0}" but expected type "${M_}".`)}var g_}}class e0 extends Y_{constructor(_d,i_){super(),(_d=_r(_d))&&(this._element=_d,this._config=this._getConfig(i_),a.set(this._element,this.constructor.DATA_KEY,this))}dispose(){a.remove(this._element,this.constructor.DATA_KEY),a_.off(this._element,this.constructor.EVENT_KEY);for(const _d of Object.getOwnPropertyNames(this))this[_d]=null}_queueCallback(_d,i_,g_=!0){o_(_d,i_,g_)}_getConfig(_d){return _d=this._mergeConfigObj(_d,this._element),_d=this._configAfterMerge(_d),this._typeCheckConfig(_d),_d}static getInstance(_d){return a.get(_r(_d),this.DATA_KEY)}static getOrCreateInstance(_d,i_={}){return this.getInstance(_d)||new this(_d,typeof i_=="object"?i_:null)}static get VERSION(){return"5.3.2"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(_d){return`${_d}${this.EVENT_KEY}`}}const F_=u_=>{let _d=u_.getAttribute("data-bs-target");if(!_d||_d==="#"){let i_=u_.getAttribute("href");if(!i_||!i_.includes("#")&&!i_.startsWith("."))return null;i_.includes("#")&&!i_.startsWith("#")&&(i_=`#${i_.split("#")[1]}`),_d=i_&&i_!=="#"?$(i_.trim()):null}return _d},H_={find:(u_,_d=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(_d,u_)),findOne:(u_,_d=document.documentElement)=>Element.prototype.querySelector.call(_d,u_),children:(u_,_d)=>[].concat(...u_.children).filter(i_=>i_.matches(_d)),parents(u_,_d){const i_=[];let g_=u_.parentNode.closest(_d);for(;g_;)i_.push(g_),g_=g_.parentNode.closest(_d);return i_},prev(u_,_d){let i_=u_.previousElementSibling;for(;i_;){if(i_.matches(_d))return[i_];i_=i_.previousElementSibling}return[]},next(u_,_d){let i_=u_.nextElementSibling;for(;i_;){if(i_.matches(_d))return[i_];i_=i_.nextElementSibling}return[]},focusableChildren(u_){const _d=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(i_=>`${i_}:not([tabindex^="-"])`).join(",");return this.find(_d,u_).filter(i_=>!na(i_)&&_s(i_))},getSelectorFromElement(u_){const _d=F_(u_);return _d&&H_.findOne(_d)?_d:null},getElementFromSelector(u_){const _d=F_(u_);return _d?H_.findOne(_d):null},getMultipleElementsFromSelector(u_){const _d=F_(u_);return _d?H_.find(_d):[]}},E0=(u_,_d="hide")=>{const i_=`click.dismiss${u_.EVENT_KEY}`,g_=u_.NAME;a_.on(document,i_,`[data-bs-dismiss="${g_}"]`,function(x_){if(["A","AREA"].includes(this.tagName)&&x_.preventDefault(),na(this))return;const M_=H_.getElementFromSelector(this)||this.closest(`.${g_}`);u_.getOrCreateInstance(M_)[_d]()})},d0=".bs.alert",m0=`close${d0}`,v0=`closed${d0}`;class u0 extends e0{static get NAME(){return"alert"}close(){if(a_.trigger(this._element,m0).defaultPrevented)return;this._element.classList.remove("show");const _d=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,_d)}_destroyElement(){this._element.remove(),a_.trigger(this._element,v0),this.dispose()}static jQueryInterface(_d){return this.each(function(){const i_=u0.getOrCreateInstance(this);if(typeof _d=="string"){if(i_[_d]===void 0||_d.startsWith("_")||_d==="constructor")throw new TypeError(`No method named "${_d}"`);i_[_d](this)}})}}E0(u0,"close"),e_(u0);const s0='[data-bs-toggle="button"]';class T0 extends e0{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(_d){return this.each(function(){const i_=T0.getOrCreateInstance(this);_d==="toggle"&&i_[_d]()})}}a_.on(document,"click.bs.button.data-api",s0,u_=>{u_.preventDefault();const _d=u_.target.closest(s0);T0.getOrCreateInstance(_d).toggle()}),e_(T0);const j0=".bs.swipe",J_=`touchstart${j0}`,g0=`touchmove${j0}`,A0=`touchend${j0}`,j_=`pointerdown${j0}`,o0=`pointerup${j0}`,w0={endCallback:null,leftCallback:null,rightCallback:null},k0={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class H0 extends Y_{constructor(_d,i_){super(),this._element=_d,_d&&H0.isSupported()&&(this._config=this._getConfig(i_),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return w0}static get DefaultType(){return k0}static get NAME(){return"swipe"}dispose(){a_.off(this._element,j0)}_start(_d){this._supportPointerEvents?this._eventIsPointerPenTouch(_d)&&(this._deltaX=_d.clientX):this._deltaX=_d.touches[0].clientX}_end(_d){this._eventIsPointerPenTouch(_d)&&(this._deltaX=_d.clientX-this._deltaX),this._handleSwipe(),t_(this._config.endCallback)}_move(_d){this._deltaX=_d.touches&&_d.touches.length>1?0:_d.touches[0].clientX-this._deltaX}_handleSwipe(){const _d=Math.abs(this._deltaX);if(_d<=40)return;const i_=_d/this._deltaX;this._deltaX=0,i_&&t_(i_>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(a_.on(this._element,j_,_d=>this._start(_d)),a_.on(this._element,o0,_d=>this._end(_d)),this._element.classList.add("pointer-event")):(a_.on(this._element,J_,_d=>this._start(_d)),a_.on(this._element,g0,_d=>this._move(_d)),a_.on(this._element,A0,_d=>this._end(_d)))}_eventIsPointerPenTouch(_d){return this._supportPointerEvents&&(_d.pointerType==="pen"||_d.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const U0=".bs.carousel",NS=".data-api",yS="next",SR="prev",BS="left",mR="right",XR=`slide${U0}`,dR=`slid${U0}`,dT=`keydown${U0}`,pT=`mouseenter${U0}`,iT=`mouseleave${U0}`,kR=`dragstart${U0}`,bT=`load${U0}${NS}`,rO=`click${U0}${NS}`,nI="carousel",iO="active",UI=".active",bI=".carousel-item",QR=UI+bI,HO={ArrowLeft:mR,ArrowRight:BS},SI={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},gR={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class kT extends e0{constructor(_d,i_){super(_d,i_),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=H_.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===nI&&this.cycle()}static get Default(){return SI}static get DefaultType(){return gR}static get NAME(){return"carousel"}next(){this._slide(yS)}nextWhenVisible(){!document.hidden&&_s(this._element)&&this.next()}prev(){this._slide(SR)}pause(){this._isSliding&&_e(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?a_.one(this._element,dR,()=>this.cycle()):this.cycle())}to(_d){const i_=this._getItems();if(_d>i_.length-1||_d<0)return;if(this._isSliding)return void a_.one(this._element,dR,()=>this.to(_d));const g_=this._getItemIndex(this._getActive());if(g_===_d)return;const x_=_d>g_?yS:SR;this._slide(x_,i_[_d])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(_d){return _d.defaultInterval=_d.interval,_d}_addEventListeners(){this._config.keyboard&&a_.on(this._element,dT,_d=>this._keydown(_d)),this._config.pause==="hover"&&(a_.on(this._element,pT,()=>this.pause()),a_.on(this._element,iT,()=>this._maybeEnableCycle())),this._config.touch&&H0.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const i_ of H_.find(".carousel-item img",this._element))a_.on(i_,kR,g_=>g_.preventDefault());const _d={leftCallback:()=>this._slide(this._directionToOrder(BS)),rightCallback:()=>this._slide(this._directionToOrder(mR)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new H0(this._element,_d)}_keydown(_d){if(/input|textarea/i.test(_d.target.tagName))return;const i_=HO[_d.key];i_&&(_d.preventDefault(),this._slide(this._directionToOrder(i_)))}_getItemIndex(_d){return this._getItems().indexOf(_d)}_setActiveIndicatorElement(_d){if(!this._indicatorsElement)return;const i_=H_.findOne(UI,this._indicatorsElement);i_.classList.remove(iO),i_.removeAttribute("aria-current");const g_=H_.findOne(`[data-bs-slide-to="${_d}"]`,this._indicatorsElement);g_&&(g_.classList.add(iO),g_.setAttribute("aria-current","true"))}_updateInterval(){const _d=this._activeElement||this._getActive();if(!_d)return;const i_=Number.parseInt(_d.getAttribute("data-bs-interval"),10);this._config.interval=i_||this._config.defaultInterval}_slide(_d,i_=null){if(this._isSliding)return;const g_=this._getActive(),x_=_d===yS,M_=i_||m_(this._getItems(),g_,x_,this._config.wrap);if(M_===g_)return;const X_=this._getItemIndex(M_),i0=R0=>a_.trigger(this._element,R0,{relatedTarget:M_,direction:this._orderToDirection(_d),from:this._getItemIndex(g_),to:X_});if(i0(XR).defaultPrevented||!g_||!M_)return;const _0=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(X_),this._activeElement=M_;const N0=x_?"carousel-item-start":"carousel-item-end",P0=x_?"carousel-item-next":"carousel-item-prev";M_.classList.add(P0),_f(M_),g_.classList.add(N0),M_.classList.add(N0),this._queueCallback(()=>{M_.classList.remove(N0,P0),M_.classList.add(iO),g_.classList.remove(iO,P0,N0),this._isSliding=!1,i0(dR)},g_,this._isAnimated()),_0&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return H_.findOne(QR,this._element)}_getItems(){return H_.find(bI,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(_d){return n_()?_d===BS?SR:yS:_d===BS?yS:SR}_orderToDirection(_d){return n_()?_d===SR?BS:mR:_d===SR?mR:BS}static jQueryInterface(_d){return this.each(function(){const i_=kT.getOrCreateInstance(this,_d);if(typeof _d!="number"){if(typeof _d=="string"){if(i_[_d]===void 0||_d.startsWith("_")||_d==="constructor")throw new TypeError(`No method named "${_d}"`);i_[_d]()}}else i_.to(_d)})}}a_.on(document,rO,"[data-bs-slide], [data-bs-slide-to]",function(u_){const _d=H_.getElementFromSelector(this);if(!_d||!_d.classList.contains(nI))return;u_.preventDefault();const i_=kT.getOrCreateInstance(_d),g_=this.getAttribute("data-bs-slide-to");return g_?(i_.to(g_),void i_._maybeEnableCycle()):W_.getDataAttribute(this,"slide")==="next"?(i_.next(),void i_._maybeEnableCycle()):(i_.prev(),void i_._maybeEnableCycle())}),a_.on(window,bT,()=>{const u_=H_.find('[data-bs-ride="carousel"]');for(const _d of u_)kT.getOrCreateInstance(_d)}),e_(kT);const VT=".bs.collapse",wN=`show${VT}`,RI=`shown${VT}`,tR=`hide${VT}`,ST=`hidden${VT}`,AR=`click${VT}.data-api`,RR="show",vS="collapse",TR="collapsing",rI=`:scope .${vS} .${vS}`,PT='[data-bs-toggle="collapse"]',hT={parent:null,toggle:!0},qO={parent:"(null|element)",toggle:"boolean"};class iI extends e0{constructor(_d,i_){super(_d,i_),this._isTransitioning=!1,this._triggerArray=[];const g_=H_.find(PT);for(const x_ of g_){const M_=H_.getSelectorFromElement(x_),X_=H_.find(M_).filter(i0=>i0===this._element);M_!==null&&X_.length&&this._triggerArray.push(x_)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return hT}static get DefaultType(){return qO}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let _d=[];if(this._config.parent&&(_d=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(x_=>x_!==this._element).map(x_=>iI.getOrCreateInstance(x_,{toggle:!1}))),_d.length&&_d[0]._isTransitioning||a_.trigger(this._element,wN).defaultPrevented)return;for(const x_ of _d)x_.hide();const i_=this._getDimension();this._element.classList.remove(vS),this._element.classList.add(TR),this._element.style[i_]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const g_=`scroll${i_[0].toUpperCase()+i_.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(TR),this._element.classList.add(vS,RR),this._element.style[i_]="",a_.trigger(this._element,RI)},this._element,!0),this._element.style[i_]=`${this._element[g_]}px`}hide(){if(this._isTransitioning||!this._isShown()||a_.trigger(this._element,tR).defaultPrevented)return;const _d=this._getDimension();this._element.style[_d]=`${this._element.getBoundingClientRect()[_d]}px`,_f(this._element),this._element.classList.add(TR),this._element.classList.remove(vS,RR);for(const i_ of this._triggerArray){const g_=H_.getElementFromSelector(i_);g_&&!this._isShown(g_)&&this._addAriaAndCollapsedClass([i_],!1)}this._isTransitioning=!0,this._element.style[_d]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(TR),this._element.classList.add(vS),a_.trigger(this._element,ST)},this._element,!0)}_isShown(_d=this._element){return _d.classList.contains(RR)}_configAfterMerge(_d){return _d.toggle=!!_d.toggle,_d.parent=_r(_d.parent),_d}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const _d=this._getFirstLevelChildren(PT);for(const i_ of _d){const g_=H_.getElementFromSelector(i_);g_&&this._addAriaAndCollapsedClass([i_],this._isShown(g_))}}_getFirstLevelChildren(_d){const i_=H_.find(rI,this._config.parent);return H_.find(_d,this._config.parent).filter(g_=>!i_.includes(g_))}_addAriaAndCollapsedClass(_d,i_){if(_d.length)for(const g_ of _d)g_.classList.toggle("collapsed",!i_),g_.setAttribute("aria-expanded",i_)}static jQueryInterface(_d){const i_={};return typeof _d=="string"&&/show|hide/.test(_d)&&(i_.toggle=!1),this.each(function(){const g_=iI.getOrCreateInstance(this,i_);if(typeof _d=="string"){if(g_[_d]===void 0)throw new TypeError(`No method named "${_d}"`);g_[_d]()}})}}a_.on(document,AR,PT,function(u_){(u_.target.tagName==="A"||u_.delegateTarget&&u_.delegateTarget.tagName==="A")&&u_.preventDefault();for(const _d of H_.getMultipleElementsFromSelector(this))iI.getOrCreateInstance(_d,{toggle:!1}).toggle()}),e_(iI);var IS="top",oT="bottom",fT="right",ZR="left",zO="auto",TI=[IS,oT,fT,ZR],tS="start",NR="end",_P="clippingParents",yP="viewport",bO="popper",bP="reference",SO=TI.reduce(function(u_,_d){return u_.concat([_d+"-"+tS,_d+"-"+NR])},[]),FI=[].concat(TI,[zO]).reduce(function(u_,_d){return u_.concat([_d,_d+"-"+tS,_d+"-"+NR])},[]),SP="beforeRead",jL="read",wR="afterRead",UL="beforeMain",RP="main",TP="afterMain",FL="beforeWrite",BL="write",VL="afterWrite",GL=[SP,jL,wR,UL,RP,TP,FL,BL,VL];function wI(u_){return u_?(u_.nodeName||"").toLowerCase():null}function xT(u_){if(u_==null)return window;if(u_.toString()!=="[object Window]"){var _d=u_.ownerDocument;return _d&&_d.defaultView||window}return u_}function RO(u_){return u_ instanceof xT(u_).Element||u_ instanceof Element}function mT(u_){return u_ instanceof xT(u_).HTMLElement||u_ instanceof HTMLElement}function h1(u_){return typeof ShadowRoot<"u"&&(u_ instanceof xT(u_).ShadowRoot||u_ instanceof ShadowRoot)}const CN={name:"applyStyles",enabled:!0,phase:"write",fn:function(u_){var _d=u_.state;Object.keys(_d.elements).forEach(function(i_){var g_=_d.styles[i_]||{},x_=_d.attributes[i_]||{},M_=_d.elements[i_];mT(M_)&&wI(M_)&&(Object.assign(M_.style,g_),Object.keys(x_).forEach(function(X_){var i0=x_[X_];i0===!1?M_.removeAttribute(X_):M_.setAttribute(X_,i0===!0?"":i0)}))})},effect:function(u_){var _d=u_.state,i_={popper:{position:_d.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(_d.elements.popper.style,i_.popper),_d.styles=i_,_d.elements.arrow&&Object.assign(_d.elements.arrow.style,i_.arrow),function(){Object.keys(_d.elements).forEach(function(g_){var x_=_d.elements[g_],M_=_d.attributes[g_]||{},X_=Object.keys(_d.styles.hasOwnProperty(g_)?_d.styles[g_]:i_[g_]).reduce(function(i0,_0){return i0[_0]="",i0},{});mT(x_)&&wI(x_)&&(Object.assign(x_.style,X_),Object.keys(M_).forEach(function(i0){x_.removeAttribute(i0)}))})}},requires:["computeStyles"]};function CI(u_){return u_.split("-")[0]}var BI=Math.max,f1=Math.min,TO=Math.round;function wP(){var u_=navigator.userAgentData;return u_!=null&&u_.brands&&Array.isArray(u_.brands)?u_.brands.map(function(_d){return _d.brand+"/"+_d.version}).join(" "):navigator.userAgent}function $L(){return!/^((?!chrome|android).)*safari/i.test(wP())}function KO(u_,_d,i_){_d===void 0&&(_d=!1),i_===void 0&&(i_=!1);var g_=u_.getBoundingClientRect(),x_=1,M_=1;_d&&mT(u_)&&(x_=u_.offsetWidth>0&&TO(g_.width)/u_.offsetWidth||1,M_=u_.offsetHeight>0&&TO(g_.height)/u_.offsetHeight||1);var X_=(RO(u_)?xT(u_):window).visualViewport,i0=!$L()&&i_,_0=(g_.left+(i0&&X_?X_.offsetLeft:0))/x_,N0=(g_.top+(i0&&X_?X_.offsetTop:0))/M_,P0=g_.width/x_,R0=g_.height/M_;return{width:P0,height:R0,top:N0,right:_0+P0,bottom:N0+R0,left:_0,x:_0,y:N0}}function CP(u_){var _d=KO(u_),i_=u_.offsetWidth,g_=u_.offsetHeight;return Math.abs(_d.width-i_)<=1&&(i_=_d.width),Math.abs(_d.height-g_)<=1&&(g_=_d.height),{x:u_.offsetLeft,y:u_.offsetTop,width:i_,height:g_}}function WL(u_,_d){var i_=_d.getRootNode&&_d.getRootNode();if(u_.contains(_d))return!0;if(i_&&h1(i_)){var g_=_d;do{if(g_&&u_.isSameNode(g_))return!0;g_=g_.parentNode||g_.host}while(g_)}return!1}function VI(u_){return xT(u_).getComputedStyle(u_)}function PF(u_){return["table","td","th"].indexOf(wI(u_))>=0}function oO(u_){return((RO(u_)?u_.ownerDocument:u_.document)||window.document).documentElement}function IN(u_){return wI(u_)==="html"?u_:u_.assignedSlot||u_.parentNode||(h1(u_)?u_.host:null)||oO(u_)}function HL(u_){return mT(u_)&&VI(u_).position!=="fixed"?u_.offsetParent:null}function ON(u_){for(var _d=xT(u_),i_=HL(u_);i_&&PF(i_)&&VI(i_).position==="static";)i_=HL(i_);return i_&&(wI(i_)==="html"||wI(i_)==="body"&&VI(i_).position==="static")?_d:i_||function(g_){var x_=/firefox/i.test(wP());if(/Trident/i.test(wP())&&mT(g_)&&VI(g_).position==="fixed")return null;var M_=IN(g_);for(h1(M_)&&(M_=M_.host);mT(M_)&&["html","body"].indexOf(wI(M_))<0;){var X_=VI(M_);if(X_.transform!=="none"||X_.perspective!=="none"||X_.contain==="paint"||["transform","perspective"].indexOf(X_.willChange)!==-1||x_&&X_.willChange==="filter"||x_&&X_.filter&&X_.filter!=="none")return M_;M_=M_.parentNode}return null}(u_)||_d}function IP(u_){return["top","bottom"].indexOf(u_)>=0?"x":"y"}function GI(u_,_d,i_){return BI(u_,f1(_d,i_))}function qL(u_){return Object.assign({},{top:0,right:0,bottom:0,left:0},u_)}function zL(u_,_d){return _d.reduce(function(i_,g_){return i_[g_]=u_,i_},{})}const KL={name:"arrow",enabled:!0,phase:"main",fn:function(u_){var _d,i_=u_.state,g_=u_.name,x_=u_.options,M_=i_.elements.arrow,X_=i_.modifiersData.popperOffsets,i0=CI(i_.placement),_0=IP(i0),N0=[ZR,fT].indexOf(i0)>=0?"height":"width";if(M_&&X_){var P0=function(VS,jS){return qL(typeof(VS=typeof VS=="function"?VS(Object.assign({},jS.rects,{placement:jS.placement})):VS)!="number"?VS:zL(VS,TI))}(x_.padding,i_),R0=CP(M_),oS=_0==="y"?IS:ZR,W0=_0==="y"?oT:fT,Q0=i_.rects.reference[N0]+i_.rects.reference[_0]-X_[_0]-i_.rects.popper[N0],J0=X_[_0]-i_.rects.reference[_0],K0=ON(M_),xS=K0?_0==="y"?K0.clientHeight||0:K0.clientWidth||0:0,DS=Q0/2-J0/2,fS=P0[oS],OS=xS-R0[N0]-P0[W0],Z0=xS/2-R0[N0]/2+DS,bS=GI(fS,Z0,OS),LS=_0;i_.modifiersData[g_]=((_d={})[LS]=bS,_d.centerOffset=bS-Z0,_d)}},effect:function(u_){var _d=u_.state,i_=u_.options.element,g_=i_===void 0?"[data-popper-arrow]":i_;g_!=null&&(typeof g_!="string"||(g_=_d.elements.popper.querySelector(g_)))&&WL(_d.elements.popper,g_)&&(_d.elements.arrow=g_)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function YO(u_){return u_.split("-")[1]}var YL={top:"auto",right:"auto",bottom:"auto",left:"auto"};function JL(u_){var _d,i_=u_.popper,g_=u_.popperRect,x_=u_.placement,M_=u_.variation,X_=u_.offsets,i0=u_.position,_0=u_.gpuAcceleration,N0=u_.adaptive,P0=u_.roundOffsets,R0=u_.isFixed,oS=X_.x,W0=oS===void 0?0:oS,Q0=X_.y,J0=Q0===void 0?0:Q0,K0=typeof P0=="function"?P0({x:W0,y:J0}):{x:W0,y:J0};W0=K0.x,J0=K0.y;var xS=X_.hasOwnProperty("x"),DS=X_.hasOwnProperty("y"),fS=ZR,OS=IS,Z0=window;if(N0){var bS=ON(i_),LS="clientHeight",VS="clientWidth";bS===xT(i_)&&VI(bS=oO(i_)).position!=="static"&&i0==="absolute"&&(LS="scrollHeight",VS="scrollWidth"),(x_===IS||(x_===ZR||x_===fT)&&M_===NR)&&(OS=oT,J0-=(R0&&bS===Z0&&Z0.visualViewport?Z0.visualViewport.height:bS[LS])-g_.height,J0*=_0?1:-1),x_!==ZR&&(x_!==IS&&x_!==oT||M_!==NR)||(fS=fT,W0-=(R0&&bS===Z0&&Z0.visualViewport?Z0.visualViewport.width:bS[VS])-g_.width,W0*=_0?1:-1)}var jS,CR=Object.assign({position:i0},N0&&YL),LT=P0===!0?function(sI,FR){var $T=sI.x,MT=sI.y,nR=FR.devicePixelRatio||1;return{x:TO($T*nR)/nR||0,y:TO(MT*nR)/nR||0}}({x:W0,y:J0},xT(i_)):{x:W0,y:J0};return W0=LT.x,J0=LT.y,_0?Object.assign({},CR,((jS={})[OS]=DS?"0":"",jS[fS]=xS?"0":"",jS.transform=(Z0.devicePixelRatio||1)<=1?"translate("+W0+"px, "+J0+"px)":"translate3d("+W0+"px, "+J0+"px, 0)",jS)):Object.assign({},CR,((_d={})[OS]=DS?J0+"px":"",_d[fS]=xS?W0+"px":"",_d.transform="",_d))}const OP={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(u_){var _d=u_.state,i_=u_.options,g_=i_.gpuAcceleration,x_=g_===void 0||g_,M_=i_.adaptive,X_=M_===void 0||M_,i0=i_.roundOffsets,_0=i0===void 0||i0,N0={placement:CI(_d.placement),variation:YO(_d.placement),popper:_d.elements.popper,popperRect:_d.rects.popper,gpuAcceleration:x_,isFixed:_d.options.strategy==="fixed"};_d.modifiersData.popperOffsets!=null&&(_d.styles.popper=Object.assign({},_d.styles.popper,JL(Object.assign({},N0,{offsets:_d.modifiersData.popperOffsets,position:_d.options.strategy,adaptive:X_,roundOffsets:_0})))),_d.modifiersData.arrow!=null&&(_d.styles.arrow=Object.assign({},_d.styles.arrow,JL(Object.assign({},N0,{offsets:_d.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:_0})))),_d.attributes.popper=Object.assign({},_d.attributes.popper,{"data-popper-placement":_d.placement})},data:{}};var m1={passive:!0};const wO={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(u_){var _d=u_.state,i_=u_.instance,g_=u_.options,x_=g_.scroll,M_=x_===void 0||x_,X_=g_.resize,i0=X_===void 0||X_,_0=xT(_d.elements.popper),N0=[].concat(_d.scrollParents.reference,_d.scrollParents.popper);return M_&&N0.forEach(function(P0){P0.addEventListener("scroll",i_.update,m1)}),i0&&_0.addEventListener("resize",i_.update,m1),function(){M_&&N0.forEach(function(P0){P0.removeEventListener("scroll",i_.update,m1)}),i0&&_0.removeEventListener("resize",i_.update,m1)}},data:{}};var oI={left:"right",right:"left",bottom:"top",top:"bottom"};function AN(u_){return u_.replace(/left|right|bottom|top/g,function(_d){return oI[_d]})}var XL={start:"end",end:"start"};function QL(u_){return u_.replace(/start|end/g,function(_d){return XL[_d]})}function AP(u_){var _d=xT(u_);return{scrollLeft:_d.pageXOffset,scrollTop:_d.pageYOffset}}function NP(u_){return KO(oO(u_)).left+AP(u_).scrollLeft}function DT(u_){var _d=VI(u_),i_=_d.overflow,g_=_d.overflowX,x_=_d.overflowY;return/auto|scroll|overlay|hidden/.test(i_+x_+g_)}function ZL(u_){return["html","body","#document"].indexOf(wI(u_))>=0?u_.ownerDocument.body:mT(u_)&&DT(u_)?u_:ZL(IN(u_))}function NN(u_,_d){var i_;_d===void 0&&(_d=[]);var g_=ZL(u_),x_=g_===((i_=u_.ownerDocument)==null?void 0:i_.body),M_=xT(g_),X_=x_?[M_].concat(M_.visualViewport||[],DT(g_)?g_:[]):g_,i0=_d.concat(X_);return x_?i0:i0.concat(NN(IN(X_)))}function kP(u_){return Object.assign({},u_,{left:u_.x,top:u_.y,right:u_.x+u_.width,bottom:u_.y+u_.height})}function kN(u_,_d,i_){return _d===yP?kP(function(g_,x_){var M_=xT(g_),X_=oO(g_),i0=M_.visualViewport,_0=X_.clientWidth,N0=X_.clientHeight,P0=0,R0=0;if(i0){_0=i0.width,N0=i0.height;var oS=$L();(oS||!oS&&x_==="fixed")&&(P0=i0.offsetLeft,R0=i0.offsetTop)}return{width:_0,height:N0,x:P0+NP(g_),y:R0}}(u_,i_)):RO(_d)?function(g_,x_){var M_=KO(g_,!1,x_==="fixed");return M_.top=M_.top+g_.clientTop,M_.left=M_.left+g_.clientLeft,M_.bottom=M_.top+g_.clientHeight,M_.right=M_.left+g_.clientWidth,M_.width=g_.clientWidth,M_.height=g_.clientHeight,M_.x=M_.left,M_.y=M_.top,M_}(_d,i_):kP(function(g_){var x_,M_=oO(g_),X_=AP(g_),i0=(x_=g_.ownerDocument)==null?void 0:x_.body,_0=BI(M_.scrollWidth,M_.clientWidth,i0?i0.scrollWidth:0,i0?i0.clientWidth:0),N0=BI(M_.scrollHeight,M_.clientHeight,i0?i0.scrollHeight:0,i0?i0.clientHeight:0),P0=-X_.scrollLeft+NP(g_),R0=-X_.scrollTop;return VI(i0||M_).direction==="rtl"&&(P0+=BI(M_.clientWidth,i0?i0.clientWidth:0)-_0),{width:_0,height:N0,x:P0,y:R0}}(oO(u_)))}function PP(u_){var _d,i_=u_.reference,g_=u_.element,x_=u_.placement,M_=x_?CI(x_):null,X_=x_?YO(x_):null,i0=i_.x+i_.width/2-g_.width/2,_0=i_.y+i_.height/2-g_.height/2;switch(M_){case IS:_d={x:i0,y:i_.y-g_.height};break;case oT:_d={x:i0,y:i_.y+i_.height};break;case fT:_d={x:i_.x+i_.width,y:_0};break;case ZR:_d={x:i_.x-g_.width,y:_0};break;default:_d={x:i_.x,y:i_.y}}var N0=M_?IP(M_):null;if(N0!=null){var P0=N0==="y"?"height":"width";switch(X_){case tS:_d[N0]=_d[N0]-(i_[P0]/2-g_[P0]/2);break;case NR:_d[N0]=_d[N0]+(i_[P0]/2-g_[P0]/2)}}return _d}function JO(u_,_d){_d===void 0&&(_d={});var i_=_d,g_=i_.placement,x_=g_===void 0?u_.placement:g_,M_=i_.strategy,X_=M_===void 0?u_.strategy:M_,i0=i_.boundary,_0=i0===void 0?_P:i0,N0=i_.rootBoundary,P0=N0===void 0?yP:N0,R0=i_.elementContext,oS=R0===void 0?bO:R0,W0=i_.altBoundary,Q0=W0!==void 0&&W0,J0=i_.padding,K0=J0===void 0?0:J0,xS=qL(typeof K0!="number"?K0:zL(K0,TI)),DS=oS===bO?bP:bO,fS=u_.rects.popper,OS=u_.elements[Q0?DS:oS],Z0=function(FR,$T,MT,nR){var HT=$T==="clippingParents"?function(YS){var gT=NN(IN(YS)),qT=["absolute","fixed"].indexOf(VI(YS).position)>=0&&mT(YS)?ON(YS):YS;return RO(qT)?gT.filter(function(aI){return RO(aI)&&WL(aI,qT)&&wI(aI)!=="body"}):[]}(FR):[].concat($T),II=[].concat(HT,[MT]),tN=II[0],BR=II.reduce(function(YS,gT){var qT=kN(FR,gT,nR);return YS.top=BI(qT.top,YS.top),YS.right=f1(qT.right,YS.right),YS.bottom=f1(qT.bottom,YS.bottom),YS.left=BI(qT.left,YS.left),YS},kN(FR,tN,nR));return BR.width=BR.right-BR.left,BR.height=BR.bottom-BR.top,BR.x=BR.left,BR.y=BR.top,BR}(RO(OS)?OS:OS.contextElement||oO(u_.elements.popper),_0,P0,X_),bS=KO(u_.elements.reference),LS=PP({reference:bS,element:fS,strategy:"absolute",placement:x_}),VS=kP(Object.assign({},fS,LS)),jS=oS===bO?VS:bS,CR={top:Z0.top-jS.top+xS.top,bottom:jS.bottom-Z0.bottom+xS.bottom,left:Z0.left-jS.left+xS.left,right:jS.right-Z0.right+xS.right},LT=u_.modifiersData.offset;if(oS===bO&&LT){var sI=LT[x_];Object.keys(CR).forEach(function(FR){var $T=[fT,oT].indexOf(FR)>=0?1:-1,MT=[IS,oT].indexOf(FR)>=0?"y":"x";CR[FR]+=sI[MT]*$T})}return CR}function xP(u_,_d){_d===void 0&&(_d={});var i_=_d,g_=i_.placement,x_=i_.boundary,M_=i_.rootBoundary,X_=i_.padding,i0=i_.flipVariations,_0=i_.allowedAutoPlacements,N0=_0===void 0?FI:_0,P0=YO(g_),R0=P0?i0?SO:SO.filter(function(Q0){return YO(Q0)===P0}):TI,oS=R0.filter(function(Q0){return N0.indexOf(Q0)>=0});oS.length===0&&(oS=R0);var W0=oS.reduce(function(Q0,J0){return Q0[J0]=JO(u_,{placement:J0,boundary:x_,rootBoundary:M_,padding:X_})[CI(J0)],Q0},{});return Object.keys(W0).sort(function(Q0,J0){return W0[Q0]-W0[J0]})}const eM={name:"flip",enabled:!0,phase:"main",fn:function(u_){var _d=u_.state,i_=u_.options,g_=u_.name;if(!_d.modifiersData[g_]._skip){for(var x_=i_.mainAxis,M_=x_===void 0||x_,X_=i_.altAxis,i0=X_===void 0||X_,_0=i_.fallbackPlacements,N0=i_.padding,P0=i_.boundary,R0=i_.rootBoundary,oS=i_.altBoundary,W0=i_.flipVariations,Q0=W0===void 0||W0,J0=i_.allowedAutoPlacements,K0=_d.options.placement,xS=CI(K0),DS=_0||(xS!==K0&&Q0?function(YS){if(CI(YS)===zO)return[];var gT=AN(YS);return[QL(YS),gT,QL(gT)]}(K0):[AN(K0)]),fS=[K0].concat(DS).reduce(function(YS,gT){return YS.concat(CI(gT)===zO?xP(_d,{placement:gT,boundary:P0,rootBoundary:R0,padding:N0,flipVariations:Q0,allowedAutoPlacements:J0}):gT)},[]),OS=_d.rects.reference,Z0=_d.rects.popper,bS=new Map,LS=!0,VS=fS[0],jS=0;jS<fS.length;jS++){var CR=fS[jS],LT=CI(CR),sI=YO(CR)===tS,FR=[IS,oT].indexOf(LT)>=0,$T=FR?"width":"height",MT=JO(_d,{placement:CR,boundary:P0,rootBoundary:R0,altBoundary:oS,padding:N0}),nR=FR?sI?fT:ZR:sI?oT:IS;OS[$T]>Z0[$T]&&(nR=AN(nR));var HT=AN(nR),II=[];if(M_&&II.push(MT[LT]<=0),i0&&II.push(MT[nR]<=0,MT[HT]<=0),II.every(function(YS){return YS})){VS=CR,LS=!1;break}bS.set(CR,II)}if(LS)for(var tN=function(YS){var gT=fS.find(function(qT){var aI=bS.get(qT);if(aI)return aI.slice(0,YS).every(function(N1){return N1})});if(gT)return VS=gT,"break"},BR=Q0?3:1;BR>0&&tN(BR)!=="break";BR--);_d.placement!==VS&&(_d.modifiersData[g_]._skip=!0,_d.placement=VS,_d.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function tM(u_,_d,i_){return i_===void 0&&(i_={x:0,y:0}),{top:u_.top-_d.height-i_.y,right:u_.right-_d.width+i_.x,bottom:u_.bottom-_d.height+i_.y,left:u_.left-_d.width-i_.x}}function nM(u_){return[IS,fT,oT,ZR].some(function(_d){return u_[_d]>=0})}const rM={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(u_){var _d=u_.state,i_=u_.name,g_=_d.rects.reference,x_=_d.rects.popper,M_=_d.modifiersData.preventOverflow,X_=JO(_d,{elementContext:"reference"}),i0=JO(_d,{altBoundary:!0}),_0=tM(X_,g_),N0=tM(i0,x_,M_),P0=nM(_0),R0=nM(N0);_d.modifiersData[i_]={referenceClippingOffsets:_0,popperEscapeOffsets:N0,isReferenceHidden:P0,hasPopperEscaped:R0},_d.attributes.popper=Object.assign({},_d.attributes.popper,{"data-popper-reference-hidden":P0,"data-popper-escaped":R0})}},iM={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(u_){var _d=u_.state,i_=u_.options,g_=u_.name,x_=i_.offset,M_=x_===void 0?[0,0]:x_,X_=FI.reduce(function(P0,R0){return P0[R0]=function(oS,W0,Q0){var J0=CI(oS),K0=[ZR,IS].indexOf(J0)>=0?-1:1,xS=typeof Q0=="function"?Q0(Object.assign({},W0,{placement:oS})):Q0,DS=xS[0],fS=xS[1];return DS=DS||0,fS=(fS||0)*K0,[ZR,fT].indexOf(J0)>=0?{x:fS,y:DS}:{x:DS,y:fS}}(R0,_d.rects,M_),P0},{}),i0=X_[_d.placement],_0=i0.x,N0=i0.y;_d.modifiersData.popperOffsets!=null&&(_d.modifiersData.popperOffsets.x+=_0,_d.modifiersData.popperOffsets.y+=N0),_d.modifiersData[g_]=X_}},DP={name:"popperOffsets",enabled:!0,phase:"read",fn:function(u_){var _d=u_.state,i_=u_.name;_d.modifiersData[i_]=PP({reference:_d.rects.reference,element:_d.rects.popper,strategy:"absolute",placement:_d.placement})},data:{}},sO={name:"preventOverflow",enabled:!0,phase:"main",fn:function(u_){var _d=u_.state,i_=u_.options,g_=u_.name,x_=i_.mainAxis,M_=x_===void 0||x_,X_=i_.altAxis,i0=X_!==void 0&&X_,_0=i_.boundary,N0=i_.rootBoundary,P0=i_.altBoundary,R0=i_.padding,oS=i_.tether,W0=oS===void 0||oS,Q0=i_.tetherOffset,J0=Q0===void 0?0:Q0,K0=JO(_d,{boundary:_0,rootBoundary:N0,padding:R0,altBoundary:P0}),xS=CI(_d.placement),DS=YO(_d.placement),fS=!DS,OS=IP(xS),Z0=OS==="x"?"y":"x",bS=_d.modifiersData.popperOffsets,LS=_d.rects.reference,VS=_d.rects.popper,jS=typeof J0=="function"?J0(Object.assign({},_d.rects,{placement:_d.placement})):J0,CR=typeof jS=="number"?{mainAxis:jS,altAxis:jS}:Object.assign({mainAxis:0,altAxis:0},jS),LT=_d.modifiersData.offset?_d.modifiersData.offset[_d.placement]:null,sI={x:0,y:0};if(bS){if(M_){var FR,$T=OS==="y"?IS:ZR,MT=OS==="y"?oT:fT,nR=OS==="y"?"height":"width",HT=bS[OS],II=HT+K0[$T],tN=HT-K0[MT],BR=W0?-VS[nR]/2:0,YS=DS===tS?LS[nR]:VS[nR],gT=DS===tS?-VS[nR]:-LS[nR],qT=_d.elements.arrow,aI=W0&&qT?CP(qT):{width:0,height:0},N1=_d.modifiersData["arrow#persistent"]?_d.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},nN=N1[$T],k1=N1[MT],P1=GI(0,LS[nR],aI[nR]),_D=fS?LS[nR]/2-BR-P1-nN-CR.mainAxis:YS-P1-nN-CR.mainAxis,kV=fS?-LS[nR]/2+BR+P1+k1+CR.mainAxis:gT+P1+k1+CR.mainAxis,rN=_d.elements.arrow&&ON(_d.elements.arrow),$N=rN?OS==="y"?rN.clientTop||0:rN.clientLeft||0:0,WN=(FR=LT==null?void 0:LT[OS])!=null?FR:0,eL=HT+kV-WN,$M=GI(W0?f1(II,HT+_D-WN-$N):II,HT,W0?BI(tN,eL):tN);bS[OS]=$M,sI[OS]=$M-HT}if(i0){var WM,HM=OS==="x"?IS:ZR,PV=OS==="x"?oT:fT,lO=bS[Z0],iN=Z0==="y"?"height":"width",qM=lO+K0[HM],zM=lO-K0[PV],HN=[IS,ZR].indexOf(xS)!==-1,x1=(WM=LT==null?void 0:LT[Z0])!=null?WM:0,KM=HN?qM:lO-LS[iN]-VS[iN]-x1+CR.altAxis,YM=HN?lO+LS[iN]+VS[iN]-x1-CR.altAxis:zM,tL=W0&&HN?function(nL,xV,KI){var JM=GI(nL,xV,KI);return JM>KI?KI:JM}(KM,lO,YM):GI(W0?KM:qM,lO,W0?YM:zM);bS[Z0]=tL,sI[Z0]=tL-lO}_d.modifiersData[g_]=sI}},requiresIfExists:["offset"]};function g1(u_,_d,i_){i_===void 0&&(i_=!1);var g_,x_,M_=mT(_d),X_=mT(_d)&&function(R0){var oS=R0.getBoundingClientRect(),W0=TO(oS.width)/R0.offsetWidth||1,Q0=TO(oS.height)/R0.offsetHeight||1;return W0!==1||Q0!==1}(_d),i0=oO(_d),_0=KO(u_,X_,i_),N0={scrollLeft:0,scrollTop:0},P0={x:0,y:0};return(M_||!M_&&!i_)&&((wI(_d)!=="body"||DT(i0))&&(N0=(g_=_d)!==xT(g_)&&mT(g_)?{scrollLeft:(x_=g_).scrollLeft,scrollTop:x_.scrollTop}:AP(g_)),mT(_d)?((P0=KO(_d,!0)).x+=_d.clientLeft,P0.y+=_d.clientTop):i0&&(P0.x=NP(i0))),{x:_0.left+N0.scrollLeft-P0.x,y:_0.top+N0.scrollTop-P0.y,width:_0.width,height:_0.height}}function xF(u_){var _d=new Map,i_=new Set,g_=[];function x_(M_){i_.add(M_.name),[].concat(M_.requires||[],M_.requiresIfExists||[]).forEach(function(X_){if(!i_.has(X_)){var i0=_d.get(X_);i0&&x_(i0)}}),g_.push(M_)}return u_.forEach(function(M_){_d.set(M_.name,M_)}),u_.forEach(function(M_){i_.has(M_.name)||x_(M_)}),g_}var oM={placement:"bottom",modifiers:[],strategy:"absolute"};function sM(){for(var u_=arguments.length,_d=new Array(u_),i_=0;i_<u_;i_++)_d[i_]=arguments[i_];return!_d.some(function(g_){return!(g_&&typeof g_.getBoundingClientRect=="function")})}function E1(u_){u_===void 0&&(u_={});var _d=u_,i_=_d.defaultModifiers,g_=i_===void 0?[]:i_,x_=_d.defaultOptions,M_=x_===void 0?oM:x_;return function(X_,i0,_0){_0===void 0&&(_0=M_);var N0,P0,R0={placement:"bottom",orderedModifiers:[],options:Object.assign({},oM,M_),modifiersData:{},elements:{reference:X_,popper:i0},attributes:{},styles:{}},oS=[],W0=!1,Q0={state:R0,setOptions:function(K0){var xS=typeof K0=="function"?K0(R0.options):K0;J0(),R0.options=Object.assign({},M_,R0.options,xS),R0.scrollParents={reference:RO(X_)?NN(X_):X_.contextElement?NN(X_.contextElement):[],popper:NN(i0)};var DS,fS,OS=function(Z0){var bS=xF(Z0);return GL.reduce(function(LS,VS){return LS.concat(bS.filter(function(jS){return jS.phase===VS}))},[])}((DS=[].concat(g_,R0.options.modifiers),fS=DS.reduce(function(Z0,bS){var LS=Z0[bS.name];return Z0[bS.name]=LS?Object.assign({},LS,bS,{options:Object.assign({},LS.options,bS.options),data:Object.assign({},LS.data,bS.data)}):bS,Z0},{}),Object.keys(fS).map(function(Z0){return fS[Z0]})));return R0.orderedModifiers=OS.filter(function(Z0){return Z0.enabled}),R0.orderedModifiers.forEach(function(Z0){var bS=Z0.name,LS=Z0.options,VS=LS===void 0?{}:LS,jS=Z0.effect;if(typeof jS=="function"){var CR=jS({state:R0,name:bS,instance:Q0,options:VS});oS.push(CR||function(){})}}),Q0.update()},forceUpdate:function(){if(!W0){var K0=R0.elements,xS=K0.reference,DS=K0.popper;if(sM(xS,DS)){R0.rects={reference:g1(xS,ON(DS),R0.options.strategy==="fixed"),popper:CP(DS)},R0.reset=!1,R0.placement=R0.options.placement,R0.orderedModifiers.forEach(function(jS){return R0.modifiersData[jS.name]=Object.assign({},jS.data)});for(var fS=0;fS<R0.orderedModifiers.length;fS++)if(R0.reset!==!0){var OS=R0.orderedModifiers[fS],Z0=OS.fn,bS=OS.options,LS=bS===void 0?{}:bS,VS=OS.name;typeof Z0=="function"&&(R0=Z0({state:R0,options:LS,name:VS,instance:Q0})||R0)}else R0.reset=!1,fS=-1}}},update:(N0=function(){return new Promise(function(K0){Q0.forceUpdate(),K0(R0)})},function(){return P0||(P0=new Promise(function(K0){Promise.resolve().then(function(){P0=void 0,K0(N0())})})),P0}),destroy:function(){J0(),W0=!0}};if(!sM(X_,i0))return Q0;function J0(){oS.forEach(function(K0){return K0()}),oS=[]}return Q0.setOptions(_0).then(function(K0){!W0&&_0.onFirstUpdate&&_0.onFirstUpdate(K0)}),Q0}}var DF=E1(),XO=E1({defaultModifiers:[wO,DP,OP,CN]}),LP=E1({defaultModifiers:[wO,DP,OP,CN,iM,eM,sO,KL,rM]});const CO=Object.freeze(Object.defineProperty({__proto__:null,afterMain:TP,afterRead:wR,afterWrite:VL,applyStyles:CN,arrow:KL,auto:zO,basePlacements:TI,beforeMain:UL,beforeRead:SP,beforeWrite:FL,bottom:oT,clippingParents:_P,computeStyles:OP,createPopper:LP,createPopperBase:DF,createPopperLite:XO,detectOverflow:JO,end:NR,eventListeners:wO,flip:eM,hide:rM,left:ZR,main:RP,modifierPhases:GL,offset:iM,placements:FI,popper:bO,popperGenerator:E1,popperOffsets:DP,preventOverflow:sO,read:jL,reference:bP,right:fT,start:tS,top:IS,variationPlacements:SO,viewport:yP,write:BL},Symbol.toStringTag,{value:"Module"})),MP="dropdown",IO=".bs.dropdown",PR=".data-api",LF="ArrowUp",aM="ArrowDown",jP=`hide${IO}`,MF=`hidden${IO}`,UF=`show${IO}`,FF=`shown${IO}`,$I=`click${IO}${PR}`,cM=`keydown${IO}${PR}`,BF=`keyup${IO}${PR}`,QO="show",OO='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',VF=`${OO}.${QO}`,PN=".dropdown-menu",GF=n_()?"top-end":"top-start",$F=n_()?"top-start":"top-end",UP=n_()?"bottom-end":"bottom-start",v1=n_()?"bottom-start":"bottom-end",WF=n_()?"left-start":"right-start",uM=n_()?"right-start":"left-start",HF={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},zF={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class UR extends e0{constructor(_d,i_){super(_d,i_),this._popper=null,this._parent=this._element.parentNode,this._menu=H_.next(this._element,PN)[0]||H_.prev(this._element,PN)[0]||H_.findOne(PN,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return HF}static get DefaultType(){return zF}static get NAME(){return MP}toggle(){return this._isShown()?this.hide():this.show()}show(){if(na(this._element)||this._isShown())return;const _d={relatedTarget:this._element};if(!a_.trigger(this._element,UF,_d).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const i_ of[].concat(...document.body.children))a_.on(i_,"mouseover",_p);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(QO),this._element.classList.add(QO),a_.trigger(this._element,FF,_d)}}hide(){if(na(this._element)||!this._isShown())return;const _d={relatedTarget:this._element};this._completeHide(_d)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(_d){if(!a_.trigger(this._element,jP,_d).defaultPrevented){if("ontouchstart"in document.documentElement)for(const i_ of[].concat(...document.body.children))a_.off(i_,"mouseover",_p);this._popper&&this._popper.destroy(),this._menu.classList.remove(QO),this._element.classList.remove(QO),this._element.setAttribute("aria-expanded","false"),W_.removeDataAttribute(this._menu,"popper"),a_.trigger(this._element,MF,_d)}}_getConfig(_d){if(typeof(_d=super._getConfig(_d)).reference=="object"&&!_n(_d.reference)&&typeof _d.reference.getBoundingClientRect!="function")throw new TypeError(`${MP.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return _d}_createPopper(){if(CO===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let _d=this._element;this._config.reference==="parent"?_d=this._parent:_n(this._config.reference)?_d=_r(this._config.reference):typeof this._config.reference=="object"&&(_d=this._config.reference);const i_=this._getPopperConfig();this._popper=LP(_d,this._menu,i_)}_isShown(){return this._menu.classList.contains(QO)}_getPlacement(){const _d=this._parent;if(_d.classList.contains("dropend"))return WF;if(_d.classList.contains("dropstart"))return uM;if(_d.classList.contains("dropup-center"))return"top";if(_d.classList.contains("dropdown-center"))return"bottom";const i_=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return _d.classList.contains("dropup")?i_?$F:GF:i_?v1:UP}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:_d}=this._config;return typeof _d=="string"?_d.split(",").map(i_=>Number.parseInt(i_,10)):typeof _d=="function"?i_=>_d(i_,this._element):_d}_getPopperConfig(){const _d={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(W_.setDataAttribute(this._menu,"popper","static"),_d.modifiers=[{name:"applyStyles",enabled:!1}]),{..._d,...t_(this._config.popperConfig,[_d])}}_selectMenuItem({key:_d,target:i_}){const g_=H_.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(x_=>_s(x_));g_.length&&m_(g_,i_,_d===aM,!g_.includes(i_)).focus()}static jQueryInterface(_d){return this.each(function(){const i_=UR.getOrCreateInstance(this,_d);if(typeof _d=="string"){if(i_[_d]===void 0)throw new TypeError(`No method named "${_d}"`);i_[_d]()}})}static clearMenus(_d){if(_d.button===2||_d.type==="keyup"&&_d.key!=="Tab")return;const i_=H_.find(VF);for(const g_ of i_){const x_=UR.getInstance(g_);if(!x_||x_._config.autoClose===!1)continue;const M_=_d.composedPath(),X_=M_.includes(x_._menu);if(M_.includes(x_._element)||x_._config.autoClose==="inside"&&!X_||x_._config.autoClose==="outside"&&X_||x_._menu.contains(_d.target)&&(_d.type==="keyup"&&_d.key==="Tab"||/input|select|option|textarea|form/i.test(_d.target.tagName)))continue;const i0={relatedTarget:x_._element};_d.type==="click"&&(i0.clickEvent=_d),x_._completeHide(i0)}}static dataApiKeydownHandler(_d){const i_=/input|textarea/i.test(_d.target.tagName),g_=_d.key==="Escape",x_=[LF,aM].includes(_d.key);if(!x_&&!g_||i_&&!g_)return;_d.preventDefault();const M_=this.matches(OO)?this:H_.prev(this,OO)[0]||H_.next(this,OO)[0]||H_.findOne(OO,_d.delegateTarget.parentNode),X_=UR.getOrCreateInstance(M_);if(x_)return _d.stopPropagation(),X_.show(),void X_._selectMenuItem(_d);X_._isShown()&&(_d.stopPropagation(),X_.hide(),M_.focus())}}a_.on(document,cM,OO,UR.dataApiKeydownHandler),a_.on(document,cM,PN,UR.dataApiKeydownHandler),a_.on(document,$I,UR.clearMenus),a_.on(document,BF,UR.clearMenus),a_.on(document,$I,OO,function(u_){u_.preventDefault(),UR.getOrCreateInstance(this).toggle()}),e_(UR);const lM="backdrop",dM="show",pM=`mousedown.bs.${lM}`,FP={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},hM={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class WI extends Y_{constructor(_d){super(),this._config=this._getConfig(_d),this._isAppended=!1,this._element=null}static get Default(){return FP}static get DefaultType(){return hM}static get NAME(){return lM}show(_d){if(!this._config.isVisible)return void t_(_d);this._append();const i_=this._getElement();this._config.isAnimated&&_f(i_),i_.classList.add(dM),this._emulateAnimation(()=>{t_(_d)})}hide(_d){this._config.isVisible?(this._getElement().classList.remove(dM),this._emulateAnimation(()=>{this.dispose(),t_(_d)})):t_(_d)}dispose(){this._isAppended&&(a_.off(this._element,pM),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const _d=document.createElement("div");_d.className=this._config.className,this._config.isAnimated&&_d.classList.add("fade"),this._element=_d}return this._element}_configAfterMerge(_d){return _d.rootElement=_r(_d.rootElement),_d}_append(){if(this._isAppended)return;const _d=this._getElement();this._config.rootElement.append(_d),a_.on(_d,pM,()=>{t_(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(_d){o_(_d,this._getElement(),this._config.isAnimated)}}const xN=".bs.focustrap",fM=`focusin${xN}`,_1=`keydown.tab${xN}`,aO="backward",KF={autofocus:!0,trapElement:null},YF={autofocus:"boolean",trapElement:"element"};class BP extends Y_{constructor(_d){super(),this._config=this._getConfig(_d),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return KF}static get DefaultType(){return YF}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),a_.off(document,xN),a_.on(document,fM,_d=>this._handleFocusin(_d)),a_.on(document,_1,_d=>this._handleKeydown(_d)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,a_.off(document,xN))}_handleFocusin(_d){const{trapElement:i_}=this._config;if(_d.target===document||_d.target===i_||i_.contains(_d.target))return;const g_=H_.focusableChildren(i_);g_.length===0?i_.focus():this._lastTabNavDirection===aO?g_[g_.length-1].focus():g_[0].focus()}_handleKeydown(_d){_d.key==="Tab"&&(this._lastTabNavDirection=_d.shiftKey?aO:"forward")}}const y1=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",mM=".sticky-top",DN="padding-right",VP="margin-right";class b1{constructor(){this._element=document.body}getWidth(){const _d=document.documentElement.clientWidth;return Math.abs(window.innerWidth-_d)}hide(){const _d=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,DN,i_=>i_+_d),this._setElementAttributes(y1,DN,i_=>i_+_d),this._setElementAttributes(mM,VP,i_=>i_-_d)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,DN),this._resetElementAttributes(y1,DN),this._resetElementAttributes(mM,VP)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(_d,i_,g_){const x_=this.getWidth();this._applyManipulationCallback(_d,M_=>{if(M_!==this._element&&window.innerWidth>M_.clientWidth+x_)return;this._saveInitialAttribute(M_,i_);const X_=window.getComputedStyle(M_).getPropertyValue(i_);M_.style.setProperty(i_,`${g_(Number.parseFloat(X_))}px`)})}_saveInitialAttribute(_d,i_){const g_=_d.style.getPropertyValue(i_);g_&&W_.setDataAttribute(_d,i_,g_)}_resetElementAttributes(_d,i_){this._applyManipulationCallback(_d,g_=>{const x_=W_.getDataAttribute(g_,i_);x_!==null?(W_.removeDataAttribute(g_,i_),g_.style.setProperty(i_,x_)):g_.style.removeProperty(i_)})}_applyManipulationCallback(_d,i_){if(_n(_d))i_(_d);else for(const g_ of H_.find(_d,this._element))i_(g_)}}const GT=".bs.modal",JF=`hide${GT}`,gM=`hidePrevented${GT}`,LN=`hidden${GT}`,EM=`show${GT}`,XF=`shown${GT}`,QF=`resize${GT}`,ZF=`click.dismiss${GT}`,_B=`mousedown.dismiss${GT}`,eV=`keydown.dismiss${GT}`,vM=`click${GT}.data-api`,S1="modal-open",_M="show",MN="modal-static",yM={backdrop:!0,focus:!0,keyboard:!0},tV={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class AO extends e0{constructor(_d,i_){super(_d,i_),this._dialog=H_.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new b1,this._addEventListeners()}static get Default(){return yM}static get DefaultType(){return tV}static get NAME(){return"modal"}toggle(_d){return this._isShown?this.hide():this.show(_d)}show(_d){this._isShown||this._isTransitioning||a_.trigger(this._element,EM,{relatedTarget:_d}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(S1),this._adjustDialog(),this._backdrop.show(()=>this._showElement(_d)))}hide(){this._isShown&&!this._isTransitioning&&(a_.trigger(this._element,JF).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(_M),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){a_.off(window,GT),a_.off(this._dialog,GT),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new WI({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new BP({trapElement:this._element})}_showElement(_d){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const i_=H_.findOne(".modal-body",this._dialog);i_&&(i_.scrollTop=0),_f(this._element),this._element.classList.add(_M),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,a_.trigger(this._element,XF,{relatedTarget:_d})},this._dialog,this._isAnimated())}_addEventListeners(){a_.on(this._element,eV,_d=>{_d.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),a_.on(window,QF,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),a_.on(this._element,_B,_d=>{a_.one(this._element,ZF,i_=>{this._element===_d.target&&this._element===i_.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(S1),this._resetAdjustments(),this._scrollBar.reset(),a_.trigger(this._element,LN)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(a_.trigger(this._element,gM).defaultPrevented)return;const _d=this._element.scrollHeight>document.documentElement.clientHeight,i_=this._element.style.overflowY;i_==="hidden"||this._element.classList.contains(MN)||(_d||(this._element.style.overflowY="hidden"),this._element.classList.add(MN),this._queueCallback(()=>{this._element.classList.remove(MN),this._queueCallback(()=>{this._element.style.overflowY=i_},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const _d=this._element.scrollHeight>document.documentElement.clientHeight,i_=this._scrollBar.getWidth(),g_=i_>0;if(g_&&!_d){const x_=n_()?"paddingLeft":"paddingRight";this._element.style[x_]=`${i_}px`}if(!g_&&_d){const x_=n_()?"paddingRight":"paddingLeft";this._element.style[x_]=`${i_}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(_d,i_){return this.each(function(){const g_=AO.getOrCreateInstance(this,_d);if(typeof _d=="string"){if(g_[_d]===void 0)throw new TypeError(`No method named "${_d}"`);g_[_d](i_)}})}}a_.on(document,vM,'[data-bs-toggle="modal"]',function(u_){const _d=H_.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&u_.preventDefault(),a_.one(_d,EM,g_=>{g_.defaultPrevented||a_.one(_d,LN,()=>{_s(this)&&this.focus()})});const i_=H_.findOne(".modal.show");i_&&AO.getInstance(i_).hide(),AO.getOrCreateInstance(_d).toggle(this)}),E0(AO),e_(AO);const HI=".bs.offcanvas",bM=".data-api",nV=`load${HI}${bM}`,SM="show",RM="showing",jN="hiding",TM=".offcanvas.show",rV=`show${HI}`,iV=`shown${HI}`,GP=`hide${HI}`,wM=`hidePrevented${HI}`,CM=`hidden${HI}`,oV=`resize${HI}`,IM=`click${HI}${bM}`,sV=`keydown.dismiss${HI}`,R1={backdrop:!0,keyboard:!0,scroll:!1},$P={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class qI extends e0{constructor(_d,i_){super(_d,i_),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return R1}static get DefaultType(){return $P}static get NAME(){return"offcanvas"}toggle(_d){return this._isShown?this.hide():this.show(_d)}show(_d){this._isShown||a_.trigger(this._element,rV,{relatedTarget:_d}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new b1().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(RM),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(SM),this._element.classList.remove(RM),a_.trigger(this._element,iV,{relatedTarget:_d})},this._element,!0))}hide(){this._isShown&&(a_.trigger(this._element,GP).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(jN),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(SM,jN),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new b1().reset(),a_.trigger(this._element,CM)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const _d=!!this._config.backdrop;return new WI({className:"offcanvas-backdrop",isVisible:_d,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:_d?()=>{this._config.backdrop!=="static"?this.hide():a_.trigger(this._element,wM)}:null})}_initializeFocusTrap(){return new BP({trapElement:this._element})}_addEventListeners(){a_.on(this._element,sV,_d=>{_d.key==="Escape"&&(this._config.keyboard?this.hide():a_.trigger(this._element,wM))})}static jQueryInterface(_d){return this.each(function(){const i_=qI.getOrCreateInstance(this,_d);if(typeof _d=="string"){if(i_[_d]===void 0||_d.startsWith("_")||_d==="constructor")throw new TypeError(`No method named "${_d}"`);i_[_d](this)}})}}a_.on(document,IM,'[data-bs-toggle="offcanvas"]',function(u_){const _d=H_.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&u_.preventDefault(),na(this))return;a_.one(_d,CM,()=>{_s(this)&&this.focus()});const i_=H_.findOne(TM);i_&&i_!==_d&&qI.getInstance(i_).hide(),qI.getOrCreateInstance(_d).toggle(this)}),a_.on(window,nV,()=>{for(const u_ of H_.find(TM))qI.getOrCreateInstance(u_).show()}),a_.on(window,oV,()=>{for(const u_ of H_.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(u_).position!=="fixed"&&qI.getOrCreateInstance(u_).hide()}),E0(qI),e_(qI);const OM={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},aV=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),AM=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,NM=(u_,_d)=>{const i_=u_.nodeName.toLowerCase();return _d.includes(i_)?!aV.has(i_)||!!AM.test(u_.nodeValue):_d.filter(g_=>g_ instanceof RegExp).some(g_=>g_.test(i_))},WP={allowList:OM,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},cV={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},uV={entry:"(string|element|function|null)",selector:"(string|element)"};class HP extends Y_{constructor(_d){super(),this._config=this._getConfig(_d)}static get Default(){return WP}static get DefaultType(){return cV}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(_d=>this._resolvePossibleFunction(_d)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(_d){return this._checkContent(_d),this._config.content={...this._config.content,..._d},this}toHtml(){const _d=document.createElement("div");_d.innerHTML=this._maybeSanitize(this._config.template);for(const[x_,M_]of Object.entries(this._config.content))this._setContent(_d,M_,x_);const i_=_d.children[0],g_=this._resolvePossibleFunction(this._config.extraClass);return g_&&i_.classList.add(...g_.split(" ")),i_}_typeCheckConfig(_d){super._typeCheckConfig(_d),this._checkContent(_d.content)}_checkContent(_d){for(const[i_,g_]of Object.entries(_d))super._typeCheckConfig({selector:i_,entry:g_},uV)}_setContent(_d,i_,g_){const x_=H_.findOne(g_,_d);x_&&((i_=this._resolvePossibleFunction(i_))?_n(i_)?this._putElementInTemplate(_r(i_),x_):this._config.html?x_.innerHTML=this._maybeSanitize(i_):x_.textContent=i_:x_.remove())}_maybeSanitize(_d){return this._config.sanitize?function(i_,g_,x_){if(!i_.length)return i_;if(x_&&typeof x_=="function")return x_(i_);const M_=new window.DOMParser().parseFromString(i_,"text/html"),X_=[].concat(...M_.body.querySelectorAll("*"));for(const i0 of X_){const _0=i0.nodeName.toLowerCase();if(!Object.keys(g_).includes(_0)){i0.remove();continue}const N0=[].concat(...i0.attributes),P0=[].concat(g_["*"]||[],g_[_0]||[]);for(const R0 of N0)NM(R0,P0)||i0.removeAttribute(R0.nodeName)}return M_.body.innerHTML}(_d,this._config.allowList,this._config.sanitizeFn):_d}_resolvePossibleFunction(_d){return t_(_d,[this])}_putElementInTemplate(_d,i_){if(this._config.html)return i_.innerHTML="",void i_.append(_d);i_.textContent=_d.textContent}}const lV=new Set(["sanitize","allowList","sanitizeFn"]),qP="fade",T1="show",kM=".modal",PM="hide.bs.modal",UN="hover",w1="focus",dV={AUTO:"auto",TOP:"top",RIGHT:n_()?"left":"right",BOTTOM:"bottom",LEFT:n_()?"right":"left"},pV={allowList:OM,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},hV={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class zI extends e0{constructor(_d,i_){if(CO===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(_d,i_),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return pV}static get DefaultType(){return hV}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),a_.off(this._element.closest(kM),PM,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const _d=a_.trigger(this._element,this.constructor.eventName("show")),i_=(ba(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(_d.defaultPrevented||!i_)return;this._disposePopper();const g_=this._getTipElement();this._element.setAttribute("aria-describedby",g_.getAttribute("id"));const{container:x_}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(x_.append(g_),a_.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(g_),g_.classList.add(T1),"ontouchstart"in document.documentElement)for(const M_ of[].concat(...document.body.children))a_.on(M_,"mouseover",_p);this._queueCallback(()=>{a_.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!a_.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(T1),"ontouchstart"in document.documentElement)for(const _d of[].concat(...document.body.children))a_.off(_d,"mouseover",_p);this._activeTrigger.click=!1,this._activeTrigger[w1]=!1,this._activeTrigger[UN]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),a_.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(_d){const i_=this._getTemplateFactory(_d).toHtml();if(!i_)return null;i_.classList.remove(qP,T1),i_.classList.add(`bs-${this.constructor.NAME}-auto`);const g_=(x_=>{do x_+=Math.floor(1e6*Math.random());while(document.getElementById(x_));return x_})(this.constructor.NAME).toString();return i_.setAttribute("id",g_),this._isAnimated()&&i_.classList.add(qP),i_}setContent(_d){this._newContent=_d,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(_d){return this._templateFactory?this._templateFactory.changeContent(_d):this._templateFactory=new HP({...this._config,content:_d,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(_d){return this.constructor.getOrCreateInstance(_d.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(qP)}_isShown(){return this.tip&&this.tip.classList.contains(T1)}_createPopper(_d){const i_=t_(this._config.placement,[this,_d,this._element]),g_=dV[i_.toUpperCase()];return LP(this._element,_d,this._getPopperConfig(g_))}_getOffset(){const{offset:_d}=this._config;return typeof _d=="string"?_d.split(",").map(i_=>Number.parseInt(i_,10)):typeof _d=="function"?i_=>_d(i_,this._element):_d}_resolvePossibleFunction(_d){return t_(_d,[this._element])}_getPopperConfig(_d){const i_={placement:_d,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:g_=>{this._getTipElement().setAttribute("data-popper-placement",g_.state.placement)}}]};return{...i_,...t_(this._config.popperConfig,[i_])}}_setListeners(){const _d=this._config.trigger.split(" ");for(const i_ of _d)if(i_==="click")a_.on(this._element,this.constructor.eventName("click"),this._config.selector,g_=>{this._initializeOnDelegatedTarget(g_).toggle()});else if(i_!=="manual"){const g_=i_===UN?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),x_=i_===UN?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");a_.on(this._element,g_,this._config.selector,M_=>{const X_=this._initializeOnDelegatedTarget(M_);X_._activeTrigger[M_.type==="focusin"?w1:UN]=!0,X_._enter()}),a_.on(this._element,x_,this._config.selector,M_=>{const X_=this._initializeOnDelegatedTarget(M_);X_._activeTrigger[M_.type==="focusout"?w1:UN]=X_._element.contains(M_.relatedTarget),X_._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},a_.on(this._element.closest(kM),PM,this._hideModalHandler)}_fixTitle(){const _d=this._element.getAttribute("title");_d&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",_d),this._element.setAttribute("data-bs-original-title",_d),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(_d,i_){clearTimeout(this._timeout),this._timeout=setTimeout(_d,i_)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(_d){const i_=W_.getDataAttributes(this._element);for(const g_ of Object.keys(i_))lV.has(g_)&&delete i_[g_];return _d={...i_,...typeof _d=="object"&&_d?_d:{}},_d=this._mergeConfigObj(_d),_d=this._configAfterMerge(_d),this._typeCheckConfig(_d),_d}_configAfterMerge(_d){return _d.container=_d.container===!1?document.body:_r(_d.container),typeof _d.delay=="number"&&(_d.delay={show:_d.delay,hide:_d.delay}),typeof _d.title=="number"&&(_d.title=_d.title.toString()),typeof _d.content=="number"&&(_d.content=_d.content.toString()),_d}_getDelegateConfig(){const _d={};for(const[i_,g_]of Object.entries(this._config))this.constructor.Default[i_]!==g_&&(_d[i_]=g_);return _d.selector=!1,_d.trigger="manual",_d}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(_d){return this.each(function(){const i_=zI.getOrCreateInstance(this,_d);if(typeof _d=="string"){if(i_[_d]===void 0)throw new TypeError(`No method named "${_d}"`);i_[_d]()}})}}e_(zI);const fV={...zI.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},mV={...zI.DefaultType,content:"(null|string|element|function)"};class ZO extends zI{static get Default(){return fV}static get DefaultType(){return mV}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(_d){return this.each(function(){const i_=ZO.getOrCreateInstance(this,_d);if(typeof _d=="string"){if(i_[_d]===void 0)throw new TypeError(`No method named "${_d}"`);i_[_d]()}})}}e_(ZO);const zP=".bs.scrollspy",gV=`activate${zP}`,xM=`click${zP}`,EV=`load${zP}.data-api`,_A="active",KP="[href]",FN=".nav-link",DM=`${FN}, .nav-item > ${FN}, .list-group-item`,vV={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},_V={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class eN extends e0{constructor(_d,i_){super(_d,i_),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return vV}static get DefaultType(){return _V}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const _d of this._observableSections.values())this._observer.observe(_d)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(_d){return _d.target=_r(_d.target)||document.body,_d.rootMargin=_d.offset?`${_d.offset}px 0px -30%`:_d.rootMargin,typeof _d.threshold=="string"&&(_d.threshold=_d.threshold.split(",").map(i_=>Number.parseFloat(i_))),_d}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(a_.off(this._config.target,xM),a_.on(this._config.target,xM,KP,_d=>{const i_=this._observableSections.get(_d.target.hash);if(i_){_d.preventDefault();const g_=this._rootElement||window,x_=i_.offsetTop-this._element.offsetTop;if(g_.scrollTo)return void g_.scrollTo({top:x_,behavior:"smooth"});g_.scrollTop=x_}}))}_getNewObserver(){const _d={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(i_=>this._observerCallback(i_),_d)}_observerCallback(_d){const i_=X_=>this._targetLinks.get(`#${X_.target.id}`),g_=X_=>{this._previousScrollData.visibleEntryTop=X_.target.offsetTop,this._process(i_(X_))},x_=(this._rootElement||document.documentElement).scrollTop,M_=x_>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=x_;for(const X_ of _d){if(!X_.isIntersecting){this._activeTarget=null,this._clearActiveClass(i_(X_));continue}const i0=X_.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(M_&&i0){if(g_(X_),!x_)return}else M_||i0||g_(X_)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const _d=H_.find(KP,this._config.target);for(const i_ of _d){if(!i_.hash||na(i_))continue;const g_=H_.findOne(decodeURI(i_.hash),this._element);_s(g_)&&(this._targetLinks.set(decodeURI(i_.hash),i_),this._observableSections.set(i_.hash,g_))}}_process(_d){this._activeTarget!==_d&&(this._clearActiveClass(this._config.target),this._activeTarget=_d,_d.classList.add(_A),this._activateParents(_d),a_.trigger(this._element,gV,{relatedTarget:_d}))}_activateParents(_d){if(_d.classList.contains("dropdown-item"))H_.findOne(".dropdown-toggle",_d.closest(".dropdown")).classList.add(_A);else for(const i_ of H_.parents(_d,".nav, .list-group"))for(const g_ of H_.prev(i_,DM))g_.classList.add(_A)}_clearActiveClass(_d){_d.classList.remove(_A);const i_=H_.find(`${KP}.${_A}`,_d);for(const g_ of i_)g_.classList.remove(_A)}static jQueryInterface(_d){return this.each(function(){const i_=eN.getOrCreateInstance(this,_d);if(typeof _d=="string"){if(i_[_d]===void 0||_d.startsWith("_")||_d==="constructor")throw new TypeError(`No method named "${_d}"`);i_[_d]()}})}}a_.on(window,EV,()=>{for(const u_ of H_.find('[data-bs-spy="scroll"]'))eN.getOrCreateInstance(u_)}),e_(eN);const NO=".bs.tab",yV=`hide${NO}`,bV=`hidden${NO}`,LM=`show${NO}`,YP=`shown${NO}`,MM=`click${NO}`,jM=`keydown${NO}`,C1=`load${NO}`,I1="ArrowLeft",UM="ArrowRight",SV="ArrowUp",JP="ArrowDown",XP="Home",FM="End",kO="active",PO="fade",QP="show",BM=".dropdown-toggle",ZP=`:not(${BM})`,_x='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',BN=`.nav-link${ZP}, .list-group-item${ZP}, [role="tab"]${ZP}, ${_x}`,RV=`.${kO}[data-bs-toggle="tab"], .${kO}[data-bs-toggle="pill"], .${kO}[data-bs-toggle="list"]`;class xO extends e0{constructor(_d){super(_d),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),a_.on(this._element,jM,i_=>this._keydown(i_)))}static get NAME(){return"tab"}show(){const _d=this._element;if(this._elemIsActive(_d))return;const i_=this._getActiveElem(),g_=i_?a_.trigger(i_,yV,{relatedTarget:_d}):null;a_.trigger(_d,LM,{relatedTarget:i_}).defaultPrevented||g_&&g_.defaultPrevented||(this._deactivate(i_,_d),this._activate(_d,i_))}_activate(_d,i_){_d&&(_d.classList.add(kO),this._activate(H_.getElementFromSelector(_d)),this._queueCallback(()=>{_d.getAttribute("role")==="tab"?(_d.removeAttribute("tabindex"),_d.setAttribute("aria-selected",!0),this._toggleDropDown(_d,!0),a_.trigger(_d,YP,{relatedTarget:i_})):_d.classList.add(QP)},_d,_d.classList.contains(PO)))}_deactivate(_d,i_){_d&&(_d.classList.remove(kO),_d.blur(),this._deactivate(H_.getElementFromSelector(_d)),this._queueCallback(()=>{_d.getAttribute("role")==="tab"?(_d.setAttribute("aria-selected",!1),_d.setAttribute("tabindex","-1"),this._toggleDropDown(_d,!1),a_.trigger(_d,bV,{relatedTarget:i_})):_d.classList.remove(QP)},_d,_d.classList.contains(PO)))}_keydown(_d){if(![I1,UM,SV,JP,XP,FM].includes(_d.key))return;_d.stopPropagation(),_d.preventDefault();const i_=this._getChildren().filter(x_=>!na(x_));let g_;if([XP,FM].includes(_d.key))g_=i_[_d.key===XP?0:i_.length-1];else{const x_=[UM,JP].includes(_d.key);g_=m_(i_,_d.target,x_,!0)}g_&&(g_.focus({preventScroll:!0}),xO.getOrCreateInstance(g_).show())}_getChildren(){return H_.find(BN,this._parent)}_getActiveElem(){return this._getChildren().find(_d=>this._elemIsActive(_d))||null}_setInitialAttributes(_d,i_){this._setAttributeIfNotExists(_d,"role","tablist");for(const g_ of i_)this._setInitialAttributesOnChild(g_)}_setInitialAttributesOnChild(_d){_d=this._getInnerElement(_d);const i_=this._elemIsActive(_d),g_=this._getOuterElement(_d);_d.setAttribute("aria-selected",i_),g_!==_d&&this._setAttributeIfNotExists(g_,"role","presentation"),i_||_d.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(_d,"role","tab"),this._setInitialAttributesOnTargetPanel(_d)}_setInitialAttributesOnTargetPanel(_d){const i_=H_.getElementFromSelector(_d);i_&&(this._setAttributeIfNotExists(i_,"role","tabpanel"),_d.id&&this._setAttributeIfNotExists(i_,"aria-labelledby",`${_d.id}`))}_toggleDropDown(_d,i_){const g_=this._getOuterElement(_d);if(!g_.classList.contains("dropdown"))return;const x_=(M_,X_)=>{const i0=H_.findOne(M_,g_);i0&&i0.classList.toggle(X_,i_)};x_(BM,kO),x_(".dropdown-menu",QP),g_.setAttribute("aria-expanded",i_)}_setAttributeIfNotExists(_d,i_,g_){_d.hasAttribute(i_)||_d.setAttribute(i_,g_)}_elemIsActive(_d){return _d.classList.contains(kO)}_getInnerElement(_d){return _d.matches(BN)?_d:H_.findOne(BN,_d)}_getOuterElement(_d){return _d.closest(".nav-item, .list-group-item")||_d}static jQueryInterface(_d){return this.each(function(){const i_=xO.getOrCreateInstance(this);if(typeof _d=="string"){if(i_[_d]===void 0||_d.startsWith("_")||_d==="constructor")throw new TypeError(`No method named "${_d}"`);i_[_d]()}})}}a_.on(document,MM,_x,function(u_){["A","AREA"].includes(this.tagName)&&u_.preventDefault(),na(this)||xO.getOrCreateInstance(this).show()}),a_.on(window,C1,()=>{for(const u_ of H_.find(RV))xO.getOrCreateInstance(u_)}),e_(xO);const cO=".bs.toast",O1=`mouseover${cO}`,TV=`mouseout${cO}`,wV=`focusin${cO}`,CV=`focusout${cO}`,uO=`hide${cO}`,IV=`hidden${cO}`,VM=`show${cO}`,OV=`shown${cO}`,GM="hide",VN="show",A1="showing",AV={animation:"boolean",autohide:"boolean",delay:"number"},NV={animation:!0,autohide:!0,delay:5e3};class GN extends e0{constructor(_d,i_){super(_d,i_),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return NV}static get DefaultType(){return AV}static get NAME(){return"toast"}show(){a_.trigger(this._element,VM).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(GM),_f(this._element),this._element.classList.add(VN,A1),this._queueCallback(()=>{this._element.classList.remove(A1),a_.trigger(this._element,OV),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(a_.trigger(this._element,uO).defaultPrevented||(this._element.classList.add(A1),this._queueCallback(()=>{this._element.classList.add(GM),this._element.classList.remove(A1,VN),a_.trigger(this._element,IV)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(VN),super.dispose()}isShown(){return this._element.classList.contains(VN)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(_d,i_){switch(_d.type){case"mouseover":case"mouseout":this._hasMouseInteraction=i_;break;case"focusin":case"focusout":this._hasKeyboardInteraction=i_}if(i_)return void this._clearTimeout();const g_=_d.relatedTarget;this._element===g_||this._element.contains(g_)||this._maybeScheduleHide()}_setListeners(){a_.on(this._element,O1,_d=>this._onInteraction(_d,!0)),a_.on(this._element,TV,_d=>this._onInteraction(_d,!1)),a_.on(this._element,wV,_d=>this._onInteraction(_d,!0)),a_.on(this._element,CV,_d=>this._onInteraction(_d,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(_d){return this.each(function(){const i_=GN.getOrCreateInstance(this,_d);if(typeof _d=="string"){if(i_[_d]===void 0)throw new TypeError(`No method named "${_d}"`);i_[_d](this)}})}}return E0(GN),e_(GN),{Alert:u0,Button:T0,Carousel:kT,Collapse:iI,Dropdown:UR,Modal:AO,Offcanvas:qI,Popover:ZO,ScrollSpy:eN,Tab:xO,Toast:GN,Tooltip:zI}})})(bootstrap_bundle_min);function App(){return jsxRuntimeExports.jsx("div",{className:"App",children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{exact:!0,path:"/",element:jsxRuntimeExports.jsx(Home,{})}),jsxRuntimeExports.jsx(Route,{path:"/login",element:jsxRuntimeExports.jsx(Login,{})}),jsxRuntimeExports.jsx(Route,{path:"/register",element:jsxRuntimeExports.jsx(Register,{})}),jsxRuntimeExports.jsx(Route,{path:"/meet/:id",element:jsxRuntimeExports.jsx(MeetRoom,{})}),jsxRuntimeExports.jsx(Route,{path:"/profile",element:jsxRuntimeExports.jsx(Profile,{})})]})})}const scriptRel="modulepreload",assetsURL=function(e){return"/"+e},seen={},__vitePreload=function e(o,s,a){let _=Promise.resolve();if(s&&s.length>0){const $=document.getElementsByTagName("link");_=Promise.all(s.map(_e=>{if(_e=assetsURL(_e),_e in seen)return;seen[_e]=!0;const _n=_e.endsWith(".css"),_r=_n?'[rel="stylesheet"]':"";if(!!a)for(let ba=$.length-1;ba>=0;ba--){const _p=$[ba];if(_p.href===_e&&(!_n||_p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${_e}"]${_r}`))return;const na=document.createElement("link");if(na.rel=_n?"stylesheet":scriptRel,_n||(na.as="script",na.crossOrigin=""),na.href=_e,document.head.appendChild(na),_n)return new Promise((ba,_p)=>{na.addEventListener("load",ba),na.addEventListener("error",()=>_p(new Error(`Unable to preload CSS for ${_e}`)))})}))}return _.then(()=>o()).catch($=>{const _e=new Event("vite:preloadError",{cancelable:!0});if(_e.payload=$,window.dispatchEvent(_e),!_e.defaultPrevented)throw $})},reportWebVitals=e=>{e&&e instanceof Function&&__vitePreload(()=>import("./web-vitals-GXdahIIP.js"),__vite__mapDeps([])).then(({getCLS:o,getFID:s,getFCP:a,getLCP:_,getTTFB:$})=>{o(e),s(e),a(e),_(e),$(e)})},root=client.createRoot(document.getElementById("root"));root.render(jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsx(AuthContextProvider,{children:jsxRuntimeExports.jsx(SocketContextProvider,{children:jsxRuntimeExports.jsx(App,{})})})}));reportWebVitals();
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}